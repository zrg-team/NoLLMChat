const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-JZURskBY.js","assets/index-BI7AT9Lt.js","assets/index-BqtM78fc.css","assets/dot-CKDMXOD3.js","assets/createLucideIcon-B0dYk2nE.js","assets/index-CuU07XIu.js","assets/pdf-CajhSkHa.js","assets/pdf.min-DX3AyXIJ.js","assets/pdf.worker.min-DhAvbXYU.js","assets/index-C1fFSMf1.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-BkpfqE9V.js","assets/index-Cr8Tc6mT.css","assets/index-yEY5AE0y.js","assets/use-prevent-pitch-zoom-lFEWSQFn.js","assets/index-BEkVPQPE.js","assets/link-6FRRrFw6.js","assets/trash-2-Bk6T4_Wn.js","assets/text-fBFOIFrU.js","assets/external-link-DZiofibh.js","assets/unlink-BX3tOGun.js","assets/index-COLWAJG5.js","assets/list-v-1DuM8Z.js","assets/list-ordered-k3EHiZeO.js","assets/list-todo-CsOmghSg.js","assets/indent-increase-D70DYf4u.js","assets/pilcrow-CGg_mRG1.js","assets/heading-1-cn6rBx-T.js","assets/heading-2-BwNu7WR3.js","assets/heading-3-CC2LikAS.js","assets/table-DkhhZgM0.js","assets/file-code-C-qqIw4Z.js","assets/quote-K7lGtwuo.js","assets/minus-DoXwUnX9.js","assets/square-Bf47Itdu.js","assets/chevron-right-4CxTHW62.js","assets/image-CeI0ppt6.js","assets/table-of-contents-BWSQsNC1.js","assets/columns-3-fCSLuM87.js","assets/link-2-DGwXOc-b.js","assets/calendar-seAslxCN.js","assets/plus-BhZ9qt07.js","assets/wrap-text-BFqLplWo.js","assets/pen-CTs34q1T.js","assets/eye-Cz6QkF-A.js","assets/indent-decrease-BWeILDd-.js","assets/pointer-DsUAQRQ0.js","assets/wand-sparkles-DqWuL8Ti.js","assets/bold-CB_6IrYM.js","assets/italic-1YzQkW8n.js","assets/underline-1T-3QudC.js","assets/strikethrough-Cr5CyYyH.js","assets/code-xml-CjIhmk0B.js","assets/baseline-KGbH4LD0.js","assets/paint-bucket-D1lmr4cQ.js","assets/arrow-up-to-line-BYws7EiH.js","assets/index-BCYu3EnN.css","assets/index-DUi7_GYs.js","assets/check-BVW7eF_B.js","assets/circle-C_OZLUbE.js","assets/index-CTZWMXN0.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-6SORg0ob.js","assets/DocumentViewer-CGm2Hp6Z.js"])))=>i.map(i=>d[i]);
var aAe=Object.defineProperty;var oAe=(ki,Ya,As)=>Ya in ki?aAe(ki,Ya,{enumerable:!0,configurable:!0,writable:!0,value:As}):ki[Ya]=As;var kf=(ki,Ya,As)=>oAe(ki,typeof Ya!="symbol"?Ya+"":Ya,As);import{r as g,M as vN,j as h,u as Sg,P as iAe,a as bN,L as sAe,m as cAe,c as lAe,f as tK,i as uAe,b as wN,d as nK,e as dAe,g as fAe,_ as rK,h as aK,k as Cl,l as Eg,n as Ua,o as zo,p as Nl,q as en,R as pAe,s as er,t as Sn,v as Ae,w as ge,x as Mr,y as wt,z as G,A as Wa,S as Vo,B as tr,D as Og,C as hAe,E as Cg,F as de,G as oK,H as mAe,I as Pe,J as Af,K as Qe,N as Ml,O as Ha,Q as Yt,T as tn,U as ue,V as Tf,W as iK,X as yAe,Y as gAe,Z as sK,$ as Pl,a0 as If,a1 as da,a2 as ot,a3 as cK,a4 as H,a5 as kl,a6 as vAe,a7 as bAe,a8 as qa,a9 as oe,aa as wAe,ab as Oi,ac as Rf,ad as At,ae as Pr,af as xAe,ag as _Ae,ah as jAe,ai as SAe,aj as Df,ak as lK,al as EAe,am as OAe,an as uK,ao as xN,ap as CAe,aq as NAe,ar as dK,as as _N,at as MAe,au as fK,av as PAe,aw as Ng,ax as kAe,ay as AAe,az as TAe,aA as fa,aB as pK,aC as IAe,aD as jN,aE as me,aF as Ci,aG as hK,aH as Uo,aI as mK,aJ as RAe,aK as yK,aL as DAe,aM as LAe,aN as $Ae,aO as Ss,aP as Mg,aQ as Lf,aR as FAe,aS as kr,aT as Pg,aU as BAe,aV as zAe,aW as SN,aX as gK,aY as EN,aZ as VAe,a_ as UAe,a$ as WAe,b0 as HAe,b1 as qAe,b2 as Al,b3 as KAe,b4 as YAe,b5 as vK,b6 as GAe,b7 as XAe,b8 as ZAe,b9 as JAe,ba as bK,bb as ON,bc as xt,bd as QAe,be as CN,bf as e2e,bg as t2e,bh as n2e,__tla as r2e}from"./index-BI7AT9Lt.js";import wK,{__tla as a2e}from"./dot-CKDMXOD3.js";let Pt,NN,kg,MN,PN,Tl,Ag,Il,Ni,$f,Ff,Tg,kN,AN,Es,TN,IN,RN,DN,Ig,LN,$N,Rl,FN,BN,zN,VN,Rg,Dg,Lg,Dl,Ll,Mi,Pi,Bf,xK,$l,Os,Cs,_K,jK,$g,UN,WN,HN,SK,Fg,qN,Bg,KN,Ka,EK,Wo,Fl,Bl,zg,Vg,Ug,Wg,Hg,qg,Kg,Yg,YN,GN,zf,Gg,XN,Xg,ZN,JN,OK,QN,Zg,CK,eM,tM,nM,Jg,rM,NK,Qg,ev,tv,aM,nv,rv,av,ov,iv,sv,oM,iM,zl,cv,lv,uv,dv,fv,pv,hv,Vf,yn,mv,sM,cM,Ns,Ho,MK,Uf,yv,gv,Vl,Ul,PK,lM,nt,Ms,vv,bv,Vn,De,An,Tn,wv,xv,uM,dM,_v,jv,ut,fM,Sv,Ev,pM,hM,Ar,Ov,mM,yM,Ps,Tr,Cv,Nv,gM,pa,vM,Mv,Pv,bM,wM,xM,kv,In,Wl,Av,Hl,ks,_M,o2e=Promise.all([(()=>{try{return r2e}catch{}})(),(()=>{try{return a2e}catch{}})()]).then(async()=>{class ki extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Ya({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(vN);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(ki,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const As=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=Sg(AK),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const f of s.values())if(!f)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,f)=>s.set(f,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(Ya,{isPresent:n,children:e})),h.jsx(iAe.Provider,{value:u,children:e})};function AK(){return new Map}const Wf=e=>e.key||"";function SM(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const TK=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>SM(e),[e]),c=s.map(Wf),l=g.useRef(!0),u=g.useRef(s),d=Sg(()=>new Map),[f,p]=g.useState(s),[y,m]=g.useState(s);bN(()=>{l.current=!1,u.current=s;for(let w=0;w<y.length;w++){const _=Wf(y[w]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[y,c.length,c.join("-")]);const v=[];if(s!==f){let w=[...s];for(let _=0;_<y.length;_++){const x=y[_],j=Wf(x);c.includes(j)||(w.splice(_,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),m(SM(w)),p(s);return}const{forceRender:b}=g.useContext(sAe);return h.jsx(h.Fragment,{children:y.map(w=>{const _=Wf(w),x=s===y||c.includes(_),j=()=>{if(d.has(_))d.set(_,!0);else return;let S=!0;d.forEach(E=>{E||(S=!1)}),S&&(b==null||b(),m(u.current),a&&a())};return h.jsx(As,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:j,children:w},_)})})};function Tv(e){const t=Sg(()=>cAe(e)),{isStatic:n}=g.useContext(vN);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function EM(e,t){const n=Tv(t()),r=()=>n.set(t());return r(),bN(()=>{const a=()=>tK.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),lAe(r)}}),n}const IK=e=>e&&typeof e=="object"&&e.mix,RK=e=>IK(e)?e.mix:void 0;function DK(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=uAe(a,o,{mixer:RK(o[0]),...i});return t?s(r):s}function LK(e){wN.current=[],e();const t=EM(wN.current,e);return wN.current=void 0,t}function OM(e,t,n,r){if(typeof e=="function")return LK(e);const a=typeof t=="function"?t:DK(t,n,r);return Array.isArray(e)?CM(e,a):CM([e],([o])=>a(o))}function CM(e,t){const n=Sg(()=>[]);return EM(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function NM(e){return typeof e=="number"?e:parseFloat(e)}function $K(e,t={}){const{isStatic:n}=g.useContext(vN),r=g.useRef(null),a=Tv(nK(e)?NM(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(dAe.delta),c(),r.current=fAe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,tK.update(s),a.get()),c),[JSON.stringify(t)]),bN(()=>{if(nK(e))return e.on("change",l=>a.set(NM(l)))},[a]),a}var Xe=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(Xe||{}),ql=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(ql||{}),nn=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e))(nn||{}),Ga=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Ga||{}),nr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(nr||{}),Hf=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(Hf||{}),rr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(rr||{}),Ts=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(Ts||{});function MM(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=rK(t),i=rK(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(aK(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?MM(u,d,n,r+"/"+Cl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Eg(u)}),n.push({op:"replace",path:r+"/"+Cl(l),value:Eg(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Eg(u)}),n.push({op:"remove",path:r+"/"+Cl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!aK(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Cl(l),value:Eg(t[l])})}}}function FK(e,t,n=!1){var r=[];return MM(e,t,r,"",n),r}let PM,kM;PM=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},kM=()=>{const e=Ua(a=>a.toolsCallingStream),t=Ua(a=>a.structuredStream),n=Ua(a=>a.stream),r=Ua(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var p;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&zo("Multiple schemas are not supported. Only the first schema will be used."),u=t(((p=s==null?void 0:s[0])==null?void 0:p.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:f}=await PM(u,c);return l==null||l({content:f,lastChunk:d}),{lastChunk:d,content:f}},[r,n,t,e])}},Ag=globalThis||void 0||self;var Kl={},AM;function BK(){if(AM)return Kl;AM=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.parse=i,Kl.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,p){const y=new o,m=f.length;if(m<2)return y;const v=(p==null?void 0:p.decode)||u;let b=0;do{const w=f.indexOf("=",b);if(w===-1)break;const _=f.indexOf(";",b),x=_===-1?m:_;if(w>x){b=f.lastIndexOf(";",w-1)+1;continue}const j=s(f,b,w),S=c(f,w,j),E=f.slice(j,S);if(y[E]===void 0){let O=s(f,w+1,x),M=c(f,x,O);const N=v(f.slice(O,M));y[E]=N}b=x+1}while(b<m);return y}function s(f,p,y){do{const m=f.charCodeAt(p);if(m!==32&&m!==9)return p}while(++p<y);return y}function c(f,p,y){for(;p>y;){const m=f.charCodeAt(--p);if(m!==32&&m!==9)return p+1}return y}function l(f,p,y){const m=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const v=m(p);if(!t.test(v))throw new TypeError(`argument val is invalid: ${p}`);let b=f+"="+v;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return a.call(f)==="[object Date]"}return Kl}BK();var TM="popstate";function zK(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Is("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Xa(a)}return RM(t,n,null,e)}function VK(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=Za(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Is("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:Xa(o))}function r(a,o){rn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return RM(t,n,r,e)}function Ge(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function UK(){return Math.random().toString(36).substring(2,10)}function IM(e,t){return{usr:e.state,key:e.key,idx:t}}function Is(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Za(t):t,state:n,key:t&&t.key||r||UK()}}function Xa({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Za(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function RM(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:m.location,delta:b})}function f(v,b){s="PUSH";let w=Is(m.location,v,b);n&&n(w,v),l=u()+1;let _=IM(w,l),x=m.createHref(w);try{i.pushState(_,"",x)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(x)}o&&c&&c({action:s,location:m.location,delta:1})}function p(v,b){s="REPLACE";let w=Is(m.location,v,b);n&&n(w,v),l=u();let _=IM(w,l),x=m.createHref(w);i.replaceState(_,"",x),o&&c&&c({action:s,location:m.location,delta:0})}function y(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:Xa(v);return w=w.replace(/ $/,"%20"),Ge(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let m={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(TM,d),c=v,()=>{a.removeEventListener(TM,d),c=null}},createHref(v){return t(a,v)},createURL:y,encodeLocation(v){let b=y(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(v){return i.go(v)}};return m}var WK=new Set(["lazy","caseSensitive","path","id","index","children"]);function HK(e){return e.index===!0}function qf(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Ge(a.index!==!0||!a.children,"Cannot specify children on an index route"),Ge(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),HK(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=qf(a.children,t,i,r)),c}})}function qo(e,t,n="/"){return Kf(e,t,n,!1)}function Kf(e,t,n,r){let a=typeof t=="string"?Za(t):t,o=Ir(a.pathname||"/",n);if(o==null)return null;let i=DM(e);KK(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=aY(o);s=nY(i[c],l,r)}return s}function qK(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function DM(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Ge(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=ha([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Ge(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),DM(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:eY(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of LM(o.path))a(o,i,c)}),t}function LM(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=LM(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function KK(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:tY(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var YK=/^:[\w-]+$/,GK=3,XK=2,ZK=1,JK=10,QK=-2,$M=e=>e==="*";function eY(e,t){let n=e.split("/"),r=n.length;return n.some($M)&&(r+=QK),t&&(r+=XK),n.filter(a=>!$M(a)).reduce((a,o)=>a+(YK.test(o)?GK:o===""?ZK:JK),r)}function tY(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function nY(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Yf({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Yf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ha([o,d.pathname]),pathnameBase:sY(ha([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=ha([o,d.pathnameBase]))}return i}function Yf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=rY(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let p=s[d]||"";i=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}const f=s[d];return u&&!f?c[l]=void 0:c[l]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function rY(e,t=!1,n=!0){rn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function aY(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return rn(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ir(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function oY(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Za(e):e;return{pathname:n?n.startsWith("/")?n:iY(n,t):t,search:cY(r),hash:lY(a)}}function iY(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Iv(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function FM(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Gf(e){let t=FM(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Xf(e,t,n,r=!1){let a;typeof e=="string"?a=Za(e):(a={...e},Ge(!a.pathname||!a.pathname.includes("?"),Iv("?","pathname","search",a)),Ge(!a.pathname||!a.pathname.includes("#"),Iv("#","pathname","hash",a)),Ge(!a.search||!a.search.includes("#"),Iv("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}s=d>=0?t[d]:"/"}let c=oY(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var ha=e=>e.join("/").replace(/\/\/+/g,"/"),sY=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),cY=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,lY=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Zf=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Jf(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var BM=["POST","PUT","PATCH","DELETE"],uY=new Set(BM),dY=["GET",...BM],fY=new Set(dY),pY=new Set([301,302,303,307,308]),hY=new Set([307,308]),Rv={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},mY={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Yl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Dv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yY=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),zM="remix-router-transitions",VM=Symbol("ResetLoaderData");function UM(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Ge(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||yY,a={},o=qf(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||xY,l=e.patchRoutesOnNavigation,u={...e.future},d=null,f=new Set,p=null,y=null,m=null,v=e.hydrationData!=null,b=qo(o,e.history.location,s),w=null;if(b==null&&!l){let W=yr(404,{pathname:e.history.location.pathname}),{matches:J,route:ae}=tP(o);b=J,w={[ae.id]:W}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(W=>W.route.lazy))_=!1;else if(!b.some(W=>W.route.loader))_=!0;else{let W=e.hydrationData?e.hydrationData.loaderData:null,J=e.hydrationData?e.hydrationData.errors:null;if(J){let ae=b.findIndex(fe=>J[fe.route.id]!==void 0);_=b.slice(0,ae+1).every(fe=>!$v(fe.route,W,J))}else _=b.every(ae=>!$v(ae.route,W,J))}else{_=!1,b=[];let W=Oe(null,o,e.history.location.pathname);W.active&&W.matches&&(b=W.matches)}let x,j={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:Rv,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,O,M=!1,N=new Map,P=null,I=!1,k=!1,C=new Set,A=new Map,T=0,D=-1,L=new Map,R=new Set,F=new Map,V=new Map,$=new Set,U=new Map,z,K=null;function ne(){if(d=e.history.listen(({action:W,location:J,delta:ae})=>{if(z){z(),z=void 0;return}rn(U.size===0||ae!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let fe=Ut({currentLocation:j.location,nextLocation:J,historyAction:W});if(fe&&ae!=null){let Ne=new Promise(Re=>{z=Re});e.history.go(ae*-1),Te(fe,{state:"blocked",location:J,proceed(){Te(fe,{state:"proceeding",proceed:void 0,reset:void 0,location:J}),Ne.then(()=>e.history.go(ae))},reset(){let Re=new Map(j.blockers);Re.set(fe,Yl),q({blockers:Re})}});return}return ce(W,J)}),n){AY(t,N);let W=()=>TY(t,N);t.addEventListener("pagehide",W),P=()=>t.removeEventListener("pagehide",W)}return j.initialized||ce("POP",j.location,{initialHydration:!0}),x}function Q(){d&&d(),P&&P(),f.clear(),O&&O.abort(),j.fetchers.forEach((W,J)=>Xn(J)),j.blockers.forEach((W,J)=>he(J))}function Y(W){return f.add(W),()=>f.delete(W)}function q(W,J={}){j={...j,...W};let ae=[],fe=[];j.fetchers.forEach((Ne,Re)=>{Ne.state==="idle"&&($.has(Re)?ae.push(Re):fe.push(Re))}),[...f].forEach(Ne=>Ne(j,{deletedFetchers:ae,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),ae.forEach(Ne=>Xn(Ne)),fe.forEach(Ne=>j.fetchers.delete(Ne))}function X(W,J,{flushSync:ae}={}){var we,ze;let fe=j.actionData!=null&&j.navigation.formMethod!=null&&Rr(j.navigation.formMethod)&&j.navigation.state==="loading"&&((we=W.state)==null?void 0:we._isRedirect)!==!0,Ne;J.actionData?Object.keys(J.actionData).length>0?Ne=J.actionData:Ne=null:fe?Ne=j.actionData:Ne=null;let Re=J.loaderData?QM(j.loaderData,J.loaderData,J.matches||[],J.errors):j.loaderData,Be=j.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Je,kt)=>Be.set(kt,Yl)));let Me=E===!0||j.navigation.formMethod!=null&&Rr(j.navigation.formMethod)&&((ze=W.state)==null?void 0:ze._isRedirect)!==!0;i&&(o=i,i=void 0),I||S==="POP"||(S==="PUSH"?e.history.push(W,W.state):S==="REPLACE"&&e.history.replace(W,W.state));let ke;if(S==="POP"){let Je=N.get(j.location.pathname);Je&&Je.has(W.pathname)?ke={currentLocation:j.location,nextLocation:W}:N.has(W.pathname)&&(ke={currentLocation:W,nextLocation:j.location})}else if(M){let Je=N.get(j.location.pathname);Je?Je.add(W.pathname):(Je=new Set([W.pathname]),N.set(j.location.pathname,Je)),ke={currentLocation:j.location,nextLocation:W}}q({...J,actionData:Ne,loaderData:Re,historyAction:S,location:W,initialized:!0,navigation:Rv,revalidation:"idle",restoreScrollPosition:Ee(W,J.matches||j.matches),preventScrollReset:Me,blockers:Be},{viewTransitionOpts:ke,flushSync:ae===!0}),S="POP",E=!1,M=!1,I=!1,k=!1,K==null||K.resolve(),K=null}async function te(W,J){if(typeof W=="number"){e.history.go(W);return}let ae=Lv(j.location,j.matches,s,W,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:fe,submission:Ne,error:Re}=WM(!1,ae,J),Be=j.location,Me=Is(j.location,fe,J&&J.state);Me={...Me,...e.history.encodeLocation(Me)};let ke=J&&J.replace!=null?J.replace:void 0,we="PUSH";ke===!0?we="REPLACE":ke===!1||Ne!=null&&Rr(Ne.formMethod)&&Ne.formAction===j.location.pathname+j.location.search&&(we="REPLACE");let ze=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Je=(J&&J.flushSync)===!0,kt=Ut({currentLocation:Be,nextLocation:Me,historyAction:we});if(kt){Te(kt,{state:"blocked",location:Me,proceed(){Te(kt,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),te(W,J)},reset(){let Lt=new Map(j.blockers);Lt.set(kt,Yl),q({blockers:Lt})}});return}await ce(we,Me,{submission:Ne,pendingError:Re,preventScrollReset:ze,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:Je})}function B(){K||(K=IY()),st(),q({revalidation:"loading"});let W=K.promise;return j.navigation.state==="submitting"?W:j.navigation.state==="idle"?(ce(j.historyAction,j.location,{startUninterruptedRevalidation:!0}),W):(ce(S||j.historyAction,j.navigation.location,{overrideNavigation:j.navigation,enableViewTransition:M===!0}),W)}async function ce(W,J,ae){O&&O.abort(),O=null,S=W,I=(ae&&ae.startUninterruptedRevalidation)===!0,_e(j.location,j.matches),E=(ae&&ae.preventScrollReset)===!0,M=(ae&&ae.enableViewTransition)===!0;let fe=i||o,Ne=ae&&ae.overrideNavigation,Re=qo(fe,J,s),Be=(ae&&ae.flushSync)===!0,Me=Oe(Re,fe,J.pathname);if(Me.active&&Me.matches&&(Re=Me.matches),!Re){let{error:at,notFoundMatches:Jn,route:Kt}=Dt(J.pathname);X(J,{matches:Jn,loaderData:{},errors:{[Kt.id]:at}},{flushSync:Be});return}if(j.initialized&&!k&&CY(j.location,J)&&!(ae&&ae.submission&&Rr(ae.submission.formMethod))){X(J,{matches:Re},{flushSync:Be});return}O=new AbortController;let ke=Rs(e.history,J,O.signal,ae&&ae.submission),we;if(ae&&ae.pendingError)we=[Ai(Re).route.id,{type:"error",error:ae.pendingError}];else if(ae&&ae.submission&&Rr(ae.submission.formMethod)){let at=await re(ke,J,ae.submission,Re,Me.active,{replace:ae.replace,flushSync:Be});if(at.shortCircuited)return;if(at.pendingActionResult){let[Jn,Kt]=at.pendingActionResult;if(ar(Kt)&&Jf(Kt.error)&&Kt.error.status===404){O=null,X(J,{matches:at.matches,loaderData:{},errors:{[Jn]:Kt.error}});return}}Re=at.matches||Re,we=at.pendingActionResult,Ne=zv(J,ae.submission),Be=!1,Me.active=!1,ke=Rs(e.history,ke.url,ke.signal)}let{shortCircuited:ze,matches:Je,loaderData:kt,errors:Lt}=await le(ke,J,Re,Me.active,Ne,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,Be,we);ze||(O=null,X(J,{matches:Je||Re,...eP(we),loaderData:kt,errors:Lt}))}async function re(W,J,ae,fe,Ne,Re={}){st();let Be=PY(J,ae);if(q({navigation:Be},{flushSync:Re.flushSync===!0}),Ne){let we=await Ue(fe,J.pathname,W.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let ze=Ai(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[ze,{type:"error",error:we.error}]}}else if(we.matches)fe=we.matches;else{let{notFoundMatches:ze,error:Je,route:kt}=Dt(J.pathname);return{matches:ze,pendingActionResult:[kt.id,{type:"error",error:Je}]}}}let Me,ke=Gl(fe,J);if(!ke.route.action&&!ke.route.lazy)Me={type:"error",error:yr(405,{method:W.method,pathname:J.pathname,routeId:ke.route.id})};else if(Me=(await He("action",j,W,[ke],fe,null))[ke.route.id],W.signal.aborted)return{shortCircuited:!0};if(Ti(Me)){let we;return Re&&Re.replace!=null?we=Re.replace:we=XM(Me.response.headers.get("Location"),new URL(W.url),s)===j.location.pathname+j.location.search,await We(W,Me,!0,{submission:ae,replace:we}),{shortCircuited:!0}}if(ar(Me)){let we=Ai(fe,ke.route.id);return(Re&&Re.replace)!==!0&&(S="PUSH"),{matches:fe,pendingActionResult:[we.route.id,Me]}}return{matches:fe,pendingActionResult:[ke.route.id,Me]}}async function le(W,J,ae,fe,Ne,Re,Be,Me,ke,we,ze){let Je=Ne||zv(J,Re),kt=Re||Be||oP(Je),Lt=!I&&!ke;if(fe){if(Lt){let Qn=je(ze);q({navigation:Je,...Qn!==void 0?{actionData:Qn}:{}},{flushSync:we})}let pt=await Ue(ae,J.pathname,W.signal);if(pt.type==="aborted")return{shortCircuited:!0};if(pt.type==="error"){let Qn=Ai(pt.partialMatches).route.id;return{matches:pt.partialMatches,loaderData:{},errors:{[Qn]:pt.error}}}else if(pt.matches)ae=pt.matches;else{let{error:Qn,notFoundMatches:js,route:zt}=Dt(J.pathname);return{matches:js,loaderData:{},errors:{[zt.id]:Qn}}}}let at=i||o,[Jn,Kt]=qM(e.history,j,ae,kt,J,ke===!0,k,C,$,F,R,at,s,ze);if(D=++T,Jn.length===0&&Kt.length===0){let pt=Z();return X(J,{matches:ae,loaderData:{},errors:ze&&ar(ze[1])?{[ze[0]]:ze[1].error}:null,...eP(ze),...pt?{fetchers:new Map(j.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(Lt){let pt={};if(!fe){pt.navigation=Je;let Qn=je(ze);Qn!==void 0&&(pt.actionData=Qn)}Kt.length>0&&(pt.fetchers=Le(Kt)),q(pt,{flushSync:we})}Kt.forEach(pt=>{Zn(pt.key),pt.controller&&A.set(pt.key,pt.controller)});let _s=()=>Kt.forEach(pt=>Zn(pt.key));O&&O.signal.addEventListener("abort",_s);let{loaderResults:ua,fetcherResults:Ei}=await Mt(j,ae,Jn,Kt,W);if(W.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",_s),Kt.forEach(pt=>A.delete(pt.key));let Va=Qf(ua);if(Va)return await We(W,Va.result,!0,{replace:Me}),{shortCircuited:!0};if(Va=Qf(Ei),Va)return R.add(Va.key),await We(W,Va.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:Pf,errors:Nr}=JM(j,ae,ua,ze,Kt,Ei);ke&&j.errors&&(Nr={...j.errors,...Nr});let Sl=Z(),El=ee(D),Ol=Sl||El||Kt.length>0;return{matches:ae,loaderData:Pf,errors:Nr,...Ol?{fetchers:new Map(j.fetchers)}:{}}}function je(W){if(W&&!ar(W[1]))return{[W[0]]:W[1].data};if(j.actionData)return Object.keys(j.actionData).length===0?null:j.actionData}function Le(W){return W.forEach(J=>{let ae=j.fetchers.get(J.key),fe=Xl(void 0,ae?ae.data:void 0);j.fetchers.set(J.key,fe)}),new Map(j.fetchers)}async function $e(W,J,ae,fe){Zn(W);let Ne=(fe&&fe.flushSync)===!0,Re=i||o,Be=Lv(j.location,j.matches,s,ae,J,fe==null?void 0:fe.relative),Me=qo(Re,Be,s),ke=Oe(Me,Re,Be);if(ke.active&&ke.matches&&(Me=ke.matches),!Me){bt(W,J,yr(404,{pathname:Be}),{flushSync:Ne});return}let{path:we,submission:ze,error:Je}=WM(!0,Be,fe);if(Je){bt(W,J,Je,{flushSync:Ne});return}let kt=Gl(Me,we),Lt=(fe&&fe.preventScrollReset)===!0;if(ze&&Rr(ze.formMethod)){await Se(W,J,we,kt,Me,ke.active,Ne,Lt,ze);return}F.set(W,{routeId:J,path:we}),await Ve(W,J,we,kt,Me,ke.active,Ne,Lt,ze)}async function Se(W,J,ae,fe,Ne,Re,Be,Me,ke){st(),F.delete(W);function we(zt){if(!zt.route.action&&!zt.route.lazy){let Bo=yr(405,{method:ke.formMethod,pathname:ae,routeId:J});return bt(W,J,Bo,{flushSync:Be}),!0}return!1}if(!Re&&we(fe))return;let ze=j.fetchers.get(W);rt(W,kY(ke,ze),{flushSync:Be});let Je=new AbortController,kt=Rs(e.history,ae,Je.signal,ke);if(Re){let zt=await Ue(Ne,ae,kt.signal);if(zt.type==="aborted")return;if(zt.type==="error"){bt(W,J,zt.error,{flushSync:Be});return}else if(zt.matches){if(Ne=zt.matches,fe=Gl(Ne,ae),we(fe))return}else{bt(W,J,yr(404,{pathname:ae}),{flushSync:Be});return}}A.set(W,Je);let Lt=T,at=(await He("action",j,kt,[fe],Ne,W))[fe.route.id];if(kt.signal.aborted){A.get(W)===Je&&A.delete(W);return}if($.has(W)){if(Ti(at)||ar(at)){rt(W,Ko(void 0));return}}else{if(Ti(at))if(A.delete(W),D>Lt){rt(W,Ko(void 0));return}else return R.add(W),rt(W,Xl(ke)),We(kt,at,!1,{fetcherSubmission:ke,preventScrollReset:Me});if(ar(at)){bt(W,J,at.error);return}}let Jn=j.navigation.location||j.location,Kt=Rs(e.history,Jn,Je.signal),_s=i||o,ua=j.navigation.state!=="idle"?qo(_s,j.navigation.location,s):j.matches;Ge(ua,"Didn't find any matches after fetcher action");let Ei=++T;L.set(W,Ei);let Va=Xl(ke,at.data);j.fetchers.set(W,Va);let[Pf,Nr]=qM(e.history,j,ua,ke,Jn,!1,k,C,$,F,R,_s,s,[fe.route.id,at]);Nr.filter(zt=>zt.key!==W).forEach(zt=>{let Bo=zt.key,jg=j.fetchers.get(Bo),yN=Xl(void 0,jg?jg.data:void 0);j.fetchers.set(Bo,yN),Zn(Bo),zt.controller&&A.set(Bo,zt.controller)}),q({fetchers:new Map(j.fetchers)});let Sl=()=>Nr.forEach(zt=>Zn(zt.key));Je.signal.addEventListener("abort",Sl);let{loaderResults:El,fetcherResults:Ol}=await Mt(j,ua,Pf,Nr,Kt);if(Je.signal.aborted)return;Je.signal.removeEventListener("abort",Sl),L.delete(W),A.delete(W),Nr.forEach(zt=>A.delete(zt.key));let pt=Qf(El);if(pt)return We(Kt,pt.result,!1,{preventScrollReset:Me});if(pt=Qf(Ol),pt)return R.add(pt.key),We(Kt,pt.result,!1,{preventScrollReset:Me});let{loaderData:Qn,errors:js}=JM(j,ua,El,void 0,Nr,Ol);if(j.fetchers.has(W)){let zt=Ko(at.data);j.fetchers.set(W,zt)}ee(Ei),j.navigation.state==="loading"&&Ei>D?(Ge(S,"Expected pending action"),O&&O.abort(),X(j.navigation.location,{matches:ua,loaderData:Qn,errors:js,fetchers:new Map(j.fetchers)})):(q({errors:js,loaderData:QM(j.loaderData,Qn,ua,js),fetchers:new Map(j.fetchers)}),k=!1)}async function Ve(W,J,ae,fe,Ne,Re,Be,Me,ke){let we=j.fetchers.get(W);rt(W,Xl(ke,we?we.data:void 0),{flushSync:Be});let ze=new AbortController,Je=Rs(e.history,ae,ze.signal);if(Re){let at=await Ue(Ne,ae,Je.signal);if(at.type==="aborted")return;if(at.type==="error"){bt(W,J,at.error,{flushSync:Be});return}else if(at.matches)Ne=at.matches,fe=Gl(Ne,ae);else{bt(W,J,yr(404,{pathname:ae}),{flushSync:Be});return}}A.set(W,ze);let kt=T,Lt=(await He("loader",j,Je,[fe],Ne,W))[fe.route.id];if(A.get(W)===ze&&A.delete(W),!Je.signal.aborted){if($.has(W)){rt(W,Ko(void 0));return}if(Ti(Lt))if(D>kt){rt(W,Ko(void 0));return}else{R.add(W),await We(Je,Lt,!1,{preventScrollReset:Me});return}if(ar(Lt)){bt(W,J,Lt.error);return}rt(W,Ko(Lt.data))}}async function We(W,J,ae,{submission:fe,fetcherSubmission:Ne,preventScrollReset:Re,replace:Be}={}){J.response.headers.has("X-Remix-Revalidate")&&(k=!0);let Me=J.response.headers.get("Location");Ge(Me,"Expected a Location header on the redirect Response"),Me=XM(Me,new URL(W.url),s);let ke=Is(j.location,Me,{_isRedirect:!0});if(n){let at=!1;if(J.response.headers.has("X-Remix-Reload-Document"))at=!0;else if(Dv.test(Me)){const Jn=e.history.createURL(Me);at=Jn.origin!==t.location.origin||Ir(Jn.pathname,s)==null}if(at){Be?t.location.replace(Me):t.location.assign(Me);return}}O=null;let we=Be===!0||J.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ze,formAction:Je,formEncType:kt}=j.navigation;!fe&&!Ne&&ze&&Je&&kt&&(fe=oP(j.navigation));let Lt=fe||Ne;if(hY.has(J.response.status)&&Lt&&Rr(Lt.formMethod))await ce(we,ke,{submission:{...Lt,formAction:Me},preventScrollReset:Re||E,enableViewTransition:ae?M:void 0});else{let at=zv(ke,fe);await ce(we,ke,{overrideNavigation:at,fetcherSubmission:Ne,preventScrollReset:Re||E,enableViewTransition:ae?M:void 0})}}async function He(W,J,ae,fe,Ne,Re){let Be,Me={};try{Be=await _Y(c,W,J,ae,fe,Ne,Re,a,r)}catch(ke){return fe.forEach(we=>{Me[we.route.id]={type:"error",error:ke}}),Me}for(let[ke,we]of Object.entries(Be))if(NY(we)){let ze=we.result;Me[ke]={type:"redirect",response:EY(ze,ae,ke,Ne,s)}}else Me[ke]=await SY(we);return Me}async function Mt(W,J,ae,fe,Ne){let Re=He("loader",W,Ne,ae,J,null),Be=Promise.all(fe.map(async we=>{if(we.matches&&we.match&&we.controller){let ze=(await He("loader",W,Rs(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:ze}}else return Promise.resolve({[we.key]:{type:"error",error:yr(404,{pathname:we.path})}})})),Me=await Re,ke=(await Be).reduce((we,ze)=>Object.assign(we,ze),{});return{loaderResults:Me,fetcherResults:ke}}function st(){k=!0,F.forEach((W,J)=>{A.has(J)&&C.add(J),Zn(J)})}function rt(W,J,ae={}){j.fetchers.set(W,J),q({fetchers:new Map(j.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function bt(W,J,ae,fe={}){let Ne=Ai(j.matches,J);Xn(W),q({errors:{[Ne.route.id]:ae},fetchers:new Map(j.fetchers)},{flushSync:(fe&&fe.flushSync)===!0})}function qt(W){return V.set(W,(V.get(W)||0)+1),$.has(W)&&$.delete(W),j.fetchers.get(W)||mY}function Xn(W){let J=j.fetchers.get(W);A.has(W)&&!(J&&J.state==="loading"&&L.has(W))&&Zn(W),F.delete(W),L.delete(W),R.delete(W),$.delete(W),C.delete(W),j.fetchers.delete(W)}function Ba(W){let J=(V.get(W)||0)-1;J<=0?(V.delete(W),$.add(W)):V.set(W,J),q({fetchers:new Map(j.fetchers)})}function Zn(W){let J=A.get(W);J&&(J.abort(),A.delete(W))}function za(W){for(let J of W){let ae=qt(J),fe=Ko(ae.data);j.fetchers.set(J,fe)}}function Z(){let W=[],J=!1;for(let ae of R){let fe=j.fetchers.get(ae);Ge(fe,`Expected fetcher: ${ae}`),fe.state==="loading"&&(R.delete(ae),W.push(ae),J=!0)}return za(W),J}function ee(W){let J=[];for(let[ae,fe]of L)if(fe<W){let Ne=j.fetchers.get(ae);Ge(Ne,`Expected fetcher: ${ae}`),Ne.state==="loading"&&(Zn(ae),L.delete(ae),J.push(ae))}return za(J),J.length>0}function se(W,J){let ae=j.blockers.get(W)||Yl;return U.get(W)!==J&&U.set(W,J),ae}function he(W){j.blockers.delete(W),U.delete(W)}function Te(W,J){let ae=j.blockers.get(W)||Yl;Ge(ae.state==="unblocked"&&J.state==="blocked"||ae.state==="blocked"&&J.state==="blocked"||ae.state==="blocked"&&J.state==="proceeding"||ae.state==="blocked"&&J.state==="unblocked"||ae.state==="proceeding"&&J.state==="unblocked",`Invalid blocker state transition: ${ae.state} -> ${J.state}`);let fe=new Map(j.blockers);fe.set(W,J),q({blockers:fe})}function Ut({currentLocation:W,nextLocation:J,historyAction:ae}){if(U.size===0)return;U.size>1&&rn(!1,"A router only supports one blocker at a time");let fe=Array.from(U.entries()),[Ne,Re]=fe[fe.length-1],Be=j.blockers.get(Ne);if(!(Be&&Be.state==="proceeding")&&Re({currentLocation:W,nextLocation:J,historyAction:ae}))return Ne}function Dt(W){let J=yr(404,{pathname:W}),ae=i||o,{matches:fe,route:Ne}=tP(ae);return{notFoundMatches:fe,route:Ne,error:J}}function Ke(W,J,ae){if(p=W,m=J,y=ae||null,!v&&j.navigation===Rv){v=!0;let fe=Ee(j.location,j.matches);fe!=null&&q({restoreScrollPosition:fe})}return()=>{p=null,m=null,y=null}}function be(W,J){return y&&y(W,J.map(ae=>qK(ae,j.loaderData)))||W.key}function _e(W,J){if(p&&m){let ae=be(W,J);p[ae]=m()}}function Ee(W,J){if(p){let ae=be(W,J),fe=p[ae];if(typeof fe=="number")return fe}return null}function Oe(W,J,ae){if(l)if(W){if(Object.keys(W[0].params).length>0)return{active:!0,matches:Kf(J,ae,s,!0)}}else return{active:!0,matches:Kf(J,ae,s,!0)||[]};return{active:!1,matches:null}}async function Ue(W,J,ae){if(!l)return{type:"success",matches:W};let fe=W;for(;;){let Ne=i==null,Re=i||o,Be=a;try{await l({path:J,matches:fe,patch:(we,ze)=>{ae.aborted||YM(we,ze,Re,Be,r)}})}catch(we){return{type:"error",error:we,partialMatches:fe}}finally{Ne&&!ae.aborted&&(o=[...o])}if(ae.aborted)return{type:"aborted"};let Me=qo(Re,J,s);if(Me)return{type:"success",matches:Me};let ke=Kf(Re,J,s,!0);if(!ke||fe.length===ke.length&&fe.every((we,ze)=>we.route.id===ke[ze].route.id))return{type:"success",matches:null};fe=ke}}function St(W){a={},i=qf(W,r,void 0,a)}function Bt(W,J){let ae=i==null;YM(W,J,i||o,a,r),ae&&(o=[...o],q({}))}return x={get basename(){return s},get future(){return u},get state(){return j},get routes(){return o},get window(){return t},initialize:ne,subscribe:Y,enableScrollRestoration:Ke,navigate:te,fetch:$e,revalidate:B,createHref:W=>e.history.createHref(W),encodeLocation:W=>e.history.encodeLocation(W),getFetcher:qt,deleteFetcher:Ba,dispose:Q,getBlocker:se,deleteBlocker:he,patchRoutes:Bt,_internalFetchControllers:A,_internalSetRoutes:St},x}function gY(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function Lv(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=Xf(r||".",Gf(i),Ir(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=Bv(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let f=u.toString();c.search=f?`?${f}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:ha([n,c.pathname])),Xa(c)}function WM(e,t,n){if(!n||!gY(n))return{path:t};if(n.formMethod&&!MY(n.formMethod))return{path:t,error:yr(405,{method:n.formMethod})};let r=()=>({path:t,error:yr(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=nP(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Rr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[f,p])=>`${d}${f}=${p}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Rr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=Fv(n.formData),s=n.formData;else if(n.body instanceof FormData)i=Fv(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=ZM(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=ZM(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Rr(c.formMethod))return{path:t,submission:c};let l=Za(t);return e&&l.search&&Bv(l.search)&&i.append("index",""),l.search=`?${i}`,{path:Xa(l),submission:c}}function HM(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function qM(e,t,n,r,a,o,i,s,c,l,u,d,f,p){let y=p?ar(p[1])?p[1].error:p[1].data:void 0,m=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=HM(n,Object.keys(t.errors)[0],!0):p&&ar(p[1])&&(b=HM(n,p[0]));let w=p?p[1].statusCode:void 0,_=w&&w>=400,x=b.filter((S,E)=>{let{route:O}=S;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return $v(O,t.loaderData,t.errors);if(vY(t.loaderData,t.matches[E],S))return!0;let M=t.matches[E],N=S;return KM(S,{currentUrl:m,currentParams:M.params,nextUrl:v,nextParams:N.params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||bY(M,N)})}),j=[];return l.forEach((S,E)=>{if(o||!n.some(I=>I.route.id===S.routeId)||c.has(E))return;let O=qo(d,S.path,f);if(!O){j.push({key:E,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let M=t.fetchers.get(E),N=Gl(O,S.path),P=!1;u.has(E)?P=!1:s.has(E)?(s.delete(E),P=!0):M&&M.state!=="idle"&&M.data===void 0?P=i:P=KM(N,{currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i}),P&&j.push({key:E,routeId:S.routeId,path:S.path,matches:O,match:N,controller:new AbortController})}),[x,j]}function $v(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function vY(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function bY(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function KM(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function YM(e,t,n,r,a){let o;if(e){let c=r[e];Ge(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>GM(c,l))),s=qf(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function GM(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>GM(n,o))}):!1}async function wY(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Ge(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";rn(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!WK.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function xY({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function _Y(e,t,n,r,a,o,i,s,c,l){let u=o.map(p=>p.route.lazy?wY(p.route,c,s):void 0),d=o.map((p,y)=>{let m=u[y],v=a.some(b=>b.route.id===p.route.id);return{...p,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(v=!0),v?jY(t,r,p,m,b,l):Promise.resolve({type:"data",result:void 0}))}}),f=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return f}async function jY(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((y,m)=>u=m);s=()=>u(),t.signal.addEventListener("abort",s);let f=y=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...y!==void 0?[y]:[]),p=(async()=>{try{return{type:"data",result:await(a?a(y=>f(y)):f())}}catch(y){return{type:"error",result:y}}})();return Promise.race([p,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw yr(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw yr(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function SY(e){var r,a,o,i;let{result:t,type:n}=e;if(aP(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Zf(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(rP(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Zf(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:Jf(t)?t.status:void 0}}return rP(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function EY(e,t,n,r,a){let o=e.headers.get("Location");if(Ge(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Dv.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=Lv(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function XM(e,t,n){if(Dv.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Ir(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function Rs(e,t,n,r){let a=e.createURL(nP(t)).toString(),o={signal:n};if(r&&Rr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=Fv(r.formData):o.body=r.formData}return new Request(a,o)}function Fv(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function ZM(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function OY(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&ar(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,p=t[f];if(Ge(!Ti(p),"Cannot handle redirect results in processLoaderData"),ar(p)){let y=p.error;if(u!==void 0&&(y=u,u=void 0),i=i||{},a)i[f]=y;else{let m=Ai(e,f);i[m.route.id]==null&&(i[m.route.id]=y)}r||(o[f]=VM),c||(c=!0,s=Jf(p.error)?p.error.status:500),p.headers&&(l[f]=p.headers)}else o[f]=p.data,p.statusCode&&p.statusCode!==200&&!c&&(s=p.statusCode),p.headers&&(l[f]=p.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function JM(e,t,n,r,a,o){let{loaderData:i,errors:s}=OY(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,f=o[l];if(Ge(f,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(ar(f)){let p=Ai(e.matches,u==null?void 0:u.route.id);s&&s[p.route.id]||(s={...s,[p.route.id]:f.error}),e.fetchers.delete(l)}else if(Ti(f))Ge(!1,"Unhandled fetcher revalidation redirect");else{let p=Ko(f.data);e.fetchers.set(l,p)}}),{loaderData:i,errors:s}}function QM(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==VM).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function eP(e){return e?ar(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ai(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function tP(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function yr(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Zf(e||500,i,new Error(s),!0)}function Qf(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Ti(a))return{key:r,result:a}}}function nP(e){let t=typeof e=="string"?Za(e):e;return Xa({...t,hash:""})}function CY(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function NY(e){return aP(e.result)&&pY.has(e.result.status)}function ar(e){return e.type==="error"}function Ti(e){return(e&&e.type)==="redirect"}function rP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function aP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function MY(e){return fY.has(e.toUpperCase())}function Rr(e){return uY.has(e.toUpperCase())}function Bv(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Gl(e,t){let n=typeof t=="string"?Za(t).search:t.search;if(e[e.length-1].route.index&&Bv(n||""))return e[e.length-1];let r=FM(e);return r[r.length-1]}function oP(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function zv(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function PY(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Xl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function kY(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ko(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function AY(e,t){try{let n=e.sessionStorage.getItem(zM);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function TY(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(zM,JSON.stringify(n))}catch(r){rn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function IY(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Ii=g.createContext(null);Ii.displayName="DataRouter";var Zl=g.createContext(null);Zl.displayName="DataRouterState";var Vv=g.createContext({isTransitioning:!1});Vv.displayName="ViewTransition";var iP=g.createContext(new Map);iP.displayName="Fetchers";var RY=g.createContext(null);RY.displayName="Await";var Dr=g.createContext(null);Dr.displayName="Navigation";var ep=g.createContext(null);ep.displayName="Location";var gr=g.createContext({outlet:null,matches:[],isDataRoute:!1});gr.displayName="Route";var Uv=g.createContext(null);Uv.displayName="RouteError";function DY(e,{relative:t}={}){Ge(Ds(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Dr),{hash:a,pathname:o,search:i}=Jl(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:ha([n,o])),r.createHref({pathname:s,search:i,hash:a})}function Ds(){return g.useContext(ep)!=null}function ma(){return Ge(Ds(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(ep).location}var sP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cP(e){g.useContext(Dr).static||g.useLayoutEffect(e)}function Ri(){let{isDataRoute:e}=g.useContext(gr);return e?XY():LY()}function LY(){Ge(Ds(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Ii),{basename:t,navigator:n}=g.useContext(Dr),{matches:r}=g.useContext(gr),{pathname:a}=ma(),o=JSON.stringify(Gf(r)),i=g.useRef(!1);return cP(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(rn(i.current,sP),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=Xf(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:ha([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var $Y=g.createContext(null);function FY(e){let t=g.useContext(gr).outlet;return t&&g.createElement($Y.Provider,{value:e},t)}function lP(){let{matches:e}=g.useContext(gr),t=e[e.length-1];return t?t.params:{}}function Jl(e,{relative:t}={}){let{matches:n}=g.useContext(gr),{pathname:r}=ma(),a=JSON.stringify(Gf(n));return g.useMemo(()=>Xf(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function BY(e,t,n,r){Ge(Ds(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Dr),{matches:o}=g.useContext(gr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";fP(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=ma(),f;f=d;let p=f.pathname||"/",y=p;if(l!=="/"){let v=l.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=qo(e,{pathname:y});return rn(u||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),rn(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),HY(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:ha([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ha([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function zY(){let e=uP(),t=Jf(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var VY=g.createElement(zY,null),UY=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(gr.Provider,{value:this.props.routeContext},g.createElement(Uv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function WY({routeContext:e,match:t,children:n}){let r=g.useContext(Ii);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(gr.Provider,{value:e},n)}function HY(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Ge(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,f=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,f=!1,p=null,y=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,p=l.route.errorElement||VY,i&&(s<0&&u===0?(fP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,y=null):s===u&&(f=!0,y=l.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=p:f?b=y:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(WY,{match:l,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(UY,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}function Wv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qY(e){let t=g.useContext(Ii);return Ge(t,Wv(e)),t}function KY(e){let t=g.useContext(Zl);return Ge(t,Wv(e)),t}function YY(e){let t=g.useContext(gr);return Ge(t,Wv(e)),t}function Hv(e){let t=YY(e),n=t.matches[t.matches.length-1];return Ge(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function GY(){return Hv("useRouteId")}function uP(){var r;let e=g.useContext(Uv),t=KY("useRouteError"),n=Hv("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function XY(){let{router:e}=qY("useNavigate"),t=Hv("useNavigate"),n=g.useRef(!1);return cP(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{rn(n.current,sP),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var dP={};function fP(e,t,n){!t&&!dP[e]&&(dP[e]=!0,rn(!1,n))}var pP={};function hP(e,t){!e&&!pP[t]&&(pP[t]=!0,console.warn(t))}function mP(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&rn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&rn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&rn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var ZY=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function JY({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[f,p]=g.useState(),y=g.useRef(new Map),m=g.useCallback((_,{deletedFetchers:x,flushSync:j,viewTransitionOpts:S})=>{x.forEach(O=>y.current.delete(O)),_.fetchers.forEach((O,M)=>{O.data!==void 0&&y.current.set(M,O.data)}),hP(j===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(hP(S==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!E){t&&j?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&j){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),p({state:_,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(o(_),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(m),[e,m]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new ZY)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let _=a,x=c.promise,j=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await x});j.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(j)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&f&&(o(f.state),s({isTransitioning:!0,flushSync:!1,currentLocation:f.currentLocation,nextLocation:f.nextLocation}),p(void 0))},[i.isTransitioning,f]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,x,j)=>e.navigate(_,{state:x,preventScrollReset:j==null?void 0:j.preventScrollReset}),replace:(_,x,j)=>e.navigate(_,{replace:!0,state:x,preventScrollReset:j==null?void 0:j.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Ii.Provider,{value:w},g.createElement(Zl.Provider,{value:n},g.createElement(iP.Provider,{value:y.current},g.createElement(Vv.Provider,{value:i},g.createElement(rG,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(QY,{routes:e.routes,future:e.future,state:n})))))),null)}var QY=g.memo(eG);function eG({routes:e,future:t,state:n}){return BY(e,void 0,n,t)}function tG({to:e,replace:t,state:n,relative:r}){Ge(Ds(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Dr);rn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(gr),{pathname:i}=ma(),s=Ri(),c=Xf(e,Gf(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function nG(e){return FY(e.context)}function Yo(e){Ge(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rG({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Ge(!Ds(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=Za(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:f="default"}=n,p=g.useMemo(()=>{let y=Ir(c,i);return y==null?null:{location:{pathname:y,search:l,hash:u,state:d,key:f},navigationType:r}},[i,c,l,u,d,f,r]);return rn(p!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:g.createElement(Dr.Provider,{value:s},g.createElement(ep.Provider,{children:t,value:p}))}function qv(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,qv(r.props.children,o));return}Ge(r.type===Yo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ge(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=qv(r.props.children,o)),n.push(i)}),n}var aG=qv,tp="get",np="application/x-www-form-urlencoded";function rp(e){return e!=null&&typeof e.tagName=="string"}function oG(e){return rp(e)&&e.tagName.toLowerCase()==="button"}function iG(e){return rp(e)&&e.tagName.toLowerCase()==="form"}function sG(e){return rp(e)&&e.tagName.toLowerCase()==="input"}function cG(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function lG(e,t){return e.button===0&&(!t||t==="_self")&&!cG(e)}var ap=null;function uG(){if(ap===null)try{new FormData(document.createElement("form"),0),ap=!1}catch{ap=!0}return ap}var dG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kv(e){return e!=null&&!dG.has(e)?(rn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${np}"`),null):e}function fG(e,t){let n,r,a,o,i;if(iG(e)){let s=e.getAttribute("action");r=s?Ir(s,t):null,n=e.getAttribute("method")||tp,a=Kv(e.getAttribute("enctype"))||np,o=new FormData(e)}else if(oG(e)||sG(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Ir(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||tp,a=Kv(e.getAttribute("formenctype"))||Kv(s.getAttribute("enctype"))||np,o=new FormData(s,e),!uG()){let{name:l,type:u,value:d}=e;if(u==="image"){let f=l?`${l}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else l&&o.append(l,d)}}else{if(rp(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=tp,r=null,a=np,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function Yv(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function pG(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function hG(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function mG(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await pG(o,n);return i.links?i.links():[]}return[]}));return bG(r.flat(1).filter(hG).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function yP(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function yG(e,t){return gG(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function gG(e){return[...new Set(e)]}function vG(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function bG(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(vG(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function wG(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function xG(){let e=g.useContext(Ii);return Yv(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function _G(){let e=g.useContext(Zl);return Yv(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Gv=g.createContext(void 0);Gv.displayName="FrameworkContext";function gP(){let e=g.useContext(Gv);return Yv(e,"You must render this element inside a <HydratedRouter> element"),e}function jG(e,t){let n=g.useContext(Gv),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(m,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[r]);let p=()=>{a(!0)},y=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,f,{}]:[o,f,{onFocus:Ql(s,p),onBlur:Ql(c,y),onMouseEnter:Ql(l,p),onMouseLeave:Ql(u,y),onTouchStart:Ql(d,p)}]:[!1,f,{}]}function Ql(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function SG({page:e,...t}){let{router:n}=xG(),r=g.useMemo(()=>qo(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(OG,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function EG(e){let{manifest:t,routeModules:n}=gP(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return mG(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function OG({page:e,matches:t,...n}){let r=ma(),{manifest:a,routeModules:o}=gP(),{loaderData:i,matches:s}=_G(),c=g.useMemo(()=>yP(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>yP(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let p=new Set,y=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?y=!0:p.add(v.route.id))}),p.size===0)return[];let m=wG(e);return y&&p.size>0&&m.searchParams.set("_routes",t.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>yG(l,a),[l,a]),f=EG(l);return g.createElement(g.Fragment,null,u.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:y})=>g.createElement("link",{key:p,...y})))}function CG(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var vP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vP&&(window.__reactRouterVersion="7.0.2")}catch{}function bP(e,t){return UM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:zK({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||wP(),routes:e,mapRouteProperties:mP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function NG(e,t){return UM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:VK({window:t==null?void 0:t.window}),hydrationData:wP(),routes:e,mapRouteProperties:mP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function wP(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:MG(e.errors)}),e}function MG(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Zf(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var xP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xv=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=g.useContext(Dr),y=typeof c=="string"&&xP.test(c),m,v=!1;if(typeof c=="string"&&y&&(m=c,vP))try{let O=new URL(window.location.href),M=c.startsWith("//")?new URL(O.protocol+c):new URL(c),N=Ir(M.pathname,p);M.origin===O.origin&&N!=null?c=N+M.search+M.hash:v=!0}catch{rn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=DY(c,{relative:r}),[w,_,x]=jG(n,d),j=TG(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(O){e&&e(O),O.defaultPrevented||j(O)}let E=g.createElement("a",{...d,...x,href:m||b,onClick:v||a?e:S,ref:CG(f,_),target:s,"data-discover":!y&&t==="render"?"true":void 0});return w&&!y?g.createElement(g.Fragment,null,E,g.createElement(SG,{page:b})):E});Xv.displayName="Link";var PG=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=Jl(o,{relative:c.relative}),d=ma(),f=g.useContext(Zl),{navigator:p,basename:y}=g.useContext(Dr),m=f!=null&&$G(u)&&i===!0,v=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&y&&(w=Ir(w,y)||w);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",j=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:x,isPending:j,isTransitioning:m},E=x?e:void 0,O;typeof n=="function"?O=n(S):O=[n,x?"active":null,j?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(S):a;return g.createElement(Xv,{...c,"aria-current":E,className:O,ref:l,style:M,to:o,viewTransition:i},typeof s=="function"?s(S):s)});PG.displayName="NavLink";var kG=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=tp,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let y=DG(),m=LG(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&xP.test(s),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,j=(x==null?void 0:x.getAttribute("formmethod"))||i;y(x||_.currentTarget,{fetcherKey:t,method:j,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:p,method:v,action:m,onSubmit:r?c:w,...f,"data-discover":!b&&e==="render"?"true":void 0})});kG.displayName="Form";function AG(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _P(e){let t=g.useContext(Ii);return Ge(t,AG(e)),t}function TG(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=Ri(),c=ma(),l=Jl(e,{relative:o});return g.useCallback(u=>{if(lG(u,t)){u.preventDefault();let d=n!==void 0?n:Xa(c)===Xa(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var IG=0,RG=()=>`__${String(++IG)}__`;function DG(){let{router:e}=_P("useSubmit"),{basename:t}=g.useContext(Dr),n=GY();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=fG(r,t);if(a.navigate===!1){let u=a.fetcherKey||RG();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function LG(e,{relative:t}={}){let{basename:n}=g.useContext(Dr),r=g.useContext(gr);Ge(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...Jl(e||".",{relative:t})},i=ma();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:ha([n,o.pathname])),Xa(o)}function $G(e,t={}){let n=g.useContext(Vv);Ge(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=_P("useViewTransitionState"),a=Jl(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Ir(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Ir(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Yf(a.pathname,i)!=null||Yf(a.pathname,o)!=null}new TextEncoder;function FG(e){return g.createElement(JY,{flushSync:Nl.flushSync,...e})}var BG=pAe.useId||(()=>{}),zG=0;Pt=function(e){const[t,n]=g.useState(BG());return en(()=>{e||n(r=>r??String(zG++))},[e]),e||(t?`radix-${t}`:"")};var Zv="Collapsible",[VG,jP]=er(Zv),[UG,Jv]=VG(Zv),SP=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Sn({prop:r,defaultProp:a,onChange:i});return h.jsx(UG,{scope:n,disabled:o,contentId:Pt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Ae.div,{"data-state":n0(c),"data-disabled":o?"":void 0,...s,ref:t})})});SP.displayName=Zv;var EP="CollapsibleTrigger",Qv=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Jv(EP,n);return h.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":n0(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});Qv.displayName=EP;var e0="CollapsibleContent",t0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Jv(e0,e.__scopeCollapsible);return h.jsx(Mr,{present:n||a.open,children:({present:o})=>h.jsx(WG,{...r,ref:t,present:o})})});t0.displayName=e0;var WG=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=Jv(e0,n),[s,c]=g.useState(r),l=g.useRef(null),u=wt(t,l),d=g.useRef(0),f=d.current,p=g.useRef(0),y=p.current,m=i.open||s,v=g.useRef(m),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),en(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();d.current=_.height,p.current=_.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Ae.div,{"data-state":n0(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...o,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:m&&a})});function n0(e){return e?"open":"closed"}var OP=SP,HG=Qv,qG=t0;const KG=OP,YG=Qv,GG=t0,r0=768;function XG(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${r0-1}px)`),r=()=>{t(window.innerWidth<r0)};return n.addEventListener("change",r),t(window.innerWidth<r0),()=>n.removeEventListener("change",r)},[]),!!e}let eu;eu=Wa("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ut=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?Vo:"button";return h.jsx(i,{className:G(eu({variant:t,size:n,className:e})),ref:o,...a})}),ut.displayName="Button";const En=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:G("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));En.displayName="Input";var ZG="Separator",CP="horizontal",JG=["horizontal","vertical"],NP=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=CP,...a}=e,o=QG(r)?r:CP,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Ae.div,{"data-orientation":o,...i,...a,ref:t})});NP.displayName=ZG;function QG(e){return JG.includes(e)}Zg=NP,Ms=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Zg,{ref:a,decorative:n,orientation:t,className:G("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Ms.displayName=Zg.displayName;var a0="focusScope.autoFocusOnMount",o0="focusScope.autoFocusOnUnmount",MP={bubbles:!1,cancelable:!0},eX="FocusScope",op=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),f=wt(t,m=>c(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:Go(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||Go(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&Go(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){AP.add(p);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(a0,MP);s.addEventListener(a0,l),s.dispatchEvent(v),v.defaultPrevented||(tX(iX(PP(s)),{select:!0}),document.activeElement===m&&Go(s))}return()=>{s.removeEventListener(a0,l),setTimeout(()=>{const v=new CustomEvent(o0,MP);s.addEventListener(o0,u),s.dispatchEvent(v),v.defaultPrevented||Go(m??document.body,{select:!0}),s.removeEventListener(o0,u),AP.remove(p)},0)}}},[s,l,u,p]);const y=g.useCallback(m=>{if(!n&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=nX(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&Go(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&Go(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,p.paused]);return h.jsx(Ae.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});op.displayName=eX;function tX(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Go(r,{select:t}),document.activeElement!==n)return}function nX(e){const t=PP(e),n=kP(t,e),r=kP(t.reverse(),e);return[n,r]}function PP(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function kP(e,t){for(const n of e)if(!rX(n,{upTo:t}))return n}function rX(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function aX(e){return e instanceof HTMLInputElement&&"select"in e}function Go(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&aX(e)&&t&&e.select()}}var AP=oX();function oX(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=TP(e,t),e.unshift(t)},remove(t){var n;e=TP(e,t),(n=e[0])==null||n.resume()}}}function TP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function iX(e){return e.filter(t=>t.tagName!=="A")}var i0=0;Ul=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??IP()),document.body.insertAdjacentElement("beforeend",e[1]??IP()),i0++,()=>{i0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),i0--}},[])};function IP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}yn=function(){return yn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},yn.apply(this,arguments)},Vf=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},yv=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var ip="right-scroll-bar-position",sp="width-before-scroll-bar",sX="with-scroll-bars-hidden",cX="--removed-body-scroll-bar-size";function s0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function lX(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var uX=typeof window<"u"?g.useLayoutEffect:g.useEffect,RP=new WeakMap;function dX(e,t){var n=lX(null,function(r){return e.forEach(function(a){return s0(a,r)})});return uX(function(){var r=RP.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||s0(s,null)}),o.forEach(function(s){a.has(s)||s0(s,i)})}RP.set(n,e)},[e]),n}function fX(e){return e}function pX(e,t){t===void 0&&(t=fX);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}hv=function(e){e===void 0&&(e={});var t=pX(null);return t.options=yn({async:!0,ssr:!1},e),t};var DP=function(e){var t=e.sideCar,n=Vf(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,yn({},n))};DP.isSideCarExport=!0,gv=function(e,t){return e.useMedium(t),DP};var LP=hv(),c0=function(){},cp=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:c0,onWheelCapture:c0,onTouchMoveCapture:c0}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Vf(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,j=dX([n,t]),S=yn(yn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:LP,removeScrollBar:l,shards:d,noIsolation:p,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),yn(yn({},S),{ref:j})):g.createElement(b,yn({},S,{className:c,ref:j}),s))});cp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},cp.classNames={fullWidth:sp,zeroRight:ip},mv=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function hX(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=mv();return t&&e.setAttribute("nonce",t),e}function mX(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function yX(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let $P,FP,BP,lp,zP,VP,UP,Di,WP,l0,HP,qP,up;if($P=function(){var e=0,t=null;return{add:function(n){e==0&&(t=hX())&&(mX(t,n),yX(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},FP=function(){var e=$P();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Uf=function(){var e=FP(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},BP={left:0,top:0,right:0,gap:0},lp=function(e){return parseInt(e||"",10)||0},zP=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[lp(n),lp(r),lp(a)]},VP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return BP;var t=zP(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},UP=Uf(),Di="data-scroll-locked",WP=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(sX,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Di,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ip,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(sp,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(ip," .").concat(ip,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(sp," .").concat(sp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Di,`] {
    `).concat(cX,": ").concat(s,`px;
  }
`)},l0=function(){var e=parseInt(document.body.getAttribute(Di)||"0",10);return isFinite(e)?e:0},HP=function(){g.useEffect(function(){return document.body.setAttribute(Di,(l0()+1).toString()),function(){var e=l0()-1;e<=0?document.body.removeAttribute(Di):document.body.setAttribute(Di,e.toString())}},[])},qP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;HP();var o=g.useMemo(function(){return VP(a)},[a]);return g.createElement(UP,{styles:WP(o,!t,a,n?"":"!important")})},up=!1,typeof window<"u")try{var dp=Object.defineProperty({},"passive",{get:function(){return up=!0,!0}});window.addEventListener("test",dp,dp),window.removeEventListener("test",dp,dp)}catch{up=!1}var Ls=up?{passive:!1}:!1,gX=function(e){return e.tagName==="TEXTAREA"},KP=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!gX(e)&&n[t]==="visible")},vX=function(e){return KP(e,"overflowY")},bX=function(e){return KP(e,"overflowX")},YP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=GP(e,r);if(a){var o=XP(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},wX=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},xX=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},GP=function(e,t){return e==="v"?vX(t):bX(t)},XP=function(e,t){return e==="v"?wX(t):xX(t)},_X=function(e,t){return e==="h"&&t==="rtl"?-1:1},jX=function(e,t,n,r,a){var o=_X(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=XP(e,s),y=p[0],m=p[1],v=p[2],b=m-v-o*y;(y||b)&&GP(e,s)&&(d+=b,f+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},fp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ZP=function(e){return[e.deltaX,e.deltaY]},JP=function(e){return e&&"current"in e?e.current:e},SX=function(e,t){return e[0]===t[0]&&e[1]===t[1]},EX=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},OX=0,$s=[];function CX(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(OX++)[0],o=g.useState(Uf)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=yv([e.lockRef.current],(e.shards||[]).map(JP),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=fp(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=YP(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=YP(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var M=r.current||j;return jX(M,v,m,M==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!$s.length||$s[$s.length-1]!==o)){var b="deltaY"in v?ZP(v):fp(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&SX(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(JP).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:NX(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=fp(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,ZP(m),m.target,s(m,e.lockRef.current))},[]),f=g.useCallback(function(m){l(m.type,fp(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return $s.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Ls),document.addEventListener("touchmove",c,Ls),document.addEventListener("touchstart",u,Ls),function(){$s=$s.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Ls),document.removeEventListener("touchmove",c,Ls),document.removeEventListener("touchstart",u,Ls)}},[]);var p=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:EX(a)}):null,p?g.createElement(qP,{gapMode:e.gapMode}):null)}function NX(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const MX=gv(LP,CX);var pp=g.forwardRef(function(e,t){return g.createElement(cp,yn({},e,{ref:t,sideCar:MX}))});pp.classNames=cp.classNames;let QP,Li,tu,nu,hp,u0,ek,tk,mp,d0,f0,nk,vr,p0;QP=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Li=new WeakMap,tu=new WeakMap,nu={},hp=0,u0=function(e){return e&&(e.host||u0(e.parentNode))},ek=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=u0(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},tk=function(e,t,n,r){var a=ek(t,Array.isArray(e)?e:[e]);nu[n]||(nu[n]=new WeakMap);var o=nu[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))u(f);else try{var p=f.getAttribute(r),y=p!==null&&p!=="false",m=(Li.get(f)||0)+1,v=(o.get(f)||0)+1;Li.set(f,m),o.set(f,v),i.push(f),m===1&&y&&tu.set(f,!0),v===1&&f.setAttribute(n,"true"),y||f.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),s.clear(),hp++,function(){i.forEach(function(d){var f=Li.get(d)-1,p=o.get(d)-1;Li.set(d,f),o.set(d,p),f||(tu.has(d)||d.removeAttribute(r),tu.delete(d)),p||d.removeAttribute(n)}),hp--,hp||(Li=new WeakMap,Li=new WeakMap,tu=new WeakMap,nu={})}},Vl=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=QP(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),tk(r,a,n,"aria-hidden")):function(){return null}},mp="Dialog",[d0,f0]=er(mp),[nk,vr]=d0(mp),p0=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(nk,{scope:t,triggerRef:s,contentRef:c,contentId:Pt(),titleId:Pt(),descriptionId:Pt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},p0.displayName=mp;var rk="DialogTrigger",ak=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(rk,n),o=wt(t,a.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":y0(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});ak.displayName=rk;var h0="DialogPortal",[PX,ok]=d0(h0,{forceMount:void 0}),ik=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=vr(h0,t);return h.jsx(PX,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:i})}))})};ik.displayName=h0;var yp="DialogOverlay",sk=g.forwardRef((e,t)=>{const n=ok(yp,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr(yp,e.__scopeDialog);return o.modal?h.jsx(Mr,{present:r||o.open,children:h.jsx(kX,{...a,ref:t})}):null});sk.displayName=yp;var kX=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(yp,n);return h.jsx(pp,{as:Vo,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Ae.div,{"data-state":y0(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),$i="DialogContent",ck=g.forwardRef((e,t)=>{const n=ok($i,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr($i,e.__scopeDialog);return h.jsx(Mr,{present:r||o.open,children:o.modal?h.jsx(AX,{...a,ref:t}):h.jsx(TX,{...a,ref:t})})});ck.displayName=$i;var AX=g.forwardRef((e,t)=>{const n=vr($i,e.__scopeDialog),r=g.useRef(null),a=wt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return Vl(o)},[]),h.jsx(lk,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),TX=g.forwardRef((e,t)=>{const n=vr($i,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(lk,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),lk=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=vr($i,n),c=g.useRef(null),l=wt(t,c);return Ul(),h.jsxs(h.Fragment,{children:[h.jsx(op,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(Og,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":y0(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(yk,{titleId:s.titleId}),h.jsx(vk,{contentRef:c,descriptionId:s.descriptionId})]})]})}),m0="DialogTitle",uk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(m0,n);return h.jsx(Ae.h2,{id:a.titleId,...r,ref:t})});uk.displayName=m0;var dk="DialogDescription",fk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(dk,n);return h.jsx(Ae.p,{id:a.descriptionId,...r,ref:t})});fk.displayName=dk;var pk="DialogClose",hk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(pk,n);return h.jsx(Ae.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});hk.displayName=pk;function y0(e){return e?"open":"closed"}let g0,mk,v0,yk,gk,vk,bk;g0="DialogTitleWarning",[mk,v0]=hAe(g0,{contentName:$i,titleName:m0,docsSlug:"dialog"}),yk=({titleId:e})=>{const t=v0(g0),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},gk="DialogDescriptionWarning",vk=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${v0(gk).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Dl=p0,bk=ak,Ll=ik,Mi=sk,Pi=ck,Os=uk,Cs=fk,$l=hk;const IX=Dl,RX=Ll,wk=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));wk.displayName=Mi.displayName;const DX=Wa("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),xk=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(RX,{children:[h.jsx(wk,{}),h.jsxs(Pi,{ref:a,className:G(DX({side:e}),t),...r,children:[n,h.jsxs($l,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xk.displayName=Pi.displayName;const LX=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:G("text-lg font-semibold text-foreground",e),...t}));LX.displayName=Os.displayName;const $X=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));$X.displayName=Cs.displayName;function _k({className:e,...t}){return h.jsx("div",{className:G("animate-pulse rounded-md bg-muted",e),...t})}const FX=["top","right","bottom","left"],ya=Math.min,or=Math.max,gp=Math.round,vp=Math.floor,Xo=e=>({x:e,y:e}),BX={left:"right",right:"left",bottom:"top",top:"bottom"},zX={start:"end",end:"start"};function b0(e,t,n){return or(e,ya(t,n))}function Ja(e,t){return typeof e=="function"?e(t):e}function Qa(e){return e.split("-")[0]}function Fs(e){return e.split("-")[1]}function w0(e){return e==="x"?"y":"x"}function x0(e){return e==="y"?"height":"width"}function Zo(e){return["top","bottom"].includes(Qa(e))?"y":"x"}function _0(e){return w0(Zo(e))}function VX(e,t,n){n===void 0&&(n=!1);const r=Fs(e),a=_0(e),o=x0(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=bp(i)),[i,bp(i)]}function UX(e){const t=bp(e);return[j0(e),t,j0(t)]}function j0(e){return e.replace(/start|end/g,t=>zX[t])}function WX(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function HX(e,t,n,r){const a=Fs(e);let o=WX(Qa(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(j0)))),o}function bp(e){return e.replace(/left|right|bottom|top/g,t=>BX[t])}function qX(e){return{top:0,right:0,bottom:0,left:0,...e}}function jk(e){return typeof e!="number"?qX(e):{top:e,right:e,bottom:e,left:e}}function wp(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Sk(e,t,n){let{reference:r,floating:a}=e;const o=Zo(t),i=_0(t),s=x0(i),c=Qa(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,f=r[s]/2-a[s]/2;let p;switch(c){case"top":p={x:u,y:r.y-a.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-a.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Fs(t)){case"start":p[i]-=f*(n&&l?-1:1);break;case"end":p[i]+=f*(n&&l?-1:1);break}return p}const KX=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=Sk(l,r,c),f=r,p={},y=0;for(let m=0;m<s.length;m++){const{name:v,fn:b}=s[m],{x:w,y:_,data:x,reset:j}=await b({x:u,y:d,initialPlacement:r,placement:f,strategy:a,middlewareData:p,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=_??d,p={...p,[v]:{...p[v],...x}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(l=j.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):j.rects),{x:u,y:d}=Sk(l,f,c)),m=-1)}return{x:u,y:d,placement:f,strategy:a,middlewareData:p}};async function ru(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=Ja(t,e),y=jk(p),m=s[f?d==="floating"?"reference":"floating":d],v=wp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(m)))==null||n?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),_=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=wp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+y.top)/_.y,bottom:(x.bottom-v.bottom+y.bottom)/_.y,left:(v.left-x.left+y.left)/_.x,right:(x.right-v.right+y.right)/_.x}}const YX=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=Ja(e,t)||{};if(l==null)return{};const d=jk(u),f={x:n,y:r},p=_0(a),y=x0(p),m=await i.getDimensions(l),v=p==="y",b=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",x=o.reference[y]+o.reference[p]-f[p]-o.floating[y],j=f[p]-o.reference[p],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=S?S[_]:0;(!E||!await(i.isElement==null?void 0:i.isElement(S)))&&(E=s.floating[_]||o.floating[y]);const O=x/2-j/2,M=E/2-m[y]/2-1,N=ya(d[b],M),P=ya(d[w],M),I=N,k=E-m[y]-P,C=E/2-m[y]/2+O,A=b0(I,C,k),T=!c.arrow&&Fs(a)!=null&&C!==A&&o.reference[y]/2-(C<I?N:P)-m[y]/2<0,D=T?C<I?C-I:C-k:0;return{[p]:f[p]+D,data:{[p]:A,centerOffset:C-A-D,...T&&{alignmentOffset:D}},reset:T}}}),GX=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=Ja(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=Qa(a),w=Zo(s),_=Qa(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),j=f||(_||!m?[bp(s)]:UX(s)),S=y!=="none";!f&&S&&j.push(...HX(s,m,y,x));const E=[s,...j],O=await ru(t,v),M=[];let N=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&M.push(O[b]),d){const C=VX(a,i,x);M.push(O[C[0]],O[C[1]])}if(N=[...N,{placement:a,overflows:M}],!M.every(C=>C<=0)){var P,I;const C=(((P=o.flip)==null?void 0:P.index)||0)+1,A=E[C];if(A)return{data:{index:C,overflows:N},reset:{placement:A}};let T=(I=N.filter(D=>D.overflows[0]<=0).sort((D,L)=>D.overflows[1]-L.overflows[1])[0])==null?void 0:I.placement;if(!T)switch(p){case"bestFit":{var k;const D=(k=N.filter(L=>{if(S){const R=Zo(L.placement);return R===w||R==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(R=>R>0).reduce((R,F)=>R+F,0)]).sort((L,R)=>L[1]-R[1])[0])==null?void 0:k[0];D&&(T=D);break}case"initialPlacement":T=s;break}if(a!==T)return{reset:{placement:T}}}return{}}}};function Ek(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Ok(e){return FX.some(t=>e[t]>=0)}const XX=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Ja(e,t);switch(r){case"referenceHidden":{const o=await ru(t,{...a,elementContext:"reference"}),i=Ek(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Ok(i)}}}case"escaped":{const o=await ru(t,{...a,altBoundary:!0}),i=Ek(o,n.floating);return{data:{escapedOffsets:i,escaped:Ok(i)}}}default:return{}}}}};async function ZX(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=Qa(n),s=Fs(n),c=Zo(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=Ja(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof y=="number"&&(p=s==="end"?y*-1:y),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}const JX=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await ZX(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},QX=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=Ja(e,t),l={x:n,y:r},u=await ru(t,c),d=Zo(Qa(a)),f=w0(d);let p=l[f],y=l[d];if(o){const v=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=p+u[v],_=p-u[b];p=b0(w,p,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=y+u[v],_=y-u[b];y=b0(w,y,_)}const m=s.fn({...t,[f]:p,[d]:y});return{...m,data:{x:m.x-n,y:m.y-r}}}}},eZ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=Ja(e,t),u={x:n,y:r},d=Zo(a),f=w0(d);let p=u[f],y=u[d];const m=Ja(s,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const _=f==="y"?"height":"width",x=o.reference[f]-o.floating[_]+v.mainAxis,j=o.reference[f]+o.reference[_]-v.mainAxis;p<x?p=x:p>j&&(p=j)}if(l){var b,w;const _=f==="y"?"width":"height",x=["top","left"].includes(Qa(a)),j=o.reference[d]-o.floating[_]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),S=o.reference[d]+o.reference[_]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);y<j?y=j:y>S&&(y=S)}return{[f]:p,[d]:y}}}},tZ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=Ja(e,t),c=await ru(t,s),l=Qa(n),u=Fs(n),d=Zo(n)==="y",{width:f,height:p}=r.floating;let y,m;l==="top"||l==="bottom"?(y=l,m=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(m=l,y=u==="end"?"top":"bottom");const v=p-c.top-c.bottom,b=f-c.left-c.right,w=ya(p-c[y],v),_=ya(f-c[m],b),x=!t.middlewareData.shift;let j=w,S=_;if(d?S=u||x?ya(_,b):b:j=u||x?ya(w,v):v,x&&!u){const O=or(c.left,0),M=or(c.right,0),N=or(c.top,0),P=or(c.bottom,0);d?S=f-2*(O!==0||M!==0?O+M:or(c.left,c.right)):j=p-2*(N!==0||P!==0?N+P:or(c.top,c.bottom))}await i({...t,availableWidth:S,availableHeight:j});const E=await a.getDimensions(o.floating);return f!==E.width||p!==E.height?{reset:{rects:!0}}:{}}}};function Bs(e){return Ck(e)?(e.nodeName||"").toLowerCase():"#document"}function ir(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function eo(e){var t;return(t=(Ck(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Ck(e){return e instanceof Node||e instanceof ir(e).Node}function Lr(e){return e instanceof Element||e instanceof ir(e).Element}function ga(e){return e instanceof HTMLElement||e instanceof ir(e).HTMLElement}function Nk(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ir(e).ShadowRoot}function au(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=$r(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function nZ(e){return["table","td","th"].includes(Bs(e))}function xp(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function S0(e){const t=E0(),n=Lr(e)?$r(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function rZ(e){let t=Jo(e);for(;ga(t)&&!zs(t);){if(S0(t))return t;if(xp(t))return null;t=Jo(t)}return null}function E0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function zs(e){return["html","body","#document"].includes(Bs(e))}function $r(e){return ir(e).getComputedStyle(e)}function _p(e){return Lr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Jo(e){if(Bs(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Nk(e)&&e.host||eo(e);return Nk(t)?t.host:t}function Mk(e){const t=Jo(e);return zs(t)?e.ownerDocument?e.ownerDocument.body:e.body:ga(t)&&au(t)?t:Mk(t)}function ou(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=Mk(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=ir(a);if(o){const s=O0(i);return t.concat(i,i.visualViewport||[],au(a)?a:[],s&&n?ou(s):[])}return t.concat(a,ou(a,[],n))}function O0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Pk(e){const t=$r(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=ga(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=gp(n)!==o||gp(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function C0(e){return Lr(e)?e:e.contextElement}function Vs(e){const t=C0(e);if(!ga(t))return Xo(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Pk(t);let i=(o?gp(n.width):n.width)/r,s=(o?gp(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const aZ=Xo(0);function kk(e){const t=ir(e);return!E0()||!t.visualViewport?aZ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function oZ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ir(e)?!1:t}function Fi(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=C0(e);let i=Xo(1);t&&(r?Lr(r)&&(i=Vs(r)):i=Vs(e));const s=oZ(o,n,r)?kk(o):Xo(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const f=ir(o),p=r&&Lr(r)?ir(r):r;let y=f,m=O0(y);for(;m&&r&&p!==y;){const v=Vs(m),b=m.getBoundingClientRect(),w=$r(m),_=b.left+(m.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(m.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=x,y=ir(m),m=O0(y)}}return wp({width:u,height:d,x:c,y:l})}function iZ(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=eo(r),s=t?xp(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=Xo(1);const u=Xo(0),d=ga(r);if((d||!d&&!o)&&((Bs(r)!=="body"||au(i))&&(c=_p(r)),ga(r))){const f=Fi(r);l=Vs(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function sZ(e){return Array.from(e.getClientRects())}function Ak(e){return Fi(eo(e)).left+_p(e).scrollLeft}function cZ(e){const t=eo(e),n=_p(e),r=e.ownerDocument.body,a=or(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=or(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+Ak(e);const s=-n.scrollTop;return $r(r).direction==="rtl"&&(i+=or(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function lZ(e,t){const n=ir(e),r=eo(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=E0();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function uZ(e,t){const n=Fi(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=ga(e)?Vs(e):Xo(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function Tk(e,t,n){let r;if(t==="viewport")r=lZ(e,n);else if(t==="document")r=cZ(eo(e));else if(Lr(t))r=uZ(t,n);else{const a=kk(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return wp(r)}function Ik(e,t){const n=Jo(e);return n===t||!Lr(n)||zs(n)?!1:$r(n).position==="fixed"||Ik(n,t)}function dZ(e,t){const n=t.get(e);if(n)return n;let r=ou(e,[],!1).filter(s=>Lr(s)&&Bs(s)!=="body"),a=null;const o=$r(e).position==="fixed";let i=o?Jo(e):e;for(;Lr(i)&&!zs(i);){const s=$r(i),c=S0(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||au(i)&&!c&&Ik(e,i))?r=r.filter(l=>l!==i):a=s,i=Jo(i)}return t.set(e,r),r}function fZ(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?xp(t)?[]:dZ(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=Tk(t,l,a);return c.top=or(u.top,c.top),c.right=ya(u.right,c.right),c.bottom=ya(u.bottom,c.bottom),c.left=or(u.left,c.left),c},Tk(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function pZ(e){const{width:t,height:n}=Pk(e);return{width:t,height:n}}function hZ(e,t,n){const r=ga(t),a=eo(t),o=n==="fixed",i=Fi(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=Xo(0);if(r||!r&&!o)if((Bs(t)!=="body"||au(a))&&(s=_p(t)),r){const d=Fi(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=Ak(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function N0(e){return $r(e).position==="static"}function Rk(e,t){return!ga(e)||$r(e).position==="fixed"?null:t?t(e):e.offsetParent}function Dk(e,t){const n=ir(e);if(xp(e))return n;if(!ga(e)){let a=Jo(e);for(;a&&!zs(a);){if(Lr(a)&&!N0(a))return a;a=Jo(a)}return n}let r=Rk(e,t);for(;r&&nZ(r)&&N0(r);)r=Rk(r,t);return r&&zs(r)&&N0(r)&&!S0(r)?n:r||rZ(e)||n}const mZ=async function(e){const t=this.getOffsetParent||Dk,n=this.getDimensions,r=await n(e.floating);return{reference:hZ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function yZ(e){return $r(e).direction==="rtl"}const gZ={convertOffsetParentRelativeRectToViewportRelativeRect:iZ,getDocumentElement:eo,getClippingRect:fZ,getOffsetParent:Dk,getElementRects:mZ,getClientRects:sZ,getDimensions:pZ,getScale:Vs,isElement:Lr,isRTL:yZ};function vZ(e,t){let n=null,r;const a=eo(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const p=vp(u),y=vp(a.clientWidth-(l+d)),m=vp(a.clientHeight-(u+f)),v=vp(l),b={rootMargin:-p+"px "+-y+"px "+-m+"px "+-v+"px",threshold:or(0,ya(1,c))||1};let w=!0;function _(x){const j=x[0].intersectionRatio;if(j!==c){if(!w)return i();j?i(!1,j):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),o}Rg=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=C0(e),u=a||o?[...l?ou(l):[],...ou(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?vZ(l,n):null;let f=-1,p=null;i&&(p=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=p)==null||_.observe(t)})),n()}),l&&!c&&p.observe(l),p.observe(t));let y,m=c?Fi(e):null;c&&v();function v(){const b=Fi(e);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&n(),m=b,y=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=p)==null||b.disconnect(),p=null,c&&cancelAnimationFrame(y)}};let Lk;BN=JX,eM=QX,zN=GX,nM=tZ,Lk=XX,Jg=YX,tM=eZ,VN=(e,t,n)=>{const r=new Map,a={platform:gZ,...n},o={...a.platform,_c:r};return KX(e,t,{...a,platform:o})};var jp=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Sp(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Sp(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Sp(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function $k(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Fk(e,t){const n=$k(e);return Math.round(t*n)/n}function Bk(e){const t=g.useRef(e);return jp(()=>{t.current=e}),t}Gg=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=g.useState(r);Sp(f,r)||p(r);const[y,m]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(D=>{D!==S.current&&(S.current=D,m(D))},[]),_=g.useCallback(D=>{D!==E.current&&(E.current=D,b(D))},[]),x=o||y,j=i||v,S=g.useRef(null),E=g.useRef(null),O=g.useRef(u),M=c!=null,N=Bk(c),P=Bk(a),I=g.useCallback(()=>{if(!S.current||!E.current)return;const D={placement:t,strategy:n,middleware:f};P.current&&(D.platform=P.current),VN(S.current,E.current,D).then(L=>{const R={...L,isPositioned:!0};k.current&&!Sp(O.current,R)&&(O.current=R,Nl.flushSync(()=>{d(R)}))})},[f,t,n,P]);jp(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const k=g.useRef(!1);jp(()=>(k.current=!0,()=>{k.current=!1}),[]),jp(()=>{if(x&&(S.current=x),j&&(E.current=j),x&&j){if(N.current)return N.current(x,j,I);I()}},[x,j,I,N,M]);const C=g.useMemo(()=>({reference:S,floating:E,setReference:w,setFloating:_}),[w,_]),A=g.useMemo(()=>({reference:x,floating:j}),[x,j]),T=g.useMemo(()=>{const D={position:n,left:0,top:0};if(!A.floating)return D;const L=Fk(A.floating,u.x),R=Fk(A.floating,u.y);return s?{...D,transform:"translate("+L+"px, "+R+"px)",...$k(A.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:R}},[n,s,A.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:I,refs:C,elements:A,floatingStyles:T}),[u,I,C,A,T])};let zk;zk=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Jg({element:r.current,padding:a}).fn(n):{}:r?Jg({element:r,padding:a}).fn(n):{}}}},Lg=(e,t)=>({...BN(e),options:[e,t]}),cv=(e,t)=>({...eM(e),options:[e,t]}),lv=(e,t)=>({...tM(e),options:[e,t]}),uv=(e,t)=>({...zN(e),options:[e,t]}),dv=(e,t)=>({...nM(e),options:[e,t]}),pv=(e,t)=>({...Lk(e),options:[e,t]}),fv=(e,t)=>({...zk(e),options:[e,t]});var bZ="Arrow",Vk=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Ae.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});Vk.displayName=bZ;var wZ=Vk;function xZ(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,_Z(a,...t)]}function _Z(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}zf=function(e){const[t,n]=g.useState(void 0);return en(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var M0="Popper",[Uk,Us]=xZ(M0),[jZ,Wk]=Uk(M0),Hk=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(jZ,{scope:t,anchor:r,onAnchorChange:a,children:n})};Hk.displayName=M0;var qk="PopperAnchor",Kk=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=Wk(qk,n),i=g.useRef(null),s=wt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Ae.div,{...a,ref:s})});Kk.displayName=qk;var P0="PopperContent",[SZ,EZ]=Uk(P0),Yk=g.forwardRef((e,t)=>{var Q,Y,q,X,te,B;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=e,v=Wk(P0,n),[b,w]=g.useState(null),_=wt(t,ce=>w(ce)),[x,j]=g.useState(null),S=zf(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:N,boundary:P.filter(CZ),altBoundary:I},{refs:C,floatingStyles:A,placement:T,isPositioned:D,middlewareData:L}=Gg({strategy:"fixed",placement:M,whileElementsMounted:(...ce)=>Rg(...ce,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Lg({mainAxis:a+O,alignmentAxis:i}),c&&cv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lv():void 0,...k}),c&&uv({...k}),dv({...k,apply:({elements:ce,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=ce.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&fv({element:x,padding:s}),NZ({arrowWidth:E,arrowHeight:O}),f&&pv({strategy:"referenceHidden",...k})]}),[R,F]=Zk(T),V=tr(y);en(()=>{D&&(V==null||V())},[D,V]);const $=(Q=L.arrow)==null?void 0:Q.x,U=(Y=L.arrow)==null?void 0:Y.y,z=((q=L.arrow)==null?void 0:q.centerOffset)!==0,[K,ne]=g.useState();return en(()=>{b&&ne(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...A,transform:D?A.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(te=L.transformOrigin)==null?void 0:te.y].join(" "),...((B=L.hide)==null?void 0:B.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(SZ,{scope:n,placedSide:R,onArrowChange:j,arrowX:$,arrowY:U,shouldHideArrow:z,children:h.jsx(Ae.div,{"data-side":R,"data-align":F,...m,ref:_,style:{...m.style,animation:D?void 0:"none"}})})})});Yk.displayName=P0;var Gk="PopperArrow",OZ={top:"bottom",right:"left",bottom:"top",left:"right"},Xk=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=EZ(Gk,n),o=OZ[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(wZ,{...r,ref:t,style:{...r.style,display:"block"}})})});Xk.displayName=Gk;function CZ(e){return e!==null}var NZ=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=Zk(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",y="";return c==="bottom"?(p=o?u:`${d}px`,y=`${-s}px`):c==="top"?(p=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,y=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,y=o?u:`${f}px`),{data:{x:p,y}}}});function Zk(e){const[t,n="center"]=e.split("-");return[t,n]}var Ep=Hk,k0=Kk,A0=Yk,T0=Xk,[Op,i2e]=er("Tooltip",[Us]),Cp=Us(),Jk="TooltipProvider",MZ=700,I0="tooltip.open",[PZ,R0]=Op(Jk),Qk=e=>{const{__scopeTooltip:t,delayDuration:n=MZ,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(PZ,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};Qk.displayName=Jk;var Np="Tooltip",[kZ,iu]=Op(Np),eA=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=R0(Np,e.__scopeTooltip),l=Cp(t),[u,d]=g.useState(null),f=Pt(),p=g.useRef(0),y=i??c.disableHoverableContent,m=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Sn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(I0))):c.onClose(),o==null||o(E)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),j=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),S=g.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},m)},[m,w]);return g.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),h.jsx(Ep,{...l,children:h.jsx(kZ,{scope:t,contentId:f,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?S():x()},[c.isOpenDelayed,S,x]),onTriggerLeave:g.useCallback(()=>{y?j():(window.clearTimeout(p.current),p.current=0)},[j,y]),onOpen:x,onClose:j,disableHoverableContent:y,children:n})})};eA.displayName=Np;var D0="TooltipTrigger",tA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=iu(D0,n),o=R0(D0,n),i=Cp(n),s=g.useRef(null),c=wt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(k0,{asChild:!0,...i,children:h.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});tA.displayName=D0;var L0="TooltipPortal",[AZ,TZ]=Op(L0,{forceMount:void 0}),nA=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=iu(L0,t);return h.jsx(AZ,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:r})})})};nA.displayName=L0;var Ws="TooltipContent",rA=g.forwardRef((e,t)=>{const n=TZ(Ws,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=iu(Ws,e.__scopeTooltip);return h.jsx(Mr,{present:r||i.open,children:i.disableHoverableContent?h.jsx(aA,{side:a,...o,ref:t}):h.jsx(IZ,{side:a,...o,ref:t})})}),IZ=g.forwardRef((e,t)=>{const n=iu(Ws,e.__scopeTooltip),r=R0(Ws,e.__scopeTooltip),a=g.useRef(null),o=wt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,f=g.useCallback(()=>{s(null),d(!1)},[d]),p=g.useCallback((y,m)=>{const v=y.currentTarget,b={x:y.clientX,y:y.clientY},w=$Z(b,v.getBoundingClientRect()),_=FZ(b,w),x=BZ(m.getBoundingClientRect()),j=VZ([..._,...x]);s(j),d(!0)},[d]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const y=v=>p(v,u),m=v=>p(v,c);return c.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[c,u,p,f]),g.useEffect(()=>{if(i){const y=m=>{const v=m.target,b={x:m.clientX,y:m.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!zZ(b,i);w?f():_&&(f(),l())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,u,i,l,f]),h.jsx(aA,{...e,ref:o})}),[RZ,DZ]=Op(Np,{isInside:!1}),aA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=iu(Ws,n),l=Cp(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(I0,u),()=>document.removeEventListener(I0,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=f=>{var p;(p=f.target)!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(A0,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(oK,{children:r}),h.jsx(RZ,{scope:n,isInside:!0,children:h.jsx(mAe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});rA.displayName=Ws;var oA="TooltipArrow",LZ=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Cp(n);return DZ(oA,n).isInside?null:h.jsx(T0,{...a,...r,ref:t})});LZ.displayName=oA;function $Z(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function FZ(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function BZ(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function zZ(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function VZ(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),UZ(t)}function UZ(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}UN=Qk,WN=eA,HN=tA,SK=nA,Fg=rA;const su=UN,va=WN,ba=HN,Fr=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Fg,{ref:r,sideOffset:t,className:G("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Fr.displayName=Fg.displayName;const WZ="sidebar:state",HZ=60*60*24*7,qZ="16rem",KZ="18rem",YZ="3rem",GZ="b",iA=g.createContext(null);function cu(){const e=g.useContext(iA);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const $0=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=XG(),[l,u]=g.useState(!1),[d,f]=g.useState(e),p=t??d,y=g.useCallback(w=>{const _=typeof w=="function"?w(p):w;n?n(_):f(_),document.cookie=`${WZ}=${_}; path=/; max-age=${HZ}`},[n,p]),m=g.useCallback(()=>c?u(w=>!w):y(w=>!w),[c,y,u]);g.useEffect(()=>{const w=_=>{_.key===GZ&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),m())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[m]);const v=p?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:p,setOpen:y,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:m}),[v,p,y,c,l,u,m]);return h.jsx(iA.Provider,{value:b,children:h.jsx(su,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":qZ,"--sidebar-width-icon":YZ,...a},className:G("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});$0.displayName="SidebarProvider";const F0=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=cu();return n==="none"?h.jsx("div",{className:G("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(IX,{open:l,onOpenChange:u,...o,children:h.jsx(xk,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":KZ},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:G("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:G("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});F0.displayName="Sidebar";const sA=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=cu();return h.jsx(ut,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:G("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(de,{size:32,name:"panel-left"})})});sA.displayName="SidebarTrigger";const cA=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=cu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:G("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});cA.displayName="SidebarRail";const B0=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:G("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));B0.displayName="SidebarInset";const XZ=g.forwardRef(({className:e,...t},n)=>h.jsx(En,{ref:n,"data-sidebar":"input",className:G("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));XZ.displayName="SidebarInput";const ZZ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:G("flex flex-col gap-2 p-2",e),...t}));ZZ.displayName="SidebarHeader";const lA=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:G("flex flex-col gap-2 p-2",e),...t}));lA.displayName="SidebarFooter";const JZ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ms,{ref:n,"data-sidebar":"separator",className:G("mx-2 w-auto bg-sidebar-border",e),...t}));JZ.displayName="SidebarSeparator";const z0=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:G("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));z0.displayName="SidebarContent";const lu=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:G("relative flex w-full min-w-0 flex-col p-2",e),...t}));lu.displayName="SidebarGroup";const uu=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Vo:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:G("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});uu.displayName="SidebarGroupLabel";const QZ=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Vo:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:G("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});QZ.displayName="SidebarGroupAction";const eJ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:G("w-full text-sm",e),...t}));eJ.displayName="SidebarGroupContent";const Hs=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:G("flex w-full min-w-0 flex-col gap-1",e),...t}));Hs.displayName="SidebarMenu";const to=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:G("group/menu-item relative",e),...t}));to.displayName="SidebarMenuItem";const tJ=Wa("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),no=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:o,...i},s)=>{const c=e?Vo:"button",{isMobile:l,state:u}=cu(),d=h.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:G(tJ({variant:n,size:r}),o),...i});return a?(typeof a=="string"&&(a={children:a}),h.jsxs(va,{children:[h.jsx(ba,{asChild:!0,children:d}),h.jsx(Fr,{side:"right",align:"center",hidden:u!=="collapsed"||l,...a})]})):d});no.displayName="SidebarMenuButton";const nJ=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?Vo:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:G("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});nJ.displayName="SidebarMenuAction";const rJ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:G("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));rJ.displayName="SidebarMenuBadge";const aJ=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:G("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(_k,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(_k,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});aJ.displayName="SidebarMenuSkeleton";const uA=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:G("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));uA.displayName="SidebarMenuSub";const dA=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));dA.displayName="SidebarMenuSubItem";const fA=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?Vo:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:G("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});fA.displayName="SidebarMenuSubButton";const oJ="hash",Mp={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},gn=(e,t)=>{let n=Mp[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},iJ=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function sJ({items:e}){const{t}=Pe("documents");return h.jsxs(lu,{children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(Hs,{children:e.map(n=>{var r;return h.jsx(KG,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(to,{children:[h.jsx(YG,{asChild:!0,children:h.jsxs(no,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(de,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(GG,{children:h.jsx(uA,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(dA,{className:"cursor-pointer",children:h.jsx(fA,{asChild:!0,children:h.jsx(Xv,{to:gn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const cJ=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,f=`${Math.random()*100}%`,p=Math.random()>.5?t.first:t.second,y=Math.random()*2,m=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${f}-${Date.now()}`,x:d,y:f,color:p,delay:y,scale:m,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(f=>f.lifespan<=0?s():{...f,lifespan:f.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:G("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(lJ,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),lJ=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(Af.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function uJ({className:e,onClick:t}){const{t:n}=Pe("sidebar");return h.jsxs(no,{className:G(e,"tw-w-full"),onClick:t,children:[h.jsx(de,{name:"frame"}),h.jsx(cJ,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const dJ=()=>{const[e,t]=g.useState(!1),n=Qe(i=>i.setCurrentSession),r=Qe(i=>i.createSession),a=Ml(i=>i.setSelectedSessionId),o=g.useCallback(async i=>{try{t(!0);const s=await r(i);n(s),a(s.id)}finally{t(!1)}},[r,n,a]);return{loading:e,createSession:o}},Qo=Dl,fJ=Ll,pA=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{ref:n,className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));pA.displayName=Mi.displayName;const ro=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(fJ,{children:[h.jsx(pA,{}),h.jsxs(Pi,{ref:r,className:G("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs($l,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ro.displayName=Pi.displayName;const ao=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ao.displayName="DialogHeader";const du=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});du.displayName="DialogFooter";const oo=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:G("text-lg font-semibold leading-none tracking-tight",e),...t}));oo.displayName=Os.displayName;const Pp=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));Pp.displayName=Cs.displayName;var pJ="Label",hA=g.forwardRef((e,t)=>h.jsx(Ae.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));hA.displayName=pJ;var mA=hA;let yA;yA=Wa("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),nt=g.forwardRef(({className:e,...t},n)=>h.jsx(mA,{ref:n,className:G(yA(),e),...t})),nt.displayName=mA.displayName;const hJ=Ha(()=>{const e=Yt(),{t}=Pe("dialogs"),[n,r]=g.useState(""),{toast:a}=tn(),{loading:o,createSession:i}=dJ(),s=l=>{r(l.target.value)},c=async()=>{try{await i({name:n}),r(""),e.hide()}catch{a({variant:"destructive",description:t("create_session.errors.create_failed")})}};return h.jsx(Qo,{open:e.visible,onOpenChange:e.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:t("create_session.title")}),h.jsx(Pp,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(En,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),mJ=()=>{const[e,t]=g.useState(!1),n=Qe(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([ue("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowEdge").delete(i.id)))),ue("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var gA="AlertDialog",[yJ,s2e]=er(gA,[f0]),io=f0(),vA=e=>{const{__scopeAlertDialog:t,...n}=e,r=io(t);return h.jsx(Dl,{...r,...n,modal:!0})};vA.displayName=gA;var gJ="AlertDialogTrigger",vJ=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(bk,{...a,...r,ref:t})});vJ.displayName=gJ;var bJ="AlertDialogPortal",bA=e=>{const{__scopeAlertDialog:t,...n}=e,r=io(t);return h.jsx(Ll,{...r,...n})};bA.displayName=bJ;var wJ="AlertDialogOverlay",wA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Mi,{...a,...r,ref:t})});wA.displayName=wJ;var qs="AlertDialogContent",[xJ,_J]=yJ(qs),xA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=io(n),i=g.useRef(null),s=wt(t,i),c=g.useRef(null);return h.jsx(mk,{contentName:qs,titleName:_A,docsSlug:"alert-dialog",children:h.jsx(xJ,{scope:n,cancelRef:c,children:h.jsxs(Pi,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(oK,{children:r}),h.jsx(MA,{contentRef:i})]})})})});xA.displayName=qs;var _A="AlertDialogTitle",jA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Os,{...a,...r,ref:t})});jA.displayName=_A;var SA="AlertDialogDescription",EA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Cs,{...a,...r,ref:t})});EA.displayName=SA;var jJ="AlertDialogAction",OA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx($l,{...a,...r,ref:t})});OA.displayName=jJ;var CA="AlertDialogCancel",NA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=_J(CA,n),o=io(n),i=wt(t,a);return h.jsx($l,{...o,...r,ref:i})});NA.displayName=CA;let MA;MA=({contentRef:e})=>{const t=`\`${qs}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qs}\` by passing a \`${SA}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qs}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},GN=vA,YN=bA,Ug=wA,Wg=xA,Kg=OA,Yg=NA,Hg=jA,qg=EA;const PA=GN,SJ=YN,kA=g.forwardRef(({className:e,...t},n)=>h.jsx(Ug,{className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));kA.displayName=Ug.displayName;const V0=g.forwardRef(({className:e,...t},n)=>h.jsxs(SJ,{children:[h.jsx(kA,{}),h.jsx(Wg,{ref:n,className:G("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));V0.displayName=Wg.displayName;const U0=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col space-y-2 text-center sm:text-left",e),...t});U0.displayName="AlertDialogHeader";const W0=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});W0.displayName="AlertDialogFooter";const H0=g.forwardRef(({className:e,...t},n)=>h.jsx(Hg,{ref:n,className:G("text-lg font-semibold",e),...t}));H0.displayName=Hg.displayName;const q0=g.forwardRef(({className:e,...t},n)=>h.jsx(qg,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));q0.displayName=qg.displayName;const K0=g.forwardRef(({className:e,...t},n)=>h.jsx(Kg,{ref:n,className:G(eu(),e),...t}));K0.displayName=Kg.displayName;const Y0=g.forwardRef(({className:e,...t},n)=>h.jsx(Yg,{ref:n,className:G(eu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Y0.displayName=Yg.displayName;const AA=Ha(({id:e})=>{const{t}=Pe("dialogs"),n=Yt(),{toast:r}=tn(),{deleteSession:a,loading:o}=mJ(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(PA,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(V0,{children:[h.jsxs(U0,{children:[h.jsx(H0,{children:t("delete_session.title")}),h.jsx(q0,{children:t("delete_session.description")})]}),h.jsxs(W0,{children:[h.jsx(Y0,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(K0,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function EJ({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ri(),o=Yt(hJ),i=Yt(AA),s=g.useCallback(()=>{o.show({})},[o]),c=g.useCallback((u,d)=>{u.preventDefault(),u.stopPropagation(),i.show({id:d})},[i]),l=u=>{n(u),a(gn("whiteboard",{sessionId:u.id}))};return h.jsxs(lu,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(Hs,{children:[h.jsx(to,{children:h.jsx(uJ,{onClick:s,className:"w-full"})}),e.map(u=>h.jsx(to,{className:"cursor-pointer",children:h.jsx(no,{asChild:!0,onClick:()=>l(u),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===u.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsx("span",{children:u.name})]}),h.jsx(de,{onClick:d=>c(d,u.id),size:16,name:"trash-2",className:"!z-50"})]})})},u.id)),e!=null&&e.length?h.jsx(to,{children:h.jsxs(no,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var OJ=g.createContext(void 0);Wo=function(e){const t=g.useContext(OJ);return e||t||"ltr"};function CJ(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,NJ(a,...t)]}function NJ(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let kp,TA,fu,Ap,G0,IA,RA,DA,LA,X0;kp="rovingFocusGroup.onEntryFocus",TA={bubbles:!1,cancelable:!0},fu="RovingFocusGroup",[Ap,G0,IA]=Tf(fu),[RA,Ka]=CJ(fu,[IA]),[DA,LA]=RA(fu),X0=g.forwardRef((e,t)=>h.jsx(Ap.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(Ap.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(MJ,{...e,ref:t})})})),X0.displayName=fu;var MJ=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,f=g.useRef(null),p=wt(t,f),y=Wo(o),[m=null,v]=Sn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),_=tr(l),x=G0(n),j=g.useRef(!1),[S,E]=g.useState(0);return g.useEffect(()=>{const O=f.current;if(O)return O.addEventListener(kp,_),()=>O.removeEventListener(kp,_)},[_]),h.jsx(DA,{scope:n,orientation:r,dir:y,loop:a,currentTabStopId:m,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx(Ae.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{j.current=!0}),onFocus:ge(e.onFocus,O=>{const M=!j.current;if(O.target===O.currentTarget&&M&&!b){const N=new CustomEvent(kp,TA);if(O.currentTarget.dispatchEvent(N),!N.defaultPrevented){const P=x().filter(A=>A.focusable),I=P.find(A=>A.active),k=P.find(A=>A.id===m),C=[I,k,...P].filter(Boolean).map(A=>A.ref.current);BA(C,u)}}j.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),$A="RovingFocusGroupItem",FA=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Pt(),c=o||s,l=LA($A,n),u=l.currentTabStopId===c,d=G0(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=l;return g.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),h.jsx(Ap.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Ae.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,y=>{r?l.onItemFocus(c):y.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){l.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const m=AJ(y,l.orientation,l.dir);if(m!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const b=v.indexOf(y.currentTarget);v=l.loop?TJ(v,b+1):v.slice(b+1)}setTimeout(()=>BA(v))}})})})});FA.displayName=$A;var PJ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function kJ(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function AJ(e,t,n){const r=kJ(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return PJ[r]}function BA(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function TJ(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let Tp,zA,Z0,VA,UA,WA,Ks,Ys,HA,qA,ei,Ip,Gs,J0,Q0,so,KA,Xs,eb;Fl=X0,Bl=FA,Tp=["Enter"," "],zA=["ArrowDown","PageUp","Home"],Z0=["ArrowUp","PageDown","End"],VA=[...zA,...Z0],UA={ltr:[...Tp,"ArrowRight"],rtl:[...Tp,"ArrowLeft"]},WA={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ks="Menu",[Ys,HA,qA]=Tf(Ks),[ei,Ip]=er(Ks,[qA,Us,Ka]),Gs=Us(),J0=Ka(),[Q0,so]=ei(Ks),[KA,Xs]=ei(Ks),eb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=Gs(t),[c,l]=g.useState(null),u=g.useRef(!1),d=tr(o),f=Wo(a);return g.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),h.jsx(Ep,{...s,children:h.jsx(Q0,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(KA,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:i,children:r})})})},eb.displayName=Ks;var IJ="MenuAnchor",tb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Gs(n);return h.jsx(k0,{...a,...r,ref:t})});tb.displayName=IJ;var nb="MenuPortal",[RJ,YA]=ei(nb,{forceMount:void 0}),GA=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=so(nb,t);return h.jsx(RJ,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:r})})})};GA.displayName=nb;var br="MenuContent",[DJ,rb]=ei(br),XA=g.forwardRef((e,t)=>{const n=YA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=so(br,e.__scopeMenu),i=Xs(br,e.__scopeMenu);return h.jsx(Ys.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Ys.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(LJ,{...a,ref:t}):h.jsx($J,{...a,ref:t})})})})}),LJ=g.forwardRef((e,t)=>{const n=so(br,e.__scopeMenu),r=g.useRef(null),a=wt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return Vl(o)},[]),h.jsx(ab,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),$J=g.forwardRef((e,t)=>{const n=so(br,e.__scopeMenu);return h.jsx(ab,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),ab=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:y,...m}=e,v=so(br,n),b=Xs(br,n),w=Gs(n),_=J0(n),x=HA(n),[j,S]=g.useState(null),E=g.useRef(null),O=wt(t,E,v.onContentChange),M=g.useRef(0),N=g.useRef(""),P=g.useRef(0),I=g.useRef(null),k=g.useRef("right"),C=g.useRef(0),A=y?pp:g.Fragment,T=y?{as:Vo,allowPinchZoom:!0}:void 0,D=R=>{var Q,Y;const F=N.current+R,V=x().filter(q=>!q.disabled),$=document.activeElement,U=(Q=V.find(q=>q.ref.current===$))==null?void 0:Q.textValue,z=V.map(q=>q.textValue),K=XJ(z,F,U),ne=(Y=V.find(q=>q.textValue===K))==null?void 0:Y.ref.current;(function q(X){N.current=X,window.clearTimeout(M.current),X!==""&&(M.current=window.setTimeout(()=>q(""),1e3))})(F),ne&&setTimeout(()=>ne.focus())};g.useEffect(()=>()=>window.clearTimeout(M.current),[]),Ul();const L=g.useCallback(R=>{var F,V;return k.current===((F=I.current)==null?void 0:F.side)&&JJ(R,(V=I.current)==null?void 0:V.area)},[]);return h.jsx(DJ,{scope:n,searchRef:N,onItemEnter:g.useCallback(R=>{L(R)&&R.preventDefault()},[L]),onItemLeave:g.useCallback(R=>{var F;L(R)||((F=E.current)==null||F.focus(),S(null))},[L]),onTriggerLeave:g.useCallback(R=>{L(R)&&R.preventDefault()},[L]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(R=>{I.current=R},[]),children:h.jsx(A,{...T,children:h.jsx(op,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,R=>{var F;R.preventDefault(),(F=E.current)==null||F.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(Fl,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:S,onEntryFocus:ge(c,R=>{b.isUsingKeyboardRef.current||R.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(A0,{role:"menu","aria-orientation":"vertical","data-state":h2(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...m,ref:O,style:{outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,R=>{const F=R.target.closest("[data-radix-menu-content]")===R.currentTarget,V=R.ctrlKey||R.altKey||R.metaKey,$=R.key.length===1;F&&(R.key==="Tab"&&R.preventDefault(),!V&&$&&D(R.key));const U=E.current;if(R.target!==U||!VA.includes(R.key))return;R.preventDefault();const z=x().filter(K=>!K.disabled).map(K=>K.ref.current);Z0.includes(R.key)&&z.reverse(),YJ(z)}),onBlur:ge(e.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(M.current),N.current="")}),onPointerMove:ge(e.onPointerMove,hu(R=>{const F=R.target,V=C.current!==R.clientX;if(R.currentTarget.contains(F)&&V){const $=R.clientX>C.current?"right":"left";k.current=$,C.current=R.clientX}}))})})})})})})});XA.displayName=br;var FJ="MenuGroup",ob=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"group",...r,ref:t})});ob.displayName=FJ;var BJ="MenuLabel",ZA=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{...r,ref:t})});ZA.displayName=BJ;var Rp="MenuItem",JA="menu.itemSelect",Dp=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=Xs(Rp,e.__scopeMenu),s=rb(Rp,e.__scopeMenu),c=wt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const f=new CustomEvent(JA,{bubbles:!0,cancelable:!0});d.addEventListener(JA,p=>r==null?void 0:r(p),{once:!0}),yAe(d,f),f.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(QA,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var f;(f=e.onPointerDown)==null||f.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var f;l.current||((f=d.currentTarget)==null||f.click())}),onKeyDown:ge(e.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||Tp.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Dp.displayName=Rp;var QA=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=rb(Rp,n),s=J0(n),c=g.useRef(null),l=wt(t,c),[u,d]=g.useState(!1),[f,p]=g.useState("");return g.useEffect(()=>{const y=c.current;y&&p((y.textContent??"").trim())},[o.children]),h.jsx(Ys.ItemSlot,{scope:n,disabled:r,textValue:a??f,children:h.jsx(Bl,{asChild:!0,...s,focusable:!r,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,hu(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,hu(y=>i.onItemLeave(y))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),zJ="MenuCheckboxItem",e2=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(o2,{scope:e.__scopeMenu,checked:n,children:h.jsx(Dp,{role:"menuitemcheckbox","aria-checked":Lp(n)?"mixed":n,...a,ref:t,"data-state":cb(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(Lp(n)?!0:!n),{checkForDefaultPrevented:!1})})})});e2.displayName=zJ;var t2="MenuRadioGroup",[VJ,UJ]=ei(t2,{value:void 0,onValueChange:()=>{}}),n2=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=tr(r);return h.jsx(VJ,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(ob,{...a,ref:t})})});n2.displayName=t2;var r2="MenuRadioItem",a2=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=UJ(r2,e.__scopeMenu),o=n===a.value;return h.jsx(o2,{scope:e.__scopeMenu,checked:o,children:h.jsx(Dp,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":cb(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});a2.displayName=r2;var ib="MenuItemIndicator",[o2,WJ]=ei(ib,{checked:!1}),i2=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=WJ(ib,n);return h.jsx(Mr,{present:r||Lp(o.checked)||o.checked===!0,children:h.jsx(Ae.span,{...a,ref:t,"data-state":cb(o.checked)})})});i2.displayName=ib;var HJ="MenuSeparator",s2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});s2.displayName=HJ;var qJ="MenuArrow",c2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Gs(n);return h.jsx(T0,{...a,...r,ref:t})});c2.displayName=qJ;var sb="MenuSub",[KJ,l2]=ei(sb),u2=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=so(sb,t),i=Gs(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=tr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(Ep,{...i,children:h.jsx(Q0,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(KJ,{scope:t,contentId:Pt(),triggerId:Pt(),trigger:s,onTriggerChange:c,children:n})})})};u2.displayName=sb;var pu="MenuSubTrigger",d2=g.forwardRef((e,t)=>{const n=so(pu,e.__scopeMenu),r=Xs(pu,e.__scopeMenu),a=l2(pu,e.__scopeMenu),o=rb(pu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(tb,{asChild:!0,...l,children:h.jsx(QA,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":h2(n.open),...e,ref:iK(t,a.onTriggerChange),onClick:d=>{var f;(f=e.onClick)==null||f.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,hu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,hu(d=>{var p,y;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const m=(y=n.content)==null?void 0:y.dataset.side,v=m==="right",b=v?-5:5,w=f[v?"left":"right"],_=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x:w,y:f.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var p;const f=o.searchRef.current!=="";e.disabled||f&&d.key===" "||UA[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});d2.displayName=pu;var f2="MenuSubContent",p2=g.forwardRef((e,t)=>{const n=YA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=so(br,e.__scopeMenu),i=Xs(br,e.__scopeMenu),s=l2(f2,e.__scopeMenu),c=g.useRef(null),l=wt(t,c);return h.jsx(Ys.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Ys.Slot,{scope:e.__scopeMenu,children:h.jsx(ab,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=WA[i.dir].includes(u.key);d&&f&&(o.onOpenChange(!1),(p=s.trigger)==null||p.focus(),u.preventDefault())})})})})})});p2.displayName=f2;function h2(e){return e?"open":"closed"}function Lp(e){return e==="indeterminate"}function cb(e){return Lp(e)?"indeterminate":e?"checked":"unchecked"}function YJ(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function GJ(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function XJ(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=GJ(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function ZJ(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function JJ(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return ZJ(n,t)}function hu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var m2=eb,y2=tb,g2=GA,v2=XA,b2=ob,w2=ZA,x2=Dp,_2=e2,j2=n2,S2=a2,E2=i2,O2=s2,C2=c2,QJ=u2,N2=d2,M2=p2,lb="DropdownMenu",[eQ,c2e]=er(lb,[Ip]),On=Ip(),[tQ,P2]=eQ(lb),k2=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=On(t),l=g.useRef(null),[u=!1,d]=Sn({prop:a,defaultProp:o,onChange:i});return h.jsx(tQ,{scope:t,triggerId:Pt(),triggerRef:l,contentId:Pt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(f=>!f),[d]),modal:s,children:h.jsx(m2,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};k2.displayName=lb;var A2="DropdownMenuTrigger",T2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=P2(A2,n),i=On(n);return h.jsx(y2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:iK(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});T2.displayName=A2;var nQ="DropdownMenuPortal",I2=e=>{const{__scopeDropdownMenu:t,...n}=e,r=On(t);return h.jsx(g2,{...r,...n})};I2.displayName=nQ;var R2="DropdownMenuContent",D2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=P2(R2,n),o=On(n),i=g.useRef(!1);return h.jsx(v2,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});D2.displayName=R2;var rQ="DropdownMenuGroup",L2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(b2,{...a,...r,ref:t})});L2.displayName=rQ;var aQ="DropdownMenuLabel",$2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(w2,{...a,...r,ref:t})});$2.displayName=aQ;var oQ="DropdownMenuItem",F2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(x2,{...a,...r,ref:t})});F2.displayName=oQ;var iQ="DropdownMenuCheckboxItem",B2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(_2,{...a,...r,ref:t})});B2.displayName=iQ;var sQ="DropdownMenuRadioGroup",z2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(j2,{...a,...r,ref:t})});z2.displayName=sQ;var cQ="DropdownMenuRadioItem",V2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(S2,{...a,...r,ref:t})});V2.displayName=cQ;var lQ="DropdownMenuItemIndicator",U2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(E2,{...a,...r,ref:t})});U2.displayName=lQ;var uQ="DropdownMenuSeparator",W2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(O2,{...a,...r,ref:t})});W2.displayName=uQ;var dQ="DropdownMenuArrow",fQ=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(C2,{...a,...r,ref:t})});fQ.displayName=dQ;var pQ=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=On(t),[s=!1,c]=Sn({prop:r,defaultProp:o,onChange:a});return h.jsx(QJ,{...i,open:s,onOpenChange:c,children:n})},hQ="DropdownMenuSubTrigger",H2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(N2,{...a,...r,ref:t})});H2.displayName=hQ;var mQ="DropdownMenuSubContent",q2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(M2,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});q2.displayName=mQ,oM=k2,iM=T2,aM=I2,Qg=D2,rM=L2,iv=$2,nv=F2,rv=B2,NK=z2,ov=V2,av=U2,sv=W2,jK=pQ,ev=H2,tv=q2;const yQ=oM,gQ=iM,vQ=rM,bQ=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(ev,{ref:a,className:G("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto"})]}));bQ.displayName=ev.displayName;const wQ=g.forwardRef(({className:e,...t},n)=>h.jsx(tv,{ref:n,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));wQ.displayName=tv.displayName;const K2=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(aM,{children:h.jsx(Qg,{ref:r,sideOffset:t,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));K2.displayName=Qg.displayName;const Y2=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(nv,{ref:r,className:G("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));Y2.displayName=nv.displayName;const xQ=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(rv,{ref:a,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(av,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));xQ.displayName=rv.displayName;const _Q=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(ov,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(av,{children:h.jsx(de,{name:"circle",className:"h-4 w-4"})})}),t]}));_Q.displayName=ov.displayName;const jQ=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(iv,{ref:r,className:G("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));jQ.displayName=iv.displayName;const SQ=g.forwardRef(({className:e,...t},n)=>h.jsx(sv,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));SQ.displayName=sv.displayName;function EQ(){const{t:e}=Pe("sidebar"),{isMobile:t}=cu();return h.jsx(Hs,{children:h.jsx(to,{children:h.jsxs(yQ,{children:[h.jsx(gQ,{asChild:!0,children:h.jsxs(no,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(de,{name:"settings",size:28,className:"pr-2"})}),h.jsx(de,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(K2,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(vQ,{children:h.jsxs(Y2,{children:[h.jsx(de,{name:"sparkles"}),e("contact")]})})})]})})})}const OQ=Wa("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function un({className:e,variant:t,...n}){return h.jsx("div",{className:G(OQ({variant:t}),e),...n})}function CQ({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ri(),o=Yt(AA),i=g.useCallback((l,u)=>{l.preventDefault(),l.stopPropagation(),o.show({id:u})},[o]),s=l=>{n(l),a(gn("application",{applicationId:l.id}))},c=l=>{switch(l.main_source_type){case"Thread":return h.jsx(un,{className:"ml-1",color:"blue",children:r("application_types.chat")});default:return null}};return h.jsxs(lu,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(Hs,{children:[e==null?void 0:e.map(l=>h.jsx(to,{className:"cursor-pointer",children:h.jsx(no,{asChild:!0,onClick:()=>s(l),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===l.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[l.name,c(l)]})]}),h.jsx(de,{onClick:u=>i(u,l.id),size:16,className:"!z-50",name:"trash-2"})]})})},l.id)),e?h.jsx(to,{children:h.jsxs(no,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const NQ={navMain:[{title:"playground.title",icon:h.jsx(de,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(de,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(de,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(de,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function MQ({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(F0,{collapsible:"icon",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(z0,{children:[h.jsx(EJ,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(CQ,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(sJ,{items:NQ.navMain})]}),h.jsx(lA,{children:h.jsx(EQ,{})}),h.jsx(cA,{})]})}Vn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(ut,{...n,disabled:e.disabled||t,children:t?h.jsx(de,{name:"loader-circle",className:"animate-spin"}):e.children})});function PQ({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const f=Date.now(),p=setInterval(()=>{const y=(Date.now()-f)/n*100;y>=100?(clearInterval(p),u(100)):u(y)},10);return()=>clearInterval(p)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(p=>setTimeout(p,n));const f=t?await t():!0;s(f),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(ut,{className:G("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:G("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(de,{name:"forward",className:G("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(de,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(de,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const wa="NOLLM",kQ="0123456789abcdef",AQ=[8,4,4,4,12];function mu(){return AQ.map(e=>gAe(kQ,e)()).join("-")}const TQ=()=>{const e=Qe(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(sK).filter(c=>c!=="Session");await Promise.all(r.map(c=>ue(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${mu()}]`});let a=JSON.stringify({[wa]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},IQ=()=>{const[e,t]=g.useState(!1),n=Ri(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(sK).filter(d=>d!==wa);if(!Object.keys(o[wa]).length||typeof o[wa]!="object")throw new Error("Missing Metadata");if(!("session"in o[wa])||!o[wa].session)throw new Error("Missing Session Metadata");const s=o[wa].session;if(!("ids"in o[wa]))throw new Error("Missing Session ID");const c=o[wa].ids.reduce((d,f)=>(d[f]=mu(),d),{}),l=Object.keys(o).filter(d=>d!==wa);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(f=>{if("session_id"in f&&f.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await ue("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const f=o[d];if(!f||!f.length)return Promise.resolve();const p=f.map(y=>r(y,{idMap:c,newSessionId:u.id}));return ue(d).save(p)})),u.type===Pl.Whiteboard?n(gn("whiteboard",{sessionId:u.id})):u.type===Pl.StandaloneApp&&n(gn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function RQ(){const{t:e}=Pe("tooltips"),t=ma(),n=Ml(f=>f.setTheme),r=Ml(f=>f.theme),{exportSession:a}=TQ(),{loading:o,importSession:i}=IQ(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(f){return If(f),!1}},[a]),u=g.useCallback(async f=>{var p;try{const y=(p=f.target.files)==null?void 0:p[0];if(!y)return;const m=await new Promise((v,b)=>{const w=new FileReader;w.onload=_=>{var x;try{const j=(x=_.target)==null?void 0:x.result;v(JSON.parse(j))}catch(j){b(j)}},w.onerror=_=>{b(_)},w.readAsText(y)});await i(m)}catch(y){return If(y),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(gn("whiteboard")))return e("whiteboard");if(t.pathname.includes(gn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(sA,{}),h.jsx(nt,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(su,{children:[h.jsxs(va,{children:[h.jsx(ba,{children:h.jsxs(Vn,{loading:o,variant:"ghost",onClick:()=>{var f;return(f=s.current)==null?void 0:f.click()},children:[h.jsx(de,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Fr,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(PQ,{onProcess:l})}),h.jsx(Fr,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(ut,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(de,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Fr,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(ut,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(de,{size:18,name:"github"})})})}),h.jsx(Fr,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function G2({requiredSession:e}){const t=lP(),n=Ri(),r=ma(),a=g.useRef(r),o=Qe(l=>l.currentSession),i=Qe(l=>l.sessions),s=Qe(l=>l.applications),c=Qe(l=>l.setCurrentSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(gn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(gn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(gn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(gn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(l=>{iJ().has("flow")&&l.type===Pl.StandaloneApp||(l.type===Pl.StandaloneApp&&a.current.pathname.includes(gn("whiteboard").replace("/",""))?n(gn("application",{applicationId:l.id})):l.type===Pl.Whiteboard&&a.current.pathname.includes(gn("application").replace("/",""))&&n(gn("whiteboard",{sessionId:l.id})))})},[n,t.applicationId,t.sessionId,e,c]),h.jsxs($0,{defaultOpen:!1,children:[h.jsx(MQ,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(B0,{className:"max-h-screen overflow-hidden",children:[h.jsx(RQ,{}),h.jsx(Ms,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(nG,{})})]})]})}const X2=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:G("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));X2.displayName="ChatMessageList";var Z2="vercel.ai.error",DQ=Symbol.for(Z2),J2,LQ=class kK extends Error{constructor({name:t,message:n,cause:r}){super(n),this[J2]=!0,this.name=t,this.cause=r}static isInstance(t){return kK.hasMarker(t,Z2)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};J2=DQ;var Zs=LQ;function Q2(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var eT="AI_InvalidArgumentError",tT=`vercel.ai.error.${eT}`,$Q=Symbol.for(tT),nT,FQ=class extends Zs{constructor({message:e,cause:t,argument:n}){super({name:eT,message:e,cause:t}),this[nT]=!0,this.argument=n}static isInstance(e){return Zs.hasMarker(e,tT)}};nT=$Q;var rT="AI_JSONParseError",aT=`vercel.ai.error.${rT}`,BQ=Symbol.for(aT),oT,iT=class extends Zs{constructor({text:e,cause:t}){super({name:rT,message:`JSON parsing failed: Text: ${e}.
Error message: ${Q2(t)}`,cause:t}),this[oT]=!0,this.text=e}static isInstance(e){return Zs.hasMarker(e,aT)}};oT=BQ;var sT="AI_TypeValidationError",cT=`vercel.ai.error.${sT}`,zQ=Symbol.for(cT),lT,VQ=class jM extends Zs{constructor({value:t,cause:n}){super({name:sT,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Q2(n)}`,cause:n}),this[lT]=!0,this.value=t}static isInstance(t){return Zs.hasMarker(t,cT)}static wrap({value:t,cause:n}){return jM.isInstance(n)&&n.value===t?n:new jM({value:t,cause:n})}};lT=zQ;var uT=VQ;let UQ=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var Bi={exports:{}},dT;function WQ(){if(dT)return Bi.exports;dT=1;const e=typeof da<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&da.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",f=l&&l.constructorAction||"error";if(d==="ignore"&&f==="ignore")return u;if(d!=="ignore"&&f!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&f==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:f,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const f=d;d=[];for(const p of f){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const y in p){const m=p[y];m&&typeof m=="object"&&d.push(m)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return Bi.exports=o,Bi.exports.default=o,Bi.exports.parse=o,Bi.exports.safeParse=i,Bi.exports.scan=a,Bi.exports}var HQ=WQ();const qQ=ot(HQ);var KQ=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=UQ(n,t);if(e==null)return a;if(n.includes(r))throw new FQ({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},fT=KQ(),ub=Symbol.for("vercel.ai.validator");function YQ(e){return{[ub]:!0,validate:e}}function GQ(e){return typeof e=="object"&&e!==null&&ub in e&&e[ub]===!0&&"validate"in e}function XQ(e){return GQ(e)?e:ZQ(e)}function ZQ(e){return YQ(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function JQ({value:e,schema:t}){const n=XQ(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:uT.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:uT.wrap({value:e,cause:r})}}}function pT({text:e,schema:t}){try{const n=qQ.parse(e);return t==null?{success:!0,value:n}:JQ({value:n,schema:t})}catch(n){return{success:!1,error:iT.isInstance(n)?n:new iT({text:e,cause:n})}}}var $p={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Fp={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Bp={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},zp={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Vp={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},QQ=[$p,Fp,Bp,zp,Vp];$p.code+"",Fp.code+"",Bp.code+"",zp.code+"",Vp.code+"",$p.name+"",$p.code,Fp.name+"",Fp.code,Bp.name+"",Bp.code,zp.name+"",zp.code,Vp.name+"",Vp.code,QQ.map(e=>e.code);function eee(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function tee(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=pT({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=pT({text:eee(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var yu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},gu={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},vu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},bu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},wu={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},xu={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},_u={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},ju={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Su={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Eu={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},nee=[yu,gu,vu,bu,wu,xu,_u,ju,Su,Eu],ree={[yu.code]:yu,[gu.code]:gu,[vu.code]:vu,[bu.code]:bu,[wu.code]:wu,[xu.code]:xu,[_u.code]:_u,[ju.code]:ju,[Su.code]:Su,[Eu.code]:Eu};yu.name+"",yu.code,gu.name+"",gu.code,vu.name+"",vu.code,bu.name+"",bu.code,wu.name+"",wu.code,xu.name+"",xu.code,_u.name+"",_u.code,ju.name+"",ju.code,Su.name+"",Su.code,Eu.name+"",Eu.code;var aee=nee.map(e=>e.code),oee=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!aee.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return ree[r].parse(o)},iee=10;function see(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function cee({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),f=new TextDecoder,p=[];let y=0;for(;;){const{value:m}=await d.read();if(m&&(p.push(m),y+=m.length,m[m.length-1]!==iee))continue;if(p.length===0)break;const v=see(p,y);y=0;const b=f.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(oee);for(const{type:w,value:_}of b)switch(w){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(a==null?void 0:a(_));break;case"tool_call_delta":await(o==null?void 0:o(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function lee({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function uee({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=fT,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const f={};let p={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},y="unknown";function m(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await cee({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},m()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),f[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),m()},onToolCallDeltaPart(b){const w=v(),_=f[b.toolCallId];_.text+=b.argsTextDelta;const{value:x}=tee(_.text);w.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:x},m()},async onToolCallPart(b){const w=v();if(f[b.toolCallId]!=null?w.toolInvocations[f[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:_})}m()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const _=w.findIndex(x=>x.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[_]={...w[_],state:"result",...b},m()},onDataPart(b){u.push(...b),m()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),m()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){y=b.finishReason,b.usage!=null&&(p=lee(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:y,usage:p})}async function dee({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var fee=()=>fetch;async function pee({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:f=fee()}){var p,y;const m=await f(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(p=o==null?void 0:o())==null?void 0:p.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(m)}catch(v){throw v}if(!m.ok)throw i(),new Error((y=await m.text())!=null?y:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await dee({stream:m.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await uee({stream:m.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var hT={exports:{}},db={},mT;function hee(){if(mT)return db;mT=1;var e=cK();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,f){var p=f(),y=r({inst:{value:p,getSnapshot:f}}),m=y[0].inst,v=y[1];return o(function(){m.value=p,m.getSnapshot=f,c(m)&&v({inst:m})},[d,p,f]),a(function(){return c(m)&&v({inst:m}),d(function(){c(m)&&v({inst:m})})},[d]),i(p),p}function c(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function l(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return db.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,db}var yT;function gT(){return yT||(yT=1,hT.exports=hee()),hT.exports}Bf=gT();let co,Rn,Up,ct,Br,lo,vT,Ou;CK=ot(Bf),co=()=>{},Rn=co(),Up=Object,ct=e=>e===Rn,Br=e=>typeof e=="function",lo=(e,t)=>({...e,...t}),vT=e=>Br(e.then),Ou=new WeakMap;let mee=0;const Cu=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Up(e)===e&&!r&&n!=RegExp){if(a=Ou.get(e),a)return a;if(a=++mee+"~",Ou.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=Cu(e[o])+",";Ou.set(e,a)}if(n==Up){a="#";const i=Up.keys(e).sort();for(;!ct(o=i.pop());)ct(e[o])||(a+=o+":"+Cu(e[o])+",");Ou.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},uo=new WeakMap,fb={},Wp={},pb="undefined",Hp=typeof window!=pb,hb=typeof document!=pb,yee=()=>Hp&&typeof window.requestAnimationFrame!=pb,bT=(e,t)=>{const n=uo.get(e);return[()=>!ct(t)&&e.get(t)||fb,r=>{if(!ct(t)){const a=e.get(t);t in Wp||(Wp[t]=a),n[5](t,lo(a,r),a||fb)}},n[6],()=>!ct(t)&&t in Wp?Wp[t]:!ct(t)&&e.get(t)||fb]};let mb=!0;const gee=()=>mb,[yb,gb]=Hp&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[co,co],vee=()=>{const e=hb&&document.visibilityState;return ct(e)||e!=="hidden"},bee=e=>(hb&&document.addEventListener("visibilitychange",e),yb("focus",e),()=>{hb&&document.removeEventListener("visibilitychange",e),gb("focus",e)}),wee=e=>{const t=()=>{mb=!0,e()},n=()=>{mb=!1};return yb("online",t),yb("offline",n),()=>{gb("online",t),gb("offline",n)}},xee={isOnline:gee,isVisible:vee},_ee={initFocus:bee,initReconnect:wee},wT=!H.useId,Nu=!Hp||"Deno"in window,jee=e=>yee()?window.requestAnimationFrame(e):setTimeout(e,1),vb=Nu?g.useEffect:g.useLayoutEffect,bb=typeof navigator<"u"&&navigator.connection,xT=!Nu&&bb&&(["slow-2g","2g"].includes(bb.effectiveType)||bb.saveData),wb=e=>{if(Br(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Cu(e):"",[e,t]};let See=0;const xb=()=>++See,_T=0,jT=1,ST=2;var Mu={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:_T,MUTATE_EVENT:ST,RECONNECT_EVENT:jT};async function ET(...e){const[t,n,r,a]=e,o=lo({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=f=>typeof s=="function"?s(f):s!==!1,u=o.throwOnError;if(Br(n)){const f=n,p=[],y=t.keys();for(const m of y)!/^\$(inf|sub)\$/.test(m)&&f(t.get(m)._k)&&p.push(m);return Promise.all(p.map(d))}return d(n);async function d(f){const[p]=wb(f);if(!p)return;const[y,m]=bT(t,p),[v,b,w,_]=uo.get(t),x=()=>{const k=v[p];return(Br(o.revalidate)?o.revalidate(y().data,f):o.revalidate!==!1)&&(delete w[p],delete _[p],k&&k[0])?k[0](ST).then(()=>y().data):y().data};if(e.length<3)return x();let j=r,S;const E=xb();b[p]=[E,0];const O=!ct(c),M=y(),N=M.data,P=M._c,I=ct(P)?N:P;if(O&&(c=Br(c)?c(I,N):c,m({data:c,_c:I})),Br(j))try{j=j(I)}catch(k){S=k}if(j&&vT(j))if(j=await j.catch(k=>{S=k}),E!==b[p][0]){if(S)throw S;return j}else S&&O&&l(S)&&(i=!0,m({data:I,_c:Rn}));if(i&&!S)if(Br(i)){const k=i(j,I);m({data:k,error:Rn,_c:Rn})}else m({data:j,error:Rn,_c:Rn});if(b[p][1]=xb(),Promise.resolve(x()).then(()=>{m({_c:Rn})}),S){if(u)throw S;return}return j}}const OT=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Eee=(e,t)=>{if(!uo.has(e)){const n=lo(_ee,t),r={},a=ET.bind(Rn,e);let o=co;const i={},s=(u,d)=>{const f=i[u]||[];return i[u]=f,f.push(d),()=>f.splice(f.indexOf(d),1)},c=(u,d,f)=>{e.set(u,d);const p=i[u];if(p)for(const y of p)y(d,f)},l=()=>{if(!uo.has(e)&&(uo.set(e,[r,{},{},{},a,c,s]),!Nu)){const u=n.initFocus(setTimeout.bind(Rn,OT.bind(Rn,r,_T))),d=n.initReconnect(setTimeout.bind(Rn,OT.bind(Rn,r,jT)));o=()=>{u&&u(),d&&d(),uo.delete(e)}}};return l(),[e,a,l,o]}return[e,uo.get(e)[4]]},Oee=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ct(o)&&i>o||setTimeout(r,s,a)},Cee=(e,t)=>Cu(e)==Cu(t),[CT,Nee]=Eee(new Map),Mee=lo({onLoadingSlow:co,onSuccess:co,onError:co,onErrorRetry:Oee,onDiscarded:co,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:xT?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:xT?5e3:3e3,compare:Cee,isPaused:()=>!1,cache:CT,mutate:Nee,fallback:{}},xee),Pee=(e,t)=>{const n=lo(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=lo(a,i))}return n},kee=g.createContext({}),Aee="$inf$",NT=Hp&&window.__SWR_DEVTOOLS_USE__,Tee=NT?window.__SWR_DEVTOOLS_USE__:[],Iee=()=>{NT&&(window.__SWR_DEVTOOLS_REACT__=H)},Ree=e=>Br(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],Dee=()=>lo(Mee,g.useContext(kee)),Lee=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=wb(t),[,,,i]=uo.get(CT);if(o.startsWith(Aee))return n(...a);const s=i[o];return ct(s)?n(...a):(delete i[o],s)}),r),$ee=Tee.concat(Lee),Fee=e=>function(...t){const n=Dee(),[r,a,o]=Ree(t),i=Pee(n,o);let s=e;const{use:c}=i,l=(c||[]).concat($ee);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},Bee=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};Iee();const MT=H.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),_b={dedupe:!0},zee=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:f}=n,[p,y,m,v]=uo.get(r),[b,w]=wb(e),_=g.useRef(!1),x=g.useRef(!1),j=g.useRef(b),S=g.useRef(t),E=g.useRef(n),O=()=>E.current,M=()=>O().isVisible()&&O().isOnline(),[N,P,I,k]=bT(r,b),C=g.useRef({}).current,A=ct(i)?n.fallback[b]:i,T=(B,ce)=>{for(const re in C){const le=re;if(le==="data"){if(!a(B[le],ce[le])&&(!ct(B[le])||!a(K,ce[le])))return!1}else if(ce[le]!==B[le])return!1}return!0},D=g.useMemo(()=>{const B=!b||!t?!1:ct(s)?O().isPaused()||o?!1:ct(c)?!0:c:s,ce=Se=>{const Ve=lo(Se);return delete Ve._k,B?{isValidating:!0,isLoading:!0,...Ve}:Ve},re=N(),le=k(),je=ce(re),Le=re===le?je:ce(le);let $e=je;return[()=>{const Se=ce(N());return T(Se,$e)?($e.data=Se.data,$e.isLoading=Se.isLoading,$e.isValidating=Se.isValidating,$e.error=Se.error,$e):($e=Se,Se)},()=>Le]},[r,b]),L=Bf.useSyncExternalStore(g.useCallback(B=>I(b,(ce,re)=>{T(re,ce)||B()}),[r,b]),D[0],D[1]),R=!_.current,F=p[b]&&p[b].length>0,V=L.data,$=ct(V)?A:V,U=L.error,z=g.useRef($),K=f?ct(V)?z.current:V:$,ne=F&&!ct(U)?!1:R&&!ct(s)?s:O().isPaused()?!1:o?ct($)?!1:c:ct($)||c,Q=!!(b&&t&&R&&ne),Y=ct(L.isValidating)?Q:L.isValidating,q=ct(L.isLoading)?Q:L.isLoading,X=g.useCallback(async B=>{const ce=S.current;if(!b||!ce||x.current||O().isPaused())return!1;let re,le,je=!0;const Le=B||{},$e=!m[b]||!Le.dedupe,Se=()=>wT?!x.current&&b===j.current&&_.current:b===j.current,Ve={isValidating:!1,isLoading:!1},We=()=>{P(Ve)},He=()=>{const st=m[b];st&&st[1]===le&&delete m[b]},Mt={isValidating:!0};ct(N().data)&&(Mt.isLoading=!0);try{if($e&&(P(Mt),n.loadingTimeout&&ct(N().data)&&setTimeout(()=>{je&&Se()&&O().onLoadingSlow(b,n)},n.loadingTimeout),m[b]=[ce(w),xb()]),[re,le]=m[b],re=await re,$e&&setTimeout(He,n.dedupingInterval),!m[b]||m[b][1]!==le)return $e&&Se()&&O().onDiscarded(b),!1;Ve.error=Rn;const st=y[b];if(!ct(st)&&(le<=st[0]||le<=st[1]||st[1]===0))return We(),$e&&Se()&&O().onDiscarded(b),!1;const rt=N().data;Ve.data=a(rt,re)?rt:re,$e&&Se()&&O().onSuccess(re,b,n)}catch(st){He();const rt=O(),{shouldRetryOnError:bt}=rt;rt.isPaused()||(Ve.error=st,$e&&Se()&&(rt.onError(st,b,rt),(bt===!0||Br(bt)&&bt(st))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||M())&&rt.onErrorRetry(st,b,rt,qt=>{const Xn=p[b];Xn&&Xn[0]&&Xn[0](Mu.ERROR_REVALIDATE_EVENT,qt)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,We(),!0},[b,r]),te=g.useCallback((...B)=>ET(r,j.current,...B),[]);if(vb(()=>{S.current=t,E.current=n,ct(V)||(z.current=V)}),vb(()=>{if(!b)return;const B=X.bind(Rn,_b);let ce=0;const re=Bee(b,p,(le,je={})=>{if(le==Mu.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>ce&&M()&&(ce=Le+O().focusThrottleInterval,B())}else if(le==Mu.RECONNECT_EVENT)O().revalidateOnReconnect&&M()&&B();else{if(le==Mu.MUTATE_EVENT)return X();if(le==Mu.ERROR_REVALIDATE_EVENT)return X(je)}});return x.current=!1,j.current=b,_.current=!0,P({_k:w}),ne&&(ct($)||Nu?B():jee(B)),()=>{x.current=!0,re()}},[b]),vb(()=>{let B;function ce(){const le=Br(l)?l(N().data):l;le&&B!==-1&&(B=setTimeout(re,le))}function re(){!N().error&&(u||O().isVisible())&&(d||O().isOnline())?X(_b).then(ce):ce()}return ce(),()=>{B&&(clearTimeout(B),B=-1)}},[l,u,d,b]),g.useDebugValue(K),o&&ct($)&&b){if(!wT&&Nu)throw new Error("Fallback data is required when using suspense in SSR.");S.current=t,E.current=n,x.current=!1;const B=v[b];if(!ct(B)){const ce=te(B);MT(ce)}if(ct(U)){const ce=X(_b);ct(K)||(ce.status="fulfilled",ce.value=!0),MT(ce)}else throw U}return{mutate:te,get data(){return C.data=!0,K},get error(){return C.error=!0,U},get isValidating(){return C.isValidating=!0,Y},get isLoading(){return C.isLoading=!0,q}}},qp=Fee(zee);var jb,PT;function Vee(){if(PT)return jb;PT=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return jb=e,jb}var Uee=Vee();const Wee=ot(Uee);function kT(e,t){return t!=null?Wee(e,t):e}var Hee=async(e,t,n,r,a,o,i,s,c,l,u,d,f,p,y,m,v)=>{var b;const w=i.current;n(t.messages,!1);const _=p?t.messages:t.messages.map(({role:j,content:S,experimental_attachments:E,data:O,annotations:M,toolInvocations:N})=>({role:j,content:S,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...M!==void 0&&{annotations:M},...N!==void 0&&{toolInvocations:N}})),x=a.current;return await pee({api:e,body:(b=y==null?void 0:y({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(j,S){n([...t.messages,...j],!1),S!=null&&S.length&&r([...x??[],...S],!1)},onToolCall:f,onFinish:u,generateId:c,fetch:m})};function qee({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:f,headers:p,body:y,generateId:m=fT,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const _=g.useId(),x=t??_,j=typeof e=="string"?[e,x]:x,[S]=g.useState([]),{data:E,mutate:O}=qp([j,"messages"],null,{fallbackData:n??S}),M=g.useRef(E||[]);g.useEffect(()=>{M.current=E||[]},[E]);const{data:N,mutate:P}=qp([j,"streamData"],null),I=g.useRef(N);g.useEffect(()=>{I.current=N},[N]);const{data:k=!1,mutate:C}=qp([j,"loading"],null),{data:A=void 0,mutate:T}=qp([j,"error"],null),D=g.useRef(null),L=g.useRef({credentials:f,headers:p,body:y});g.useEffect(()=>{L.current={credentials:f,headers:p,body:y}},[f,p,y]);const R=g.useCallback(async Y=>{const q=M.current.length;try{C(!0),T(void 0);const B=new AbortController;D.current=B,await Hee(e,Y,kT(O,w),kT(P,w),I,L,M,D,m,c,u,l,o,a,i,v,b),D.current=null}catch(B){if(B.name==="AbortError")return D.current=null,null;d&&B instanceof Error&&d(B),T(B)}finally{C(!1)}const X=M.current,te=X[X.length-1];X.length>q&&te!=null&&s>1&&AT(te)&&Kee(X)<s&&await R({messages:X})},[O,C,e,L,l,u,d,T,P,I,c,a,i,o,s,M,D,m,v,b,w]),F=g.useCallback(async(Y,{data:q,headers:X,body:te,experimental_attachments:B}={})=>{var ce,re;Y.id||(Y.id=m());const le=await TT(B),je=M.current.concat({...Y,id:(ce=Y.id)!=null?ce:m(),createdAt:(re=Y.createdAt)!=null?re:new Date,experimental_attachments:le.length>0?le:void 0});return R({messages:je,headers:X,body:te,data:q})},[R,m]),V=g.useCallback(async({data:Y,headers:q,body:X}={})=>{const te=M.current;if(te.length===0)return null;const B=te[te.length-1];return R({messages:B.role==="assistant"?te.slice(0,-1):te,headers:q,body:X,data:Y})},[R]),$=g.useCallback(()=>{D.current&&(D.current.abort(),D.current=null)},[]),U=g.useCallback(Y=>{typeof Y=="function"&&(Y=Y(M.current)),O(Y,!1),M.current=Y},[O]),z=g.useCallback(Y=>{typeof Y=="function"&&(Y=Y(I.current)),P(Y,!1),I.current=Y},[P]),[K,ne]=g.useState(r),Q=g.useCallback(async(Y,q={},X)=>{var te;if((te=Y==null?void 0:Y.preventDefault)==null||te.call(Y),!K&&!q.allowEmptySubmit)return;X&&(L.current={...L.current,...X});const B=await TT(q.experimental_attachments),ce={messages:!K&&!B.length&&q.allowEmptySubmit?M.current:M.current.concat({id:m(),createdAt:new Date,role:"user",content:K,experimental_attachments:B.length>0?B:void 0}),headers:q.headers,body:q.body,data:q.data};R(ce),ne("")},[K,m,R]);return{messages:E||[],setMessages:U,data:N,setData:z,error:A,append:F,reload:V,stop:$,input:K,setInput:ne,handleInputChange:Y=>{ne(Y.target.value)},handleSubmit:Q,isLoading:k,addToolResult:({toolCallId:Y,result:q})=>{const X=M.current.map((B,ce,re)=>ce===re.length-1&&B.role==="assistant"&&B.toolInvocations?{...B,toolInvocations:B.toolInvocations.map(le=>le.toolCallId===Y?{...le,result:q,state:"result"}:le)}:B);O(X,!1);const te=X[X.length-1];AT(te)&&R({messages:X})}}}function AT(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function Kee(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function TT(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}qN=qee;const fo=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:G("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));fo.displayName="Textarea";function Yee({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const Gee=48,IT=164;bv=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,f]=g.useState(!1),[p,y]=g.useState(""),{textareaRef:m,adjustHeight:v}=Yee({minHeight:o||Gee,maxHeight:i||IT}),[b,w]=g.useState(!0),_=g.useCallback(async j=>{try{f(!0),await e(p,j)&&y("")}finally{f(!1)}},[p,e]),x=g.useMemo(()=>({maxHeight:`${i||IT}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:G("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(fo,{id:"ai-input-04",value:(l?u:p)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:m,onKeyDown:j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),_(j))},onChange:j=>{l||y(j.target.value),v(),l==null||l(j)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(de,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:G("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(Af.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(de,{name:"globe",className:G("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(TK,{children:b&&h.jsx(Af.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:j=>{_(j)},className:G("rounded-lg p-2",l&&u||p?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(de,{name:"send",className:"w-4 h-4"})})})]})]})})})};var Sb,RT;function Xee(){if(RT)return Sb;RT=1;function e(){this.__data__=[],this.size=0}return Sb=e,Sb}var Eb,DT;Il=function(){if(DT)return Eb;DT=1;function e(t,n){return t===n||t!==t&&n!==n}return Eb=e,Eb};var Ob,LT;function Kp(){if(LT)return Ob;LT=1;var e=Il();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return Ob=t,Ob}var Cb,$T;function Zee(){if($T)return Cb;$T=1;var e=Kp(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Cb=r,Cb}var Nb,FT;function Jee(){if(FT)return Nb;FT=1;var e=Kp();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Nb=t,Nb}var Mb,BT;function Qee(){if(BT)return Mb;BT=1;var e=Kp();function t(n){return e(this.__data__,n)>-1}return Mb=t,Mb}var Pb,zT;function ete(){if(zT)return Pb;zT=1;var e=Kp();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return Pb=t,Pb}var kb,VT;function Yp(){if(VT)return kb;VT=1;var e=Xee(),t=Zee(),n=Jee(),r=Qee(),a=ete();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,kb=o,kb}var Ab,UT;function tte(){if(UT)return Ab;UT=1;var e=Yp();function t(){this.__data__=new e,this.size=0}return Ab=t,Ab}var Tb,WT;function nte(){if(WT)return Tb;WT=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Tb=e,Tb}var Ib,HT;function rte(){if(HT)return Ib;HT=1;function e(t){return this.__data__.get(t)}return Ib=e,Ib}var Rb,qT;function ate(){if(qT)return Rb;qT=1;function e(t){return this.__data__.has(t)}return Rb=e,Rb}var Db,KT;function YT(){if(KT)return Db;KT=1;var e=typeof kl=="object"&&kl&&kl.Object===Object&&kl;return Db=e,Db}var Lb,GT;Ar=function(){if(GT)return Lb;GT=1;var e=YT(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Lb=n,Lb};var $b,XT;Ps=function(){if(XT)return $b;XT=1;var e=Ar(),t=e.Symbol;return $b=t,$b};var Fb,ZT;function ote(){if(ZT)return Fb;ZT=1;var e=Ps(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Fb=o,Fb}var Bb,JT;function ite(){if(JT)return Bb;JT=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Bb=n,Bb}var zb,QT;function po(){if(QT)return zb;QT=1;var e=Ps(),t=ote(),n=ite(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return zb=i,zb}var Vb,eI;Tr=function(){if(eI)return Vb;eI=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Vb=e,Vb};var Ub,tI;Ff=function(){if(tI)return Ub;tI=1;var e=po(),t=Tr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return Ub=i,Ub};var Wb,nI;function ste(){if(nI)return Wb;nI=1;var e=Ar(),t=e["__core-js_shared__"];return Wb=t,Wb}var Hb,rI;function cte(){if(rI)return Hb;rI=1;var e=ste(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Hb=n,Hb}var qb,aI;function oI(){if(aI)return qb;aI=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return qb=n,qb}var Kb,iI;function lte(){if(iI)return Kb;iI=1;var e=Ff(),t=cte(),n=Tr(),r=oI(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!n(f)||t(f))return!1;var p=e(f)?u:o;return p.test(r(f))}return Kb=d,Kb}var Yb,sI;function ute(){if(sI)return Yb;sI=1;function e(t,n){return t==null?void 0:t[n]}return Yb=e,Yb}var Gb,cI;function zi(){if(cI)return Gb;cI=1;var e=lte(),t=ute();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Gb=n,Gb}var Xb,lI;function Zb(){if(lI)return Xb;lI=1;var e=zi(),t=Ar(),n=e(t,"Map");return Xb=n,Xb}var Jb,uI;function Gp(){if(uI)return Jb;uI=1;var e=zi(),t=e(Object,"create");return Jb=t,Jb}var Qb,dI;function dte(){if(dI)return Qb;dI=1;var e=Gp();function t(){this.__data__=e?e(null):{},this.size=0}return Qb=t,Qb}var ew,fI;function fte(){if(fI)return ew;fI=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return ew=e,ew}var tw,pI;function pte(){if(pI)return tw;pI=1;var e=Gp(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return tw=a,tw}var nw,hI;function hte(){if(hI)return nw;hI=1;var e=Gp(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return nw=r,nw}var rw,mI;function mte(){if(mI)return rw;mI=1;var e=Gp(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return rw=n,rw}var aw,yI;function yte(){if(yI)return aw;yI=1;var e=dte(),t=fte(),n=pte(),r=hte(),a=mte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,aw=o,aw}var ow,gI;function gte(){if(gI)return ow;gI=1;var e=yte(),t=Yp(),n=Zb();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return ow=r,ow}var iw,vI;function vte(){if(vI)return iw;vI=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return iw=e,iw}var sw,bI;function Xp(){if(bI)return sw;bI=1;var e=vte();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return sw=t,sw}var cw,wI;function bte(){if(wI)return cw;wI=1;var e=Xp();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return cw=t,cw}var lw,xI;function wte(){if(xI)return lw;xI=1;var e=Xp();function t(n){return e(this,n).get(n)}return lw=t,lw}var uw,_I;function xte(){if(_I)return uw;_I=1;var e=Xp();function t(n){return e(this,n).has(n)}return uw=t,uw}var dw,jI;function _te(){if(jI)return dw;jI=1;var e=Xp();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return dw=t,dw}var fw,SI;function pw(){if(SI)return fw;SI=1;var e=gte(),t=bte(),n=wte(),r=xte(),a=_te();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,fw=o,fw}var hw,EI;function jte(){if(EI)return hw;EI=1;var e=Yp(),t=Zb(),n=pw(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return hw=a,hw}var mw,OI;Pv=function(){if(OI)return mw;OI=1;var e=Yp(),t=tte(),n=nte(),r=rte(),a=ate(),o=jte();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,mw=i,mw};var yw,CI;function Ste(){if(CI)return yw;CI=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return yw=t,yw}var gw,NI;function Ete(){if(NI)return gw;NI=1;function e(t){return this.__data__.has(t)}return gw=e,gw}var vw,MI;function PI(){if(MI)return vw;MI=1;var e=pw(),t=Ste(),n=Ete();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,vw=r,vw}var bw,kI;function AI(){if(kI)return bw;kI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return bw=e,bw}var ww,TI;function II(){if(TI)return ww;TI=1;function e(t,n){return t.has(n)}return ww=e,ww}var xw,RI;function DI(){if(RI)return xw;RI=1;var e=PI(),t=AI(),n=II(),r=1,a=2;function o(i,s,c,l,u,d){var f=c&r,p=i.length,y=s.length;if(p!=y&&!(f&&y>p))return!1;var m=d.get(i),v=d.get(s);if(m&&v)return m==s&&v==i;var b=-1,w=!0,_=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<p;){var x=i[b],j=s[b];if(l)var S=f?l(j,x,b,s,i,d):l(x,j,b,i,s,d);if(S!==void 0){if(S)continue;w=!1;break}if(_){if(!t(s,function(E,O){if(!n(_,O)&&(x===E||u(x,E,c,l,d)))return _.push(O)})){w=!1;break}}else if(!(x===j||u(x,j,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return xw=o,xw}var _w,LI;yM=function(){if(LI)return _w;LI=1;var e=Ar(),t=e.Uint8Array;return _w=t,_w};var jw,$I;function Ote(){if($I)return jw;$I=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return jw=e,jw}var Sw,FI;function Ew(){if(FI)return Sw;FI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return Sw=e,Sw}var Ow,BI;function Cte(){if(BI)return Ow;BI=1;var e=Ps(),t=yM(),n=Il(),r=DI(),a=Ote(),o=Ew(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",f="[object Number]",p="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_=e?e.prototype:void 0,x=_?_.valueOf:void 0;function j(S,E,O,M,N,P,I){switch(O){case w:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case b:return!(S.byteLength!=E.byteLength||!P(new t(S),new t(E)));case c:case l:case f:return n(+S,+E);case u:return S.name==E.name&&S.message==E.message;case p:case m:return S==E+"";case d:var k=a;case y:var C=M&i;if(k||(k=o),S.size!=E.size&&!C)return!1;var A=I.get(S);if(A)return A==E;M|=s,I.set(S,E);var T=r(k(S),k(E),M,N,P,I);return I.delete(S),T;case v:if(x)return x.call(S)==x.call(E)}return!1}return Ow=j,Ow}var Cw,zI;function Nw(){if(zI)return Cw;zI=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Cw=e,Cw}var Mw,VI;In=function(){if(VI)return Mw;VI=1;var e=Array.isArray;return Mw=e,Mw};var Pw,UI;function WI(){if(UI)return Pw;UI=1;var e=Nw(),t=In();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return Pw=n,Pw}var kw,HI;function Nte(){if(HI)return kw;HI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return kw=e,kw}var Aw,qI;function KI(){if(qI)return Aw;qI=1;function e(){return[]}return Aw=e,Aw}var Tw,YI;Ov=function(){if(YI)return Tw;YI=1;var e=Nte(),t=KI(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return Tw=o,Tw};var Iw,GI;function Mte(){if(GI)return Iw;GI=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Iw=e,Iw}var Rw,XI;pa=function(){if(XI)return Rw;XI=1;function e(t){return t!=null&&typeof t=="object"}return Rw=e,Rw};var Dw,ZI;function Pte(){if(ZI)return Dw;ZI=1;var e=po(),t=pa(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Dw=r,Dw}var Lw,JI;$f=function(){if(JI)return Lw;JI=1;var e=Pte(),t=pa(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return Lw=o,Lw};var Zp={exports:{}},$w,QI;function kte(){if(QI)return $w;QI=1;function e(){return!1}return $w=e,$w}Zp.exports;var eR;kv=function(){return eR||(eR=1,function(e,t){var n=Ar(),r=kte(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Zp,Zp.exports)),Zp.exports};var Fw,tR;function Jp(){if(tR)return Fw;tR=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Fw=n,Fw}var Bw,nR;function zw(){if(nR)return Bw;nR=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return Bw=t,Bw}var Vw,rR;function Ate(){if(rR)return Vw;rR=1;var e=po(),t=zw(),n=pa(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",f="[object RegExp]",p="[object Set]",y="[object String]",m="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",j="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",M="[object Uint16Array]",N="[object Uint32Array]",P={};P[w]=P[_]=P[x]=P[j]=P[S]=P[E]=P[O]=P[M]=P[N]=!0,P[r]=P[a]=P[v]=P[o]=P[b]=P[i]=P[s]=P[c]=P[l]=P[u]=P[d]=P[f]=P[p]=P[y]=P[m]=!1;function I(k){return n(k)&&t(k.length)&&!!P[e(k)]}return Vw=I,Vw}var Uw,aR;Mv=function(){if(aR)return Uw;aR=1;function e(t){return function(n){return t(n)}}return Uw=e,Uw};var Qp={exports:{}};Qp.exports;var oR;vM=function(){return oR||(oR=1,function(e,t){var n=YT(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(Qp,Qp.exports)),Qp.exports};var Ww,iR;Tg=function(){if(iR)return Ww;iR=1;var e=Ate(),t=Mv(),n=vM(),r=n&&n.isTypedArray,a=r?t(r):e;return Ww=a,Ww};var Hw,sR;function cR(){if(sR)return Hw;sR=1;var e=Mte(),t=$f(),n=In(),r=kv(),a=Jp(),o=Tg(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),f=!d&&t(l),p=!d&&!f&&r(l),y=!d&&!f&&!p&&o(l),m=d||f||p||y,v=m?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(m&&(w=="length"||p&&(w=="offset"||w=="parent")||y&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return Hw=c,Hw}var qw,lR;Nv=function(){if(lR)return qw;lR=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return qw=t,qw};var Kw,uR;function dR(){if(uR)return Kw;uR=1;function e(t,n){return function(r){return t(n(r))}}return Kw=e,Kw}var Yw,fR;function Tte(){if(fR)return Yw;fR=1;var e=dR(),t=e(Object.keys,Object);return Yw=t,Yw}var Gw,pR;function Ite(){if(pR)return Gw;pR=1;var e=Nv(),t=Tte(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Gw=a,Gw}var Xw,hR;Ni=function(){if(hR)return Xw;hR=1;var e=Ff(),t=zw();function n(r){return r!=null&&t(r.length)&&!e(r)}return Xw=n,Xw};var Zw,mR;zl=function(){if(mR)return Zw;mR=1;var e=cR(),t=Ite(),n=Ni();function r(a){return n(a)?e(a):t(a)}return Zw=r,Zw};var Jw,yR;bM=function(){if(yR)return Jw;yR=1;var e=WI(),t=Ov(),n=zl();function r(a){return e(a,n,t)}return Jw=r,Jw};var Qw,gR;function Rte(){if(gR)return Qw;gR=1;var e=bM(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,f=e(o),p=f.length,y=e(i),m=y.length;if(p!=m&&!d)return!1;for(var v=p;v--;){var b=f[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),_=u.get(i);if(w&&_)return w==i&&_==o;var x=!0;u.set(o,i),u.set(i,o);for(var j=d;++v<p;){b=f[v];var S=o[b],E=i[b];if(c)var O=d?c(E,S,b,i,o,u):c(S,E,b,o,i,u);if(!(O===void 0?S===E||l(S,E,s,c,u):O)){x=!1;break}j||(j=b=="constructor")}if(x&&!j){var M=o.constructor,N=i.constructor;M!=N&&"constructor"in o&&"constructor"in i&&!(typeof M=="function"&&M instanceof M&&typeof N=="function"&&N instanceof N)&&(x=!1)}return u.delete(o),u.delete(i),x}return Qw=a,Qw}var ex,vR;function Dte(){if(vR)return ex;vR=1;var e=zi(),t=Ar(),n=e(t,"DataView");return ex=n,ex}var tx,bR;function Lte(){if(bR)return tx;bR=1;var e=zi(),t=Ar(),n=e(t,"Promise");return tx=n,tx}var nx,wR;function xR(){if(wR)return nx;wR=1;var e=zi(),t=Ar(),n=e(t,"Set");return nx=n,nx}var rx,_R;function $te(){if(_R)return rx;_R=1;var e=zi(),t=Ar(),n=e(t,"WeakMap");return rx=n,rx}var ax,jR;gM=function(){if(jR)return ax;jR=1;var e=Dte(),t=Zb(),n=Lte(),r=xR(),a=$te(),o=po(),i=oI(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",f="[object DataView]",p=i(e),y=i(t),m=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=f||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(_){var x=o(_),j=x==c?_.constructor:void 0,S=j?i(j):"";if(S)switch(S){case p:return f;case y:return s;case m:return l;case v:return u;case b:return d}return x}),ax=w,ax};var ox,SR;function Fte(){if(SR)return ox;SR=1;var e=Pv(),t=DI(),n=Cte(),r=Rte(),a=gM(),o=In(),i=kv(),s=Tg(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,p=f.hasOwnProperty;function y(m,v,b,w,_,x){var j=o(m),S=o(v),E=j?u:a(m),O=S?u:a(v);E=E==l?d:E,O=O==l?d:O;var M=E==d,N=O==d,P=E==O;if(P&&i(m)){if(!i(v))return!1;j=!0,M=!1}if(P&&!M)return x||(x=new e),j||s(m)?t(m,v,b,w,_,x):n(m,v,E,b,w,_,x);if(!(b&c)){var I=M&&p.call(m,"__wrapped__"),k=N&&p.call(v,"__wrapped__");if(I||k){var C=I?m.value():m,A=k?v.value():v;return x||(x=new e),_(C,A,b,w,x)}}return P?(x||(x=new e),r(m,v,b,w,_,x)):!1}return ox=y,ox}var ix,ER;function sx(){if(ER)return ix;ER=1;var e=Fte(),t=pa();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return ix=n,ix}var cx,OR;function Bte(){if(OR)return cx;OR=1;var e=Pv(),t=sx(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var f=s[l];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++l<u;){f=s[l];var p=f[0],y=o[p],m=f[1];if(d&&f[2]){if(y===void 0&&!(p in o))return!1}else{var v=new e;if(c)var b=c(y,m,p,o,i,v);if(!(b===void 0?t(m,y,n|r,c,v):b))return!1}}return!0}return cx=a,cx}var lx,CR;function NR(){if(CR)return lx;CR=1;var e=Tr();function t(n){return n===n&&!e(n)}return lx=t,lx}var ux,MR;function zte(){if(MR)return ux;MR=1;var e=NR(),t=zl();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return ux=n,ux}var dx,PR;function kR(){if(PR)return dx;PR=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return dx=e,dx}var fx,AR;function Vte(){if(AR)return fx;AR=1;var e=Bte(),t=zte(),n=kR();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return fx=r,fx}var px,TR;function Js(){if(TR)return px;TR=1;var e=po(),t=pa(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return px=r,px}var hx,IR;function mx(){if(IR)return hx;IR=1;var e=In(),t=Js(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return hx=a,hx}var yx,RR;function DR(){if(RR)return yx;RR=1;var e=pw(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,yx=n,yx}var gx,LR;function Ute(){if(LR)return gx;LR=1;var e=DR(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return gx=n,gx}var vx,$R;function Wte(){if($R)return vx;$R=1;var e=Ute(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return vx=r,vx}var bx,FR;Tl=function(){if(FR)return bx;FR=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return bx=e,bx};var wx,BR;function Hte(){if(BR)return wx;BR=1;var e=Ps(),t=Tl(),n=In(),r=Js(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return wx=s,wx}var xx,zR;function VR(){if(zR)return xx;zR=1;var e=Hte();function t(n){return n==null?"":e(n)}return xx=t,xx}var _x,UR;Hl=function(){if(UR)return _x;UR=1;var e=In(),t=mx(),n=Wte(),r=VR();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return _x=a,_x};var jx,WR;ks=function(){if(WR)return jx;WR=1;var e=Js(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return jx=n,jx};var Sx,HR;Wl=function(){if(HR)return Sx;HR=1;var e=Hl(),t=ks();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return Sx=n,Sx};var Ex,qR;function KR(){if(qR)return Ex;qR=1;var e=Wl();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return Ex=t,Ex}var Ox,YR;function qte(){if(YR)return Ox;YR=1;function e(t,n){return t!=null&&n in Object(t)}return Ox=e,Ox}var Cx,GR;function Kte(){if(GR)return Cx;GR=1;var e=Hl(),t=$f(),n=In(),r=Jp(),a=zw(),o=ks();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var p=o(c[u]);if(!(f=s!=null&&l(s,p)))break;s=s[p]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&a(d)&&r(p,d)&&(n(s)||t(s)))}return Cx=i,Cx}var Nx,XR;$N=function(){if(XR)return Nx;XR=1;var e=qte(),t=Kte();function n(r,a){return r!=null&&t(r,a,e)}return Nx=n,Nx};var Mx,ZR;function Yte(){if(ZR)return Mx;ZR=1;var e=sx(),t=KR(),n=$N(),r=mx(),a=NR(),o=kR(),i=ks(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(f){var p=t(f,u);return p===void 0&&p===d?n(f,u):e(d,p,s|c)}}return Mx=l,Mx}var Px,JR;function Qs(){if(JR)return Px;JR=1;function e(t){return t}return Px=e,Px}var kx,QR;function Gte(){if(QR)return kx;QR=1;function e(t){return function(n){return n==null?void 0:n[t]}}return kx=e,kx}var Ax,eD;function Xte(){if(eD)return Ax;eD=1;var e=Wl();function t(n){return function(r){return e(r,n)}}return Ax=t,Ax}var Tx,tD;function Zte(){if(tD)return Tx;tD=1;var e=Gte(),t=Xte(),n=mx(),r=ks();function a(o){return n(o)?e(r(o)):t(o)}return Tx=a,Tx}var Ix,nD;function xa(){if(nD)return Ix;nD=1;var e=Vte(),t=Yte(),n=Qs(),r=In(),a=Zte();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return Ix=o,Ix}var Rx,rD;function Jte(){if(rD)return Rx;rD=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return Rx=t,Rx}var Dx,aD;function oD(){if(aD)return Dx;aD=1;var e=zi(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return Dx=t,Dx}var Lx,iD;Dg=function(){if(iD)return Lx;iD=1;var e=oD();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return Lx=t,Lx};var $x,sD;wM=function(){if(sD)return $x;sD=1;var e=Dg(),t=Il(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return $x=a,$x};var Fx,cD;function Qte(){if(cD)return Fx;cD=1;var e=wM(),t=Hl(),n=Jp(),r=Tr(),a=ks();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,f=d-1,p=i;p!=null&&++u<d;){var y=a(s[u]),m=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(u!=f){var v=p[y];m=l?l(v,y,p):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(p,y,m),p=p[y]}return i}return Fx=o,Fx}var Bx,lD;LN=function(){if(lD)return Bx;lD=1;var e=Wl(),t=Qte(),n=Hl();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return Bx=r,Bx};var zx,uD;Cv=function(){if(uD)return zx;uD=1;var e=dR(),t=e(Object.getPrototypeOf,Object);return zx=t,zx};var Vx,dD;mM=function(){if(dD)return Vx;dD=1;var e=Nw(),t=Cv(),n=Ov(),r=KI(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return Vx=o,Vx};var Ux,fD;function ene(){if(fD)return Ux;fD=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return Ux=e,Ux}var Wx,pD;function tne(){if(pD)return Wx;pD=1;var e=Tr(),t=Nv(),n=ene(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return Wx=o,Wx}var Hx,hD;hM=function(){if(hD)return Hx;hD=1;var e=cR(),t=tne(),n=Ni();function r(a){return n(a)?e(a,!0):t(a)}return Hx=r,Hx};var qx,mD;xM=function(){if(mD)return qx;mD=1;var e=WI(),t=mM(),n=hM();function r(a){return e(a,n,t)}return qx=r,qx};var Kx,yD;function nne(){if(yD)return Kx;yD=1;var e=Tl(),t=xa(),n=LN(),r=xM();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return Kx=a,Kx}var Yx,gD;function rne(){if(gD)return Yx;gD=1;var e=xa(),t=Jte(),n=nne();function r(a,o){return n(a,t(e(o)))}return Yx=r,Yx}var ane=rne();const Pu=ot(ane);var Gx,vD;function one(){if(vD)return Gx;vD=1;function e(t){return t===void 0}return Gx=e,Gx}var ine=one();const ku=ot(ine);function Xt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Xt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var sne={value:()=>{}};function eh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new th(n)}function th(e){this._=e}function cne(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}th.prototype=eh.prototype={constructor:th,on:function(e,t){var n=this._,r=cne(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=lne(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=bD(n[a],e.name,t);else if(t==null)for(a in n)n[a]=bD(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new th(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function lne(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function bD(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=sne,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Xx="http://www.w3.org/1999/xhtml";const wD={svg:"http://www.w3.org/2000/svg",xhtml:Xx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wD.hasOwnProperty(t)?{space:wD[t],local:e}:e}function une(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Xx&&t.documentElement.namespaceURI===Xx?t.createElement(e):t.createElementNS(n,e)}}function dne(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xD(e){var t=nh(e);return(t.local?dne:une)(t)}function fne(){}function Zx(e){return e==null?fne:function(){return this.querySelector(e)}}function pne(e){typeof e!="function"&&(e=Zx(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new sr(r,this._parents)}function hne(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mne(){return[]}function _D(e){return e==null?mne:function(){return this.querySelectorAll(e)}}function yne(e){return function(){return hne(e.apply(this,arguments))}}function gne(e){typeof e=="function"?e=yne(e):e=_D(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new sr(r,a)}function jD(e){return function(){return this.matches(e)}}function SD(e){return function(t){return t.matches(e)}}var vne=Array.prototype.find;function bne(e){return function(){return vne.call(this.children,e)}}function wne(){return this.firstElementChild}function xne(e){return this.select(e==null?wne:bne(typeof e=="function"?e:SD(e)))}var _ne=Array.prototype.filter;function jne(){return Array.from(this.children)}function Sne(e){return function(){return _ne.call(this.children,e)}}function Ene(e){return this.selectAll(e==null?jne:Sne(typeof e=="function"?e:SD(e)))}function One(e){typeof e!="function"&&(e=jD(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new sr(r,this._parents)}function ED(e){return new Array(e.length)}function Cne(){return new sr(this._enter||this._groups.map(ED),this._parents)}function rh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rh.prototype={constructor:rh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Nne(e){return function(){return e}}function Mne(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new rh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function Pne(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,f=new Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=i.call(c,c.__data__,s,t)+"",l.has(p)?a[s]=c:l.set(p,c));for(s=0;s<d;++s)p=i.call(e,o[s],s,o)+"",(c=l.get(p))?(r[s]=c,c.__data__=o[s],l.delete(p)):n[s]=new rh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(a[s]=c)}function kne(e){return e.__data__}function Ane(e,t){if(!arguments.length)return Array.from(this,kne);var n=t?Pne:Mne,r=this._parents,a=this._groups;typeof e!="function"&&(e=Nne(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],f=d.length,p=Tne(e.call(u,u&&u.__data__,l,r)),y=p.length,m=s[l]=new Array(y),v=i[l]=new Array(y),b=c[l]=new Array(f);n(u,d,m,v,b,p,t);for(var w=0,_=0,x,j;w<y;++w)if(x=m[w]){for(w>=_&&(_=w+1);!(j=v[_])&&++_<y;);x._next=j||null}}return i=new sr(i,r),i._enter=s,i._exit=c,i}function Tne(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ine(){return new sr(this._exit||this._groups.map(ED),this._parents)}function Rne(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function Dne(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),p,y=0;y<d;++y)(p=l[y]||u[y])&&(f[y]=p);for(;c<a;++c)s[c]=n[c];return new sr(s,this._parents)}function Lne(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function $ne(e){e||(e=Fne);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new sr(a,this._parents).order()}function Fne(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Bne(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function zne(){return Array.from(this)}function Vne(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function Une(){let e=0;for(const t of this)++e;return e}function Wne(){return!this.node()}function Hne(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function qne(e){return function(){this.removeAttribute(e)}}function Kne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yne(e,t){return function(){this.setAttribute(e,t)}}function Gne(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Xne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Zne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Jne(e,t){var n=nh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Kne:qne:typeof t=="function"?n.local?Zne:Xne:n.local?Gne:Yne)(n,t))}function OD(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Qne(e){return function(){this.style.removeProperty(e)}}function ere(e,t,n){return function(){this.style.setProperty(e,t,n)}}function tre(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function nre(e,t,n){return arguments.length>1?this.each((t==null?Qne:typeof t=="function"?tre:ere)(e,t,n??"")):ec(this.node(),e)}function ec(e,t){return e.style.getPropertyValue(t)||OD(e).getComputedStyle(e,null).getPropertyValue(t)}function rre(e){return function(){delete this[e]}}function are(e,t){return function(){this[e]=t}}function ore(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ire(e,t){return arguments.length>1?this.each((t==null?rre:typeof t=="function"?ore:are)(e,t)):this.node()[e]}function CD(e){return e.trim().split(/^|\s+/)}function Jx(e){return e.classList||new ND(e)}function ND(e){this._node=e,this._names=CD(e.getAttribute("class")||"")}ND.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function MD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function PD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function sre(e){return function(){MD(this,e)}}function cre(e){return function(){PD(this,e)}}function lre(e,t){return function(){(t.apply(this,arguments)?MD:PD)(this,e)}}function ure(e,t){var n=CD(e+"");if(arguments.length<2){for(var r=Jx(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?lre:t?sre:cre)(n,t))}function dre(){this.textContent=""}function fre(e){return function(){this.textContent=e}}function pre(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function hre(e){return arguments.length?this.each(e==null?dre:(typeof e=="function"?pre:fre)(e)):this.node().textContent}function mre(){this.innerHTML=""}function yre(e){return function(){this.innerHTML=e}}function gre(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function vre(e){return arguments.length?this.each(e==null?mre:(typeof e=="function"?gre:yre)(e)):this.node().innerHTML}function bre(){this.nextSibling&&this.parentNode.appendChild(this)}function wre(){return this.each(bre)}function xre(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _re(){return this.each(xre)}function jre(e){var t=typeof e=="function"?e:xD(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Sre(){return null}function Ere(e,t){var n=typeof e=="function"?e:xD(e),r=t==null?Sre:typeof t=="function"?t:Zx(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ore(){var e=this.parentNode;e&&e.removeChild(this)}function Cre(){return this.each(Ore)}function Nre(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mre(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pre(e){return this.select(e?Mre:Nre)}function kre(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Are(e){return function(t){e.call(this,t,this.__data__)}}function Tre(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ire(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Rre(e,t,n){return function(){var r=this.__on,a,o=Are(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function Dre(e,t,n){var r=Tre(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?Rre:Ire,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function kD(e,t,n){var r=OD(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Lre(e,t){return function(){return kD(this,e,t)}}function $re(e,t){return function(){return kD(this,e,t.apply(this,arguments))}}function Fre(e,t){return this.each((typeof t=="function"?$re:Lre)(e,t))}function*Bre(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var AD=[null];function sr(e,t){this._groups=e,this._parents=t}function Au(){return new sr([[document.documentElement]],AD)}function zre(){return this}sr.prototype=Au.prototype={constructor:sr,select:pne,selectAll:gne,selectChild:xne,selectChildren:Ene,filter:One,data:Ane,enter:Cne,exit:Ine,join:Rne,merge:Dne,selection:zre,order:Lne,sort:$ne,call:Bne,nodes:zne,node:Vne,size:Une,empty:Wne,each:Hne,attr:Jne,style:nre,property:ire,classed:ure,text:hre,html:vre,raise:wre,lower:_re,append:jre,insert:Ere,remove:Cre,clone:Pre,datum:kre,on:Dre,dispatch:Fre,[Symbol.iterator]:Bre};function cr(e){return typeof e=="string"?new sr([[document.querySelector(e)]],[document.documentElement]):new sr([[e]],AD)}function Vre(e){let t;for(;t=e.sourceEvent;)e=t;return e}function zr(e,t){if(e=Vre(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ure={passive:!1},Tu={capture:!0,passive:!1};function Qx(e){e.stopImmediatePropagation()}function tc(e){e.preventDefault(),e.stopImmediatePropagation()}function TD(e){var t=e.document.documentElement,n=cr(e).on("dragstart.drag",tc,Tu);"onselectstart"in t?n.on("selectstart.drag",tc,Tu):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ID(e,t){var n=e.document.documentElement,r=cr(e).on("dragstart.drag",null);t&&(r.on("click.drag",tc,Tu),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ah=e=>()=>e;function e1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}e1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wre(e){return!e.ctrlKey&&!e.button}function Hre(){return this.parentNode}function qre(e,t){return t??{x:e.x,y:e.y}}function Kre(){return navigator.maxTouchPoints||"ontouchstart"in this}function RD(){var e=Wre,t=Hre,n=qre,r=Kre,a={},o=eh("start","drag","end"),i=0,s,c,l,u,d=0;function f(x){x.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,Ure).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(x,j){if(!(u||!e.call(this,x,j))){var S=_(this,t.call(this,x,j),x,j,"mouse");S&&(cr(x.view).on("mousemove.drag",y,Tu).on("mouseup.drag",m,Tu),TD(x.view),Qx(x),l=!1,s=x.clientX,c=x.clientY,S("start",x))}}function y(x){if(tc(x),!l){var j=x.clientX-s,S=x.clientY-c;l=j*j+S*S>d}a.mouse("drag",x)}function m(x){cr(x.view).on("mousemove.drag mouseup.drag",null),ID(x.view,l),tc(x),a.mouse("end",x)}function v(x,j){if(e.call(this,x,j)){var S=x.changedTouches,E=t.call(this,x,j),O=S.length,M,N;for(M=0;M<O;++M)(N=_(this,E,x,j,S[M].identifier,S[M]))&&(Qx(x),N("start",x,S[M]))}}function b(x){var j=x.changedTouches,S=j.length,E,O;for(E=0;E<S;++E)(O=a[j[E].identifier])&&(tc(x),O("drag",x,j[E]))}function w(x){var j=x.changedTouches,S=j.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<S;++E)(O=a[j[E].identifier])&&(Qx(x),O("end",x,j[E]))}function _(x,j,S,E,O,M){var N=o.copy(),P=zr(M||S,j),I,k,C;if((C=n.call(x,new e1("beforestart",{sourceEvent:S,target:f,identifier:O,active:i,x:P[0],y:P[1],dx:0,dy:0,dispatch:N}),E))!=null)return I=C.x-P[0]||0,k=C.y-P[1]||0,function A(T,D,L){var R=P,F;switch(T){case"start":a[O]=A,F=i++;break;case"end":delete a[O],--i;case"drag":P=zr(L||D,j),F=i;break}N.call(T,x,new e1(T,{sourceEvent:D,subject:C,target:f,identifier:O,active:F,x:P[0]+I,y:P[1]+k,dx:P[0]-R[0],dy:P[1]-R[1],dispatch:N}),E)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:ah(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:ah(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:ah(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:ah(!!x),f):r},f.on=function(){var x=o.on.apply(o,arguments);return x===o?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function t1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function DD(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Iu(){}var Ru=.7,oh=1/Ru,nc="\\s*([+-]?\\d+)\\s*",Du="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yre=/^#([0-9a-f]{3,8})$/,Gre=new RegExp(`^rgb\\(${nc},${nc},${nc}\\)$`),Xre=new RegExp(`^rgb\\(${_a},${_a},${_a}\\)$`),Zre=new RegExp(`^rgba\\(${nc},${nc},${nc},${Du}\\)$`),Jre=new RegExp(`^rgba\\(${_a},${_a},${_a},${Du}\\)$`),Qre=new RegExp(`^hsl\\(${Du},${_a},${_a}\\)$`),eae=new RegExp(`^hsla\\(${Du},${_a},${_a},${Du}\\)$`),LD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t1(Iu,Vi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$D,formatHex:$D,formatHex8:tae,formatHsl:nae,formatRgb:FD,toString:FD});function $D(){return this.rgb().formatHex()}function tae(){return this.rgb().formatHex8()}function nae(){return WD(this).formatHsl()}function FD(){return this.rgb().formatRgb()}function Vi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Yre.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?BD(t):n===3?new Un(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ih(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ih(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Gre.exec(e))?new Un(t[1],t[2],t[3],1):(t=Xre.exec(e))?new Un(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Zre.exec(e))?ih(t[1],t[2],t[3],t[4]):(t=Jre.exec(e))?ih(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Qre.exec(e))?UD(t[1],t[2]/100,t[3]/100,1):(t=eae.exec(e))?UD(t[1],t[2]/100,t[3]/100,t[4]):LD.hasOwnProperty(e)?BD(LD[e]):e==="transparent"?new Un(NaN,NaN,NaN,0):null}function BD(e){return new Un(e>>16&255,e>>8&255,e&255,1)}function ih(e,t,n,r){return r<=0&&(e=t=n=NaN),new Un(e,t,n,r)}function rae(e){return e instanceof Iu||(e=Vi(e)),e?(e=e.rgb(),new Un(e.r,e.g,e.b,e.opacity)):new Un}function n1(e,t,n,r){return arguments.length===1?rae(e):new Un(e,t,n,r??1)}function Un(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}t1(Un,n1,DD(Iu,{brighter(e){return e=e==null?oh:Math.pow(oh,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ru:Math.pow(Ru,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Un(Ui(this.r),Ui(this.g),Ui(this.b),sh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zD,formatHex:zD,formatHex8:aae,formatRgb:VD,toString:VD}));function zD(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}`}function aae(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}${Wi((isNaN(this.opacity)?1:this.opacity)*255)}`}function VD(){const e=sh(this.opacity);return`${e===1?"rgb(":"rgba("}${Ui(this.r)}, ${Ui(this.g)}, ${Ui(this.b)}${e===1?")":`, ${e})`}`}function sh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ui(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wi(e){return e=Ui(e),(e<16?"0":"")+e.toString(16)}function UD(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Vr(e,t,n,r)}function WD(e){if(e instanceof Vr)return new Vr(e.h,e.s,e.l,e.opacity);if(e instanceof Iu||(e=Vi(e)),!e)return new Vr;if(e instanceof Vr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new Vr(i,s,c,e.opacity)}function oae(e,t,n,r){return arguments.length===1?WD(e):new Vr(e,t,n,r??1)}function Vr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t1(Vr,oae,DD(Iu,{brighter(e){return e=e==null?oh:Math.pow(oh,e),new Vr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ru:Math.pow(Ru,e),new Vr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Un(r1(e>=240?e-240:e+120,a,r),r1(e,a,r),r1(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Vr(HD(this.h),ch(this.s),ch(this.l),sh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sh(this.opacity);return`${e===1?"hsl(":"hsla("}${HD(this.h)}, ${ch(this.s)*100}%, ${ch(this.l)*100}%${e===1?")":`, ${e})`}`}}));function HD(e){return e=(e||0)%360,e<0?e+360:e}function ch(e){return Math.max(0,Math.min(1,e||0))}function r1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const a1=e=>()=>e;function iae(e,t){return function(n){return e+n*t}}function sae(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function cae(e){return(e=+e)==1?qD:function(t,n){return n-t?sae(t,n,e):a1(isNaN(t)?n:t)}}function qD(e,t){var n=t-e;return n?iae(e,n):a1(isNaN(e)?t:e)}const lh=function e(t){var n=cae(t);function r(a,o){var i=n((a=n1(a)).r,(o=n1(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=qD(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function lae(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function uae(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dae(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=rc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function fae(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ur(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function pae(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=rc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var o1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,i1=new RegExp(o1.source,"g");function hae(e){return function(){return e}}function mae(e){return function(t){return e(t)+""}}function KD(e,t){var n=o1.lastIndex=i1.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=o1.exec(e))&&(a=i1.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:Ur(r,a)})),n=i1.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?mae(c[0].x):hae(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function rc(e,t){var n=typeof t,r;return t==null||n==="boolean"?a1(t):(n==="number"?Ur:n==="string"?(r=Vi(t))?(t=r,lh):KD:t instanceof Vi?lh:t instanceof Date?fae:uae(t)?lae:Array.isArray(t)?dae:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?pae:Ur)(e,t)}function s1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var YD=180/Math.PI,GD={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function XD(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*YD,skewX:Math.atan(c)*YD,scaleX:i,scaleY:s}}var uh;function yae(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?GD:XD(t.a,t.b,t.c,t.d,t.e,t.f)}function gae(e){return e==null||(uh||(uh=document.createElementNS("http://www.w3.org/2000/svg","g")),uh.setAttribute("transform",e),!(e=uh.transform.baseVal.consolidate()))?GD:(e=e.matrix,XD(e.a,e.b,e.c,e.d,e.e,e.f))}function ZD(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push("translate(",null,t,null,n);y.push({i:m-4,x:Ur(l,d)},{i:m-2,x:Ur(u,f)})}else(d||f)&&p.push("translate("+d+t+f+n)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(a(d)+"rotate(",null,r)-2,x:Ur(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(a(d)+"skewX(",null,r)-2,x:Ur(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push(a(p)+"scale(",null,",",null,")");y.push({i:m-4,x:Ur(l,d)},{i:m-2,x:Ur(u,f)})}else(d!==1||f!==1)&&p.push(a(p)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(p){for(var y=-1,m=f.length,v;++y<m;)d[(v=f[y]).i]=v.x(p);return d.join("")}}}var vae=ZD(yae,"px, ","px)","deg)"),bae=ZD(gae,", ",")",")"),wae=1e-12;function JD(e){return((e=Math.exp(e))+1/e)/2}function xae(e){return((e=Math.exp(e))-1/e)/2}function _ae(e){return((e=Math.exp(2*e))-1)/(e+1)}const jae=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],f=i[2],p=u-s,y=d-c,m=p*p+y*y,v,b;if(m<wae)b=Math.log(f/l)/t,v=function(E){return[s+E*p,c+E*y,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(m),_=(f*f-l*l+r*m)/(2*l*n*w),x=(f*f-l*l-r*m)/(2*f*n*w),j=Math.log(Math.sqrt(_*_+1)-_),S=Math.log(Math.sqrt(x*x+1)-x);b=(S-j)/t,v=function(E){var O=E*b,M=JD(j),N=l/(n*w)*(M*_ae(t*O+j)-xae(j));return[s+N*p,c+N*y,l*M/JD(t*O+j)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Sae(e,t){t===void 0&&(t=e,e=rc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var ac=0,Lu=0,$u=0,QD=1e3,dh,Fu,fh=0,Hi=0,ph=0,Bu=typeof performance=="object"&&performance.now?performance:Date,e3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function c1(){return Hi||(e3(Eae),Hi=Bu.now()+ph)}function Eae(){Hi=0}function hh(){this._call=this._time=this._next=null}hh.prototype=t3.prototype={constructor:hh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?c1():+n)+(t==null?0:+t),!this._next&&Fu!==this&&(Fu?Fu._next=this:dh=this,Fu=this),this._call=e,this._time=n,l1()},stop:function(){this._call&&(this._call=null,this._time=1/0,l1())}};function t3(e,t,n){var r=new hh;return r.restart(e,t,n),r}function Oae(){c1(),++ac;for(var e=dh,t;e;)(t=Hi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ac}function n3(){Hi=(fh=Bu.now())+ph,ac=Lu=0;try{Oae()}finally{ac=0,Nae(),Hi=0}}function Cae(){var e=Bu.now(),t=e-fh;t>QD&&(ph-=t,fh=e)}function Nae(){for(var e,t=dh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:dh=n);Fu=e,l1(r)}function l1(e){if(!ac){Lu&&(Lu=clearTimeout(Lu));var t=e-Hi;t>24?(e<1/0&&(Lu=setTimeout(n3,e-Bu.now()-ph)),$u&&($u=clearInterval($u))):($u||(fh=Bu.now(),$u=setInterval(Cae,QD)),ac=1,e3(n3))}}function r3(e,t,n){var r=new hh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var Mae=eh("start","end","cancel","interrupt"),Pae=[],a3=0,o3=1,u1=2,mh=3,i3=4,d1=5,yh=6;function gh(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;kae(e,n,{name:t,index:r,group:a,on:Mae,tween:Pae,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:a3})}function f1(e,t){var n=Wr(e,t);if(n.state>a3)throw new Error("too late; already scheduled");return n}function ja(e,t){var n=Wr(e,t);if(n.state>mh)throw new Error("too late; already running");return n}function Wr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function kae(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=t3(o,0,n.time);function o(l){n.state=o3,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,f,p;if(n.state!==o3)return c();for(u in r)if(p=r[u],p.name===n.name){if(p.state===mh)return r3(i);p.state===i3?(p.state=yh,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=yh,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(r3(function(){n.state===mh&&(n.state=i3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=u1,n.on.call("start",e,e.__data__,n.index,n.group),n.state===u1){for(n.state=mh,a=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=p);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=d1,1),d=-1,f=a.length;++d<f;)a[d].call(e,u);n.state===d1&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=yh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function vh(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>u1&&r.state<d1,r.state=yh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function Aae(e){return this.each(function(){vh(this,e)})}function Tae(e,t){var n,r;return function(){var a=ja(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function Iae(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=ja(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function Rae(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Wr(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?Tae:Iae)(n,e,t))}function p1(e,t,n){var r=e._id;return e.each(function(){var a=ja(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return Wr(a,r).value[t]}}function s3(e,t){var n;return(typeof t=="number"?Ur:t instanceof Vi?lh:(n=Vi(t))?(t=n,lh):KD)(e,t)}function Dae(e){return function(){this.removeAttribute(e)}}function Lae(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $ae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function Fae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function Bae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function zae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Vae(e,t){var n=nh(e),r=n==="transform"?bae:s3;return this.attrTween(e,typeof t=="function"?(n.local?zae:Bae)(n,r,p1(this,"attr."+e,t)):t==null?(n.local?Lae:Dae)(n):(n.local?Fae:$ae)(n,r,t))}function Uae(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Wae(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Hae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Wae(e,o)),n}return a._value=t,a}function qae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Uae(e,o)),n}return a._value=t,a}function Kae(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=nh(e);return this.tween(n,(r.local?Hae:qae)(r,t))}function Yae(e,t){return function(){f1(this,e).delay=+t.apply(this,arguments)}}function Gae(e,t){return t=+t,function(){f1(this,e).delay=t}}function Xae(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yae:Gae)(t,e)):Wr(this.node(),t).delay}function Zae(e,t){return function(){ja(this,e).duration=+t.apply(this,arguments)}}function Jae(e,t){return t=+t,function(){ja(this,e).duration=t}}function Qae(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Zae:Jae)(t,e)):Wr(this.node(),t).duration}function eoe(e,t){if(typeof t!="function")throw new Error;return function(){ja(this,e).ease=t}}function toe(e){var t=this._id;return arguments.length?this.each(eoe(t,e)):Wr(this.node(),t).ease}function noe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ja(this,e).ease=n}}function roe(e){if(typeof e!="function")throw new Error;return this.each(noe(this._id,e))}function aoe(e){typeof e!="function"&&(e=jD(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new ho(r,this._parents,this._name,this._id)}function ooe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)i[s]=t[s];return new ho(i,this._parents,this._name,this._id)}function ioe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function soe(e,t,n){var r,a,o=ioe(t)?f1:ja;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function coe(e,t){var n=this._id;return arguments.length<2?Wr(this.node(),n).on.on(e):this.each(soe(n,e,t))}function loe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function uoe(){return this.on("end.remove",loe(this._id))}function doe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Zx(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,gh(l[f],t,n,f,l,Wr(u,n)));return new ho(o,this._parents,t,n)}function foe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_D(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,y=Wr(u,n),m=0,v=f.length;m<v;++m)(p=f[m])&&gh(p,t,n,m,f,y);o.push(f),i.push(u)}return new ho(o,i,t,n)}var poe=Au.prototype.constructor;function hoe(){return new poe(this._groups,this._parents)}function moe(e,t){var n,r,a;return function(){var o=ec(this,e),i=(this.style.removeProperty(e),ec(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function c3(e){return function(){this.style.removeProperty(e)}}function yoe(e,t,n){var r,a=n+"",o;return function(){var i=ec(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function goe(e,t,n){var r,a,o;return function(){var i=ec(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),ec(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function voe(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=ja(this,e),l=c.on,u=c.value[o]==null?s||(s=c3(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function boe(e,t,n){var r=(e+="")=="transform"?vae:s3;return t==null?this.styleTween(e,moe(e,r)).on("end.style."+e,c3(e)):typeof t=="function"?this.styleTween(e,goe(e,r,p1(this,"style."+e,t))).each(voe(this._id,e)):this.styleTween(e,yoe(e,r,t),n).on("end.style."+e,null)}function woe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function xoe(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&woe(e,i,n)),r}return o._value=t,o}function _oe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,xoe(e,t,n??""))}function joe(e){return function(){this.textContent=e}}function Soe(e){return function(){var t=e(this);this.textContent=t??""}}function Eoe(e){return this.tween("text",typeof e=="function"?Soe(p1(this,"text",e)):joe(e==null?"":e+""))}function Ooe(e){return function(t){this.textContent=e.call(this,t)}}function Coe(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Ooe(a)),t}return r._value=e,r}function Noe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Coe(e))}function Moe(){for(var e=this._name,t=this._id,n=l3(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=Wr(c,t);gh(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ho(r,this._parents,e,n)}function Poe(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=ja(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var koe=0;function ho(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function l3(){return++koe}var mo=Au.prototype;ho.prototype={constructor:ho,select:doe,selectAll:foe,selectChild:mo.selectChild,selectChildren:mo.selectChildren,filter:aoe,merge:ooe,selection:hoe,transition:Moe,call:mo.call,nodes:mo.nodes,node:mo.node,size:mo.size,empty:mo.empty,each:mo.each,on:coe,attr:Vae,attrTween:Kae,style:boe,styleTween:_oe,text:Eoe,textTween:Noe,remove:uoe,tween:Rae,delay:Xae,duration:Qae,ease:toe,easeVarying:roe,end:Poe,[Symbol.iterator]:mo[Symbol.iterator]};function Aoe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Toe={time:null,delay:0,duration:250,ease:Aoe};function Ioe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Roe(e){var t,n;e instanceof ho?(t=e._id,e=e._name):(t=l3(),(n=Toe).time=c1(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&gh(c,e,t,l,i,n||Ioe(c,t));return new ho(r,this._parents,e,t)}Au.prototype.interrupt=Aae,Au.prototype.transition=Roe;const bh=e=>()=>e;function Doe(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function yo(e,t,n){this.k=e,this.x=t,this.y=n}yo.prototype={constructor:yo,scale:function(e){return e===1?this:new yo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new yo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wh=new yo(1,0,0);u3.prototype=yo.prototype;function u3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return wh;return e.__zoom}function h1(e){e.stopImmediatePropagation()}function zu(e){e.preventDefault(),e.stopImmediatePropagation()}function Loe(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function $oe(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function d3(){return this.__zoom||wh}function Foe(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Boe(){return navigator.maxTouchPoints||"ontouchstart"in this}function zoe(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function f3(){var e=Loe,t=$oe,n=zoe,r=Foe,a=Boe,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=jae,l=eh("start","zoom","end"),u,d,f,p=500,y=150,m=0,v=10;function b(C){C.property("__zoom",d3).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",N).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,A,T,D){var L=C.selection?C.selection():C;L.property("__zoom",d3),C!==L?j(C,A,T,D):L.interrupt().each(function(){S(this,arguments).event(D).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},b.scaleBy=function(C,A,T,D){b.scaleTo(C,function(){var L=this.__zoom.k,R=typeof A=="function"?A.apply(this,arguments):A;return L*R},T,D)},b.scaleTo=function(C,A,T,D){b.transform(C,function(){var L=t.apply(this,arguments),R=this.__zoom,F=T==null?x(L):typeof T=="function"?T.apply(this,arguments):T,V=R.invert(F),$=typeof A=="function"?A.apply(this,arguments):A;return n(_(w(R,$),F,V),L,i)},T,D)},b.translateBy=function(C,A,T,D){b.transform(C,function(){return n(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof T=="function"?T.apply(this,arguments):T),t.apply(this,arguments),i)},null,D)},b.translateTo=function(C,A,T,D,L){b.transform(C,function(){var R=t.apply(this,arguments),F=this.__zoom,V=D==null?x(R):typeof D=="function"?D.apply(this,arguments):D;return n(wh.translate(V[0],V[1]).scale(F.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof T=="function"?-T.apply(this,arguments):-T),R,i)},D,L)};function w(C,A){return A=Math.max(o[0],Math.min(o[1],A)),A===C.k?C:new yo(A,C.x,C.y)}function _(C,A,T){var D=A[0]-T[0]*C.k,L=A[1]-T[1]*C.k;return D===C.x&&L===C.y?C:new yo(C.k,D,L)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,A,T,D){C.on("start.zoom",function(){S(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(D).end()}).tween("zoom",function(){var L=this,R=arguments,F=S(L,R).event(D),V=t.apply(L,R),$=T==null?x(V):typeof T=="function"?T.apply(L,R):T,U=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),z=L.__zoom,K=typeof A=="function"?A.apply(L,R):A,ne=c(z.invert($).concat(U/z.k),K.invert($).concat(U/K.k));return function(Q){if(Q===1)Q=K;else{var Y=ne(Q),q=U/Y[2];Q=new yo(q,$[0]-Y[0]*q,$[1]-Y[1]*q)}F.zoom(null,Q)}})}function S(C,A,T){return!T&&C.__zooming||new E(C,A)}function E(C,A){this.that=C,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,A),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,A){return this.mouse&&C!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var A=cr(this.that).datum();l.call(C,this.that,new Doe(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),A)}};function O(C,...A){if(!e.apply(this,arguments))return;var T=S(this,A).event(C),D=this.__zoom,L=Math.max(o[0],Math.min(o[1],D.k*Math.pow(2,r.apply(this,arguments)))),R=zr(C);if(T.wheel)(T.mouse[0][0]!==R[0]||T.mouse[0][1]!==R[1])&&(T.mouse[1]=D.invert(T.mouse[0]=R)),clearTimeout(T.wheel);else{if(D.k===L)return;T.mouse=[R,D.invert(R)],vh(this),T.start()}zu(C),T.wheel=setTimeout(F,y),T.zoom("mouse",n(_(w(D,L),T.mouse[0],T.mouse[1]),T.extent,i));function F(){T.wheel=null,T.end()}}function M(C,...A){if(f||!e.apply(this,arguments))return;var T=C.currentTarget,D=S(this,A,!0).event(C),L=cr(C.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",U,!0),R=zr(C,T),F=C.clientX,V=C.clientY;TD(C.view),h1(C),D.mouse=[R,this.__zoom.invert(R)],vh(this),D.start();function $(z){if(zu(z),!D.moved){var K=z.clientX-F,ne=z.clientY-V;D.moved=K*K+ne*ne>m}D.event(z).zoom("mouse",n(_(D.that.__zoom,D.mouse[0]=zr(z,T),D.mouse[1]),D.extent,i))}function U(z){L.on("mousemove.zoom mouseup.zoom",null),ID(z.view,D.moved),zu(z),D.event(z).end()}}function N(C,...A){if(e.apply(this,arguments)){var T=this.__zoom,D=zr(C.changedTouches?C.changedTouches[0]:C,this),L=T.invert(D),R=T.k*(C.shiftKey?.5:2),F=n(_(w(T,R),D,L),t.apply(this,A),i);zu(C),s>0?cr(this).transition().duration(s).call(j,F,D,C):cr(this).call(b.transform,F,D,C)}}function P(C,...A){if(e.apply(this,arguments)){var T=C.touches,D=T.length,L=S(this,A,C.changedTouches.length===D).event(C),R,F,V,$;for(h1(C),F=0;F<D;++F)V=T[F],$=zr(V,this),$=[$,this.__zoom.invert($),V.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,R=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),R&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},p)),vh(this),L.start())}}function I(C,...A){if(this.__zooming){var T=S(this,A).event(C),D=C.changedTouches,L=D.length,R,F,V,$;for(zu(C),R=0;R<L;++R)F=D[R],V=zr(F,this),T.touch0&&T.touch0[2]===F.identifier?T.touch0[0]=V:T.touch1&&T.touch1[2]===F.identifier&&(T.touch1[0]=V);if(F=T.that.__zoom,T.touch1){var U=T.touch0[0],z=T.touch0[1],K=T.touch1[0],ne=T.touch1[1],Q=(Q=K[0]-U[0])*Q+(Q=K[1]-U[1])*Q,Y=(Y=ne[0]-z[0])*Y+(Y=ne[1]-z[1])*Y;F=w(F,Math.sqrt(Q/Y)),V=[(U[0]+K[0])/2,(U[1]+K[1])/2],$=[(z[0]+ne[0])/2,(z[1]+ne[1])/2]}else if(T.touch0)V=T.touch0[0],$=T.touch0[1];else return;T.zoom("touch",n(_(F,V,$),T.extent,i))}}function k(C,...A){if(this.__zooming){var T=S(this,A).event(C),D=C.changedTouches,L=D.length,R,F;for(h1(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),R=0;R<L;++R)F=D[R],T.touch0&&T.touch0[2]===F.identifier?delete T.touch0:T.touch1&&T.touch1[2]===F.identifier&&delete T.touch1;if(T.touch1&&!T.touch0&&(T.touch0=T.touch1,delete T.touch1),T.touch0)T.touch0[1]=this.__zoom.invert(T.touch0[0]);else if(T.end(),T.taps===2&&(F=zr(F,this),Math.hypot(d[0]-F[0],d[1]-F[1])<v)){var V=cr(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:bh(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:bh(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:bh(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:bh([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,b):Math.sqrt(m)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const go={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},Vu=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],p3=["Enter"," ","Escape"];var oc;(function(e){e.Strict="strict",e.Loose="loose"})(oc||(oc={}));var ti;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ti||(ti={}));var Uu;(function(e){e.Partial="partial",e.Full="full"})(Uu||(Uu={}));const h3={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ni;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ni||(ni={}));var xh;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(xh||(xh={}));var pe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(pe||(pe={}));const m3={[pe.Left]:pe.Right,[pe.Right]:pe.Left,[pe.Top]:pe.Bottom,[pe.Bottom]:pe.Top};function Voe(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function y3(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function g3(e){return e===null?null:e?"valid":"invalid"}const v3=e=>"id"in e&&"source"in e&&"target"in e,Uoe=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),m1=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Wu=(e,t=[0,0])=>{const{width:n,height:r}=vo(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},Woe=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):m1(a)?a:t.nodeLookup.get(a.id));const s=i?Sh(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return _h(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return jh(n)},Hu=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=Sh(r);n=_h(n,a)}}),jh(n)},b3=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...Ku(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(i&&!d||f)continue;const p=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=qu(s,sc(l)),v=(p??0)*(y??0),b=o&&m>0;(!l.internals.handleBounds||b||m>=v||l.dragging)&&c.push(l)}return c},Hoe=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function y1(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function g1({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=Hu(e),c=b1(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function w3({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",go.error005());else{const p=s.measured.width,y=s.measured.height;p&&y&&(d=[[c,l],[c+p,l+y]])}else s&&cc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=cc(d)?qi(t,d,i.measured):t;return{position:{x:f.x-c+i.measured.width*u[0],y:f.y-l+i.measured.height*u[1]},positionAbsolute:f}}async function qoe({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const f=o.has(d.id),p=!f&&d.parentId&&i.find(y=>y.id===d.parentId);(f||p)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=Hoe(i,c);for(const d of c)s.has(d.id)&&!l.find(f=>f.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const ic=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),qi=(e={x:0,y:0},t,n)=>({x:ic(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:ic(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function x3(e,t,n){const{width:r,height:a}=vo(n),{x:o,y:i}=n.internals.positionAbsolute;return qi(e,[[o,i],[o+r,i+a]],t)}const _3=(e,t,n)=>e<t?ic(Math.abs(e-t),1,t)/t:e>n?-ic(Math.abs(e-n),1,t)/t:0,j3=(e,t,n=15,r=40)=>{const a=_3(e.x,r,t.width-r)*n,o=_3(e.y,r,t.height-r)*n;return[a,o]},_h=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),v1=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),jh=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),sc=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=m1(e)?e.internals.positionAbsolute:Wu(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},Sh=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=m1(e)?e.internals.positionAbsolute:Wu(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},S3=(e,t)=>jh(_h(v1(e),v1(t))),qu=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},E3=e=>Hr(e.width)&&Hr(e.height)&&Hr(e.x)&&Hr(e.y),Hr=e=>!isNaN(e)&&isFinite(e),Koe=(e,t)=>{},Eh=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ku=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?Eh(s,i):s},O3=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),b1=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=ic(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l;return{x:f,y:p,zoom:l}},Oh=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function cc(e){return e!==void 0&&e!=="parent"}function vo(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function C3(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function N3(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function Yu(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=bo(e),s=Ku({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?Eh(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Ch=e=>({width:e.offsetWidth,height:e.offsetHeight}),M3=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Yoe=["INPUT","SELECT","TEXTAREA"];function w1(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return Yoe.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const P3=e=>"clientX"in e,bo=(e,t)=>{var o,i;const n=P3(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},k3=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...Ch(i)}})};function A3({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function Nh(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function T3({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case pe.Left:return[t-Nh(t-r,o),n];case pe.Right:return[t+Nh(r-t,o),n];case pe.Top:return[t,n-Nh(n-a,o)];case pe.Bottom:return[t,n+Nh(a-n,o)]}}function I3({sourceX:e,sourceY:t,sourcePosition:n=pe.Bottom,targetX:r,targetY:a,targetPosition:o=pe.Top,curvature:i=.25}){const[s,c]=T3({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=T3({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,f,p,y]=A3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,f,p,y]}function R3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function Goe({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function Xoe({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=_h(Sh(e),Sh(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return qu(i,jh(o))>0}const Zoe=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Joe=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),D3=(e,t)=>{if(!e.source||!e.target)return t;let n;return v3(e)?n={...e}:n={...e,id:Zoe(e)},Joe(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function L3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=R3({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const $3={[pe.Left]:{x:-1,y:0},[pe.Right]:{x:1,y:0},[pe.Top]:{x:0,y:-1},[pe.Bottom]:{x:0,y:1}},Qoe=({source:e,sourcePosition:t=pe.Bottom,target:n})=>t===pe.Left||t===pe.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},F3=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function eie({source:e,sourcePosition:t=pe.Bottom,target:n,targetPosition:r=pe.Top,center:a,offset:o}){const i=$3[t],s=$3[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=Qoe({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let p=[],y,m;const v={x:0,y:0},b={x:0,y:0},[w,_,x,j]=R3({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){y=a.x??w,m=a.y??_;const S=[{x:y,y:c.y},{x:y,y:l.y}],E=[{x:c.x,y:m},{x:l.x,y:m}];i[d]===f?p=d==="x"?S:E:p=d==="x"?E:S}else{const S=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?p=i.x===f?E:S:p=i.y===f?S:E,t===r){const I=Math.abs(e[d]-n[d]);if(I<=o){const k=Math.min(o-1,o-I);i[d]===f?v[d]=(c[d]>e[d]?-1:1)*k:b[d]=(l[d]>n[d]?-1:1)*k}}if(t!==r){const I=d==="x"?"y":"x",k=i[d]===s[I],C=c[I]>l[I],A=c[I]<l[I];(i[d]===1&&(!k&&C||k&&A)||i[d]!==1&&(!k&&A||k&&C))&&(p=d==="x"?S:E)}const O={x:c.x+v.x,y:c.y+v.y},M={x:l.x+b.x,y:l.y+b.y},N=Math.max(Math.abs(O.x-p[0].x),Math.abs(M.x-p[0].x)),P=Math.max(Math.abs(O.y-p[0].y),Math.abs(M.y-p[0].y));N>=P?(y=(O.x+M.x)/2,m=p[0].y):(y=p[0].x,m=(O.y+M.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...p,{x:l.x+b.x,y:l.y+b.y},n],y,m,x,j]}function tie(e,t,n,r){const a=Math.min(F3(e,t)/2,F3(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function x1({sourceX:e,sourceY:t,sourcePosition:n=pe.Bottom,targetX:r,targetY:a,targetPosition:o=pe.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,p,y]=eie({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((m,v,b)=>{let w="";return b>0&&b<u.length-1?w=tie(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,m+=w,m},""),d,f,p,y]}function B3(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function nie(e){var d;const{sourceNode:t,targetNode:n}=e;if(!B3(t)||!B3(n))return null;const r=t.internals.handleBounds||z3(t.handles),a=n.internals.handleBounds||z3(n.handles),o=V3((r==null?void 0:r.source)??[],e.sourceHandle),i=V3(e.connectionMode===oc.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",go.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||pe.Bottom,c=(i==null?void 0:i.position)||pe.Top,l=Gu(t,o,s),u=Gu(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function z3(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Gu(e,t,n=pe.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??vo(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case pe.Top:return{x:a+i/2,y:o};case pe.Right:return{x:a+i,y:o+s/2};case pe.Bottom:return{x:a+i/2,y:o+s};case pe.Left:return{x:a,y:o+s/2}}}function V3(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function _1(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function rie(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=_1(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const j1={nodeOrigin:[0,0],nodeExtent:Vu,elevateNodesOnSelect:!0,defaults:{}},aie={...j1,checkEquality:!0};function S1(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function oie(e,t,n){const r=S1(j1,n);for(const a of e.values())if(a.parentId)O1(a,e,t,r);else{const o=Wu(a,r.nodeOrigin),i=cc(a.extent)?a.extent:r.nodeExtent,s=qi(o,i,vo(a));a.internals.positionAbsolute=s}}function E1(e,t,n,r){var s,c;const a=S1(aie,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=Wu(l,a.nodeOrigin),f=cc(l.extent)?l.extent:a.nodeExtent,p=qi(d,f,vo(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:U3(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&O1(u,t,n,r)}}function iie(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function O1(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=S1(j1,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}iie(e,n);const l=a?1e3:0,{x:u,y:d,z:f}=sie(e,c,o,i,l),{positionAbsolute:p}=e.internals,y=u!==p.x||d!==p.y;(y||f!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:y?{x:u,y:d}:p,z:f})}function U3(e,t){return(Hr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function sie(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=vo(e),c=Wu(e,n),l=cc(e.extent)?qi(c,e.extent,s):c;let u=qi({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=x3(u,s,t));const d=U3(e,a),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function C1(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??sc(c),u=S3(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=vo(c),f=c.origin??r,p=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,y=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,m=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(m-d.width)*f[0],w=(v-d.height)*f[1];(p>0||y>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-p+b,y:c.position.y-y+w}}),(_=n.get(l))==null||_.forEach(x=>{e.some(j=>j.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+p,y:x.position.y+y}})})),(d.width<s.width||d.height<s.height||p||y)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(p?f[0]*p-b:0),height:v+(y?f[1]*y-w:0)}})}),a}function cie(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const p=t.get(f.id);if(p)if(p.hidden)p.internals={...p.internals,handleBounds:void 0},s=!0;else{const y=Ch(f.nodeElement),m=p.measured.width!==y.width||p.measured.height!==y.height;if(y.width&&y.height&&(m||!p.internals.handleBounds||f.force)){const v=f.nodeElement.getBoundingClientRect(),b=cc(p.extent)?p.extent:o;let{positionAbsolute:w}=p.internals;p.parentId&&p.extent==="parent"?w=x3(w,y,t.get(p.parentId)):b&&(w=qi(w,b,y)),p.measured=y,p.internals={...p.internals,positionAbsolute:w,handleBounds:{source:k3("source",f.nodeElement,v,u,p.id),target:k3("target",f.nodeElement,v,u,p.id)}},p.parentId&&O1(p,t,n,{nodeOrigin:a}),s=!0,m&&(c.push({id:p.id,type:"dimensions",dimensions:y}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:sc(p,a)}))}}}if(d.length>0){const f=C1(d,t,n,a);c.push(...f)}return{changes:c,updatedInternals:s}}async function lie({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function W3(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,f={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,f)),e.set(l,d.set(`${a}-${i}`,f))}}function H3(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:H3(n,t):!1}function q3(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function uie(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!H3(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function N1({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function die({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,p=!1;function y({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:_,nodeId:x,nodeClickDistance:j=0}){f=cr(w);function S({x:N,y:P},I){const{nodeLookup:k,nodeExtent:C,snapGrid:A,snapToGrid:T,nodeOrigin:D,onNodeDrag:L,onSelectionDrag:R,onError:F,updateNodePositions:V}=t();o={x:N,y:P};let $=!1,U={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const z=Hu(s);U=v1(z)}for(const[z,K]of s){if(!k.has(z))continue;let ne={x:N-K.distance.x,y:P-K.distance.y};T&&(ne=Eh(ne,A));let Q=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!K.extent){const{positionAbsolute:X}=K.internals,te=X.x-U.x+C[0][0],B=X.x+K.measured.width-U.x2+C[1][0],ce=X.y-U.y+C[0][1],re=X.y+K.measured.height-U.y2+C[1][1];Q=[[te,ce],[B,re]]}const{position:Y,positionAbsolute:q}=w3({nodeId:z,nextPosition:ne,nodeLookup:k,nodeExtent:Q,nodeOrigin:D,onError:F});$=$||K.position.x!==Y.x||K.position.y!==Y.y,K.position=Y,K.internals.positionAbsolute=q}if($&&(V(s,!0),I&&(r||L||!x&&R))){const[z,K]=N1({nodeId:x,dragItems:s,nodeLookup:k});r==null||r(I,s,z,K),L==null||L(I,z,K),x||(R==null||R(I,K))}}async function E(){if(!u)return;const{transform:N,panBy:P,autoPanSpeed:I}=t(),[k,C]=j3(l,u,I);(k!==0||C!==0)&&(o.x=(o.x??0)-k/N[2],o.y=(o.y??0)-C/N[2],await P({x:k,y:C})&&S(o,null)),i=requestAnimationFrame(E)}function O(N){var $;const{nodeLookup:P,multiSelectionActive:I,nodesDraggable:k,transform:C,snapGrid:A,snapToGrid:T,selectNodesOnDrag:D,onNodeDragStart:L,onSelectionDragStart:R,unselectNodesAndEdges:F}=t();d=!0,(!D||!_)&&!I&&x&&(($=P.get(x))!=null&&$.selected||F()),_&&D&&x&&(e==null||e(x));const V=Yu(N.sourceEvent,{transform:C,snapGrid:A,snapToGrid:T,containerBounds:u});if(o=V,s=uie(P,k,V,x),s.size>0&&(n||L||!x&&R)){const[U,z]=N1({nodeId:x,dragItems:s,nodeLookup:P});n==null||n(N.sourceEvent,s,U,z),L==null||L(N.sourceEvent,U,z),x||(R==null||R(N.sourceEvent,z))}}const M=RD().clickDistance(j).on("start",N=>{const{domNode:P,nodeDragThreshold:I,transform:k,snapGrid:C,snapToGrid:A}=t();u=(P==null?void 0:P.getBoundingClientRect())||null,p=!1,I===0&&O(N),o=Yu(N.sourceEvent,{transform:k,snapGrid:C,snapToGrid:A,containerBounds:u}),l=bo(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:P,transform:I,snapGrid:k,snapToGrid:C,nodeDragThreshold:A,nodeLookup:T}=t(),D=Yu(N.sourceEvent,{transform:I,snapGrid:k,snapToGrid:C,containerBounds:u});if((N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||x&&!T.has(x))&&(p=!0),!p){if(!c&&P&&d&&(c=!0,E()),!d){const L=D.xSnapped-(o.x??0),R=D.ySnapped-(o.y??0);Math.sqrt(L*L+R*R)>A&&O(N)}(o.x!==D.xSnapped||o.y!==D.ySnapped)&&s&&d&&(l=bo(N.sourceEvent,u),S(D,N.sourceEvent))}}).on("end",N=>{if(!(!d||p)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:P,updateNodePositions:I,onNodeDragStop:k,onSelectionDragStop:C}=t();if(I(s,!1),a||k||!x&&C){const[A,T]=N1({nodeId:x,dragItems:s,nodeLookup:P,dragging:!1});a==null||a(N.sourceEvent,s,A,T),k==null||k(N.sourceEvent,A,T),x||(C==null||C(N.sourceEvent,T))}}}).filter(N=>{const P=N.target;return!N.button&&(!v||!q3(P,`.${v}`,w))&&(!b||q3(P,b,w))});f.call(M)}function m(){f==null||f.on(".drag",null)}return{update:y,destroy:m}}function fie(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())qu(a,sc(o))>0&&r.push(o);return r}const pie=250;function hie(e,t,n,r){var s,c;let a=[],o=1/0;const i=fie(e,n,t+pie);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:p}=Gu(l,d,d.position,!0),y=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(p-e.y,2));y>t||(y<o?(a=[{...d,x:f,y:p}],o=y):y===o&&a.push({...d,x:f,y:p}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function K3(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(f=>f.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...Gu(i,c,c.position,!0)}:c}function Y3(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function mie(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const G3=()=>!0;function yie(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:p,onConnectStart:y,onConnect:m,onConnectEnd:v,isValidConnection:b=G3,onReconnectEnd:w,updateConnection:_,getTransform:x,getFromHandle:j,autoPanSpeed:S}){const E=M3(e.target);let O=0,M;const{x:N,y:P}=bo(e),I=E==null?void 0:E.elementFromPoint(N,P),k=Y3(o,I),C=s==null?void 0:s.getBoundingClientRect();if(!C||!k)return;const A=K3(a,k,r,c,t);if(!A)return;let T=bo(e,C),D=!1,L=null,R=!1,F=null;function V(){if(!u||!C)return;const[Y,q]=j3(T,C,S);f({x:Y,y:q}),O=requestAnimationFrame(V)}const $={...A,nodeId:a,type:k,position:A.position},U=c.get(a),z={inProgress:!0,isValid:null,from:Gu(U,$,pe.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:U,to:T,toHandle:null,toPosition:m3[$.position],toNode:null};_(z);let K=z;y==null||y(e,{nodeId:a,handleId:r,handleType:k});function ne(Y){if(!j()||!$){Q(Y);return}const q=x();T=bo(Y,C),M=hie(Ku(T,q,!1,[1,1]),n,c,$),D||(V(),D=!0);const X=X3(Y,{handle:M,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});F=X.handleDomNode,L=X.connection,R=mie(!!M,X.isValid);const te={...K,isValid:R,to:M&&R?O3({x:M.x,y:M.y},q):T,toHandle:X.toHandle,toPosition:R&&X.toHandle?X.toHandle.position:m3[$.position],toNode:X.toHandle?c.get(X.toHandle.nodeId):null};R&&M&&K.toHandle&&te.toHandle&&K.toHandle.type===te.toHandle.type&&K.toHandle.nodeId===te.toHandle.nodeId&&K.toHandle.id===te.toHandle.id&&K.to.x===te.to.x&&K.to.y===te.to.y||(_(te),K=te)}function Q(Y){(M||F)&&L&&R&&(m==null||m(L));const{inProgress:q,...X}=K,te={...X,toPosition:K.toHandle?K.toPosition:null};v==null||v(Y,te),o&&(w==null||w(Y,te)),p(),cancelAnimationFrame(O),D=!1,R=!1,L=null,F=null,E.removeEventListener("mousemove",ne),E.removeEventListener("mouseup",Q),E.removeEventListener("touchmove",ne),E.removeEventListener("touchend",Q)}E.addEventListener("mousemove",ne),E.addEventListener("mouseup",Q),E.addEventListener("touchmove",ne),E.addEventListener("touchend",Q)}function X3(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=G3,nodeLookup:u}){const d=o==="target",f=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y}=bo(e),m=i.elementFromPoint(p,y),v=m!=null&&m.classList.contains(`${s}-flow__handle`)?m:f,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=Y3(void 0,v),_=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),j=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!_||!w)return b;const E={source:d?_:r,sourceHandle:d?x:a,target:d?r:_,targetHandle:d?a:x};b.connection=E;const O=j&&S&&(n===oc.Strict?d&&w==="source"||!d&&w==="target":_!==r||x!==a);b.isValid=O&&l(E),b.toHandle=K3(_,w,x,u,n,!1)}return b}const M1={onPointerDown:yie,isValid:X3};function gie({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=cr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:p=!1}){const y=_=>{const x=n();if(_.sourceEvent.type!=="wheel"||!t)return;const j=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,S=x[2]*Math.pow(2,j);t.scaleTo(S)};let m=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(m=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const x=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const j=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],S=[j[0]-m[0],j[1]-m[1]];m=j;const E=r()*Math.max(x[2],Math.log(x[2]))*(p?-1:1),O={x:x[0]-S[0]*E,y:x[1]-S[1]*E},M=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},M,s)},w=f3().on("start",v).on("zoom",d?b:null).on("zoom.wheel",f?y:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:zr}}const vie=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Mh=e=>({x:e.x,y:e.y,zoom:e.k}),P1=({x:e,y:t,zoom:n})=>wh.translate(e,t).scale(n),lc=(e,t)=>e.target.closest(`.${t}`),Z3=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),k1=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},J3=e=>{const t=e.ctrlKey&&Oh()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function bie({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(lc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=zr(u),b=J3(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const f=u.deltaMode===1?20:1;let p=a===ti.Vertical?0:u.deltaX*f,y=a===ti.Horizontal?0:u.deltaY*f;!Oh()&&u.shiftKey&&a!==ti.Vertical&&(p=u.deltaY*f,y=0),r.translateBy(n,-(p/d)*o,-(y/d)*o,{internal:!0});const m=Mh(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function wie({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||lc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function xie({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=Mh(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function _ie({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&Z3(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,Mh(o.transform)))}}function jie({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&Z3(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&vie(e.prevViewport,i.transform))){const c=Mh(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Sie({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var y;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(lc(u,`${l}-flow__node`)||lc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||lc(u,s)&&u.type==="wheel"||lc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const p=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&p}}function Eie({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=f3().clickDistance(!Hr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),p=cr(e).call(f);_({x:o.x,y:o.y,zoom:ic(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const y=p.on("wheel.zoom"),m=p.on("dblclick.zoom");f.wheelDelta(J3);function v(I,k){return p?new Promise(C=>{f==null||f.transform(k1(p,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function b({noWheelClassName:I,noPanClassName:k,onPaneContextMenu:C,userSelectionActive:A,panOnScroll:T,panOnDrag:D,panOnScrollMode:L,panOnScrollSpeed:R,preventScrolling:F,zoomOnPinch:V,zoomOnScroll:$,zoomOnDoubleClick:U,zoomActivationKeyPressed:z,lib:K,onTransformChange:ne}){A&&!u.isZoomingOrPanning&&w();const Q=T&&!z&&!A?bie({zoomPanValues:u,noWheelClassName:I,d3Selection:p,d3Zoom:f,panOnScrollMode:L,panOnScrollSpeed:R,zoomOnPinch:V,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):wie({noWheelClassName:I,preventScrolling:F,d3ZoomHandler:y});if(p.on("wheel.zoom",Q,{passive:!1}),!A){const q=xie({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});f.on("start",q);const X=_ie({zoomPanValues:u,panOnDrag:D,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:ne});f.on("zoom",X);const te=jie({zoomPanValues:u,panOnDrag:D,panOnScroll:T,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});f.on("end",te)}const Y=Sie({zoomActivationKeyPressed:z,panOnDrag:D,zoomOnScroll:$,panOnScroll:T,zoomOnDoubleClick:U,zoomOnPinch:V,userSelectionActive:A,noPanClassName:k,noWheelClassName:I,lib:K});f.filter(Y),U?p.on("dblclick.zoom",m):p.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function _(I,k,C){const A=P1(I),T=f==null?void 0:f.constrain()(A,k,C);return T&&await v(T),new Promise(D=>D(T))}async function x(I,k){const C=P1(I);return await v(C,k),new Promise(A=>A(C))}function j(I){if(p){const k=P1(I),C=p.property("__zoom");(C.k!==I.zoom||C.x!==I.x||C.y!==I.y)&&(f==null||f.transform(p,k,null,{sync:!0}))}}function S(){const I=p?u3(p.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function E(I,k){return p?new Promise(C=>{f==null||f.scaleTo(k1(p,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function O(I,k){return p?new Promise(C=>{f==null||f.scaleBy(k1(p,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function M(I){f==null||f.scaleExtent(I)}function N(I){f==null||f.translateExtent(I)}function P(I){const k=!Hr(I)||I<0?0:I;f==null||f.clickDistance(k)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:_,getViewport:S,scaleTo:E,scaleBy:O,setScaleExtent:M,setTranslateExtent:N,syncViewport:j,setClickDistance:P}}var uc;(function(e){e.Line="line",e.Handle="handle"})(uc||(uc={}));const Oie=["top-left","top-right","bottom-left","bottom-right"],Cie=["top","right","bottom","left"];function Nie({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function Mie(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function ri(e,t){return Math.max(0,t-e)}function ai(e,t){return Math.max(0,e-t)}function Ph(e,t,n){return Math.max(0,t-e,e-n)}function Q3(e,t){return e?!t:t}function Pie(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:p,ySnapped:y}=n,{minWidth:m,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:_,y:x,width:j,height:S,aspectRatio:E}=e;let O=Math.floor(u?p-e.pointerX:0),M=Math.floor(d?y-e.pointerY:0);const N=j+(c?-O:O),P=S+(l?-M:M),I=-o[0]*j,k=-o[1]*S;let C=Ph(N,m,v),A=Ph(P,b,w);if(i){let L=0,R=0;c&&O<0?L=ri(_+O+I,i[0][0]):!c&&O>0&&(L=ai(_+N+I,i[1][0])),l&&M<0?R=ri(x+M+k,i[0][1]):!l&&M>0&&(R=ai(x+P+k,i[1][1])),C=Math.max(C,L),A=Math.max(A,R)}if(s){let L=0,R=0;c&&O>0?L=ai(_+O,s[0][0]):!c&&O<0&&(L=ri(_+N,s[1][0])),l&&M>0?R=ai(x+M,s[0][1]):!l&&M<0&&(R=ri(x+P,s[1][1])),C=Math.max(C,L),A=Math.max(A,R)}if(a){if(u){const L=Ph(N/E,b,w)*E;if(C=Math.max(C,L),i){let R=0;!c&&!l||c&&!l&&f?R=ai(x+k+N/E,i[1][1])*E:R=ri(x+k+(c?O:-O)/E,i[0][1])*E,C=Math.max(C,R)}if(s){let R=0;!c&&!l||c&&!l&&f?R=ri(x+N/E,s[1][1])*E:R=ai(x+(c?O:-O)/E,s[0][1])*E,C=Math.max(C,R)}}if(d){const L=Ph(P*E,m,v)/E;if(A=Math.max(A,L),i){let R=0;!c&&!l||l&&!c&&f?R=ai(_+P*E+I,i[1][0])/E:R=ri(_+(l?M:-M)*E+I,i[0][0])/E,A=Math.max(A,R)}if(s){let R=0;!c&&!l||l&&!c&&f?R=ri(_+P*E,s[1][0])/E:R=ai(_+(l?M:-M)*E,s[0][0])/E,A=Math.max(A,R)}}}M=M+(M<0?A:-A),O=O+(O<0?C:-C),a&&(f?N>P*E?M=(Q3(c,l)?-O:O)/E:O=(Q3(c,l)?-M:M)*E:u?(M=O/E,l=c):(O=M*E,c=l));const T=c?_+O:_,D=l?x+M:x;return{width:j+(c?-O:O),height:S+(l?-M:M),x:o[0]*O*(c?-1:1)+T,y:o[1]*M*(l?-1:1)+D}}const e5={width:0,height:0,x:0,y:0},kie={...e5,pointerX:0,pointerY:0,aspectRatio:1};function Aie(e){return[[0,0],[e.measured.width,e.measured.height]]}function Tie(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function Iie({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=cr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:p,shouldResize:y}){let m={...e5},v={...kie};const b=Mie(c);let w,_=null,x=[],j,S,E;const O=RD().on("start",M=>{const{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:A}=n();if(w=N.get(t),!w)return;_=(A==null?void 0:A.getBoundingClientRect())??null;const{xSnapped:T,ySnapped:D}=Yu(M.sourceEvent,{transform:P,snapGrid:I,snapToGrid:k,containerBounds:_});m={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...m,pointerX:T,pointerY:D,aspectRatio:m.width/m.height},j=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(j=N.get(w.parentId),S=j&&w.extent==="parent"?Aie(j):void 0),x=[],E=void 0;for(const[L,R]of N)if(R.parentId===t&&(x.push({id:L,position:{...R.position},extent:R.extent}),R.extent==="parent"||R.expandParent)){const F=Tie(R,w,R.origin??C);E?E=[[Math.min(F[0][0],E[0][0]),Math.min(F[0][1],E[0][1])],[Math.max(F[1][0],E[1][0]),Math.max(F[1][1],E[1][1])]]:E=F}d==null||d(M,{...m})}).on("drag",M=>{const{transform:N,snapGrid:P,snapToGrid:I,nodeOrigin:k}=n(),C=Yu(M.sourceEvent,{transform:N,snapGrid:P,snapToGrid:I,containerBounds:_}),A=[];if(!w)return;const{x:T,y:D,width:L,height:R}=m,F={},V=w.origin??k,{width:$,height:U,x:z,y:K}=Pie(v,b,C,l,u,V,S,E),ne=$!==L,Q=U!==R,Y=z!==T&&ne,q=K!==D&&Q;if(!Y&&!q&&!ne&&!Q)return;if((Y||q||V[0]===1||V[1]===1)&&(F.x=Y?z:m.x,F.y=q?K:m.y,m.x=F.x,m.y=F.y,x.length>0)){const B=z-T,ce=K-D;for(const re of x)re.position={x:re.position.x-B+V[0]*($-L),y:re.position.y-ce+V[1]*(U-R)},A.push(re)}if((ne||Q)&&(F.width=ne?$:m.width,F.height=Q?U:m.height,m.width=F.width,m.height=F.height),j&&w.expandParent){const B=V[0]*(F.width??0);F.x&&F.x<B&&(m.x=B,v.x=v.x-(F.x-B));const ce=V[1]*(F.height??0);F.y&&F.y<ce&&(m.y=ce,v.y=v.y-(F.y-ce))}const X=Nie({width:m.width,prevWidth:L,height:m.height,prevHeight:R,affectsX:b.affectsX,affectsY:b.affectsY}),te={...m,direction:X};(y==null?void 0:y(M,te))!==!1&&(f==null||f(M,te),r(F,A))}).on("end",M=>{p==null||p(M,{...m}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var t5={exports:{}},A1={},n5;function Rie(){if(n5)return A1;n5=1;var e=cK(),t=gT();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return A1.useSyncExternalStoreWithSelector=function(l,u,d,f,p){var y=o(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=s(function(){function b(S){if(!w){if(w=!0,_=S,S=f(S),p!==void 0&&m.hasValue){var E=m.value;if(p(E,S))return x=E}return x=S}if(E=x,r(_,S))return E;var O=f(S);return p!==void 0&&p(E,O)?E:(_=S,x=O)}var w=!1,_,x,j=d===void 0?null:d;return[function(){return b(u())},j===null?void 0:function(){return b(j())}]},[u,d,f,p]);var v=a(l,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),c(v),v},A1}var r5;function Die(){return r5||(r5=1,t5.exports=Rie()),t5.exports}var Lie=Die();let a5,T1,o5,i5,s5,c5;RN=ot(Lie),a5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},T1=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(a5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},o5=e=>e?T1(e):T1,{useDebugValue:i5}=H,{useSyncExternalStoreWithSelector:s5}=RN,c5=e=>e;function l5(e,t=c5,n){const r=s5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return i5(r),r}const u5=(e,t)=>{const n=o5(e),r=(a,o=t)=>l5(n,a,o);return Object.assign(r,n),r},$ie=(e,t)=>e?u5(e,t):u5;function $t(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const kh=g.createContext(null),Fie=kh.Provider,d5=go.error001();function Ze(e,t){const n=g.useContext(kh);if(n===null)throw new Error(d5);return l5(n,e,t)}function Tt(){const e=g.useContext(kh);if(e===null)throw new Error(d5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const f5={display:"none"},Bie={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},p5="react-flow__node-desc",h5="react-flow__edge-desc",zie="react-flow__aria-live",Vie=e=>e.ariaLiveMessage;function Uie({rfId:e}){const t=Ze(Vie);return h.jsx("div",{id:`${zie}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Bie,children:t})}function Wie({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${p5}-${e}`,style:f5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${h5}-${e}`,style:f5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(Uie,{rfId:e})]})}const Hie=e=>e.userSelectionActive?"none":"all";function dc({position:e="top-left",children:t,className:n,style:r,...a}){const o=Ze(Hie),i=`${e}`.split("-");return h.jsx("div",{className:Xt(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function qie({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(dc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Kie=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Ah=e=>e.id;function Yie(e,t){return $t(e.selectedNodes.map(Ah),t.selectedNodes.map(Ah))&&$t(e.selectedEdges.map(Ah),t.selectedEdges.map(Ah))}function Gie({onSelectionChange:e}){const t=Tt(),{selectedNodes:n,selectedEdges:r}=Ze(Kie,Yie);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const Xie=e=>!!e.onSelectionChangeHandlers;function Zie({onSelectionChange:e}){const t=Ze(Xie);return e||t?h.jsx(Gie,{onSelectionChange:e}):null}const m5=[0,0],Jie={x:0,y:0,zoom:1},Qie=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],y5=[...Qie,"rfId"],ese=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),g5={translateExtent:Vu,nodeOrigin:m5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function tse(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Ze(ese,$t),u=Tt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=g5,s()}),[]);const d=g.useRef(g5);return g.useEffect(()=>{for(const f of y5){const p=e[f],y=d.current[f];p!==y&&(typeof e[f]>"u"||(f==="nodes"?t(p):f==="edges"?n(p):f==="minZoom"?r(p):f==="maxZoom"?a(p):f==="translateExtent"?o(p):f==="nodeExtent"?i(p):f==="paneClickDistance"?l(p):f==="fitView"?u.setState({fitViewOnInit:p}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:p}):u.setState({[f]:p})))}d.current=e},y5.map(f=>e[f])),null}function v5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function nse(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=v5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=v5())!=null&&r.matches?"dark":"light"}const b5=typeof document<"u"?document:null;function Xu(e=null,t={target:b5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||b5;if(e!==null){const l=f=>{if(a.current=f.ctrlKey||f.metaKey||f.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&w1(f))return!1;const p=x5(f.code,s);o.current.add(f[p]),w5(i,o.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&w1(f))return!1;const p=x5(f.code,s);w5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(f[p]),f.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function w5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function x5(e,t){return t.includes(e)?"code":"key"}const rse=()=>{const e=Tt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=y1(n,t),{width:c,height:l}=Ch(i);return g1({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=b1(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return Ku(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=O3(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function _5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)ase(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function ase(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ki(e,t){return _5(e,t)}function Zu(e,t){return _5(e,t)}function Yi(e,t){return{id:e,type:"select",selected:t}}function fc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(Yi(o.id,i)))}return r}function j5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function S5(e){return{id:e.id,type:"remove"}}const E5=e=>Uoe(e),ose=e=>v3(e);function O5(e){return g.forwardRef(e)}const ise=typeof window<"u"?g.useLayoutEffect:g.useEffect;function C5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>sse(()=>n(a=>a+BigInt(1))));return ise(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function sse(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const N5=g.createContext(null);function cse({children:e}){const t=Tt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let p=c;for(const y of s)p=typeof y=="function"?y(p):y;u?l(p):d&&d(j5({items:p,lookup:f}))},[]),r=C5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let p=c;for(const y of s)p=typeof y=="function"?y(p):y;u?l(p):d&&d(j5({items:p,lookup:f}))},[]),o=C5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(N5.Provider,{value:i,children:e})}function lse(){const e=g.useContext(N5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const use=e=>!!e.panZoom;function lr(){const e=rse(),t=Tt(),n=lse(),r=Ze(use),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:f,nodeOrigin:p}=t.getState(),y=E5(d)?d:f.get(d.id),m=y.parentId?N3(y.position,y.measured,y.parentId,f,p):y.position,v={id:y.id,position:m,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((w=y.measured)==null?void 0:w.height)??y.height,data:y.data};return sc(v)},l=(d,f,p={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return p.replace&&E5(v)?v:{...m,...v}}return m}))},u=(d,f,p={replace:!1})=>{s(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return p.replace&&ose(v)?v:{...m,...v}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=o(d))==null?void 0:f.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:p}=t.getState(),[y,m,v]=p;return{nodes:d.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:y,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:p,edges:y,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:_,onBeforeDelete:x}=t.getState(),{nodes:j,edges:S}=await qoe({nodesToRemove:d,edgesToRemove:f,nodes:p,edges:y,onBeforeDelete:x}),E=S.length>0,O=j.length>0;if(E){const M=S.map(S5);v==null||v(S),w(M)}if(O){const M=j.map(S5);m==null||m(j),b(M)}return(O||E)&&(_==null||_({nodes:j,edges:S})),{deletedNodes:j,deletedEdges:S}},getIntersectingNodes:(d,f=!0,p)=>{const y=E3(d),m=y?d:c(d),v=p!==void 0;return m?(p||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!y&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const _=sc(v?b:w),x=qu(_,m);return f&&x>0||x>=m.width*m.height}):[]},isNodeIntersecting:(d,f,p=!0)=>{const y=E3(d)?d:c(d);if(!y)return!1;const m=qu(y,f);return p&&m>0||m>=y.width*y.height},updateNode:l,updateNodeData:(d,f,p={replace:!1})=>{l(d,y=>{const m=typeof f=="function"?f(y):f;return p.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},p)},updateEdge:u,updateEdgeData:(d,f,p={replace:!1})=>{u(d,y=>{const m=typeof f=="function"?f(y):f;return p.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},p)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return Woe(d,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:d,id:f,nodeId:p})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${p}-${d}-${f??null}`))==null?void 0:y.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const M5=e=>e.selected,dse={actInsideInputWithModifier:!1},fse=typeof window<"u"?window:void 0;function pse({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Tt(),{deleteElements:r}=lr(),a=Xu(e,dse),o=Xu(t,{target:fse});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(M5),edges:i.filter(M5)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function hse(e){const t=Tt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=Ch(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",go.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Th={position:"absolute",width:"100%",height:"100%",top:0,left:0},mse=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function yse({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=ti.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:y,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:_}){const x=Tt(),j=g.useRef(null),{userSelectionActive:S,lib:E}=Ze(mse,$t),O=Xu(f),M=g.useRef();hse(j);const N=g.useCallback(P=>{b==null||b({x:P[0],y:P[1],zoom:P[2]}),w||x.setState({transform:P})},[b,w]);return g.useEffect(()=>{if(j.current){M.current=Eie({domNode:j.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,A)=>{const{onViewportChangeStart:T,onMoveStart:D}=x.getState();D==null||D(C,A),T==null||T(A)},onPanZoom:(C,A)=>{const{onViewportChange:T,onMove:D}=x.getState();D==null||D(C,A),T==null||T(A)},onPanZoomEnd:(C,A)=>{const{onViewportChangeEnd:T,onMoveEnd:D}=x.getState();D==null||D(C,A),T==null||T(A)}});const{x:P,y:I,zoom:k}=M.current.getViewport();return x.setState({panZoom:M.current,transform:[P,I,k],domNode:j.current.closest(".react-flow")}),()=>{var C;(C=M.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var P;(P=M.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:p,noPanClassName:v,userSelectionActive:S,noWheelClassName:m,lib:E,onTransformChange:N})},[e,t,n,r,a,o,i,s,O,p,v,S,m,E,N]),h.jsx("div",{className:"react-flow__renderer",ref:j,style:Th,children:y})}const gse=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function vse(){const{userSelectionActive:e,userSelectionRect:t}=Ze(gse,$t);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const I1=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},bse=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function wse({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Uu.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:p}){const y=g.useRef(null),m=Tt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),_=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:j,dragging:S}=Ze(bse,$t),E=j&&(e||x),O=g.useRef(!1),M=g.useRef(!1),N=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},P=L=>{if(O.current){O.current=!1;return}s==null||s(L),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},I=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},k=l?L=>l(L):void 0,C=L=>{var z,K,ne,Q;const{resetSelectedElements:R,domNode:F,edgeLookup:V}=m.getState();if(w.current=F==null?void 0:F.getBoundingClientRect(),!j||!e||L.button!==0||L.target!==y.current||!w.current)return;(K=(z=L.target)==null?void 0:z.setPointerCapture)==null||K.call(z,L.pointerId),M.current=!0,O.current=!1,_.current=new Map;for(const[Y,q]of V)_.current.set(q.source,((ne=_.current.get(q.source))==null?void 0:ne.add(Y))||new Set([Y])),_.current.set(q.target,((Q=_.current.get(q.target))==null?void 0:Q.add(Y))||new Set([Y]));const{x:$,y:U}=bo(L.nativeEvent,w.current);R(),m.setState({userSelectionRect:{width:0,height:0,startX:$,startY:U,x:$,y:U}}),o==null||o(L)},A=L=>{const{userSelectionRect:R,edgeLookup:F,transform:V,nodeLookup:$,triggerNodeChanges:U,triggerEdgeChanges:z}=m.getState();if(!w.current||!R)return;O.current=!0;const{x:K,y:ne}=bo(L.nativeEvent,w.current),{startX:Q,startY:Y}=R,q={startX:Q,startY:Y,x:K<Q?K:Q,y:ne<Y?ne:Y,width:Math.abs(K-Q),height:Math.abs(ne-Y)},X=b3($,q,V,n===Uu.Partial,!0),te=new Set,B=new Set;for(const ce of X){B.add(ce.id);const re=_.current.get(ce.id);if(re)for(const le of re)te.add(le)}if(v.current!==B.size){v.current=B.size;const ce=fc($,B,!0);U(ce)}if(b.current!==te.size){b.current=te.size;const ce=fc(F,te);z(ce)}m.setState({userSelectionRect:q,userSelectionActive:!0,nodesSelectionActive:!1})},T=L=>{var F,V;if(L.button!==0||!M.current)return;(V=(F=L.target)==null?void 0:F.releasePointerCapture)==null||V.call(F,L.pointerId);const{userSelectionRect:R}=m.getState();!x&&R&&L.target===y.current&&(P==null||P(L)),v.current>0&&m.setState({nodesSelectionActive:!0}),N(),i==null||i(L),(t||a)&&(O.current=!1),M.current=!1},D=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:Xt(["react-flow__pane",{draggable:D,dragging:S,selection:e}]),onClick:E?void 0:I1(P,y),onContextMenu:I1(I,y),onWheel:I1(k,y),onPointerEnter:E?void 0:u,onPointerDown:E?C:d,onPointerMove:E?A:d,onPointerUp:E?T:void 0,onPointerLeave:f,ref:y,style:Th,children:[p,h.jsx(vse,{})]})}function R1({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",go.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function P5({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Tt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=die({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{R1({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var p;(p=u.current)==null||p.destroy()}},[n,r,t,o,e,a]),c}const xse=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function k5(){const e=Tt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=xse(o),f=r?a[0]:5,p=r?a[1]:5,y=t.direction.x*f*t.factor,m=t.direction.y*p*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+y,y:v.internals.positionAbsolute.y+m};r&&(b=Eh(b,a));const{position:w,positionAbsolute:_}=w3({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const D1=g.createContext(null),_se=D1.Provider;D1.Consumer;const L1=()=>g.useContext(D1),jse=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Sse=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===oc.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Ese({type:e="source",position:t=pe.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},p){var C,A;const y=i||null,m=e==="target",v=Tt(),b=L1(),{connectOnClick:w,noPanClassName:_,rfId:x}=Ze(jse,$t),{connectingFrom:j,connectingTo:S,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:M,valid:N}=Ze(Sse(b,y,e),$t);b||((A=(C=v.getState()).onError)==null||A.call(C,"010",go.error010()));const P=T=>{const{defaultEdgeOptions:D,onConnect:L,hasDefaultEdges:R}=v.getState(),F={...D,...T};if(R){const{edges:V,setEdges:$}=v.getState();$(D3(F,V))}L==null||L(F),s==null||s(F)},I=T=>{if(!b)return;const D=P3(T.nativeEvent);if(a&&(D&&T.button===0||!D)){const L=v.getState();M1.onPointerDown(T.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:m,handleId:y,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:P,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}D?u==null||u(T):d==null||d(T)},k=T=>{const{onClickConnectStart:D,onClickConnectEnd:L,connectionClickStartHandle:R,connectionMode:F,isValidConnection:V,lib:$,rfId:U,nodeLookup:z,connection:K}=v.getState();if(!b||!R&&!a)return;if(!R){D==null||D(T.nativeEvent,{nodeId:b,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const ne=M3(T.target),Q=n||V,{connection:Y,isValid:q}=M1.isValid(T.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:F,fromNodeId:R.nodeId,fromHandleId:R.id||null,fromType:R.type,isValidConnection:Q,flowId:U,doc:ne,lib:$,nodeLookup:z});q&&Y&&P(Y);const X=structuredClone(K);delete X.inProgress,X.toPosition=X.toHandle?X.toHandle.position:null,L==null||L(T,X),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${y}-${e}`,className:Xt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!m,target:m,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:j,connectingto:S,valid:N,connectionindicator:r&&(!M||O)&&(M?o:a)}]),onMouseDown:I,onTouchStart:I,onClick:w?k:void 0,ref:p,...f,children:c})}const Ju=g.memo(O5(Ese));function Ose({data:e,isConnectable:t,sourcePosition:n=pe.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(Ju,{type:"source",position:n,isConnectable:t})]})}function Cse({data:e,isConnectable:t,targetPosition:n=pe.Top,sourcePosition:r=pe.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(Ju,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(Ju,{type:"source",position:r,isConnectable:t})]})}function Nse(){return null}function Mse({data:e,isConnectable:t,targetPosition:n=pe.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(Ju,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ih={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},A5={input:Ose,default:Cse,output:Mse,group:Nse};function Pse(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const kse=e=>{const{width:t,height:n,x:r,y:a}=Hu(e.nodeLookup,{filter:o=>!!o.selected});return{width:Hr(t)?t:null,height:Hr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function Ase({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Tt(),{width:a,height:o,transformString:i,userSelectionActive:s}=Ze(kse,$t),c=k5(),l=g.useRef(null);if(g.useEffect(()=>{var f;n||((f=l.current)==null||f.focus({preventScroll:!0}))},[n]),P5({nodeRef:l}),s||!a||!o)return null;const u=e?f=>{const p=r.getState().nodes.filter(y=>y.selected);e(f,p)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Ih,f.key)&&c({direction:Ih[f.key],factor:f.shiftKey?4:1})};return h.jsx("div",{className:Xt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const T5=typeof window<"u"?window:void 0,Tse=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function I5({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:I,preventScrolling:k,onSelectionContextMenu:C,noWheelClassName:A,noPanClassName:T,disableKeyboardA11y:D,onViewportChange:L,isControlledViewport:R}){const{nodesSelectionActive:F,userSelectionActive:V}=Ze(Tse),$=Xu(l,{target:T5}),U=Xu(m,{target:T5}),z=U||O,K=U||x,ne=u&&z!==!0,Q=$||V||ne;return pse({deleteKeyCode:c,multiSelectionKeyCode:y}),h.jsx(yse,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:K,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:!$&&z,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:I,zoomActivationKeyCode:v,preventScrolling:k,noWheelClassName:A,noPanClassName:T,onViewportChange:L,isControlledViewport:R,paneClickDistance:s,children:h.jsxs(wse,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:z,isSelecting:!!Q,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:ne,children:[e,F&&h.jsx(Ase,{onSelectionContextMenu:C,noPanClassName:T,disableKeyboardA11y:D})]})})}I5.displayName="FlowRenderer";const Ise=g.memo(I5),Rse=e=>t=>e?b3(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Dse(e){return Ze(g.useCallback(Rse(e),[e]),$t)}const Lse=e=>e.updateNodeInternals;function $se(){const e=Ze(Lse),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Fse({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Tt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,f=s.current!==e.sourcePosition,p=c.current!==e.targetPosition;(d||f||p)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function Bse({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:y,rfId:m,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:_}){const{node:x,internals:j,isParent:S}=Ze(Y=>{const q=Y.nodeLookup.get(e),X=Y.parentLookup.has(e);return{node:q,internals:q.internals,isParent:X}},$t);let E=x.type||"default",O=(v==null?void 0:v[E])||A5[E];O===void 0&&(_==null||_("003",go.error003(E)),E="default",O=A5.default);const M=!!(x.draggable||s&&typeof x.draggable>"u"),N=!!(x.selectable||c&&typeof x.selectable>"u"),P=!!(x.connectable||l&&typeof x.connectable>"u"),I=!!(x.focusable||u&&typeof x.focusable>"u"),k=Tt(),C=C3(x),A=Fse({node:x,nodeType:E,hasDimensions:C,resizeObserver:d}),T=P5({nodeRef:A,disabled:x.hidden||!M,noDragClassName:f,handleSelector:x.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:w}),D=k5();if(x.hidden)return null;const L=vo(x),R=Pse(x),F=N||M||t||n||r||a,V=n?Y=>n(Y,{...j.userNode}):void 0,$=r?Y=>r(Y,{...j.userNode}):void 0,U=a?Y=>a(Y,{...j.userNode}):void 0,z=o?Y=>o(Y,{...j.userNode}):void 0,K=i?Y=>i(Y,{...j.userNode}):void 0,ne=Y=>{const{selectNodesOnDrag:q,nodeDragThreshold:X}=k.getState();N&&(!q||!M||X>0)&&R1({id:e,store:k,nodeRef:A}),t&&t(Y,{...j.userNode})},Q=Y=>{if(!(w1(Y.nativeEvent)||y))if(p3.includes(Y.key)&&N){const q=Y.key==="Escape";R1({id:e,store:k,unselect:q,nodeRef:A})}else M&&x.selected&&Object.prototype.hasOwnProperty.call(Ih,Y.key)&&(k.setState({ariaLiveMessage:`Moved selected node ${Y.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~j.positionAbsolute.x}, y: ${~~j.positionAbsolute.y}`}),D({direction:Ih[Y.key],factor:Y.shiftKey?4:1}))};return h.jsx("div",{className:Xt(["react-flow__node",`react-flow__node-${E}`,{[p]:M},x.className,{selected:x.selected,selectable:N,parent:S,draggable:M,dragging:T}]),ref:A,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:F?"all":"none",visibility:C?"visible":"hidden",...x.style,...R},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:$,onMouseLeave:U,onContextMenu:z,onClick:ne,onDoubleClick:K,onKeyDown:I?Q:void 0,tabIndex:I?0:void 0,role:I?"button":void 0,"aria-describedby":y?void 0:`${p5}-${m}`,"aria-label":x.ariaLabel,children:h.jsx(_se,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:x.selected,selectable:N,draggable:M,deletable:x.deletable??!0,isConnectable:P,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:T,dragHandle:x.dragHandle,zIndex:j.z,parentId:x.parentId,...L})})})}const zse=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function R5(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=Ze(zse,$t),i=Dse(e.onlyRenderVisibleElements),s=$se();return h.jsx("div",{className:"react-flow__nodes",style:Th,children:i.map(c=>h.jsx(Bse,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}R5.displayName="NodeRenderer";const Vse=g.memo(R5);function Use(e){return Ze(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&Xoe({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),$t)}const Wse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Hse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),D5={[xh.Arrow]:Wse,[xh.ArrowClosed]:Hse};function qse(e){const t=Tt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(D5,e)?D5[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",go.error009(e)),null)},[e])}const Kse=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=qse(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},L5=({defaultColor:e,rfId:t})=>{const n=Ze(o=>o.edges),r=Ze(o=>o.defaultEdgeOptions),a=g.useMemo(()=>rie(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(Kse,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};L5.displayName="MarkerDefinitions";var Yse=g.memo(L5);function $5({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,f]=g.useState({x:1,y:0,width:0,height:0}),p=Xt(["react-flow__edge-textwrapper",l]),y=g.useRef(null);return g.useEffect(()=>{if(y.current){const m=y.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]})}$5.displayName="EdgeText";const Gse=g.memo($5);function Rh({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,className:p,interactionWidth:y=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:Xt(["react-flow__edge-path",p]),markerEnd:d,markerStart:f}),y&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),a&&Hr(n)&&Hr(r)?h.jsx(Gse,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function F5({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===pe.Left||e===pe.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function B5({sourceX:e,sourceY:t,sourcePosition:n=pe.Bottom,targetX:r,targetY:a,targetPosition:o=pe.Top}){const[i,s]=F5({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=F5({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,f,p]=A3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,f,p]}function z5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=pe.Bottom,targetPosition:s=pe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:b})=>{const[w,_,x]=B5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),j=e.isInternal?void 0:t;return h.jsx(Rh,{id:j,path:w,labelX:_,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:b})})}const Xse=z5({isInternal:!1}),V5=z5({isInternal:!0});Xse.displayName="SimpleBezierEdge",V5.displayName="SimpleBezierEdgeInternal";function U5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:p=pe.Bottom,targetPosition:y=pe.Top,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=x1({sourceX:n,sourceY:r,sourcePosition:p,targetX:a,targetY:o,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),S=e.isInternal?void 0:t;return h.jsx(Rh,{id:S,path:_,labelX:x,labelY:j,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:v,interactionWidth:w})})}const W5=U5({isInternal:!1}),H5=U5({isInternal:!0});W5.displayName="SmoothStepEdge",H5.displayName="SmoothStepEdgeInternal";function q5(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(W5,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Zse=q5({isInternal:!1}),K5=q5({isInternal:!0});Zse.displayName="StepEdge",K5.displayName="StepEdgeInternal";function Y5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})=>{const[v,b,w]=L3({sourceX:n,sourceY:r,targetX:a,targetY:o}),_=e.isInternal?void 0:t;return h.jsx(Rh,{id:_,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})})}const Jse=Y5({isInternal:!1}),G5=Y5({isInternal:!0});Jse.displayName="StraightEdge",G5.displayName="StraightEdgeInternal";function X5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=pe.Bottom,targetPosition:s=pe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=I3({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return h.jsx(Rh,{id:S,path:_,labelX:x,labelY:j,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:w})})}const Qse=X5({isInternal:!1}),Z5=X5({isInternal:!0});Qse.displayName="BezierEdge",Z5.displayName="BezierEdgeInternal";const J5={default:Z5,straight:G5,step:K5,smoothstep:H5,simplebezier:V5},Q5={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},ece=(e,t,n)=>n===pe.Left?e-t:n===pe.Right?e+t:e,tce=(e,t,n)=>n===pe.Top?e-t:n===pe.Bottom?e+t:e,e4="react-flow__edgeupdater";function t4({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:Xt([e4,`${e4}-${s}`]),cx:ece(t,r,e),cy:tce(n,r,e),r,stroke:"transparent",fill:"transparent"})}function nce({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){const y=Tt(),m=(x,j)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:E,isValidConnection:O,connectionMode:M,connectionRadius:N,lib:P,onConnectStart:I,onConnectEnd:k,cancelConnection:C,nodeLookup:A,rfId:T,panBy:D,updateConnection:L}=y.getState(),R=j.type==="target";f(!0),u==null||u(x,n,j.type);const F=($,U)=>{f(!1),d==null||d($,n,j.type,U)},V=$=>l==null?void 0:l(n,$);M1.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:M,connectionRadius:N,domNode:E,handleId:j.id,nodeId:j.nodeId,nodeLookup:A,isTarget:R,edgeUpdaterType:j.type,lib:P,flowId:T,cancelConnection:C,panBy:D,isValidConnection:O,onConnect:V,onConnectStart:I,onConnectEnd:k,onReconnectEnd:F,updateConnection:L,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},v=x=>m(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>m(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),_=()=>p(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(t4,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&h.jsx(t4,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function rce({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,rfId:y,edgeTypes:m,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let _=Ze(B=>B.edgeLookup.get(e));const x=Ze(B=>B.defaultEdgeOptions);_=x?{...x,..._}:_;let j=_.type||"default",S=(m==null?void 0:m[j])||J5[j];S===void 0&&(b==null||b("011",go.error011(j)),j="default",S=J5.default);const E=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),M=!!(_.selectable||r&&typeof _.selectable>"u"),N=g.useRef(null),[P,I]=g.useState(!1),[k,C]=g.useState(!1),A=Tt(),{zIndex:T,sourceX:D,sourceY:L,targetX:R,targetY:F,sourcePosition:V,targetPosition:$}=Ze(g.useCallback(B=>{const ce=B.nodeLookup.get(_.source),re=B.nodeLookup.get(_.target);if(!ce||!re)return{zIndex:_.zIndex,...Q5};const le=nie({id:e,sourceNode:ce,targetNode:re,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:B.connectionMode,onError:b});return{zIndex:Goe({selected:_.selected,zIndex:_.zIndex,sourceNode:ce,targetNode:re,elevateOnSelect:B.elevateEdgesOnSelect}),...le||Q5}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),$t),U=g.useMemo(()=>_.markerStart?`url('#${_1(_.markerStart,y)}')`:void 0,[_.markerStart,y]),z=g.useMemo(()=>_.markerEnd?`url('#${_1(_.markerEnd,y)}')`:void 0,[_.markerEnd,y]);if(_.hidden||D===null||L===null||R===null||F===null)return null;const K=B=>{var je;const{addSelectedEdges:ce,unselectNodesAndEdges:re,multiSelectionActive:le}=A.getState();M&&(A.setState({nodesSelectionActive:!1}),_.selected&&le?(re({nodes:[],edges:[_]}),(je=N.current)==null||je.blur()):ce([e])),a&&a(B,_)},ne=o?B=>{o(B,{..._})}:void 0,Q=i?B=>{i(B,{..._})}:void 0,Y=s?B=>{s(B,{..._})}:void 0,q=c?B=>{c(B,{..._})}:void 0,X=l?B=>{l(B,{..._})}:void 0,te=B=>{var ce;if(!w&&p3.includes(B.key)&&M){const{unselectNodesAndEdges:re,addSelectedEdges:le}=A.getState();B.key==="Escape"?((ce=N.current)==null||ce.blur(),re({edges:[_]})):le([e])}};return h.jsx("svg",{style:{zIndex:T},children:h.jsxs("g",{className:Xt(["react-flow__edge",`react-flow__edge-${j}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!M&&!a,updating:P,selectable:M}]),onClick:K,onDoubleClick:ne,onContextMenu:Q,onMouseEnter:Y,onMouseMove:q,onMouseLeave:X,onKeyDown:E?te:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":E?`${h5}-${y}`:void 0,ref:N,children:[!k&&h.jsx(S,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:M,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:D,sourceY:L,targetX:R,targetY:F,sourcePosition:V,targetPosition:$,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:U,markerEnd:z,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&h.jsx(nce,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,sourceX:D,sourceY:L,targetX:R,targetY:F,sourcePosition:V,targetPosition:$,setUpdateHover:I,setReconnecting:C})]})})}const ace=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function n4({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:_}=Ze(ace,$t),x=Use(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(Yse,{defaultColor:e,rfId:n}),x.map(j=>h.jsx(rce,{id:j,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:y,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:m},j))]})}n4.displayName="EdgeRenderer";const oce=g.memo(n4),ice=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function sce({children:e}){const t=Ze(ice);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function cce(e){const t=lr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const lce=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function uce(e){const t=Ze(lce),n=Tt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function dce(e){return e.connection.inProgress?{...e.connection,to:Ku(e.connection.to,e.transform)}:{...e.connection}}function fce(e){return dce}function pce(e){const t=fce();return Ze(t,$t)}const hce=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function mce({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=Ze(hce,$t);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:Xt(["react-flow__connection",g3(s)]),children:h.jsx(r4,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const r4=({style:e,type:t=ni.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=pce();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:g3(r),toNode:u,toHandle:d});let p="";const y={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case ni.Bezier:[p]=I3(y);break;case ni.SimpleBezier:[p]=B5(y);break;case ni.Step:[p]=x1({...y,borderRadius:0});break;case ni.SmoothStep:[p]=x1(y);break;default:[p]=L3(y)}return h.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};r4.displayName="ConnectionLine";const yce={};function a4(e=yce){g.useRef(e),Tt(),g.useEffect(()=>{},[e])}function gce(){Tt(),g.useRef(!1),g.useEffect(()=>{},[])}function o4({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:M,elementsSelectable:N,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,preventScrolling:A,defaultMarkerColor:T,zoomOnScroll:D,zoomOnPinch:L,panOnScroll:R,panOnScrollSpeed:F,panOnScrollMode:V,zoomOnDoubleClick:$,panOnDrag:U,onPaneClick:z,onPaneMouseEnter:K,onPaneMouseMove:ne,onPaneMouseLeave:Q,onPaneScroll:Y,onPaneContextMenu:q,paneClickDistance:X,nodeClickDistance:te,onEdgeContextMenu:B,onEdgeMouseEnter:ce,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,noDragClassName:Ve,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt,viewport:bt,onViewportChange:qt}){return a4(e),a4(t),gce(),cce(n),uce(bt),h.jsx(Ise,{onPaneClick:z,onPaneMouseEnter:K,onPaneMouseMove:ne,onPaneMouseLeave:Q,onPaneContextMenu:q,onPaneScroll:Y,paneClickDistance:X,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:N,zoomOnScroll:D,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:R,panOnScrollSpeed:F,panOnScrollMode:V,panOnDrag:U,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,onSelectionContextMenu:d,preventScrolling:A,noDragClassName:Ve,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:Mt,onViewportChange:qt,isControlledViewport:!!bt,children:h.jsxs(sce,{children:[h.jsx(oce,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,onlyRenderVisibleElements:M,onEdgeContextMenu:B,onEdgeMouseEnter:ce,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,defaultMarkerColor:T,noPanClassName:He,disableKeyboardA11y:Mt,rfId:rt}),h.jsx(mce,{style:m,type:y,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(Vse,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:te,onlyRenderVisibleElements:M,noPanClassName:He,noDragClassName:Ve,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}o4.displayName="GraphView";const vce=g.memo(o4),i4=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,p=r??t??[],y=n??e??[],m=s??[0,0],v=c??Vu;W3(d,f,p),E1(y,l,u,{nodeOrigin:m,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=Hu(l,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:_,y:x,zoom:j}=b1(w,a,o,.5,2,.1);b=[_,x,j]}return{rfId:"1",width:0,height:0,transform:b,nodes:y,nodeLookup:l,parentLookup:u,edges:p,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Vu,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:oc.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...h3},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Koe,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},bce=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>$ie((l,u)=>({...i4({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:p,nodeOrigin:y,elevateNodesOnSelect:m}=u();E1(d,f,p,{nodeOrigin:y,nodeExtent:c,elevateNodesOnSelect:m,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:p}=u();W3(f,p,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:p}=u();p(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:p}=u();p(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:p,nodeLookup:y,parentLookup:m,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:_,nodeOrigin:x,nodeExtent:j,debug:S,fitViewSync:E}=u(),{changes:O,updatedInternals:M}=cie(d,y,m,_,x,j);if(M){if(oie(y,m,{nodeOrigin:x,nodeExtent:j}),f.triggerFitView){let N=b;!b&&v&&(N=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:N})}else l({});(O==null?void 0:O.length)>0&&(S&&console.log("React Flow: trigger node changes",O),p==null||p(O))}},updateNodePositions:(d,f=!1)=>{const p=[],y=[];for(const[m,v]of d){const b={id:m,type:"position",position:v.position,dragging:f};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(p.push({id:m,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),y.push(b)}if(p.length>0){const{nodeLookup:m,parentLookup:v,nodeOrigin:b}=u(),w=C1(p,m,v,b);y.push(...w)}u().triggerNodeChanges(y)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:p,nodes:y,hasDefaultNodes:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Ki(d,y);p(b)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:p,edges:y,hasDefaultEdges:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Zu(d,y);p(b)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>Yi(w,!0));m(b);return}m(fc(y,new Set([...d]),!0)),v(fc(p))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>Yi(w,!0));v(b);return}v(fc(p,new Set([...d]))),m(fc(y,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:p,nodes:y,nodeLookup:m,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||y,_=f||p,x=w.map(S=>{const E=m.get(S.id);return E&&(E.selected=!1),Yi(S.id,!1)}),j=_.map(S=>Yi(S.id,!1));v(x),b(j)},setMinZoom:d=>{const{panZoom:f,maxZoom:p}=u();f==null||f.setScaleExtent([d,p]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:p}=u();f==null||f.setScaleExtent([p,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:p,triggerEdgeChanges:y}=u(),m=f.reduce((b,w)=>w.selected?[...b,Yi(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,Yi(w.id,!1)]:b,[]);p(m),y(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:p,parentLookup:y,nodeOrigin:m,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(E1(f,p,y,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:p,height:y,panZoom:m,translateExtent:v}=u();return lie({delta:d,panZoom:m,transform:f,translateExtent:v,width:p,height:y})},fitView:d=>{const{panZoom:f,width:p,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return Promise.resolve(!1);const w=y1(b,d);return g1({nodes:w,width:p,height:y,panZoom:f,minZoom:m,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:p,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return!1;const w=y1(b,d);return g1({nodes:w,width:p,height:y,panZoom:f,minZoom:m,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...h3}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...i4()})}),Object.is);function wce({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>bce({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(Fie,{value:u,children:h.jsx(cse,{children:l})})}function xce({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(kh)?h.jsx(h.Fragment,{children:e}):h.jsx(wce,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const _ce={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function jce({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onNodesDelete:N,onEdgesDelete:P,onDelete:I,onSelectionChange:k,onSelectionDragStart:C,onSelectionDrag:A,onSelectionDragStop:T,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:R,onBeforeDelete:F,connectionMode:V,connectionLineType:$=ni.Bezier,connectionLineStyle:U,connectionLineComponent:z,connectionLineContainerStyle:K,deleteKeyCode:ne="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:Y=!1,selectionMode:q=Uu.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:te=Oh()?"Meta":"Control",zoomActivationKeyCode:B=Oh()?"Meta":"Control",snapToGrid:ce,snapGrid:re,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,nodeOrigin:Ve=m5,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:Mt=!0,defaultViewport:st=Jie,minZoom:rt=.5,maxZoom:bt=2,translateExtent:qt=Vu,preventScrolling:Xn=!0,nodeExtent:Ba,defaultMarkerColor:Zn="#b1b1b7",zoomOnScroll:za=!0,zoomOnPinch:Z=!0,panOnScroll:ee=!1,panOnScrollSpeed:se=.5,panOnScrollMode:he=ti.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Ut=!0,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ue=0,nodeClickDistance:St=0,children:Bt,onReconnect:W,onReconnectStart:J,onReconnectEnd:ae,onEdgeContextMenu:fe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke=10,onNodesChange:we,onEdgesChange:ze,noDragClassName:Je="nodrag",noWheelClassName:kt="nowheel",noPanClassName:Lt="nopan",fitView:at,fitViewOptions:Jn,connectOnClick:Kt,attributionPosition:_s,proOptions:ua,defaultEdgeOptions:Ei,elevateNodesOnSelect:Va,elevateEdgesOnSelect:Pf,disableKeyboardA11y:Nr=!1,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,connectionRadius:pt,isValidConnection:Qn,onError:js,style:zt,id:Bo,nodeDragThreshold:jg,viewport:yN,onViewportChange:Xke,width:Zke,height:Jke,colorMode:Qke="light",debug:eAe,...tAe},nAe){const gN=Bo||"1",rAe=nse(Qke);return h.jsx("div",{...tAe,style:{...zt,..._ce},ref:nAe,className:Xt(["react-flow",a,rAe]),"data-testid":"rf__wrapper",id:Bo,children:h.jsxs(xce,{nodes:e,edges:t,width:Zke,height:Jke,fitView:at,nodeOrigin:Ve,nodeExtent:Ba,children:[h.jsx(vce,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:U,connectionLineComponent:z,connectionLineContainerStyle:K,selectionKeyCode:Q,selectionOnDrag:Y,selectionMode:q,deleteKeyCode:ne,multiSelectionKeyCode:te,panActivationKeyCode:X,zoomActivationKeyCode:B,onlyRenderVisibleElements:le,defaultViewport:st,translateExtent:qt,minZoom:rt,maxZoom:bt,preventScrolling:Xn,zoomOnScroll:za,zoomOnPinch:Z,zoomOnDoubleClick:Te,panOnScroll:ee,panOnScrollSpeed:se,panOnScrollMode:he,panOnDrag:Ut,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ue,nodeClickDistance:St,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:R,onReconnect:W,onReconnectStart:J,onReconnectEnd:ae,onEdgeContextMenu:fe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke,defaultMarkerColor:Zn,noDragClassName:Je,noWheelClassName:kt,noPanClassName:Lt,rfId:gN,disableKeyboardA11y:Nr,nodeExtent:Ba,viewport:yN,onViewportChange:Xke}),h.jsx(tse,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:Mt,elevateNodesOnSelect:Va,elevateEdgesOnSelect:Pf,minZoom:rt,maxZoom:bt,nodeExtent:Ba,onNodesChange:we,onEdgesChange:ze,snapToGrid:ce,snapGrid:re,connectionMode:V,translateExtent:qt,connectOnClick:Kt,defaultEdgeOptions:Ei,fitView:at,fitViewOptions:Jn,onNodesDelete:N,onEdgesDelete:P,onDelete:I,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onSelectionDrag:A,onSelectionDragStart:C,onSelectionDragStop:T,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Lt,nodeOrigin:Ve,rfId:gN,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,onError:js,connectionRadius:pt,isValidConnection:Qn,selectNodesOnDrag:je,nodeDragThreshold:jg,onBeforeDelete:F,paneClickDistance:Ue,debug:eAe}),h.jsx(Zie,{onSelectionChange:k}),Bt,h.jsx(qie,{proOptions:ua,position:_s}),h.jsx(Wie,{rfId:gN,disableKeyboardA11y:Nr})]})})}var Sce=O5(jce);const Ece=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Oce({children:e}){const t=Ze(Ece);return t?Nl.createPortal(e,t):null}const Cce=e=>e.nodes;function Nce(){return Ze(Cce,$t)}function Dh({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=L1(),i=n??o,s=g.useRef(null),c=Ze(l=>l.connectionLookup.get(`${i}-${e}-${t}`),Voe);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;y3(s.current,l,a),y3(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Tn=function(e){return Ze(g.useCallback(t=>t.nodeLookup.get(e),[e]),$t)};function Mce({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Xt(["react-flow__background-pattern",n,r])})}function Pce({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:Xt(["react-flow__background-pattern","dots",t])})}var wo;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(wo||(wo={}));const kce={[wo.Dots]:1,[wo.Lines]:1,[wo.Cross]:6},Ace=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function s4({id:e,variant:t=wo.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:f,patternId:p}=Ze(Ace,$t),y=r||kce[t],m=t===wo.Dots,v=t===wo.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*f[2]||1,b[1]*f[2]||1],_=y*f[2],x=Array.isArray(o)?o:[o,o],j=v?[_,_]:w,S=[x[0]*f[2]||1+j[0]/2,x[1]*f[2]||1+j[1]/2],E=`${p}${e||""}`;return h.jsxs("svg",{className:Xt(["react-flow__background",l]),style:{...c,...Th,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?h.jsx(Pce,{radius:_/2,className:u}):h.jsx(Mce,{dimensions:j,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}s4.displayName="Background";const Tce=g.memo(s4);function Ice(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Rce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Dce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Lce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function $ce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Lh({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:Xt(["react-flow__controls-button",t]),...n,children:e})}const Fce=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function c4({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":p="React Flow controls"}){const y=Tt(),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=Ze(Fce,$t),{zoomIn:w,zoomOut:_,fitView:x}=lr(),j=()=>{w(),o==null||o()},S=()=>{_(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},M=f==="horizontal"?"horizontal":"vertical";return h.jsxs(dc,{className:Xt(["react-flow__controls",M,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":p,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(Lh,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(Ice,{})}),h.jsx(Lh,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(Rce,{})})]}),n&&h.jsx(Lh,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx(Dce,{})}),r&&h.jsx(Lh,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?h.jsx($ce,{}):h.jsx(Lce,{})}),u]})}c4.displayName="Controls";const Bce=g.memo(c4);function zce({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:p}){const{background:y,backgroundColor:m}=o||{},v=i||y||m;return h.jsx("rect",{className:Xt(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:p?b=>p(b,e):void 0})}const Vce=g.memo(zce),Uce=e=>e.nodes.map(t=>t.id),$1=e=>e instanceof Function?e:()=>e;function Wce({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=Vce,onClick:i}){const s=Ze(Uce,$t),c=$1(t),l=$1(e),u=$1(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(f=>h.jsx(qce,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},f))})}function Hce({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:f,height:p}=Ze(y=>{const m=y.nodeLookup.get(e),{x:v,y:b}=m.internals.positionAbsolute,{width:w,height:_}=vo(m);return{node:m,x:v,y:b,width:w,height:_}},$t);return!l||l.hidden||!C3(l)?null:h.jsx(s,{x:u,y:d,width:f,height:p,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const qce=g.memo(Hce);var Kce=g.memo(Wce);const Yce=200,Gce=150,Xce=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?S3(Hu(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Zce="react-flow__minimap-desc";function l4({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:p,onNodeClick:y,pannable:m=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:_=10,offsetScale:x=5}){const j=Tt(),S=g.useRef(null),{boundingRect:E,viewBB:O,rfId:M,panZoom:N,translateExtent:P,flowWidth:I,flowHeight:k}=Ze(Xce,$t),C=(e==null?void 0:e.width)??Yce,A=(e==null?void 0:e.height)??Gce,T=E.width/C,D=E.height/A,L=Math.max(T,D),R=L*C,F=L*A,V=x*L,$=E.x-(R-E.width)/2-V,U=E.y-(F-E.height)/2-V,z=R+V*2,K=F+V*2,ne=`${Zce}-${M}`,Q=g.useRef(0),Y=g.useRef();Q.current=L,g.useEffect(()=>{if(S.current&&N)return Y.current=gie({domNode:S.current,panZoom:N,getTransform:()=>j.getState().transform,getViewScale:()=>Q.current}),()=>{var te;(te=Y.current)==null||te.destroy()}},[N]),g.useEffect(()=>{var te;(te=Y.current)==null||te.update({translateExtent:P,width:I,height:k,inversePan:w,pannable:m,zoomStep:_,zoomable:v})},[m,v,w,_,P,I,k]);const q=p?te=>{var re;const[B,ce]=((re=Y.current)==null?void 0:re.pointer(te))||[0,0];p(te,{x:B,y:ce})}:void 0,X=y?g.useCallback((te,B)=>{const ce=j.getState().nodeLookup.get(B);y(te,ce)},[]):void 0;return h.jsx(dc,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:Xt(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:A,viewBox:`${$} ${U} ${z} ${K}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ne,ref:S,onClick:q,children:[b&&h.jsx("title",{id:ne,children:b}),h.jsx(Kce,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-V},${U-V}h${z+V*2}v${K+V*2}h${-z-V*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}l4.displayName="MiniMap";const Jce=g.memo(l4);function Qce({nodeId:e,position:t,variant:n=uc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:y,onResizeEnd:m}){const v=L1(),b=typeof e=="string"?e:v,w=Tt(),_=g.useRef(null),x=n===uc.Line?"right":"bottom-right",j=t??x,S=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return S.current||(S.current=Iie({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,domNode:A}=w.getState();return{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:A}},onChange:(N,P)=>{const{triggerNodeChanges:I,nodeLookup:k,parentLookup:C,nodeOrigin:A}=w.getState(),T=[],D={x:N.x,y:N.y},L=k.get(b);if(L&&L.expandParent&&L.parentId){const R=L.origin??A,F=N.width??L.measured.width,V=N.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:F,height:V,...N3({x:N.x??L.position.x,y:N.y??L.position.y},{width:F,height:V},L.parentId,k,R)}},U=C1([$],k,C,A);T.push(...U),D.x=N.x?Math.max(R[0]*F,N.x):void 0,D.y=N.y?Math.max(R[1]*V,N.y):void 0}if(D.x!==void 0&&D.y!==void 0){const R={id:b,type:"position",position:{...D}};T.push(R)}if(N.width!==void 0&&N.height!==void 0){const R={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:N.width,height:N.height}};T.push(R)}for(const R of P){const F={...R,type:"position"};T.push(F)}I(T)},onEnd:()=>{const N={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([N])}})),S.current.update({controlPosition:j,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:p,onResize:y,onResizeEnd:m,shouldResize:f}),()=>{var N;(N=S.current)==null||N.destroy()}},[j,s,c,l,u,d,p,y,m,f]);const E=j.split("-"),O=n===uc.Line?"borderColor":"backgroundColor",M=i?{...a,[O]:i}:a;return h.jsx("div",{className:Xt(["react-flow__resize-control","nodrag",...E,n,r]),ref:_,style:M,children:o})}const u4=g.memo(Qce);function ele({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:y,onResizeEnd:m}){return t?h.jsxs(h.Fragment,{children:[Cie.map(v=>h.jsx(u4,{className:a,style:o,nodeId:e,position:v,variant:uc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v)),Oie.map(v=>h.jsx(u4,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v))]}):null}var F1,d4;function tle(){if(d4)return F1;d4=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?m(i(b),b,w):b}function c(b,w,_){return b.concat(w).map(function(x){return s(x,_)})}function l(b,w){if(!w.customMerge)return m;var _=w.customMerge(b);return typeof _=="function"?_:m}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function f(b,w){try{return w in b}catch{return!1}}function p(b,w){return f(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function y(b,w,_){var x={};return _.isMergeableObject(b)&&d(b).forEach(function(j){x[j]=s(b[j],_)}),d(w).forEach(function(j){p(b,j)||(f(b,j)&&_.isMergeableObject(w[j])?x[j]=l(j,_)(b[j],w[j],_):x[j]=s(w[j],_))}),x}function m(b,w,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),j=Array.isArray(b),S=x===j;return S?x?_.arrayMerge(b,w,_):y(b,w,_):s(w,_)}m.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,x){return m(_,x,w)},{})};var v=m;return F1=v,F1}var nle=tle();const $h=ot(nle);var f4={},p4;function rle(){if(p4)return f4;p4=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof kl=="object"?kl:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,f){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:f}),u&&u(d,f)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return za(Object.create(null))}:l?function(){return za({__proto__:null})}:function(){return za({})},has:u?function(Z,ee){return a.call(Z,ee)}:function(Z,ee){return ee in Z},get:u?function(Z,ee){return a.call(Z,ee)?Z[ee]:void 0}:function(Z,ee){return Z[ee]}},f=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Xn(),y=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ba(),m=typeof WeakMap=="function"?WeakMap:Zn(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=st(),w=rt(b);function _(Z,ee,se,he){if(U(se)){if(!B(Z))throw new TypeError;if(!re(ee))throw new TypeError;return k(Z,ee)}else{if(!B(Z))throw new TypeError;if(!ne(ee))throw new TypeError;if(!ne(he)&&!U(he)&&!z(he))throw new TypeError;return z(he)&&(he=void 0),se=te(se),C(Z,ee,se,he)}}n("decorate",_);function x(Z,ee){function se(he,Te){if(!ne(he))throw new TypeError;if(!U(Te)&&!le(Te))throw new TypeError;R(Z,ee,he,Te)}return se}n("metadata",x);function j(Z,ee,se,he){if(!ne(se))throw new TypeError;return U(he)||(he=te(he)),R(Z,ee,se,he)}n("defineMetadata",j);function S(Z,ee,se){if(!ne(ee))throw new TypeError;return U(se)||(se=te(se)),A(Z,ee,se)}n("hasMetadata",S);function E(Z,ee,se){if(!ne(ee))throw new TypeError;return U(se)||(se=te(se)),T(Z,ee,se)}n("hasOwnMetadata",E);function O(Z,ee,se){if(!ne(ee))throw new TypeError;return U(se)||(se=te(se)),D(Z,ee,se)}n("getMetadata",O);function M(Z,ee,se){if(!ne(ee))throw new TypeError;return U(se)||(se=te(se)),L(Z,ee,se)}n("getOwnMetadata",M);function N(Z,ee){if(!ne(Z))throw new TypeError;return U(ee)||(ee=te(ee)),F(Z,ee)}n("getMetadataKeys",N);function P(Z,ee){if(!ne(Z))throw new TypeError;return U(ee)||(ee=te(ee)),V(Z,ee)}n("getOwnMetadataKeys",P);function I(Z,ee,se){if(!ne(ee))throw new TypeError;if(U(se)||(se=te(se)),!ne(ee))throw new TypeError;U(se)||(se=te(se));var he=qt(ee,se,!1);return U(he)?!1:he.OrdinaryDeleteMetadata(Z,ee,se)}n("deleteMetadata",I);function k(Z,ee){for(var se=Z.length-1;se>=0;--se){var he=Z[se],Te=he(ee);if(!U(Te)&&!z(Te)){if(!re(Te))throw new TypeError;ee=Te}}return ee}function C(Z,ee,se,he){for(var Te=Z.length-1;Te>=0;--Te){var Ut=Z[Te],Dt=Ut(ee,se,he);if(!U(Dt)&&!z(Dt)){if(!ne(Dt))throw new TypeError;he=Dt}}return he}function A(Z,ee,se){var he=T(Z,ee,se);if(he)return!0;var Te=He(ee);return z(Te)?!1:A(Z,Te,se)}function T(Z,ee,se){var he=qt(ee,se,!1);return U(he)?!1:q(he.OrdinaryHasOwnMetadata(Z,ee,se))}function D(Z,ee,se){var he=T(Z,ee,se);if(he)return L(Z,ee,se);var Te=He(ee);if(!z(Te))return D(Z,Te,se)}function L(Z,ee,se){var he=qt(ee,se,!1);if(!U(he))return he.OrdinaryGetOwnMetadata(Z,ee,se)}function R(Z,ee,se,he){var Te=qt(se,he,!0);Te.OrdinaryDefineOwnMetadata(Z,ee,se,he)}function F(Z,ee){var se=V(Z,ee),he=He(Z);if(he===null)return se;var Te=F(he,ee);if(Te.length<=0)return se;if(se.length<=0)return Te;for(var Ut=new y,Dt=[],Ke=0,be=se;Ke<be.length;Ke++){var _e=be[Ke],Ee=Ut.has(_e);Ee||(Ut.add(_e),Dt.push(_e))}for(var Oe=0,Ue=Te;Oe<Ue.length;Oe++){var _e=Ue[Oe],Ee=Ut.has(_e);Ee||(Ut.add(_e),Dt.push(_e))}return Dt}function V(Z,ee){var se=qt(Z,ee,!1);return se?se.OrdinaryOwnMetadataKeys(Z,ee):[]}function $(Z){if(Z===null)return 1;switch(typeof Z){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Z===null?1:6;default:return 6}}function U(Z){return Z===void 0}function z(Z){return Z===null}function K(Z){return typeof Z=="symbol"}function ne(Z){return typeof Z=="object"?Z!==null:typeof Z=="function"}function Q(Z,ee){switch($(Z)){case 0:return Z;case 1:return Z;case 2:return Z;case 3:return Z;case 4:return Z;case 5:return Z}var se="string",he=Le(Z,i);if(he!==void 0){var Te=he.call(Z,se);if(ne(Te))throw new TypeError;return Te}return Y(Z)}function Y(Z,ee){var se,he;{var Te=Z.toString;if(ce(Te)){var he=Te.call(Z);if(!ne(he))return he}var se=Z.valueOf;if(ce(se)){var he=se.call(Z);if(!ne(he))return he}}throw new TypeError}function q(Z){return!!Z}function X(Z){return""+Z}function te(Z){var ee=Q(Z);return K(ee)?ee:X(ee)}function B(Z){return Array.isArray?Array.isArray(Z):Z instanceof Object?Z instanceof Array:Object.prototype.toString.call(Z)==="[object Array]"}function ce(Z){return typeof Z=="function"}function re(Z){return typeof Z=="function"}function le(Z){switch($(Z)){case 3:return!0;case 4:return!0;default:return!1}}function je(Z,ee){return Z===ee||Z!==Z&&ee!==ee}function Le(Z,ee){var se=Z[ee];if(se!=null){if(!ce(se))throw new TypeError;return se}}function $e(Z){var ee=Le(Z,s);if(!ce(ee))throw new TypeError;var se=ee.call(Z);if(!ne(se))throw new TypeError;return se}function Se(Z){return Z.value}function Ve(Z){var ee=Z.next();return ee.done?!1:ee}function We(Z){var ee=Z.return;ee&&ee.call(Z)}function He(Z){var ee=Object.getPrototypeOf(Z);if(typeof Z!="function"||Z===f||ee!==f)return ee;var se=Z.prototype,he=se&&Object.getPrototypeOf(se);if(he==null||he===Object.prototype)return ee;var Te=he.constructor;return typeof Te!="function"||Te===Z?ee:Te}function Mt(){var Z;!U(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Z=bt(r.Reflect));var ee,se,he,Te=new m,Ut={registerProvider:Dt,getProvider:be,setProvider:Ee};return Ut;function Dt(Oe){if(!Object.isExtensible(Ut))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Z===Oe:break;case U(ee):ee=Oe;break;case ee===Oe:break;case U(se):se=Oe;break;case se===Oe:break;default:he===void 0&&(he=new y),he.add(Oe);break}}function Ke(Oe,Ue){if(!U(ee)){if(ee.isProviderFor(Oe,Ue))return ee;if(!U(se)){if(se.isProviderFor(Oe,Ue))return ee;if(!U(he))for(var St=$e(he);;){var Bt=Ve(St);if(!Bt)return;var W=Se(Bt);if(W.isProviderFor(Oe,Ue))return We(St),W}}}if(!U(Z)&&Z.isProviderFor(Oe,Ue))return Z}function be(Oe,Ue){var St=Te.get(Oe),Bt;return U(St)||(Bt=St.get(Ue)),U(Bt)&&(Bt=Ke(Oe,Ue),U(Bt)||(U(St)&&(St=new p,Te.set(Oe,St)),St.set(Ue,Bt))),Bt}function _e(Oe){if(U(Oe))throw new TypeError;return ee===Oe||se===Oe||!U(he)&&he.has(Oe)}function Ee(Oe,Ue,St){if(!_e(St))throw new Error("Metadata provider not registered.");var Bt=be(Oe,Ue);if(Bt!==St){if(!U(Bt))return!1;var W=Te.get(Oe);U(W)&&(W=new p,Te.set(Oe,W)),W.set(Ue,St)}return!0}}function st(){var Z;return!U(v)&&ne(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Z=r.Reflect[v]),U(Z)&&(Z=Mt()),!U(v)&&ne(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Z}),Z}function rt(Z){var ee=new m,se={isProviderFor:function(_e,Ee){var Oe=ee.get(_e);return U(Oe)?!1:Oe.has(Ee)},OrdinaryDefineOwnMetadata:Dt,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Ut,OrdinaryOwnMetadataKeys:Ke,OrdinaryDeleteMetadata:be};return b.registerProvider(se),se;function he(_e,Ee,Oe){var Ue=ee.get(_e),St=!1;if(U(Ue)){if(!Oe)return;Ue=new p,ee.set(_e,Ue),St=!0}var Bt=Ue.get(Ee);if(U(Bt)){if(!Oe)return;if(Bt=new p,Ue.set(Ee,Bt),!Z.setProvider(_e,Ee,se))throw Ue.delete(Ee),St&&ee.delete(_e),new Error("Wrong provider for target.")}return Bt}function Te(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);return U(Ue)?!1:q(Ue.has(_e))}function Ut(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);if(!U(Ue))return Ue.get(_e)}function Dt(_e,Ee,Oe,Ue){var St=he(Oe,Ue,!0);St.set(_e,Ee)}function Ke(_e,Ee){var Oe=[],Ue=he(_e,Ee,!1);if(U(Ue))return Oe;for(var St=Ue.keys(),Bt=$e(St),W=0;;){var J=Ve(Bt);if(!J)return Oe.length=W,Oe;var ae=Se(J);try{Oe[W]=ae}catch(fe){try{We(Bt)}finally{throw fe}}W++}}function be(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);if(U(Ue)||!Ue.delete(_e))return!1;if(Ue.size===0){var St=ee.get(Ee);U(St)||(St.delete(Oe),St.size===0&&ee.delete(St))}return!0}}function bt(Z){var ee=Z.defineMetadata,se=Z.hasOwnMetadata,he=Z.getOwnMetadata,Te=Z.getOwnMetadataKeys,Ut=Z.deleteMetadata,Dt=new m,Ke={isProviderFor:function(be,_e){var Ee=Dt.get(be);return!U(Ee)&&Ee.has(_e)?!0:Te(be,_e).length?(U(Ee)&&(Ee=new y,Dt.set(be,Ee)),Ee.add(_e),!0):!1},OrdinaryDefineOwnMetadata:ee,OrdinaryHasOwnMetadata:se,OrdinaryGetOwnMetadata:he,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Ut};return Ke}function qt(Z,ee,se){var he=b.getProvider(Z,ee);if(!U(he))return he;if(se){if(b.setProvider(Z,ee,w))return w;throw new Error("Illegal state.")}}function Xn(){var Z={},ee=[],se=function(){function Ke(be,_e,Ee){this._index=0,this._keys=be,this._values=_e,this._selector=Ee}return Ke.prototype["@@iterator"]=function(){return this},Ke.prototype[s]=function(){return this},Ke.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=ee,this._values=ee):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ke.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=ee,this._values=ee),be},Ke.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=ee,this._values=ee),{value:be,done:!0}},Ke}(),he=function(){function Ke(){this._keys=[],this._values=[],this._cacheKey=Z,this._cacheIndex=-2}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ke.prototype.has=function(be){return this._find(be,!1)>=0},Ke.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ke.prototype.set=function(be,_e){var Ee=this._find(be,!0);return this._values[Ee]=_e,this},Ke.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Ee=this._keys.length,Oe=_e+1;Oe<Ee;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=Z,this._cacheIndex=-2),!0}return!1},Ke.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Z,this._cacheIndex=-2},Ke.prototype.keys=function(){return new se(this._keys,this._values,Te)},Ke.prototype.values=function(){return new se(this._keys,this._values,Ut)},Ke.prototype.entries=function(){return new se(this._keys,this._values,Dt)},Ke.prototype["@@iterator"]=function(){return this.entries()},Ke.prototype[s]=function(){return this.entries()},Ke.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Ee=0;Ee<this._keys.length;Ee++)if(je(this._keys[Ee],be)){this._cacheIndex=Ee;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ke}();return he;function Te(Ke,be){return Ke}function Ut(Ke,be){return be}function Dt(Ke,be){return[Ke,be]}}function Ba(){var Z=function(){function ee(){this._map=new p}return Object.defineProperty(ee.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ee.prototype.has=function(se){return this._map.has(se)},ee.prototype.add=function(se){return this._map.set(se,se),this},ee.prototype.delete=function(se){return this._map.delete(se)},ee.prototype.clear=function(){this._map.clear()},ee.prototype.keys=function(){return this._map.keys()},ee.prototype.values=function(){return this._map.keys()},ee.prototype.entries=function(){return this._map.entries()},ee.prototype["@@iterator"]=function(){return this.keys()},ee.prototype[s]=function(){return this.keys()},ee}();return Z}function Zn(){var Z=16,ee=d.create(),se=he();return function(){function be(){this._key=he()}return be.prototype.has=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.has(Ee,this._key):!1},be.prototype.get=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.get(Ee,this._key):void 0},be.prototype.set=function(_e,Ee){var Oe=Te(_e,!0);return Oe[this._key]=Ee,this},be.prototype.delete=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?delete Ee[this._key]:!1},be.prototype.clear=function(){this._key=he()},be}();function he(){var be;do be="@@WeakMap@@"+Ke();while(d.has(ee,be));return ee[be]=!0,be}function Te(be,_e){if(!a.call(be,se)){if(!_e)return;Object.defineProperty(be,se,{value:d.create()})}return be[se]}function Ut(be,_e){for(var Ee=0;Ee<_e;++Ee)be[Ee]=Math.random()*255|0;return be}function Dt(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Ut(_e,be),_e}return Ut(new Array(be),be)}function Ke(){var be=Dt(Z);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Ee=0;Ee<Z;++Ee){var Oe=be[Ee];(Ee===4||Ee===6||Ee===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function za(Z){return Z.__=void 0,delete Z.__,Z}})}(e||(e={})),f4}rle(),typeof window<"u"&&(window.Buffer=vAe),typeof Ag<"u"&&typeof require<"u"&&(Ag.Buffer=require("buffer/").Buffer);class Zt{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class pc extends xe{constructor(){super("Locking not supported on given driver.")}}class B1 extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Ct{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class ale extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Ct.isEntitySchema(t)?t.options.name:typeof t=="function"||Zt.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class h4 extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class m4 extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class ole extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class Fh extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Sa extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Sa.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class ile extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class sle extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class Qu extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class cle extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class lle extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class ule extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class y4{constructor(t){Zt.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Ea{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var z1={exports:{}},V1={exports:{}},g4;function hc(){return g4||(g4=1,typeof Object.create=="function"?V1.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:V1.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),V1.exports}var U1={exports:{}},v4;function Gi(){return v4||(v4=1,function(e,t){var n=bAe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(U1,U1.exports)),U1.exports}var W1,b4;function mc(){if(b4)return W1;b4=1;var e=Gi().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},W1=t,W1}var H1,w4;function dle(){if(w4)return H1;w4=1;var e=hc(),t=mc(),n=Gi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,f){return l===0?u&d|~u&f:l===2?u&d|u&f|d&f:u^d^f}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,f=this._b|0,p=this._c|0,y=this._d|0,m=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),_=i(d)+c(w,f,p,y)+m+u[b]+r[w]|0;m=y,y=p,p=s(f),f=d,d=_}this._a=d+this._a|0,this._b=f+this._b|0,this._c=p+this._c|0,this._d=y+this._d|0,this._e=m+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},H1=o,H1}var q1,x4;function fle(){if(x4)return q1;x4=1;var e=hc(),t=mc(),n=Gi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,f,p){return u===0?d&f|~d&p:u===2?d&f|d&p|f&p:d^f^p}return o.prototype._update=function(u){for(var d=this._w,f=this._a|0,p=this._b|0,y=this._c|0,m=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var _=~~(w/20),x=s(f)+l(_,p,y,m)+v+d[w]+r[_]|0;v=m,m=y,y=c(p),p=f,f=x}this._a=f+this._a|0,this._b=p+this._b|0,this._c=y+this._c|0,this._d=m+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},q1=o,q1}var K1,_4;function j4(){if(_4)return K1;_4=1;var e=hc(),t=mc(),n=Gi().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(f,p,y){return y^f&(p^y)}function s(f,p,y){return f&p|y&(f|p)}function c(f){return(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10)}function l(f){return(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7)}function u(f){return(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3}function d(f){return(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10}return o.prototype._update=function(f){for(var p=this._w,y=this._a|0,m=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,_=this._f|0,x=this._g|0,j=this._h|0,S=0;S<16;++S)p[S]=f.readInt32BE(S*4);for(;S<64;++S)p[S]=d(p[S-2])+p[S-7]+u(p[S-15])+p[S-16]|0;for(var E=0;E<64;++E){var O=j+l(w)+i(w,_,x)+r[E]+p[E]|0,M=c(y)+s(y,m,v)|0;j=x,x=_,_=w,w=b+O|0,b=v,v=m,m=y,y=O+M|0}this._a=y+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=_+this._f|0,this._g=x+this._g|0,this._h=j+this._h|0},o.prototype._hash=function(){var f=n.allocUnsafe(32);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f.writeInt32BE(this._h,28),f},K1=o,K1}var Y1,S4;function ple(){if(S4)return Y1;S4=1;var e=hc(),t=j4(),n=mc(),r=Gi().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},Y1=o,Y1}var G1,E4;function O4(){if(E4)return G1;E4=1;var e=hc(),t=mc(),n=Gi().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(m,v,b){return b^m&(v^b)}function s(m,v,b){return m&v|b&(m|v)}function c(m,v){return(m>>>28|v<<4)^(v>>>2|m<<30)^(v>>>7|m<<25)}function l(m,v){return(m>>>14|v<<18)^(m>>>18|v<<14)^(v>>>9|m<<23)}function u(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7}function d(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25)}function f(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6}function p(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26)}function y(m,v){return m>>>0<v>>>0?1:0}return o.prototype._update=function(m){for(var v=this._w,b=this._ah|0,w=this._bh|0,_=this._ch|0,x=this._dh|0,j=this._eh|0,S=this._fh|0,E=this._gh|0,O=this._hh|0,M=this._al|0,N=this._bl|0,P=this._cl|0,I=this._dl|0,k=this._el|0,C=this._fl|0,A=this._gl|0,T=this._hl|0,D=0;D<32;D+=2)v[D]=m.readInt32BE(D*4),v[D+1]=m.readInt32BE(D*4+4);for(;D<160;D+=2){var L=v[D-30],R=v[D-15*2+1],F=u(L,R),V=d(R,L);L=v[D-2*2],R=v[D-2*2+1];var $=f(L,R),U=p(R,L),z=v[D-7*2],K=v[D-7*2+1],ne=v[D-16*2],Q=v[D-16*2+1],Y=V+K|0,q=F+z+y(Y,V)|0;Y=Y+U|0,q=q+$+y(Y,U)|0,Y=Y+Q|0,q=q+ne+y(Y,Q)|0,v[D]=q,v[D+1]=Y}for(var X=0;X<160;X+=2){q=v[X],Y=v[X+1];var te=s(b,w,_),B=s(M,N,P),ce=c(b,M),re=c(M,b),le=l(j,k),je=l(k,j),Le=r[X],$e=r[X+1],Se=i(j,S,E),Ve=i(k,C,A),We=T+je|0,He=O+le+y(We,T)|0;We=We+Ve|0,He=He+Se+y(We,Ve)|0,We=We+$e|0,He=He+Le+y(We,$e)|0,We=We+Y|0,He=He+q+y(We,Y)|0;var Mt=re+B|0,st=ce+te+y(Mt,re)|0;O=E,T=A,E=S,A=C,S=j,C=k,k=I+We|0,j=x+He+y(k,I)|0,x=_,I=P,_=w,P=N,w=b,N=M,M=We+Mt|0,b=He+st+y(M,We)|0}this._al=this._al+M|0,this._bl=this._bl+N|0,this._cl=this._cl+P|0,this._dl=this._dl+I|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+A|0,this._hl=this._hl+T|0,this._ah=this._ah+b+y(this._al,M)|0,this._bh=this._bh+w+y(this._bl,N)|0,this._ch=this._ch+_+y(this._cl,P)|0,this._dh=this._dh+x+y(this._dl,I)|0,this._eh=this._eh+j+y(this._el,k)|0,this._fh=this._fh+S+y(this._fl,C)|0,this._gh=this._gh+E+y(this._gl,A)|0,this._hh=this._hh+O+y(this._hl,T)|0},o.prototype._hash=function(){var m=n.allocUnsafe(64);function v(b,w,_){m.writeInt32BE(b,_),m.writeInt32BE(w,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),m},G1=o,G1}var X1,C4;function hle(){if(C4)return X1;C4=1;var e=hc(),t=O4(),n=mc(),r=Gi().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},X1=o,X1}var N4;function mle(){if(N4)return z1.exports;N4=1;var e=z1.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=dle(),e.sha1=fle(),e.sha224=ple(),e.sha256=j4(),e.sha384=hle(),e.sha512=O4(),z1.exports}var yle=mle();const gle=ot(yle);function vle(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function ble(e,t={}){const n=gle("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class wle{static isGreaterOrEqual(t,n){const r=M4(t),a=M4(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function M4(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&wle.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=vle(o);if(i.length<t)return i}return ble(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,f="";const p=l.indexOf(":");p!==-1&&(d=l.substr(0,p),f=l.substr(p+1));const[y,m]=u.split(":");return{type:n,host:y,username:decodeURIComponent(d),password:decodeURIComponent(f),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,f,p={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const j=c.split("&");let S,E;j.forEach(O=>{S=O.split("=")[0],E=O.split("=")[1],p[S]=E}),f=p.replicaSet,s=s.substr(0,s.indexOf("?"))}const y=i.lastIndexOf("@"),m=i.substr(0,y),v=i.substr(y+1);let b=m,w="";const _=m.indexOf(":");_!==-1&&(b=m.substr(0,_),w=m.substr(_+1)),f?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[j,S]of Object.entries(p))x[j]=S;return x}}class P4{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Zt.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Ea.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Ea.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Ea.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class Z1{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,Zt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class J1{constructor(t,n){this.expressionMap=t,Zt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Ea.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class Q1{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new y4;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new Q1(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new y4(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new P4(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new Z1(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new J1(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class k4{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class e_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class ed{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Ct.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Ct.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Ct.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Ct.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Ct.isFindOperator(this._value))return this._value}get getSql(){return Ct.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof ed?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&e_.transformTo(t,n)):e_.transformTo(t,this._value)}}function Oa(e){return new ed("in",e,!0,!0)}const xle=/[.*+\-?^${}()|[\]\\]/g,_le=e=>e.replace(xle,"\\$&");class Wt{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Ct.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new Q1(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Wt.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Ct.isSelectQueryBuilder(this)?this:Wt.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Ct.isInsertQueryBuilder(this)?this:Wt.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Ct.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Ct.isUpdateQueryBuilder(this)?this:Wt.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Ct.isDeleteQueryBuilder(this)?this:Wt.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Ct.isSoftDeleteQueryBuilder(this)?this:Wt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Ct.isSoftDeleteQueryBuilder(this)?this:Wt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Ct.isRelationQueryBuilder(this)?this:Wt.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>_le(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${ed.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Ct.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Ct.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Oa(r.map(o=>a.getEntityValue(o,!1)))}}return new k4(a=>{for(const o of r)a.orWhere(new k4(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Sa(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Ct.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Ct.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Ct.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Ct.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Wt.queryBuilderRegistry={};class jle{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Sle extends Wt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=jle.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new Fh;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Bh;const Ele=new Uint8Array(16);function Ole(){if(!Bh&&(Bh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Bh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Bh(Ele)}const vn=[];for(let e=0;e<256;++e)vn.push((e+256).toString(16).slice(1));function Cle(e,t=0){return vn[e[t+0]]+vn[e[t+1]]+vn[e[t+2]]+vn[e[t+3]]+"-"+vn[e[t+4]]+vn[e[t+5]]+"-"+vn[e[t+6]]+vn[e[t+7]]+"-"+vn[e[t+8]]+vn[e[t+9]]+"-"+vn[e[t+10]]+vn[e[t+11]]+vn[e[t+12]]+vn[e[t+13]]+vn[e[t+14]]+vn[e[t+15]]}const Nle=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),A4={randomUUID:Nle};function Mle(e,t,n){if(A4.randomUUID&&!t&&!e)return A4.randomUUID();e=e||{};const r=e.random||(e.rng||Ole)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Cle(r)}class T4{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class I4{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class t_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,f,p)=>(d[this.expressionMap.extraReturningColumns[p].databaseName]=f[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class Ple extends Wt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new I4;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new T4;t.forEach(y=>{n.broadcaster.broadcastBeforeInsertEvent(p,this.expressionMap.mainAlias.metadata,y)}),await p.wait()}let a=null,o=null;const i=new t_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(p=>!s.includes(p)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(p=>p!=null).join(`;

`),d=await n.query(u,l,!0),f=I4.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(f,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new T4;t.forEach(y=>{n.broadcaster.broadcastAfterInsertEvent(p,this.expressionMap.mainAlias.metadata,y)}),await p.wait()}return r&&await n.commitTransaction(),f}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new Fh;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:f}=this.expressionMap.onUpdate;let p="ON CONFLICT";if(Array.isArray(u)){if(p+=` ( ${u.map(m=>this.escape(m)).join(", ")} )`,f&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");f&&ve.isPostgresFamily(this.connection.driver)&&(p+=` WHERE ( ${f} )`)}else u&&(p+=` ON CONSTRAINT ${this.escape(u)}`);const y=[];Array.isArray(c)?y.push(...c.map(m=>`${this.escape(m)} = EXCLUDED.${this.escape(m)}`)):l&&y.push(...l.map(m=>`${this.escape(m)} = :${m}`)),y.length>0&&(o+=` ${p} DO UPDATE SET `,y.push(...this.expressionMap.mainAlias.metadata.columns.filter(m=>m.isUpdateDate&&!(c!=null&&c.includes(m.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(m=>`${this.escape(m.databaseName)} = DEFAULT`)),o+=y.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(m=>`${t}.${this.escape(m)} IS DISTINCT FROM EXCLUDED.${this.escape(m)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=Mle(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(Zt.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new sle}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class R4{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=Zt.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const f="joinColumn_"+l+"_"+d;o[f]=Zt.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${f}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=Zt.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(f=>{d[f.databaseName]=Zt.isObject(l)?f.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(f=>{d[f.databaseName]=Zt.isObject(u)?f.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class kle{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,f)=>[...n.inverseRelation.joinColumns.map((p,y)=>{const m="joinColumn_"+u+"_"+f+"_"+y;return i[m]=Zt.isObject(l)?p.referencedColumn.getEntityValue(l):l,`${p.propertyPath} = :${m}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((p,y)=>{const m="primaryColumn_"+f+"_"+f+"_"+y;return i[m]=Zt.isObject(d)?p.getEntityValue(d):d,`${p.propertyPath} = :${m}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,f)=>{l.push(...s.map((p,y)=>[...r.ownerColumns.map((m,v)=>{const b="firstValue_"+f+"_"+y+"_"+v;return c[b]=Zt.isObject(d)?m.referencedColumn.getEntityValue(d):d,`${m.databaseName} = :${b}`}),...r.inverseColumns.map((m,v)=>{const b="secondValue_"+f+"_"+y+"_"+v;return c[b]=Zt.isObject(p)?m.referencedColumn.getEntityValue(p):p,`${m.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class Ale extends Wt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Zt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new R4(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Zt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new R4(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new kle(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!Zt.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class bn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)bn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:bn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class Tle{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return da.isBuffer(l)?l.toString("hex"):Zt.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(f=>f===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],f=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),p=(y,m,v)=>{const b=y.shift();if(b&&y.length===0)return m[b]=v,m;if(b&&y.length>0)p(y,m[b],v);else return m};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(p(f,r,d[0]),o=!0):(p(f,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),bn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),bn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let Ile=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((p,y)=>{const m=[],v={},b=a.map(_=>{const x=_.databaseName+y,j=p[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],S=`${s}:${_.propertyPath}:${j}`;return m.indexOf(S)!==-1?"":(m.push(S),v[x]=j,s+"."+_.propertyPath+" = :"+x)}).filter(_=>_).join(" AND ");m.sort();const w=m.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(p=>p).map(p=>"("+p+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);bn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],p=>p.propertyPath).forEach(p=>{d.addSelect(s+"."+p.propertyPath,p.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const f=await d.getRawMany();return f.forEach(p=>{a.forEach(y=>{p[y.databaseName]=this.connection.driver.prepareHydratedValue(p[y.databaseName],y.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(y=>{p[y.databaseName]=this.connection.driver.prepareHydratedValue(p[y.databaseName],y)})}),{relationIdAttribute:n,results:f}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((_,x)=>(_[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},f={},p=u.map((w,_)=>{const x=[],j={},S=Object.keys(w).map(O=>{const M=O+_,N=w[O],P=`${i}:${O}:${N}`;return x.indexOf(P)!==-1?"":(x.push(P),j[M]=N,i+"."+O+" = :"+M)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return f[E]?"":(f[E]=!0,Object.assign(d,j),S)}).filter(w=>w),y=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),m=p.map(w=>"("+w+" AND "+y+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,m).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(_=>{w[_.databaseName]=this.connection.driver.prepareHydratedValue(w[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class Rle{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const f={entity:d,related:o?[]:void 0},p=s.filter(y=>u.every(m=>m.compareEntityValue(d,y[m.entityMetadata.name+"_"+m.propertyAliasName])));return p.length&&c.forEach(y=>{p.forEach(m=>{l.every(v=>v.compareEntityValue(y,m[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?f.related.push(y):f.related=y)})}),f})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)}),s.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)});let l="";if(i.length===1){const f=n.map(p=>i[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?l=`${o}.${i[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values1",f),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((f,p)=>i.map(y=>{const m="entity1_"+p+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const f=r.map(p=>s[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?u=`${o}.${s[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values2",f),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((f,p)=>s.map(y=>{const m="entity2_"+p+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const d=[l,u].filter(f=>f.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const f=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[f]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(f=>{const p=f.getEntityValue(l),y=f.referencedColumn.getEntityValue(d);if(!(p===void 0||y===void 0)&&p===y){const m=f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[m]=y}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const f="entity"+l+"_"+d;return i.setParameter(f,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),f=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[f]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class Dle{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new Z1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class Lle{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let f=t.map(y=>y[a.parentAlias+"_"+s]).filter(y=>!!y);if(f=f.filter(n),f.length===0)return{relationCountAttribute:a,results:[]};const p=this.connection.createQueryBuilder(this.queryRunner);return p.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",f),a.queryBuilderFactory&&a.queryBuilderFactory(p),{relationCountAttribute:a,results:await p.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,f=a.alias||d,p=a.relation.junctionEntityMetadata.tableName,y=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+f+"."+i,m=this.connection.createQueryBuilder(this.queryRunner);return m.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+m.escape(f)+"."+m.escape(i)+")","cnt").from(d,f).innerJoin(p,u,y).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(m),{relationCountAttribute:a,results:await m.getRawMany()}}});return Promise.all(r)}}class $le{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new J1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class n_{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(n_.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new cle(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const f=t.expressionMap.joinAttributes.find(p=>p.entityOrProperty===l);u=f.metadata,d=f.alias.name}if(!d||!u)throw new Sa(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const f=a.relations.find(p=>p.propertyName===s.propertyPath);f&&this.joinEagerRelations(t,c,f.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class r_ extends Wt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new Z1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new J1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Qu;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new h4(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new h4(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new ale(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Qu;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Qu;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Qu;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Qu;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new P4(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const p=n(this.subQuery());this.setParameters(p.getParameters()),d=p.getQuery()}else d=n;const f=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:f===!1?n:void 0,subQuery:f===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new ule}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new pc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new pc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new pc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new pc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new pc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new pc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(f=>f.selection===t+"."+l.propertyPath);if(d.length)d.forEach(f=>{s.push({selection:u,aliasName:f.aliasName?f.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:f.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?bn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?bn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&n_.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new lle;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new ile(i.name)}const n=new Ile(this.connection,t,this.expressionMap.relationIdAttributes),r=new Lle(this.connection,t,this.expressionMap.relationCountAttributes);new Dle(this.expressionMap).transform(),new $le(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(p=>{const y=this.escape("distinctAlias"),m=this.escape(ve.buildAlias(this.connection.driver,void 0,l,p.databaseName));s[m]||(s[m]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,p.databaseName);return`${y}.${m} AS ${this.escape(v)}`}),d=this.clone(),f=d.expressionMap.timeTravel;if(a=await new r_(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(f).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let p="";const y={};if(c.hasMultiplePrimaryKeys)p=a.map((m,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,_=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return y[w]=m[_],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const m=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[m]);v.every(b=>typeof b=="number")?p=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(y.orm_distinct_ids=v,p=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:p}).setParameters(y).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new Tle(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new Rle(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?bn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?bn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,f=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?bn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?bn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?bn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const p=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,f);o.forEach(y=>{const m=p.find(v=>v.entity===y);if(m){const v=m.related===void 0?null:m.related;s.setEntityValue(y,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return Zt.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Sa(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Sa(c,r);if(l)this.buildRelations(s,typeof n=="object"?bn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?bn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Sa(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?bn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let p=d+"_"+f.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},d,p),this.joins.find(y=>y.alias===p)||this.joins.push({type:"left",select:!0,alias:p,parentAlias:d,selection:void 0,relationMetadata:f}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?bn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Sa(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let f=`${r}.${i}`;this.addOrderBy(f,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Sa(c,n);if(l){let f=`${r}.${c}`;l.isVirtualProperty&&l.query&&(f=`(${l.query(r)})`);let p=t[s];Ct.isEqualOperator(t[s])&&(p=t[s].value),l.transformer&&(p instanceof ed?p.transformValue(l.transformer):p=e_.transformTo(l.transformer,p)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,p)))}else if(u){const f=this.buildWhere(t[s],n,r,c);f&&i.push(f)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(f=>t[s][f]===void 0))continue;if(Ct.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let f="";t[s].type==="moreThan"?f=">":t[s].type==="lessThan"?f="<":t[s].type==="moreThanOrEqual"?f=">=":t[s].type==="lessThanOrEqual"&&(f="<=");const p=this.subQuery();if(d.isManyToManyOwner)p.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(y=>`${d.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)p.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(y=>`${d.inverseRelation.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)p.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(y=>`${d.inverseEntityMetadata.tableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(p.getSql()+" "+f+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const f=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let f=r+"_"+d.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},r,f),this.joins.find(y=>y.alias===f)||this.joins.push({type:"left",select:!1,selection:void 0,alias:f,parentAlias:r,relationMetadata:d});const p=this.buildWhere(t[s],d.inverseEntityMetadata,f);p&&i.push(p)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class D4{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Fle extends Wt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new t_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=D4.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Fh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new ole(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new B1;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new m4}return""}}class Ble extends Wt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new t_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(f=>!i.includes(f)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(f=>f!=null).join(`;

`),c,!0),d=D4.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Fh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Sa(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!da.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const f=this.createParameter(d);let p=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?p=`${y}(${f}, ${u.srid})`:p=`${y}(${f})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?p=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:p=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?p=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":p=f;a.push(this.escape(u.databaseName)+" = "+p)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new B1;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new m4}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new B1}}function zle(){Wt.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Sle(e)),Wt.registerQueryBuilderClass("InsertQueryBuilder",e=>new Ple(e)),Wt.registerQueryBuilderClass("RelationQueryBuilder",e=>new Ale(e)),Wt.registerQueryBuilderClass("SelectQueryBuilder",e=>new r_(e)),Wt.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new Fle(e)),Wt.registerQueryBuilderClass("UpdateQueryBuilder",e=>new Ble(e))}var L4;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(L4||(L4={}));var a_={exports:{}},o_,$4;function Vle(){if($4)return o_;$4=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;o_=function(u,d){d=d||{};var f=typeof u;if(f==="string"&&u.length>0)return i(u);if(f==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var f=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*o;case"weeks":case"week":case"w":return f*a;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,f,p){var y=d>=f*1.5;return Math.round(u/f)+" "+p+(y?"s":"")}return o_}var i_,F4;function Ule(){if(F4)return i_;F4=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=Vle(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=n;function r(d){let f,p=null,y,m;function v(...b){if(!v.enabled)return;const w=v,_=Number(new Date),x=_-(f||_);w.diff=x,w.prev=f,w.curr=_,f=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let j=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(S,E)=>{if(S==="%%")return"%";j++;const O=r.formatters[E];if(typeof O=="function"){const M=b[j];S=O.call(w,M),b.splice(j,1),j--}return S}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(y!==r.namespaces&&(y=r.namespaces,m=r.enabled(d)),m),set:b=>{p=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,f){const p=r(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),y=p.length;for(f=0;f<y;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(f=>"-"+f)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=r.skips.length;f<p;f++)if(r.skips[f].test(d))return!1;for(f=0,p=r.names.length;f<p;f++)if(r.names[f].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return i_=e,i_}var B4;function Wle(){return B4||(B4=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,f=0;l[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof qa<"u"&&"env"in qa&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=Ule()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(a_,a_.exports)),a_.exports}Wle(),zle();const z4=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),Hle=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),V4=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),qle=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),s_=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=z4(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?$h({...o||{},data:void 0},Pu(s,ku)):s}}),newIds:[]}},c_=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:V4(o)}):(n.push(o.id),{type:"replace",item:V4(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},l_={width:440,height:360},zh={width:380,height:650},td={[oe.Toolbox]:"toolbox",[oe.SessionInfo]:"session-info",[oe.DefaultEmbeddingModel]:"default-embedding-model",[oe.ApplicationBar]:"application-bar"},Kle={id:td[oe.Toolbox],type:oe.Toolbox,position:{x:10+zh.width+20,y:10},measured:l_,data:{}},Yle={id:td[oe.SessionInfo],type:oe.SessionInfo,position:{x:10,y:10},measured:zh,data:{}},Gle={id:td[oe.DefaultEmbeddingModel],type:oe.DefaultEmbeddingModel,position:{x:10+zh.width+l_.width+40,y:10},data:{model:wAe}},Xle={id:td[oe.ApplicationBar],type:oe.ApplicationBar,position:{x:10+zh.width+l_.width+40,y:80},data:{}},Zle=[Kle,Yle,Gle,Xle],Jle=[oe.Toolbox,oe.SessionInfo,oe.ApplicationBar,oe.EditorApp,oe.CodeContainerApp],U4={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Zle},Vh=async e=>{const t=await ue("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await ue(i).find({where:{id:Oa(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},Qle=(e,t)=>({reset:()=>{e(U4)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:Ki(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:Zu(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:D3(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=s_(n,a,r);e({nodes:Ki(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=c_(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:Zu(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Vh(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return z4(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=s_(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:Ki(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await ue("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>Hle(s))});else{const s=t().edges,{changes:c}=c_(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:Zu(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await ue("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await ue(r.source_type).delete(r.source_id).catch(i=>{zo("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:Ki([{type:"remove",id:r.id}],o)})}}catch(r){zo("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await ue("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){zo("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=Qe.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await ue("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){zo("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=Qe.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(p=>p.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=$h(s,Pu(n,ku)),r!=null&&r.lazy?ue("FlowNode").update(s.id,i):await ue("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Oi(),ue("FlowNode").save(i)):i=await ue("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(p=>p.id===i.id);i.source_type&&!l?c=await ue(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:f}=s_([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(p=>p.id!==i.id),i],nodes:Ki(f,d)}),i}catch(o){zo("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=Qe.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=$h(i,Pu(n,ku)),r!=null&&r.lazy?ue("FlowEdge").update(i.id,o):await ue("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Oi(),ue("FlowEdge").save(o)):o=await ue("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:Zu(c_([o],c).changes,c)}),o}catch(a){zo("Failed to create or update flow node",a)}}}),Uh=()=>{const e=Ua(t=>t.loadModel);return{loadModel:async(t,...n)=>{switch(t){case nn.WebLLM:return e(...n);case nn.OpenAI:break;default:throw new Error("Unsupported provider")}}}},eue=()=>{var S,E;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),f=Qe(O=>O.currentSession),{loadModel:p}=Uh(),y=g.useCallback(async O=>{var N;if(!f)return;const M=await ue("JSONData").findOne({where:{id:O.source_id,session_id:f==null?void 0:f.id}});M&&((N=u.current)==null||N.call(u,M.data?M.data:[]),l({node:O,enity:M}))},[f]),m=g.useCallback(async O=>{var A;const M=(O==null?void 0:O.sessionId)||(f==null?void 0:f.id),N=(O==null?void 0:O.threadNode)||(n==null?void 0:n.threadNode),P=(O==null?void 0:O.prompts)||(e==null?void 0:e.prompts);if(!M||!(N!=null&&N.id))return;const I=P==null?void 0:P.map(T=>{if(T.type!=="few_shot_example")switch(T.role){case"ai":case"assistant":case"tool":return{id:T.id,content:T.content,role:"assistant"};case"system":return{id:T.id,content:T.content,role:"system"};default:return{id:T.id,content:T.content,role:"user"}}}).filter(Boolean),k=await ue("JSONData").save({headers:"item",session_id:M,json:"",data:I});if(!k)return;const C=await ue("FlowNode").save({session_id:M,source_id:k.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(C)return await ue("FlowEdge").save({session_id:M,source:N.id,target:C.id}),(A=u.current)==null||A.call(u,I),l({node:C,enity:k}),{jsonData:k,jsonDataNode:C}},[e==null?void 0:e.prompts,f==null?void 0:f.id,n==null?void 0:n.threadNode]),v=g.useCallback(async(O,M)=>{if(!f)return;const N=await ue("FlowEdge").findOne({where:{session_id:f.id,source:O.id},order:{id:"DESC"}});if(N){const P=await ue("FlowNode").findOne({where:{id:N.target,session_id:f.id}});if(!P)return;await y(P)}else if(!await m({sessionId:f.id,threadNode:O,prompts:M||[]}))return},[m,f,y]),b=g.useCallback(async O=>{if(O!=null&&O.length&&(f!=null&&f.id)){const M=(await Promise.all(O.map(async N=>ue("FlowEdge").find({where:{target:N.source.id}}).then(P=>Vh({where:{session_id:f.id,id:Oa(P.map(I=>I.source))}}).then(I=>({...I,...N})))))).map(N=>{var A,T,D,L;const P=N.flowNodes.find(R=>R.source_type==="Prompt"),I=N.flowNodes.find(R=>R.source_type==="VectorDatabase");if(!I||!P)return;const k=(T=(A=N.flowNodeDatas)==null?void 0:A.Prompt)==null?void 0:T.find(R=>R.id===P.source_id),C=(L=(D=N.flowNodeDatas)==null?void 0:D.VectorDatabase)==null?void 0:L.find(R=>R.id===I.source_id);return{promptNode:P,vectorDatabaseNode:I,placeholderNode:N.source,placeholderEntity:N.entity,promptEntity:k,vectorDatabaseEntity:C}}).filter(Boolean);s(M)}},[f==null?void 0:f.id]),w=g.useCallback(async()=>{try{if(d.current.handling=f==null?void 0:f.id,!(f!=null&&f.id)||!(f!=null&&f.main_source_id)||(f==null?void 0:f.main_source_type)!=="Thread")return;const[O,M]=await Promise.all([ue("Thread").findOne({where:{id:f.main_source_id,session_id:f.id}}),ue("FlowNode").findOne({where:{id:f.main_node_id}})]);if(!O||!M)return;const N=await ue("FlowEdge").find({where:{session_id:f.id,target:M.id}}),{flowNodes:P,flowNodeDatas:I}=await Vh({where:{session_id:f.id,id:Oa(N.map(R=>R.source))}}),k=(await ue("FlowEdge").find({where:{session_id:f.id}})).filter(R=>R.target===M.id).map(R=>{var V;const F=P.find($=>$.id===R.source);return{connection:R,source:F,entity:(V=I==null?void 0:I[F.source_type])==null?void 0:V.find($=>$.id===F.source_id)}}),C=k.find(R=>R.source.source_type==="LLM"),A=k.filter(R=>R.source.source_type==="Prompt"),T=k.find(R=>R.source.source_type==="Schema");if(!(C!=null&&C.entity))return;const D=k.filter(R=>R.source.source_type==="FlowNodePlaceholder");await b(D),await v(M,(A==null?void 0:A.map(R=>R.entity))||[]),o({llm:C.entity,status:Xe.Started,progress:""}),r({thread:O,threadNode:M});const L=T==null?void 0:T.entity;if(L){const R=await ue("SchemaItem").find({where:{schema_id:L.id}});L.schema_items=R||[]}t({prompts:(A==null?void 0:A.map(R=>R.entity))||[],schema:L}),d.current.handled=f.id}finally{d.current.handling=void 0}},[f==null?void 0:f.id,f==null?void 0:f.main_node_id,f==null?void 0:f.main_source_id,f==null?void 0:f.main_source_type,b,v]),_=g.useCallback(async()=>{var O;if((O=a==null?void 0:a.llm)!=null&&O.name)try{o(M=>M&&{...M,status:Xe.Loading}),await p(a.llm.provider,a==null?void 0:a.llm.name,M=>{o(N=>N&&{...N,progress:M.text})}),o(M=>M&&{...M,status:Xe.Loaded,progress:""})}catch{o(M=>M&&{...M,status:Xe.Started,progress:""})}},[(S=a==null?void 0:a.llm)==null?void 0:S.name,(E=a==null?void 0:a.llm)==null?void 0:E.provider,p]),x=g.useCallback(O=>(u.current=O,()=>{u.current=void 0}),[]),j=g.useCallback(async O=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await ue("JSONData").save({...c.enity,data:O})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(f==null?void 0:f.id)||w()},[f==null?void 0:f.id,w]),{...e,loadLLM:_,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:j,addNewDataNode:m,selectDataNode:y,onThreadMessagesLoaded:x}};class tue extends Rf{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>tL);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>tL);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await At(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-JZURskBY.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class W4 extends xAe{}class H4 extends W4{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Pr(this.value)]}}class nue extends W4{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return _Ae(this.messages)}toChatMessages(){return this.messages}}sM=class extends tue{async formatPromptValue(e){const t=await this.format(e);return new H4(t)}};var rue=Object.prototype.toString,yc=Array.isArray||function(e){return rue.call(e)==="[object Array]"};function u_(e){return typeof e=="function"}function aue(e){return yc(e)?"array":typeof e}function d_(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function q4(e,t){return e!=null&&typeof e=="object"&&t in e}function oue(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var iue=RegExp.prototype.test;function sue(e,t){return iue.call(e,t)}var cue=/\S/;function lue(e){return!sue(cue,e)}var uue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function due(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return uue[t]})}var fue=/\s*/,pue=/\s+/,K4=/\s*=/,hue=/\s*\}/,mue=/#|\^|\/|>|\{|&|=|!/;function yue(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,f,p;function y(O){if(typeof O=="string"&&(O=O.split(pue,2)),!yc(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(d_(O[0])+"\\s*"),f=new RegExp("\\s*"+d_(O[1])),p=new RegExp("\\s*"+d_("}"+O[1]))}y(t||Wn.tags);for(var m=new nd(e),v,b,w,_,x,j;!m.eos();){if(v=m.pos,w=m.scanUntil(d),w)for(var S=0,E=w.length;S<E;++S)_=w.charAt(S),lue(_)?(o.push(a.length),c+=_):(s=!0,n=!0,c+=" "),a.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!m.scan(d))break;if(i=!0,b=m.scan(mue)||"name",m.scan(fue),b==="="?(w=m.scanUntil(K4),m.scan(K4),m.scanUntil(f)):b==="{"?(w=m.scanUntil(p),m.scan(hue),m.scanUntil(f),b="&"):w=m.scanUntil(f),!m.scan(f))throw new Error("Unclosed tag at "+m.pos);if(b==">"?x=[b,w,v,m.pos,c,l,n]:x=[b,w,v,m.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+w+'" at '+v);if(j[1]!==w)throw new Error('Unclosed section "'+j[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&y(w)}if(u(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+m.pos);return vue(gue(a))}function gue(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function vue(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function nd(e){this.string=e,this.tail=e,this.pos=0}nd.prototype.eos=function(){return this.tail===""},nd.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},nd.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function gc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}gc.prototype.push=function(e){return new gc(e,this)},gc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=q4(a,o[i])||oue(a,o[i])),a=a[o[i++]];else a=r.view[e],s=q4(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return u_(n)&&(n=n.call(this.view)),n};function Dn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Dn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Dn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||Wn.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=yue(e,t),a&&n.set(r,o)),o},Dn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof gc?t:new gc(t,void 0);return this.renderTokens(o,i,n,e,r)},Dn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Dn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(yc(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(u_(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Dn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||yc(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Dn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Dn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=u_(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Dn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Dn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||Wn.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Wn.escape?String(a):r(a)},Dn.prototype.rawValue=function(e){return e[1]},Dn.prototype.getConfigTags=function(e){return yc(e)?e:e&&typeof e=="object"?e.tags:void 0},Dn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!yc(e))return e.escape};var Wn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){rd.templateCache=e},get templateCache(){return rd.templateCache}},rd=new Dn;Wn.clearCache=function(){return rd.clearCache()},Wn.parse=function(e,t){return rd.parse(e,t)},Wn.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+aue(e)+'" was given as the first argument for mustache#render(template, view, partials)');return rd.render(e,t,n,r)},Wn.escape=due,Wn.Scanner=nd,Wn.Context=gc,Wn.Writer=Dn;function Y4(){Wn.escape=e=>e}let f_,G4,X4,Z4,J4,Wh,Q4,eL;f_=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},G4=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),X4=e=>{Y4();const t=Wn.parse(e);return G4(t)},Z4=(e,t)=>f_(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),J4=(e,t)=>(Y4(),Wn.render(e,t)),Wh={"f-string":Z4,mustache:J4},Q4={"f-string":f_,mustache:X4},Ns=(e,t,n)=>Wh[t](e,n),eL=(e,t)=>Q4[t](e),cM=(e,t,n)=>{if(!(t in Wh)){const r=Object.keys(Wh);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Ns(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Ns(a.image_url,t,r);else{const o=a.image_url.url;Ns(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Ns(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},Ho=class extends sM{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),cM(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Ns(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new Ho({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return eL(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new Ho({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new Ho(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Ho({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const tL=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Ho},Symbol.toStringTag,{value:"Module"})),p_="RFC3986",h_={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},bue="RFC1738",wue=Array.isArray,Ca=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),m_=1024,xue=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=m_){const c=o.length>=m_?o.slice(s,s+m_):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===bue&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Ca[d];continue}if(d<2048){l[l.length]=Ca[192|d>>6]+Ca[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Ca[224|d>>12]+Ca[128|d>>6&63]+Ca[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Ca[240|d>>18]+Ca[128|d>>12&63]+Ca[128|d>>6&63]+Ca[128|d&63]}i+=l.join("")}return i};function _ue(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function nL(e,t){if(wue(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const jue=Object.prototype.hasOwnProperty,rL={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Na=Array.isArray,Sue=Array.prototype.push,aL=function(e,t){Sue.apply(e,Na(t)?t:[t])},Eue=Date.prototype.toISOString,an={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:xue,encodeValuesOnly:!1,format:p_,formatter:h_[p_],indices:!1,serializeDate(e){return Eue.call(e)},skipNulls:!1,strictNullHandling:!1};function Oue(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const y_={};function oL(e,t,n,r,a,o,i,s,c,l,u,d,f,p,y,m,v,b){let w=e,_=b,x=0,j=!1;for(;(_=_.get(y_))!==void 0&&!j;){const N=_.get(e);if(x+=1,typeof N<"u"){if(N===x)throw new RangeError("Cyclic object value");j=!0}typeof _.get(y_)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=f==null?void 0:f(w):n==="comma"&&Na(w)&&(w=nL(w,function(N){return N instanceof Date?f==null?void 0:f(N):N})),w===null){if(o)return c&&!m?c(t,an.encoder,v,"key",p):t;w=""}if(Oue(w)||_ue(w)){if(c){const N=m?t:c(t,an.encoder,v,"key",p);return[(y==null?void 0:y(N))+"="+(y==null?void 0:y(c(w,an.encoder,v,"value",p)))]}return[(y==null?void 0:y(t))+"="+(y==null?void 0:y(String(w)))]}const S=[];if(typeof w>"u")return S;let E;if(n==="comma"&&Na(w))m&&c&&(w=nL(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Na(l))E=l;else{const N=Object.keys(w);E=u?N.sort(u):N}const O=s?String(t).replace(/\./g,"%2E"):String(t),M=r&&Na(w)&&w.length===1?O+"[]":O;if(a&&Na(w)&&w.length===0)return M+"[]";for(let N=0;N<E.length;++N){const P=E[N],I=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(i&&I===null)continue;const k=d&&s?P.replace(/\./g,"%2E"):P,C=Na(w)?typeof n=="function"?n(M,k):M:M+(d?"."+k:"["+k+"]");b.set(e,x);const A=new WeakMap;A.set(y_,b),aL(S,oL(I,C,n,r,a,o,i,s,n==="comma"&&m&&Na(w)?null:c,l,u,d,f,p,y,m,v,A))}return S}function Cue(e=an){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||an.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=p_;if(typeof e.format<"u"){if(!jue.call(h_,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=h_[n];let a=an.filter;(typeof e.filter=="function"||Na(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in rL?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=an.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:an.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:an.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:an.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:an.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?an.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:an.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:an.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:an.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:an.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:an.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:an.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:an.strictNullHandling}}function Nue(e,t={}){let n=e;const r=Cue(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Na(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=rL[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let f=0;f<a.length;++f){const p=a[f];r.skipNulls&&n[p]===null||aL(i,oL(n[p],p,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const vc="4.78.1";let iL=!1,ad,sL,cL,g_,lL,uL,dL,fL,pL;function Mue(e,t={auto:!1}){if(iL)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(ad)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${ad}'\``);iL=t.auto,ad=e.kind,sL=e.fetch,cL=e.FormData,g_=e.File,lL=e.ReadableStream,uL=e.getMultipartRequestOptions,dL=e.getDefaultAgent,fL=e.fileFromPath,pL=e.isFsReadStream}class Pue{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function kue({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new Pue(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}ad||Mue(kue(),{auto:!0});class et extends Error{}class wn extends et{constructor(t,n,r,a){super(`${wn.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Hh({message:r,cause:x_(n)});const o=n==null?void 0:n.error;return t===400?new hL(t,o,r,a):t===401?new mL(t,o,r,a):t===403?new yL(t,o,r,a):t===404?new gL(t,o,r,a):t===409?new vL(t,o,r,a):t===422?new bL(t,o,r,a):t===429?new wL(t,o,r,a):t>=500?new xL(t,o,r,a):new wn(t,o,r,a)}}class wr extends wn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Hh extends wn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class qh extends Hh{constructor({message:t}={}){super({message:t??"Request timed out."})}}class hL extends wn{}class mL extends wn{}class yL extends wn{}class gL extends wn{}class vL extends wn{}class bL extends wn{}class wL extends wn{}class xL extends wn{}class _L extends et{constructor(){super("Could not parse response content as the length limit was reached")}}class jL extends et{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Xi{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Xi.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(Xi.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof da<"u"){if(t instanceof da)return t.toString();if(t instanceof Uint8Array)return da.from(t).toString();throw new et(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new et(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new et("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}Xi.NEWLINE_CHARS=new Set([`
`,"\r"]),Xi.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Ma{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of Aue(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new wn(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new wn(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Ma(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Xi,s=SL(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Ma(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Ma(()=>a(t),this.controller),new Ma(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new lL({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}async function*Aue(e,t){if(!e.body)throw t.abort(),new et("Attempted to iterate over a response with no body");const n=new Rue,r=new Xi,a=SL(e.body);for await(const o of Tue(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*Tue(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Iue(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Iue(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}class Rue{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=Due(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function Due(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function SL(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const EL=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",OL=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Kh(e),Kh=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Lue=e=>OL(e)||EL(e)||pL(e);async function CL(e,t,n){var a;if(e=await e,OL(e))return e;if(EL(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Kh(o)?[await o.arrayBuffer()]:[o];return new g_(i,t,n)}const r=await $ue(e);if(t||(t=Bue(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new g_(r,t,n)}async function $ue(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Kh(e))t.push(await e.arrayBuffer());else if(zue(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${Fue(e)}`);return t}function Fue(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Bue(e){var t;return v_(e.name)||v_(e.filename)||((t=v_(e.path))==null?void 0:t.split(/[\\/]/).pop())}const v_=e=>{if(typeof e=="string")return e;if(typeof da<"u"&&e instanceof da)return String(e)},zue=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",NL=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",bc=async e=>{const t=await Vue(e.body);return uL(t,e)},Vue=async e=>{const t=new cL;return await Promise.all(Object.entries(e||{}).map(([n,r])=>b_(t,n,r))),t},b_=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Lue(n)){const r=await CL(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>b_(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>b_(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var wc={},Uue=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Wue=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Yh;async function ML(e){const{response:t}=e;if(e.options.stream)return xc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Ma.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return xc("response",t.status,t.url,t.headers,a),PL(a,t)}const r=await t.text();return xc("response",t.status,t.url,t.headers,r),r}function PL(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class Gh extends Promise{constructor(t,n=ML){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new Gh(this.responsePromise,async n=>PL(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class Hue{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e5,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=w_("maxRetries",n),this.timeout=w_("timeout",r),this.httpAgent=a,this.fetch=o??sL}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Zue(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${tde()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&Kh(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof da<"u")return da.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:n=0}={}){var y;const{method:r,path:a,query:o,headers:i={}}=t,s=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:NL(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,c=this.calculateContentLength(s),l=this.buildURL(a,o);"timeout"in t&&w_("timeout",t.timeout);const u=t.timeout??this.timeout,d=t.httpAgent??this.httpAgent??dL(l),f=u+1e3;typeof((y=d==null?void 0:d.options)==null?void 0:y.timeout)=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey);const p=this.buildHeaders({options:t,headers:i,contentLength:c,retryCount:n});return{req:{method:r,...s&&{body:s},headers:p,...d&&{agent:d},signal:t.signal??null},url:l,timeout:u}}buildHeaders({options:t,headers:n,contentLength:r,retryCount:a}){const o={};r&&(o["content-length"]=r);const i=this.defaultHeaders(t);return LL(o,i),LL(o,n),NL(t.body)&&ad!=="node"&&delete o["content-type"],$L(i,"x-stainless-retry-count")===void 0&&$L(n,"x-stainless-retry-count")===void 0&&(o["x-stainless-retry-count"]=String(a)),this.validateHeaders(o,n),o}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return wn.generate(t,n,r,a)}request(t,n=null){return new Gh(this.makeRequest(t,n))}async makeRequest(t,n){var d,f;const r=await t,a=r.maxRetries??this.maxRetries;n==null&&(n=a),await this.prepareOptions(r);const{req:o,url:i,timeout:s}=this.buildRequest(r,{retryCount:a-n});if(await this.prepareRequest(o,{url:i,options:r}),xc("request",i,r,o.headers),(d=r.signal)==null?void 0:d.aborted)throw new wr;const c=new AbortController,l=await this.fetchWithTimeout(i,o,s,c).catch(x_);if(l instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new wr;if(n)return this.retryRequest(r,n);throw l.name==="AbortError"?new qh:new Hh({cause:l})}const u=Kue(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const v=`retrying, ${n} attempts remaining`;return xc(`response (error; ${v})`,l.status,i,u),this.retryRequest(r,n,u)}const p=await l.text().catch(v=>x_(v).message),y=Jue(p),m=y?void 0:p;throw xc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,m),this.makeStatusError(l.status,y,m,u)}return{response:l,options:r,controller:c}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new que(this,r,t)}buildURL(t,n){const r=ede(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return RL(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new et(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r),c={signal:a.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,t,c).finally(()=>{clearTimeout(s)})}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await od(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${vc}`}}class kL{constructor(t,n,r,a){Yh.set(this,void 0),Uue(this,Yh,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new et("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Wue(this,Yh,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Yh=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class que extends Gh{constructor(t,n,r){super(n,async a=>new r(t,a.response,await ML(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const Kue=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Yue={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Hn=e=>typeof e=="object"&&e!==null&&!RL(e)&&Object.keys(e).every(t=>DL(Yue,t)),Gue=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":TL(Deno.build.os),"X-Stainless-Arch":AL(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":qa.version};if(Object.prototype.toString.call(typeof qa<"u"?qa:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":TL(qa.platform),"X-Stainless-Arch":AL(qa.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":qa.version};const e=Xue();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Xue(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const AL=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",TL=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let IL;const Zue=()=>IL??(IL=Gue()),Jue=e=>{try{return JSON.parse(e)}catch{return}},Que=/^[a-z][a-z0-9+.-]*:/i,ede=e=>Que.test(e),od=e=>new Promise(t=>setTimeout(t,e)),w_=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new et(`${e} must be an integer`);if(t<0)throw new et(`${e} must be a positive integer`);return t},x_=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Xh=e=>{var t,n,r,a;if(typeof qa<"u")return((t=wc==null?void 0:wc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function RL(e){if(!e)return!0;for(const t in e)return!1;return!0}function DL(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function LL(e,t){for(const n in t){if(!DL(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function xc(e,...t){typeof qa<"u"&&(wc==null?void 0:wc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const tde=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),nde=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",rde=e=>typeof(e==null?void 0:e.get)=="function",$L=(e,t)=>{var r;const n=t.toLowerCase();if(rde(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function __(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class ade extends kL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class qr extends kL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class ht{constructor(t){this._client=t}}let FL=class extends ht{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},j_=class extends ht{constructor(){super(...arguments),this.completions=new FL(this._client)}};j_.Completions=FL;class BL extends ht{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class zL extends ht{create(t,n){return this._client.post("/audio/transcriptions",bc({body:t,...n}))}}class VL extends ht{create(t,n){return this._client.post("/audio/translations",bc({body:t,...n}))}}class id extends ht{constructor(){super(...arguments),this.transcriptions=new zL(this._client),this.translations=new VL(this._client),this.speech=new BL(this._client)}}id.Transcriptions=zL,id.Translations=VL,id.Speech=BL;class S_ extends ht{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/batches",E_,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class E_ extends qr{}S_.BatchesPage=E_;class O_ extends ht{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/assistants",C_,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class C_ extends qr{}O_.AssistantsPage=C_;function UL(e){return typeof e.parse=="function"}const _c=e=>(e==null?void 0:e.role)==="assistant",WL=e=>(e==null?void 0:e.role)==="function",HL=e=>(e==null?void 0:e.role)==="tool";var Kr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Vt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},N_,Zh,Jh,sd,cd,Qh,ld,xo,ud,em,tm,jc,qL;class KL{constructor(){N_.add(this),this.controller=new AbortController,Zh.set(this,void 0),Jh.set(this,()=>{}),sd.set(this,()=>{}),cd.set(this,void 0),Qh.set(this,()=>{}),ld.set(this,()=>{}),xo.set(this,{}),ud.set(this,!1),em.set(this,!1),tm.set(this,!1),jc.set(this,!1),Kr(this,Zh,new Promise((t,n)=>{Kr(this,Jh,t,"f"),Kr(this,sd,n,"f")}),"f"),Kr(this,cd,new Promise((t,n)=>{Kr(this,Qh,t,"f"),Kr(this,ld,n,"f")}),"f"),Vt(this,Zh,"f").catch(()=>{}),Vt(this,cd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Vt(this,N_,"m",qL).bind(this))},0)}_connected(){this.ended||(Vt(this,Jh,"f").call(this),this._emit("connect"))}get ended(){return Vt(this,ud,"f")}get errored(){return Vt(this,em,"f")}get aborted(){return Vt(this,tm,"f")}abort(){this.controller.abort()}on(t,n){return(Vt(this,xo,"f")[t]||(Vt(this,xo,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Vt(this,xo,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Vt(this,xo,"f")[t]||(Vt(this,xo,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{Kr(this,jc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){Kr(this,jc,!0,"f"),await Vt(this,cd,"f")}_emit(t,...n){if(Vt(this,ud,"f"))return;t==="end"&&(Kr(this,ud,!0,"f"),Vt(this,Qh,"f").call(this));const r=Vt(this,xo,"f")[t];if(r&&(Vt(this,xo,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,sd,"f").call(this,a),Vt(this,ld,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,sd,"f").call(this,a),Vt(this,ld,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Zh=new WeakMap,Jh=new WeakMap,sd=new WeakMap,cd=new WeakMap,Qh=new WeakMap,ld=new WeakMap,xo=new WeakMap,ud=new WeakMap,em=new WeakMap,tm=new WeakMap,jc=new WeakMap,N_=new WeakSet,qL=function(e){if(Kr(this,em,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new wr),e instanceof wr)return Kr(this,tm,!0,"f"),this._emit("abort",e);if(e instanceof et)return this._emit("error",e);if(e instanceof Error){const t=new et(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new et(String(e)))};function ode(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function YL(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function ide(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function dd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function sde(e,t){return!t||!GL(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:M_(e,t)}function M_(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new _L;if(r.finish_reason==="content_filter")throw new jL;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>lde(t,o)))??[],parsed:r.message.content&&!r.message.refusal?cde(t,r.message.content):null}}});return{...e,choices:n}}function cde(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function lde(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:dd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function ude(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return dd(n)||(n==null?void 0:n.function.strict)||!1}function GL(e){var t;return YL(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>dd(n)||n.type==="function"&&n.function.strict===!0))??!1}function dde(e){for(const t of e??[]){if(t.type!=="function")throw new et(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new et(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var qn=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Cn,P_,nm,k_,A_,T_,XL,I_;const ZL=10;class JL extends KL{constructor(){super(...arguments),Cn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(WL(t)||HL(t))&&t.content)this._emit("functionCallResult",t.content);else if(_c(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(_c(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new et("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),qn(this,Cn,"m",P_).call(this)}async finalMessage(){return await this.done(),qn(this,Cn,"m",nm).call(this)}async finalFunctionCall(){return await this.done(),qn(this,Cn,"m",k_).call(this)}async finalFunctionCallResult(){return await this.done(),qn(this,Cn,"m",A_).call(this)}async totalUsage(){return await this.done(),qn(this,Cn,"m",T_).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=qn(this,Cn,"m",nm).call(this);n&&this._emit("finalMessage",n);const r=qn(this,Cn,"m",P_).call(this);r&&this._emit("finalContent",r);const a=qn(this,Cn,"m",k_).call(this);a&&this._emit("finalFunctionCall",a);const o=qn(this,Cn,"m",A_).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",qn(this,Cn,"m",T_).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),qn(this,Cn,"m",XL).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(M_(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var f;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=ZL}=r||{},u={};for(const p of n.functions)u[p.name||p.function.name]=p;const d=n.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const y=(f=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!y)throw new et("missing message in ChatCompletion response");if(!y.function_call)return;const{name:m,arguments:v}=y.function_call,b=u[m];if(b){if(c&&c!==m){const j=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:j});continue}}else{const j=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${d.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:j});continue}let w;try{w=UL(b)?await b.parse(v):v}catch(j){this._addMessage({role:a,name:m,content:j instanceof Error?j.message:String(j)});continue}const _=await b.function(w,this),x=qn(this,Cn,"m",I_).call(this,_);if(this._addMessage({role:a,name:m,content:x}),c)return}}async _runTools(t,n,r){var p,y,m;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((p=o==null?void 0:o.function)==null?void 0:p.name),{maxChatCompletions:l=ZL}=r||{},u=n.tools.map(v=>{if(dd(v)){if(!v.$callback)throw new et("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const f="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(y=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:y.message;if(!b)throw new et("missing message in ChatCompletion response");if(!((m=b.tool_calls)!=null&&m.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const _=w.id,{name:x,arguments:j}=w.function,S=d[x];if(S){if(c&&c!==x){const N=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:_,content:N});continue}}else{const N=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:_,content:N});continue}let E;try{E=UL(S)?await S.parse(j):j}catch(N){const P=N instanceof Error?N.message:String(N);this._addMessage({role:a,tool_call_id:_,content:P});continue}const O=await S.function(E,this),M=qn(this,Cn,"m",I_).call(this,O);if(this._addMessage({role:a,tool_call_id:_,content:M}),c)return}}}}Cn=new WeakSet,P_=function(){return qn(this,Cn,"m",nm).call(this).content??null},nm=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(_c(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new et("stream ended without producing a ChatCompletionMessage with role=assistant")},k_=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(_c(r)&&(r!=null&&r.function_call))return r.function_call;if(_c(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},A_=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(WL(t)&&t.content!=null||HL(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},T_=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},XL=function(e){if(e.n!=null&&e.n>1)throw new et("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},I_=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class fd extends JL{static runFunctions(t,n,r){const a=new fd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new fd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),_c(t)&&t.content&&this._emit("content",t.content)}}const QL=1,e6=2,t6=4,n6=8,r6=16,a6=32,o6=64,i6=128,s6=256,c6=i6|s6,l6=r6|a6|c6|o6,u6=QL|e6|l6,d6=t6|n6,fde=u6|d6,dn={STR:QL,NUM:e6,ARR:t6,OBJ:n6,NULL:r6,BOOL:a6,NAN:o6,INFINITY:i6,MINUS_INFINITY:s6,INF:c6,SPECIAL:l6,ATOM:u6,COLLECTION:d6,ALL:fde};class pde extends Error{}class hde extends Error{}function mde(e,t=dn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return yde(e.trim(),t)}const yde=(e,t)=>{const n=e.length;let r=0;const a=f=>{throw new pde(`${f} at position ${r}`)},o=f=>{throw new hde(`${f} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||dn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||dn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||dn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||dn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||dn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||dn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const f=r;let p=!1;for(r++;r<n&&(e[r]!=='"'||p&&e[r-1]==="\\");)p=e[r]==="\\"?!p:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(f,++r-Number(p)))}catch(y){o(String(y))}else if(dn.STR&t)try{return JSON.parse(e.substring(f,r-Number(p))+'"')}catch{return JSON.parse(e.substring(f,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const f={};try{for(;e[r]!=="}";){if(d(),r>=n&&dn.OBJ&t)return f;const p=s();d(),r++;try{const y=i();Object.defineProperty(f,p,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(dn.OBJ&t)return f;throw y}d(),e[r]===","&&r++}}catch{if(dn.OBJ&t)return f;a("Expected '}' at end of object")}return r++,f},l=()=>{r++;const f=[];try{for(;e[r]!=="]";)f.push(i()),d(),e[r]===","&&r++}catch{if(dn.ARR&t)return f;a("Expected ']' at end of array")}return r++,f},u=()=>{if(r===0){e==="-"&&dn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(p){if(dn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(p))}}const f=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(dn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(f,r))}catch{e.substring(f,r)==="-"&&dn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(f,e.lastIndexOf("e")))}catch(p){o(String(p))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},f6=e=>mde(e,dn.ALL^dn.NUM);var Sc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Et=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},on,_o,Ec,oi,R_,rm,D_,L_,$_,am,F_,p6;class pd extends JL{constructor(t){super(),on.add(this),_o.set(this,void 0),Ec.set(this,void 0),oi.set(this,void 0),Sc(this,_o,t,"f"),Sc(this,Ec,[],"f")}get currentChatCompletionSnapshot(){return Et(this,oi,"f")}static fromReadableStream(t){const n=new pd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new pd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Et(this,on,"m",R_).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Et(this,on,"m",D_).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,on,"m",am).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Et(this,on,"m",R_).call(this),this._connected();const a=Ma.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Et(this,on,"m",am).call(this)),Et(this,on,"m",D_).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,on,"m",am).call(this))}[(_o=new WeakMap,Ec=new WeakMap,oi=new WeakMap,on=new WeakSet,R_=function(){this.ended||Sc(this,oi,void 0,"f")},rm=function(t){let n=Et(this,Ec,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Et(this,Ec,"f")[t.index]=n,n)},D_=function(t){var r,a,o,i,s,c,l,u,d,f,p,y,m,v,b;if(this.ended)return;const n=Et(this,on,"m",p6).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const _=n.choices[w.index];w.delta.content!=null&&((r=_.message)==null?void 0:r.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",w.delta.content,_.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),w.delta.refusal!=null&&((o=_.message)==null?void 0:o.role)==="assistant"&&((i=_.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:_.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((f=_.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=w.logprobs)==null?void 0:p.refusal,snapshot:((y=_.logprobs)==null?void 0:y.refusal)??[]});const x=Et(this,on,"m",rm).call(this,_);_.finish_reason&&(Et(this,on,"m",$_).call(this,_),x.current_tool_call_index!=null&&Et(this,on,"m",L_).call(this,_,x.current_tool_call_index));for(const j of w.delta.tool_calls??[])x.current_tool_call_index!==j.index&&(Et(this,on,"m",$_).call(this,_),x.current_tool_call_index!=null&&Et(this,on,"m",L_).call(this,_,x.current_tool_call_index)),x.current_tool_call_index=j.index;for(const j of w.delta.tool_calls??[]){const S=(m=_.message.tool_calls)==null?void 0:m[j.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=S.function)==null?void 0:v.name,index:j.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((b=j.function)==null?void 0:b.arguments)??""}):S==null||S.type)}}},L_=function(t,n){var a,o,i;if(Et(this,on,"m",rm).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Et(this,_o,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:dd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},$_=function(t){var r,a;const n=Et(this,on,"m",rm).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Et(this,on,"m",F_).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},am=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");const t=Et(this,oi,"f");if(!t)throw new et("request ended without sending any chunks");return Sc(this,oi,void 0,"f"),Sc(this,Ec,[],"f"),gde(t,Et(this,_o,"f"))},F_=function(){var n;const t=(n=Et(this,_o,"f"))==null?void 0:n.response_format;return YL(t)?t:null},p6=function(t){var n,r,a,o;let i=Et(this,oi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Sc(this,oi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:f=null,...p}of t.choices){let y=i.choices[d];if(y||(y=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:f,...p}),f)if(!y.logprobs)y.logprobs=Object.assign({},f);else{const{content:j,refusal:S,...E}=f;Object.assign(y.logprobs,E),j&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(...j)),S&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...S))}if(u&&(y.finish_reason=u,Et(this,_o,"f")&&GL(Et(this,_o,"f")))){if(u==="length")throw new _L;if(u==="content_filter")throw new jL}if(Object.assign(y,p),!l)continue;const{content:m,refusal:v,function_call:b,role:w,tool_calls:_,...x}=l;if(Object.assign(y.message,x),v&&(y.message.refusal=(y.message.refusal||"")+v),w&&(y.message.role=w),b&&(y.message.function_call?(b.name&&(y.message.function_call.name=b.name),b.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=b.arguments)):y.message.function_call=b),m&&(y.message.content=(y.message.content||"")+m,!y.message.refusal&&Et(this,on,"m",F_).call(this)&&(y.message.parsed=f6(y.message.content))),_){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:j,id:S,type:E,function:O,...M}of _){const N=(o=y.message.tool_calls)[j]??(o[j]={});Object.assign(N,M),S&&(N.id=S),E&&(N.type=E),O&&(N.function??(N.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(N.function.name=O.name),O!=null&&O.arguments&&(N.function.arguments+=O.arguments,ude(Et(this,_o,"f"),N)&&(N.function.parsed_arguments=f6(N.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ma(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function gde(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:f,...p})=>{if(!u)throw new et(`missing finish_reason for choice ${d}`);const{content:y=null,function_call:m,tool_calls:v,...b}=l,w=l.role;if(!w)throw new et(`missing role for choice ${d}`);if(m){const{arguments:_,name:x}=m;if(_==null)throw new et(`missing function_call.arguments for choice ${d}`);if(!x)throw new et(`missing function_call.name for choice ${d}`);return{...p,message:{content:y,function_call:{arguments:_,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}return v?{...p,index:d,finish_reason:u,logprobs:f,message:{...b,role:w,content:y,refusal:l.refusal??null,tool_calls:v.map((_,x)=>{const{function:j,type:S,id:E,...O}=_,{arguments:M,name:N,...P}=j||{};if(E==null)throw new et(`missing choices[${d}].tool_calls[${x}].id
${om(e)}`);if(S==null)throw new et(`missing choices[${d}].tool_calls[${x}].type
${om(e)}`);if(N==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.name
${om(e)}`);if(M==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.arguments
${om(e)}`);return{...O,id:E,type:S,function:{...P,name:N,arguments:M}}})}}:{...p,message:{...b,content:y,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return sde(c,t)}function om(e){return JSON.stringify(e)}class Oc extends pd{static fromReadableStream(t){const n=new Oc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Oc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Oc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let h6=class extends ht{parse(e,t){return dde(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>M_(n,e))}runFunctions(e,t){return e.stream?Oc.runFunctions(this._client,e,t):fd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Oc.runTools(this._client,e,t):fd.runTools(this._client,e,t)}stream(e,t){return pd.createChatCompletion(this._client,e,t)}};class B_ extends ht{constructor(){super(...arguments),this.completions=new h6(this._client)}}(function(e){e.Completions=h6})(B_||(B_={}));class m6 extends ht{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class z_ extends ht{constructor(){super(...arguments),this.sessions=new m6(this._client)}}z_.Sessions=m6;var Ie=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ur=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},xn,V_,Pa,im,Yr,Zi,Cc,Ji,sm,dr,cm,lm,hd,md,yd,y6,g6,v6,b6,w6,x6,_6;class Gr extends KL{constructor(){super(...arguments),xn.add(this),V_.set(this,[]),Pa.set(this,{}),im.set(this,{}),Yr.set(this,void 0),Zi.set(this,void 0),Cc.set(this,void 0),Ji.set(this,void 0),sm.set(this,void 0),dr.set(this,void 0),cm.set(this,void 0),lm.set(this,void 0),hd.set(this,void 0)}[(V_=new WeakMap,Pa=new WeakMap,im=new WeakMap,Yr=new WeakMap,Zi=new WeakMap,Cc=new WeakMap,Ji=new WeakMap,sm=new WeakMap,dr=new WeakMap,cm=new WeakMap,lm=new WeakMap,hd=new WeakMap,xn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new Gr;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Ma.fromReadableStream(t,this.controller);for await(const i of a)Ie(this,xn,"m",md).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",yd).call(this))}toReadableStream(){return new Ma(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new Gr;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Ie(this,xn,"m",md).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",yd).call(this))}static createThreadAssistantStream(t,n,r){const a=new Gr;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new Gr;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Ie(this,cm,"f")}currentRun(){return Ie(this,lm,"f")}currentMessageSnapshot(){return Ie(this,Yr,"f")}currentRunStepSnapshot(){return Ie(this,hd,"f")}async finalRunSteps(){return await this.done(),Object.values(Ie(this,Pa,"f"))}async finalMessages(){return await this.done(),Object.values(Ie(this,im,"f"))}async finalRun(){if(await this.done(),!Ie(this,Zi,"f"))throw Error("Final run was not received.");return Ie(this,Zi,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Ie(this,xn,"m",md).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",yd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Ie(this,xn,"m",md).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",yd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(__(o)&&__(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!__(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}md=function(e){if(!this.ended)switch(ur(this,cm,e,"f"),Ie(this,xn,"m",v6).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ie(this,xn,"m",_6).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ie(this,xn,"m",g6).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ie(this,xn,"m",y6).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},yd=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");if(!Ie(this,Zi,"f"))throw Error("Final run has not been received");return Ie(this,Zi,"f")},y6=function(e){const[t,n]=Ie(this,xn,"m",w6).call(this,e,Ie(this,Yr,"f"));ur(this,Yr,t,"f"),Ie(this,im,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Ie(this,Cc,"f")){if(Ie(this,Ji,"f"))switch(Ie(this,Ji,"f").type){case"text":this._emit("textDone",Ie(this,Ji,"f").text,Ie(this,Yr,"f"));break;case"image_file":this._emit("imageFileDone",Ie(this,Ji,"f").image_file,Ie(this,Yr,"f"));break}ur(this,Cc,r.index,"f")}ur(this,Ji,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ie(this,Cc,"f")!==void 0){const r=e.data.content[Ie(this,Cc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Ie(this,Yr,"f"));break;case"text":this._emit("textDone",r.text,Ie(this,Yr,"f"));break}}Ie(this,Yr,"f")&&this._emit("messageDone",e.data),ur(this,Yr,void 0,"f")}},g6=function(e){const t=Ie(this,xn,"m",b6).call(this,e);switch(ur(this,hd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Ie(this,sm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Ie(this,dr,"f")&&this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,sm,r.index,"f"),ur(this,dr,t.step_details.tool_calls[r.index],"f"),Ie(this,dr,"f")&&this._emit("toolCallCreated",Ie(this,dr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ur(this,hd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ie(this,dr,"f")&&(this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,dr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},v6=function(e){Ie(this,V_,"f").push(e),this._emit("event",e)},b6=function(e){switch(e.event){case"thread.run.step.created":return Ie(this,Pa,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ie(this,Pa,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=Gr.accumulateDelta(t,n.delta);Ie(this,Pa,"f")[e.data.id]=r}return Ie(this,Pa,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ie(this,Pa,"f")[e.data.id]=e.data;break}if(Ie(this,Pa,"f")[e.data.id])return Ie(this,Pa,"f")[e.data.id];throw new Error("No snapshot available")},w6=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Ie(this,xn,"m",x6).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},x6=function(e,t){return Gr.accumulateDelta(t,e)},_6=function(e){switch(ur(this,lm,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ur(this,Zi,e.data,"f"),Ie(this,dr,"f")&&(this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,dr,void 0,"f"));break}};class U_ extends ht{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,W_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class W_ extends qr{}U_.MessagesPage=W_;class H_ extends ht{retrieve(t,n,r,a={},o){return Hn(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return Hn(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,q_,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class q_ extends qr{}H_.RunStepsPage=q_;class gd extends ht{constructor(){super(...arguments),this.steps=new H_(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,K_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return Gr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await od(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return Gr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return Gr.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class K_ extends qr{}gd.RunsPage=K_,gd.Steps=H_,gd.RunStepsPage=q_;class Nc extends ht{constructor(){super(...arguments),this.runs=new gd(this._client),this.messages=new U_(this._client)}create(t={},n){return Hn(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return Gr.createThreadAssistantStream(t,this._client.beta.threads,n)}}Nc.Runs=gd,Nc.RunsPage=K_,Nc.Messages=U_,Nc.MessagesPage=W_;const vde=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let Y_=class extends ht{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return Hn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,um,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await od(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class um extends qr{}Y_.VectorStoreFilesPage=um;class j6 extends ht{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return Hn(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,um,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await od(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(f){for(let p of f){const y=await s.files.create({file:p,purpose:"assistants"},a);l.push(y.id)}}const d=Array(i).fill(c).map(u);return await vde(d),await this.createAndPoll(t,{file_ids:l})}}class Mc extends ht{constructor(){super(...arguments),this.files=new Y_(this._client),this.fileBatches=new j6(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/vector_stores",G_,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class G_ extends qr{}Mc.VectorStoresPage=G_,Mc.Files=Y_,Mc.VectorStoreFilesPage=um,Mc.FileBatches=j6;class ii extends ht{constructor(){super(...arguments),this.realtime=new z_(this._client),this.vectorStores=new Mc(this._client),this.chat=new B_(this._client),this.assistants=new O_(this._client),this.threads=new Nc(this._client)}}ii.Realtime=z_,ii.VectorStores=Mc,ii.VectorStoresPage=G_,ii.Assistants=O_,ii.AssistantsPage=C_,ii.Threads=Nc;class S6 extends ht{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class E6 extends ht{create(t,n){return this._client.post("/embeddings",{body:t,...n})}}class X_ extends ht{create(t,n){return this._client.post("/files",bc({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/files",Z_,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await od(n),i=await this.retrieve(t),Date.now()-o>r)throw new qh({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class Z_ extends qr{}X_.FileObjectsPage=Z_;class J_ extends ht{list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Q_,{query:n,...r})}}class Q_ extends qr{}J_.FineTuningJobCheckpointsPage=Q_;class Pc extends ht{constructor(){super(...arguments),this.checkpoints=new J_(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",ej,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return Hn(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,tj,{query:n,...r})}}class ej extends qr{}class tj extends qr{}Pc.FineTuningJobsPage=ej,Pc.FineTuningJobEventsPage=tj,Pc.Checkpoints=J_,Pc.FineTuningJobCheckpointsPage=Q_;class vd extends ht{constructor(){super(...arguments),this.jobs=new Pc(this._client)}}vd.Jobs=Pc,vd.FineTuningJobsPage=ej,vd.FineTuningJobEventsPage=tj;class O6 extends ht{createVariation(t,n){return this._client.post("/images/variations",bc({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",bc({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}class nj extends ht{retrieve(t,n){return this._client.get(`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",rj,t)}del(t,n){return this._client.delete(`/models/${t}`,n)}}class rj extends ade{}nj.ModelsPage=rj;class C6 extends ht{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class N6 extends ht{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,bc({body:n,...r}))}}class aj extends ht{constructor(){super(...arguments),this.parts=new N6(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}aj.Parts=N6;var M6;let it=class extends Hue{constructor({baseURL:e=Xh("OPENAI_BASE_URL"),apiKey:t=Xh("OPENAI_API_KEY"),organization:n=Xh("OPENAI_ORG_ID")??null,project:r=Xh("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new et("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&nde())throw new et(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new S6(this),this.chat=new j_(this),this.embeddings=new E6(this),this.files=new X_(this),this.images=new O6(this),this.audio=new id(this),this.moderations=new C6(this),this.models=new nj(this),this.fineTuning=new vd(this),this.beta=new ii(this),this.batches=new S_(this),this.uploads=new aj(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Nue(e,{arrayFormat:"brackets"})}};M6=it,it.OpenAI=M6,it.DEFAULT_TIMEOUT=6e5,it.OpenAIError=et,it.APIError=wn,it.APIConnectionError=Hh,it.APIConnectionTimeoutError=qh,it.APIUserAbortError=wr,it.NotFoundError=gL,it.ConflictError=vL,it.RateLimitError=wL,it.BadRequestError=hL,it.AuthenticationError=mL,it.InternalServerError=xL,it.PermissionDeniedError=yL,it.UnprocessableEntityError=bL,it.toFile=CL,it.fileFromPath=fL,it.Completions=S6,it.Chat=j_,it.Embeddings=E6,it.Files=X_,it.FileObjectsPage=Z_,it.Images=O6,it.Audio=id,it.Moderations=C6,it.Models=nj,it.ModelsPage=rj,it.FineTuning=vd,it.Beta=ii,it.Batches=S_,it.BatchesPage=E_,it.Uploads=aj;var bde=typeof window=="object"?window:{},Ye="0123456789abcdef".split(""),wde=[-2147483648,8388608,32768,128],Xr=[24,16,8,0],fn=[];function Zr(e){e?(fn[0]=fn[16]=fn[1]=fn[2]=fn[3]=fn[4]=fn[5]=fn[6]=fn[7]=fn[8]=fn[9]=fn[10]=fn[11]=fn[12]=fn[13]=fn[14]=fn[15]=0,this.blocks=fn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Zr.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===bde.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<Xr[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<Xr[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<Xr[a++&3],i[a>>2]|=(128|n&63)<<Xr[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<Xr[a++&3],i[a>>2]|=(128|n>>6&63)<<Xr[a++&3],i[a>>2]|=(128|n&63)<<Xr[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<Xr[a++&3],i[a>>2]|=(128|n>>12&63)<<Xr[a++&3],i[a>>2]|=(128|n>>6&63)<<Xr[a++&3],i[a>>2]|=(128|n&63)<<Xr[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Zr.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=wde[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Zr.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},Zr.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Ye[e>>28&15]+Ye[e>>24&15]+Ye[e>>20&15]+Ye[e>>16&15]+Ye[e>>12&15]+Ye[e>>8&15]+Ye[e>>4&15]+Ye[e&15]+Ye[t>>28&15]+Ye[t>>24&15]+Ye[t>>20&15]+Ye[t>>16&15]+Ye[t>>12&15]+Ye[t>>8&15]+Ye[t>>4&15]+Ye[t&15]+Ye[n>>28&15]+Ye[n>>24&15]+Ye[n>>20&15]+Ye[n>>16&15]+Ye[n>>12&15]+Ye[n>>8&15]+Ye[n>>4&15]+Ye[n&15]+Ye[r>>28&15]+Ye[r>>24&15]+Ye[r>>20&15]+Ye[r>>16&15]+Ye[r>>12&15]+Ye[r>>8&15]+Ye[r>>4&15]+Ye[r&15]+Ye[a>>28&15]+Ye[a>>24&15]+Ye[a>>20&15]+Ye[a>>16&15]+Ye[a>>12&15]+Ye[a>>8&15]+Ye[a>>4&15]+Ye[a&15]},Zr.prototype.toString=Zr.prototype.hex,Zr.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},Zr.prototype.array=Zr.prototype.digest,Zr.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const xde=e=>new Zr(!0).update(e).hex(),P6=(...e)=>xde(e.join("_"));class _de{}const jde=new Map;class oj extends _de{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(P6(t,n))??null)}async update(t,n,r){this.cache.set(P6(t,n),r)}static global(){return new oj(jde)}}const Sde=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function Ede(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const Ode=()=>!1;class Cde extends Rf{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??Ode(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class Nde extends Cde{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=oj.global():this.cache=void 0,this.caller=new jAe(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await SAe("modelName"in this?Sde(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new H4(t):Array.isArray(t)?new nue(t.map(Df)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class dm extends Rf{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=lK(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=lK(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=uK(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new EAe(new OAe({steps:t}))}}function k6(e){return typeof(e==null?void 0:e.parse)=="function"}class si extends Nde{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=si._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===si.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=si._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await xN.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const f of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(f.message.id==null){const p=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;p!=null&&f.message._updateId(`run-${p}`)}f.message.response_metadata={...f.generationInfo,...f.message.response_metadata},yield f.message,d?d=d.concat(f):d=f}}catch(f){throw await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMError(f))),f}await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var f,p;const a=t.map(y=>y.map(Df)),o={...r.metadata,...this.getLsParams(n)},i=await xN.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(y=>CAe(y)||NAe(y))&&a.length===1&&this._streamResponseChunks!==si.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let m;for await(const v of y){if(v.message.id==null){const b=(f=c==null?void 0:c.at(0))==null?void 0:f.runId;b!=null&&v.message._updateId(`run-${b}`)}m===void 0?m=v:m=uK(m,v)}if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(y){throw await(c==null?void 0:c[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((m,v)=>this._generate(m,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(y.map(async(m,v)=>{var b,w,_;if(m.status==="fulfilled"){const x=m.value;for(const j of x.generations){if(j.message.id==null){const S=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;S!=null&&j.message._updateId(`run-${S}`)}j.message.response_metadata={...j.generationInfo,...j.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((_=c==null?void 0:c[v])==null?void 0:_.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const d={generations:l,llmOutput:u.length?(p=this._combineLLMOutput)==null?void 0:p.call(this,...u):void 0};return Object.defineProperty(d,dK,{value:c?{runIds:c==null?void 0:c.map(y=>y.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(m=>m.map(Df)),s={...o.metadata,...this.getLsParams(a)},c=await xN.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],f=(await Promise.allSettled(i.map(async(m,v)=>{const b=si._convertInputToPromptValue(m).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((m,v)=>({result:m,runManager:u==null?void 0:u[v]})).filter(({result:m})=>m.status==="fulfilled"&&m.value!=null||m.status==="rejected"),p=[];await Promise.all(f.map(async({result:m,runManager:v},b)=>{if(m.status==="fulfilled"){const w=m.value;return p[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(m.reason)),Promise.reject(m.reason)}));const y={generations:p,missingPromptIndices:d};return Object.defineProperty(y,dK,{value:u?{runIds:u==null?void 0:u.map(m=>m.runId)}:void 0,configurable:!0}),y}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(p=>p.map(Df)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let f={};if(d.length>0){const p=await this._generateUncached(d.map(y=>o[y]),s,i);await Promise.all(p.generations.map(async(y,m)=>{const v=d[m];u[v]=y;const b=si._convertInputToPromptValue(o[v]).toString();return c.update(b,l,y)})),f=p.llmOutput??{}}return{generations:u,llmOutput:f}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(Df)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Pr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;k6(r)?l=[{type:"function",function:{name:c,description:o,parameters:_N(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=MAe.from(m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=m.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const f=dm.assign({parsed:(m,v)=>d.invoke(m.raw,v)}),p=dm.assign({parsed:()=>null}),y=f.withFallbacks({fallbacks:[p]});return fK.from([{raw:u},y]).withConfig({runName:"StructuredOutputRunnable"})}}class Mde extends Rf{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class A6 extends Mde{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class ij extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function sj(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!sj(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!sj(e[o],t[o]))return!1;return!0}return e===t}class Pde extends A6{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class T6 extends Pde{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(PAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Ng({message:a,text:a.content})}else if(kAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Ng({message:AAe(a),text:a.content})}else o=new TAe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!sj(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class I6 extends A6{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=fa.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,fa.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(_N(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new ij(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class R6 extends T6{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?FK(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return pK(t[0].text)}async parse(t){return pK(t,JSON.parse)}getFormatInstructions(){return""}}function D6(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=IAe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new ij([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function kde(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function Ade(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class Tde extends T6{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(jN(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>D6(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class L6 extends Tde{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new ij(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const Ide=Symbol("Let zodToJsonSchema decide on which parser to use"),Rde={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Dde=e=>({...Rde,...e}),Lde=e=>{const t=Dde(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function $6(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function _t(e,t,n,r,a){e[t]=n,$6(e,t,r,a)}function $de(){return{}}function Fde(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=mt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&_t(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&_t(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(_t(n,"minItems",e.exactLength.value,e.exactLength.message,t),_t(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Bde(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function zde(){return{type:"boolean"}}function Vde(e,t){return mt(e.type._def,t)}const Ude=(e,t)=>mt(e.innerType._def,t);function F6(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>F6(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Wde(e,t)}}const Wde=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":_t(n,"minimum",r.value,r.message,t);break;case"max":_t(n,"maximum",r.value,r.message,t);break}return n};function Hde(e,t){return{...mt(e.innerType._def,t),default:e.defaultValue()}}function qde(e,t){return t.effectStrategy==="input"?mt(e.schema._def,t):{}}function Kde(e){return{type:"string",enum:e.values}}const Yde=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Gde(e,t){const n=[mt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),mt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Yde(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Xde(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let cj;const Qi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(cj===void 0&&(cj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),cj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function B6(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Zde(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Jr(n,"email",a.message,t);break;case"format:idn-email":Jr(n,"idn-email",a.message,t);break;case"pattern:zod":Qr(n,Qi.email,a.message,t);break}break;case"url":Jr(n,"uri",a.message,t);break;case"uuid":Jr(n,"uuid",a.message,t);break;case"regex":Qr(n,a.regex,a.message,t);break;case"cuid":Qr(n,Qi.cuid,a.message,t);break;case"cuid2":Qr(n,Qi.cuid2,a.message,t);break;case"startsWith":Qr(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":Qr(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":Jr(n,"date-time",a.message,t);break;case"date":Jr(n,"date",a.message,t);break;case"time":Jr(n,"time",a.message,t);break;case"duration":Jr(n,"duration",a.message,t);break;case"length":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{Qr(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&Jr(n,"ipv4",a.message,t),a.version!=="v4"&&Jr(n,"ipv6",a.message,t);break}case"emoji":Qr(n,Qi.emoji,a.message,t);break;case"ulid":{Qr(n,Qi.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Jr(n,"binary",a.message,t);break}case"contentEncoding:base64":{_t(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{Qr(n,Qi.base64,a.message,t);break}}break}case"nanoid":Qr(n,Qi.nanoid,a.message,t)}return n}const Zde=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),Jr=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):_t(e,"format",t,n,r)},Qr=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:z6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):_t(e,"pattern",z6(t,r),n,r)},z6=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function V6(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(B6(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Jde(e,t){if(t.mapStrategy==="record")return V6(e,t);const n=mt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Qde(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function efe(){return{not:{}}}function tfe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const fm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function nfe(e,t){if(t.target==="openApi3")return U6(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in fm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=fm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return U6(e,t)}const U6=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>mt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function rfe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:fm[e.innerType._def.typeName],nullable:!0}:{type:[fm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=mt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function afe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",$6(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function ofe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function ife(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=mt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:ofe(e,t)};return n.required.length||delete n.required,n}const sfe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return mt(e.innerType._def,t);const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},cfe=(e,t)=>{if(t.pipeStrategy==="input")return mt(e.in._def,t);if(t.pipeStrategy==="output")return mt(e.out._def,t);const n=mt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=mt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function lfe(e,t){return mt(e.type._def,t)}function ufe(e,t){const n={type:"array",uniqueItems:!0,items:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&_t(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&_t(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function dfe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:mt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function ffe(){return{not:{}}}function pfe(){return{}}const hfe=(e,t)=>mt(e.innerType._def,t);function mt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==Ide)return s}if(r&&!n){const s=mfe(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=gfe(e,e.typeName,t);return o&&vfe(e,t,o),a.jsonSchema=o,o}const mfe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:yfe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},yfe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},gfe=(e,t,n)=>{switch(t){case me.ZodString:return B6(e,n);case me.ZodNumber:return afe(e,n);case me.ZodObject:return ife(e,n);case me.ZodBigInt:return Bde(e,n);case me.ZodBoolean:return zde();case me.ZodDate:return F6(e,n);case me.ZodUndefined:return ffe();case me.ZodNull:return tfe(n);case me.ZodArray:return Fde(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return nfe(e,n);case me.ZodIntersection:return Gde(e,n);case me.ZodTuple:return dfe(e,n);case me.ZodRecord:return V6(e,n);case me.ZodLiteral:return Xde(e,n);case me.ZodEnum:return Kde(e);case me.ZodNativeEnum:return Qde(e);case me.ZodNullable:return rfe(e,n);case me.ZodOptional:return sfe(e,n);case me.ZodMap:return Jde(e,n);case me.ZodSet:return ufe(e,n);case me.ZodLazy:return mt(e.getter()._def,n);case me.ZodPromise:return lfe(e,n);case me.ZodNaN:case me.ZodNever:return efe();case me.ZodEffects:return qde(e,n);case me.ZodAny:return $de();case me.ZodUnknown:return pfe();case me.ZodDefault:return Hde(e,n);case me.ZodBranded:return Vde(e,n);case me.ZodReadonly:return hfe(e,n);case me.ZodCatch:return Ude(e,n);case me.ZodPipeline:return cfe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(r=>{})()}},vfe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),bfe=(e,t)=>{const n=Lde(t),r=void 0,a=t==null?void 0:t.name,o=mt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},wfe=Symbol("Let zodToJsonSchema decide on which parser to use"),W6={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},xfe=e=>typeof e=="string"?{...W6,basePath:["#"],definitions:{},name:e}:{...W6,basePath:["#"],definitions:{},...e},lj=e=>"_def"in e?e._def:e;function _fe(e){if(!e)return!0;for(const t in e)return!1;return!0}const jfe=e=>{const t=xfe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[lj(a),{def:lj(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function H6(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function jt(e,t,n,r,a){e[t]=n,H6(e,t,r,a)}function Sfe(){return{}}function Efe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=dt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&jt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&jt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(jt(n,"minItems",e.exactLength.value,e.exactLength.message,t),jt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Ofe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function Cfe(){return{type:"boolean"}}function Nfe(e,t){return dt(e.type._def,t)}const Mfe=(e,t)=>dt(e.innerType._def,t);function q6(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>q6(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Pfe(e,t)}}const Pfe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":jt(n,"minimum",r.value,r.message,t);break;case"max":jt(n,"maximum",r.value,r.message,t);break}return n};function kfe(e,t){return{...dt(e.innerType._def,t),default:e.defaultValue()}}function Afe(e,t,n){return t.effectStrategy==="input"?dt(e.schema._def,t,n):{}}function Tfe(e){return{type:"string",enum:[...e.values]}}const Ife=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Rfe(e,t){const n=[dt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),dt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Ife(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Dfe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let uj;const es={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(uj===void 0&&(uj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),uj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function K6(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Lfe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ea(n,"email",a.message,t);break;case"format:idn-email":ea(n,"idn-email",a.message,t);break;case"pattern:zod":ta(n,es.email,a.message,t);break}break;case"url":ea(n,"uri",a.message,t);break;case"uuid":ea(n,"uuid",a.message,t);break;case"regex":ta(n,a.regex,a.message,t);break;case"cuid":ta(n,es.cuid,a.message,t);break;case"cuid2":ta(n,es.cuid2,a.message,t);break;case"startsWith":ta(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ta(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ea(n,"date-time",a.message,t);break;case"date":ea(n,"date",a.message,t);break;case"time":ea(n,"time",a.message,t);break;case"duration":ea(n,"duration",a.message,t);break;case"length":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ta(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ea(n,"ipv4",a.message,t),a.version!=="v4"&&ea(n,"ipv6",a.message,t);break}case"emoji":ta(n,es.emoji,a.message,t);break;case"ulid":{ta(n,es.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ea(n,"binary",a.message,t);break}case"contentEncoding:base64":{jt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ta(n,es.base64,a.message,t);break}}break}case"nanoid":ta(n,es.nanoid,a.message,t)}return n}const Lfe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ea=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):jt(e,"format",t,n,r)},ta=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:Y6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):jt(e,"pattern",Y6(t,r),n,r)},Y6=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function G6(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(K6(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function $fe(e,t){if(t.mapStrategy==="record")return G6(e,t);const n=dt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Ffe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Bfe(){return{not:{}}}function zfe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const pm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Vfe(e,t){if(t.target==="openApi3")return X6(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in pm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=pm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return X6(e,t)}const X6=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>dt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Ufe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:pm[e.innerType._def.typeName],nullable:!0}:{type:[pm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=dt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Wfe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",H6(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function Hfe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function qfe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=dt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Hfe(e,t)};return n.required.length||delete n.required,n}const Kfe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return dt(e.innerType._def,t);const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Yfe=(e,t)=>{if(t.pipeStrategy==="input")return dt(e.in._def,t);if(t.pipeStrategy==="output")return dt(e.out._def,t);const n=dt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=dt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Gfe(e,t){return dt(e.type._def,t)}function Xfe(e,t){const n={type:"array",uniqueItems:!0,items:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&jt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&jt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Zfe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:dt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Jfe(){return{not:{}}}function Qfe(){return{}}const epe=(e,t)=>dt(e.innerType._def,t);function dt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==wfe)return s}if(r&&!n){const s=tpe(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=rpe(e,e.typeName,t,n);return o&&ape(e,t,o),a.jsonSchema=o,o}const tpe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:npe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},npe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},rpe=(e,t,n,r)=>{switch(t){case me.ZodString:return K6(e,n);case me.ZodNumber:return Wfe(e,n);case me.ZodObject:return qfe(e,n);case me.ZodBigInt:return Ofe(e,n);case me.ZodBoolean:return Cfe();case me.ZodDate:return q6(e,n);case me.ZodUndefined:return Jfe();case me.ZodNull:return zfe(n);case me.ZodArray:return Efe(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return Vfe(e,n);case me.ZodIntersection:return Rfe(e,n);case me.ZodTuple:return Zfe(e,n);case me.ZodRecord:return G6(e,n);case me.ZodLiteral:return Dfe(e,n);case me.ZodEnum:return Tfe(e);case me.ZodNativeEnum:return Ffe(e);case me.ZodNullable:return Ufe(e,n);case me.ZodOptional:return Kfe(e,n);case me.ZodMap:return $fe(e,n);case me.ZodSet:return Xfe(e,n);case me.ZodLazy:return dt(e.getter()._def,n);case me.ZodPromise:return Gfe(e,n);case me.ZodNaN:case me.ZodNever:return Bfe();case me.ZodEffects:return Afe(e,n,r);case me.ZodAny:return Sfe();case me.ZodUnknown:return Qfe();case me.ZodDefault:return kfe(e,n);case me.ZodBranded:return Nfe(e,n);case me.ZodReadonly:return epe(e,n);case me.ZodCatch:return Mfe(e,n);case me.ZodPipeline:return Yfe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(a=>{})()}},ape=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),ope=(e,t)=>{const n=jfe(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=dt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(_fe(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([f])=>!l.has(f));if(d.length===0)break;for(const[f,p]of d)c[f]=dt(lj(p),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},l.add(f)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function Z6(e,t){return ope(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function ipe(e,t,n){return ode({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:Z6(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function spe(e){return ide({type:"function",function:{name:e.name,parameters:Z6(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function cpe(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function lpe(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:_N(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function upe(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function dpe(e){return e!==void 0&&Rf.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function fpe(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&k6(e.schema)}function ppe(e){return fpe(e)||dpe(e)||upe(e)}function hm(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function J6(e){let t;return e.constructor.name===qh.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===wr.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=hm(e,"INVALID_TOOL_RESULTS"):e.status===401?t=hm(e,"MODEL_AUTHENTICATION"):e.status===429?t=hm(e,"MODEL_RATE_LIMIT"):e.status===404?t=hm(e,"MODEL_NOT_FOUND"):t=e,t}function hpe(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function mpe(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function ype(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(Q6(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function Q6(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${mm(o,t)},`):n.push(`${a}?: ${mm(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function mm(e,t){if(mpe(e))return e.anyOf.map(n=>mm(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Q6(e,t+2),"}"].join(`
`);case"array":return e.items?`${mm(e.items,t)}[]`:"any[]";default:return""}}function gpe(e,t){let n;if(ppe(e)){const r=spe({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:lpe(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function vpe(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function e8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!mK.isInstance(e))throw new Error("Invalid generic chat message");return vpe(e)}default:throw new Error(`Unknown message type: ${t}`)}}function bpe(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(D6(c,{returnId:!0}))}catch(l){o.push(Ade(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new Uo({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new mK(e.content||"",e.role??"unknown")}}function wpe(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new RAe({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new hK({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new yK({content:o,response_metadata:s}):a==="developer"?new yK({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new DAe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new LAe({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new $Ae({content:o,role:a,response_metadata:s})}function t8(e,t){return e.flatMap(n=>{var o;let r=e8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),jN(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(kde),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function n8(e,t){return Ede(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:gpe(e,t)}class xpe extends si{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??Ci("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??Ci("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??Ci("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??Ci("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??Ci("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??Ci("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??Ci("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??Ci("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const f=this.azureOpenAIBasePath.split("/openai/deployments/");if(f.length===2){const[,p]=f;this.azureOpenAIApiDeploymentName=p}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>n8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&ym(t.json_schema.schema)?ipe(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>n8(c,{strict:r})):void 0,tool_choice:hpe(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,f,p,y,m,v,b,w;const a=t8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const _ of s){const x=(l=_==null?void 0:_.choices)==null?void 0:l[0];if(_.usage&&(c=_.usage),!x)continue;const{delta:j}=x;if(!j)continue;const S=wpe(j,_,i,this.__includeRawResponse);i=j.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=_.system_fingerprint,O.model_name=_.model),this.logprobs&&(O.logprobs=x.logprobs);const M=new Ng({message:S,text:S.content,generationInfo:O});yield M,await(r==null?void 0:r.handleLLMNewToken(M.text??"",E,void 0,void 0,void 0,{chunk:M}))}if(c){const _={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((f=c.prompt_tokens_details)==null?void 0:f.cached_tokens)!==null&&{cache_read:(p=c.prompt_tokens_details)==null?void 0:p.cached_tokens}},x={...((y=c.completion_tokens_details)==null?void 0:y.audio_tokens)!==null&&{audio:(m=c.completion_tokens_details)==null?void 0:m.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new Ng({message:new hK({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(_).length>0&&{input_token_details:_},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=t8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:f,function_call:p}=this.invocationParams(n),y=await this.getEstimatedTokenCountFromPrompt(t,f,p),m=await this.getNumTokensFromGenerations(d);return a.input_tokens=y,a.output_tokens=m,a.total_tokens=y+m,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:f,prompt_tokens_details:p,completion_tokens_details:y}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),f&&(a.total_tokens=(a.total_tokens??0)+f),((p==null?void 0:p.audio_tokens)!==null||(p==null?void 0:p.cached_tokens)!==null)&&(a.input_token_details={...(p==null?void 0:p.audio_tokens)!==null&&{audio:p==null?void 0:p.audio_tokens},...(p==null?void 0:p.cached_tokens)!==null&&{cache_read:p==null?void 0:p.cached_tokens}}),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.reasoning_tokens)!==null)&&(a.output_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.reasoning_tokens)!==null&&{reasoning:y==null?void 0:y.reasoning_tokens}});const m=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:bpe(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},jN(b.message)&&(b.message.usage_metadata=a),b.message=new Uo(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),m.push(b)}return{generations:m,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=ype(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var f,p,y,m,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(e8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(f=d.additional_kwargs)!=null&&f.function_call&&(u+=3),(p=d==null?void 0:d.additional_kwargs.function_call)!=null&&p.name&&(u+=await this.getNumTokens((y=d.additional_kwargs.function_call)==null?void 0:y.name)),(m=d.additional_kwargs.function_call)==null?void 0:m.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw J6(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw J6(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=cpe(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new it(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;_pe(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),ym(r)?c=I6.fromZodSchema(r):c=new R6;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),ym(r)?c=I6.fromZodSchema(r):c=new R6;else{let f=a??"extract";if(ym(r)){const p=bfe(r);s=this.bind({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new L6({returnSingle:!0,keyName:f,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,f=r.name):(f=r.title??f,p={name:f,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new L6({returnSingle:!0,keyName:f})}}if(!i)return s.pipe(c);const l=dm.assign({parsed:(f,p)=>c.invoke(f.raw,p)}),u=dm.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return fK.from([{raw:s},d])}}function ym(e){return typeof(e==null?void 0:e.parse)=="function"}function _pe(e){return e!==void 0&&typeof e.schema=="object"}class jpe{constructor(){kf(this,"sessionKeyProcess");kf(this,"sessionKey");kf(this,"loadded",!1);kf(this,"sessionMemory",new Map);this.init()}async init(){if(this.loadded)return;const t={name:"AES-GCM",length:256},n=["encrypt","decrypt"];this.sessionKeyProcess=window.crypto.subtle.generateKey(t,!0,n).then(r=>r),this.sessionKey=await this.sessionKeyProcess,this.loadded=!0,this.sessionKeyProcess=void 0}async set(t,n){this.sessionKeyProcess&&await this.sessionKeyProcess;const r=await crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12)},this.sessionKey,new TextEncoder().encode(n));this.sessionMemory.set(t,r)}async get(t){const n=this.sessionMemory.get(t);if(!n)return null;this.sessionKeyProcess&&await this.sessionKeyProcess;const r=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12)},this.sessionKey,n);return new TextDecoder().decode(r)}async exists(t){return this.sessionMemory.has(t)}}const gm=new jpe;var Spe=Object.defineProperty,Epe=Object.defineProperties,Ope=Object.getOwnPropertyDescriptors,vm=Object.getOwnPropertySymbols,r8=Object.prototype.hasOwnProperty,a8=Object.prototype.propertyIsEnumerable,o8=(e,t,n)=>t in e?Spe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Cpe=(e,t)=>{for(var n in t||(t={}))r8.call(t,n)&&o8(e,n,t[n]);if(vm)for(var n of vm(t))a8.call(t,n)&&o8(e,n,t[n]);return e},Npe=(e,t)=>Epe(e,Ope(t)),Mpe=(e,t)=>{var n={};for(var r in e)r8.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&vm)for(var r of vm(e))t.indexOf(r)<0&&a8.call(e,r)&&(n[r]=e[r]);return n};function Ppe(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function kpe(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Ape=18,i8=40,Tpe=`${i8}px`,Ipe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Rpe({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let f=e.current,p=t.current;if(!f||!p||c||n==="none")return;let y=f,m=y.getBoundingClientRect().left+y.offsetWidth,v=y.getBoundingClientRect().top+y.offsetHeight/2,b=m-Ape,w=v;document.querySelectorAll(Ipe).length===0&&document.elementFromPoint(b,w)===f||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let f=e.current;if(!f||n==="none")return;function p(){let m=window.innerWidth-f.getBoundingClientRect().right;s(m>=i8)}p();let y=setInterval(p,1e3);return()=>{clearInterval(y)}},[e,n]),g.useEffect(()=>{let f=r||document.activeElement===t.current;if(n==="none"||!f)return;let p=setTimeout(d,0),y=setTimeout(d,2e3),m=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(p),clearTimeout(y),clearTimeout(m),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Tpe}}var s8=g.createContext({}),c8=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:f,containerClassName:p,noScriptCSSFallback:y=Dpe,render:m,children:v}=n,b=Mpe(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,_,x,j,S;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),M=r??E,N=kpe(M),P=g.useCallback(re=>{a==null||a(re),O(re)},[a]),I=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),k=g.useRef(null),C=g.useRef(null),A=g.useRef({value:M,onChange:P,isIOS:typeof window<"u"&&((_=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:_.call(w,"-webkit-touch-callout","none"))}),T=g.useRef({prev:[(x=k.current)==null?void 0:x.selectionStart,(j=k.current)==null?void 0:j.selectionEnd,(S=k.current)==null?void 0:S.selectionDirection]});g.useImperativeHandle(t,()=>k.current,[]),g.useEffect(()=>{let re=k.current,le=C.current;if(!re||!le)return;A.current.value!==re.value&&A.current.onChange(re.value),T.current.prev=[re.selectionStart,re.selectionEnd,re.selectionDirection];function je(){if(document.activeElement!==re){$(null),z(null);return}let Se=re.selectionStart,Ve=re.selectionEnd,We=re.selectionDirection,He=re.maxLength,Mt=re.value,st=T.current.prev,rt=-1,bt=-1,qt;if(Mt.length!==0&&Se!==null&&Ve!==null){let za=Se===Ve,Z=Se===Mt.length&&Mt.length<He;if(za&&!Z){let ee=Se;if(ee===0)rt=0,bt=1,qt="forward";else if(ee===He)rt=ee-1,bt=ee,qt="backward";else if(He>1&&Mt.length>1){let se=0;if(st[0]!==null&&st[1]!==null){qt=ee<st[1]?"backward":"forward";let he=st[0]===st[1]&&st[0]<He;qt==="backward"&&!he&&(se=-1)}rt=se+ee,bt=se+ee+1}}rt!==-1&&bt!==-1&&rt!==bt&&k.current.setSelectionRange(rt,bt,qt)}let Xn=rt!==-1?rt:Se,Ba=bt!==-1?bt:Ve,Zn=qt??We;$(Xn),z(Ba),T.current.prev=[Xn,Ba,Zn]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===re&&F(!0),!document.getElementById("input-otp-style")){let Se=document.createElement("style");if(Se.id="input-otp-style",document.head.appendChild(Se),Se.sheet){let Ve="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";bd(Se.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),bd(Se.sheet,`[data-input-otp]:autofill { ${Ve} }`),bd(Se.sheet,`[data-input-otp]:-webkit-autofill { ${Ve} }`),bd(Se.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),bd(Se.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{le&&le.style.setProperty("--root-height",`${re.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(re),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[D,L]=g.useState(!1),[R,F]=g.useState(!1),[V,$]=g.useState(null),[U,z]=g.useState(null);g.useEffect(()=>{Ppe(()=>{var re,le,je,Le;(re=k.current)==null||re.dispatchEvent(new Event("input"));let $e=(le=k.current)==null?void 0:le.selectionStart,Se=(je=k.current)==null?void 0:je.selectionEnd,Ve=(Le=k.current)==null?void 0:Le.selectionDirection;$e!==null&&Se!==null&&($($e),z(Se),T.current.prev=[$e,Se,Ve])})},[M,R]),g.useEffect(()=>{N!==void 0&&M!==N&&N.length<o&&M.length===o&&(u==null||u(M))},[o,u,N,M]);let K=Rpe({containerRef:C,inputRef:k,pushPasswordManagerStrategy:d,isFocused:R}),ne=g.useCallback(re=>{let le=re.currentTarget.value.slice(0,o);if(le.length>0&&I&&!I.test(le)){re.preventDefault();return}typeof N=="string"&&le.length<N.length&&document.dispatchEvent(new Event("selectionchange")),P(le)},[o,P,N,I]),Q=g.useCallback(()=>{var re;if(k.current){let le=Math.min(k.current.value.length,o-1),je=k.current.value.length;(re=k.current)==null||re.setSelectionRange(le,je),$(le),z(je)}F(!0)},[o]),Y=g.useCallback(re=>{var le,je;let Le=k.current;if(!f&&(!A.current.isIOS||!re.clipboardData||!Le))return;let $e=re.clipboardData.getData("text/plain"),Se=f?f($e):$e;re.preventDefault();let Ve=(le=k.current)==null?void 0:le.selectionStart,We=(je=k.current)==null?void 0:je.selectionEnd,He=(Ve!==We?M.slice(0,Ve)+Se+M.slice(We):M.slice(0,Ve)+Se+M.slice(Ve)).slice(0,o);if(He.length>0&&I&&!I.test(He))return;Le.value=He,P(He);let Mt=Math.min(He.length,o-1),st=He.length;Le.setSelectionRange(Mt,st),$(Mt),z(st)},[o,P,I,M]),q=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),X=g.useMemo(()=>({position:"absolute",inset:0,width:K.willPushPWMBadge?`calc(100% + ${K.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:K.willPushPWMBadge?`inset(0 ${K.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[K.PWM_BADGE_SPACE_WIDTH,K.willPushPWMBadge,i]),te=g.useMemo(()=>g.createElement("input",Npe(Cpe({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":M.length===0||void 0,"data-input-otp-mss":V,"data-input-otp-mse":U,inputMode:l,pattern:I==null?void 0:I.source,"aria-placeholder":c,style:X,maxLength:o,value:M,ref:k,onPaste:re=>{var le;Y(re),(le=b.onPaste)==null||le.call(b,re)},onChange:ne,onMouseOver:re=>{var le;L(!0),(le=b.onMouseOver)==null||le.call(b,re)},onMouseLeave:re=>{var le;L(!1),(le=b.onMouseLeave)==null||le.call(b,re)},onFocus:re=>{var le;Q(),(le=b.onFocus)==null||le.call(b,re)},onBlur:re=>{var le;F(!1),(le=b.onBlur)==null||le.call(b,re)}})),[ne,Q,Y,l,X,o,U,V,b,I==null?void 0:I.source,M]),B=g.useMemo(()=>({slots:Array.from({length:o}).map((re,le)=>{var je;let Le=R&&V!==null&&U!==null&&(V===U&&le===V||le>=V&&le<U),$e=M[le]!==void 0?M[le]:null,Se=M[0]!==void 0?null:(je=c==null?void 0:c[le])!=null?je:null;return{char:$e,placeholderChar:Se,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:R,isHovering:!b.disabled&&D}),[R,D,o,U,V,b.disabled,M]),ce=g.useMemo(()=>m?m(B):g.createElement(s8.Provider,{value:B},v),[v,B,m]);return g.createElement(g.Fragment,null,y!==null&&g.createElement("noscript",null,g.createElement("style",null,y)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:q,className:p},ce,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},te)))});c8.displayName="Input";function bd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Dpe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const dj=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(c8,{ref:r,containerClassName:G("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:G("disabled:cursor-not-allowed",e),...n}));dj.displayName="InputOTP";const wd=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex items-center",e),...t}));wd.displayName="InputOTPGroup";const fr=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(s8),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:G("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(wK,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});fr.displayName="InputOTPSlot";const fj=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(wK,{})}));fj.displayName="InputOTPSeparator";const Lpe=Ha(({onConfirm:e,onCancel:t})=>{const n=Yt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Qo,{open:n.visible,onOpenChange:c,children:h.jsxs(ro,{className:"w-[330px]",children:[h.jsx(ao,{children:h.jsx(oo,{children:r("create_session_passkey.title")})}),h.jsx("div",{className:"py-4",children:h.jsxs(dj,{onChange:i,maxLength:6,children:[h.jsxs(wd,{children:[h.jsx(fr,{index:0,hidden:!0}),h.jsx(fr,{index:1,hidden:!0}),h.jsx(fr,{index:2,hidden:!0})]}),h.jsx(fj,{}),h.jsxs(wd,{children:[h.jsx(fr,{index:3,hidden:!0}),h.jsx(fr,{index:4,hidden:!0}),h.jsx(fr,{index:5,hidden:!0})]})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),xd=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},l8=e=>new TextEncoder().encode(e).buffer,$pe=async e=>{const t=l8(e);return await crypto.subtle.digest("SHA-256",t)},pj=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Fpe=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return pj(e)},hj=async e=>{const t=await $pe(e);return pj(t)},u8=async e=>(await hj(e)).substring(0,32),d8=async(e,t)=>{const n=await hj(t),r=await u8(t),a=l8(e),o=await Bpe(a,n,r);return pj(o)},f8=async(e,t)=>{const n=await hj(t),r=await u8(t),a=xd(e),o=await zpe(a,n,r);return new TextDecoder().decode(o)},Bpe=async(e,t,n)=>{const r=xd(n),a=xd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},zpe=async(e,t,n)=>{const r=xd(n),a=xd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},Vpe=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},p8=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},Upe=e=>{const t={},n={string:fa.string,number:fa.number,boolean:fa.boolean,enum:()=>fa.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=fa.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=fa.array(fa.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=fa.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),fa.object(t)},Wpe=()=>{const e=Qe(n=>n.currentSession),t=Yt(Lpe);return{stream:g.useCallback(async(n,r)=>{var s,c;const{schemas:a,onMessageUpdate:o,onMessageFinish:i}=r||{};if(!(e!=null&&e.passphrase))throw new Error("Session is not found");switch(await gm.exists("passphrase")||await new Promise((l,u)=>{t.show({onConfirm:async d=>{try{const f=await f8(e.passphrase,d);await gm.set("passphrase",f),t.hide(),l()}catch(f){u(f)}},onCancel:()=>{u()}})}),r==null?void 0:r.provider){case nn.OpenAI:{const l=(s=r==null?void 0:r.llm)==null?void 0:s.parameters;if(!(l!=null&&l.key)||typeof l.key!="string")throw new Error("API Key is not found");const u=await gm.get("passphrase");if(!u)throw new Error("Passphrase is not found");const d=await f8(l.key,u);if(!d)throw new Error("API Key is not found");const f=new xpe({apiKey:d,model:(c=r==null?void 0:r.llm)==null?void 0:c.name});console.log("schemas",a);let p="",y;if(a!=null&&a.length){const m=a.filter(w=>{var _;return(_=w.schema_items)==null?void 0:_.length}).flatMap(w=>w.schema_items),v=Upe(m),b=await f.withStructuredOutput(v).stream(n);for await(const w of b)p=JSON.stringify(w),o==null||o({content:p})}else{const m=await f.stream(n);for await(const v of m)p+=`${v.content}`,y=v,o==null||o({content:p,chunk:v})}return i==null||i({content:p,lastChunk:y}),{lastChunk:y,content:p}}default:throw new Error("Provider is not supported")}},[e==null?void 0:e.passphrase,t])}},kc=()=>{const e=kM(),t=Wpe();return{stream:g.useCallback((n,r,a)=>{switch(n){case nn.WebLLM:return e.stream(r,a);case nn.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},Hpe=e=>{const[t]=g.useState(!1),n=Ss(i=>i.similaritySearchWithScore),{stream:r}=kc(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,f,p,y;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case Ts.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const m=(d=u.metadata)!=null&&d.k?+((f=u.metadata)==null?void 0:f.k):1;let v=(p=u.metadata)!=null&&p.minimalScore?+((y=u.metadata)==null?void 0:y.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,m);if(!b)return[];const w=new Ho({template:l.promptEntity.content,inputVariables:["context"]});c.push(new Uo(await w.format({context:v?b.filter(([,_])=>_>=v).map(([_])=>_.pageContent).join(`
`):b.map(([_])=>_.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:f})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==Xe.Loaded)throw new Error("LLM not found");const p=[];c!=null&&c.length&&(p.push(...await a(i,c)),f==null||f(p));const y=s.map(w=>w.role==="system"?new Mg(w.content):w.role==="user"?new Pr(w.content):new Uo(w.content));d==null||d();const{content:m}=await r(e.mainLLMInfo.llm.provider,y,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:m}}),m},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},qpe=Ha(({onDelete:e})=>{const{t}=Pe("dialogs"),[n,r]=g.useState(!1),a=Yt(),{toast:o}=tn(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(PA,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(V0,{children:[h.jsxs(U0,{children:[h.jsx(H0,{children:t("delete_chat_data_node.title")}),h.jsx(q0,{children:t("delete_chat_data_node.description")})]}),h.jsxs(W0,{children:[h.jsx(Y0,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(K0,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function bm(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const Kpe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),Ype=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Gpe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),Xpe=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),Zpe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Jpe="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Qpe="/NoLLMChat/assets/smollm-CikBjd4F.png",ehe="/NoLLMChat/assets/stablelm-BquePdQ7.png",the="/NoLLMChat/assets/nomic-BjJqoFji.webp",nhe="/NoLLMChat/assets/joshua-ByaReJuI.webp",rhe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),ahe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),ka=g.memo(({name:e,className:t,...n})=>{const r=Ml(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(rhe,{className:G("w-5 h-5",t),...n}):h.jsx(ahe,{className:G("w-5 h-5",t),...n}):e.includes("gemma")?h.jsx(Ype,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:G("w-5 h-5",t),src:Jpe,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(Gpe,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(Xpe,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:G("w-5 h-5",t),src:Qpe,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(Zpe,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(Kpe,{className:G("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:ehe,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:the,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:nhe,alt:"Xenova",...n}):h.jsx(de,{className:G("w-5 h-5",t),name:"brain"})}),mj=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC"],_d=g.memo(e=>{var c;const{name:t,model:n,isCached:r,isFunctionCalling:a}=e,{t:o}=Pe("atoms"),i=g.useCallback(l=>l===1?"llm_info.model_types.embedding":l===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),s=g.useMemo(()=>{if(n)switch(n.model_type){case 0:case 1:return h.jsx(un,{className:"",children:o(i(n.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(un,{className:"",children:o(i(0))}),h.jsx(un,{className:"",children:o(i(n.model_type))})]})}},[n,i,o]);if(n)return h.jsxs(h.Fragment,{children:[s,mj.some(l=>t&&l.includes(t))?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.recommended")}):null,r?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.cached")}):null,a?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.low_resource_required")}):null,(c=n==null?void 0:n.overrides)!=null&&c.context_window_size?h.jsxs(un,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?h.jsxs(un,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),Gt=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Gt.displayName="Card";const Ln=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex flex-col space-y-1.5 p-6",e),...t}));Ln.displayName="CardHeader";const Kn=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:G("text-2xl font-semibold leading-none tracking-tight",e),...t}));Kn.displayName="CardTitle";const h8=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:G("text-sm text-muted-foreground",e),...t}));h8.displayName="CardDescription";const $n=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("p-6 pt-0",e),...t}));$n.displayName="CardContent";const ci=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex items-center p-6 pt-0",e),...t}));ci.displayName="CardFooter";const ohe=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Pe("flows"),[o,i]=g.useState();g.useEffect(()=>{o||!(e!=null&&e.name)||At(()=>import("./index-CuU07XIu.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const f=await l(e==null?void 0:e.name);i({hasCache:f,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(p=>p.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case Xe.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Xe.Loaded:return h.jsx(ka,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(ka,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(Gt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(_d,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1}),t!==Xe.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(ut,{disabled:t===Xe.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),ihe=e=>{const[t,n]=g.useState([]),r=Qe(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await ue("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Vh({where:{session_id:r.id,id:Oa(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var f;const d=(f=c[u.source_type])==null?void 0:f.find(p=>p.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await ue("FlowNode").delete(i.id),await ue("JSONData").delete(i.source_id);const s=await ue("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>ue("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};class she{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class m8 extends she{constructor(t,{splitPages:n=!0,pdfjs:r=che,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new Lf({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new Lf({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function che(){try{const{default:e}=await At(async()=>{const{default:r}=await import("./pdf-CajhSkHa.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([6,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var yj="Tabs",[lhe,u2e]=er(yj,[Ka]),y8=Ka(),[uhe,gj]=lhe(yj),g8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=Wo(s),[d,f]=Sn({prop:r,onChange:a,defaultProp:o});return h.jsx(uhe,{scope:n,baseId:Pt(),value:d,onValueChange:f,orientation:i,dir:u,activationMode:c,children:h.jsx(Ae.div,{dir:u,"data-orientation":i,...l,ref:t})})});g8.displayName=yj;var v8="TabsList",b8=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=gj(v8,n),i=y8(n);return h.jsx(Fl,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});b8.displayName=v8;var w8="TabsTrigger",x8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=gj(w8,n),s=y8(n),c=S8(i.baseId,r),l=E8(i.baseId,r),u=r===i.value;return h.jsx(Bl,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});x8.displayName=w8;var _8="TabsContent",j8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=gj(_8,n),c=S8(s.baseId,r),l=E8(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Mr,{present:a||u,children:({present:f})=>h.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&o})})});j8.displayName=_8;function S8(e,t){return`${e}-trigger-${t}`}function E8(e,t){return`${e}-content-${t}`}var dhe=g8,O8=b8,C8=x8,N8=j8;const vj=dhe,wm=g.forwardRef(({className:e,...t},n)=>h.jsx(O8,{ref:n,className:G("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));wm.displayName=O8.displayName;const na=g.forwardRef(({className:e,...t},n)=>h.jsx(C8,{ref:n,className:G("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));na.displayName=C8.displayName;const ra=g.forwardRef(({className:e,...t},n)=>h.jsx(N8,{ref:n,className:G("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ra.displayName=N8.displayName,xv=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function M8(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var fhe=[" ","Enter","ArrowUp","ArrowDown"],phe=[" ","Enter"],jd="Select",[xm,_m,hhe]=Tf(jd),[Ac,d2e]=er(jd,[hhe,Us]),jm=Us(),[mhe,li]=Ac(jd),[yhe,ghe]=Ac(jd),P8=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:f,required:p,form:y}=e,m=jm(t),[v,b]=g.useState(null),[w,_]=g.useState(null),[x,j]=g.useState(!1),S=Wo(l),[E=!1,O]=Sn({prop:r,defaultProp:a,onChange:o}),[M,N]=Sn({prop:i,defaultProp:s,onChange:c}),P=g.useRef(null),I=v?y||!!v.closest("form"):!0,[k,C]=g.useState(new Set),A=Array.from(k).map(T=>T.props.value).join(";");return h.jsx(Ep,{...m,children:h.jsxs(mhe,{required:p,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:j,contentId:Pt(),value:M,onValueChange:N,open:E,onOpenChange:O,dir:S,triggerPointerDownPosRef:P,disabled:f,children:[h.jsx(xm.Provider,{scope:t,children:h.jsx(yhe,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(T=>{C(D=>new Set(D).add(T))},[]),onNativeOptionRemove:g.useCallback(T=>{C(D=>{const L=new Set(D);return L.delete(T),L})},[]),children:n})}),I?h.jsxs(t$,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:M,onChange:T=>N(T.target.value),disabled:f,form:y,children:[M===void 0?h.jsx("option",{value:""}):null,Array.from(k)]},A):null]})})};P8.displayName=jd;var k8="SelectTrigger",A8=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=jm(n),i=li(k8,n),s=i.disabled||r,c=wt(t,i.onTriggerChange),l=_m(n),u=g.useRef("touch"),[d,f,p]=n$(m=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),w=r$(v,m,b);w!==void 0&&i.onValueChange(w.value)}),y=m=>{s||(i.onOpenChange(!0),p()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return h.jsx(k0,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":e$(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:ge(a.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:ge(a.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&f(m.key),!(v&&m.key===" ")&&fhe.includes(m.key)&&(y(),m.preventDefault())})})})});A8.displayName=k8;var T8="SelectValue",I8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=li(T8,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=wt(t,c.onValueNodeChange);return en(()=>{l(u)},[l,u]),h.jsx(Ae.span,{...s,ref:d,style:{pointerEvents:"none"},children:e$(c.value)?h.jsx(h.Fragment,{children:i}):o})});I8.displayName=T8;var vhe="SelectIcon",R8=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});R8.displayName=vhe;var bhe="SelectPortal",D8=e=>h.jsx(Cg,{asChild:!0,...e});D8.displayName=bhe;var ts="SelectContent",L8=g.forwardRef((e,t)=>{const n=li(ts,e.__scopeSelect),[r,a]=g.useState();if(en(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Nl.createPortal(h.jsx($8,{scope:e.__scopeSelect,children:h.jsx(xm.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(F8,{...e,ref:t})});L8.displayName=ts;var aa=10,[$8,ui]=Ac(ts),whe="SelectContentImpl",F8=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v,...b}=e,w=li(ts,n),[_,x]=g.useState(null),[j,S]=g.useState(null),E=wt(t,Q=>x(Q)),[O,M]=g.useState(null),[N,P]=g.useState(null),I=_m(n),[k,C]=g.useState(!1),A=g.useRef(!1);g.useEffect(()=>{if(_)return Vl(_)},[_]),Ul();const T=g.useCallback(Q=>{const[Y,...q]=I().map(B=>B.ref.current),[X]=q.slice(-1),te=document.activeElement;for(const B of Q)if(B===te||(B==null||B.scrollIntoView({block:"nearest"}),B===Y&&j&&(j.scrollTop=0),B===X&&j&&(j.scrollTop=j.scrollHeight),B==null||B.focus(),document.activeElement!==te))return},[I,j]),D=g.useCallback(()=>T([O,_]),[T,O,_]);g.useEffect(()=>{k&&D()},[k,D]);const{onOpenChange:L,triggerPointerDownPosRef:R}=w;g.useEffect(()=>{if(_){let Q={x:0,y:0};const Y=X=>{var te,B;Q={x:Math.abs(Math.round(X.pageX)-(((te=R.current)==null?void 0:te.x)??0)),y:Math.abs(Math.round(X.pageY)-(((B=R.current)==null?void 0:B.y)??0))}},q=X=>{Q.x<=10&&Q.y<=10?X.preventDefault():_.contains(X.target)||L(!1),document.removeEventListener("pointermove",Y),R.current=null};return R.current!==null&&(document.addEventListener("pointermove",Y),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",q,{capture:!0})}}},[_,L,R]),g.useEffect(()=>{const Q=()=>L(!1);return window.addEventListener("blur",Q),window.addEventListener("resize",Q),()=>{window.removeEventListener("blur",Q),window.removeEventListener("resize",Q)}},[L]);const[F,V]=n$(Q=>{const Y=I().filter(te=>!te.disabled),q=Y.find(te=>te.ref.current===document.activeElement),X=r$(Y,Q,q);X&&setTimeout(()=>X.ref.current.focus())}),$=g.useCallback((Q,Y,q)=>{const X=!A.current&&!q;(w.value!==void 0&&w.value===Y||X)&&(M(Q),X&&(A.current=!0))},[w.value]),U=g.useCallback(()=>_==null?void 0:_.focus(),[_]),z=g.useCallback((Q,Y,q)=>{const X=!A.current&&!q;(w.value!==void 0&&w.value===Y||X)&&P(Q)},[w.value]),K=r==="popper"?bj:B8,ne=K===bj?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return h.jsx($8,{scope:n,content:_,viewport:j,onViewportChange:S,itemRefCallback:$,selectedItem:O,onItemLeave:U,itemTextRefCallback:z,focusSelectedItem:D,selectedItemText:N,position:r,isPositioned:k,searchRef:F,children:h.jsx(pp,{as:Vo,allowPinchZoom:!0,children:h.jsx(op,{asChild:!0,trapped:w.open,onMountAutoFocus:Q=>{Q.preventDefault()},onUnmountAutoFocus:ge(a,Q=>{var Y;(Y=w.trigger)==null||Y.focus({preventScroll:!0}),Q.preventDefault()}),children:h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:Q=>Q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(K,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Q=>Q.preventDefault(),...b,...ne,onPlaced:()=>C(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,Q=>{const Y=Q.ctrlKey||Q.altKey||Q.metaKey;if(Q.key==="Tab"&&Q.preventDefault(),!Y&&Q.key.length===1&&V(Q.key),["ArrowUp","ArrowDown","Home","End"].includes(Q.key)){let q=I().filter(X=>!X.disabled).map(X=>X.ref.current);if(["ArrowUp","End"].includes(Q.key)&&(q=q.slice().reverse()),["ArrowUp","ArrowDown"].includes(Q.key)){const X=Q.target,te=q.indexOf(X);q=q.slice(te+1)}setTimeout(()=>T(q)),Q.preventDefault()}})})})})})})});F8.displayName=whe;var xhe="SelectItemAlignedPosition",B8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=li(ts,n),i=ui(ts,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=wt(t,E=>u(E)),f=_m(n),p=g.useRef(!1),y=g.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,_=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&m&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),M=o.valueNode.getBoundingClientRect(),N=b.getBoundingClientRect();if(o.dir!=="rtl"){const X=N.left-O.left,te=M.left-X,B=E.left-te,ce=E.width+B,re=Math.max(ce,O.width),le=window.innerWidth-aa,je=xv(te,[aa,Math.max(aa,le-re)]);s.style.minWidth=ce+"px",s.style.left=je+"px"}else{const X=O.right-N.right,te=window.innerWidth-M.right-X,B=window.innerWidth-E.right-te,ce=E.width+B,re=Math.max(ce,O.width),le=window.innerWidth-aa,je=xv(te,[aa,Math.max(aa,le-re)]);s.style.minWidth=ce+"px",s.style.right=je+"px"}const P=f(),I=window.innerHeight-aa*2,k=m.scrollHeight,C=window.getComputedStyle(l),A=parseInt(C.borderTopWidth,10),T=parseInt(C.paddingTop,10),D=parseInt(C.borderBottomWidth,10),L=parseInt(C.paddingBottom,10),R=A+T+k+L+D,F=Math.min(v.offsetHeight*5,R),V=window.getComputedStyle(m),$=parseInt(V.paddingTop,10),U=parseInt(V.paddingBottom,10),z=E.top+E.height/2-aa,K=I-z,ne=v.offsetHeight/2,Q=v.offsetTop+ne,Y=A+T+Q,q=R-Y;if(Y<=z){const X=P.length>0&&v===P[P.length-1].ref.current;s.style.bottom="0px";const te=l.clientHeight-m.offsetTop-m.offsetHeight,B=Math.max(K,ne+(X?U:0)+te+D),ce=Y+B;s.style.height=ce+"px"}else{const X=P.length>0&&v===P[0].ref.current;s.style.top="0px";const te=Math.max(z,A+m.offsetTop+(X?$:0)+ne)+q;s.style.height=te+"px",m.scrollTop=Y-z+m.offsetTop}s.style.margin=`${aa}px 0`,s.style.minHeight=F+"px",s.style.maxHeight=I+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,o.trigger,o.valueNode,s,l,m,v,b,o.dir,r]);en(()=>_(),[_]);const[x,j]=g.useState();en(()=>{l&&j(window.getComputedStyle(l).zIndex)},[l]);const S=g.useCallback(E=>{E&&y.current===!0&&(_(),w==null||w(),y.current=!1)},[_,w]);return h.jsx(jhe,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:p,onScrollButtonChange:S,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});B8.displayName=xhe;var _he="SelectPopperPosition",bj=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=aa,...o}=e,i=jm(n);return h.jsx(A0,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});bj.displayName=_he;var[jhe,wj]=Ac(ts,{}),xj="SelectViewport",z8=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=ui(xj,n),i=wj(xj,n),s=wt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(xm.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&d){const p=Math.abs(c.current-u.scrollTop);if(p>0){const y=window.innerHeight-aa*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(m,v);if(b<y){const w=b+p,_=Math.min(y,w),x=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});z8.displayName=xj;var V8="SelectGroup",[She,Ehe]=Ac(V8),Ohe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Pt();return h.jsx(She,{scope:n,id:a,children:h.jsx(Ae.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Ohe.displayName=V8;var U8="SelectLabel",W8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ehe(U8,n);return h.jsx(Ae.div,{id:a.id,...r,ref:t})});W8.displayName=U8;var Sm="SelectItem",[Che,H8]=Ac(Sm),q8=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=li(Sm,n),c=ui(Sm,n),l=s.value===r,[u,d]=g.useState(o??""),[f,p]=g.useState(!1),y=wt(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,r,a)}),m=Pt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Che,{scope:n,value:r,disabled:a,textId:m,isSelected:l,onItemTextChange:g.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(xm.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Ae.div,{role:"option","aria-labelledby":m,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:y,onFocus:ge(i.onFocus,()=>p(!0)),onBlur:ge(i.onBlur,()=>p(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var _;v.current=w.pointerType,a?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(phe.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});q8.displayName=Sm;var Sd="SelectItemText",K8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=li(Sd,n),s=ui(Sd,n),c=H8(Sd,n),l=ghe(Sd,n),[u,d]=g.useState(null),f=wt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),p=u==null?void 0:u.textContent,y=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=l;return en(()=>(m(y),()=>v(y)),[m,v,y]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Nl.createPortal(o.children,i.valueNode):null]})});K8.displayName=Sd;var Y8="SelectItemIndicator",G8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return H8(Y8,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:t}):null});G8.displayName=Y8;var _j="SelectScrollUpButton",X8=g.forwardRef((e,t)=>{const n=ui(_j,e.__scopeSelect),r=wj(_j,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return en(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});X8.displayName=_j;var jj="SelectScrollDownButton",Z8=g.forwardRef((e,t)=>{const n=ui(jj,e.__scopeSelect),r=wj(jj,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return en(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});Z8.displayName=jj;var J8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=ui("SelectScrollButton",n),i=g.useRef(null),s=_m(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),en(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),Nhe="SelectSeparator",Q8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:t})});Q8.displayName=Nhe;var Sj="SelectArrow",Mhe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=jm(n),o=li(Sj,n),i=ui(Sj,n);return o.open&&i.position==="popper"?h.jsx(T0,{...a,...r,ref:t}):null});Mhe.displayName=Sj;function e$(e){return e===""||e===void 0}var t$=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=wt(t,a),i=M8(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(FAe,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});t$.displayName="BubbleSelect";function n$(e){const t=tr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function r$(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=Phe(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function Phe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var khe=P8,a$=A8,Ahe=I8,The=R8,Ihe=D8,o$=L8,Rhe=z8,i$=W8,s$=q8,Dhe=K8,Lhe=G8,c$=X8,l$=Z8,u$=Q8;const jo=khe,So=Ahe,Aa=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(a$,{ref:r,className:G("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(The,{asChild:!0,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Aa.displayName=a$.displayName;const d$=g.forwardRef(({className:e,...t},n)=>h.jsx(c$,{ref:n,className:G("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-up",className:"h-4 w-4"})}));d$.displayName=c$.displayName;const f$=g.forwardRef(({className:e,...t},n)=>h.jsx(l$,{ref:n,className:G("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4"})}));f$.displayName=l$.displayName;const Ta=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(Ihe,{children:h.jsxs(o$,{ref:a,className:G("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(d$,{}),h.jsx(Rhe,{className:G("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(f$,{})]})}));Ta.displayName=o$.displayName;const $he=g.forwardRef(({className:e,...t},n)=>h.jsx(i$,{ref:n,className:G("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));$he.displayName=i$.displayName;const Yn=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(s$,{ref:r,className:G("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Lhe,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),h.jsx(Dhe,{children:t})]}));Yn.displayName=s$.displayName;const Fhe=g.forwardRef(({className:e,...t},n)=>h.jsx(u$,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));Fhe.displayName=u$.displayName;var Eo="Accordion",Bhe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ej,zhe,Vhe]=Tf(Eo),[Em,f2e]=er(Eo,[Vhe,jP]),Oj=jP(),p$=H.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(Ej.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(qhe,{...o,ref:t}):h.jsx(Hhe,{...a,ref:t})})});p$.displayName=Eo;var[h$,Uhe]=Em(Eo),[m$,Whe]=Em(Eo,{collapsible:!1}),Hhe=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(h$,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:H.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(m$,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(y$,{...i,ref:t})})})}),qhe=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=H.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=H.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(h$,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(m$,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(y$,{...o,ref:t})})})}),[Khe,Om]=Em(Eo),y$=H.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=H.useRef(null),c=wt(s,t),l=zhe(n),u=Wo(a)==="ltr",d=ge(e.onKeyDown,f=>{var E;if(!Bhe.includes(f.key))return;const p=f.target,y=l().filter(O=>{var M;return!((M=O.ref.current)!=null&&M.disabled)}),m=y.findIndex(O=>O.ref.current===p),v=y.length;if(m===-1)return;f.preventDefault();let b=m;const w=0,_=v-1,x=()=>{b=m+1,b>_&&(b=w)},j=()=>{b=m-1,b<w&&(b=_)};switch(f.key){case"Home":b=w;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?x():j());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?j():x());break;case"ArrowUp":o==="vertical"&&j();break}const S=b%v;(E=y[S].ref.current)==null||E.focus()});return h.jsx(Khe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(Ej.Slot,{scope:n,children:h.jsx(Ae.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Cm="AccordionItem",[Yhe,Cj]=Em(Cm),g$=H.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Om(Cm,n),i=Uhe(Cm,n),s=Oj(n),c=Pt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Yhe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(OP,{"data-orientation":o.orientation,"data-state":j$(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});g$.displayName=Cm;var v$="AccordionHeader",b$=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(Eo,n),o=Cj(v$,n);return h.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":j$(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});b$.displayName=v$;var Nj="AccordionTrigger",w$=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(Eo,n),o=Cj(Nj,n),i=Whe(Nj,n),s=Oj(n);return h.jsx(Ej.ItemSlot,{scope:n,children:h.jsx(HG,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});w$.displayName=Nj;var x$="AccordionContent",_$=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(Eo,n),o=Cj(x$,n),i=Oj(n);return h.jsx(qG,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});_$.displayName=x$;function j$(e){return e?"open":"closed"}let S$;uM=p$,dM=g$,S$=b$,_v=w$,jv=_$;const E$=uM,Mj=g.forwardRef(({className:e,...t},n)=>h.jsx(dM,{ref:n,className:G("border-b",e),...t}));Mj.displayName="AccordionItem";const Pj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(S$,{className:"flex",children:h.jsxs(_v,{ref:r,className:G("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(de,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Pj.displayName=_v.displayName;const kj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(jv,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:G("pb-4 pt-0",e),children:t})}));kj.displayName=jv.displayName;const Ghe=[1,2,3,4,5,6,7,8,9,10],O$=g.memo(e=>{const{t}=Pe("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,f=async()=>{o(await l(n,+i)),r("")},p=async y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),f())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(jo,{value:`${i}`,onValueChange:y=>s(y),children:[h.jsx(Aa,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(So,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(Ta,{children:Ghe.map(y=>h.jsx(Yn,{value:`${y}`,children:y},`${y}`))})]}),h.jsx(fo,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:G("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:p,onChange:y=>{r(y.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:f,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(de,{name:c?"loader-circle":"arrow-right",className:G("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(E$,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([y,m],v)=>h.jsxs(Mj,{value:`${v}`,children:[h.jsxs(Pj,{children:[`[${m.toFixed(2)}] ${y.pageContent}`.substring(0,32),"..."]}),h.jsx(kj,{children:y.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(ut,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(ut,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),C$=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Pe("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(En,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(nt,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(fo,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Vn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),Aj=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:G("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Xhe({accept:e,maxSize:t}){const{t:n}=Pe("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=f=>{var y;const p=(y=f.target.files)==null?void 0:y[0];d(p)},d=f=>{if(i(""),f){if(t&&f.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(f.size/1024/1024).toFixed(2)}));return}const p=e==null?void 0:e.split(",").map(y=>y.replace(".","").trim());if(e&&!f.type.match(e.replace("/*",""))&&!(p!=null&&p.some(y=>f.type.includes(y)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(f.size),a(f.name),f}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Zhe({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=tn(),{t:i}=Pe("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:f,validateAndSetFile:p,fileSize:y}=Xhe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{f&&o({title:f,variant:"destructive"})},[f,o]);function m(x){const j=p(x);j&&t(j)}function v(x){x.preventDefault(),c(!1);const j=x.dataTransfer.files[0];j&&m(j)}function b(x){var S;const j=(S=x.target.files)==null?void 0:S[0];j&&m(j)}function w(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(de,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(de,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:G("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var j;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(j=u.current)==null||j.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[_,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:y?`(${(y/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(de,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(Aj,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(de,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function N$({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Pe("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(Zhe,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(Vn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const Nm=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:G("w-full caption-bottom text-sm",e),...t})}));Nm.displayName="Table";const Mm=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:G("[&_tr]:border-b",e),...t}));Mm.displayName="TableHeader";const Pm=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:G("[&_tr:last-child]:border-0",e),...t}));Pm.displayName="TableBody";const Jhe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:G("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Jhe.displayName="TableFooter";const ns=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:G("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ns.displayName="TableRow";const Tc=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:G("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Tc.displayName="TableHead";const Ic=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:G("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ic.displayName="TableCell";const Qhe=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:G("mt-4 text-sm text-muted-foreground",e),...t}));Qhe.displayName="TableCaption";const M$=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:G("mx-auto flex w-full justify-center",e),...t});M$.displayName="Pagination";const P$=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:G("flex flex-row items-center gap-1",e),...t}));P$.displayName="PaginationContent";const Rc=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:G("",e),...t}));Rc.displayName="PaginationItem";const km=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:G(eu({variant:t?"outline":"ghost",size:n}),e),...r});km.displayName="PaginationLink";const k$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(km,{"aria-label":"Go to previous page",size:"default",className:G("gap-1 pl-2.5",e),...t,children:[h.jsx(de,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};k$.displayName="PaginationPrevious";const A$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(km,{"aria-label":"Go to next page",size:"default",className:G("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(de,{name:"chevron-right",className:"h-4 w-4"})]})};A$.displayName="PaginationNext";const Tj=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs("span",{"aria-hidden":!0,className:G("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(de,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};Tj.displayName="PaginationEllipsis";const T$=Ha(({title:e,content:t})=>{const n=Yt();return h.jsx(Qo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(ro,{className:"sm:max-w-2xl",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),Am=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=Yt(T$);g.useEffect(()=>{c(p=>({...p,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let p=!1,y=!1;return h.jsx(M$,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(P$,{children:[s.page>1?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page-1})),children:h.jsx(k$,{})}):null,Array.from({length:s.maxPage},(m,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&y?null:!w&&b>s.page+o?(y=!0,h.jsx(Rc,{children:h.jsx(Tj,{})},v)):!w&&b<s.page-o&&p?null:!w&&b<s.page-o?(p=!0,h.jsx(Rc,{children:h.jsx(Tj,{})},v)):h.jsx(Rc,{onClick:()=>c(_=>({..._,page:b})),children:h.jsx(km,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page+1})),children:h.jsx(A$,{})}):null]})})},[s.maxPage,s.page,o]),f=(p,y)=>{if(!p)return;const m=Array.isArray(p)?p:n.map(v=>p[v]);return h.jsxs(ns,{children:[h.jsx(Ic,{children:h.jsx("div",{className:"font-bold",children:y+1})}),m.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),_=n[b],x=(r==null?void 0:r[_])||i,j=w.length>x;return h.jsx(Ic,{className:"p-4",children:h.jsxs("div",{onClick:j?()=>l.show({title:_,content:w}):void 0,className:"flex gap-4",children:[j?`${w.substring(0,x)}...`:w,j?h.jsx(de,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${y}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsxs(ns,{children:[h.jsx(Tc,{},"index"),n?n.map(p=>h.jsx(Tc,{children:h.jsx("div",{className:"font-bold",children:p})},p)):void 0]})}),h.jsx(Pm,{children:u!=null&&u.length?u==null?void 0:u.map(f):void 0})]}),d]})});var Ij,I$;Av=function(){if(I$)return Ij;I$=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return Ij=e,Ij};var Rj,R$;Es=function(){if(R$)return Rj;R$=1;var e=Il(),t=Ni(),n=Jp(),r=Tr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return Rj=a,Rj};var Dj,D$;function eme(){if(D$)return Dj;D$=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Dj=t,Dj}var Lj,L$;function tme(){if(L$)return Lj;L$=1;var e=eme(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return Lj=n,Lj}var $j,$$;function F$(){if($$)return $j;$$=1;var e=tme(),t=Tr(),n=Js(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return $j=c,$j}var Fj,B$;function z$(){if(B$)return Fj;B$=1;var e=F$(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return Fj=r,Fj}var Bj,V$;function U$(){if(V$)return Bj;V$=1;var e=z$();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return Bj=t,Bj}var zj,W$;function nme(){if(W$)return zj;W$=1;var e=Av(),t=Es(),n=U$(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,f=Array(r(l/s));u<l;)f[d++]=e(i,u,u+=s);return f}return zj=o,zj}var rme=nme();const Vj=ot(rme),ame=()=>{const[e,t]=g.useState(!1),{t:n}=Pe("flows"),{toast:r}=tn(),a=Ss(c=>c.index),o=Ss(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new Lf({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=Vj(d,10);let p=0;for(const y of f)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:y.length,handled:p,total:d.length}),await a({databaseId:l.vectorDatabase.id},y),p+=y.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},ome=Ha(({retriverInfo:e})=>{var m,v,b;const{t}=Pe("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=ame(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=Yt(),u=g.useMemo(()=>{var x,j;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],_=Pg((j=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:j.raw);return{headers:w,rows:_.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(m=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:m.raw]),d=g.useCallback(async(...w)=>{const[_,x]=w;await a(_,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),f=g.useCallback(async(w,_)=>{const x=w.trim(),j=await r(x,{k:_,vectorDatabase:e.vectorDatabaseEntity});if(j!=null&&j.length)return j},[e.vectorDatabaseEntity,r]),p=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const _=new FileReader;_.onload=async x=>{var S;const j=(S=x.target)==null?void 0:S.result;await d({content:j},{vectorDatabase:e.vectorDatabaseEntity})},_.readAsText(w)}else if(w.type.endsWith("pdf")){const _=new Blob([w],{type:"application/pdf"}),x=await new m8(_,{pdfjs:async()=>{const j=await At(()=>import("./pdf.min-DX3AyXIJ.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-DhAvbXYU.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([8,1,2,3,4])),j.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),j},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:j=>{c((j.handled+j.handling)/j.total)}})}},[d,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(o){case"search":return h.jsx(ra,{value:"search",children:h.jsx(O$,{loading:n,onSimilaritySearch:f})});case"new":return h.jsx(ra,{className:"min-w-80",value:"new",children:h.jsx(C$,{loading:n,onCreateData:d})});case"file":return h.jsx(ra,{value:"file",children:h.jsx(N$,{loading:n,progress:s,onFileSubmit:p,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(ra,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(Am,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,p,f,n,o,s,u]);return h.jsx(Qo,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(ro,{className:"max-w-3xl",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(vj,{value:o,onValueChange:i,defaultValue:"search",className:G("w-full h-full mt-4"),children:[h.jsxs(wm,{className:G("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(na,{value:"search",children:t("chat.search")}),h.jsx(na,{value:"new",children:t("chat.text")}),h.jsx(na,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===kr.DatabaseNode?h.jsx(na,{value:"view",children:t("chat.view")}):void 0]}),y]})})})]})})}),ime=g.lazy(()=>At(()=>import("./index-C1fFSMf1.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function sme({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,...c}){var x,j;const{t:l}=Pe("applications"),[u,d]=g.useState(!1),f=Yt(qpe),p=Yt(ome),{chatList:y,getChatList:m,deleteChat:v}=ihe(a),b=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),m()}finally{d(!1)}},[m,i]),w=g.useCallback(()=>{p.show({retriverInfo:r[0]})},[r,p]),_=g.useCallback(async(S,E)=>{S.stopPropagation(),f.show({onDelete:()=>v(E)})},[v,f]);return h.jsxs(F0,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[h.jsx("div",{className:"h-1"}),h.jsxs(uu,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),h.jsx(Vn,{loading:u,onClick:b,variant:"link",className:"mr-[-6px]",children:h.jsx(de,{name:"circle-plus"})})]}),h.jsxs(z0,{children:[h.jsx(lu,{className:"flex-1",children:h.jsx(Hs,{children:y.map(({node:S},E)=>{var O;return h.jsx(to,{onClick:()=>o(S),children:h.jsx(no,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(de,{size:16,name:((O=s==null?void 0:s.node)==null?void 0:O.id)===S.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${E+1}`})]}),h.jsx(de,{onClick:M=>_(M,S),size:16,name:"trash-2"})]})})},S.id)})})}),r!=null&&r.length?h.jsxs(Gt,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((S,E)=>{var O;return h.jsx("span",{children:((O=S.promptEntity)==null?void 0:O.content)||""},`${E}`)})}),h.jsx(ut,{onClick:w,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(x=e==null?void 0:e.schema_items)!=null&&x.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(bm,{}),children:h.jsx(ime,{className:G("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(j=e==null?void 0:e.schema_items)!=null&&j.length?`\`\`\`javascript
${p8((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})})}):void 0,h.jsx(ohe,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var cme=Object.defineProperty,lme=Object.defineProperties,ume=Object.getOwnPropertyDescriptors,Tm=Object.getOwnPropertySymbols,H$=Object.prototype.hasOwnProperty,q$=Object.prototype.propertyIsEnumerable,K$=(e,t,n)=>t in e?cme(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Im=(e,t)=>{for(var n in t||(t={}))H$.call(t,n)&&K$(e,n,t[n]);if(Tm)for(var n of Tm(t))q$.call(t,n)&&K$(e,n,t[n]);return e},dme=(e,t)=>lme(e,ume(t)),fme=(e,t)=>{var n={};for(var r in e)H$.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Tm)for(var r of Tm(e))t.indexOf(r)<0&&q$.call(e,r)&&(n[r]=e[r]);return n};Rl=function(...e){return BAe(zAe(e))},QN=function(e,t){const n=e;return H.forwardRef(function(r,a){return H.createElement(n,dme(Im(Im({ref:a},t),r),{className:Rl(t.className,r.className)}))})},xK=function(e,...t){return QN(e,{className:Rl(t)})},_K=function(e,t,n){const r=e;return H.forwardRef(function(a,o){const i=a,{className:s}=i,c=fme(i,["className"]),l=Im({},c);return n&&n.forEach(u=>{c[u]!==void 0&&delete l[u]}),H.createElement(r,Im({ref:o,className:Rl(t(c),s)},l))})};var Uj="Avatar",[pme,p2e]=er(Uj),[hme,Y$]=pme(Uj),G$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(hme,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Ae.span,{...r,ref:t})})});G$.displayName=Uj;var X$="AvatarImage",Z$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=Y$(X$,n),s=mme(r,o.referrerPolicy),c=tr(l=>{a(l),i.onImageLoadingStatusChange(l)});return en(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Ae.img,{...o,ref:t,src:r}):null});Z$.displayName=X$;var J$="AvatarFallback",Q$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=Y$(J$,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Ae.span,{...a,ref:t}):null});Q$.displayName=J$;function mme(e,t){const[n,r]=g.useState("idle");return en(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var eF=G$,tF=Z$,nF=Q$;const rF=g.forwardRef(({className:e,...t},n)=>h.jsx(eF,{ref:n,className:G("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));rF.displayName=eF.displayName;const aF=g.forwardRef(({className:e,...t},n)=>h.jsx(tF,{ref:n,className:G("aspect-square h-full w-full",e),...t}));aF.displayName=tF.displayName;const oF=g.forwardRef(({className:e,...t},n)=>h.jsx(nF,{ref:n,className:G("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));oF.displayName=nF.displayName;const yme=Wa("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),iF=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:G(yme({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));iF.displayName="ChatBubble";const gme=({src:e,fallback:t,className:n})=>h.jsxs(rF,{className:n,children:[h.jsx(aF,{src:e,alt:"Avatar"}),h.jsx(oF,{children:t})]}),vme=Wa("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"bg-primary text-primary-foreground rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),sF=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:G(vme({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(bm,{})}):a}));sF.displayName="ChatBubbleMessage";const bme=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(ut,{variant:r,size:a,className:n,onClick:t,...o,children:e}),wme=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:G("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));wme.displayName="ChatBubbleActionWrapper";const xme=g.lazy(()=>At(()=>import("./index-C1fFSMf1.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12]))),_me=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],jme=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>h.jsxs(iF,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(gme,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(sF,{children:[r&&n&&(!e.content||a)?h.jsx(bm,{}):h.jsxs(g.Suspense,{fallback:h.jsx(bm,{}),children:[e.role==="system"?h.jsx(un,{className:"!text-sm mb-1",children:"System"}):void 0,h.jsx(xme,{className:Rl("[&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans !text-sm"),style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""})]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:_me.map((i,s)=>h.jsx(bme,{variant:"ghost",className:"size-5",icon:h.jsx(de,{name:i.icon,className:"size-3"}),onClick:()=>o(i.label,e)},s))})})]})]},t),()=>!1),Sme=g.memo(()=>{const{t:e}=Pe("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},50)},[]),o=eue(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,addNewDataNode:f,selectDataNode:p,updateMessagesData:y,onThreadMessagesLoaded:m}=o,{sendMessage:v}=Hpe(o),{input:b,messages:w,isLoading:_,reload:x,setInput:j,handleSubmit:S,handleInputChange:E,setMessages:O}=qN({fetch:async(C,A)=>{try{r(!0);const T=JSON.parse(A==null?void 0:A.body),D=Oi(),L=T.messages[T.messages.length-1];return t.current=!0,O(R=>[...R,{id:Oi(),content:L.content,role:"user"}]),await v(L.content,T.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:R=>{R.length&&O(F=>[...F,...R.map(V=>V._getType()==="system"?{id:Oi(),content:`${V.content}`,role:"system",data:{injectedMessage:!0}}:V._getType()==="human"?{id:Oi(),content:`${V.content}`,role:"user",data:{injectedMessage:!0}}:{id:Oi(),content:`${V.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:R=>{O(F=>[...F,{id:D,content:R||"",role:"assistant"}])},onMessageUpdate:R=>{O(F=>{const V=[...F],$=V.findIndex(U=>U.id===D);return $!==-1&&(V[$]={...V[$],content:R.nodeData.content||""}),V}),t.current&&a()}}),O(R=>(y(R),R)),r(!1),j(""),t.current&&a(),new Response}finally{r(!1)}}}),M=g.useRef(null);g.useEffect(()=>{const C=m(A=>{O(A||[]),a()});return()=>{C()}},[O,m,a]);const N=async(C,A)=>(r(!0),await S(A),!0),P=g.useCallback(async(C,A)=>{if(C==="Refresh"){r(!0);try{await x()}finally{r(!1)}}C==="Copy"&&A&&A.role==="assistant"&&navigator.clipboard.writeText(A.content),C==="Volume"&&(A!=null&&A.content)&&await SN.speak((A==null?void 0:A.content)||"")},[x]),I=g.useCallback(()=>t.current=!1,[]),k=g.useMemo(()=>w&&w.map((C,A)=>h.jsx(jme,{message:C,index:A,isLastMessage:A===w.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},C.id||`${A}`)),[w,n,i,P]);return h.jsxs($0,{onClick:I,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(B0,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(X2,{className:"!max-h-full",ref:M,children:k})}),h.jsx(bv,{className:"!max-w-2xl px-4",onSubmit:N,disabled:_||n||(c==null?void 0:c.status)!==Xe.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:b,onChange:E})]})}),h.jsx(sme,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:f,onSelectThread:p})]})}),Eme=()=>{const[e,t]=g.useState(),n=Qe(l=>l.currentSession),{t:r}=Pe("flows"),{toast:a}=tn(),{stream:o}=kc(),{loadModel:i}=Uh(),s=g.useCallback(async(l,u)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==Xe.Loaded&&(await i(e.llm.provider,e.llm.name,d=>{t(f=>f&&{...f,progress:d.text})}),t(d=>d&&{...d,status:Xe.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof l=="string"?[new Pr(l)]:l,{onMessageUpdate:d=>{u==null||u(d.content)},llm:e==null?void 0:e.llm})).content}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),c=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const l=await ue("FlowEdge").find({where:{target:n.main_node_id}}),u=(await ue("FlowNode").find({where:{id:Oa(l.map(f=>f.source))}})).find(f=>f.source_type===oe.LLM);if(!u)return;const d=await ue("LLM").findOne({where:{id:u.source_id}});d&&(await i(d.provider,d.name,f=>{t(p=>p&&{...p,llm:d,progress:f.text})}),t({llm:d,status:Xe.Loaded}))},[n==null?void 0:n.main_node_id,i]);return g.useEffect(()=>{n!=null&&n.main_node_id&&c()},[n==null?void 0:n.main_node_id,c]),{mainLLMInfo:e,createMessage:s}},Ome=()=>{const e=Qe(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await ue("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&ue("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},Cme=g.lazy(()=>At(()=>import("./index-yEY5AE0y.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Nme=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=Ome(),{mainLLMInfo:n,createMessage:r}=Eme(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(su,{children:h.jsx(va,{children:h.jsxs("div",{className:G("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===Xe.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(ka,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(ba,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===Xe.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Fr,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful !rounded-none flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:e?h.jsx(Cme,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx("div",{className:"h-full w-full !rounded-none flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})})})]})}),Mme=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=Qe(f=>f.currentSession),{t:o}=Pe("flows"),{toast:i}=tn(),{loadModel:s}=Uh(),{stream:c}=kc(),l=g.useCallback(async(f,p,y)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==Xe.Loaded&&(await s(n.llm.provider,n.llm.name,m=>{r(v=>v&&{...v,progress:m.text})}),r(m=>m&&{...m,status:Xe.Loaded,progress:""}));try{const m=p.map(b=>b.role==="system"?new Mg(b.content):b.role==="assistant"?new Uo(b.content):new Pr(b.content)),v=await c(n.llm.provider,[...m,new Pr(f)],{onMessageUpdate:b=>{y==null||y(b.content)},llm:n.llm});return y==null||y(""),v.content}catch(m){if(m instanceof Error&&m.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),u=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const f=await ue("FlowEdge").find({where:{target:a.main_node_id}}),p=(await ue("FlowNode").find({where:{id:Oa(f.map(m=>m.source))}})).find(m=>m.source_type===oe.LLM);if(!p)return;const y=await ue("LLM").findOne({where:{id:p.source_id}});if(!y)return;await s(y.provider,y.name,m=>{r(v=>v&&{...v,llm:y,progress:m.text})}),r({llm:y,status:Xe.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,s]),d=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,f=>{r(p=>p&&{...p,progress:f.text})}),r(f=>f&&{...f,status:Xe.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&u()},[a==null?void 0:a.main_node_id,u]),{loading:e,mainLLMInfo:n,createMessage:l,loadCurrentModel:d}};fM=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Oi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=fM(a.directory,i)),n.push(c)}return n},Sv=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},wv=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},Ev=function(e,t){return gK(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const Pme=()=>{const e=Qe(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await ue("FlowNode").update(i,{raw:wv(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=Ev(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await ue("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?Sv(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},kme=g.lazy(()=>At(()=>import("./index-DUi7_GYs.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Ame=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=Mme(),{fileSystemTree:a,updateCodeContainerFile:o}=Pme(),i=g.useCallback((d,f,p)=>r(d,f,p),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(su,{children:h.jsx(va,{children:h.jsxs("div",{className:G("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===Xe.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(ka,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(ba,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===Xe.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==Xe.Loaded?h.jsx(de,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Fr,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:a!==void 0?h.jsx(kme,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function Tme(){var t,n;const e=Qe(r=>r.currentSession);if(!e)return h.jsx(EN,{flickeringGrid:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(Sme,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(Nme,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(Ame,{})}var Rm="Menubar",[Wj,Ime,Rme]=Tf(Rm),[cF,h2e]=er(Rm,[Rme,Ka]),Fn=Ip(),lF=Ka(),[Dme,Hj]=cF(Rm),uF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=Wo(s),u=lF(n),[d="",f]=Sn({prop:r,onChange:a,defaultProp:o}),[p,y]=g.useState(null);return h.jsx(Dme,{scope:n,value:d,onMenuOpen:g.useCallback(m=>{f(m),y(m)},[f]),onMenuClose:g.useCallback(()=>f(""),[f]),onMenuToggle:g.useCallback(m=>{f(v=>v?"":m),y(m)},[f]),dir:l,loop:i,children:h.jsx(Wj.Provider,{scope:n,children:h.jsx(Wj.Slot,{scope:n,children:h.jsx(Fl,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:p,onCurrentTabStopIdChange:y,children:h.jsx(Ae.div,{role:"menubar",...c,ref:t})})})})})});uF.displayName=Rm;var qj="MenubarMenu",[Lme,dF]=cF(qj),fF=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Pt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=Hj(qj,t),s=Fn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(Lme,{scope:t,value:o,triggerId:Pt(),triggerRef:c,contentId:Pt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(m2,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};fF.displayName=qj;var Kj="MenubarTrigger",pF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=lF(n),i=Fn(n),s=Hj(Kj,n),c=dF(Kj,n),l=g.useRef(null),u=wt(t,l,c.triggerRef),[d,f]=g.useState(!1),p=s.value===c.value;return h.jsx(Wj.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(Bl,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(y2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":p,"aria-controls":p?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":p?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,y=>{!r&&y.button===0&&y.ctrlKey===!1&&(s.onMenuOpen(c.value),p||y.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var y;s.value&&!p&&(s.onMenuOpen(c.value),(y=l.current)==null||y.focus())}),onKeyDown:ge(e.onKeyDown,y=>{r||(["Enter"," "].includes(y.key)&&s.onMenuToggle(c.value),y.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(y.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,y.preventDefault()))}),onFocus:ge(e.onFocus,()=>f(!0)),onBlur:ge(e.onBlur,()=>f(!1))})})})})});pF.displayName=Kj;var $me="MenubarPortal",hF=e=>{const{__scopeMenubar:t,...n}=e,r=Fn(t);return h.jsx(g2,{...r,...n})};hF.displayName=$me;var Yj="MenubarContent",mF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Fn(n),i=Hj(Yj,n),s=dF(Yj,n),c=Ime(n),l=g.useRef(!1);return h.jsx(v2,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(f=>{var p;return(p=f.ref.current)==null?void 0:p.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,f=d.hasAttribute("data-radix-menubar-subtrigger"),p=d.closest("[data-radix-menubar-content]")!==u.currentTarget,y=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!y&&f||p&&y)return;let m=c().filter(w=>!w.disabled).map(w=>w.value);y&&m.reverse();const v=m.indexOf(s.value);m=i.loop?Qme(m,v+1):m.slice(v+1);const[b]=m;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});mF.displayName=Yj;var Fme="MenubarGroup",Bme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(b2,{...a,...r,ref:t})});Bme.displayName=Fme;var zme="MenubarLabel",yF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(w2,{...a,...r,ref:t})});yF.displayName=zme;var Vme="MenubarItem",gF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(x2,{...a,...r,ref:t})});gF.displayName=Vme;var Ume="MenubarCheckboxItem",vF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(_2,{...a,...r,ref:t})});vF.displayName=Ume;var Wme="MenubarRadioGroup",Hme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(j2,{...a,...r,ref:t})});Hme.displayName=Wme;var qme="MenubarRadioItem",bF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(S2,{...a,...r,ref:t})});bF.displayName=qme;var Kme="MenubarItemIndicator",wF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(E2,{...a,...r,ref:t})});wF.displayName=Kme;var Yme="MenubarSeparator",xF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(O2,{...a,...r,ref:t})});xF.displayName=Yme;var Gme="MenubarArrow",Xme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(C2,{...a,...r,ref:t})});Xme.displayName=Gme;var Zme="MenubarSubTrigger",_F=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(N2,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});_F.displayName=Zme;var Jme="MenubarSubContent",jF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(M2,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});jF.displayName=Jme;function Qme(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var SF=uF,eye=fF,EF=pF,tye=hF,OF=mF,CF=yF,NF=gF,MF=vF,PF=bF,kF=wF,AF=xF,TF=_F,IF=jF;const Gj=eye,RF=g.forwardRef(({className:e,...t},n)=>h.jsx(SF,{ref:n,className:G("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));RF.displayName=SF.displayName;const Xj=g.forwardRef(({className:e,...t},n)=>h.jsx(EF,{ref:n,className:G("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));Xj.displayName=EF.displayName;const nye=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(TF,{ref:a,className:G("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));nye.displayName=TF.displayName;const rye=g.forwardRef(({className:e,...t},n)=>h.jsx(IF,{ref:n,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));rye.displayName=IF.displayName;const DF=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(tye,{children:h.jsx(OF,{ref:o,align:t,alignOffset:n,sideOffset:r,className:G("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));DF.displayName=OF.displayName;const LF=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(NF,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));LF.displayName=NF.displayName;const aye=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(MF,{ref:a,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(kF,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));aye.displayName=MF.displayName;const oye=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(PF,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(kF,{children:h.jsx(de,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));oye.displayName=PF.displayName;const iye=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(CF,{ref:r,className:G("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));iye.displayName=CF.displayName;const sye=g.forwardRef(({className:e,...t},n)=>h.jsx(AF,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));sye.displayName=AF.displayName;let $F;De=VAe()(UAe(WAe((e,t)=>({...U4,...Qle(e,t)})))),$F=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.pushSyncNodeQueue),a=De(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await ue("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):ue("LLM").save({name:`${s.name}`,status:s.provider===nn.WebLLM?Xe.Started:Xe.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||ql.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,f;return await a({source_id:l.id,source_type:"LLM",node_type:oe.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((f=i.measured)==null?void 0:f.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function di(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function FF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function BF(...e){return t=>{let n=!1;const r=e.map(a=>{const o=FF(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():FF(e[a],null)}}}}function fi(...e){return g.useCallback(BF(...e),e)}var Zj=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(lye);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(Jj,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(Jj,{...r,ref:t,children:n})});Zj.displayName="Slot";var Jj=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=dye(n);return g.cloneElement(n,{...uye(r,n.props),ref:t?BF(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});Jj.displayName="SlotClone";var cye=({children:e})=>h.jsx(h.Fragment,{children:e});function lye(e){return g.isValidElement(e)&&e.type===cye}function uye(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function dye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var fye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Oo=fye.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?Zj:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function pye(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}var hye="DismissableLayer",Qj="dismissableLayer.update",mye="dismissableLayer.pointerDownOutside",yye="dismissableLayer.focusOutside",zF,VF=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),UF=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(VF),[u,d]=g.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),y=fi(t,E=>d(E)),m=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=m.indexOf(v),w=u?m.indexOf(u):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,j=bye(E=>{const O=E.target,M=[...l.branches].some(N=>N.contains(O));!x||M||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f),S=wye(E=>{const O=E.target;[...l.branches].some(M=>M.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f);return HAe(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(zF=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),WF(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=zF)}},[u,f,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),WF())},[u,l]),g.useEffect(()=>{const E=()=>p({});return document.addEventListener(Qj,E),()=>document.removeEventListener(Qj,E)},[]),h.jsx(Oo.div,{...c,ref:y,style:{pointerEvents:_?x?"auto":"none":void 0,...e.style},onFocusCapture:di(e.onFocusCapture,S.onFocusCapture),onBlurCapture:di(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:di(e.onPointerDownCapture,j.onPointerDownCapture)})});UF.displayName=hye;var gye="DismissableLayerBranch",vye=g.forwardRef((e,t)=>{const n=g.useContext(VF),r=g.useRef(null),a=fi(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Oo.div,{...e,ref:a})});vye.displayName=gye;function bye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){HF(mye,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function wye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&HF(yye,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function WF(){const e=new CustomEvent(Qj);document.dispatchEvent(e)}function HF(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?pye(a,o):a.dispatchEvent(o)}var eS="focusScope.autoFocusOnMount",tS="focusScope.autoFocusOnUnmount",qF={bubbles:!1,cancelable:!0},xye="FocusScope",KF=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),f=fi(t,m=>c(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:pi(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||pi(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&pi(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){XF.add(p);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(eS,qF);s.addEventListener(eS,l),s.dispatchEvent(v),v.defaultPrevented||(_ye(Cye(YF(s)),{select:!0}),document.activeElement===m&&pi(s))}return()=>{s.removeEventListener(eS,l),setTimeout(()=>{const v=new CustomEvent(tS,qF);s.addEventListener(tS,u),s.dispatchEvent(v),v.defaultPrevented||pi(m??document.body,{select:!0}),s.removeEventListener(tS,u),XF.remove(p)},0)}}},[s,l,u,p]);const y=g.useCallback(m=>{if(!n&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=jye(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&pi(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&pi(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,p.paused]);return h.jsx(Oo.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});KF.displayName=xye;function _ye(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(pi(r,{select:t}),document.activeElement!==n)return}function jye(e){const t=YF(e),n=GF(t,e),r=GF(t.reverse(),e);return[n,r]}function YF(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function GF(e,t){for(const n of e)if(!Sye(n,{upTo:t}))return n}function Sye(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Eye(e){return e instanceof HTMLInputElement&&"select"in e}function pi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Eye(e)&&t&&e.select()}}var XF=Oye();function Oye(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=ZF(e,t),e.unshift(t)},remove(t){var n;e=ZF(e,t),(n=e[0])==null||n.resume()}}}function ZF(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Cye(e){return e.filter(t=>t.tagName!=="A")}var Nye="Arrow",JF=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Oo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});JF.displayName=Nye;var Mye=JF,nS="Popper",[QF,e9]=er(nS),[Pye,t9]=QF(nS),n9=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(Pye,{scope:t,anchor:r,onAnchorChange:a,children:n})};n9.displayName=nS;var r9="PopperAnchor",a9=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=t9(r9,n),i=g.useRef(null),s=fi(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Oo.div,{...a,ref:s})});a9.displayName=r9;var rS="PopperContent",[kye,Aye]=QF(rS),o9=g.forwardRef((e,t)=>{var Q,Y,q,X,te,B;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=e,v=t9(rS,n),[b,w]=g.useState(null),_=fi(t,ce=>w(ce)),[x,j]=g.useState(null),S=zf(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:N,boundary:P.filter(Iye),altBoundary:I},{refs:C,floatingStyles:A,placement:T,isPositioned:D,middlewareData:L}=Gg({strategy:"fixed",placement:M,whileElementsMounted:(...ce)=>Rg(...ce,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Lg({mainAxis:a+O,alignmentAxis:i}),c&&cv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lv():void 0,...k}),c&&uv({...k}),dv({...k,apply:({elements:ce,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=ce.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&fv({element:x,padding:s}),Rye({arrowWidth:E,arrowHeight:O}),f&&pv({strategy:"referenceHidden",...k})]}),[R,F]=c9(T),V=tr(y);en(()=>{D&&(V==null||V())},[D,V]);const $=(Q=L.arrow)==null?void 0:Q.x,U=(Y=L.arrow)==null?void 0:Y.y,z=((q=L.arrow)==null?void 0:q.centerOffset)!==0,[K,ne]=g.useState();return en(()=>{b&&ne(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...A,transform:D?A.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(te=L.transformOrigin)==null?void 0:te.y].join(" "),...((B=L.hide)==null?void 0:B.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(kye,{scope:n,placedSide:R,onArrowChange:j,arrowX:$,arrowY:U,shouldHideArrow:z,children:h.jsx(Oo.div,{"data-side":R,"data-align":F,...m,ref:_,style:{...m.style,animation:D?void 0:"none"}})})})});o9.displayName=rS;var i9="PopperArrow",Tye={top:"bottom",right:"left",bottom:"top",left:"right"},s9=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=Aye(i9,n),o=Tye[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(Mye,{...r,ref:t,style:{...r.style,display:"block"}})})});s9.displayName=i9;function Iye(e){return e!==null}var Rye=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=c9(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",y="";return c==="bottom"?(p=o?u:`${d}px`,y=`${-s}px`):c==="top"?(p=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,y=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,y=o?u:`${f}px`),{data:{x:p,y}}}});function c9(e){const[t,n="center"]=e.split("-");return[t,n]}var Dye=n9,l9=a9,Lye=o9,$ye=s9,Fye="Portal",u9=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);en(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?qAe.createPortal(h.jsx(Oo.div,{...r,ref:t}),i):null});u9.displayName=Fye;function Bye(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var aS=e=>{const{present:t,children:n}=e,r=zye(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=fi(r.ref,Vye(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};aS.displayName="Presence";function zye(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=Bye(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=Dm(r.current);o.current=s==="mounted"?l:"none"},[s]),en(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,f=Dm(l);e?c("MOUNT"):f==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),en(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=p=>{const y=Dm(r.current).includes(p.animationName);if(p.target===t&&y&&(c("ANIMATION_END"),!a.current)){const m=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=m)})}},f=p=>{p.target===t&&(o.current=Dm(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function Dm(e){return(e==null?void 0:e.animationName)||"none"}function Vye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Lm="right-scroll-bar-position",$m="width-before-scroll-bar",Uye="with-scroll-bars-hidden",Wye="--removed-body-scroll-bar-size";function oS(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Hye(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var qye=typeof window<"u"?g.useLayoutEffect:g.useEffect,d9=new WeakMap;function Kye(e,t){var n=Hye(null,function(r){return e.forEach(function(a){return oS(a,r)})});return qye(function(){var r=d9.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||oS(s,null)}),o.forEach(function(s){a.has(s)||oS(s,i)})}d9.set(n,e)},[e]),n}var f9=hv(),iS=function(){},Fm=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:iS,onWheelCapture:iS,onTouchMoveCapture:iS}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Vf(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,j=Kye([n,t]),S=yn(yn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:f9,removeScrollBar:l,shards:d,noIsolation:p,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),yn(yn({},S),{ref:j})):g.createElement(b,yn({},S,{className:c,ref:j}),s))});Fm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Fm.classNames={fullWidth:$m,zeroRight:Lm};function Yye(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=mv();return t&&e.setAttribute("nonce",t),e}function Gye(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Xye(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Zye=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Yye())&&(Gye(t,n),Xye(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Jye=function(){var e=Zye();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Qye=function(){var e=Jye(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},ege={left:0,top:0,right:0,gap:0},sS=function(e){return parseInt(e||"",10)||0},tge=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[sS(n),sS(r),sS(a)]},nge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ege;var t=tge(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},rge=Qye(),Dc="data-scroll-locked",age=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Uye,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Dc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Lm,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat($m,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Lm," .").concat(Lm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat($m," .").concat($m,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Dc,`] {
    `).concat(Wye,": ").concat(s,`px;
  }
`)},p9=function(){var e=parseInt(document.body.getAttribute(Dc)||"0",10);return isFinite(e)?e:0},oge=function(){g.useEffect(function(){return document.body.setAttribute(Dc,(p9()+1).toString()),function(){var e=p9()-1;e<=0?document.body.removeAttribute(Dc):document.body.setAttribute(Dc,e.toString())}},[])},ige=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;oge();var o=g.useMemo(function(){return nge(a)},[a]);return g.createElement(rge,{styles:age(o,!t,a,n?"":"!important")})},cS=!1;if(typeof window<"u")try{var Bm=Object.defineProperty({},"passive",{get:function(){return cS=!0,!0}});window.addEventListener("test",Bm,Bm),window.removeEventListener("test",Bm,Bm)}catch{cS=!1}var Lc=cS?{passive:!1}:!1,sge=function(e){return e.tagName==="TEXTAREA"},h9=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!sge(e)&&n[t]==="visible")},cge=function(e){return h9(e,"overflowY")},lge=function(e){return h9(e,"overflowX")},m9=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=y9(e,r);if(a){var o=g9(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},uge=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},dge=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},y9=function(e,t){return e==="v"?cge(t):lge(t)},g9=function(e,t){return e==="v"?uge(t):dge(t)},fge=function(e,t){return e==="h"&&t==="rtl"?-1:1},pge=function(e,t,n,r,a){var o=fge(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=g9(e,s),y=p[0],m=p[1],v=p[2],b=m-v-o*y;(y||b)&&y9(e,s)&&(d+=b,f+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},zm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},v9=function(e){return[e.deltaX,e.deltaY]},b9=function(e){return e&&"current"in e?e.current:e},hge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},mge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},yge=0,$c=[];function gge(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(yge++)[0],o=g.useState(Uf)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=yv([e.lockRef.current],(e.shards||[]).map(b9),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=zm(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=m9(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=m9(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var M=r.current||j;return pge(M,v,m,M==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!$c.length||$c[$c.length-1]!==o)){var b="deltaY"in v?v9(v):zm(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&hge(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(b9).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:vge(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=zm(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,v9(m),m.target,s(m,e.lockRef.current))},[]),f=g.useCallback(function(m){l(m.type,zm(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return $c.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Lc),document.addEventListener("touchmove",c,Lc),document.addEventListener("touchstart",u,Lc),function(){$c=$c.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Lc),document.removeEventListener("touchmove",c,Lc),document.removeEventListener("touchstart",u,Lc)}},[]);var p=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:mge(a)}):null,p?g.createElement(ige,{gapMode:e.gapMode}):null)}function vge(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const bge=gv(f9,gge);var w9=g.forwardRef(function(e,t){return g.createElement(Fm,yn({},e,{ref:t,sideCar:bge}))});w9.classNames=Fm.classNames;var lS="Popover",[x9,m2e]=er(lS,[e9]),Ed=e9(),[wge,hi]=x9(lS),_9=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=Ed(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,f]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(Dye,{...s,children:h.jsx(wge,{scope:t,contentId:Pt(),triggerRef:c,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};_9.displayName=lS;let uS;uS="PopoverAnchor",$g=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(uS,n),o=Ed(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(l9,{...o,...r,ref:t})}),$g.displayName=uS;var j9="PopoverTrigger",dS=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(j9,n),o=Ed(n),i=fi(t,a.triggerRef),s=h.jsx(Oo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":N9(a.open),...r,ref:i,onClick:di(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(l9,{asChild:!0,...o,children:s})});dS.displayName=j9;var fS="PopoverPortal",[xge,_ge]=x9(fS,{forceMount:void 0}),S9=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=hi(fS,t);return h.jsx(xge,{scope:t,forceMount:n,children:h.jsx(aS,{present:n||o.open,children:h.jsx(u9,{asChild:!0,container:a,children:r})})})};S9.displayName=fS;var Fc="PopoverContent",E9=g.forwardRef((e,t)=>{const n=_ge(Fc,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=hi(Fc,e.__scopePopover);return h.jsx(aS,{present:r||o.open,children:o.modal?h.jsx(jge,{...a,ref:t}):h.jsx(Sge,{...a,ref:t})})});E9.displayName=Fc;var jge=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(null),a=fi(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return Vl(i)},[]),h.jsx(w9,{as:Zj,allowPinchZoom:!0,children:h.jsx(O9,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:di(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:di(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:di(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Sge=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(O9,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),O9=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,f=hi(Fc,n),p=Ed(n);return Ul(),h.jsx(KF,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(UF,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(Lye,{"data-state":N9(f.open),role:"dialog",id:f.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),C9="PopoverClose",Ege=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(C9,n);return h.jsx(Oo.button,{type:"button",...r,ref:t,onClick:di(e.onClick,()=>a.onOpenChange(!1))})});Ege.displayName=C9;var Oge="PopoverArrow",Cge=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Ed(n);return h.jsx($ye,{...a,...r,ref:t})});Cge.displayName=Oge;function N9(e){return e?"open":"closed"}ZN=_9,OK=$g,JN=dS,XN=S9,Xg=E9,lM=ZN,PK=JN,vv=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(XN,{children:h.jsx(Xg,{ref:a,align:t,sideOffset:n,className:G("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),vv.displayName=Xg.displayName;var M9=1,Nge=.9,Mge=.8,Pge=.17,pS=.1,hS=.999,kge=.9999,Age=.99,Tge=/[\\\/_+.#"@\[\(\{&]/,Ige=/[\\\/_+.#"@\[\(\{&]/g,Rge=/[\s-]/,P9=/[\s-]/g;function mS(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?M9:Age;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,f,p,y;l>=0;)d=mS(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=M9:Tge.test(e.charAt(l-1))?(d*=Mge,p=e.slice(a,l-1).match(Ige),p&&a>0&&(d*=Math.pow(hS,p.length))):Rge.test(e.charAt(l-1))?(d*=Nge,y=e.slice(a,l-1).match(P9),y&&a>0&&(d*=Math.pow(hS,y.length))):(d*=Pge,a>0&&(d*=Math.pow(hS,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=kge)),(d<pS&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(f=mS(e,t,n,r,l+1,o+2,i),f*pS>d&&(d=f*pS)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function k9(e){return e.toLowerCase().replace(P9," ")}function Dge(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,mS(e,t,k9(e),k9(t),0,0,{})}var Od='[cmdk-group=""]',yS='[cmdk-group-items=""]',Lge='[cmdk-group-heading=""]',gS='[cmdk-item=""]',A9=`${gS}:not([aria-disabled="true"])`,vS="cmdk-item-select",rs="data-value",$ge=(e,t,n)=>Dge(e,t,n),T9=g.createContext(void 0),Cd=()=>g.useContext(T9),I9=g.createContext(void 0),bS=()=>g.useContext(I9),R9=g.createContext(void 0),D9=g.forwardRef((e,t)=>{let n=Bc(()=>{var $,U;return{search:"",value:(U=($=e.value)!=null?$:e.defaultValue)!=null?U:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=Bc(()=>new Set),a=Bc(()=>new Map),o=Bc(()=>new Map),i=Bc(()=>new Set),s=L9(e),{label:c,children:l,value:u,onValueChange:d,filter:f,shouldFilter:p,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...b}=e,w=Pt(),_=Pt(),x=Pt(),j=g.useRef(null),S=Gge();as(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,E.emit()}},[u]),as(()=>{S(6,k)},[]);let E=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,U,z)=>{var K,ne,Q;if(!Object.is(n.current[$],U)){if(n.current[$]=U,$==="search")I(),N(),S(1,P);else if($==="value"&&(z||S(5,k),((K=s.current)==null?void 0:K.value)!==void 0)){let Y=U??"";(Q=(ne=s.current).onValueChange)==null||Q.call(ne,Y);return}E.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,U,z)=>{var K;U!==((K=o.current.get($))==null?void 0:K.value)&&(o.current.set($,{value:U,keywords:z}),n.current.filtered.items.set($,M(U,z)),S(2,()=>{N(),E.emit()}))},item:($,U)=>(r.current.add($),U&&(a.current.has(U)?a.current.get(U).add($):a.current.set(U,new Set([$]))),S(3,()=>{I(),N(),n.current.value||P(),E.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let z=C();S(4,()=>{I(),(z==null?void 0:z.getAttribute("id"))===$&&P(),E.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:_,listInnerRef:j}),[]);function M($,U){var z,K;let ne=(K=(z=s.current)==null?void 0:z.filter)!=null?K:$ge;return $?ne($,n.current.search,U):0}function N(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,U=[];n.current.filtered.groups.forEach(K=>{let ne=a.current.get(K),Q=0;ne.forEach(Y=>{let q=$.get(Y);Q=Math.max(q,Q)}),U.push([K,Q])});let z=j.current;A().sort((K,ne)=>{var Q,Y;let q=K.getAttribute("id"),X=ne.getAttribute("id");return((Q=$.get(X))!=null?Q:0)-((Y=$.get(q))!=null?Y:0)}).forEach(K=>{let ne=K.closest(yS);ne?ne.appendChild(K.parentElement===ne?K:K.closest(`${yS} > *`)):z.appendChild(K.parentElement===z?K:K.closest(`${yS} > *`))}),U.sort((K,ne)=>ne[1]-K[1]).forEach(K=>{var ne;let Q=(ne=j.current)==null?void 0:ne.querySelector(`${Od}[${rs}="${encodeURIComponent(K[0])}"]`);Q==null||Q.parentElement.appendChild(Q)})}function P(){let $=A().find(z=>z.getAttribute("aria-disabled")!=="true"),U=$==null?void 0:$.getAttribute(rs);E.setState("value",U||void 0)}function I(){var $,U,z,K;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let ne=0;for(let Q of r.current){let Y=(U=($=o.current.get(Q))==null?void 0:$.value)!=null?U:"",q=(K=(z=o.current.get(Q))==null?void 0:z.keywords)!=null?K:[],X=M(Y,q);n.current.filtered.items.set(Q,X),X>0&&ne++}for(let[Q,Y]of a.current)for(let q of Y)if(n.current.filtered.items.get(q)>0){n.current.filtered.groups.add(Q);break}n.current.filtered.count=ne}function k(){var $,U,z;let K=C();K&&((($=K.parentElement)==null?void 0:$.firstChild)===K&&((z=(U=K.closest(Od))==null?void 0:U.querySelector(Lge))==null||z.scrollIntoView({block:"nearest"})),K.scrollIntoView({block:"nearest"}))}function C(){var $;return($=j.current)==null?void 0:$.querySelector(`${gS}[aria-selected="true"]`)}function A(){var $;return Array.from((($=j.current)==null?void 0:$.querySelectorAll(A9))||[])}function T($){let U=A()[$];U&&E.setState("value",U.getAttribute(rs))}function D($){var U;let z=C(),K=A(),ne=K.findIndex(Y=>Y===z),Q=K[ne+$];(U=s.current)!=null&&U.loop&&(Q=ne+$<0?K[K.length-1]:ne+$===K.length?K[0]:K[ne+$]),Q&&E.setState("value",Q.getAttribute(rs))}function L($){let U=C(),z=U==null?void 0:U.closest(Od),K;for(;z&&!K;)z=$>0?Kge(z,Od):Yge(z,Od),K=z==null?void 0:z.querySelector(A9);K?E.setState("value",K.getAttribute(rs)):D($)}let R=()=>T(A().length-1),F=$=>{$.preventDefault(),$.metaKey?R():$.altKey?L(1):D(1)},V=$=>{$.preventDefault(),$.metaKey?T(0):$.altKey?L(-1):D(-1)};return g.createElement(Ae.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var U;if((U=b.onKeyDown)==null||U.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&F($);break}case"ArrowDown":{F($);break}case"p":case"k":{v&&$.ctrlKey&&V($);break}case"ArrowUp":{V($);break}case"Home":{$.preventDefault(),T(0);break}case"End":{$.preventDefault(),R();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let z=C();if(z){let K=new Event(vS);z.dispatchEvent(K)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Zge},c),Vm(e,$=>g.createElement(I9.Provider,{value:E},g.createElement(T9.Provider,{value:O},$))))}),Fge=g.forwardRef((e,t)=>{var n,r;let a=Pt(),o=g.useRef(null),i=g.useContext(R9),s=Cd(),c=L9(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;as(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=$9(a,o,[e.value,e.children,o],e.keywords),d=bS(),f=os(S=>S.value&&S.value===u.current),p=os(S=>l||s.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);g.useEffect(()=>{let S=o.current;if(!(!S||e.disabled))return S.addEventListener(vS,y),()=>S.removeEventListener(vS,y)},[p,e.onSelect,e.disabled]);function y(){var S,E;m(),(E=(S=c.current).onSelect)==null||E.call(S,u.current)}function m(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:b,onSelect:w,forceMount:_,keywords:x,...j}=e;return g.createElement(Ae.div,{ref:Nd([o,t]),...j,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||s.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},e.children)}),Bge=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Pt(),s=g.useRef(null),c=g.useRef(null),l=Pt(),u=Cd(),d=os(p=>a||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);as(()=>u.group(i),[]),$9(i,s,[e.value,e.heading,c]);let f=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Ae.div,{ref:Nd([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),Vm(e,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(R9.Provider,{value:f},p))))}),zge=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=os(i=>!i.search);return!n&&!o?null:g.createElement(Ae.div,{ref:Nd([a,t]),...r,"cmdk-separator":"",role:"separator"})}),Vge=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=bS(),i=os(u=>u.search),s=os(u=>u.value),c=Cd(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${gS}[${rs}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Ae.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),Uge=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=Cd();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;l.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Ae.div,{ref:Nd([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},Vm(e,c=>g.createElement("div",{ref:Nd([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),Wge=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(Dl,{open:n,onOpenChange:r},g.createElement(Ll,{container:i},g.createElement(Mi,{"cmdk-overlay":"",className:a}),g.createElement(Pi,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(D9,{ref:t,...s}))))}),Hge=g.forwardRef((e,t)=>os(n=>n.filtered.count===0)?g.createElement(Ae.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),qge=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Ae.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Vm(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),Gn=Object.assign(D9,{List:Uge,Item:Fge,Input:Vge,Group:Bge,Separator:zge,Dialog:Wge,Empty:Hge,Loading:qge});function Kge(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Yge(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function L9(e){let t=g.useRef(e);return as(()=>{t.current=e}),t}var as=typeof window>"u"?g.useEffect:g.useLayoutEffect;function Bc(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function Nd(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function os(e){let t=bS(),n=()=>e(t.snapshot());return Bf.useSyncExternalStore(t.subscribe,n,n)}function $9(e,t,n,r=[]){let a=g.useRef(),o=Cd();return as(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(rs,s),a.current=s}),a}var Gge=()=>{let[e,t]=g.useState(),n=Bc(()=>new Map);return as(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function Xge(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Vm({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(Xge(t),{ref:t.ref},n(t.props.children)):n(t)}var Zge={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const F9=g.forwardRef(({className:e,...t},n)=>h.jsx(Gn,{ref:n,className:G("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));F9.displayName=Gn.displayName;const B9=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(de,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(Gn.Input,{ref:n,className:G("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));B9.displayName=Gn.Input.displayName;const z9=g.forwardRef(({className:e,...t},n)=>h.jsx(Gn.List,{ref:n,className:G("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));z9.displayName=Gn.List.displayName;const V9=g.forwardRef((e,t)=>h.jsx(Gn.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));V9.displayName=Gn.Empty.displayName;const U9=g.forwardRef(({className:e,...t},n)=>h.jsx(Gn.Group,{ref:n,className:G("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));U9.displayName=Gn.Group.displayName;const Jge=g.forwardRef(({className:e,...t},n)=>h.jsx(Gn.Separator,{ref:n,className:G("-mx-1 h-px bg-border",e),...t}));Jge.displayName=Gn.Separator.displayName;const wS=g.forwardRef(({className:e,...t},n)=>h.jsx(Gn.Item,{ref:n,className:G("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));wS.displayName=Gn.Item.displayName;const Qge=Wa("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ia=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:G(Qge({variant:t}),e),...n}));Ia.displayName="Alert";const Co=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:G("mb-1 font-medium leading-none tracking-tight",e),...t}));Co.displayName="AlertTitle";const zc=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("text-sm [&_p]:leading-relaxed",e),...t}));zc.displayName="AlertDescription";const eve=Ha(({onConfirm:e,onCancel:t})=>{const n=Yt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Qo,{open:n.visible,onOpenChange:c,children:h.jsxs(ro,{className:"w-[330px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:r("create_session_passkey.title")}),h.jsx(Pp,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(dj,{onChange:i,maxLength:6,children:[h.jsxs(wd,{children:[h.jsx(fr,{index:0,hidden:!0}),h.jsx(fr,{index:1,hidden:!0}),h.jsx(fr,{index:2,hidden:!0})]}),h.jsx(fj,{}),h.jsxs(wd,{children:[h.jsx(fr,{index:3,hidden:!0}),h.jsx(fr,{index:4,hidden:!0}),h.jsx(fr,{index:5,hidden:!0})]})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),tve=()=>{const[e,t]=g.useState(!1),n=Qe(o=>o.currentSession),r=Qe(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Fpe(),s=await d8(i,o);await ue("Session").update(n.id,{passphrase:s});const c=await ue("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},nve=[nn.WebLLM,nn.OpenAI],rve=["gpt-4o","gpt-4o-mini"];function ave(e){var $,U;const{id:t,setDialog:n}=e,{t:r}=Pe("components"),{toast:a}=tn(),o=Tn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[f,p]=g.useState(""),[y,m]=g.useState(),[v,b]=g.useState(nn.WebLLM),[w,_]=g.useState(!1),[x,j]=g.useState(),S=Yt(eve),{updateSessionPassphrase:E}=tve(),O=Ua(z=>z.syncCachedLLMURLs),M=Ua(z=>z.cachedLLMURLs),{loading:N,createLLM:P}=$F();g.useEffect(()=>{At(()=>import("./index-CuU07XIu.js").then(async z=>(await z.__tla,z)),__vite__mapDeps([5,1,2,3,4])).then(async({functionCallingModelIds:z,prebuiltAppConfig:K})=>{const ne=K.model_list;j({modelList:ne,functionCallingModelIds:z})})},[]),g.useEffect(()=>{O()},[O]);const I=g.useMemo(()=>c?v!==nn.WebLLM:!1,[c,v]),k=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((f?x==null?void 0:x.modelList.filter(z=>z.model_id.toLowerCase().includes(f.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((z,K)=>{const ne=M.some(B=>B.includes(z.model_id)),Q=M.some(B=>B.includes(K.model_id));if(ne&&!Q)return-1;if(!ne&&Q)return 1;const Y=mj.includes(z.model_id),q=mj.includes(K.model_id);if(Y&&!q)return-1;if(!Y&&q)return 1;const X=x==null?void 0:x.functionCallingModelIds.includes(z.model_id),te=x==null?void 0:x.functionCallingModelIds.includes(K.model_id);return X&&!te?-1:!X&&te?1:z.vram_required_MB&&K.vram_required_MB&&z.vram_required_MB!==K.vram_required_MB?z.vram_required_MB-K.vram_required_MB:z.model_id.localeCompare(K.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,f,M]),C=g.useMemo(()=>{if(c)switch(v){case nn.WebLLM:return(x==null?void 0:x.modelList)&&k.find(z=>z.model_id===c);case nn.OpenAI:return m({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,k,v]);g.useEffect(()=>{!(C!=null&&C.model_id)||!M||_(M.some(z=>z.includes(C.model_id)))},[M,C==null?void 0:C.model_id]);const A=g.useCallback(z=>{l(z),d(!1)},[]),T=g.useCallback(z=>{p(z)},[]),D=g.useCallback(z=>{b(z)},[]),L=async()=>{var z;if(o)try{s(!0);let K="",ne;if(I){await new Promise((Y,q)=>{S.show({onConfirm:X=>{K=X,S.hide(),Y(void 0)},onCancel:()=>{q()}})});const Q=await E(K);if(!Q||!Object.keys(y||{}).length)throw new Error("Failed to update session passphrase");await gm.set("passphrase",Q.passphrase),ne={},await Promise.all(Object.entries(y||{}).map(async([Y,q])=>{const X=await d8(q,Q.passphrase);ne||(ne={}),ne[Y]=X}))}await P(o,{name:c,model_type:R(C==null?void 0:C.model_type),function_calling:C!=null&&C.model_id?(z=x==null?void 0:x.functionCallingModelIds)==null?void 0:z.includes(C==null?void 0:C.model_id):!1,parameters:ne,provider:v}),n==null||n(!1)}catch(K){If(K),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),l("")}},R=g.useCallback(z=>z===1?ql.embedding:z===2?ql.VLM:ql.LLM,[]),F=g.useMemo(()=>{switch(v){case nn.WebLLM:return k.map(z=>{var K;return h.jsxs(wS,{value:z.model_id,onSelect:A,children:[c===z.model_id?h.jsx(de,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(ka,{name:z.model_id}),z.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(_d,{model:z,isFunctionCalling:((K=x==null?void 0:x.functionCallingModelIds)==null?void 0:K.includes(z.model_id))||!1,name:z.model_id,isCached:M.some(ne=>ne.includes(z.model_id))||!1})})]})]},z.model_id)});case nn.OpenAI:return rve.map(z=>h.jsxs(wS,{value:z,onSelect:A,children:[c===z?h.jsx(de,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(ka,{name:z}),z]})})]},z))}},[M,A,c,x==null?void 0:x.functionCallingModelIds,k,v]),V=g.useMemo(()=>{if(I)switch(v){case nn.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Ia,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(nt,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(En,{type:"password",value:(y==null?void 0:y.key)||"",onChange:z=>m(K=>({...K,key:z.target.value}))})]})]})}},[I,v,r,y]);return h.jsxs(Gt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:r("add_llm_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:r("add_llm_card.provider")}),h.jsxs(jo,{value:v,onValueChange:D,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(Ta,{children:Object.values(nve).map(z=>h.jsx(Yn,{value:z,children:r(`add_llm_card.providers.${z.toLowerCase()}`)},z))})]}),h.jsx(nt,{children:r("add_llm_card.model_name")}),h.jsxs(lM,{open:u,onOpenChange:d,children:[h.jsx(dS,{asChild:!0,children:h.jsxs(ut,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?C==null?void 0:C.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(de,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(vv,{className:"w-full p-0",children:h.jsxs(F9,{children:[h.jsx(B9,{onValueChange:T,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(z9,{children:[h.jsx(V9,{children:r("add_llm_card.no_model")}),h.jsx(U9,{children:F})]})]})})]})]}),C?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(ka,{name:C.model_id,className:"mr-2"}),h.jsx(_d,{model:C,isFunctionCalling:(($=x==null?void 0:x.functionCallingModelIds)==null?void 0:$.includes(C.model_id))||!1,name:C.model_id,isCached:M.some(z=>z.includes(C.model_id))||!1})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),C.model]}),C.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),C.model_lib]}):void 0,C.overrides&&((U=Object.keys(C.overrides))!=null&&U.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(C.overrides)]}):void 0]}):null,V]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:N||i,disabled:!(c!=null&&c.length),onClick:L,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const W9=()=>{const e=Qe(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),f=await ue("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||nr.System,status:Ga.Started,session_id:e,type:i.type||rr.Chat});if(!f)throw new Error("Failed to save prompt");if(!await r({source_id:f.id,source_type:"Prompt",node_type:oe.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},ove={[rr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:rr.Chat},[rr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:rr.FewShotExample}},ive={[nr.System]:{label:"add_prompt_card.prompt_roles.system",value:nr.System},[nr.Human]:{label:"add_prompt_card.prompt_roles.human",value:nr.Human},[nr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:nr.AI}},xS=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||rr.Chat),[d,f]=g.useState(t),[p,y]=g.useState(""),{t:m}=Pe("components"),v=g.useCallback(j=>{c(j.target.value)},[]),b=g.useCallback(j=>{y(j.target.value)},[]),w=g.useCallback(j=>{j===rr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(j)},[]),_=g.useCallback(j=>{f(j)},[]),x=async()=>{await i({content:s,role:d,prefix:p,type:l})&&(c(""),f(void 0),u("chat"),y(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_type")}),h.jsxs(jo,{value:l,onValueChange:w,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:m("add_prompt_card.type_select_placeholder")})}),h.jsx(Ta,{children:Object.values(ove).map(j=>h.jsx(Yn,{value:j.value,children:m(j.label)},j.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_role")}),h.jsxs(jo,{value:d,onValueChange:_,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:m("add_prompt_card.role_select_placeholder")})}),h.jsx(Ta,{children:Object.values(ive).map(j=>h.jsx(Yn,{value:j.value,children:m(j.label)},j.value))})]})]}),l===rr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_prefix")}),h.jsx(fo,{value:p,onChange:b,disabled:!1,className:"h-20",placeholder:m("add_prompt_card.placeholder"),id:"message"}),h.jsx(nt,{children:m("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),m("add_prompt_card.few_shot_example_note")]})]}),h.jsx(fo,{value:s,onChange:v,disabled:!1,placeholder:m("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Vn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:m("add_prompt_card.button")})})]})}),sve=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Pe("components"),{toast:o}=tn(),i=Tn(t),{createPrompt:s,loading:c}=W9(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_prompt_card.title")})}),h.jsx($n,{children:h.jsx(xS,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),cve=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||mu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,f=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),p=await ue("Schema").save({name:"Untitled Schema",session_id:e});if(!p)throw new Error("Failed to save schema");const y=a(p.id,s,[],void 0);if(!(y!=null&&y.length))throw new Error("Failed to convert schema items");if(await ue("SchemaItem").save(y),!await r({source_id:p.id,source_type:"Schema",node_type:oe.Schema,x:d,y:f+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}};var _S="Checkbox",[lve,y2e]=er(_S),[uve,dve]=lve(_S),H9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[f,p]=g.useState(null),y=wt(t,x=>p(x)),m=g.useRef(!1),v=f?u||!!f.closest("form"):!0,[b=!1,w]=Sn({prop:a,defaultProp:o,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const x=f==null?void 0:f.form;if(x){const j=()=>w(_.current);return x.addEventListener("reset",j),()=>x.removeEventListener("reset",j)}},[f,w]),h.jsxs(uve,{scope:n,state:b,disabled:s,children:[h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":mi(b)?"mixed":b,"aria-required":i,"data-state":Y9(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:y,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(j=>mi(j)?!0:!j),v&&(m.current=x.isPropagationStopped(),m.current||x.stopPropagation())})}),v&&h.jsx(fve,{control:f,bubbles:!m.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:mi(o)?!1:o})]})});H9.displayName=_S;var q9="CheckboxIndicator",K9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=dve(q9,n);return h.jsx(Mr,{present:r||mi(o.state)||o.state===!0,children:h.jsx(Ae.span,{"data-state":Y9(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});K9.displayName=q9;var fve=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=M8(n),c=zf(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&f){const p=new Event("click",{bubbles:r});u.indeterminate=mi(n),f.call(u,mi(n)?!1:n),u.dispatchEvent(p)}},[s,n,r]);const l=g.useRef(mi(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function mi(e){return e==="indeterminate"}function Y9(e){return mi(e)?"indeterminate":e?"checked":"unchecked"}Bg=H9,KN=K9;const G9=g.forwardRef(({className:e,...t},n)=>h.jsx(Bg,{ref:n,className:G("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(KN,{className:G("flex items-center justify-center text-current"),children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}));G9.displayName=Bg.displayName;const X9=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Pe("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(m=>m.id===n)||a,[t,a,n]),s=g.useCallback(m=>{m.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(m.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:m.target.value||""}:b)]):o(v=>({...v,name:m.target.value||""})))},[n,e]),c=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:m.target.value||""}:b)]):o(v=>({...v,description:m.target.value||""}))},[n,e]),l=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:m||""}:b)]):o(v=>({...v,type:m||"string"}))},[n,e]),u=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!m||!1}:b)]):o(v=>({...v,required:!!m||!1}))},[n,e]),d=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:m.target.value||""}:b)]):o(v=>({...v,enum:m.target.value||""}))},[n,e]),f=g.useCallback(()=>{if(t.find(m=>m.name===a.name))return Al({variant:"destructive",content:"Name already exists"});a.id=mu(),e(m=>[...m,{...a}]),o({name:"",description:"",type:"string",required:!1,id:mu(),parent:n||void 0,data:[]})},[t,a,e,n]),p=g.useCallback(m=>{e(v=>[...v.map(b=>b.id===n?{...b,data:m(b.data||[])}:b)])},[n,e]),y=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.name")}),h.jsx(En,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.description")}),h.jsx(En,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.type")}),h.jsxs(jo,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Aa,{children:h.jsx(So,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(Ta,{children:[h.jsx(Yn,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(Yn,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(Yn,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(Yn,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(Yn,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(nt,{children:r("add_schema_card.field.required")}),h.jsx(G9,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),y?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.children")}),h.jsx(Z9,{data:(i==null?void 0:i.data)||[],setData:p})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.field.enum")}),h.jsx(En,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(ut,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:f,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),Z9=g.memo(({data:e,setData:t})=>h.jsxs(E$,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(Mj,{value:`${n.id}`,children:[h.jsx(Pj,{children:n.name}),h.jsx(kj,{children:h.jsx(X9,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(Gt,{className:"p-2 mt-4",children:h.jsx(X9,{setData:t,data:e})})]})),pve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=cve(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){Al({variant:"destructive",title:`${l}`})}};return h.jsxs(Gt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_schema_card.title")})}),h.jsx($n,{className:"min-w-96",children:h.jsx(Z9,{setData:o,data:a})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),J9=()=>{const e=Qe(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,f=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),p=KAe(i,s),y=await ue("CSVData").save({headers:p.headers,csv:p.data,session_id:e});if(!y)throw new Error("Failed to save");if(!await r({source_id:y.id,source_type:"CSVData",node_type:oe.CSVData,x:d,y:f+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function hve({data:e}){const{t}=Pe("components");return h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsxs(ns,{children:[h.jsx(Tc,{children:t("add_few_shot_example_card.input")}),h.jsx(Tc,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(Pm,{children:e==null?void 0:e.map((n,r)=>h.jsxs(ns,{children:[h.jsx(Ic,{className:"p-4",children:n.input}),h.jsx(Ic,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const mve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Tn(t),{createCSVData:u,loading:d}=J9(),f=()=>{a(y=>[...y,{input:o,output:s}]),i(""),c("")},p=async()=>{l&&await u(l,["input","output"],r.map(y=>[y.input,y.output]))};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_few_shot_example_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(En,{value:o,onChange:y=>i(y.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(fo,{value:s,onChange:y=>c(y.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o||!s,onClick:f,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(hve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:d,disabled:!(r!=null&&r.length),onClick:p,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),yve=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!y)throw new Error("Failed create tool.");const m=await r({source_id:y.id,source_type:"ToolDefinition",node_type:oe.ToolDefinition,x:f,y:p+20});if(!m)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:m.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},gve=g.memo(e=>{const{t}=Pe("components"),{toast:n}=tn(),{id:r}=e,a=Tn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=yve(),d=y=>{i(y.target.value)},f=y=>{c(y.target.value)},p=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(y){zo(y),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_tool_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(En,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(fo,{onChange:f,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:u,onClick:p,className:"w-full",children:t("add_tool_card.create")})})]})}),vve=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||YAe.Local,storage:s.storage||kr.DatabaseNode,raw:"",provider:s.provider||vK.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!y)throw new Error("Failed to save vectorDatabase");const m=await r({source_id:y.id,source_type:"VectorDatabase",node_type:oe.VectorDatabase,x:f,y:p+30});if(!m)throw new Error("Failed to save vectorDatabase node");if(s.storage===kr.DataNode){const v=await ue("JSONLData").save({headers:GAe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:oe.JSONLData,x:f+80,y:p+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:m.id})}return{vectorDatabase:y,vectorDatabaseNode:m}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},Md=[vK.Memory],Pd=[kr.DatabaseNode],bve=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],wve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),{toast:a}=tn(),[o,i]=g.useState(""),[s,c]=g.useState(Md[0]),[l,u]=g.useState(Pd[0]),[d,f]=g.useState({}),{loading:p,createVectorDatabase:y}=vve(),m=g.useCallback(S=>{c(S)},[]),v=g.useCallback(S=>{u(S)},[]),b=g.useCallback(S=>{f(E=>({...E,type:S,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(S=>{i(S.target.value||"")},[]),_=g.useCallback(S=>{f(E=>({...E,chunkSize:Number(S.target.value)}))},[]),x=g.useCallback(S=>{f(E=>({...E,chunkOverlap:Number(S.target.value)}))},[]),j=async()=>{try{if(!r)return;await y(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),f({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.title")})}),h.jsx($n,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:t("create_vector_database_card.name")}),h.jsx(En,{className:"mb-4",value:o,onChange:w}),(Pd==null?void 0:Pd.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.storage_type")}),h.jsxs(jo,{value:l,onValueChange:v,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ta,{children:Object.values(Pd).map(S=>h.jsx(Yn,{value:S,children:t(`create_vector_database_card.storage_types.${S.toLowerCase()}`)},S))})]})]}):void 0,(Md==null?void 0:Md.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.provider")}),h.jsxs(jo,{value:s,onValueChange:m,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ta,{children:Object.values(Md).map(S=>h.jsx(Yn,{value:S,children:t(`create_vector_database_card.providers.${S.toLowerCase()}`)},S))})]})]}):void 0,h.jsx(nt,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(jo,{value:d.type,onValueChange:b,children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(Ta,{children:Object.values(bve).map(S=>h.jsx(Yn,{value:S,children:t(`create_vector_database_card.text_splitters.${S.toLowerCase()}`)},S))})]}),d.type?h.jsxs(Gt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs($n,{children:[h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(En,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(En,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{disabled:!d.type||!o,loading:p,onClick:j,className:"w-full",children:t("create_vector_database_card.create")})})]})});function xve({data:e}){const{t}=Pe("components");return h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsx(ns,{children:h.jsx(Tc,{children:t("add_text_data.text")})})}),h.jsx(Pm,{children:e==null?void 0:e.map((n,r)=>h.jsx(ns,{children:h.jsx(Ic,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const _ve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Tn(t),{createCSVData:c,loading:l}=J9(),u=()=>{a(f=>[...f,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(f=>[f.text]))};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_text_data.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(fo,{value:o,onChange:f=>i(f.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(xve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var No=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(No||{});const jve=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],Sve=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let Q9=0,eB,tB,nB,rB,aB,oB,Nn,lt,iB,sB,cB,lB,Um,jS,SS,ES,uB,dB,OS,fB,pB,hB;eB=(e,t)=>{Q9++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=Sve();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,M=(t==null?void 0:t.speedUp)||Math.random()*25,N=Math.random()*360,P=Math.random()*35*(Math.random()<=.5?-1:1),I=c-E/2,k=s-E/2,C=Math.random()<=.5?-1:1,A=document.createElement("div");if(n==="circle"){const T="http://www.w3.org/2000/svg",D=document.createElementNS(T,"svg"),L=document.createElementNS(T,"circle");L.setAttributeNS(null,"cx",(E/2).toString()),L.setAttributeNS(null,"cy",(E/2).toString()),L.setAttributeNS(null,"r",(E/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),D.appendChild(L),D.setAttribute("width",E.toString()),D.setAttribute("height",E.toString()),A.appendChild(D)}else A.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;A.style.position="absolute",A.style.transform=`translate3d(${k}px, ${I}px, 0px) rotate(${N}deg)`,l.appendChild(A),o.push({direction:C,element:A,left:k,size:E,speedHorz:O,speedUp:M,spinSpeed:P,spinVal:N,top:I})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let f,p=0;const y=30;function m(){const E=performance.now();i&&o.length<a&&E-p>y&&(u(),p=E),d(),f=requestAnimationFrame(m)}m();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",x=E=>{var O,M;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(M=E.touches)==null?void 0:M[0].clientY):(s=E.clientX,c=E.clientY)},j=E=>{x(E),i=!0},S=()=>{i=!1};return e.addEventListener(_,x,{passive:!0}),e.addEventListener(b,j,{passive:!0}),e.addEventListener(w,S,{passive:!0}),e.addEventListener("mouseleave",S,{passive:!0}),()=>{e.removeEventListener(_,x),e.removeEventListener(b,j),e.removeEventListener(w,S),e.removeEventListener("mouseleave",S);const E=setInterval(()=>{f&&o.length===0&&(cancelAnimationFrame(f),clearInterval(E),--Q9===0&&l.remove())},500)}},tB=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return eB(n.current,t)},[t]),H.cloneElement(e,{ref:n})},nB=g.memo(e=>{const{t}=Pe("flows"),n=Ml(s=>s.theme),[r,a]=g.useState(`${No.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(RF,{children:[h.jsx(Gj,{children:h.jsx(tB,{children:h.jsx(ut,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(XAe,{width:32,height:32,className:G(n==="dark"?"fill-white":"fill-black")})})})}),jve.map(s=>typeof s=="object"?h.jsxs(Gj,{children:[h.jsx(Xj,{children:s.icon?h.jsx(de,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(DF,{children:s.children.map(c=>h.jsx(LF,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(Gj,{children:h.jsx(Xj,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case No.ADD_LLM:return h.jsx(ave,{...e});case No.ADD_PROMPT:return h.jsx(sve,{...e});case No.ADD_SCHEMA:return h.jsx(pve,{...e});case No.ADD_FEW_SHOT_EXAMPLE:return h.jsx(mve,{...e});case No.ADD_TOOL_DEFINITION:return h.jsx(gve,{...e});case No.ADD_VECTOR_DATABASE:return h.jsx(wve,{...e});case No.ADD_TEXT_DATA:return h.jsx(_ve,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),rB=()=>{const[e,t]=g.useState(!1),n=Ri(),r=Qe(s=>s.currentSession),a=Qe(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var p;const d=(p=c.data)==null?void 0:p.entity;let f=c.type?ZAe[c.type]:void 0;if(f&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){f=f;const y=await ue(f).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,y.id);const m=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await ue("FlowNode").save({...m||c.data.flowNode,session_id:s.id,id:void 0,source_type:f,source_id:y.id});return u.set(`${c.id}`,v.id),{entityName:f,entity:y,node:v}}else if(!u.has(`${c.id}`)){const y=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),m=await ue("FlowNode").save({...y||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,m.id),{node:m}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await ue("Session").save({type:Pl.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:JAe.Started});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,f=await o(l,s,u,d);if(!f)throw new Error("Failed to clone main node");await ue("Session").update(l.id,{main_node_id:f.node.id,main_source_id:f!=null&&f.entity?f.entity.id:void 0,main_source_type:f.entityName?f.entityName:void 0});for(const{node:p,connectedNodes:y}of c.connections)if(await o(l,p,u,d),y)for(const m of y)await o(l,m,u,d);for(const{connections:p}of c.connections)for(const y of p){const m=d.get(`${y.source}`),v=d.get(`${y.target}`);if(!m||!v)throw new Error("Failed to get connected flow node id");await ue("FlowEdge").save({source:m,target:v,sourceHandle:y.sourceHandle,targetHandle:y.targetHandle,session_id:l.id})}return a(),n(gn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},aB=()=>{const[e,t]=g.useState(!1),n=De(o=>o.updateNodes),r=De(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await ue("FlowNode").delete(o);const i=await ue("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>ue("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},oB=Ha(({cloneStandaloneSession:e})=>{const t=Yt(),{t:n}=Pe("dialogs"),[r,a]=g.useState(""),{toast:o}=tn(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(Qo,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:n("create_session.title")}),h.jsx(Pp,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(En,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Nn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Pe("common"),{getNode:o}=lr(),{loading:i,deleteNodeFlow:s}=aB(),{createStandaloneSession:c}=rB(),{toast:l}=tn(),u=Yt(oB),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),f=g.useCallback(async y=>{try{const m=o(e);if(!m)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(m,{name:y,connections:v}),l({description:a("standalone_session_created")})}catch(m){If(m),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),p=g.useCallback(()=>{u.show({cloneStandaloneSession:f})},[f,u]);return h.jsxs("div",{className:G("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(ut,{className:"!rounded-none !px-2",onClick:p,variant:"ghost",children:h.jsx(de,{name:"package-plus",size:16})}):void 0,h.jsx(Vn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(de,{name:"trash-2",size:16})})]})}),lt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(Ju,{className:G("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===pe.Top?"!top-[-2px]":"",t),...n})}),iB=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),f=await ue("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:Hf.Started,messages:[],session_id:e}),p=await r({source_id:f.id,source_type:"Thread",node_type:oe.Thread,x:u,y:d+60});if(!p)throw new Error("Failed to create thread node");const y=await a({source:i.id,target:p.id});return{thread:f,flowNode:p,flowEdge:y}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},sB=(e,t)=>{var w;const{t:n}=Pe("flows"),{toast:r}=tn(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Tn(e),{loadModel:l}=Uh(),{createThread:u,loading:d}=iB(),f=De(_=>_.updateNodes),p=De(_=>_.pushSyncNodeQueue),{getNodes:y}=lr(),m=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const _=await ue("Thread").find({where:{initial_llm_id:t.entity.id}});p("Thread",{where:{source_type:"Thread",source_id:Oa(_.map(x=>x.id))}})}}finally{s(!1)}},[(w=t==null?void 0:t.entity)==null?void 0:w.id,p]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,x=>{c.data.status=x.progress===100?Xe.Loaded:Xe.Loading,c.data.label=x.text,f([{id:e,type:"replace",item:c}])}));const _=y().filter(x=>x.type===oe.LLM?x.data.entity.provider===nn.WebLLM:!1).map(x=>(x.data.status=Xe.Started,{id:x.id,type:"replace",item:x}));c.data.label="",c.data.status=Xe.Loaded,_.push({id:e,type:"replace",item:c}),f(_),await m()}}catch(_){zo(_),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,y,e,l,c,m,n,r,f]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,f([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:m}},An=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=lr();Dh({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...qle(l)])}});const c=g.useCallback(async(l,u,d,f)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:f})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async f=>{const p="edgeId"in f?f.edgeId:void 0,y=s(f.source);if(!y||!d)return;const m=await c(`${p}`,y,d,f);m!=null&&m.deleteEdgeId&&u.push(...Array.isArray(m.deleteEdgeId)?m.deleteEdgeId:[m.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(f=>({id:f}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},cB=e=>{const t=g.useCallback(async()=>{},[]);An(e,t)},lB=g.memo(e=>{var m,v,b,w,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Pe("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=sB(t,n);cB(t);const f=[Xe.Loading,Xe.Downloading].includes(n.status);g.useEffect(()=>{var x,j,S,E,O;if(!(a||!((x=n==null?void 0:n.entity)!=null&&x.name))){if(((j=n==null?void 0:n.entity)==null?void 0:j.provider)!==nn.WebLLM){o({hasCache:!0,isFunctionCalling:!0,info:{model_id:(S=n==null?void 0:n.entity)==null?void 0:S.name,model:(E=n==null?void 0:n.entity)==null?void 0:E.name,model_lib:(O=n==null?void 0:n.entity)==null?void 0:O.provider,model_type:2}});return}At(()=>import("./index-CuU07XIu.js").then(async M=>(await M.__tla,M)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:M,functionCallingModelIds:N,prebuiltAppConfig:P})=>{var k,C;const I=await M((k=n==null?void 0:n.entity)==null?void 0:k.name);o({hasCache:I,isFunctionCalling:N.includes((C=n==null?void 0:n.entity)==null?void 0:C.name),info:P.model_list.find(A=>{var T;return A.model_id===((T=n==null?void 0:n.entity)==null?void 0:T.name)})})})}},[(m=n==null?void 0:n.entity)==null?void 0:m.name,(v=n==null?void 0:n.entity)==null?void 0:v.provider,a]);const p=g.useMemo(()=>{var x,j;switch(n.status){case Xe.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Xe.Loaded:return h.jsx(ka,{name:((x=n.entity)==null?void 0:x.name)||"brain",className:"w-7 h-7"});case Xe.Loading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(ka,{name:((j=n.entity)==null?void 0:j.name)||"brain",className:"w-7 h-7"})}},[(b=n.entity)==null?void 0:b.name,n.status]),y=g.useMemo(()=>f?null:d?h.jsx(ut,{disabled:!0,className:"w-full mt-4",children:h.jsx(de,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===Xe.Loaded?h.jsx(ut,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Vn,{loading:l,onClick:u,children:h.jsx(de,{size:24,name:"message-square-more"})}):null,h.jsx(ut,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[f,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ia,{className:"flex justify-center",children:[p,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Co,{className:"flex gap-2 items-center pr-6",children:`${((w=n==null?void 0:n.entity)==null?void 0:w.name)||""}`}),h.jsx(zc,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(_d,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(_=n==null?void 0:n.entity)==null?void 0:_.name,isCached:(a==null?void 0:a.hasCache)||!1})}),y]})]}),f?h.jsx(Aj,{className:"rounded-lg"}):void 0]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),Um=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Pe("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(Gt,{className:"min-w-80",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_message_card.title")})}),h.jsxs($n,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(bv,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),jS=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===oe.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==oe.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&jS(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},SS=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const f=t.getNode(d.source);return f?{connections:t.getHandleConnections({nodeId:f.id,type:"target"}),node:f}:void 0}),a=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:f})});const i=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);f!=null&&f.find(y=>y.type===oe.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:f})});const c=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);f&&l.push({node:d.node,connections:d.connections,connectedNodes:f})});const u=r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},ES=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===oe.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Pr(c.content));break;case"ai":t.push(new Uo(c.content));break}}else if(r.type===oe.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===rr.FewShotExample){const u=(s=(i=a.find(d=>d.type===oe.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=bK(u.headers,u.csv);d.forEach(f=>{l+=`${c.content.replace(/{([^{}]*)}/g,(p,y)=>`${f[y]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Pr(l));break;case"system":t.push(new Mg(l));break;default:t.push(new Uo(l));break}}}}),t},uB=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===oe.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:ES(n),systems:ES(r)}},dB=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===oe.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],OS=({getNode:e,getHandleConnections:t})=>{const{t:n}=Pe("create_new_message"),[r,a]=g.useState(!1),o=Qe(y=>y.currentSession),i=De(y=>y.createOrUpdateFlowNode),s=De(y=>y.createOrUpdateFlowEdge),c=Ss(y=>y.similaritySearchWithScore),{stream:l}=kc(),u=g.useCallback(async({content:y,threadId:m,sourceId:v,initialX:b,initialY:w,initialLLMId:_})=>{if(!o)throw new Error("Session is not found");const x=await ue("Message").save({thread_id:m,content:y,role:nr.Human,status:Ga.Started,llm_id:_,session_id:o.id});if(!x)throw new Error("Failed to save message");const j=await i({source_id:x.id,source_type:"Message",node_type:oe.Message,x:b,y:w+80});if(!j)throw new Error("Failed to save human message node");await s({source:v,target:j.id});const S=await ue("Message").save({thread_id:m,content:n("initial_ai_message"),role:nr.AI,status:Ga.Inprogress,llm_id:_,parent_message_id:x.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const E=await i({source_id:S.id,source_type:"Message",node_type:oe.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:j.id,target:E.id}),{aiMessage:S,humanMessage:x,aiMessageNode:E,humanMessageNode:j}},[s,i,o,n]),d=g.useCallback(async(y,m)=>{const{placeholders:v}=m;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,j,S,E,O,M,N,P,I,k,C,A;const _=(x=w.node.data)==null?void 0:x.entity;if(_)switch(_.placeholder_type){case Ts.VECTOR_DATABASE_RETREIVER:{const T=(j=w.connectedNodes)==null?void 0:j.find(U=>U.type===oe.VectorDatabase),D=(S=T==null?void 0:T.data)==null?void 0:S.entity,L=(M=(O=(E=w.connectedNodes)==null?void 0:E.find(U=>U.type===oe.Prompt))==null?void 0:O.data)==null?void 0:M.entity;if(!L||!D||!T)return;const R=(N=_.metadata)!=null&&N.k?+((P=_.metadata)==null?void 0:P.k):1;let F=(I=_.metadata)!=null&&I.minimalScore?+((k=_.metadata)==null?void 0:k.minimalScore):void 0;F&&F>1&&(F=F/100);const V=[];if(D.storage===kr.DataNode){const U=(A=(C=t({nodeId:T.id,type:"target"}).map(z=>e(z.source)).find(z=>(z==null?void 0:z.type)&&[oe.JSONLData,oe.CSVData].includes(z==null?void 0:z.type)))==null?void 0:C.data)==null?void 0:A.entity;if(!U)return;V.push(...await c({databaseId:D.id,dataSourceId:U.id,dataSourceType:ON(U)},y.humanMessage.content,R))}else V.push(...await c({databaseId:D.id},y.humanMessage.content,R));if(!V)return[];const $=new Ho({template:L.content,inputVariables:["context"]});b.push(new Uo(await $.format({context:F?V.filter(([,U])=>U>=F).map(([U])=>U.pageContent).join(`
`):V.map(([U])=>U.pageContent).join(`
`)})))}}})),b},[t,e,c]),f=g.useCallback(async(y,m,v,{onMessageUpdate:b})=>{var A;const{prompts:w,tools:_,schemas:x,placeholders:j,llm:S}=m,E=(A=S==null?void 0:S.node.data)==null?void 0:A.entity;if(!E)throw new Error("LLM is not found");const O=[];j!=null&&j.length&&O.push(...await d(y,m));const{history:M,systems:N}=uB(v,w),P=[...N,...O,...M,new Pr(y.humanMessage.content)],I=x.map(T=>{var D;return(D=T.node.data)==null?void 0:D.entity}).filter(Boolean),{lastChunk:k,content:C}=await l(E.provider,P,{tools:dB(_),schemas:I,llm:E,onMessageUpdate:({content:T})=>{b==null||b({id:y.aiMessageNode.id,nodeData:{loading:!0,content:T}})}});return y.aiMessage.content=C,y.aiMessage.metadata=JSON.stringify({message:k}),b==null||b({id:y.aiMessageNode.id,nodeData:{content:C,loading:!1,entity:y.aiMessage}}),y.aiMessage.id&&await ue("Message").update(y.aiMessage.id,{content:C,metadata:JSON.stringify({message:k})}),C},[d,l]),p=g.useCallback(async(y,m,v)=>{var S,E,O;const{nodes:b}=jS([y.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(M=>M.type===oe.Thread),_=w==null?void 0:w.data.entity;if(!y||!_||!w)throw new Error("Source or thread is not found");const x=SS(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let j;try{a(!0);const M=((S=y.position)==null?void 0:S.x)||0,N=(((E=y.position)==null?void 0:E.y)||0)+(((O=y.measured)==null?void 0:O.height)||0);return j=await u({content:m,initialX:M,initialY:N,sourceId:y.id,threadId:_.id,initialLLMId:_.initial_llm_id}),await f(j,x,b,v),await ue("Message").update(`${j.aiMessage.id}`,{status:Ga.Success}),j.aiMessage.status=Ga.Success,v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{entity:j.aiMessage,loading:!1}}),!0}catch{j!=null&&j.aiMessage&&await ue("Message").update(`${j.aiMessage.id}`,{status:Ga.Failed,content:n("errors.ai_message_content_failed")}),j!=null&&j.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),loading:!1}}))}finally{a(!1)}},[t,e,u,f,n]);return{loading:r,createMessage:p}},fB=(e,t)=>{const n=Tn(e),{t:r}=Pe("flows"),{getNode:a,getHandleConnections:o}=lr(),i=De(f=>f.updateNodes),{createMessage:s,loading:c}=OS({getNode:a,getHandleConnections:o}),l=g.useCallback(f=>{if(!f.id)return;const p=a(f.id);!p||!f.nodeData||i([{id:p.id,type:"replace",item:{...p,data:{...p.data,...Pu(f.nodeData,ku)}}}])},[a,i]),u=g.useCallback(async f=>{if(n&&t.entity)try{await s(n,f,{onMessageUpdate:l})}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return Al({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});Al({variant:"destructive",title:`${p}`})}},[n,t.entity,s,l,r]),d=g.useCallback(f=>{const p=a(f);if(!p)return[];const y=[],m=SS(p,{getNode:a,getHandleConnections:o});return m.thread&&y.push({node:m.thread.node,connectedNodes:[],connections:m.thread.connections}),m.prompts&&y.push(...m.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),m.schemas&&y.push(...m.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),m.placeholders&&m.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);y.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),m.llm&&y.push(m.llm),y},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},pB=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.ToolDefinition&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.VectorDatabase&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.PlaceHolder&&(o==null?void 0:o.type)===oe.Thread&&a.data.entity.placeholder_type===Ts.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},hB=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows"),[o,i]=g.useState(!1),s=Dh({type:"source"}),c=Dh({type:"target"}),{getNode:l}=lr(),{loading:u,createMessage:d,getLinkedConnections:f}=fB(t,n);pB(t);const p=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),y=g.useMemo(()=>s.length>0,[s]),m=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,_;const b=c.map((x,j)=>{var E;const S=l(x.source);if((S==null?void 0:S.type)===oe.Schema)return h.jsx(un,{children:a("thread_node.structured_output")},`${j}`);if((S==null?void 0:S.type)===oe.Prompt){const O=S.data.entity;return h.jsx(un,{children:a(O.type===rr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${j}`)}else if((S==null?void 0:S.type)===oe.PlaceHolder&&((E=S.data.entity)==null?void 0:E.placeholder_type)===Ts.VECTOR_DATABASE_RETREIVER)return h.jsx(un,{children:a("thread_node.vector_database_retriever")},`${j}`)}).filter(Boolean);return e.data.entity&&!((_=(w=e.data.entity)==null?void 0:w.messages)!=null&&_.length)&&!y?h.jsx(Um,{disabled:u,loading:u,onSubmit:p,tags:b}):b!=null&&b.length?h.jsxs(Gt,{className:"p-4 pt-2",children:[h.jsx(Kn,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(ut,{onClick:m,variant:"outline",children:[h.jsx(de,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[y,l,p,m,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t,enableToStandalone:!0,getLinkedConnections:f}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Um,{disabled:u,loading:u,onSubmit:p})})})]}):void 0]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})});function Eve({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Pe("flows");return h.jsxs(Ia,{className:"flex min-w-52",children:[h.jsx(de,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Co,{children:"Human"}),h.jsx(zc,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}const Ove=g.lazy(()=>At(()=>import("./index-C1fFSMf1.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function Cve({data:e,onNewThread:t,loading:n,showThread:r}){var i,s,c,l,u,d,f,p;const{t:a}=Pe("flows"),o=g.useMemo(()=>{var y;try{return JSON.parse(((y=e==null?void 0:e.entity)==null?void 0:y.metadata)||"{}")}catch{return{}}},[(i=e==null?void 0:e.entity)==null?void 0:i.metadata]);return h.jsxs(Ia,{className:"flex min-w-52",children:[h.jsx(de,{className:G(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(de,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Co,{children:a(`message_node.message_roles.${(c=(s=e.entity)==null?void 0:s.role)==null?void 0:c.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(Ove,{className:"!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",source:`${e.content||((l=e.entity)==null?void 0:l.content)||""}`,style:{color:"unset !important"}})}),Array.isArray((u=o==null?void 0:o.message)==null?void 0:u.tool_calls)&&((f=(d=o==null?void 0:o.message)==null?void 0:d.tool_calls)!=null&&f.length)?(p=o==null?void 0:o.message)==null?void 0:p.tool_calls.map((y,m)=>h.jsx(un,{children:a("message_node.tool_call",{name:y.name,args:Object.entries(y.args).map(([v,b])=>`"${v}": "${b}"`).join(", ")})},`${y.name}_${m}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(Aj,{size:350,duration:10}):void 0]})}const Nve=e=>{const{t}=Pe("flows"),n=Tn(e),r=De(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=lr(),{createMessage:i,loading:s}=OS({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...Pu(u.nodeData,ku)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return Al({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});Al({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},mB=()=>{const e=Qe(r=>r.currentSession),t=De(r=>r.createOrUpdateFlowNode),n=De(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var y,m,v,b,w;if(!r||!a||!e)return;const s=(m=(y=i==null?void 0:i.promptNode)==null?void 0:y.data)==null?void 0:m.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await ue("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||nr.Human,status:Ga.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:oe.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const f=await n({source:r.id,target:d.id});let p;return i!=null&&i.promptNode&&(p=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:p,messageNode:d,messageEdge:f}},[t,n])}},Mve=e=>{const{createIdieMessage:t}=mB(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:Hf.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Pve=g.memo(e=>{var _,x,j;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Pe("common"),l=Dh({type:"source"}),{loading:u,createMessage:d}=Nve(t),{toast:f}=tn();Mve(t);const p=g.useCallback(async(...S)=>{const E=await d(...S);return o(!1),E},[d]),y=g.useMemo(()=>l.length===0,[l]),m=g.useCallback(()=>{var S;(S=n.entity)!=null&&S.content&&(navigator.clipboard.writeText(n.entity.content),f({description:c("copied")}))},[f,n,c]),v=g.useCallback(async()=>{var S;try{if(i)return await SN.stop(),s(!1);s(!0),await SN.speak(((S=n.entity)==null?void 0:S.content)||"")}catch{f({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,f]),b=g.useCallback(()=>{o(S=>!S)},[]),w=g.useMemo(()=>{var S;if(!(!y&&!a||n.loading||u||((S=n==null?void 0:n.entity)==null?void 0:S.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Um,{disabled:u,loading:u,onSubmit:p})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,p,y,u,a]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Nn,{id:t}),h.jsx("div",{children:((j=n.entity)==null?void 0:j.role)===nr.Human?h.jsx(Eve,{data:n,showThread:a,onNewThread:y?void 0:b}):h.jsx(Cve,{data:n,showThread:a,loading:u,onNewThread:y?void 0:b})}),h.jsx(ut,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:i?"circle-stop":"speech",size:16})}),h.jsx(ut,{onClick:m,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:"copy",size:16})})]}),w]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),kve=e=>{const t=De(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=mB(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,f=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===oe.Message&&(i==null?void 0:i.type)===oe.Prompt){const p=(l=o==null?void 0:o.data)==null?void 0:l.entity,y=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!y||!p||!i)return{deleteEdgeId:a};await n(o,{id:p==null?void 0:p.thread_id,title:"",status:Hf.Started,initial_llm_id:p.llm_id,session_id:y.session_id},y.content,{promptNode:i});return}else if((o==null?void 0:o.type)===oe.CSVData&&(i==null?void 0:i.type)===oe.Prompt&&(d==null?void 0:d.type)===rr.FewShotExample&&(f!=null&&f.headers.includes("input"))&&(f!=null&&f.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);An(e,r)},Ave=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;kve(t);const a=Yt(T$),o=g.useMemo(()=>{var f,p,y;return`${(f=n.entity)!=null&&f.prefix?`${(p=n.entity)==null?void 0:p.prefix}
`:""}${((y=n.entity)==null?void 0:y.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var p;const f=/{(.*?)}/g;return((p=o.match(f))==null?void 0:p.map(y=>y.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ia,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(de,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Co,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(zc,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(de,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((f,p)=>h.jsx(un,{className:"mt-2 mr-1",variant:"default",children:f},p)):void 0]})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})});var Tve=KR();const xr=ot(Tve);var CS,yB;function Ive(){if(yB)return CS;yB=1;function e(t){return t==null}return CS=e,CS}var Rve=Ive();const gt=ot(Rve);var NS,gB;function Dve(){if(gB)return NS;gB=1;var e=po(),t=In(),n=pa(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return NS=a,NS}var Lve=Dve();const kd=ot(Lve);var $ve=Ff();const tt=ot($ve);var Fve=Tr();const Vc=ot(Fve);var vB={exports:{}},vt={},bB;function Bve(){if(bB)return vt;bB=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),y;y=Symbol.for("react.module.reference");function m(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case f:case d:case o:return v;default:return b}}case t:return b}}}return vt.ContextConsumer=i,vt.ContextProvider=o,vt.Element=e,vt.ForwardRef=c,vt.Fragment=n,vt.Lazy=f,vt.Memo=d,vt.Portal=t,vt.Profiler=a,vt.StrictMode=r,vt.Suspense=l,vt.SuspenseList=u,vt.isAsyncMode=function(){return!1},vt.isConcurrentMode=function(){return!1},vt.isContextConsumer=function(v){return m(v)===i},vt.isContextProvider=function(v){return m(v)===o},vt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},vt.isForwardRef=function(v){return m(v)===c},vt.isFragment=function(v){return m(v)===n},vt.isLazy=function(v){return m(v)===f},vt.isMemo=function(v){return m(v)===d},vt.isPortal=function(v){return m(v)===t},vt.isProfiler=function(v){return m(v)===a},vt.isStrictMode=function(v){return m(v)===r},vt.isSuspense=function(v){return m(v)===l},vt.isSuspenseList=function(v){return m(v)===u},vt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===p||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===y||v.getModuleId!==void 0)},vt.typeOf=m,vt}var wB;function zve(){return wB||(wB=1,vB.exports=Bve()),vB.exports}var Vve=zve(),MS,xB;function _B(){if(xB)return MS;xB=1;var e=po(),t=pa(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return MS=r,MS}var PS,jB;function Uve(){if(jB)return PS;jB=1;var e=_B();function t(n){return e(n)&&n!=+n}return PS=t,PS}var Wve=Uve();const Ad=ot(Wve);var Hve=_B();const qve=ot(Hve);var oa=function(e){return e===0?0:e>0?1:-1},is=function(e){return kd(e)&&e.indexOf("%")===e.length-1},ye=function(e){return qve(e)&&!Ad(e)},sn=function(e){return ye(e)||kd(e)},Kve=0,Wm=function(e){var t=++Kve;return"".concat(e||"").concat(t)},ss=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!kd(e))return n;var a;if(is(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return Ad(a)&&(a=n),r&&a>t&&(a=t),a},yi=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Yve=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},Uc=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function kS(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):xr(r,t))===n})}function Wc(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function AS(e){"@babel/helpers - typeof";return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AS(e)}var Gve=["viewBox","children"],Xve=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],SB=["points","pathLength"],TS={svg:Gve,polygon:SB,polyline:SB},IS=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Hm=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!Vc(n))return null;var r={};return Object.keys(n).forEach(function(a){IS.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},Zve=function(e,t,n){return function(r){return e(t,n,r),null}},qm=function(e,t,n){if(!Vc(e)||AS(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];IS.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=Zve(o,t,n))}),r},Jve=["children"],Qve=["children"];function EB(e,t){if(e==null)return{};var n=e0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function e0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var OB={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Mo=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},CB=null,RS=null,DS=function e(t){if(t===CB&&Array.isArray(RS))return RS;var n=[];return g.Children.forEach(t,function(r){gt(r)||(Vve.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),RS=n,CB=t,n};function ia(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Mo(a)}):r=[Mo(t)],DS(e).forEach(function(a){var o=xr(a,"type.displayName")||xr(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function pr(e,t){var n=ia(e,t);return n&&n[0]}var NB=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},t0e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],n0e=function(e){return e&&e.type&&kd(e.type)&&t0e.indexOf(e.type)>=0},r0e=function(e,t,n,r){var a,o=(a=TS==null?void 0:TS[r])!==null&&a!==void 0?a:[];return!tt(e)&&(r&&o.includes(t)||Xve.includes(t))||n&&IS.includes(t)},yt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!Vc(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;r0e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},LS=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return MB(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!MB(o,i))return!1}return!0},MB=function(e,t){if(gt(e)&&gt(t))return!0;if(!gt(e)&&!gt(t)){var n=e.props||{},r=n.children,a=EB(n,Jve),o=t.props||{},i=o.children,s=EB(o,Qve);return r&&i?Wc(a,s)&&LS(r,i):!r&&!i?Wc(a,s):!1}return!1},PB=function(e,t){var n=[],r={};return DS(e).forEach(function(a,o){if(n0e(a))n.push(a);else if(a){var i=Mo(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},a0e=function(e){var t=e&&e.type;return t&&OB[t]?OB[t]:null},o0e=function(e,t){return DS(t).indexOf(e)},i0e=["children","width","height","viewBox","className","style","title","desc"];function $S(){return $S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$S.apply(this,arguments)}function s0e(e,t){if(e==null)return{};var n=c0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function FS(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=s0e(e,i0e),u=a||{width:n,height:r,x:0,y:0},d=xt("recharts-surface",o);return H.createElement("svg",$S({},yt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),H.createElement("title",null,s),H.createElement("desc",null,c),t)}var l0e=["children","className"];function BS(){return BS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BS.apply(this,arguments)}function u0e(e,t){if(e==null)return{};var n=d0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var pn=H.forwardRef(function(e,t){var n=e.children,r=e.className,a=u0e(e,l0e),o=xt("recharts-layer",r);return H.createElement("g",BS({className:o},yt(a,!0),{ref:t}),n)}),Po=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},zS,kB;function f0e(){if(kB)return zS;kB=1;var e=Av();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return zS=t,zS}var VS,AB;function TB(){if(AB)return VS;AB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return VS=c,VS}var US,IB;function p0e(){if(IB)return US;IB=1;function e(t){return t.split("")}return US=e,US}var WS,RB;function h0e(){if(RB)return WS;RB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",f="[\uD800-\uDBFF][\uDC00-\uDFFF]",p="\\u200d",y=l+"?",m="["+o+"]?",v="(?:"+p+"(?:"+[u,d,f].join("|")+")"+m+y+")*",b=m+y+v,w="(?:"+[u+s+"?",s,d,f,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+b,"g");function x(j){return j.match(_)||[]}return WS=x,WS}var HS,DB;function m0e(){if(DB)return HS;DB=1;var e=p0e(),t=TB(),n=h0e();function r(a){return t(a)?n(a):e(a)}return HS=r,HS}var qS,LB;function y0e(){if(LB)return qS;LB=1;var e=f0e(),t=TB(),n=m0e(),r=VR();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return qS=a,qS}var KS,$B;function g0e(){if($B)return KS;$B=1;var e=y0e(),t=e("toUpperCase");return KS=t,KS}var v0e=g0e();const Km=ot(v0e);function It(e){return function(){return e}}const FB=Math.cos,Ym=Math.sin,sa=Math.sqrt,Gm=Math.PI,Xm=2*Gm,YS=Math.PI,GS=2*YS,cs=1e-6,b0e=GS-cs;function BB(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function w0e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return BB;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class x0e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?BB:w0e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>cs)if(!(Math.abs(d*c-l*u)>cs)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-i,y=a-s,m=c*c+l*l,v=p*p+y*y,b=Math.sqrt(m),w=Math.sqrt(f),_=o*Math.tan((YS-Math.acos((m+f-v)/(2*b*w)))/2),x=_/w,j=_/b;Math.abs(x-1)>cs&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*p>u*y)},${this._x1=t+j*c},${this._y1=n+j*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,f=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>cs||Math.abs(this._y1-u)>cs)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%GS+GS),f>b0e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:f>cs&&this._append`A${r},${r},0,${+(f>=YS)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function XS(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new x0e(t)}function ZS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function zB(e){this._context=e}zB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Zm(e){return new zB(e)}function VB(e){return e[0]}function UB(e){return e[1]}function WB(e,t){var n=It(!0),r=null,a=Zm,o=null,i=XS(s);e=typeof e=="function"?e:e===void 0?VB:It(e),t=typeof t=="function"?t:t===void 0?UB:It(t);function s(c){var l,u=(c=ZS(c)).length,d,f=!1,p;for(r==null&&(o=a(p=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(d,l,c),+t(d,l,c));if(p)return o=null,p+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:It(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:It(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:It(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Jm(e,t,n){var r=null,a=It(!0),o=null,i=Zm,s=null,c=XS(l);e=typeof e=="function"?e:e===void 0?VB:It(+e),t=typeof t=="function"?t:It(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?UB:It(+n);function l(d){var f,p,y,m=(d=ZS(d)).length,v,b=!1,w,_=new Array(m),x=new Array(m);for(o==null&&(s=i(w=c())),f=0;f<=m;++f){if(!(f<m&&a(v=d[f],f,d))===b)if(b=!b)p=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),y=f-1;y>=p;--y)s.point(_[y],x[y]);s.lineEnd(),s.areaEnd()}b&&(_[f]=+e(v,f,d),x[f]=+t(v,f,d),s.point(r?+r(v,f,d):_[f],n?+n(v,f,d):x[f]))}if(w)return s=null,w+""||null}function u(){return WB().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:It(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:It(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:It(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class HB{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function _0e(e){return new HB(e,!0)}function j0e(e){return new HB(e,!1)}const JS={draw(e,t){const n=sa(t/Gm);e.moveTo(n,0),e.arc(0,0,n,0,Xm)}},S0e={draw(e,t){const n=sa(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},qB=sa(1/3),E0e=qB*2,O0e={draw(e,t){const n=sa(t/E0e),r=n*qB;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},C0e={draw(e,t){const n=sa(t),r=-n/2;e.rect(r,r,n,n)}},N0e=.8908130915292852,KB=Ym(Gm/10)/Ym(7*Gm/10),M0e=Ym(Xm/10)*KB,P0e=-FB(Xm/10)*KB,k0e={draw(e,t){const n=sa(t*N0e),r=M0e*n,a=P0e*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Xm*o/5,s=FB(i),c=Ym(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},QS=sa(3),A0e={draw(e,t){const n=-sa(t/(QS*3));e.moveTo(0,n*2),e.lineTo(-QS*n,-n),e.lineTo(QS*n,-n),e.closePath()}},_r=-.5,jr=sa(3)/2,eE=1/sa(12),T0e=(eE/2+1)*3,I0e={draw(e,t){const n=sa(t/T0e),r=n/2,a=n*eE,o=r,i=n*eE+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(_r*r-jr*a,jr*r+_r*a),e.lineTo(_r*o-jr*i,jr*o+_r*i),e.lineTo(_r*s-jr*c,jr*s+_r*c),e.lineTo(_r*r+jr*a,_r*a-jr*r),e.lineTo(_r*o+jr*i,_r*i-jr*o),e.lineTo(_r*s+jr*c,_r*c-jr*s),e.closePath()}};function R0e(e,t){let n=null,r=XS(a);e=typeof e=="function"?e:It(e||JS),t=typeof t=="function"?t:It(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:It(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:It(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function Qm(){}function ey(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function YB(e){this._context=e}YB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ey(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function D0e(e){return new YB(e)}function GB(e){this._context=e}GB.prototype={areaStart:Qm,areaEnd:Qm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function L0e(e){return new GB(e)}function XB(e){this._context=e}XB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $0e(e){return new XB(e)}function ZB(e){this._context=e}ZB.prototype={areaStart:Qm,areaEnd:Qm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function F0e(e){return new ZB(e)}function JB(e){return e<0?-1:1}function QB(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(JB(o)+JB(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function ez(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function tE(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function ty(e){this._context=e}ty.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tE(this,this._t0,ez(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,tE(this,ez(this,n=QB(this,e,t)),n);break;default:tE(this,this._t0,n=QB(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function tz(e){this._context=new nz(e)}(tz.prototype=Object.create(ty.prototype)).point=function(e,t){ty.prototype.point.call(this,t,e)};function nz(e){this._context=e}nz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function B0e(e){return new ty(e)}function z0e(e){return new tz(e)}function rz(e){this._context=e}rz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=az(e),a=az(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function az(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function V0e(e){return new rz(e)}function ny(e,t){this._context=e,this._t=t}ny.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function U0e(e){return new ny(e,.5)}function W0e(e){return new ny(e,0)}function H0e(e){return new ny(e,1)}function Hc(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function nE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function q0e(e,t){return e[t]}function K0e(e){const t=[];return t.key=e,t}function Y0e(){var e=It([]),t=nE,n=Hc,r=q0e;function a(o){var i=Array.from(e.apply(this,arguments),K0e),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=ZS(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:It(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:It(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?nE:typeof o=="function"?o:It(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??Hc,a):n},a}function G0e(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}Hc(e,t)}}function X0e(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}Hc(e,t)}}function Z0e(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,p=(d-f)/2,y=0;y<s;++y){var m=e[t[y]],v=m[r][1]||0,b=m[r-1][1]||0;p+=v-b}c+=d,l+=p*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,Hc(e,t)}}function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}var J0e=["type","size","sizeType"];function rE(){return rE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rE.apply(this,arguments)}function oz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oz(Object(n),!0).forEach(function(r){Q0e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Q0e(e,t,n){return t=ebe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ebe(e){var t=tbe(e,"string");return Td(t)=="symbol"?t:t+""}function tbe(e,t){if(Td(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Td(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nbe(e,t){if(e==null)return{};var n=rbe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var sz={symbolCircle:JS,symbolCross:S0e,symbolDiamond:O0e,symbolSquare:C0e,symbolStar:k0e,symbolTriangle:A0e,symbolWye:I0e},abe=Math.PI/180,obe=function(e){var t="symbol".concat(Km(e));return sz[t]||JS},ibe=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*abe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},sbe=function(e,t){sz["symbol".concat(Km(e))]=t},aE=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=nbe(e,J0e),c=iz(iz({},s),{},{type:n,size:a,sizeType:i}),l=function(){var y=obe(n),m=R0e().type(y).size(ibe(a,i,n));return m()},u=c.className,d=c.cx,f=c.cy,p=yt(c,!0);return d===+d&&f===+f&&a===+a?H.createElement("path",rE({},p,{className:xt("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};aE.registerSymbol=sbe;function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function oE(){return oE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oE.apply(this,arguments)}function cz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cbe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cz(Object(n),!0).forEach(function(r){Id(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ube(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uz(r.key),r)}}function dbe(e,t,n){return t&&ube(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fbe(e,t,n){return t=ry(t),pbe(e,lz()?Reflect.construct(t,n||[],ry(e).constructor):t.apply(e,n))}function pbe(e,t){if(t&&(qc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hbe(e)}function hbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lz=function(){return!!e})()}function ry(e){return ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ry(e)}function mbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iE(e,t)}function iE(e,t){return iE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},iE(e,t)}function Id(e,t,n){return t=uz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uz(e){var t=ybe(e,"string");return qc(t)=="symbol"?t:t+""}function ybe(e,t){if(qc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(qc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sr=32,sE=function(e){function t(){return lbe(this,t),fbe(this,t,arguments)}return mbe(t,e),dbe(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Sr/2,o=Sr/6,i=Sr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return H.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Sr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return H.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Sr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return H.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Sr/8,"h").concat(Sr,"v").concat(Sr*3/4,"h").concat(-Sr,"z"),className:"recharts-legend-icon"});if(H.isValidElement(n.legendIcon)){var c=cbe({},n);return delete c.legendIcon,H.cloneElement(n.legendIcon,c)}return H.createElement(aE,{fill:s,cx:a,cy:a,size:Sr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Sr,height:Sr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(f,p){var y=f.formatter||s,m=xt(Id(Id({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=tt(f.value)?null:f.value;Po(!tt(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return H.createElement("li",oE({className:m,style:u,key:"legend-item-".concat(p)},qm(n.props,f,p)),H.createElement(FS,{width:o,height:o,viewBox:l,style:d},n.renderIcon(f)),H.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(v,f,p):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return H.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);Id(sE,"displayName","Legend"),Id(sE,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var cE,dz;function fz(){if(dz)return cE;dz=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return cE=e,cE}var lE,pz;function gbe(){if(pz)return lE;pz=1;function e(t){return t!==t}return lE=e,lE}var uE,hz;function vbe(){if(hz)return uE;hz=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return uE=e,uE}var dE,mz;function bbe(){if(mz)return dE;mz=1;var e=fz(),t=gbe(),n=vbe();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return dE=r,dE}var fE,yz;function wbe(){if(yz)return fE;yz=1;var e=bbe();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return fE=t,fE}var pE,gz;function xbe(){if(gz)return pE;gz=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return pE=e,pE}var hE,vz;function _be(){if(vz)return hE;vz=1;function e(){}return hE=e,hE}var mE,bz;function jbe(){if(bz)return mE;bz=1;var e=xR(),t=_be(),n=Ew(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return mE=a,mE}var yE,wz;function Sbe(){if(wz)return yE;wz=1;var e=PI(),t=wbe(),n=xbe(),r=II(),a=jbe(),o=Ew(),i=200;function s(c,l,u){var d=-1,f=t,p=c.length,y=!0,m=[],v=m;if(u)y=!1,f=n;else if(p>=i){var b=l?null:a(c);if(b)return o(b);y=!1,f=r,v=new e}else v=l?[]:m;e:for(;++d<p;){var w=c[d],_=l?l(w):w;if(w=u||w!==0?w:0,y&&_===_){for(var x=v.length;x--;)if(v[x]===_)continue e;l&&v.push(_),m.push(w)}else f(v,_,u)||(v!==m&&v.push(_),m.push(w))}return m}return yE=s,yE}var gE,xz;function Ebe(){if(xz)return gE;xz=1;var e=xa(),t=Sbe();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return gE=n,gE}var Obe=Ebe();const _z=ot(Obe);function jz(e,t,n){return t===!0?_z(e,n):tt(t)?_z(e,t):e}function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}var Cbe=["ref"];function Sz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sz(Object(n),!0).forEach(function(r){oy(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Nbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ez(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cz(r.key),r)}}function Mbe(e,t,n){return t&&Ez(e.prototype,t),n&&Ez(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pbe(e,t,n){return t=ay(t),kbe(e,Oz()?Reflect.construct(t,n||[],ay(e).constructor):t.apply(e,n))}function kbe(e,t){if(t&&(Kc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Abe(e)}function Abe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oz=function(){return!!e})()}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ay(e)}function Tbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vE(e,t)}function vE(e,t){return vE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},vE(e,t)}function oy(e,t,n){return t=Cz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cz(e){var t=Ibe(e,"string");return Kc(t)=="symbol"?t:t+""}function Ibe(e,t){if(Kc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rbe(e,t){if(e==null)return{};var n=Dbe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Lbe(e){return e.value}function $be(e,t){if(H.isValidElement(e))return H.cloneElement(e,t);if(typeof e=="function")return H.createElement(e,t);t.ref;var n=Rbe(t,Cbe);return H.createElement(sE,n)}var Nz=1,Yc=function(e){function t(){var n;Nbe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=Pbe(this,t,[].concat(a)),oy(n,"lastBoundingBox",{width:-1,height:-1}),n}return Tbe(t,e),Mbe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>Nz||Math.abs(r.height-this.lastBoundingBox.height)>Nz)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ko({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var f=this.getBBoxSnapshot();u={left:((c||0)-f.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var p=this.getBBoxSnapshot();d={top:((l||0)-p.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return ko(ko({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=ko(ko({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return H.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},$be(a,ko(ko({},this.props),{},{payload:jz(l,c,Lbe)})))}}],[{key:"getWithHeight",value:function(n,r){var a=ko(ko({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);oy(Yc,"displayName","Legend"),oy(Yc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var bE,Mz;function Fbe(){if(Mz)return bE;Mz=1;var e=Ps(),t=$f(),n=In(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return bE=a,bE}var wE,Pz;kg=function(){if(Pz)return wE;Pz=1;var e=Nw(),t=Fbe();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return wE=n,wE};var xE,kz;function Bbe(){if(kz)return xE;kz=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return xE=e,xE}var _E,Az;kN=function(){if(Az)return _E;Az=1;var e=Bbe(),t=e();return _E=t,_E};var jE,Tz;function Iz(){if(Tz)return jE;Tz=1;var e=kN(),t=zl();function n(r,a){return r&&e(r,a,t)}return jE=n,jE}var SE,Rz;function zbe(){if(Rz)return SE;Rz=1;var e=Ni();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return SE=t,SE}var EE,Dz;function OE(){if(Dz)return EE;Dz=1;var e=Iz(),t=zbe(),n=t(e);return EE=n,EE}var CE,Lz;function $z(){if(Lz)return CE;Lz=1;var e=OE(),t=Ni();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return CE=n,CE}var NE,Fz;function Vbe(){if(Fz)return NE;Fz=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return NE=e,NE}var ME,Bz;function Ube(){if(Bz)return ME;Bz=1;var e=Js();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return ME=t,ME}var PE,zz;function Wbe(){if(zz)return PE;zz=1;var e=Ube();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return PE=t,PE}var kE,Vz;function Hbe(){if(Vz)return kE;Vz=1;var e=Tl(),t=Wl(),n=xa(),r=$z(),a=Vbe(),o=Mv(),i=Wbe(),s=Qs(),c=In();function l(u,d,f){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var p=-1;d=e(d,o(n));var y=r(u,function(m,v,b){var w=e(d,function(_){return _(m)});return{criteria:w,index:++p,value:m}});return a(y,function(m,v){return i(m,v,f)})}return kE=l,kE}var AE,Uz;FN=function(){if(Uz)return AE;Uz=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return AE=e,AE};var TE,Wz;PN=function(){if(Wz)return TE;Wz=1;var e=FN(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return TE=n,TE};var IE,Hz;function qbe(){if(Hz)return IE;Hz=1;function e(t){return function(){return t}}return IE=e,IE}var RE,qz;function Kbe(){if(qz)return RE;qz=1;var e=qbe(),t=oD(),n=Qs(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return RE=r,RE}var DE,Kz;function Ybe(){if(Kz)return DE;Kz=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return DE=r,DE}var LE,Yz;MN=function(){if(Yz)return LE;Yz=1;var e=Kbe(),t=Ybe(),n=t(e);return LE=n,LE};var $E,Gz;AN=function(){if(Gz)return $E;Gz=1;var e=Qs(),t=PN(),n=MN();function r(a,o){return n(t(a,o,e),a+"")}return $E=r,$E};var FE,Xz;function Gbe(){if(Xz)return FE;Xz=1;var e=kg(),t=Hbe(),n=AN(),r=Es(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return FE=a,FE}var Xbe=Gbe();const BE=ot(Xbe);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function zE(){return zE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zE.apply(this,arguments)}function Zbe(e,t){return twe(e)||ewe(e,t)||Qbe(e,t)||Jbe()}function Jbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qbe(e,t){if(e){if(typeof e=="string")return Zz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zz(e,t)}}function Zz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ewe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function twe(e){if(Array.isArray(e))return e}function Jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function VE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jz(Object(n),!0).forEach(function(r){nwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nwe(e,t,n){return t=rwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rwe(e){var t=awe(e,"string");return Rd(t)=="symbol"?t:t+""}function awe(e,t){if(Rd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function owe(e){return Array.isArray(e)&&sn(e[0])&&sn(e[1])?e.join(" ~ "):e}var iwe=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,y=e.label,m=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var N={padding:0,margin:0},P=(d?BE(l,d):l).map(function(I,k){if(I.type==="none")return null;var C=VE({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},i),A=I.formatter||u||owe,T=I.value,D=I.name,L=T,R=D;if(A&&L!=null&&R!=null){var F=A(T,D,I,k,l);if(Array.isArray(F)){var V=Zbe(F,2);L=V[0],R=V[1]}else L=F}return H.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(k),style:C},sn(R)?H.createElement("span",{className:"recharts-tooltip-item-name"},R):null,sn(R)?H.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,H.createElement("span",{className:"recharts-tooltip-item-value"},L),H.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return H.createElement("ul",{className:"recharts-tooltip-item-list",style:N},P)}return null},_=VE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=VE({margin:0},c),j=!gt(y),S=j?y:"",E=xt("recharts-default-tooltip",f),O=xt("recharts-tooltip-label",p);j&&m&&l!==void 0&&l!==null&&(S=m(y,l));var M=b?{role:"status","aria-live":"assertive"}:{};return H.createElement("div",zE({className:E,style:_},M),H.createElement("p",{className:O,style:x},H.isValidElement(S)?S:"".concat(S)),w())};function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function iy(e,t,n){return t=swe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function swe(e){var t=cwe(e,"string");return Dd(t)=="symbol"?t:t+""}function cwe(e,t){if(Dd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Dd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ld="recharts-tooltip-wrapper",lwe={visibility:"hidden"};function uwe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return xt(Ld,iy(iy(iy(iy({},"".concat(Ld,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(Ld,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(Ld,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(Ld,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function Qz(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var f=u,p=c[r];return f<p?Math.max(d,c[r]):Math.max(u,c[r])}var y=d+s,m=c[r]+l;return y>m?Math.max(u,c[r]):Math.max(d,c[r])}function dwe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function fwe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=Qz({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=Qz({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=dwe({translateX:u,translateY:d,useTranslate3d:s})):l=lwe,{cssProperties:l,cssClasses:uwe({translateX:u,translateY:d,coordinate:n})}}function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function e7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function t7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(n),!0).forEach(function(r){WE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hwe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r7(r.key),r)}}function mwe(e,t,n){return t&&hwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ywe(e,t,n){return t=sy(t),gwe(e,n7()?Reflect.construct(t,n||[],sy(e).constructor):t.apply(e,n))}function gwe(e,t){if(t&&(Gc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vwe(e)}function vwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n7=function(){return!!e})()}function sy(e){return sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sy(e)}function bwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UE(e,t)}function UE(e,t){return UE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},UE(e,t)}function WE(e,t,n){return t=r7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r7(e){var t=wwe(e,"string");return Gc(t)=="symbol"?t:t+""}function wwe(e,t){if(Gc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a7=1,xwe=function(e){function t(){var n;pwe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=ywe(this,t,[].concat(a)),WE(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),WE(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return bwe(t,e),mwe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>a7||Math.abs(n.height-this.state.lastBoundingBox.height)>a7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,f=r.offset,p=r.position,y=r.reverseDirection,m=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=fwe({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:f,position:p,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:v}),_=w.cssClasses,x=w.cssProperties,j=t7(t7({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return H.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(S){n.wrapperNode=S}},c)}}])}(g.PureComponent),_we=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},gi={isSsr:_we(),get:function(e){return gi[e]},set:function(e,t){if(typeof e=="string")gi[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){gi[r]=e[r]})}}};function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function o7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function i7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(n),!0).forEach(function(r){qE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Swe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c7(r.key),r)}}function Ewe(e,t,n){return t&&Swe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Owe(e,t,n){return t=cy(t),Cwe(e,s7()?Reflect.construct(t,n||[],cy(e).constructor):t.apply(e,n))}function Cwe(e,t){if(t&&(Xc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nwe(e)}function Nwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s7=function(){return!!e})()}function cy(e){return cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cy(e)}function Mwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HE(e,t)}function HE(e,t){return HE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},HE(e,t)}function qE(e,t,n){return t=c7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c7(e){var t=Pwe(e,"string");return Xc(t)=="symbol"?t:t+""}function Pwe(e,t){if(Xc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kwe(e){return e.dataKey}function Awe(e,t){return H.isValidElement(e)?H.cloneElement(e,t):typeof e=="function"?H.createElement(e,t):H.createElement(iwe,t)}var Ra=function(e){function t(){return jwe(this,t),Owe(this,t,arguments)}return Mwe(t,e),Ewe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,f=r.offset,p=r.payload,y=r.payloadUniqBy,m=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,_=r.wrapperStyle,x=p??[];u&&x.length&&(x=jz(p.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),y,kwe));var j=x.length>0;return H.createElement(xwe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:j,offset:f,position:m,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:_},Awe(c,i7(i7({},this.props),{},{payload:x})))}}])}(g.PureComponent);qE(Ra,"displayName","Tooltip"),qE(Ra,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!gi.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var KE,l7;function Twe(){if(l7)return KE;l7=1;var e=Ar(),t=function(){return e.Date.now()};return KE=t,KE}var YE,u7;DN=function(){if(u7)return YE;u7=1;var e=Tr(),t=Twe(),n=F$(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,f,p,y,m,v=0,b=!1,w=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,f=w?a(n(l.maxWait)||0,c):f,_="trailing"in l?!!l.trailing:_);function x(k){var C=u,A=d;return u=d=void 0,v=k,p=s.apply(A,C),p}function j(k){return v=k,y=setTimeout(O,c),b?x(k):p}function S(k){var C=k-m,A=k-v,T=c-C;return w?o(T,f-A):T}function E(k){var C=k-m,A=k-v;return m===void 0||C>=c||C<0||w&&A>=f}function O(){var k=t();if(E(k))return M(k);y=setTimeout(O,S(k))}function M(k){return y=void 0,_&&u?x(k):(u=d=void 0,p)}function N(){y!==void 0&&clearTimeout(y),v=0,u=m=d=y=void 0}function P(){return y===void 0?p:M(t())}function I(){var k=t(),C=E(k);if(u=arguments,d=this,m=k,C){if(y===void 0)return j(m);if(w)return clearTimeout(y),y=setTimeout(O,c),x(m)}return y===void 0&&(y=setTimeout(O,c)),p}return I.cancel=N,I.flush=P,I}return YE=i,YE};var GE,d7;function Iwe(){if(d7)return GE;d7=1;var e=DN(),t=Tr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return GE=r,GE}var Rwe=Iwe();Ig=ot(Rwe);function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function f7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ly(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f7(Object(n),!0).forEach(function(r){Dwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Dwe(e,t,n){return t=Lwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lwe(e){var t=$we(e,"string");return $d(t)=="symbol"?t:t+""}function $we(e,t){if($d(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($d(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fwe(e,t){return Uwe(e)||Vwe(e,t)||zwe(e,t)||Bwe()}function Bwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(e,t){if(e){if(typeof e=="string")return p7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p7(e,t)}}function p7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vwe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Uwe(e){if(Array.isArray(e))return e}var Wwe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,f=e.maxHeight,p=e.children,y=e.debounce,m=y===void 0?0:y,v=e.id,b=e.className,w=e.onResize,_=e.style,x=_===void 0?{}:_,j=g.useRef(null),S=g.useRef();S.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=Fwe(E,2),M=O[0],N=O[1],P=g.useCallback(function(k,C){N(function(A){var T=Math.round(k),D=Math.round(C);return A.containerWidth===T&&A.containerHeight===D?A:{containerWidth:T,containerHeight:D}})},[]);g.useEffect(function(){var k=function(L){var R,F=L[0].contentRect,V=F.width,$=F.height;P(V,$),(R=S.current)===null||R===void 0||R.call(S,V,$)};m>0&&(k=Ig(k,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(k),A=j.current.getBoundingClientRect(),T=A.width,D=A.height;return P(T,D),C.observe(j.current),function(){C.disconnect()}},[P,m]);var I=g.useMemo(function(){var k=M.containerWidth,C=M.containerHeight;if(k<0||C<0)return null;Po(is(i)||is(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Po(!n||n>0,"The aspect(%s) must be greater than zero.",n);var A=is(i)?k:i,T=is(c)?C:c;n&&n>0&&(A?T=A/n:T&&(A=T*n),f&&T>f&&(T=f)),Po(A>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,A,T,i,c,u,d,n);var D=!Array.isArray(p)&&Mo(p.type).endsWith("Chart");return H.Children.map(p,function(L){return H.isValidElement(L)?g.cloneElement(L,ly({width:A,height:T},D?{style:ly({height:"100%",width:"100%",maxHeight:T,maxWidth:A},L.props.style)}:{})):L})},[n,p,c,f,d,u,M,i]);return H.createElement("div",{id:v?"".concat(v):void 0,className:xt("recharts-responsive-container",b),style:ly(ly({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:f}),ref:j},I)}),h7=function(e){return null};h7.displayName="Cell";function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function m7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function XE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m7(Object(n),!0).forEach(function(r){Hwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hwe(e,t,n){return t=qwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qwe(e){var t=Kwe(e,"string");return Fd(t)=="symbol"?t:t+""}function Kwe(e,t){if(Fd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zc={widthCache:{},cacheCount:0},Ywe=2e3,Gwe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},y7="recharts_measurement_span";function Xwe(e){var t=XE({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Bd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||gi.isSsr)return{width:0,height:0};var n=Xwe(t),r=JSON.stringify({text:e,copyStyle:n});if(Zc.widthCache[r])return Zc.widthCache[r];try{var a=document.getElementById(y7);a||(a=document.createElement("span"),a.setAttribute("id",y7),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=XE(XE({},Gwe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return Zc.widthCache[r]=s,++Zc.cacheCount>Ywe&&(Zc.cacheCount=0,Zc.widthCache={}),s}catch{return{width:0,height:0}}},Zwe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function uy(e,t){return txe(e)||exe(e,t)||Qwe(e,t)||Jwe()}function Jwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qwe(e,t){if(e){if(typeof e=="string")return g7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g7(e,t)}}function g7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function exe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function txe(e){if(Array.isArray(e))return e}function nxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,axe(r.key),r)}}function rxe(e,t,n){return t&&v7(e.prototype,t),n&&v7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function axe(e){var t=oxe(e,"string");return zd(t)=="symbol"?t:t+""}function oxe(e,t){if(zd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(zd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var b7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,w7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ixe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,sxe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,x7={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},cxe=Object.keys(x7),Jc="NaN";function lxe(e,t){return e*x7[t]}var dy=function(){function e(t,n){nxe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!ixe.test(n)&&(this.num=NaN,this.unit=""),cxe.includes(n)&&(this.num=lxe(t,n),this.unit="px")}return rxe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=sxe.exec(t))!==null&&n!==void 0?n:[],a=uy(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function _7(e){if(e.includes(Jc))return Jc;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=b7.exec(t))!==null&&n!==void 0?n:[],a=uy(r,4),o=a[1],i=a[2],s=a[3],c=dy.parse(o??""),l=dy.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return Jc;t=t.replace(b7,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,f=(d=w7.exec(t))!==null&&d!==void 0?d:[],p=uy(f,4),y=p[1],m=p[2],v=p[3],b=dy.parse(y??""),w=dy.parse(v??""),_=m==="+"?b.add(w):b.subtract(w);if(_.isNaN())return Jc;t=t.replace(w7,_.toString())}return t}var j7=/\(([^()]*)\)/;function uxe(e){for(var t=e;t.includes("(");){var n=j7.exec(t),r=uy(n,2),a=r[1];t=t.replace(j7,_7(a))}return t}function dxe(e){var t=e.replace(/\s+/g,"");return t=uxe(t),t=_7(t),t}function fxe(e){try{return dxe(e)}catch{return Jc}}function ZE(e){var t=fxe(e.slice(5,-1));return t===Jc?"":t}var pxe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],hxe=["dx","dy","angle","className","breakAll"];function JE(){return JE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JE.apply(this,arguments)}function S7(e,t){if(e==null)return{};var n=mxe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mxe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function E7(e,t){return bxe(e)||vxe(e,t)||gxe(e,t)||yxe()}function yxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxe(e,t){if(e){if(typeof e=="string")return O7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O7(e,t)}}function O7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vxe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function bxe(e){if(Array.isArray(e))return e}var C7=/[ \f\n\r\t\v\u2028\u2029]+/,N7=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];gt(t)||(n?a=t.toString().split(""):a=t.toString().split(C7));var o=a.map(function(s){return{word:s,width:Bd(s,r).width}}),i=n?0:Bd("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},wxe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return k.reduce(function(C,A){var T=A.word,D=A.width,L=C[C.length-1];if(L&&(r==null||a||L.width+D+n<Number(r)))L.words.push(T),L.width+=D+n;else{var R={words:[T],width:D};C.push(R)}return C},[])},f=d(t),p=function(k){return k.reduce(function(C,A){return C.width>A.width?C:A})};if(!l)return f;for(var y="\u2026",m=function(k){var C=u.slice(0,k),A=N7({breakAll:c,style:s,children:C+y}).wordsWithComputedWidth,T=d(A),D=T.length>o||p(T).width>Number(r);return[D,T]},v=0,b=u.length-1,w=0,_;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),j=x-1,S=m(j),E=E7(S,2),O=E[0],M=E[1],N=m(x),P=E7(N,1),I=P[0];if(!O&&!I&&(v=x+1),O&&I&&(b=x-1),!O&&I){_=M;break}w++}return _||f},M7=function(e){var t=gt(e)?[]:e.toString().split(C7);return[{words:t}]},xxe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!gi.isSsr){var s,c,l=N7({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return M7(r);return wxe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return M7(r)},P7="#808080",fy=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,f=d===void 0?"start":d,p=e.verticalAnchor,y=p===void 0?"end":p,m=e.fill,v=m===void 0?P7:m,b=S7(e,pxe),w=g.useMemo(function(){return xxe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,x=b.dy,j=b.angle,S=b.className,E=b.breakAll,O=S7(b,hxe);if(!sn(n)||!sn(a))return null;var M=n+(ye(_)?_:0),N=a+(ye(x)?x:0),P;switch(y){case"start":P=ZE("calc(".concat(c,")"));break;case"middle":P=ZE("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:P=ZE("calc(".concat(w.length-1," * -").concat(i,")"));break}var I=[];if(u){var k=w[0].width,C=b.width;I.push("scale(".concat((ye(C)?C/k:1)/k,")"))}return j&&I.push("rotate(".concat(j,", ").concat(M,", ").concat(N,")")),I.length&&(O.transform=I.join(" ")),H.createElement("text",JE({},yt(O,!0),{x:M,y:N,className:xt("recharts-text",S),textAnchor:f,fill:v.includes("url")?P7:v}),w.map(function(A,T){var D=A.words.join(E?"":" ");return H.createElement("tspan",{x:M,dy:T===0?P:i,key:"".concat(D,"-").concat(T)},D)}))};function vi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _xe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function QE(e){let t,n,r;e.length!==2?(t=vi,n=(s,c)=>vi(e(s),c),r=(s,c)=>e(s)-c):(t=e===vi||e===_xe?e:jxe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function jxe(){return 0}function k7(e){return e===null?NaN:+e}function*Sxe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Exe=QE(vi),Vd=Exe.right;QE(k7).center;class A7 extends Map{constructor(t,n=Nxe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(T7(this,t))}has(t){return super.has(T7(this,t))}set(t,n){return super.set(Oxe(this,t),n)}delete(t){return super.delete(Cxe(this,t))}}function T7({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Oxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Cxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Nxe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Mxe(e=vi){if(e===vi)return I7;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function I7(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Pxe=Math.sqrt(50),kxe=Math.sqrt(10),Axe=Math.sqrt(2);function py(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=Pxe?10:o>=kxe?5:o>=Axe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?py(e,t,n*2):[s,c,l]}function eO(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?py(t,e,n):py(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function tO(e,t,n){return t=+t,e=+e,n=+n,py(e,t,n)[2]}function nO(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?tO(t,e,n):tO(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function R7(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function D7(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function L7(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?I7:Mxe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),p=Math.max(n,Math.floor(t-l*d/c+f)),y=Math.min(r,Math.floor(t+(c-l)*d/c+f));L7(e,t,p,y,a)}const o=e[t];let i=n,s=r;for(Ud(e,n,t),a(e[r],o)>0&&Ud(e,n,r);i<s;){for(Ud(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?Ud(e,n,s):(++s,Ud(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Ud(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Txe(e,t,n){if(e=Float64Array.from(Sxe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return D7(e);if(t>=1)return R7(e);var r,a=(r-1)*t,o=Math.floor(a),i=R7(L7(e,o).subarray(0,o+1)),s=D7(e.subarray(o+1));return i+(s-i)*(a-o)}}function Ixe(e,t,n=k7){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function Rxe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function Er(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ao(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rO=Symbol("implicit");function aO(){var e=new A7,t=[],n=[],r=rO;function a(o){let i=e.get(o);if(i===void 0){if(r!==rO)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new A7;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return aO(t,n).unknown(r)},Er.apply(a,arguments),a}function Wd(){var e=aO().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var f=t().length,p=a<r,y=p?a:r,m=p?r:a;o=(m-y)/Math.max(1,f-c+l*2),s&&(o=Math.floor(o)),y+=(m-y-o*(f-c))*u,i=o*(1-c),s&&(y=Math.round(y),i=Math.round(i));var v=Rxe(f).map(function(b){return y+o*b});return n(p?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,a]=f,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(f){return[r,a]=f,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),d()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return Wd(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},Er.apply(d(),arguments)}function $7(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $7(t())},e}function Hd(){return $7(Wd.apply(null,arguments).paddingInner(1))}function Dxe(e){return function(){return e}}function hy(e){return+e}var F7=[0,1];function Bn(e){return e}function oO(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Dxe(isNaN(t)?NaN:.5)}function Lxe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function $xe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=oO(a,r),o=n(i,o)):(r=oO(r,a),o=n(o,i)),function(s){return o(r(s))}}function Fxe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=oO(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=Vd(e,s,1,r)-1;return o[c](a[c](s))}}function qd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function my(){var e=F7,t=F7,n=rc,r,a,o,i=Bn,s,c,l;function u(){var f=Math.min(e.length,t.length);return i!==Bn&&(i=Lxe(e[0],e[f-1])),s=f>2?Fxe:$xe,c=l=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=s(e.map(r),t,n)))(r(i(f)))}return d.invert=function(f){return i(a((l||(l=s(t,e.map(r),Ur)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,hy),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=s1,u()},d.clamp=function(f){return arguments.length?(i=f?!0:Bn,u()):i!==Bn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,p){return r=f,a=p,u()}}function iO(){return my()(Bn,Bn)}function Bxe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Qc(e){return e=yy(Math.abs(e)),e?e[1]:NaN}function zxe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function Vxe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Uxe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kd(e){if(!(t=Uxe.exec(e)))throw new Error("invalid format: "+e);var t;return new sO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Kd.prototype=sO.prototype;function sO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}sO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wxe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var B7;function Hxe(e,t){var n=yy(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(B7=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+yy(e,Math.max(0,t+o-1))[0]}function z7(e,t){var n=yy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const V7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Bxe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>z7(e*100,t),r:z7,s:Hxe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function U7(e){return e}var W7=Array.prototype.map,H7=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function qxe(e){var t=e.grouping===void 0||e.thousands===void 0?U7:zxe(W7.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?U7:Vxe(W7.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Kd(d);var f=d.fill,p=d.align,y=d.sign,m=d.symbol,v=d.zero,b=d.width,w=d.comma,_=d.precision,x=d.trim,j=d.type;j==="n"?(w=!0,j="g"):V7[j]||(_===void 0&&(_=12),x=!0,j="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",E=m==="$"?r:/[%p]/.test(j)?i:"",O=V7[j],M=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function N(P){var I=S,k=E,C,A,T;if(j==="c")k=O(P)+k,P="";else{P=+P;var D=P<0||1/P<0;if(P=isNaN(P)?c:O(Math.abs(P),_),x&&(P=Wxe(P)),D&&+P==0&&y!=="+"&&(D=!1),I=(D?y==="("?y:s:y==="-"||y==="("?"":y)+I,k=(j==="s"?H7[8+B7/3]:"")+k+(D&&y==="("?")":""),M){for(C=-1,A=P.length;++C<A;)if(T=P.charCodeAt(C),48>T||T>57){k=(T===46?a+P.slice(C+1):P.slice(C))+k,P=P.slice(0,C);break}}}w&&!v&&(P=t(P,1/0));var L=I.length+P.length+k.length,R=L<b?new Array(b-L+1).join(f):"";switch(w&&v&&(P=t(R+P,R.length?b-k.length:1/0),R=""),p){case"<":P=I+P+k+R;break;case"=":P=I+R+P+k;break;case"^":P=R.slice(0,L=R.length>>1)+I+P+k+R.slice(L);break;default:P=R+I+P+k;break}return o(P)}return N.toString=function(){return d+""},N}function u(d,f){var p=l((d=Kd(d),d.type="f",d)),y=Math.max(-8,Math.min(8,Math.floor(Qc(f)/3)))*3,m=Math.pow(10,-y),v=H7[8+y/3];return function(b){return p(m*b)+v}}return{format:l,formatPrefix:u}}var gy,cO,q7;Kxe({thousands:",",grouping:[3],currency:["$",""]});function Kxe(e){return gy=qxe(e),cO=gy.format,q7=gy.formatPrefix,gy}function Yxe(e){return Math.max(0,-Qc(Math.abs(e)))}function Gxe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qc(t)/3)))*3-Qc(Math.abs(e)))}function Xxe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Qc(t)-Qc(e))+1}function K7(e,t,n,r){var a=nO(e,t,n),o;switch(r=Kd(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=Gxe(a,i))&&(r.precision=o),q7(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Xxe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Yxe(a))&&(r.precision=o-(r.type==="%")*2);break}}return cO(r)}function bi(e){var t=e.domain;return e.ticks=function(n){var r=t();return eO(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return K7(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=tO(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function vy(){var e=iO();return e.copy=function(){return qd(e,vy())},Er.apply(e,arguments),bi(e)}function Y7(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,hy),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Y7(e).unknown(t)},e=arguments.length?Array.from(e,hy):[0,1],bi(n)}function G7(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function X7(e){return Math.log(e)}function Z7(e){return Math.exp(e)}function Zxe(e){return-Math.log(-e)}function Jxe(e){return-Math.exp(-e)}function Qxe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function e1e(e){return e===10?Qxe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function t1e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function J7(e){return(t,n)=>-e(-t,n)}function lO(e){const t=e(X7,Z7),n=t.domain;let r=10,a,o;function i(){return a=t1e(r),o=e1e(r),n()[0]<0?(a=J7(a),o=J7(o),e(Zxe,Jxe)):e(X7,Z7),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let f=a(l),p=a(u),y,m;const v=s==null?10:+s;let b=[];if(!(r%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),l>0){for(;f<=p;++f)for(y=1;y<r;++y)if(m=f<0?y/o(-f):y*o(f),!(m<l)){if(m>u)break;b.push(m)}}else for(;f<=p;++f)for(y=r-1;y>=1;--y)if(m=f>0?y/o(-f):y*o(f),!(m<l)){if(m>u)break;b.push(m)}b.length*2<v&&(b=eO(l,u,v))}else b=eO(f,p,Math.min(p-f,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Kd(c)).precision==null&&(c.trim=!0),c=cO(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(G7(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function Q7(){const e=lO(my()).domain([1,10]);return e.copy=()=>qd(e,Q7()).base(e.base()),Er.apply(e,arguments),e}function eV(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function tV(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function uO(e){var t=1,n=e(eV(t),tV(t));return n.constant=function(r){return arguments.length?e(eV(t=+r),tV(t)):t},bi(n)}function nV(){var e=uO(my());return e.copy=function(){return qd(e,nV()).constant(e.constant())},Er.apply(e,arguments)}function rV(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function n1e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function r1e(e){return e<0?-e*e:e*e}function dO(e){var t=e(Bn,Bn),n=1;function r(){return n===1?e(Bn,Bn):n===.5?e(n1e,r1e):e(rV(n),rV(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},bi(t)}function fO(){var e=dO(my());return e.copy=function(){return qd(e,fO()).exponent(e.exponent())},Er.apply(e,arguments),e}function a1e(){return fO.apply(null,arguments).exponent(.5)}function aV(e){return Math.sign(e)*e*e}function o1e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oV(){var e=iO(),t=[0,1],n=!1,r;function a(o){var i=o1e(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(aV(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,hy)).map(aV)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return oV(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Er.apply(a,arguments),bi(a)}function iV(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=Ixe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[Vd(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(vi),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return iV().domain(e).range(t).unknown(r)},Er.apply(o,arguments)}function sV(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[Vd(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return sV().domain([e,t]).range(a).unknown(o)},Er.apply(bi(i),arguments)}function cV(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[Vd(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return cV().domain(e).range(t).unknown(n)},Er.apply(a,arguments)}const pO=new Date,hO=new Date;function cn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>cn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(pO.setTime(+o),hO.setTime(+i),e(pO),e(hO),Math.floor(n(pO,hO))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const by=cn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);by.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):by),by.range;const To=1e3,Or=To*60,Io=Or*60,Ro=Io*24,mO=Ro*7,lV=Ro*30,yO=Ro*365,ls=cn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*To)},(e,t)=>(t-e)/To,e=>e.getUTCSeconds());ls.range;const gO=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*To)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getMinutes());gO.range;const vO=cn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getUTCMinutes());vO.range;const bO=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*To-e.getMinutes()*Or)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getHours());bO.range;const wO=cn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getUTCHours());wO.range;const Yd=cn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Or)/Ro,e=>e.getDate()-1);Yd.range;const wy=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>e.getUTCDate()-1);wy.range;const uV=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>Math.floor(e/Ro));uV.range;function us(e){return cn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Or)/mO)}const xy=us(0),_y=us(1),i1e=us(2),s1e=us(3),el=us(4),c1e=us(5),l1e=us(6);xy.range,_y.range,i1e.range,s1e.range,el.range,c1e.range,l1e.range;function ds(e){return cn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/mO)}const jy=ds(0),Sy=ds(1),u1e=ds(2),d1e=ds(3),tl=ds(4),f1e=ds(5),p1e=ds(6);jy.range,Sy.range,u1e.range,d1e.range,tl.range,f1e.range,p1e.range;const xO=cn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xO.range;const _O=cn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());_O.range;const Do=cn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Do.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Do.range;const Lo=cn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Lo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Lo.range;function dV(e,t,n,r,a,o){const i=[[ls,1,To],[ls,5,5*To],[ls,15,15*To],[ls,30,30*To],[o,1,Or],[o,5,5*Or],[o,15,15*Or],[o,30,30*Or],[a,1,Io],[a,3,3*Io],[a,6,6*Io],[a,12,12*Io],[r,1,Ro],[r,2,2*Ro],[n,1,mO],[t,1,lV],[t,3,3*lV],[e,1,yO]];function s(l,u,d){const f=u<l;f&&([l,u]=[u,l]);const p=d&&typeof d.range=="function"?d:c(l,u,d),y=p?p.range(l,+u+1):[];return f?y.reverse():y}function c(l,u,d){const f=Math.abs(u-l)/d,p=QE(([,,v])=>v).right(i,f);if(p===i.length)return e.every(nO(l/yO,u/yO,d));if(p===0)return by.every(Math.max(nO(l,u,d),1));const[y,m]=i[f/i[p-1][2]<i[p][2]/f?p-1:p];return y.every(m)}return[s,c]}const[h1e,m1e]=dV(Lo,_O,jy,uV,wO,vO),[y1e,g1e]=dV(Do,xO,xy,Yd,bO,gO);function jO(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function SO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Gd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function v1e(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Xd(a),u=Zd(a),d=Xd(o),f=Zd(o),p=Xd(i),y=Zd(i),m=Xd(s),v=Zd(s),b=Xd(c),w=Zd(c),_={a:D,A:L,b:R,B:F,c:null,d:gV,e:gV,f:z1e,g:Z1e,G:Q1e,H:$1e,I:F1e,j:B1e,L:vV,m:V1e,M:U1e,p:V,q:$,Q:SV,s:EV,S:W1e,u:H1e,U:q1e,V:K1e,w:Y1e,W:G1e,x:null,X:null,y:X1e,Y:J1e,Z:e_e,"%":jV},x={a:U,A:z,b:K,B:ne,c:null,d:wV,e:wV,f:a_e,g:h_e,G:y_e,H:t_e,I:n_e,j:r_e,L:xV,m:o_e,M:i_e,p:Q,q:Y,Q:SV,s:EV,S:s_e,u:c_e,U:l_e,V:u_e,w:d_e,W:f_e,x:null,X:null,y:p_e,Y:m_e,Z:g_e,"%":jV},j={a:N,A:P,b:I,B:k,c:C,d:mV,e:mV,f:I1e,g:hV,G:pV,H:yV,I:yV,j:P1e,L:T1e,m:M1e,M:k1e,p:M,q:N1e,Q:D1e,s:L1e,S:A1e,u:j1e,U:S1e,V:E1e,w:_1e,W:O1e,x:A,X:T,y:hV,Y:pV,Z:C1e,"%":R1e};_.x=S(n,_),_.X=S(r,_),_.c=S(t,_),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(q,X){return function(te){var B=[],ce=-1,re=0,le=q.length,je,Le,$e;for(te instanceof Date||(te=new Date(+te));++ce<le;)q.charCodeAt(ce)===37&&(B.push(q.slice(re,ce)),(Le=fV[je=q.charAt(++ce)])!=null?je=q.charAt(++ce):Le=je==="e"?" ":"0",($e=X[je])&&(je=$e(te,Le)),B.push(je),re=ce+1);return B.push(q.slice(re,ce)),B.join("")}}function E(q,X){return function(te){var B=Gd(1900,void 0,1),ce=O(B,q,te+="",0),re,le;if(ce!=te.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(X&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(re=SO(Gd(B.y,0,1)),le=re.getUTCDay(),re=le>4||le===0?Sy.ceil(re):Sy(re),re=wy.offset(re,(B.V-1)*7),B.y=re.getUTCFullYear(),B.m=re.getUTCMonth(),B.d=re.getUTCDate()+(B.w+6)%7):(re=jO(Gd(B.y,0,1)),le=re.getDay(),re=le>4||le===0?_y.ceil(re):_y(re),re=Yd.offset(re,(B.V-1)*7),B.y=re.getFullYear(),B.m=re.getMonth(),B.d=re.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),le="Z"in B?SO(Gd(B.y,0,1)).getUTCDay():jO(Gd(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(le+5)%7:B.w+B.U*7-(le+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,SO(B)):jO(B)}}function O(q,X,te,B){for(var ce=0,re=X.length,le=te.length,je,Le;ce<re;){if(B>=le)return-1;if(je=X.charCodeAt(ce++),je===37){if(je=X.charAt(ce++),Le=j[je in fV?X.charAt(ce++):je],!Le||(B=Le(q,te,B))<0)return-1}else if(je!=te.charCodeAt(B++))return-1}return B}function M(q,X,te){var B=l.exec(X.slice(te));return B?(q.p=u.get(B[0].toLowerCase()),te+B[0].length):-1}function N(q,X,te){var B=p.exec(X.slice(te));return B?(q.w=y.get(B[0].toLowerCase()),te+B[0].length):-1}function P(q,X,te){var B=d.exec(X.slice(te));return B?(q.w=f.get(B[0].toLowerCase()),te+B[0].length):-1}function I(q,X,te){var B=b.exec(X.slice(te));return B?(q.m=w.get(B[0].toLowerCase()),te+B[0].length):-1}function k(q,X,te){var B=m.exec(X.slice(te));return B?(q.m=v.get(B[0].toLowerCase()),te+B[0].length):-1}function C(q,X,te){return O(q,t,X,te)}function A(q,X,te){return O(q,n,X,te)}function T(q,X,te){return O(q,r,X,te)}function D(q){return i[q.getDay()]}function L(q){return o[q.getDay()]}function R(q){return c[q.getMonth()]}function F(q){return s[q.getMonth()]}function V(q){return a[+(q.getHours()>=12)]}function $(q){return 1+~~(q.getMonth()/3)}function U(q){return i[q.getUTCDay()]}function z(q){return o[q.getUTCDay()]}function K(q){return c[q.getUTCMonth()]}function ne(q){return s[q.getUTCMonth()]}function Q(q){return a[+(q.getUTCHours()>=12)]}function Y(q){return 1+~~(q.getUTCMonth()/3)}return{format:function(q){var X=S(q+="",_);return X.toString=function(){return q},X},parse:function(q){var X=E(q+="",!1);return X.toString=function(){return q},X},utcFormat:function(q){var X=S(q+="",x);return X.toString=function(){return q},X},utcParse:function(q){var X=E(q+="",!0);return X.toString=function(){return q},X}}}var fV={"-":"",_:" ",0:"0"},hn=/^\s*\d+/,b1e=/^%/,w1e=/[\\^$*+?|[\]().{}]/g;function ft(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function x1e(e){return e.replace(w1e,"\\$&")}function Xd(e){return new RegExp("^(?:"+e.map(x1e).join("|")+")","i")}function Zd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function _1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function j1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function S1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function E1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function O1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function pV(e,t,n){var r=hn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function hV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function C1e(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function N1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function M1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function mV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function P1e(e,t,n){var r=hn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function yV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function k1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function A1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function T1e(e,t,n){var r=hn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function I1e(e,t,n){var r=hn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function R1e(e,t,n){var r=b1e.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function D1e(e,t,n){var r=hn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function L1e(e,t,n){var r=hn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function gV(e,t){return ft(e.getDate(),t,2)}function $1e(e,t){return ft(e.getHours(),t,2)}function F1e(e,t){return ft(e.getHours()%12||12,t,2)}function B1e(e,t){return ft(1+Yd.count(Do(e),e),t,3)}function vV(e,t){return ft(e.getMilliseconds(),t,3)}function z1e(e,t){return vV(e,t)+"000"}function V1e(e,t){return ft(e.getMonth()+1,t,2)}function U1e(e,t){return ft(e.getMinutes(),t,2)}function W1e(e,t){return ft(e.getSeconds(),t,2)}function H1e(e){var t=e.getDay();return t===0?7:t}function q1e(e,t){return ft(xy.count(Do(e)-1,e),t,2)}function bV(e){var t=e.getDay();return t>=4||t===0?el(e):el.ceil(e)}function K1e(e,t){return e=bV(e),ft(el.count(Do(e),e)+(Do(e).getDay()===4),t,2)}function Y1e(e){return e.getDay()}function G1e(e,t){return ft(_y.count(Do(e)-1,e),t,2)}function X1e(e,t){return ft(e.getFullYear()%100,t,2)}function Z1e(e,t){return e=bV(e),ft(e.getFullYear()%100,t,2)}function J1e(e,t){return ft(e.getFullYear()%1e4,t,4)}function Q1e(e,t){var n=e.getDay();return e=n>=4||n===0?el(e):el.ceil(e),ft(e.getFullYear()%1e4,t,4)}function e_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ft(t/60|0,"0",2)+ft(t%60,"0",2)}function wV(e,t){return ft(e.getUTCDate(),t,2)}function t_e(e,t){return ft(e.getUTCHours(),t,2)}function n_e(e,t){return ft(e.getUTCHours()%12||12,t,2)}function r_e(e,t){return ft(1+wy.count(Lo(e),e),t,3)}function xV(e,t){return ft(e.getUTCMilliseconds(),t,3)}function a_e(e,t){return xV(e,t)+"000"}function o_e(e,t){return ft(e.getUTCMonth()+1,t,2)}function i_e(e,t){return ft(e.getUTCMinutes(),t,2)}function s_e(e,t){return ft(e.getUTCSeconds(),t,2)}function c_e(e){var t=e.getUTCDay();return t===0?7:t}function l_e(e,t){return ft(jy.count(Lo(e)-1,e),t,2)}function _V(e){var t=e.getUTCDay();return t>=4||t===0?tl(e):tl.ceil(e)}function u_e(e,t){return e=_V(e),ft(tl.count(Lo(e),e)+(Lo(e).getUTCDay()===4),t,2)}function d_e(e){return e.getUTCDay()}function f_e(e,t){return ft(Sy.count(Lo(e)-1,e),t,2)}function p_e(e,t){return ft(e.getUTCFullYear()%100,t,2)}function h_e(e,t){return e=_V(e),ft(e.getUTCFullYear()%100,t,2)}function m_e(e,t){return ft(e.getUTCFullYear()%1e4,t,4)}function y_e(e,t){var n=e.getUTCDay();return e=n>=4||n===0?tl(e):tl.ceil(e),ft(e.getUTCFullYear()%1e4,t,4)}function g_e(){return"+0000"}function jV(){return"%"}function SV(e){return+e}function EV(e){return Math.floor(+e/1e3)}var nl,OV,CV;v_e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function v_e(e){return nl=v1e(e),OV=nl.format,nl.parse,CV=nl.utcFormat,nl.utcParse,nl}function b_e(e){return new Date(e)}function w_e(e){return e instanceof Date?+e:+new Date(+e)}function EO(e,t,n,r,a,o,i,s,c,l){var u=iO(),d=u.invert,f=u.domain,p=l(".%L"),y=l(":%S"),m=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),_=l("%B"),x=l("%Y");function j(S){return(c(S)<S?p:s(S)<S?y:i(S)<S?m:o(S)<S?v:r(S)<S?a(S)<S?b:w:n(S)<S?_:x)(S)}return u.invert=function(S){return new Date(d(S))},u.domain=function(S){return arguments.length?f(Array.from(S,w_e)):f().map(b_e)},u.ticks=function(S){var E=f();return e(E[0],E[E.length-1],S??10)},u.tickFormat=function(S,E){return E==null?j:l(E)},u.nice=function(S){var E=f();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?f(G7(E,S)):u},u.copy=function(){return qd(u,EO(e,t,n,r,a,o,i,s,c,l))},u}function x_e(){return Er.apply(EO(y1e,g1e,Do,xO,xy,Yd,bO,gO,ls,OV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function __e(){return Er.apply(EO(h1e,m1e,Lo,_O,jy,wy,wO,vO,ls,CV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ey(){var e=0,t=1,n,r,a,o,i=Bn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(f){var p,y;return arguments.length?([p,y]=f,i=d(p,y),l):[i(0),i(1)]}}return l.range=u(rc),l.rangeRound=u(s1),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function wi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function NV(){var e=bi(Ey()(Bn));return e.copy=function(){return wi(e,NV())},Ao.apply(e,arguments)}function MV(){var e=lO(Ey()).domain([1,10]);return e.copy=function(){return wi(e,MV()).base(e.base())},Ao.apply(e,arguments)}function PV(){var e=uO(Ey());return e.copy=function(){return wi(e,PV()).constant(e.constant())},Ao.apply(e,arguments)}function OO(){var e=dO(Ey());return e.copy=function(){return wi(e,OO()).exponent(e.exponent())},Ao.apply(e,arguments)}function j_e(){return OO.apply(null,arguments).exponent(.5)}function kV(){var e=[],t=Bn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Vd(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(vi),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>Txe(e,o/r))},n.copy=function(){return kV(t).domain(e)},Ao.apply(n,arguments)}function Oy(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Bn,u,d=!1,f;function p(m){return isNaN(m=+m)?f:(m=.5+((m=+u(m))-o)*(r*m<r*o?s:c),l(d?Math.max(0,Math.min(1,m)):m))}p.domain=function(m){return arguments.length?([e,t,n]=m,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p):[e,t,n]},p.clamp=function(m){return arguments.length?(d=!!m,p):d},p.interpolator=function(m){return arguments.length?(l=m,p):l};function y(m){return function(v){var b,w,_;return arguments.length?([b,w,_]=v,l=Sae(m,[b,w,_]),p):[l(0),l(.5),l(1)]}}return p.range=y(rc),p.rangeRound=y(s1),p.unknown=function(m){return arguments.length?(f=m,p):f},function(m){return u=m,a=m(e),o=m(t),i=m(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p}}function AV(){var e=bi(Oy()(Bn));return e.copy=function(){return wi(e,AV())},Ao.apply(e,arguments)}function TV(){var e=lO(Oy()).domain([.1,1,10]);return e.copy=function(){return wi(e,TV()).base(e.base())},Ao.apply(e,arguments)}function IV(){var e=uO(Oy());return e.copy=function(){return wi(e,IV()).constant(e.constant())},Ao.apply(e,arguments)}function CO(){var e=dO(Oy());return e.copy=function(){return wi(e,CO()).exponent(e.exponent())},Ao.apply(e,arguments)}function S_e(){return CO.apply(null,arguments).exponent(.5)}const RV=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Wd,scaleDiverging:AV,scaleDivergingLog:TV,scaleDivergingPow:CO,scaleDivergingSqrt:S_e,scaleDivergingSymlog:IV,scaleIdentity:Y7,scaleImplicit:rO,scaleLinear:vy,scaleLog:Q7,scaleOrdinal:aO,scalePoint:Hd,scalePow:fO,scaleQuantile:iV,scaleQuantize:sV,scaleRadial:oV,scaleSequential:NV,scaleSequentialLog:MV,scaleSequentialPow:OO,scaleSequentialQuantile:kV,scaleSequentialSqrt:j_e,scaleSequentialSymlog:PV,scaleSqrt:a1e,scaleSymlog:nV,scaleThreshold:cV,scaleTime:x_e,scaleUtc:__e,tickFormat:K7},Symbol.toStringTag,{value:"Module"}));var NO,DV;function LV(){if(DV)return NO;DV=1;var e=Js();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return NO=t,NO}var MO,$V;function E_e(){if($V)return MO;$V=1;function e(t,n){return t>n}return MO=e,MO}var PO,FV;function O_e(){if(FV)return PO;FV=1;var e=LV(),t=E_e(),n=Qs();function r(a){return a&&a.length?e(a,n,t):void 0}return PO=r,PO}var C_e=O_e();const Cy=ot(C_e);var kO,BV;function N_e(){if(BV)return kO;BV=1;function e(t,n){return t<n}return kO=e,kO}var AO,zV;function M_e(){if(zV)return AO;zV=1;var e=LV(),t=N_e(),n=Qs();function r(a){return a&&a.length?e(a,n,t):void 0}return AO=r,AO}var P_e=M_e();const Ny=ot(P_e);var TO,VV;TN=function(){if(VV)return TO;VV=1;var e=Tl(),t=xa(),n=$z(),r=In();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return TO=a,TO};var IO,UV;function k_e(){if(UV)return IO;UV=1;var e=kg(),t=TN();function n(r,a){return e(t(r,a),1)}return IO=n,IO}var A_e=k_e();const T_e=ot(A_e);var RO,WV;function I_e(){if(WV)return RO;WV=1;var e=sx();function t(n,r){return e(n,r)}return RO=t,RO}var R_e=I_e();const DO=ot(R_e);var rl=1e9,D_e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},FO,Ft=!0,Cr="[DecimalError] ",fs=Cr+"Invalid argument: ",LO=Cr+"Exponent out of range: ",al=Math.floor,ps=Math.pow,L_e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hr,mn=1e7,Rt=7,HV=9007199254740991,My=al(HV/Rt),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Rt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return $o(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return Nt($o(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return Jt(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(hr))throw Error(Cr+"NaN");if(n.s<1)throw Error(Cr+(n.s?"NaN":"-Infinity"));return n.eq(hr)?new r(0):(Ft=!1,t=$o(Jd(n,o),Jd(e,o),o),Ft=!0,Nt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GV(t,e):qV(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Cr+"NaN");return n.s?(Ft=!1,t=$o(n,e,0,1).times(e),Ft=!0,n.minus(t)):Nt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return KV(this)},Ce.naturalLogarithm=Ce.ln=function(){return Jd(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?qV(t,e):GV(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(fs+e);if(t=Jt(a)+1,r=a.d.length-1,n=r*Rt+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Cr+"NaN")}for(e=Jt(s),Ft=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=La(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=al((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus($o(s,o,i+2)).times(.5),La(o.d).slice(0,i)===(t=La(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Nt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Ft=!0,Nt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,f=u.d,p=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=f.length,l=p.length,c<l&&(o=f,f=p,p=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+p[r]*f[a-r-1]+t,o[a--]=s%mn|0,t=s/mn|0;o[a]=(o[a]+t)%mn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Ft?Nt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Da(e,0,rl),t===void 0?t=r.rounding:Da(t,0,8),Nt(n,e+Jt(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=hs(r,!0):(Da(e,0,rl),t===void 0?t=a.rounding:Da(t,0,8),r=Nt(new a(r),e+1,t),n=hs(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?hs(a):(Da(e,0,rl),t===void 0?t=o.rounding:Da(t,0,8),r=Nt(new o(a),e+Jt(a)+1,t),n=hs(r.abs(),!1,e+Jt(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return Nt(new t(e),Jt(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(hr);if(s=new c(s),!s.s){if(e.s<1)throw Error(Cr+"Infinity");return s}if(s.eq(hr))return s;if(r=c.precision,e.eq(hr))return Nt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=HV){for(a=new c(hr),t=Math.ceil(r/Rt+4),Ft=!1;n%2&&(a=a.times(s),XV(a.d,t)),n=al(n/2),n!==0;)s=s.times(s),XV(s.d,t);return Ft=!0,e.s<0?new c(hr).div(a):Nt(a,r)}}else if(o<0)throw Error(Cr+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Ft=!1,a=e.times(Jd(s,r+l)),Ft=!0,a=KV(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=Jt(a),r=hs(a,n<=o.toExpNeg||n>=o.toExpPos)):(Da(e,1,rl),t===void 0?t=o.rounding:Da(t,0,8),a=Nt(new o(a),e,t),n=Jt(a),r=hs(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Da(e,1,rl),t===void 0?t=r.rounding:Da(t,0,8)),Nt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Jt(e),n=e.constructor;return hs(e,t<=n.toExpNeg||t>=n.toExpPos)};function qV(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ft?Nt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Rt),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/mn|0,c[o]%=mn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Ft?Nt(t,d):t}function Da(e,t,n){if(e!==~~e||e<t||e>n)throw Error(fs+e)}function La(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Rt-r.length,n&&(o+=xi(n)),o+=r;i=e[t],r=i+"",n=Rt-r.length,n&&(o+=xi(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var $o=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%mn|0,i=o/mn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*mn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,f,p,y,m,v,b,w,_,x,j,S,E,O,M=r.constructor,N=r.s==a.s?1:-1,P=r.d,I=a.d;if(!r.s)return new M(r);if(!a.s)throw Error(Cr+"Division by zero");for(c=r.e-a.e,E=I.length,j=P.length,p=new M(N),y=p.d=[],l=0;I[l]==(P[l]||0);)++l;if(I[l]>(P[l]||0)&&--c,o==null?w=o=M.precision:i?w=o+(Jt(r)-Jt(a))+1:w=o,w<0)return new M(0);if(w=w/Rt+2|0,l=0,E==1)for(u=0,I=I[0],w++;(l<j||u)&&w--;l++)_=u*mn+(P[l]||0),y[l]=_/I|0,u=_%I|0;else{for(u=mn/(I[0]+1)|0,u>1&&(I=e(I,u),P=e(P,u),E=I.length,j=P.length),x=E,m=P.slice(0,E),v=m.length;v<E;)m[v++]=0;O=I.slice(),O.unshift(0),S=I[0],I[1]>=mn/2&&++S;do u=0,s=t(I,m,E,v),s<0?(b=m[0],E!=v&&(b=b*mn+(m[1]||0)),u=b/S|0,u>1?(u>=mn&&(u=mn-1),d=e(I,u),f=d.length,v=m.length,s=t(d,m,f,v),s==1&&(u--,n(d,E<f?O:I,f))):(u==0&&(s=u=1),d=I.slice()),f=d.length,f<v&&d.unshift(0),n(m,d,v),s==-1&&(v=m.length,s=t(I,m,E,v),s<1&&(u++,n(m,E<v?O:I,v))),v=m.length):s===0&&(u++,m=[0]),y[l++]=u,s&&m[0]?m[v++]=P[x]||0:(m=[P[x]],v=1);while((x++<j||m[0]!==void 0)&&w--)}return y[0]||y.shift(),p.e=c,Nt(p,i?o+Jt(p)+1:o)}}();function KV(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(Jt(e)>16)throw Error(LO+Jt(e));if(!e.s)return new u(hr);for(t==null?(Ft=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(ps(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(hr),u.precision=s;;){if(a=Nt(a.times(e),s),n=n.times(++c),i=o.plus($o(a,n,s)),La(i.d).slice(0,s)===La(o.d).slice(0,s)){for(;l--;)o=Nt(o.times(o),s);return u.precision=d,t==null?(Ft=!0,Nt(o,d)):o}o=i}}function Jt(e){for(var t=e.e*Rt,n=e.d[0];n>=10;n/=10)t++;return t}function $O(e,t,n){if(t>e.LN10.sd())throw Ft=!0,n&&(e.precision=n),Error(Cr+"LN10 precision limit exceeded");return Nt(new e(e.LN10),t)}function xi(e){for(var t="";e--;)t+="0";return t}function Jd(e,t){var n,r,a,o,i,s,c,l,u,d=1,f=10,p=e,y=p.d,m=p.constructor,v=m.precision;if(p.s<1)throw Error(Cr+(p.s?"NaN":"-Infinity"));if(p.eq(hr))return new m(0);if(t==null?(Ft=!1,l=v):l=t,p.eq(10))return t==null&&(Ft=!0),$O(m,l);if(l+=f,m.precision=l,n=La(y),r=n.charAt(0),o=Jt(p),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(e),n=La(p.d),r=n.charAt(0),d++;o=Jt(p),r>1?(p=new m("0."+n),o++):p=new m(r+"."+n.slice(1))}else return c=$O(m,l+2,v).times(o+""),p=Jd(new m(r+"."+n.slice(1)),l-f).plus(c),m.precision=v,t==null?(Ft=!0,Nt(p,v)):p;for(s=i=p=$o(p.minus(hr),p.plus(hr),l),u=Nt(p.times(p),l),a=3;;){if(i=Nt(i.times(u),l),c=s.plus($o(i,new m(a),l)),La(c.d).slice(0,l)===La(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus($O(m,l+2,v).times(o+""))),s=$o(s,new m(d),l),m.precision=v,t==null?(Ft=!0,Nt(s,v)):s;s=c,a+=2}}function YV(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=al(n/Rt),e.d=[],r=(n+1)%Rt,n<0&&(r+=Rt),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Rt;r<a;)e.d.push(+t.slice(r,r+=Rt));t=t.slice(r),r=Rt-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Ft&&(e.e>My||e.e<-My))throw Error(LO+n)}else e.s=0,e.e=0,e.d=[0];return e}function Nt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Rt,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Rt),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Rt,a=r-Rt+i}if(n!==void 0&&(o=ps(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/ps(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=Jt(e),d.length=1,t=t-o-1,d[0]=ps(10,(Rt-t%Rt)%Rt),e.e=al(-t/Rt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=ps(10,Rt-r),d[u]=a>0?(l/ps(10,i-a)%ps(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==mn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=mn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Ft&&(e.e>My||e.e<-My))throw Error(LO+Jt(e));return e}function GV(e,t){var n,r,a,o,i,s,c,l,u,d,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Ft?Nt(t,p):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(p/Rt),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=mn-1;--c[o],c[a]+=mn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Ft?Nt(t,p):t):new f(0)}function hs(e,t,n){var r,a=Jt(e),o=La(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+xi(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+xi(-a-1)+o,n&&(r=n-i)>0&&(o+=xi(r))):a>=i?(o+=xi(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+xi(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=xi(r))),e.s<0?"-"+o:o}function XV(e,t){if(e.length>t)return e.length=t,!0}function ZV(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(fs+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return YV(i,o.toString())}else if(typeof o!="string")throw Error(fs+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,L_e.test(o))YV(i,o);else throw Error(fs+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=ZV,a.config=a.set=$_e,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function $_e(e){if(!e||typeof e!="object")throw Error(Cr+"Object expected");var t,n,r,a=["precision",1,rl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(al(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(fs+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(fs+n+": "+r);return this}var FO=ZV(D_e);hr=new FO(1);const Ot=FO;function F_e(e){return U_e(e)||V_e(e)||z_e(e)||B_e()}function B_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z_e(e,t){if(e){if(typeof e=="string")return BO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BO(e,t)}}function V_e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function U_e(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W_e=function(e){return e},JV={"@@functional/placeholder":!0},QV=function(e){return e===JV},eU=function(e){return function t(){return arguments.length===0||arguments.length===1&&QV(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},H_e=function e(t,n){return t===1?n:eU(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==JV}).length;return i>=t?n.apply(void 0,a):e(t-i,eU(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return QV(d)?c.shift():d});return n.apply(void 0,F_e(u).concat(c))}))})},Py=function(e){return H_e(e.length,e)},zO=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},q_e=Py(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),K_e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return W_e;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},VO=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},tU=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function Y_e(e){var t;return e===0?t=1:t=Math.floor(new Ot(e).abs().log(10).toNumber())+1,t}function G_e(e,t,n){for(var r=new Ot(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var X_e=Py(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),Z_e=Py(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),J_e=Py(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const ky={rangeStep:G_e,getDigitCount:Y_e,interpolateNumber:X_e,uninterpolateNumber:Z_e,uninterpolateTruncation:J_e};function UO(e){return tje(e)||eje(e)||nU(e)||Q_e()}function Q_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eje(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function tje(e){if(Array.isArray(e))return WO(e)}function Qd(e,t){return aje(e)||rje(e,t)||nU(e,t)||nje()}function nje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nU(e,t){if(e){if(typeof e=="string")return WO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WO(e,t)}}function WO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rje(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function aje(e){if(Array.isArray(e))return e}function rU(e){var t=Qd(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function aU(e,t,n){if(e.lte(0))return new Ot(0);var r=ky.getDigitCount(e.toNumber()),a=new Ot(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Ot(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Ot(Math.ceil(c))}function oje(e,t,n){var r=1,a=new Ot(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Ot(10).pow(ky.getDigitCount(e)-1),a=new Ot(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Ot(Math.floor(e)))}else e===0?a=new Ot(Math.floor((t-1)/2)):n||(a=new Ot(Math.floor(e)));var i=Math.floor((t-1)/2),s=K_e(q_e(function(c){return a.add(new Ot(c-i).mul(r)).toNumber()}),zO);return s(0,t)}function oU(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Ot(0),tickMin:new Ot(0),tickMax:new Ot(0)};var o=aU(new Ot(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Ot(0):(i=new Ot(e).add(t).div(2),i=i.sub(new Ot(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Ot(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?oU(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Ot(s).mul(o)),tickMax:i.add(new Ot(c).mul(o))})}function ije(e){var t=Qd(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=rU([n,r]),c=Qd(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(UO(zO(0,a-1).map(function(){return 1/0}))):[].concat(UO(zO(0,a-1).map(function(){return-1/0})),[u]);return n>r?VO(d):d}if(l===u)return oje(l,a,o);var f=oU(l,u,i,o),p=f.step,y=f.tickMin,m=f.tickMax,v=ky.rangeStep(y,m.add(new Ot(.1).mul(p)),p);return n>r?VO(v):v}function sje(e,t){var n=Qd(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=rU([r,a]),s=Qd(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=aU(new Ot(l).sub(c).div(u-1),o,0),f=[].concat(UO(ky.rangeStep(new Ot(c),new Ot(l).sub(new Ot(.99).mul(d)),d)),[l]);return r>a?VO(f):f}var cje=tU(ije),lje=tU(sje),uje="Invariant failed";function ms(e,t){throw new Error(uje)}var dje=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function Ay(){return Ay=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ay.apply(this,arguments)}function fje(e,t){return yje(e)||mje(e,t)||hje(e,t)||pje()}function pje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hje(e,t){if(e){if(typeof e=="string")return iU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iU(e,t)}}function iU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function yje(e){if(Array.isArray(e))return e}function gje(e,t){if(e==null)return{};var n=vje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function bje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lU(r.key),r)}}function xje(e,t,n){return t&&wje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _je(e,t,n){return t=Ty(t),jje(e,sU()?Reflect.construct(t,n||[],Ty(e).constructor):t.apply(e,n))}function jje(e,t){if(t&&(ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sje(e)}function Sje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sU=function(){return!!e})()}function Ty(e){return Ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ty(e)}function Eje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},HO(e,t)}function cU(e,t,n){return t=lU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lU(e){var t=Oje(e,"string");return ol(t)=="symbol"?t:t+""}function Oje(e,t){if(ol(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ol(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iy=function(e){function t(){return bje(this,t),_je(this,t,arguments)}return Eje(t,e),xje(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=gje(n,dje),f=yt(d,!1);this.props.direction==="x"&&l.type!=="number"&&ms();var p=s.map(function(y){var m=c(y,i),v=m.x,b=m.y,w=m.value,_=m.errorVal;if(!_)return null;var x=[],j,S;if(Array.isArray(_)){var E=fje(_,2);j=E[0],S=E[1]}else j=S=_;if(a==="vertical"){var O=l.scale,M=b+r,N=M+o,P=M-o,I=O(w-j),k=O(w+S);x.push({x1:k,y1:N,x2:k,y2:P}),x.push({x1:I,y1:M,x2:k,y2:M}),x.push({x1:I,y1:N,x2:I,y2:P})}else if(a==="horizontal"){var C=u.scale,A=v+r,T=A-o,D=A+o,L=C(w-j),R=C(w+S);x.push({x1:T,y1:R,x2:D,y2:R}),x.push({x1:A,y1:L,x2:A,y2:R}),x.push({x1:T,y1:L,x2:D,y2:L})}return H.createElement(pn,Ay({className:"recharts-errorBar",key:"bar-".concat(x.map(function(F){return"".concat(F.x1,"-").concat(F.x2,"-").concat(F.y1,"-").concat(F.y2)}))},f),x.map(function(F){return H.createElement("line",Ay({},F,{key:"line-".concat(F.x1,"-").concat(F.x2,"-").concat(F.y1,"-").concat(F.y2)}))}))});return H.createElement(pn,{className:"recharts-errorBars"},p)}}])}(H.Component);cU(Iy,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),cU(Iy,"displayName","ErrorBar");function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function uU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uU(Object(n),!0).forEach(function(r){Cje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Cje(e,t,n){return t=Nje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nje(e){var t=Mje(e,"string");return ef(t)=="symbol"?t:t+""}function Mje(e,t){if(ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dU=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=pr(t,Yc);if(!o)return null;var i=Yc.defaultProps,s=i!==void 0?ys(ys({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,f=u.props,p=f.sectors||f.data||[];return l.concat(p.map(function(y){return{type:o.props.iconType||d.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,f=d!==void 0?ys(ys({},d),u.props):{},p=f.dataKey,y=f.name,m=f.legendType,v=f.hide;return{inactive:v,dataKey:p,type:s.iconType||m||"square",color:KO(u),value:y||p,payload:f}}),ys(ys(ys({},s),Yc.getWithHeight(o,r)),{},{payload:c,item:o})};function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function fU(e){return Tje(e)||Aje(e)||kje(e)||Pje()}function Pje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kje(e,t){if(e){if(typeof e=="string")return qO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qO(e,t)}}function Aje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tje(e){if(Array.isArray(e))return qO(e)}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pU(Object(n),!0).forEach(function(r){il(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function il(e,t,n){return t=Ije(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ije(e){var t=Rje(e,"string");return tf(t)=="symbol"?t:t+""}function Rje(e,t){if(tf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(e,t,n){return gt(e)||gt(t)?n:sn(t)?xr(e,t,n):tt(t)?t(e):n}function Ry(e,t,n,r){var a=T_e(e,function(s){return $a(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[Ny(o),Cy(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!gt(s)}):a;return i.map(function(s){return sn(s)||s instanceof Date?s:""})}var Dje=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(oa(u-l)!==oa(d-u)){var p=[];if(oa(d-u)===oa(s[1]-s[0])){f=d;var y=u+s[1]-s[0];p[0]=Math.min(y,(y+l)/2),p[1]=Math.max(y,(y+l)/2)}else{f=l;var m=d+s[1]-s[0];p[0]=Math.min(u,(m+u)/2),p[1]=Math.max(u,(m+u)/2)}var v=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},KO=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},Lje=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,f=u.length;d<f;d++){var p=l[u[d]],y=p.items,m=p.cateAxisId,v=y.filter(function(S){return Mo(S.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?Ht(Ht({},b),v[0].props):v[0].props,_=w.barSize,x=w[m];o[x]||(o[x]=[]);var j=gt(_)?t:_;o[x].push({item:v[0],stackList:v.slice(1),barSize:gt(j)?void 0:ss(j,n,0)})}}return o},$je=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=ss(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,f=r/s,p=o.reduce(function(_,x){return _+x.barSize||0},0);p+=(s-1)*c,p>=r&&(p-=(s-1)*c,c=0),p>=r&&f>0&&(d=!0,f*=.9,p=s*f);var y=(r-p)/2>>0,m={offset:y-c,size:0};l=o.reduce(function(_,x){var j={item:x.item,position:{offset:m.offset+m.size+c,size:d?f:x.barSize}},S=[].concat(fU(_),[j]);return m=S[S.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:m})}),S},u)}else{var v=ss(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(_,x,j){var S=[].concat(fU(_),[{item:x.item,position:{offset:v+(b+c)*j+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},u)}return l},Fje=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=dU({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,f=c.align,p=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&p==="middle")&&f!=="center"&&ye(e[f]))return Ht(Ht({},e),{},il({},f,e[f]+(u||0)));if((y==="horizontal"||y==="vertical"&&f==="center")&&p!=="middle"&&ye(e[p]))return Ht(Ht({},e),{},il({},p,e[p]+(d||0)))}return e},Bje=function(e,t,n){return gt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},hU=function(e,t,n,r,a){var o=t.props.children,i=ia(o,Iy).filter(function(c){return Bje(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=$a(l,n);if(gt(u))return c;var d=Array.isArray(u)?[Ny(u),Cy(u)]:[u,u],f=s.reduce(function(p,y){var m=$a(l,y,0),v=d[0]-Math.abs(Array.isArray(m)?m[0]:m),b=d[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(v,p[0]),Math.max(b,p[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},zje=function(e,t,n,r,a){var o=t.map(function(i){return hU(e,i,n,a,r)}).filter(function(i){return!gt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},mU=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&hU(e,s,c,r)||Ry(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},yU=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},gU=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},Fo=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?oa(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!Ad(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},YO=new WeakMap,Dy=function(e,t){if(typeof t!="function")return e;YO.has(e)||YO.set(e,new WeakMap);var n=YO.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},Vje=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:Wd(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:vy(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Hd(),realScaleType:"point"}:a==="category"?{scale:Wd(),realScaleType:"band"}:{scale:vy(),realScaleType:"linear"};if(kd(r)){var s="scale".concat(Km(r));return{scale:(RV[s]||Hd)(),realScaleType:RV[s]?s:"point"}}return tt(r)?{scale:r}:{scale:Hd(),realScaleType:"point"}},vU=1e-4,Uje=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-vU,o=Math.max(r[0],r[1])+vU,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},Wje=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},Hje=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},qje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=Ad(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},Kje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=Ad(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},Yje={sign:qje,expand:G0e,none:Hc,silhouette:X0e,wiggle:Z0e,positive:Kje},Gje=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=Yje[n],o=Y0e().keys(r).value(function(i,s){return+$a(i,s,0)}).order(nE).offset(a);return o(e)},Xje=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var f,p=(f=d.type)!==null&&f!==void 0&&f.defaultProps?Ht(Ht({},d.type.defaultProps),d.props):d.props,y=p.stackId,m=p.hide;if(m)return u;var v=p[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(sn(y)){var w=b.stackGroups[y]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[y]=w}else b.stackGroups[Wm("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return Ht(Ht({},u),{},il({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var f=c[d];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(y,m){var v=f.stackGroups[m];return Ht(Ht({},y),{},il({},m,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:Gje(e,v.items,a)}))},p)}return Ht(Ht({},u),{},il({},d,f))},l)},Zje=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=cje(c,a,i);return e.domain([Ny(l),Cy(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=lje(u,a,i);return{niceTicks:d}}return null},bU=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=$a(o,t.dataKey,t.domain[i]);return gt(s)?null:t.scale(s)-a/2+r},Jje=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},Qje=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(sn(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},eSe=function(e){return e.reduce(function(t,n){return[Ny(n.concat([t[0]]).filter(ye)),Cy(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},wU=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=eSe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},xU=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_U=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,GO=function(e,t,n){if(tt(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(xU.test(e[0])){var a=+xU.exec(e[0])[1];r[0]=t[0]-a}else tt(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(_U.test(e[1])){var o=+_U.exec(e[1])[1];r[1]=t[1]+o}else tt(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},Ly=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=BE(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},jU=function(e,t,n){return!e||!e.length||DO(e,xr(n,"type.defaultProps.domain"))?t:e},SU=function(e,t){var n=e.type.defaultProps?Ht(Ht({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return Ht(Ht({},yt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:KO(e),value:$a(t,r),type:s,payload:t,chartType:c,hide:l})};function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function EU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function OU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EU(Object(n),!0).forEach(function(r){tSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tSe(e,t,n){return t=nSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nSe(e){var t=rSe(e,"string");return nf(t)=="symbol"?t:t+""}function rSe(e,t){if(nf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $y=Math.PI/180,aSe=function(e){return e*180/Math.PI},_n=function(e,t,n,r){return{x:e+Math.cos(-$y*r)*n,y:t+Math.sin(-$y*r)*n}},oSe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},iSe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=oSe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:aSe(c),angleInRadian:c}},sSe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},cSe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},CU=function(e,t){var n=e.x,r=e.y,a=iSe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=sSe(t),u=l.startAngle,d=l.endAngle,f=i,p;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=u}return p?OU(OU({},t),{},{radius:o,angle:cSe(f,t)}):null};function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}var lSe=["offset"];function uSe(e){return hSe(e)||pSe(e)||fSe(e)||dSe()}function dSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fSe(e,t){if(e){if(typeof e=="string")return XO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XO(e,t)}}function pSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hSe(e){if(Array.isArray(e))return XO(e)}function XO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mSe(e,t){if(e==null)return{};var n=ySe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ySe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function NU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NU(Object(n),!0).forEach(function(r){gSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gSe(e,t,n){return t=vSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vSe(e){var t=bSe(e,"string");return rf(t)=="symbol"?t:t+""}function bSe(e,t){if(rf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},af.apply(this,arguments)}var wSe=function(e){var t=e.value,n=e.formatter,r=gt(e.children)?t:e.children;return tt(n)?n(r):r},xSe=function(e,t){var n=oa(t-e),r=Math.min(Math.abs(t-e),360);return n*r},_Se=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,f=s.startAngle,p=s.endAngle,y=s.clockWise,m=(u+d)/2,v=xSe(f,p),b=v>=0?1:-1,w,_;r==="insideStart"?(w=f+b*o,_=y):r==="insideEnd"?(w=p-b*o,_=!y):r==="end"&&(w=p+b*o,_=y),_=v<=0?_:!_;var x=_n(c,l,m,w),j=_n(c,l,m,w+(_?1:-1)*359),S="M".concat(x.x,",").concat(x.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),E=gt(e.id)?Wm("recharts-radial-line-"):e.id;return H.createElement("text",af({},n,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",i)}),H.createElement("defs",null,H.createElement("path",{id:E,d:S})),H.createElement("textPath",{xlinkHref:"#".concat(E)},t))},jSe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var f=_n(o,i,c+n,d),p=f.x,y=f.y;return{x:p,y,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+c)/2,v=_n(o,i,m,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},SSe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,f=u>0?"end":"start",p=u>0?"start":"end",y=c>=0?1:-1,m=y*r,v=y>0?"end":"start",b=y>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:f};return ln(ln({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:p};return ln(ln({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return ln(ln({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var j={x:i+c+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return ln(ln({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:l}:{})}var S=n?{width:c,height:l}:{};return a==="insideLeft"?ln({x:i+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},S):a==="insideRight"?ln({x:i+c-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},S):a==="insideTop"?ln({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:p},S):a==="insideBottom"?ln({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:f},S):a==="insideTopLeft"?ln({x:i+m,y:s+d,textAnchor:b,verticalAnchor:p},S):a==="insideTopRight"?ln({x:i+c-m,y:s+d,textAnchor:v,verticalAnchor:p},S):a==="insideBottomLeft"?ln({x:i+m,y:s+l-d,textAnchor:b,verticalAnchor:f},S):a==="insideBottomRight"?ln({x:i+c-m,y:s+l-d,textAnchor:v,verticalAnchor:f},S):Vc(a)&&(ye(a.x)||is(a.x))&&(ye(a.y)||is(a.y))?ln({x:i+ss(a.x,c),y:s+ss(a.y,l),textAnchor:"end",verticalAnchor:"end"},S):ln({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},S)},ESe=function(e){return"cx"in e&&ye(e.cx)};function Mn(e){var t=e.offset,n=t===void 0?5:t,r=mSe(e,lSe),a=ln({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,f=a.textBreakAll;if(!o||gt(s)&&gt(c)&&!g.isValidElement(l)&&!tt(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var p;if(tt(l)){if(p=g.createElement(l,a),g.isValidElement(p))return p}else p=wSe(a);var y=ESe(o),m=yt(a,!0);if(y&&(i==="insideStart"||i==="insideEnd"||i==="end"))return _Se(a,p,m);var v=y?jSe(a):SSe(a);return H.createElement(fy,af({className:xt("recharts-label",d)},m,v,{breakAll:f}),p)}Mn.displayName="Label";var MU=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,f=e.top,p=e.left,y=e.width,m=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(y)&&ye(m)){if(ye(u)&&ye(d))return{x:u,y:d,width:y,height:m};if(ye(f)&&ye(p))return{x:f,y:p,width:y,height:m}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},OSe=function(e,t){return e?e===!0?H.createElement(Mn,{key:"label-implicit",viewBox:t}):sn(e)?H.createElement(Mn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Mn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):H.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):tt(e)?H.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):Vc(e)?H.createElement(Mn,af({viewBox:t},e,{key:"label-implicit"})):null:null},CSe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=MU(e),o=ia(r,Mn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=OSe(e.label,t||a);return[i].concat(uSe(o))};Mn.parseViewBox=MU,Mn.renderCallByParent=CSe;var ZO,PU;_M=function(){if(PU)return ZO;PU=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return ZO=e,ZO};var NSe=_M();IN=ot(NSe);function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}var MSe=["valueAccessor"],PSe=["data","dataKey","clockWise","id","textBreakAll"];function kSe(e){return RSe(e)||ISe(e)||TSe(e)||ASe()}function ASe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TSe(e,t){if(e){if(typeof e=="string")return JO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JO(e,t)}}function ISe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RSe(e){if(Array.isArray(e))return JO(e)}function JO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fy.apply(this,arguments)}function kU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function AU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kU(Object(n),!0).forEach(function(r){DSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function DSe(e,t,n){return t=LSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LSe(e){var t=$Se(e,"string");return of(t)=="symbol"?t:t+""}function $Se(e,t){if(of(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(of(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TU(e,t){if(e==null)return{};var n=FSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var BSe=function(e){return Array.isArray(e.value)?IN(e.value):e.value};function gs(e){var t=e.valueAccessor,n=t===void 0?BSe:t,r=TU(e,MSe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=TU(r,PSe);return!a||!a.length?null:H.createElement(pn,{className:"recharts-label-list"},a.map(function(u,d){var f=gt(o)?n(u,d):$a(u&&u.payload,o),p=gt(s)?{}:{id:"".concat(s,"-").concat(d)};return H.createElement(Mn,Fy({},yt(u,!0),l,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:Mn.parseViewBox(gt(i)?u:AU(AU({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}gs.displayName="LabelList";function zSe(e,t){return e?e===!0?H.createElement(gs,{key:"labelList-implicit",data:t}):H.isValidElement(e)||tt(e)?H.createElement(gs,{key:"labelList-implicit",data:t,content:e}):Vc(e)?H.createElement(gs,Fy({data:t},e,{key:"labelList-implicit"})):null:null}function VSe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=ia(r,gs).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=zSe(e.label,t);return[o].concat(kSe(a))}gs.renderCallByParent=VSe;function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function QO(){return QO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},QO.apply(this,arguments)}function IU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function RU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IU(Object(n),!0).forEach(function(r){USe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function USe(e,t,n){return t=WSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WSe(e){var t=HSe(e,"string");return sf(t)=="symbol"?t:t+""}function HSe(e,t){if(sf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qSe=function(e,t){var n=oa(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},By=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/$y,d=c?a:a+o*u,f=_n(t,n,l,d),p=_n(t,n,r,d),y=c?a-o*u:a,m=_n(t,n,l*Math.cos(u*$y),y);return{center:f,circleTangency:p,lineTangency:m,theta:u}},DU=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=qSe(o,i),c=o+s,l=_n(t,n,a,o),u=_n(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var f=_n(t,n,r,o),p=_n(t,n,r,c);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},KSe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=oa(l-c),d=By({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),f=d.circleTangency,p=d.lineTangency,y=d.theta,m=By({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=m.circleTangency,b=m.lineTangency,w=m.theta,_=s?Math.abs(c-l):Math.abs(c-l)-y-w;if(_<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):DU({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var j=By({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),S=j.circleTangency,E=j.lineTangency,O=j.theta,M=By({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),N=M.circleTangency,P=M.lineTangency,I=M.theta,k=s?Math.abs(c-l):Math.abs(c-l)-O-I;if(k<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},YSe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},LU=function(e){var t=RU(RU({},YSe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var f=xt("recharts-sector",d),p=o-a,y=ss(i,p,0,!0),m;return y>0&&Math.abs(l-u)<360?m=KSe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(y,p/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):m=DU({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),H.createElement("path",QO({},yt(t,!0),{className:f,d:m,role:"img"}))};function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function eC(){return eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eC.apply(this,arguments)}function $U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function FU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$U(Object(n),!0).forEach(function(r){GSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$U(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function GSe(e,t,n){return t=XSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XSe(e){var t=ZSe(e,"string");return cf(t)=="symbol"?t:t+""}function ZSe(e,t){if(cf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BU={curveBasisClosed:L0e,curveBasisOpen:$0e,curveBasis:D0e,curveBumpX:_0e,curveBumpY:j0e,curveLinearClosed:F0e,curveLinear:Zm,curveMonotoneX:B0e,curveMonotoneY:z0e,curveNatural:V0e,curveStep:U0e,curveStepAfter:H0e,curveStepBefore:W0e},zy=function(e){return e.x===+e.x&&e.y===+e.y},lf=function(e){return e.x},uf=function(e){return e.y},JSe=function(e,t){if(tt(e))return e;var n="curve".concat(Km(e));return(n==="curveMonotone"||n==="curveBump")&&t?BU["".concat(n).concat(t==="vertical"?"Y":"X")]:BU[n]||Zm},QSe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=JSe(n,i),u=c?a.filter(function(y){return zy(y)}):a,d;if(Array.isArray(o)){var f=c?o.filter(function(y){return zy(y)}):o,p=u.map(function(y,m){return FU(FU({},y),{},{base:f[m]})});return i==="vertical"?d=Jm().y(uf).x1(lf).x0(function(y){return y.base.x}):d=Jm().x(lf).y1(uf).y0(function(y){return y.base.y}),d.defined(zy).curve(l),d(p)}return i==="vertical"&&ye(o)?d=Jm().y(uf).x1(lf).x0(o):ye(o)?d=Jm().x(lf).y1(uf).y0(o):d=WB().x(lf).y(uf),d.defined(zy).curve(l),d(u)},zU=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?QSe(e):r;return H.createElement("path",eC({},yt(e,!1),Hm(e),{className:xt("recharts-curve",t),d:o,ref:a}))},VU={exports:{}},tC,UU;function eEe(){if(UU)return tC;UU=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return tC=e,tC}var nC,WU;function tEe(){if(WU)return nC;WU=1;var e=eEe();function t(){}function n(){}return n.resetWarningCache=t,nC=function(){function r(i,s,c,l,u,d){if(d!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},nC}var HU;function nEe(){return HU||(HU=1,VU.exports=tEe()()),VU.exports}var rEe=nEe();const qe=ot(rEe);var aEe=Object.getOwnPropertyNames,oEe=Object.getOwnPropertySymbols,iEe=Object.prototype.hasOwnProperty;function qU(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Vy(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function KU(e){return aEe(e).concat(oEe(e))}var YU=Object.hasOwn||function(e,t){return iEe.call(e,t)};function sl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var GU="_owner",XU=Object.getOwnPropertyDescriptor,ZU=Object.keys;function sEe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function cEe(e,t){return sl(e.getTime(),t.getTime())}function JU(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],p=d[1],y=s.value,m=y[0],v=y[1];!l&&!r[u]&&(l=n.equals(f,m,o,u,e,t,n)&&n.equals(p,v,f,m,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function lEe(e,t,n){var r=ZU(e),a=r.length;if(ZU(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===GU&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!YU(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function df(e,t,n){var r=KU(e),a=r.length;if(KU(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===GU&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!YU(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=XU(e,o),s=XU(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function uEe(e,t){return sl(e.valueOf(),t.valueOf())}function dEe(e,t){return e.source===t.source&&e.flags===t.flags}function QU(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function fEe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var pEe="[object Arguments]",hEe="[object Boolean]",mEe="[object Date]",yEe="[object Map]",gEe="[object Number]",vEe="[object Object]",bEe="[object RegExp]",wEe="[object Set]",xEe="[object String]",_Ee=Array.isArray,eW=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,tW=Object.assign,jEe=Object.prototype.toString.call.bind(Object.prototype.toString);function SEe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var f=l.constructor;if(f!==u.constructor)return!1;if(f===Object)return a(l,u,d);if(_Ee(l))return t(l,u,d);if(eW!=null&&eW(l))return c(l,u,d);if(f===Date)return n(l,u,d);if(f===RegExp)return i(l,u,d);if(f===Map)return r(l,u,d);if(f===Set)return s(l,u,d);var p=jEe(l);return p===mEe?n(l,u,d):p===bEe?i(l,u,d):p===yEe?r(l,u,d):p===wEe?s(l,u,d):p===vEe?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):p===pEe?a(l,u,d):p===hEe||p===gEe||p===xEe?o(l,u,d):!1}}function EEe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?df:sEe,areDatesEqual:cEe,areMapsEqual:r?qU(JU,df):JU,areObjectsEqual:r?df:lEe,arePrimitiveWrappersEqual:uEe,areRegExpsEqual:dEe,areSetsEqual:r?qU(QU,df):QU,areTypedArraysEqual:r?df:fEe};if(n&&(a=tW({},a,n(a))),t){var o=Vy(a.areArraysEqual),i=Vy(a.areMapsEqual),s=Vy(a.areObjectsEqual),c=Vy(a.areSetsEqual);a=tW({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function OEe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function CEe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,f=l.meta;return n(s,c,{cache:d,equals:a,meta:f,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var NEe=_i();_i({strict:!0}),_i({circular:!0}),_i({circular:!0,strict:!0}),_i({createInternalComparator:function(){return sl}}),_i({strict:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl},strict:!0});function _i(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=EEe(e),c=SEe(s),l=r?r(c):OEe(c);return CEe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function MEe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function nW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):MEe(a)};requestAnimationFrame(r)}function rC(e){"@babel/helpers - typeof";return rC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rC(e)}function PEe(e){return IEe(e)||TEe(e)||AEe(e)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AEe(e,t){if(e){if(typeof e=="string")return rW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rW(e,t)}}function rW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IEe(e){if(Array.isArray(e))return e}function REe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=PEe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){nW(a.bind(null,l),c);return}a(c),nW(a.bind(null,l));return}rC(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function aW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function oW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aW(Object(n),!0).forEach(function(r){iW(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iW(e,t,n){return t=DEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DEe(e){var t=LEe(e,"string");return ff(t)==="symbol"?t:String(t)}function LEe(e,t){if(ff(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ff(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Ee=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},FEe=function(e){return e},BEe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},pf=function(e,t){return Object.keys(t).reduce(function(n,r){return oW(oW({},n),{},iW({},r,e(r,t[r])))},{})},sW=function(e,t,n){return e.map(function(r){return"".concat(BEe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function zEe(e,t){return WEe(e)||UEe(e,t)||cW(e,t)||VEe()}function VEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function WEe(e){if(Array.isArray(e))return e}function HEe(e){return YEe(e)||KEe(e)||cW(e)||qEe()}function qEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cW(e,t){if(e){if(typeof e=="string")return aC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aC(e,t)}}function KEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YEe(e){if(Array.isArray(e))return aC(e)}function aC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Uy=1e-4,lW=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},uW=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},dW=function(e,t){return function(n){var r=lW(e,t);return uW(r,n)}},GEe=function(e,t){return function(n){var r=lW(e,t),a=[].concat(HEe(r.map(function(o,i){return o*i}).slice(1)),[0]);return uW(a,n)}},fW=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),l=zEe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=dW(r,o),d=dW(a,i),f=GEe(r,o),p=function(m){return m>1?1:m<0?0:m},y=function(m){for(var v=m>1?1:m,b=v,w=0;w<8;++w){var _=u(b)-v,x=f(b);if(Math.abs(_-v)<Uy||x<Uy)return d(b);b=p(b-_/x)}return d(b)};return y.isStepper=!1,y},XEe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,f=u*a,p=u+(d-f)*i/1e3,y=u*i/1e3+c;return Math.abs(y-l)<Uy&&Math.abs(p)<Uy?[l,0]:[y,p]};return s.isStepper=!0,s.dt=i,s},ZEe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return fW(r);case"spring":return XEe();default:if(r.split("(")[0]==="cubic-bezier")return fW(r)}return typeof r=="function"?r:null};function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function pW(e){return eOe(e)||QEe(e)||mW(e)||JEe()}function JEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eOe(e){if(Array.isArray(e))return iC(e)}function hW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hW(Object(n),!0).forEach(function(r){oC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oC(e,t,n){return t=tOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tOe(e){var t=nOe(e,"string");return hf(t)==="symbol"?t:String(t)}function nOe(e,t){if(hf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(hf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rOe(e,t){return iOe(e)||oOe(e,t)||mW(e,t)||aOe()}function aOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mW(e,t){if(e){if(typeof e=="string")return iC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iC(e,t)}}function iC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function iOe(e){if(Array.isArray(e))return e}var Wy=function(e,t,n){return e+(t-e)*n},sC=function(e){var t=e.from,n=e.to;return t!==n},sOe=function e(t,n,r){var a=pf(function(o,i){if(sC(i)){var s=t(i.from,i.to,i.velocity),c=rOe(s,2),l=c[0],u=c[1];return jn(jn({},i),{},{from:l,velocity:u})}return i},n);return r<1?pf(function(o,i){return sC(i)?jn(jn({},i),{},{velocity:Wy(i.velocity,a[o].velocity,r),from:Wy(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const cOe=function(e,t,n,r,a){var o=$Ee(e,t),i=o.reduce(function(v,b){return jn(jn({},v),{},oC({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return jn(jn({},v),{},oC({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},f=function(){return pf(function(v,b){return b.from},s)},p=function(){return!Object.values(s).filter(sC).length},y=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=sOe(n,s,w),a(jn(jn(jn({},e),t),f())),l=v,p()||(c=requestAnimationFrame(d))},m=function(v){u||(u=v);var b=(v-u)/r,w=pf(function(x,j){return Wy.apply(void 0,pW(j).concat([n(b)]))},i);if(a(jn(jn(jn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var _=pf(function(x,j){return Wy.apply(void 0,pW(j).concat([n(1)]))},i);a(jn(jn(jn({},e),t),_))}};return d=n.isStepper?y:m,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function cl(e){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cl(e)}var lOe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function uOe(e,t){if(e==null)return{};var n=dOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dOe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function cC(e){return mOe(e)||hOe(e)||pOe(e)||fOe()}function fOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pOe(e,t){if(e){if(typeof e=="string")return lC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lC(e,t)}}function hOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mOe(e){if(Array.isArray(e))return lC(e)}function lC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ca(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yW(Object(n),!0).forEach(function(r){mf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mf(e,t,n){return t=gW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gOe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gW(r.key),r)}}function vOe(e,t,n){return t&&gOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gW(e){var t=bOe(e,"string");return cl(t)==="symbol"?t:String(t)}function bOe(e,t){if(cl(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cl(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uC(e,t)}function uC(e,t){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},uC(e,t)}function xOe(e){var t=_Oe();return function(){var n=Hy(e),r;if(t){var a=Hy(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return dC(this,r)}}function dC(e,t){if(t&&(cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fC(e)}function fC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hy(e){return Hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hy(e)}var ji=function(e){wOe(n,e);var t=xOe(n);function n(r,a){var o;yOe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,f=i.children,p=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(fC(o)),o.changeStyle=o.changeStyle.bind(fC(o)),!s||p<=0)return o.state={style:{}},typeof f=="function"&&(o.state={style:u}),dC(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof f=="function")return o.state={style:l},dC(o);o.state={style:c?mf({},c,l):l}}else o.state={style:{}};return o}return vOe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var f={style:s?mf({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(f);return}if(!(NEe(r.to,l)&&r.canBegin&&r.isActive)){var p=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=p||c?u:r.to;if(this.state&&d){var m={style:s?mf({},s,y):y};(s&&d[s]!==y||!s&&d!==y)&&this.setState(m)}this.runAnimation(ca(ca({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,f=cOe(o,i,ZEe(c),s,this.changeStyle),p=function(){a.stopJSAnimation=f()};this.manager.start([d,l,p,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,f=function(p,y,m){if(m===0)return p;var v=y.duration,b=y.easing,w=b===void 0?"ease":b,_=y.style,x=y.properties,j=y.onAnimationEnd,S=m>0?o[m-1]:y,E=x||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(cC(p),[a.runJSAnimation.bind(a,{from:S.style,to:_,duration:v,easing:w}),v]);var O=sW(E,v,w),M=ca(ca(ca({},S.style),_),{},{transition:O});return[].concat(cC(p),[M,v,j]).filter(FEe)};return this.manager.start([s].concat(cC(o.reduce(f,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=REe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,f=r.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var y=i?mf({},i,s):s,m=sW(Object.keys(y),o,c);p.start([l,a,ca(ca({},y),{},{transition:m}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=uOe(r,lOe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var f=d.props,p=f.style,y=p===void 0?{}:p,m=f.className,v=g.cloneElement(d,ca(ca({},s),{},{style:ca(ca({},y),l),className:m}));return v};return c===1?u(g.Children.only(a)):H.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);ji.displayName="Animate",ji.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},ji.propTypes={from:qe.oneOfType([qe.object,qe.string]),to:qe.oneOfType([qe.object,qe.string]),attributeName:qe.string,duration:qe.number,begin:qe.number,easing:qe.oneOfType([qe.string,qe.func]),steps:qe.arrayOf(qe.shape({duration:qe.number.isRequired,style:qe.object.isRequired,easing:qe.oneOfType([qe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),qe.func]),properties:qe.arrayOf("string"),onAnimationEnd:qe.func})),children:qe.oneOfType([qe.node,qe.func]),isActive:qe.bool,canBegin:qe.bool,onAnimationEnd:qe.func,shouldReAnimate:qe.bool,onAnimationStart:qe.func,onAnimationReStart:qe.func},qe.object,qe.object,qe.object,qe.element,qe.object,qe.object,qe.object,qe.oneOfType([qe.array,qe.element]),qe.any;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qy.apply(this,arguments)}function jOe(e,t){return COe(e)||OOe(e,t)||EOe(e,t)||SOe()}function SOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EOe(e,t){if(e){if(typeof e=="string")return vW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vW(e,t)}}function vW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function COe(e){if(Array.isArray(e))return e}function bW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function wW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bW(Object(n),!0).forEach(function(r){NOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NOe(e,t,n){return t=MOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MOe(e){var t=POe(e,"string");return yf(t)=="symbol"?t:t+""}function POe(e,t){if(yf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(yf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xW=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var p=Math.min(o,a);l="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+s*p,",").concat(t,`
            L `).concat(e+n-s*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*p,`
            L `).concat(e+n,",").concat(t+r-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n-s*p,",").concat(t+r,`
            L `).concat(e+s*p,",").concat(t+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*p," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},kOe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},AOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pC=function(e){var t=wW(wW({},AOe),e),n=g.useRef(),r=g.useState(-1),a=jOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,f=t.className,p=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=xt("recharts-rectangle",f);return b?H.createElement(ji,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:y,animationEasing:p,isActive:b},function(_){var x=_.width,j=_.height,S=_.x,E=_.y;return H.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,isActive:v,easing:p},H.createElement("path",qy({},yt(t,!0),{className:w,d:xW(S,E,x,j,d),ref:n})))}):H.createElement("path",qy({},yt(t,!0),{className:w,d:xW(s,c,l,u,d)}))};function hC(){return hC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hC.apply(this,arguments)}var _W=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=xt("recharts-dot",a);return t===+t&&n===+n&&r===+r?H.createElement("circle",hC({},yt(e,!1),Hm(e),{className:o,cx:t,cy:n,r})):null};function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}var TOe=["x","y","top","left","width","height","className"];function mC(){return mC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mC.apply(this,arguments)}function jW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IOe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jW(Object(n),!0).forEach(function(r){ROe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ROe(e,t,n){return t=DOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DOe(e){var t=LOe(e,"string");return gf(t)=="symbol"?t:t+""}function LOe(e,t){if(gf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Oe(e,t){if(e==null)return{};var n=FOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var BOe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},zOe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,f=d===void 0?0:d,p=e.className,y=$Oe(e,TOe),m=IOe({x:n,y:a,top:i,left:c,width:u,height:f},y);return!ye(n)||!ye(a)||!ye(u)||!ye(f)||!ye(i)||!ye(c)?null:H.createElement("path",mC({},yt(m,!0),{className:xt("recharts-cross",p),d:BOe(n,a,u,f,i,c)}))},yC,SW;NN=function(){if(SW)return yC;SW=1;var e=po(),t=Cv(),n=pa(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&i.call(f)==c}return yC=l,yC};var VOe=NN();const UOe=ot(VOe);var gC,EW;function WOe(){if(EW)return gC;EW=1;var e=po(),t=pa(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return gC=r,gC}var HOe=WOe();const qOe=ot(HOe);function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ky.apply(this,arguments)}function KOe(e,t){return ZOe(e)||XOe(e,t)||GOe(e,t)||YOe()}function YOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GOe(e,t){if(e){if(typeof e=="string")return OW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OW(e,t)}}function OW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function XOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function ZOe(e){if(Array.isArray(e))return e}function CW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function NW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CW(Object(n),!0).forEach(function(r){JOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function JOe(e,t,n){return t=QOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QOe(e){var t=eCe(e,"string");return vf(t)=="symbol"?t:t+""}function eCe(e,t){if(vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MW=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},tCe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nCe=function(e){var t=NW(NW({},tCe),e),n=g.useRef(),r=g.useState(-1),a=KOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,f=t.className,p=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=xt("recharts-trapezoid",f);return v?H.createElement(ji,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:y,animationEasing:p,isActive:v},function(w){var _=w.upperWidth,x=w.lowerWidth,j=w.height,S=w.x,E=w.y;return H.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,easing:p},H.createElement("path",Ky({},yt(t,!0),{className:b,d:MW(S,E,_,x,j),ref:n})))}):H.createElement("g",null,H.createElement("path",Ky({},yt(t,!0),{className:b,d:MW(s,c,l,u,d)})))},rCe=["option","shapeType","propTransformer","activeClassName","isActive"];function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function aCe(e,t){if(e==null)return{};var n=oCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function PW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Yy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PW(Object(n),!0).forEach(function(r){iCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iCe(e,t,n){return t=sCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sCe(e){var t=cCe(e,"string");return bf(t)=="symbol"?t:t+""}function cCe(e,t){if(bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lCe(e,t){return Yy(Yy({},t),e)}function uCe(e,t){return e==="symbols"}function kW(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return H.createElement(pC,n);case"trapezoid":return H.createElement(nCe,n);case"sector":return H.createElement(LU,n);case"symbols":if(uCe(t))return H.createElement(aE,n);break;default:return null}}function dCe(e){return g.isValidElement(e)?e.props:e}function fCe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?lCe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=aCe(e,rCe),l;if(g.isValidElement(t))l=g.cloneElement(t,Yy(Yy({},c),dCe(t)));else if(tt(t))l=t(c);else if(UOe(t)&&!qOe(t)){var u=a(t,c);l=H.createElement(kW,{shapeType:n,elementProps:u})}else{var d=c;l=H.createElement(kW,{shapeType:n,elementProps:d})}return s?H.createElement(pn,{className:i},l):l}function Gy(e,t){return t!=null&&"trapezoids"in e.props}function Xy(e,t){return t!=null&&"sectors"in e.props}function wf(e,t){return t!=null&&"points"in e.props}function pCe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function hCe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function mCe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function yCe(e,t){var n;return Gy(e,t)?n=pCe:Xy(e,t)?n=hCe:wf(e,t)&&(n=mCe),n}function gCe(e,t){var n;return Gy(e,t)?n="trapezoids":Xy(e,t)?n="sectors":wf(e,t)&&(n="points"),n}function vCe(e,t){if(Gy(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Xy(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return wf(e,t)?t.payload:{}}function bCe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=gCe(n,t),o=vCe(n,t),i=r.filter(function(c,l){var u=DO(o,c),d=n.props[a].filter(function(y){var m=yCe(n,t);return m(y,t)}),f=n.props[a].indexOf(d[d.length-1]),p=l===f;return u&&p}),s=r.indexOf(i[i.length-1]);return s}var vC,AW;function wCe(){if(AW)return vC;AW=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return vC=n,vC}var bC,TW;function xCe(){if(TW)return bC;TW=1;var e=wCe(),t=Es(),n=z$();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return bC=r,bC}var wC,IW;function _Ce(){if(IW)return wC;IW=1;var e=xCe(),t=e();return wC=t,wC}var jCe=_Ce();const Zy=ot(jCe);function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function RW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RW(Object(n),!0).forEach(function(r){LW(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function LW(e,t,n){return t=SCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SCe(e){var t=ECe(e,"string");return xf(t)=="symbol"?t:t+""}function ECe(e,t){if(xf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OCe=["Webkit","Moz","O","ms"],CCe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=OCe.reduce(function(a,o){return DW(DW({},a),{},LW({},o+n,t))},{});return r[e]=t,r};function ll(e){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}function Jy(){return Jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jy.apply(this,arguments)}function $W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function xC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$W(Object(n),!0).forEach(function(r){mr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$W(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zW(r.key),r)}}function MCe(e,t,n){return t&&FW(e.prototype,t),n&&FW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function PCe(e,t,n){return t=Qy(t),kCe(e,BW()?Reflect.construct(t,n||[],Qy(e).constructor):t.apply(e,n))}function kCe(e,t){if(t&&(ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ACe(e)}function ACe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BW=function(){return!!e})()}function Qy(e){return Qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qy(e)}function TCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_C(e,t)}function _C(e,t){return _C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_C(e,t)}function mr(e,t,n){return t=zW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zW(e){var t=ICe(e,"string");return ll(t)=="symbol"?t:t+""}function ICe(e,t){if(ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RCe=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Hd().domain(Zy(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},VW=function(e){return e.changedTouches&&!!e.changedTouches.length},ul=function(e){function t(n){var r;return NCe(this,t),r=PCe(this,t,[n]),mr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),mr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),mr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),mr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),mr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),mr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),mr(r,"handleSlideDragStart",function(a){var o=VW(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return TCe(t,e),MCe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),f=t.getIndexInRange(o,u),p=t.getIndexInRange(o,d);return{startIndex:f-f%s,endIndex:p===l?l:p-p%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=$a(a[n],i,n);return tt(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,f=s.endIndex,p=s.onChange,y=n.pageX-a;y>0?y=Math.min(y,c+l-u-i,c+l-u-o):y<0&&(y=Math.max(y,c-o,c-i));var m=this.getIndex({startX:o+y,endX:i+y});(m.startIndex!==d||m.endIndex!==f)&&p&&p(m),this.setState({startX:o+y,endX:i+y,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=VW(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,f=l.travellerWidth,p=l.onChange,y=l.gap,m=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-f-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),_=w.startIndex,x=w.endIndex,j=function(){var S=m.length-1;return o==="startX"&&(i>s?_%y===0:x%y===0)||i<s&&x===S||o==="endX"&&(i>s?x%y===0:_%y===0)||i>s&&x===S};this.setState(mr(mr({},o,c+b),"brushMoveStartX",n.pageX),function(){p&&j()&&p(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var f=i[d];r==="startX"&&f>=c||r==="endX"&&f<=s||this.setState(mr({},r,f),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return H.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?H.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,f=s.ariaLabel,p=s.data,y=s.startIndex,m=s.endIndex,v=Math.max(n,this.props.x),b=xC(xC({},yt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=f||"Min value: ".concat((a=p[y])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=p[m])===null||o===void 0?void 0:o.name);return H.createElement(pn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return H.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,f=5,p={pointerEvents:"none",fill:c};return H.createElement(pn,{className:"recharts-brush-texts"},H.createElement(fy,Jy({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-f,y:o+i/2},p),this.getTextOfTick(r)),H.createElement(fy,Jy({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+f,y:o+i/2},p),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,f=d.startX,p=d.endX,y=d.isTextActive,m=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=xt("recharts-brush",a),_=H.Children.count(o)===1,x=CCe("userSelect","none");return H.createElement(pn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(y||m||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return H.createElement(H.Fragment,null,H.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),H.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),H.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return H.isValidElement(n)?a=H.cloneElement(n,r):tt(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return xC({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?RCe({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(f){return r.scale(f)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);mr(ul,"displayName","Brush"),mr(ul,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var jC,UW;function DCe(){if(UW)return jC;UW=1;var e=OE();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return jC=t,jC}var SC,WW;function LCe(){if(WW)return SC;WW=1;var e=AI(),t=xa(),n=DCe(),r=In(),a=Es();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return SC=o,SC}var $Ce=LCe();const FCe=ot($Ce);var Fa=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},EC,HW;function BCe(){if(HW)return EC;HW=1;var e=Dg(),t=Iz(),n=xa();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return EC=r,EC}var zCe=BCe();const VCe=ot(zCe);var OC,qW;function UCe(){if(qW)return OC;qW=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return OC=e,OC}var CC,KW;function WCe(){if(KW)return CC;KW=1;var e=OE();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return CC=t,CC}var NC,YW;function HCe(){if(YW)return NC;YW=1;var e=UCe(),t=WCe(),n=xa(),r=In(),a=Es();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return NC=o,NC}var qCe=HCe();const GW=ot(qCe);var KCe=["x","y"];function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function MC(){return MC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MC.apply(this,arguments)}function XW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XW(Object(n),!0).forEach(function(r){YCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YCe(e,t,n){return t=GCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GCe(e){var t=XCe(e,"string");return _f(t)=="symbol"?t:t+""}function XCe(e,t){if(_f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZCe(e,t){if(e==null)return{};var n=JCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function QCe(e,t){var n=e.x,r=e.y,a=ZCe(e,KCe),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),f=parseInt(d,10);return jf(jf(jf(jf(jf({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function ZW(e){return H.createElement(fCe,MC({shapeType:"rectangle",propTransformer:QCe,activeClassName:"recharts-active-bar"},e))}var eNe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||ms(),t)}},tNe=["value","background"],JW;function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}function nNe(e,t){if(e==null)return{};var n=rNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eg.apply(this,arguments)}function QW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QW(Object(n),!0).forEach(function(r){Si(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nH(r.key),r)}}function oNe(e,t,n){return t&&eH(e.prototype,t),n&&eH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function iNe(e,t,n){return t=tg(t),sNe(e,tH()?Reflect.construct(t,n||[],tg(e).constructor):t.apply(e,n))}function sNe(e,t){if(t&&(dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cNe(e)}function cNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tH=function(){return!!e})()}function tg(e){return tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tg(e)}function lNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PC(e,t)}function PC(e,t){return PC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},PC(e,t)}function Si(e,t,n){return t=nH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nH(e){var t=uNe(e,"string");return dl(t)=="symbol"?t:t+""}function uNe(e,t){if(dl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vs=function(e){function t(){var n;aNe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=iNe(this,t,[].concat(a)),Si(n,"state",{isAnimationFinished:!1}),Si(n,"id",Wm("recharts-bar-")),Si(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Si(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return lNe(t,e),oNe(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=yt(this.props,!1);return n&&n.map(function(u,d){var f=d===s,p=f?c:o,y=Qt(Qt(Qt({},l),u),{},{isActive:f,option:p,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return H.createElement(pn,eg({className:"recharts-bar-rectangle"},qm(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),H.createElement(ZW,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return H.createElement(ji,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,y=a.map(function(m,v){var b=d&&d[v];if(b){var w=Uc(b.x,m.x),_=Uc(b.y,m.y),x=Uc(b.width,m.width),j=Uc(b.height,m.height);return Qt(Qt({},m),{},{x:w(p),y:_(p),width:x(p),height:j(p)})}if(o==="horizontal"){var S=Uc(0,m.height),E=S(p);return Qt(Qt({},m),{},{y:m.y+m.height-E,height:E})}var O=Uc(0,m.width),M=O(p);return Qt(Qt({},m),{},{width:M})});return H.createElement(pn,null,n.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!DO(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=yt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=nNe(c,tNe);if(!u)return null;var f=Qt(Qt(Qt(Qt(Qt({},d),{},{fill:"#eee"},u),s),qm(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return H.createElement(ZW,eg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},f))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=ia(l,Iy);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,f=function(y,m){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:$a(y,m)}},p={clipPath:n?"url(#clipPath-".concat(r,")"):null};return H.createElement(pn,p,u.map(function(y){return H.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,f=n.isAnimationActive,p=n.background,y=n.id;if(r||!a||!a.length)return null;var m=this.state.isAnimationFinished,v=xt("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,_=b||w,x=gt(y)?this.id:y;return H.createElement(pn,{className:v},b||w?H.createElement("defs",null,H.createElement("clipPath",{id:"clipPath-".concat(x)},H.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,H.createElement(pn,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(x,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,x),(!f||m)&&gs.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);JW=vs,Si(vs,"displayName","Bar"),Si(vs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!gi.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Si(vs,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,f=e.offset,p=Wje(r,n);if(!p)return null;var y=t.layout,m=n.type.defaultProps,v=m!==void 0?Qt(Qt({},m),n.props):n.props,b=v.dataKey,w=v.children,_=v.minPointSize,x=y==="horizontal"?i:o,j=l?x.scale.domain():null,S=Jje({numericAxis:x}),E=ia(w,h7),O=d.map(function(M,N){var P,I,k,C,A,T;l?P=Hje(l[u+N],j):(P=$a(M,b),Array.isArray(P)||(P=[S,P]));var D=eNe(_,JW.defaultProps.minPointSize)(P[1],N);if(y==="horizontal"){var L,R=[i.scale(P[0]),i.scale(P[1])],F=R[0],V=R[1];I=bU({axis:o,ticks:s,bandSize:a,offset:p.offset,entry:M,index:N}),k=(L=V??F)!==null&&L!==void 0?L:void 0,C=p.size;var $=F-V;if(A=Number.isNaN($)?0:$,T={x:I,y:i.y,width:C,height:i.height},Math.abs(D)>0&&Math.abs(A)<Math.abs(D)){var U=oa(A||D)*(Math.abs(D)-Math.abs(A));k-=U,A+=U}}else{var z=[o.scale(P[0]),o.scale(P[1])],K=z[0],ne=z[1];if(I=K,k=bU({axis:i,ticks:c,bandSize:a,offset:p.offset,entry:M,index:N}),C=ne-K,A=p.size,T={x:o.x,y:k,width:o.width,height:A},Math.abs(D)>0&&Math.abs(C)<Math.abs(D)){var Q=oa(C||D)*(Math.abs(D)-Math.abs(C));C+=Q}}return Qt(Qt(Qt({},M),{},{x:I,y:k,width:C,height:A,value:l?P:P[1],payload:M,background:T},E&&E[N]&&E[N].props),{},{tooltipPayload:[SU(n,M)],tooltipPosition:{x:I+C/2,y:k+A/2}})});return Qt({data:O,layout:y},f)});function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function dNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oH(r.key),r)}}function fNe(e,t,n){return t&&rH(e.prototype,t),n&&rH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function aH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aH(Object(n),!0).forEach(function(r){ng(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ng(e,t,n){return t=oH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oH(e){var t=pNe(e,"string");return Sf(t)=="symbol"?t:t+""}function pNe(e,t){if(Sf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Sf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hNe=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!pr(c,vs);return l.reduce(function(f,p){var y=t[p],m=y.orientation,v=y.domain,b=y.padding,w=b===void 0?{}:b,_=y.mirror,x=y.reversed,j="".concat(m).concat(_?"Mirror":""),S,E,O,M,N;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var P=v[1]-v[0],I=1/0,k=y.categoricalDomain.sort();if(k.forEach(function(U,z){z>0&&(I=Math.min((U||0)-(k[z-1]||0),I))}),Number.isFinite(I)){var C=I/P,A=y.layout==="vertical"?n.height:n.width;if(y.padding==="gap"&&(S=C*A/2),y.padding==="no-gap"){var T=ss(e.barCategoryGap,C*A),D=C*A/2;S=D-T-(D-T)/A*T}}}r==="xAxis"?E=[n.left+(w.left||0)+(S||0),n.left+n.width-(w.right||0)-(S||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(S||0),n.top+n.height-(w.bottom||0)-(S||0)]:E=y.range,x&&(E=[E[1],E[0]]);var L=Vje(y,a,d),R=L.scale,F=L.realScaleType;R.domain(v).range(E),Uje(R);var V=Zje(R,la(la({},y),{},{realScaleType:F}));r==="xAxis"?(N=m==="top"&&!_||m==="bottom"&&_,O=n.left,M=u[j]-N*y.height):r==="yAxis"&&(N=m==="left"&&!_||m==="right"&&_,O=u[j]-N*y.width,M=n.top);var $=la(la(la({},y),V),{},{realScaleType:F,x:O,y:M,scale:R,width:r==="xAxis"?n.width:y.width,height:r==="yAxis"?n.height:y.height});return $.bandSize=Ly($,V),!y.hide&&r==="xAxis"?u[j]+=(N?-1:1)*$.height:y.hide||(u[j]+=(N?-1:1)*$.width),la(la({},f),{},ng({},p,$))},{})},iH=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},mNe=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return iH({x:t,y:n},{x:r,y:a})},sH=function(){function e(t){dNe(this,e),this.scale=t}return fNe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();ng(sH,"EPS",1e-4);var kC=function(e){var t=Object.keys(e).reduce(function(n,r){return la(la({},n),{},ng({},r,sH.create(e[r])))},{});return la(la({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return VCe(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return GW(n,function(r,a){return t[a].isInRange(r)})}})};function yNe(e){return(e%180+180)%180}var gNe=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=yNe(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},AC,cH;function vNe(){if(cH)return AC;cH=1;var e=xa(),t=Ni(),n=zl();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return AC=r,AC}var TC,lH;function bNe(){if(lH)return TC;lH=1;var e=fz(),t=xa(),n=U$(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return TC=a,TC}var IC,uH;function wNe(){if(uH)return IC;uH=1;var e=vNe(),t=bNe(),n=e(t);return IC=n,IC}var xNe=wNe();const _Ne=ot(xNe);var jNe=DR(),SNe=ot(jNe)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),RC=g.createContext(void 0),DC=g.createContext(void 0),dH=g.createContext(void 0),fH=g.createContext({}),pH=g.createContext(void 0),hH=g.createContext(0),mH=g.createContext(0),yH=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=SNe(a);return H.createElement(RC.Provider,{value:n},H.createElement(DC.Provider,{value:r},H.createElement(fH.Provider,{value:a},H.createElement(dH.Provider,{value:l},H.createElement(pH.Provider,{value:o},H.createElement(hH.Provider,{value:c},H.createElement(mH.Provider,{value:s},i)))))))},ENe=function(){return g.useContext(pH)},gH=function(e){var t=g.useContext(RC);t==null&&ms();var n=t[e];return n==null&&ms(),n},ONe=function(){var e=g.useContext(RC);return yi(e)},CNe=function(){var e=g.useContext(DC),t=_Ne(e,function(n){return GW(n.domain,Number.isFinite)});return t||yi(e)},vH=function(e){var t=g.useContext(DC);t==null&&ms();var n=t[e];return n==null&&ms(),n},NNe=function(){var e=g.useContext(dH);return e},MNe=function(){return g.useContext(fH)},LC=function(){return g.useContext(mH)},$C=function(){return g.useContext(hH)};function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function PNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_H(r.key),r)}}function ANe(e,t,n){return t&&kNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TNe(e,t,n){return t=rg(t),INe(e,bH()?Reflect.construct(t,n||[],rg(e).constructor):t.apply(e,n))}function INe(e,t){if(t&&(fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RNe(e)}function RNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bH=function(){return!!e})()}function rg(e){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rg(e)}function DNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FC(e,t)}function FC(e,t){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},FC(e,t)}function wH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function xH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wH(Object(n),!0).forEach(function(r){BC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BC(e,t,n){return t=_H(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _H(e){var t=LNe(e,"string");return fl(t)=="symbol"?t:t+""}function LNe(e,t){if(fl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ne(e,t){return VNe(e)||zNe(e,t)||BNe(e,t)||FNe()}function FNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BNe(e,t){if(e){if(typeof e=="string")return jH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jH(e,t)}}function jH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function VNe(e){if(Array.isArray(e))return e}function zC(){return zC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zC.apply(this,arguments)}var UNe=function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):tt(e)?n=e(t):n=H.createElement("line",zC({},t,{className:"recharts-reference-line-line"})),n},WNe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,f=a.height;if(n){var p=c.y,y=e.y.apply(p,{position:o});if(Fa(c,"discard")&&!e.y.isInRange(y))return null;var m=[{x:l+d,y},{x:l,y}];return s==="left"?m.reverse():m}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(Fa(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+f},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var _=c.segment,x=_.map(function(j){return e.apply(j,{position:o})});return Fa(c,"discard")&&FCe(x,function(j){return!e.isInRange(j)})?null:x}return null};function HNe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=ENe(),u=gH(a),d=vH(o),f=NNe();if(!l||!f)return null;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=kC({x:u.scale,y:d.scale}),y=sn(t),m=sn(n),v=r&&r.length===2,b=WNe(p,y,m,v,f,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=$Ne(b,2),_=w[0],x=_.x,j=_.y,S=w[1],E=S.x,O=S.y,M=Fa(e,"hidden")?"url(#".concat(l,")"):void 0,N=xH(xH({clipPath:M},yt(e,!0)),{},{x1:x,y1:j,x2:E,y2:O});return H.createElement(pn,{className:xt("recharts-reference-line",s)},UNe(i,N),Mn.renderCallByParent(e,mNe({x1:x,y1:j,x2:E,y2:O})))}var VC=function(e){function t(){return PNe(this,t),TNe(this,t,arguments)}return DNe(t,e),ANe(t,[{key:"render",value:function(){return H.createElement(HNe,this.props)}}])}(H.Component);BC(VC,"displayName","ReferenceLine"),BC(VC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function UC(){return UC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UC.apply(this,arguments)}function pl(e){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(e)}function SH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function EH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(n),!0).forEach(function(r){og(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,CH(r.key),r)}}function YNe(e,t,n){return t&&KNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GNe(e,t,n){return t=ag(t),XNe(e,OH()?Reflect.construct(t,n||[],ag(e).constructor):t.apply(e,n))}function XNe(e,t){if(t&&(pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZNe(e)}function ZNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OH=function(){return!!e})()}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ag(e)}function JNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WC(e,t)}function WC(e,t){return WC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},WC(e,t)}function og(e,t,n){return t=CH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CH(e){var t=QNe(e,"string");return pl(t)=="symbol"?t:t+""}function QNe(e,t){if(pl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(pl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eMe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=kC({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return Fa(e,"discard")&&!o.isInRange(i)?null:i},ig=function(e){function t(){return qNe(this,t),GNe(this,t,arguments)}return JNe(t,e),YNe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=sn(r),l=sn(a);if(Po(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=eMe(this.props);if(!u)return null;var d=u.x,f=u.y,p=this.props,y=p.shape,m=p.className,v=Fa(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=EH(EH({clipPath:v},yt(this.props,!0)),{},{cx:d,cy:f});return H.createElement(pn,{className:xt("recharts-reference-dot",m)},t.renderDot(y,b),Mn.renderCallByParent(this.props,{x:d-o,y:f-o,width:2*o,height:2*o}))}}])}(H.Component);og(ig,"displayName","ReferenceDot"),og(ig,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),og(ig,"renderDot",function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):tt(e)?n=e(t):n=H.createElement(_W,UC({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function HC(){return HC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HC.apply(this,arguments)}function hl(e){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}function NH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function MH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NH(Object(n),!0).forEach(function(r){cg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kH(r.key),r)}}function rMe(e,t,n){return t&&nMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aMe(e,t,n){return t=sg(t),oMe(e,PH()?Reflect.construct(t,n||[],sg(e).constructor):t.apply(e,n))}function oMe(e,t){if(t&&(hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iMe(e)}function iMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PH=function(){return!!e})()}function sg(e){return sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sg(e)}function sMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qC(e,t)}function qC(e,t){return qC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},qC(e,t)}function cg(e,t,n){return t=kH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kH(e){var t=cMe(e,"string");return hl(t)=="symbol"?t:t+""}function cMe(e,t){if(hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lMe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=kC({x:l.scale,y:u.scale}),f={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},p={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Fa(a,"discard")&&(!d.isInRange(f)||!d.isInRange(p))?null:iH(f,p)},lg=function(e){function t(){return tMe(this,t),aMe(this,t,arguments)}return sMe(t,e),rMe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=sn(r),d=sn(a),f=sn(o),p=sn(i),y=this.props.shape;if(!u&&!d&&!f&&!p&&!y)return null;var m=lMe(u,d,f,p,this.props);if(!m&&!y)return null;var v=Fa(this.props,"hidden")?"url(#".concat(l,")"):void 0;return H.createElement(pn,{className:xt("recharts-reference-area",s)},t.renderRect(y,MH(MH({clipPath:v},yt(this.props,!0)),m)),Mn.renderCallByParent(this.props,m))}}])}(H.Component);cg(lg,"displayName","ReferenceArea"),cg(lg,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),cg(lg,"renderRect",function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):tt(e)?n=e(t):n=H.createElement(pC,HC({},t,{className:"recharts-reference-area-rect"})),n});function AH(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function uMe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return gNe(r,n)}function dMe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function ug(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function fMe(e,t){return AH(e,t+1)}function pMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var p=r==null?void 0:r[c];if(p===void 0)return{v:AH(r,l)};var y=c,m,v=function(){return m===void 0&&(m=n(p,y)),m},b=p.coordinate,w=c===0||ug(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},f;l<=o.length;)if(f=d(),f)return f.v;return[]}function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function TH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TH(Object(n),!0).forEach(function(r){hMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hMe(e,t,n){return t=mMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mMe(e){var t=yMe(e,"string");return Ef(t)=="symbol"?t:t+""}function yMe(e,t){if(Ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var f=o[d],p,y=function(){return p===void 0&&(p=n(f,d)),p};if(d===i-1){var m=e*(f.coordinate+e*y()/2-c);o[d]=f=Pn(Pn({},f),{},{tickCoord:m>0?f.coordinate-m*e:f.coordinate})}else o[d]=f=Pn(Pn({},f),{},{tickCoord:f.coordinate});var v=ug(e,f.tickCoord,y,s,c);v&&(c=f.tickCoord-e*(y()/2+a),o[d]=Pn(Pn({},f),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function vMe(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);i[s-1]=u=Pn(Pn({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var p=ug(e,u.tickCoord,function(){return d},c,l);p&&(l=u.tickCoord-e*(d/2+a),i[s-1]=Pn(Pn({},u),{},{isShow:!0}))}for(var y=o?s-1:s,m=function(b){var w=i[b],_,x=function(){return _===void 0&&(_=n(w,b)),_};if(b===0){var j=e*(w.coordinate-e*x()/2-c);i[b]=w=Pn(Pn({},w),{},{tickCoord:j<0?w.coordinate-j*e:w.coordinate})}else i[b]=w=Pn(Pn({},w),{},{tickCoord:w.coordinate});var S=ug(e,w.tickCoord,x,c,l);S&&(c=w.tickCoord+e*(x()/2+a),i[b]=Pn(Pn({},w),{},{isShow:!0}))},v=0;v<y;v++)m(v);return i}function KC(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||gi.isSsr)return fMe(a,typeof c=="number"&&ye(c)?c:0);var f=[],p=s==="top"||s==="bottom"?"width":"height",y=u&&p==="width"?Bd(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(w,_){var x=tt(l)?l(w.value,_):w.value;return p==="width"?uMe(Bd(x,{fontSize:t,letterSpacing:n}),y,d):Bd(x,{fontSize:t,letterSpacing:n})[p]},v=a.length>=2?oa(a[1].coordinate-a[0].coordinate):1,b=dMe(o,v,p);return c==="equidistantPreserveStart"?pMe(v,b,m,a,i):(c==="preserveStart"||c==="preserveStartEnd"?f=vMe(v,b,m,a,i,c==="preserveStartEnd"):f=gMe(v,b,m,a,i),f.filter(function(w){return w.isShow}))}var bMe=["viewBox"],wMe=["viewBox"],xMe=["ticks"];function ml(e){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}function yl(){return yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yl.apply(this,arguments)}function IH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IH(Object(n),!0).forEach(function(r){XC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YC(e,t){if(e==null)return{};var n=_Me(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _Me(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function jMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,LH(r.key),r)}}function SMe(e,t,n){return t&&RH(e.prototype,t),n&&RH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function EMe(e,t,n){return t=dg(t),OMe(e,DH()?Reflect.construct(t,n||[],dg(e).constructor):t.apply(e,n))}function OMe(e,t){if(t&&(ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CMe(e)}function CMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DH=function(){return!!e})()}function dg(e){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dg(e)}function NMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GC(e,t)}function GC(e,t){return GC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},GC(e,t)}function XC(e,t,n){return t=LH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LH(e){var t=MMe(e,"string");return ml(t)=="symbol"?t:t+""}function MMe(e,t){if(ml(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gl=function(e){function t(n){var r;return jMe(this,t),r=EMe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return NMe(t,e),SMe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=YC(n,bMe),i=this.props,s=i.viewBox,c=YC(i,wMe);return!Wc(a,s)||!Wc(o,c)||!Wc(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,f,p,y,m,v,b,w=u?-1:1,_=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=p=n.coordinate,m=o+ +!u*s,y=m-w*_,b=y-w*d,v=x;break;case"left":y=m=n.coordinate,p=a+ +!u*i,f=p-w*_,v=f-w*d,b=x;break;case"right":y=m=n.coordinate,p=a+ +u*i,f=p+w*_,v=f+w*d,b=x;break;default:f=p=n.coordinate,m=o+ +u*s,y=m+w*_,b=y+w*d,v=x;break}return{line:{x1:f,y1:y,x2:p,y2:m},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=zn(zn(zn({},yt(this.props,!1)),yt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=zn(zn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var f=+(s==="left"&&!c||s==="right"&&c);u=zn(zn({},u),{},{x1:r+f*o,y1:a,x2:r+f*o,y2:a+i})}return H.createElement("line",yl({},u,{className:xt("recharts-cartesian-axis-line",xr(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,f=KC(zn(zn({},this.props),{},{ticks:n}),r,a),p=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),m=yt(this.props,!1),v=yt(l,!1),b=zn(zn({},m),{},{fill:"none"},yt(s,!1)),w=f.map(function(_,x){var j=o.getTickLineCoord(_),S=j.line,E=j.tick,O=zn(zn(zn(zn({textAnchor:p,verticalAnchor:y},m),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:_,visibleTicksCount:f.length,tickFormatter:u});return H.createElement(pn,yl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},qm(o.props,_,x)),s&&H.createElement("line",yl({},b,S,{className:xt("recharts-cartesian-axis-tick-line",xr(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(tt(u)?u(_.value,x):_.value).concat(d||"")))});return H.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,f=YC(u,xMe),p=d;return tt(s)&&(p=d&&d.length>0?s(this.props):s(f)),o<=0||i<=0||!p||!p.length?null:H.createElement(pn,{className:xt("recharts-cartesian-axis",c),ref:function(y){n.layerReference=y}},a&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Mn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return H.isValidElement(n)?o=H.cloneElement(n,r):tt(n)?o=n(r):o=H.createElement(fy,yl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);XC(gl,"displayName","CartesianAxis"),XC(gl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var PMe=["x1","y1","x2","y2","key"],kMe=["offset"];function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function $H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$H(Object(n),!0).forEach(function(r){AMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$H(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AMe(e,t,n){return t=TMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TMe(e){var t=IMe(e,"string");return bs(t)=="symbol"?t:t+""}function IMe(e,t){if(bs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ws(){return ws=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ws.apply(this,arguments)}function FH(e,t){if(e==null)return{};var n=RMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var DMe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return H.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function BH(e,t){var n;if(H.isValidElement(e))n=H.cloneElement(e,t);else if(tt(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=FH(t,PMe),l=yt(c,!1);l.offset;var u=FH(l,kMe);n=H.createElement("line",ws({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function LMe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return BH(a,l)});return H.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function $Me(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return BH(a,l)});return H.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function FMe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var y=!u[p+1],m=y?a+i-f:u[p+1]-f;if(m<=0)return null;var v=p%t.length;return H.createElement("rect",{key:"react-".concat(p),y:f,x:r,height:m,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return H.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function BMe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(f){return Math.round(f+o-o)}).sort(function(f,p){return f-p});o!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var y=!u[p+1],m=y?o+s-f:u[p+1]-f;if(m<=0)return null;var v=p%r.length;return H.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:m,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return H.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var zMe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return gU(KC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:Fo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},VMe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return gU(KC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:Fo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},vl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function zH(e){var t,n,r,a,o,i,s=LC(),c=$C(),l=MNe(),u=kn(kn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:vl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:vl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:vl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:vl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:vl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:vl.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,f=u.y,p=u.width,y=u.height,m=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=ONe(),_=CNe();if(!ye(p)||p<=0||!ye(y)||y<=0||!ye(d)||d!==+d||!ye(f)||f!==+f)return null;var x=u.verticalCoordinatesGenerator||zMe,j=u.horizontalCoordinatesGenerator||VMe,S=u.horizontalPoints,E=u.verticalPoints;if((!S||!S.length)&&tt(j)){var O=v&&v.length,M=j({yAxis:_?kn(kn({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:m);Po(Array.isArray(M),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(bs(M),"]")),Array.isArray(M)&&(S=M)}if((!E||!E.length)&&tt(x)){var N=b&&b.length,P=x({xAxis:w?kn(kn({},w),{},{ticks:N?b:w.ticks}):void 0,width:s,height:c,offset:l},N?!0:m);Po(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(bs(P),"]")),Array.isArray(P)&&(E=P)}return H.createElement("g",{className:"recharts-cartesian-grid"},H.createElement(DMe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),H.createElement(LMe,ws({},u,{offset:l,horizontalPoints:S,xAxis:w,yAxis:_})),H.createElement($Me,ws({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:_})),H.createElement(FMe,ws({},u,{horizontalPoints:S})),H.createElement(BMe,ws({},u,{verticalPoints:E})))}zH.displayName="CartesianGrid";function bl(e){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function UMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WH(r.key),r)}}function HMe(e,t,n){return t&&WMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qMe(e,t,n){return t=fg(t),KMe(e,VH()?Reflect.construct(t,n||[],fg(e).constructor):t.apply(e,n))}function KMe(e,t){if(t&&(bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YMe(e)}function YMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VH=function(){return!!e})()}function fg(e){return fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fg(e)}function GMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZC(e,t)}function ZC(e,t){return ZC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ZC(e,t)}function UH(e,t,n){return t=WH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WH(e){var t=XMe(e,"string");return bl(t)=="symbol"?t:t+""}function XMe(e,t){if(bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JC(){return JC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JC.apply(this,arguments)}function ZMe(e){var t=e.xAxisId,n=LC(),r=$C(),a=gH(t);return a==null?null:H.createElement(gl,JC({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Fo(o,!0)}}))}var pg=function(e){function t(){return UMe(this,t),qMe(this,t,arguments)}return GMe(t,e),HMe(t,[{key:"render",value:function(){return H.createElement(ZMe,this.props)}}])}(H.Component);UH(pg,"displayName","XAxis"),UH(pg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function JMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,KH(r.key),r)}}function ePe(e,t,n){return t&&QMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tPe(e,t,n){return t=hg(t),nPe(e,HH()?Reflect.construct(t,n||[],hg(e).constructor):t.apply(e,n))}function nPe(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rPe(e)}function rPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HH=function(){return!!e})()}function hg(e){return hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hg(e)}function aPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QC(e,t)}function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QC(e,t)}function qH(e,t,n){return t=KH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KH(e){var t=oPe(e,"string");return wl(t)=="symbol"?t:t+""}function oPe(e,t){if(wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eN(){return eN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eN.apply(this,arguments)}var iPe=function(e){var t=e.yAxisId,n=LC(),r=$C(),a=vH(t);return a==null?null:H.createElement(gl,eN({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Fo(o,!0)}}))},tN=function(e){function t(){return JMe(this,t),tPe(this,t,arguments)}return aPe(t,e),ePe(t,[{key:"render",value:function(){return H.createElement(iPe,this.props)}}])}(H.Component);qH(tN,"displayName","YAxis"),qH(tN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function YH(e){return uPe(e)||lPe(e)||cPe(e)||sPe()}function sPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cPe(e,t){if(e){if(typeof e=="string")return nN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nN(e,t)}}function lPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uPe(e){if(Array.isArray(e))return nN(e)}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rN=function(e,t,n,r,a){var o=ia(e,VC),i=ia(e,ig),s=[].concat(YH(o),YH(i)),c=ia(e,lg),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(y,m){if(m.props[l]===n&&Fa(m.props,"extendDomain")&&ye(m.props[u])){var v=m.props[u];return[Math.min(y[0],v),Math.max(y[1],v)]}return y},d)),c.length){var f="".concat(u,"1"),p="".concat(u,"2");d=c.reduce(function(y,m){if(m.props[l]===n&&Fa(m.props,"extendDomain")&&ye(m.props[f])&&ye(m.props[p])){var v=m.props[f],b=m.props[p];return[Math.min(y[0],v,b),Math.max(y[1],v,b)]}return y},d)}return a&&a.length&&(d=a.reduce(function(y,m){return ye(m)?[Math.min(y[0],m),Math.max(y[1],m)]:y},d)),d},GH={exports:{}},XH;function dPe(){return XH||(XH=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,d||c,f),y=n?n+l:l;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],p]:c._events[y].push(p):(c._events[y]=p,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,f,p){var y=n?n+c:c;if(!this._events[y])return!1;var m=this._events[y],v=arguments.length,b,w;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,f),!0;case 6:return m.fn.call(m.context,l,u,d,f,p),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m.fn.apply(m.context,b)}else{var _=m.length,x;for(w=0;w<_;w++)switch(m[w].once&&this.removeListener(c,m[w].fn,void 0,!0),v){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,l);break;case 3:m[w].fn.call(m[w].context,l,u);break;case 4:m[w].fn.call(m[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];m[w].fn.apply(m[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var f=n?n+c:c;if(!this._events[f])return this;if(!l)return i(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&i(this,f);else{for(var y=0,m=[],v=p.length;y<v;y++)(p[y].fn!==l||d&&!p[y].once||u&&p[y].context!==u)&&m.push(p[y]);m.length?this._events[f]=m.length===1?m[0]:m:i(this,f)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(GH)),GH.exports}var fPe=dPe();const pPe=ot(fPe);var aN=new pPe,oN="recharts.syncMouseEvents";function Of(e){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(e)}function hPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ZH(r.key),r)}}function yPe(e,t,n){return t&&mPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iN(e,t,n){return t=ZH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZH(e){var t=gPe(e,"string");return Of(t)=="symbol"?t:t+""}function gPe(e,t){if(Of(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Of(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vPe=function(){function e(){hPe(this,e),iN(this,"activeIndex",0),iN(this,"coordinateList",[]),iN(this,"layout","horizontal")}return yPe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function bPe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function wPe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function JH(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=_n(t,n,r,a),s=_n(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function xPe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,f=_n(s,c,l,d),p=_n(s,c,u,d);r=f.x,a=f.y,o=p.x,i=p.y}else return JH(t);return[{x:r,y:a},{x:o,y:i}]}function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function QH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function mg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QH(Object(n),!0).forEach(function(r){_Pe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _Pe(e,t,n){return t=jPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jPe(e){var t=SPe(e,"string");return Cf(t)=="symbol"?t:t+""}function SPe(e,t){if(Cf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Cf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EPe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,f=e.chartName,p=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!p||!o||!i||f!=="ScatterChart"&&a!=="axis")return null;var y,m=zU;if(f==="ScatterChart")y=i,m=zOe;else if(f==="BarChart")y=wPe(d,i,c,u),m=pC;else if(d==="radial"){var v=JH(i),b=v.cx,w=v.cy,_=v.radius,x=v.startAngle,j=v.endAngle;y={cx:b,cy:w,startAngle:x,endAngle:j,innerRadius:_,outerRadius:_},m=LU}else y={points:xPe(d,i,c)},m=zU;var S=mg(mg(mg(mg({stroke:"#ccc",pointerEvents:"none"},c),y),yt(p,!1)),{},{payload:s,payloadIndex:l,className:xt("recharts-tooltip-cursor",p.className)});return g.isValidElement(p)?g.cloneElement(p,S):g.createElement(m,S)}var OPe=["item"],CPe=["children","className","width","height","style","compact","title","desc"];function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_l.apply(this,arguments)}function eq(e,t){return PPe(e)||MPe(e,t)||rq(e,t)||NPe()}function NPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function PPe(e){if(Array.isArray(e))return e}function tq(e,t){if(e==null)return{};var n=kPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function APe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oq(r.key),r)}}function IPe(e,t,n){return t&&TPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RPe(e,t,n){return t=yg(t),DPe(e,nq()?Reflect.construct(t,n||[],yg(e).constructor):t.apply(e,n))}function DPe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LPe(e)}function LPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nq=function(){return!!e})()}function yg(e){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yg(e)}function $Pe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sN(e,t)}function sN(e,t){return sN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},sN(e,t)}function jl(e){return zPe(e)||BPe(e)||rq(e)||FPe()}function FPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rq(e,t){if(e){if(typeof e=="string")return cN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cN(e,t)}}function BPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zPe(e){if(Array.isArray(e))return cN(e)}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aq(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=oq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oq(e){var t=VPe(e,"string");return xl(t)=="symbol"?t:t+""}function VPe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UPe={xAxis:["bottom","top"],yAxis:["left","right"]},WPe={width:"100%",height:"100%"},iq={x:0,y:0};function gg(e){return e}var HPe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},qPe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return ie(ie(ie({},r),_n(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return ie(ie(ie({},r),_n(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return iq},vg=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(jl(i),jl(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function sq(e){return e==="number"?[0,"auto"]:void 0}var lN=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=vg(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var f=u===void 0?i:u;d=kS(f,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(jl(s),[SU(c,d)]):s},[])},cq=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=HPe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=Dje(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=lN(e,t,l,u),f=qPe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:f}}return null},KPe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,f=yU(l,a);return n.reduce(function(p,y){var m,v=y.type.defaultProps!==void 0?ie(ie({},y.type.defaultProps),y.props):y.props,b=v.type,w=v.dataKey,_=v.allowDataOverflow,x=v.allowDuplicatedCategory,j=v.scale,S=v.ticks,E=v.includeHidden,O=v[o];if(p[O])return p;var M=vg(e.data,{graphicalItems:r.filter(function(V){var $,U=o in V.props?V.props[o]:($=V.type.defaultProps)===null||$===void 0?void 0:$[o];return U===O}),dataStartIndex:s,dataEndIndex:c}),N=M.length,P,I,k;bPe(v.domain,_,b)&&(P=GO(v.domain,null,_),f&&(b==="number"||j!=="auto")&&(k=Ry(M,w,"category")));var C=sq(b);if(!P||P.length===0){var A,T=(A=v.domain)!==null&&A!==void 0?A:C;if(w){if(P=Ry(M,w,b),b==="category"&&f){var D=Yve(P);x&&D?(I=P,P=Zy(0,N)):x||(P=jU(T,P,y).reduce(function(V,$){return V.indexOf($)>=0?V:[].concat(jl(V),[$])},[]))}else if(b==="category")x?P=P.filter(function(V){return V!==""&&!gt(V)}):P=jU(T,P,y).reduce(function(V,$){return V.indexOf($)>=0||$===""||gt($)?V:[].concat(jl(V),[$])},[]);else if(b==="number"){var L=zje(M,r.filter(function(V){var $,U,z=o in V.props?V.props[o]:($=V.type.defaultProps)===null||$===void 0?void 0:$[o],K="hide"in V.props?V.props.hide:(U=V.type.defaultProps)===null||U===void 0?void 0:U.hide;return z===O&&(E||!K)}),w,a,l);L&&(P=L)}f&&(b==="number"||j!=="auto")&&(k=Ry(M,w,"category"))}else f?P=Zy(0,N):i&&i[O]&&i[O].hasStack&&b==="number"?P=d==="expand"?[0,1]:wU(i[O].stackGroups,s,c):P=mU(M,r.filter(function(V){var $=o in V.props?V.props[o]:V.type.defaultProps[o],U="hide"in V.props?V.props.hide:V.type.defaultProps.hide;return $===O&&(E||!U)}),b,l,!0);if(b==="number")P=rN(u,P,O,a,S),T&&(P=GO(T,P,_));else if(b==="category"&&T){var R=T,F=P.every(function(V){return R.indexOf(V)>=0});F&&(P=R)}}return ie(ie({},p),{},Fe({},O,ie(ie({},v),{},{axisType:a,domain:P,categoricalDomain:k,duplicateDomain:I,originalDomain:(m=v.domain)!==null&&m!==void 0?m:C,isCategorical:f,layout:l})))},{})},YPe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=vg(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),f=d.length,p=yU(l,a),y=-1;return n.reduce(function(m,v){var b=v.type.defaultProps!==void 0?ie(ie({},v.type.defaultProps),v.props):v.props,w=b[o],_=sq("number");if(!m[w]){y++;var x;return p?x=Zy(0,f):i&&i[w]&&i[w].hasStack?(x=wU(i[w].stackGroups,s,c),x=rN(u,x,w,a)):(x=GO(_,mU(d,n.filter(function(j){var S,E,O=o in j.props?j.props[o]:(S=j.type.defaultProps)===null||S===void 0?void 0:S[o],M="hide"in j.props?j.props.hide:(E=j.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!M}),"number",l),r.defaultProps.allowDataOverflow),x=rN(u,x,w,a)),ie(ie({},m),{},Fe({},w,ie(ie({axisType:a},r.defaultProps),{},{hide:!0,orientation:xr(UPe,"".concat(a,".").concat(y%2),null),domain:x,originalDomain:_,isCategorical:p,layout:l})))}return m},{})},GPe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=ia(l,a),f={};return d&&d.length?f=KPe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(f=YPe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),f},XPe=function(e){var t=yi(e),n=Fo(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:BE(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:Ly(t,n)}},lq=function(e){var t=e.children,n=e.defaultShowTooltip,r=pr(t,ul),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},ZPe=function(e){return!e||!e.length?!1:e.some(function(t){var n=Mo(t&&t.type);return n&&n.indexOf("Bar")>=0})},uq=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},JPe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},f=pr(u,ul),p=pr(u,Yc),y=Object.keys(s).reduce(function(x,j){var S=s[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,x[E]+S.width)):x},{left:d.left||0,right:d.right||0}),m=Object.keys(o).reduce(function(x,j){var S=o[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,xr(x,"".concat(E))+S.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=ie(ie({},m),y),b=v.bottom;f&&(v.bottom+=f.props.height||ul.defaultProps.height),p&&t&&(v=Fje(v,r,n,t));var w=c-v.left-v.right,_=l-v.top-v.bottom;return ie(ie({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(_,0)})},QPe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},eke=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(m,v){var b=v.graphicalItems,w=v.stackGroups,_=v.offset,x=v.updateId,j=v.dataStartIndex,S=v.dataEndIndex,E=m.barSize,O=m.layout,M=m.barGap,N=m.barCategoryGap,P=m.maxBarSize,I=uq(O),k=I.numericAxisName,C=I.cateAxisName,A=ZPe(b),T=[];return b.forEach(function(D,L){var R=vg(m.data,{graphicalItems:[D],dataStartIndex:j,dataEndIndex:S}),F=D.type.defaultProps!==void 0?ie(ie({},D.type.defaultProps),D.props):D.props,V=F.dataKey,$=F.maxBarSize,U=F["".concat(k,"Id")],z=F["".concat(C,"Id")],K={},ne=s.reduce(function(Se,Ve){var We=v["".concat(Ve.axisType,"Map")],He=F["".concat(Ve.axisType,"Id")];We&&We[He]||Ve.axisType==="zAxis"||ms();var Mt=We[He];return ie(ie({},Se),{},Fe(Fe({},Ve.axisType,Mt),"".concat(Ve.axisType,"Ticks"),Fo(Mt)))},K),Q=ne[C],Y=ne["".concat(C,"Ticks")],q=w&&w[U]&&w[U].hasStack&&Qje(D,w[U].stackGroups),X=Mo(D.type).indexOf("Bar")>=0,te=Ly(Q,Y),B=[],ce=A&&Lje({barSize:E,stackGroups:w,totalSize:QPe(ne,C)});if(X){var re,le,je=gt($)?P:$,Le=(re=(le=Ly(Q,Y,!0))!==null&&le!==void 0?le:je)!==null&&re!==void 0?re:0;B=$je({barGap:M,barCategoryGap:N,bandSize:Le!==te?Le:te,sizeList:ce[z],maxBarSize:je}),Le!==te&&(B=B.map(function(Se){return ie(ie({},Se),{},{position:ie(ie({},Se.position),{},{offset:Se.position.offset-Le/2})})}))}var $e=D&&D.type&&D.type.getComposedData;$e&&T.push({props:ie(ie({},$e(ie(ie({},ne),{},{displayedData:R,props:m,dataKey:V,item:D,bandSize:te,barPosition:B,offset:_,stackedData:q,layout:O,dataStartIndex:j,dataEndIndex:S}))),{},Fe(Fe(Fe({key:D.key||"item-".concat(L)},k,ne[k]),C,ne[C]),"animationId",x)),childIndex:o0e(D,m.children),item:D})}),T},f=function(m,v){var b=m.props,w=m.dataStartIndex,_=m.dataEndIndex,x=m.updateId;if(!NB({props:b}))return null;var j=b.children,S=b.layout,E=b.stackOffset,O=b.data,M=b.reverseStackOrder,N=uq(S),P=N.numericAxisName,I=N.cateAxisName,k=ia(j,n),C=Xje(O,k,"".concat(P,"Id"),"".concat(I,"Id"),E,M),A=s.reduce(function(F,V){var $="".concat(V.axisType,"Map");return ie(ie({},F),{},Fe({},$,GPe(b,ie(ie({},V),{},{graphicalItems:k,stackGroups:V.axisType===P&&C,dataStartIndex:w,dataEndIndex:_}))))},{}),T=JPe(ie(ie({},A),{},{props:b,graphicalItems:k}),v==null?void 0:v.legendBBox);Object.keys(A).forEach(function(F){A[F]=l(b,A[F],T,F.replace("Map",""),t)});var D=A["".concat(I,"Map")],L=XPe(D),R=d(b,ie(ie({},A),{},{dataStartIndex:w,dataEndIndex:_,updateId:x,graphicalItems:k,stackGroups:C,offset:T}));return ie(ie({formattedGraphicalItems:R,graphicalItems:k,offset:T,stackGroups:C},L),A)},p=function(m){function v(b){var w,_,x;return APe(this,v),x=RPe(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new vPe),Fe(x,"handleLegendBBoxUpdate",function(j){if(j){var S=x.state,E=S.dataStartIndex,O=S.dataEndIndex,M=S.updateId;x.setState(ie({legendBBox:j},f({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:M},ie(ie({},x.state),{},{legendBBox:j}))))}}),Fe(x,"handleReceiveSyncEvent",function(j,S,E){if(x.props.syncId===j){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(S)}}),Fe(x,"handleBrushChange",function(j){var S=j.startIndex,E=j.endIndex;if(S!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return ie({dataStartIndex:S,dataEndIndex:E},f({props:x.props,dataStartIndex:S,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),Fe(x,"handleMouseEnter",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;tt(O)&&O(E,j)}}),Fe(x,"triggeredAfterMouseMove",function(j){var S=x.getMouseInfo(j),E=S?ie(ie({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;tt(O)&&O(E,j)}),Fe(x,"handleItemMouseEnter",function(j){x.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(j){j.persist(),x.throttleTriggeredAfterMouseMove(j)}),Fe(x,"handleMouseLeave",function(j){x.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var E=x.props.onMouseLeave;tt(E)&&E(S,j)}),Fe(x,"handleOuterEvent",function(j){var S=a0e(j),E=xr(x.props,"".concat(S));if(S&&tt(E)){var O,M;/.*touch.*/i.test(S)?M=x.getMouseInfo(j.changedTouches[0]):M=x.getMouseInfo(j),E((O=M)!==null&&O!==void 0?O:{},j)}}),Fe(x,"handleClick",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;tt(O)&&O(E,j)}}),Fe(x,"handleMouseDown",function(j){var S=x.props.onMouseDown;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleMouseUp",function(j){var S=x.props.onMouseUp;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Fe(x,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseDown(j.changedTouches[0])}),Fe(x,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseUp(j.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(j){x.props.syncId!==void 0&&aN.emit(oN,x.props.syncId,j,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(j){var S=x.props,E=S.layout,O=S.syncMethod,M=x.state.updateId,N=j.dataStartIndex,P=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)x.setState(ie({dataStartIndex:N,dataEndIndex:P},f({props:x.props,dataStartIndex:N,dataEndIndex:P,updateId:M},x.state)));else if(j.activeTooltipIndex!==void 0){var I=j.chartX,k=j.chartY,C=j.activeTooltipIndex,A=x.state,T=A.offset,D=A.tooltipTicks;if(!T)return;if(typeof O=="function")C=O(D,j);else if(O==="value"){C=-1;for(var L=0;L<D.length;L++)if(D[L].value===j.activeLabel){C=L;break}}var R=ie(ie({},T),{},{x:T.left,y:T.top}),F=Math.min(I,R.x+R.width),V=Math.min(k,R.y+R.height),$=D[C]&&D[C].value,U=lN(x.state,x.props.data,C),z=D[C]?{x:E==="horizontal"?D[C].coordinate:F,y:E==="horizontal"?V:D[C].coordinate}:iq;x.setState(ie(ie({},j),{},{activeLabel:$,activeCoordinate:z,activePayload:U,activeTooltipIndex:C}))}else x.setState(j)}),Fe(x,"renderCursor",function(j){var S,E=x.state,O=E.isTooltipActive,M=E.activeCoordinate,N=E.activePayload,P=E.offset,I=E.activeTooltipIndex,k=E.tooltipAxisBandSize,C=x.getTooltipEventType(),A=(S=j.props.active)!==null&&S!==void 0?S:O,T=x.props.layout,D=j.key||"_recharts-cursor";return H.createElement(EPe,{key:D,activeCoordinate:M,activePayload:N,activeTooltipIndex:I,chartName:t,element:j,isActive:A,layout:T,offset:P,tooltipAxisBandSize:k,tooltipEventType:C})}),Fe(x,"renderPolarAxis",function(j,S,E){var O=xr(j,"type.axisType"),M=xr(x.state,"".concat(O,"Map")),N=j.type.defaultProps,P=N!==void 0?ie(ie({},N),j.props):j.props,I=M&&M[P["".concat(O,"Id")]];return g.cloneElement(j,ie(ie({},I),{},{className:xt(O,I.className),key:j.key||"".concat(S,"-").concat(E),ticks:Fo(I,!0)}))}),Fe(x,"renderPolarGrid",function(j){var S=j.props,E=S.radialLines,O=S.polarAngles,M=S.polarRadius,N=x.state,P=N.radiusAxisMap,I=N.angleAxisMap,k=yi(P),C=yi(I),A=C.cx,T=C.cy,D=C.innerRadius,L=C.outerRadius;return g.cloneElement(j,{polarAngles:Array.isArray(O)?O:Fo(C,!0).map(function(R){return R.coordinate}),polarRadius:Array.isArray(M)?M:Fo(k,!0).map(function(R){return R.coordinate}),cx:A,cy:T,innerRadius:D,outerRadius:L,key:j.key||"polar-grid",radialLines:E})}),Fe(x,"renderLegend",function(){var j=x.state.formattedGraphicalItems,S=x.props,E=S.children,O=S.width,M=S.height,N=x.props.margin||{},P=O-(N.left||0)-(N.right||0),I=dU({children:E,formattedGraphicalItems:j,legendWidth:P,legendContent:c});if(!I)return null;var k=I.item,C=tq(I,OPe);return g.cloneElement(k,ie(ie({},C),{},{chartWidth:O,chartHeight:M,margin:N,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var j,S=x.props,E=S.children,O=S.accessibilityLayer,M=pr(E,Ra);if(!M)return null;var N=x.state,P=N.isTooltipActive,I=N.activeCoordinate,k=N.activePayload,C=N.activeLabel,A=N.offset,T=(j=M.props.active)!==null&&j!==void 0?j:P;return g.cloneElement(M,{viewBox:ie(ie({},A),{},{x:A.left,y:A.top}),active:T,label:C,payload:T?k:[],coordinate:I,accessibilityLayer:O})}),Fe(x,"renderBrush",function(j){var S=x.props,E=S.margin,O=S.data,M=x.state,N=M.offset,P=M.dataStartIndex,I=M.dataEndIndex,k=M.updateId;return g.cloneElement(j,{key:j.key||"_recharts-brush",onChange:Dy(x.handleBrushChange,j.props.onChange),data:O,x:ye(j.props.x)?j.props.x:N.left,y:ye(j.props.y)?j.props.y:N.top+N.height+N.brushBottom-(E.bottom||0),width:ye(j.props.width)?j.props.width:N.width,startIndex:P,endIndex:I,updateId:"brush-".concat(k)})}),Fe(x,"renderReferenceElement",function(j,S,E){if(!j)return null;var O=x,M=O.clipPathId,N=x.state,P=N.xAxisMap,I=N.yAxisMap,k=N.offset,C=j.type.defaultProps||{},A=j.props,T=A.xAxisId,D=T===void 0?C.xAxisId:T,L=A.yAxisId,R=L===void 0?C.yAxisId:L;return g.cloneElement(j,{key:j.key||"".concat(S,"-").concat(E),xAxis:P[D],yAxis:I[R],viewBox:{x:k.left,y:k.top,width:k.width,height:k.height},clipPathId:M})}),Fe(x,"renderActivePoints",function(j){var S=j.item,E=j.activePoint,O=j.basePoint,M=j.childIndex,N=j.isRange,P=[],I=S.props.key,k=S.item.type.defaultProps!==void 0?ie(ie({},S.item.type.defaultProps),S.item.props):S.item.props,C=k.activeDot,A=k.dataKey,T=ie(ie({index:M,dataKey:A,cx:E.x,cy:E.y,r:4,fill:KO(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},yt(C,!1)),Hm(C));return P.push(v.renderActiveDot(C,T,"".concat(I,"-activePoint-").concat(M))),O?P.push(v.renderActiveDot(C,ie(ie({},T),{},{cx:O.x,cy:O.y}),"".concat(I,"-basePoint-").concat(M))):N&&P.push(null),P}),Fe(x,"renderGraphicChild",function(j,S,E){var O=x.filterFormatItem(j,S,E);if(!O)return null;var M=x.getTooltipEventType(),N=x.state,P=N.isTooltipActive,I=N.tooltipAxis,k=N.activeTooltipIndex,C=N.activeLabel,A=x.props.children,T=pr(A,Ra),D=O.props,L=D.points,R=D.isRange,F=D.baseLine,V=O.item.type.defaultProps!==void 0?ie(ie({},O.item.type.defaultProps),O.item.props):O.item.props,$=V.activeDot,U=V.hide,z=V.activeBar,K=V.activeShape,ne=!!(!U&&P&&T&&($||z||K)),Q={};M!=="axis"&&T&&T.props.trigger==="click"?Q={onClick:Dy(x.handleItemMouseEnter,j.props.onClick)}:M!=="axis"&&(Q={onMouseLeave:Dy(x.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:Dy(x.handleItemMouseEnter,j.props.onMouseEnter)});var Y=g.cloneElement(j,ie(ie({},O.props),Q));function q(We){return typeof I.dataKey=="function"?I.dataKey(We.payload):null}if(ne)if(k>=0){var X,te;if(I.dataKey&&!I.allowDuplicatedCategory){var B=typeof I.dataKey=="function"?q:"payload.".concat(I.dataKey.toString());X=kS(L,B,C),te=R&&F&&kS(F,B,C)}else X=L==null?void 0:L[k],te=R&&F&&F[k];if(K||z){var ce=j.props.activeIndex!==void 0?j.props.activeIndex:k;return[g.cloneElement(j,ie(ie(ie({},O.props),Q),{},{activeIndex:ce})),null,null]}if(!gt(X))return[Y].concat(jl(x.renderActivePoints({item:O,activePoint:X,basePoint:te,childIndex:k,isRange:R})))}else{var re,le=(re=x.getItemByXY(x.state.activeCoordinate))!==null&&re!==void 0?re:{graphicalItem:Y},je=le.graphicalItem,Le=je.item,$e=Le===void 0?j:Le,Se=je.childIndex,Ve=ie(ie(ie({},O.props),Q),{},{activeIndex:Se});return[g.cloneElement($e,Ve),null,null]}return R?[Y,null,null]:[Y,null]}),Fe(x,"renderCustomized",function(j,S,E){return g.cloneElement(j,ie(ie({key:"recharts-customized-".concat(E)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:gg,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:gg},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:gg},YAxis:{handler:gg},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Wm("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Ig(x.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),x.state={},x}return $Pe(v,m),IPe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,x=b.height,j=b.layout,S=pr(w,Ra);if(S){var E=S.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,M=lN(this.state,_,E,O),N=this.state.tooltipTicks[E].coordinate,P=(this.state.offset.top+x)/2,I=j==="horizontal",k=I?{x:N,y:P}:{y:N,x:P},C=this.state.formattedGraphicalItems.find(function(T){var D=T.item;return D.type.name==="Scatter"});C&&(k=ie(ie({},k),C.props.points[E].tooltipPosition),M=C.props.points[E].tooltipPayload);var A={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:M,activeCoordinate:k};this.setState(A),this.renderCursor(S),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,x;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){LS([pr(b.children,Ra)],[pr(this.props.children,Ra)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=pr(this.props.children,Ra);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),x=Zwe(_),j={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},S=_.width/w.offsetWidth||1,E=this.inRange(j.chartX,j.chartY,S);if(!E)return null;var O=this.state,M=O.xAxisMap,N=O.yAxisMap,P=this.getTooltipEventType();if(P!=="axis"&&M&&N){var I=yi(M).scale,k=yi(N).scale,C=I&&I.invert?I.invert(j.chartX):null,A=k&&k.invert?k.invert(j.chartY):null;return ie(ie({},j),{},{xValue:C,yValue:A})}var T=cq(this.state,this.props.data,this.props.layout,E);return T?ie(ie({},j),T):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,j=b/_,S=w/_;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=j>=E.left&&j<=E.left+E.width&&S>=E.top&&S<=E.top+E.height;return O?{x:j,y:S}:null}var M=this.state,N=M.angleAxisMap,P=M.radiusAxisMap;if(N&&P){var I=yi(N);return CU({x:j,y:S},I)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=pr(b,Ra),x={};_&&w==="axis"&&(_.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var j=Hm(this.props,this.handleOuterEvent);return ie(ie({},j),x)}},{key:"addListener",value:function(){aN.on(oN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){aN.removeListener(oN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var x=this.state.formattedGraphicalItems,j=0,S=x.length;j<S;j++){var E=x[j];if(E.item===b||E.props.key===b.key||w===Mo(E.item.type)&&_===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,x=w.top,j=w.height,S=w.width;return H.createElement("defs",null,H.createElement("clipPath",{id:b},H.createElement("rect",{x:_,y:x,height:j,width:S})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=eq(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=eq(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,x=w.activeItem;if(_&&_.length)for(var j=0,S=_.length;j<S;j++){var E=_[j],O=E.props,M=E.item,N=M.type.defaultProps!==void 0?ie(ie({},M.type.defaultProps),M.props):M.props,P=Mo(M.type);if(P==="Bar"){var I=(O.data||[]).find(function(T){return kOe(b,T)});if(I)return{graphicalItem:E,payload:I}}else if(P==="RadialBar"){var k=(O.data||[]).find(function(T){return CU(b,T)});if(k)return{graphicalItem:E,payload:k}}else if(Gy(E,x)||Xy(E,x)||wf(E,x)){var C=bCe({graphicalItem:E,activeTooltipItem:x,itemData:N.data}),A=N.activeIndex===void 0?C:N.activeIndex;return{graphicalItem:ie(ie({},E),{},{childIndex:A}),payload:wf(E,x)?N.data[C]:E.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!NB(this))return null;var w=this.props,_=w.children,x=w.className,j=w.width,S=w.height,E=w.style,O=w.compact,M=w.title,N=w.desc,P=tq(w,CPe),I=yt(P,!1);if(O)return H.createElement(yH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},H.createElement(FS,_l({},I,{width:j,height:S,title:M,desc:N}),this.renderClipPath(),PB(_,this.renderMap)));if(this.props.accessibilityLayer){var k,C;I.tabIndex=(k=this.props.tabIndex)!==null&&k!==void 0?k:0,I.role=(C=this.props.role)!==null&&C!==void 0?C:"application",I.onKeyDown=function(T){b.accessibilityManager.keyboardEvent(T)},I.onFocus=function(){b.accessibilityManager.focus()}}var A=this.parseEventsOfWrapper();return H.createElement(yH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},H.createElement("div",_l({className:xt("recharts-wrapper",x),style:ie({position:"relative",cursor:"default",width:j,height:S},E)},A,{ref:function(T){b.container=T}}),H.createElement(FS,_l({},I,{width:j,height:S,title:M,desc:N,style:WPe}),this.renderClipPath(),PB(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(p,"displayName",t),Fe(p,"defaultProps",ie({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(p,"getDerivedStateFromProps",function(m,v){var b=m.dataKey,w=m.data,_=m.children,x=m.width,j=m.height,S=m.layout,E=m.stackOffset,O=m.margin,M=v.dataStartIndex,N=v.dataEndIndex;if(v.updateId===void 0){var P=lq(m);return ie(ie(ie({},P),{},{updateId:0},f(ie(ie({props:m},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||j!==v.prevHeight||S!==v.prevLayout||E!==v.prevStackOffset||!Wc(O,v.prevMargin)){var I=lq(m),k={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=ie(ie({},cq(v,w,S)),{},{updateId:v.updateId+1}),A=ie(ie(ie({},I),k),C);return ie(ie(ie({},A),f(ie({props:m},A),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(!LS(_,v.prevChildren)){var T,D,L,R,F=pr(_,ul),V=F&&(T=(D=F.props)===null||D===void 0?void 0:D.startIndex)!==null&&T!==void 0?T:M,$=F&&(L=(R=F.props)===null||R===void 0?void 0:R.endIndex)!==null&&L!==void 0?L:N,U=V!==M||$!==N,z=!gt(w),K=z&&!U?v.updateId:v.updateId+1;return ie(ie({updateId:K},f(ie(ie({props:m},v),{},{updateId:K,dataStartIndex:V,dataEndIndex:$}),v)),{},{prevChildren:_,dataStartIndex:V,dataEndIndex:$})}return null}),Fe(p,"renderActiveDot",function(m,v,b){var w;return g.isValidElement(m)?w=g.cloneElement(m,v):tt(m)?w=m(v):w=H.createElement(_W,v),H.createElement(pn,{className:"recharts-active-dot",key:b},w)});var y=g.forwardRef(function(m,v){return H.createElement(p,_l({},m,{ref:v}))});return y.displayName=p.displayName,y},tke=eke({chartName:"BarChart",GraphicalChild:vs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:pg},{axisType:"yAxis",AxisComp:tN}],formatAxisMap:hNe});const nke={light:"",dark:".dark"},dq=g.createContext(null);function fq(){const e=g.useContext(dq);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const pq=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(dq.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:G("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(rke,{id:s,config:r}),h.jsx(Wwe,{children:n})]})})});pq.displayName="Chart";const rke=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(nke).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},ake=Ra,hq=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:f},p)=>{const{config:y}=fq(),m=g.useMemo(()=>{var j;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${f||b.dataKey||b.name||"value"}`,_=uN(y,b,w),x=!f&&typeof i=="string"?((j=y[i])==null?void 0:j.label)||i:_==null?void 0:_.label;return s?h.jsx("div",{className:G("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:G("font-medium",c),children:x}):null},[i,s,t,a,c,y,f]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:p,className:G("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:m,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const _=`${d||b.name||b.dataKey||"value"}`,x=uN(y,b,_),j=u||b.payload.fill||b.color;return h.jsx("div",{className:G("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:G("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),h.jsxs("div",{className:G("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?m:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});hq.displayName="ChartTooltip";const oke=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=fq();return n!=null&&n.length?h.jsx("div",{ref:o,className:G("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=uN(i,s,c);return h.jsxs("div",{className:G("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});oke.displayName="ChartLegend";function uN(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const mq=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},ike=g.memo(()=>{const{t:e}=Pe("flows"),[t,n]=g.useState(),r=Ua(y=>y.cachedLLMURLs),a=Qe(y=>y.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{At(async()=>{const{functionCallingModelIds:y,prebuiltAppConfig:m}=await import("./index-CuU07XIu.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:y,prebuiltAppConfig:m}},__vite__mapDeps([5,1,2,3,4])).then(({functionCallingModelIds:y,prebuiltAppConfig:m})=>{n(r==null?void 0:r.map(v=>{const b=m.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:y.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const f=g.useCallback(async()=>{navigator.storage.estimate().then(y=>{y&&c(e("session_info_node.used_bytes",{used:mq(y.usage),total:mq(y==null?void 0:y.quota)}))}),a!=null&&a.id&&(Promise.all([ue("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(y=>{const m=y.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(m)}),Promise.all([ue("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),ue("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),ue("Thread").count({where:{session_id:a==null?void 0:a.id}}),ue("Prompt").count({where:{session_id:a==null?void 0:a.id}}),ue("LLM").count({where:{session_id:a==null?void 0:a.id}}),ue("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),ue("Schema").count({where:{session_id:a==null?void 0:a.id}}),ue("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),ue("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),ue("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([y,m,v,b,w,_,x,j,S,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:y||0,edges:m||0,threads:v||0,prompts:b||0,llms:w||0,tools:_||0,schemas:x||0,vectorDatabases:j||0,jsonlDatas:S||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),p=g.useCallback(()=>{f()},[f]);return g.useEffect(()=>{f()},[f]),h.jsxs(Gt,{className:"w-96",children:[h.jsxs(Ln,{children:[h.jsx(Kn,{children:e("session_info_node.title")}),h.jsx(h8,{children:o||a!=null&&a.updated_at?QAe(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs($n,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(un,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(y=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[y==null?void 0:y.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(_d,{model:y==null?void 0:y.info,isFunctionCalling:(y==null?void 0:y.isFunctionCalling)||!1,isCached:!0})})]},y==null?void 0:y.model_id))]})}),h.jsx("div",{children:h.jsx(pq,{config:d,className:"min-h-28 w-full",children:h.jsxs(tke,{accessibilityLayer:!0,data:l,children:[h.jsx(zH,{vertical:!1}),h.jsx(pg,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(ake,{content:h.jsx(hq,{})}),Object.entries(d).map(([y,m])=>h.jsx(vs,{dataKey:y,fill:m.color,radius:4},y))]})})})]}),h.jsx(ci,{children:h.jsxs(ut,{className:"w-full",onClick:p,children:[h.jsx(de,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),ske=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},cke=g.memo(e=>{var c,l;const{t}=Pe("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Tn(n),s=De(u=>u.updateNodes);return ske(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,ue("SchemaItem").find({where:{schema_id:u.id}}).then(f=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:f}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:n}),h.jsxs(vj,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(wm,{className:"grid w-full grid-cols-2",children:[h.jsx(na,{value:"account",children:t("schema_node.typescript")}),h.jsx(na,{value:"password",children:t("schema_node.zod")})]}),h.jsx(ra,{value:"account",children:h.jsx(Gt,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:Vpe(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(ra,{value:"password",children:h.jsx(Gt,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:p8(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:a})]})}),lke=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=Pg(n.entity.csv);return{headers:CN(n.entity.headers),rows:s.map(c=>CN(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Gt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Am,{data:a.rows,headers:a.headers})})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),uke=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},dke=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return uke(e),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Ia,{className:"flex justify-center",children:[h.jsx(de,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Co,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(zc,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:n})]})}),fke=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);An(e,t)},pke=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return fke(t),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Ia,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(ka,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(Co,{children:`${n.model||""}`})})]})}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),hke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,mke=Ha(e=>{const{source:t,documents:n}=e,r=Yt(),{toast:a}=tn(),{t:o}=Pe("dialogs"),{loading:i,createPrompt:s}=W9(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(Qo,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(xS,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:hke}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),yke=()=>{const e=Qe(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,f;try{const p=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!p||!e)throw new Error("Source or Session not found");n(!0);const y=((u=s.position)==null?void 0:u.x)||0,m=(((d=s.position)==null?void 0:d.y)||0)+(((f=s.measured)==null?void 0:f.height)||0),v=await ue("Prompt").save({...i,status:(i==null?void 0:i.status)||Ga.Started,role:(i==null?void 0:i.role)||nr.System,type:(i==null?void 0:i.type)||rr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:oe.Prompt,x:y,y:m+20});if(!b)throw new Error("Failed to save prompt node");const w=await ue("FlowNodePlaceholder").save({placeholder:`Retriever for ${p.name}`,placeholder_type:Ts.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const _=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:oe.PlaceHolder,x:y,y:m+40});if(!_)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:_.id}),await a({source:s.id,target:_.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},gke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,vke=Ha(e=>{const{source:t}=e,n=Yt(),{toast:r}=tn(),{t:a}=Pe("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=yke(),d=async y=>{try{const m=y.content;if(!m||!m.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:m},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},f=y=>{i(y.target.value?Number(y.target.value):void 0)},p=y=>{c(y.target.value?Number(y.target.value):void 0)};return h.jsx(Qo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(xS,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:gke}),h.jsxs(Gt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs($n,{children:[h.jsx(nt,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(En,{value:o||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(nt,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(En,{value:s||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),bke=e=>{const t=De(a=>a.createOrUpdateFlowEdge),n=Ss(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===oe.CSVData&&(o==null?void 0:o.type)===oe.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=bK(u.headers,u.csv),f=d.map(p=>new Lf({pageContent:`${p.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},f),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);An(e,r)},wke=e=>{const[t,n]=g.useState(!1),{t:r}=Pe("flows"),{toast:a}=tn(),{getNode:o,getHandleConnections:i}=lr(),s=De(f=>f.updateNodes),c=Ss(f=>f.index),l=Ss(f=>f.similaritySearchWithScore),u=g.useCallback(async(f,p)=>{var y,m,v;try{const b=o(e);if(!b)return;const w=(y=b.data)==null?void 0:y.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===kr.DataNode){const _=(v=(m=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[oe.JSONLData,oe.CSVData].includes(x==null?void 0:x.type)))==null?void 0:m.data)==null?void 0:v.entity;if(!_){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:_.id,dataSourceType:ON(_)},f,p==null?void 0:p.k)}else return n(!0),await l({databaseId:w.id},f,p==null?void 0:p.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(f,p)=>{var y,m,v,b;try{const w=o(e);if(!w)return;n(!0);const _=f.content?[new Lf({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(_!=null&&_.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(y=w.data)==null?void 0:y.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===kr.DataNode){const j=i({nodeId:e,type:"target"}).map(N=>o(N.source)).find(N=>(N==null?void 0:N.type)&&[oe.JSONLData,oe.CSVData].includes(N==null?void 0:N.type)),S=(m=j==null?void 0:j.data)==null?void 0:m.entity;if(!S){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=ON(S),O=Vj(_,10);let M=0;for(const N of O){if((v=p==null?void 0:p.onProgressReport)==null||v.call(p,{handling:N.length,handled:M,total:_.length}),await c({databaseId:x.id,dataSourceId:S.id,dataSourceType:E},N),E&&j){const P=await ue(E).findOne({where:{id:S.id}});s([{type:"replace",id:j.id,item:{...j,data:{...j.data,entity:P}}}])}M+=N.length}}else{const j=Vj(_,10);let S=0;for(const E of j){(b=p==null?void 0:p.onProgressReport)==null||b.call(p,{handling:E.length,handled:S,total:_.length}),await c({databaseId:x.id},E);const O=await ue("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),S+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},xke=g.memo(e=>{var S,E,O,M;const{t}=Pe("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Tn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:f}=wke(s),p=Yt(mke),y=Yt(vke);bke(s);const m=g.useCallback(async(...N)=>{i&&await f(...N)},[f,i]),v=g.useCallback(async(N,P)=>{const I=N.trim(),k=await d(I,{k:P});if(k!=null&&k.length)return k},[d]),b=g.useCallback(N=>{p.show({source:i,documents:N.map(([P])=>P)})},[p,i]),w=g.useCallback(async()=>{y.show({source:i})},[y,i]),_=g.useCallback(async N=>{if(N.type.includes("text")||N.type.includes("txt")){const P=new FileReader;P.onload=async I=>{var C;const k=(C=I.target)==null?void 0:C.result;await m({content:k})},P.readAsText(N)}else if(N.type.endsWith("pdf")){const P=new Blob([N],{type:"application/pdf"}),I=await new m8(P,{pdfjs:async()=>{const k=await At(()=>import("./pdf.min-DX3AyXIJ.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-DhAvbXYU.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([8,1,2,3,4])),k.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),k},parsedItemSeparator:" "}).load();await m({documents:I},{onProgressReport:k=>{r((k.handled+k.handling)/k.total)}})}},[m]),x=g.useMemo(()=>{var I,k;if(!((I=c==null?void 0:c.entity)!=null&&I.raw))return{headers:[],rows:[]};const N=["content","embedding","metadata"],P=Pg((k=c==null?void 0:c.entity)==null?void 0:k.raw);return{headers:N,rows:P.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(S=c==null?void 0:c.entity)==null?void 0:S.raw]),j=g.useMemo(()=>{switch(a){case"search":return h.jsx(ra,{value:"search",children:h.jsx(O$,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(ra,{className:"min-w-80",value:"new",children:h.jsx(C$,{loading:u,onCreateData:m})});case"file":return h.jsx(ra,{value:"file",children:h.jsx(N$,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(ra,{value:"view",children:h.jsx(Am,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[m,b,w,_,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Nn,{id:s}),h.jsxs(Ia,{className:"flex justify-center",variant:"default",children:[h.jsx(de,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Co,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(vj,{value:a,onValueChange:o,defaultValue:"search",className:G("w-full mt-4"),children:[h.jsxs(wm,{className:G("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(na,{value:"search",children:t("vector_database_node.search")}),h.jsx(na,{value:"new",children:t("vector_database_node.text")}),h.jsx(na,{value:"file",children:t("vector_database_node.file")}),((M=c.entity)==null?void 0:M.storage)===kr.DatabaseNode?h.jsx(na,{value:"view",children:t("vector_database_node.view")}):void 0]}),j]})]})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:l})]})}),_ke={embedding:32},jke=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=CN(n.entity.headers||""),l=Pg(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Gt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-json",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Am,{data:a.rows,headers:a.headers,limitLengthByColumns:_ke})})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),yq=60,gq=140,Ske=Wa("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),vq=H.forwardRef(({className:e,children:t,magnification:n=yq,distance:r=gq,direction:a="bottom",...o},i)=>{const s=Tv(1/0),c=()=>H.Children.map(t,l=>H.isValidElement(l)&&l.type===Nf?H.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(Af.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:G(Ske({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});vq.displayName="Dock";const Nf=({magnification:e=yq,distance:t=gq,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=OM(n||new e2e,u=>{var f;const d=((f=i.current)==null?void 0:f.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=OM(s,[-t,0,t],[40,e,40]),l=$K(c,{mass:.1,stiffness:150,damping:12});return h.jsx(Af.div,{ref:i,style:{width:l},className:G("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};Nf.displayName="DockIcon";let bq,wq,xq,_q,bg,jq,Mf,Sq,Eq,Oq,Cq,Nq,Mq,Pq,kq,Aq,Tq,Iq,Rq,Dq,Lq,$q,Fq,Bq,zq,Vq,Uq,Wq;bq=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),wq=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-minus size-6",...e},g.createElement("path",{d:"M5 12h14"})),xq={[oe.Shape]:{width:100,height:100},[oe.CircleShape]:{width:100,height:100},[oe.TriangleShape]:{width:100,height:100},[oe.EditorApp]:{width:1240,height:400}},_q=e=>{const t=Tn(e),n=Qe(s=>s.currentSession),[r,a]=g.useState(!1),o=De(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,f=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),p=await ue("FlowNodeData").save({data:{},session_id:n.id});if(!p)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:p.id,source_type:"FlowNodeData",x:d,y:f+20,...xq[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},bg={applications:[{key:oe.EditorApp,icon:wq,label:"application_bar.editor"},{key:oe.VSLiteApp,icon:bq,label:"application_bar.vslite"}],shapes:[{key:oe.Shape,icon:"square",label:"application_bar.square"},{key:oe.CircleShape,icon:"circle",label:"application_bar.circle"},{key:oe.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:oe.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},jq=g.memo(e=>{const{t}=Pe("flows"),{toast:n}=tn(),{loading:r,createNode:a}=_q(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(su,{children:h.jsxs(vq,{direction:"middle",children:[bg.applications.map(i=>{const s=i.icon;return h.jsx(Nf,{children:h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)})}),h.jsx(Fr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),bg.shapes.map(i=>h.jsx(Nf,{children:h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Fr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),bg.old.map(i=>h.jsx(Nf,{children:h.jsxs(va,{children:[h.jsx(ba,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Fr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),Mf=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(ele,{lineClassName:G("!border-1.5",t),handleClassName:G("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),Sq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Eq=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return Sq(t),h.jsxs(h.Fragment,{children:[h.jsx(Mf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:r})]})}),Oq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.Shape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Cq=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return Oq(t),h.jsxs(h.Fragment,{children:[h.jsx(Mf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:r})]})}),Nq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Mq=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return Nq(t),h.jsxs(h.Fragment,{children:[h.jsx(Mf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:pe.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Nn,{id:t,className:"absolute top-0 right-0"}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:o})]})}),Pq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},kq=e=>{const t=Tn(e),{t:n}=Pe("flows"),r=g.useRef(null),{toast:a}=tn(),{getNode:o,getHandleConnections:i}=lr(),{stream:s}=kc(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await ue("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,f)=>{var p;if(t){const y=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===oe.LLM}),m=y?o(y==null?void 0:y.source):void 0,v=(p=m==null?void 0:m.data)==null?void 0:p.entity;if(!m||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(m.data.status!==Xe.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Pr(d)]:d,{onMessageUpdate:b=>{f==null||f(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const f=[];return i({nodeId:d,type:"target"}).forEach(p=>{const y=o(p.source);!y||y.type!==oe.LLM||f.push({node:y,connections:[p]})}),f},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},Aq=g.lazy(()=>At(()=>import("./index-yEY5AE0y.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Tq=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;Pq(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=kq(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(Mf,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(lt,{type:"target",position:pe.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Nn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(Aq,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:a})]})}),Iq=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},Rq=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows");Iq(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:r}),h.jsxs(Ia,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Nn,{id:t}),h.jsx(de,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Co,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(zc,{children:o?h.jsx(un,{children:o}):void 0})]})]}),h.jsx(lt,{type:"source",position:pe.Bottom,id:"a",isConnectable:r})]})}),Dq=g.lazy(()=>At(()=>import("./CodeContainerApp-6SORg0ob.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,10]))),Lq=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(Dq,{...e})})]}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:n})]})}),$q=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],Fq=async e=>{switch(e){case"empty-source":return At(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return At(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return At(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return At(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return At(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},pM=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Pe("components"),[r,a]=g.useState();return h.jsxs(Gt,{className:G("mw-full",e),children:[h.jsx(Ln,{className:"p-4",children:h.jsx(Kn,{children:n("add_source_base.title")})}),h.jsx($n,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(jo,{onValueChange:o=>a(o),children:[h.jsx(Aa,{className:"w-full mb-4",children:h.jsx(So,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(Ta,{children:$q.map(o=>h.jsx(Yn,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(ut,{className:"w-full",onClick:async()=>r&&t(await Fq(r)),children:n("add_source_base.update_source")})]})})]})}),Bq=()=>{const{getNode:e,getHandleConnections:t}=lr(),{stream:n}=kc(),r=g.useCallback(async(o,i)=>{await ue("FlowNode").update(o,{raw:wv(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==oe.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Mg(d.content):d.role==="user"?new Pr(d.content):new Uo(d.content));c==null||c();const{content:u}=await n(nn.WebLLM,[...l,new Pr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},zq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Vq=g.lazy(()=>At(()=>import("./index-DUi7_GYs.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Uq=g.memo(e=>{var f,p,y,m;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((f=r==null?void 0:r.flowNode)!=null&&f.raw?Sv(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=Bq();zq(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(p=r==null?void 0:r.flowNode)==null?void 0:p.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,c]),d=g.useCallback(async v=>{o(b=>{var _;const w=Ev(b||{},v);return i((_=r==null?void 0:r.flowNode)==null?void 0:_.id,w),w})},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:pe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(Vq,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(lt,{type:"source",position:pe.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(pM,{className:"w-64",onUpdateSourceBase:l})})}),Wq={[oe.LLM]:lB,[oe.Toolbox]:nB,[oe.Thread]:hB,[oe.Message]:Pve,[oe.Prompt]:Ave,[oe.SessionInfo]:ike,[oe.Schema]:cke,[oe.CSVData]:lke,[oe.ToolDefinition]:dke,[oe.DefaultEmbeddingModel]:pke,[oe.VectorDatabase]:xke,[oe.JSONLData]:jke,[oe.ApplicationBar]:jq,[oe.Shape]:Eq,[oe.CircleShape]:Cq,[oe.TriangleShape]:Mq,[oe.EditorApp]:Tq,[oe.PlaceHolder]:Rq,[oe.CodeContainerApp]:Lq,[oe.VSLiteApp]:Uq};function Eke(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,Oke(a,...t)]}function Oke(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Cke="Toggle",dN=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Sn({prop:n,onChange:a,defaultProp:r});return h.jsx(Ae.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});dN.displayName=Cke;let fN,xs,pN,hN,wg;fN=dN,xs="ToggleGroup",[pN,EK]=Eke(xs,[Ka]),hN=Ka(),wg=H.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(Nke,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(Mke,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${xs}\``)}),wg.displayName=xs;var[Hq,qq]=pN(xs),Nke=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(Hq,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:H.useCallback(()=>s(""),[s]),children:h.jsx(Kq,{...o,ref:t})})}),Mke=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=H.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=H.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(Hq,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(Kq,{...o,ref:t})})});wg.displayName=xs;var[Pke,kke]=pN(xs),Kq=H.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=hN(n),u=Wo(i),d={role:"group",dir:u,...c};return h.jsx(Pke,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(Fl,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Ae.div,{...d,ref:t})}):h.jsx(Ae.div,{...d,ref:t})})}),xg="ToggleGroupItem",Yq=H.forwardRef((e,t)=>{const n=qq(xg,e.__scopeToggleGroup),r=kke(xg,e.__scopeToggleGroup),a=hN(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=H.useRef(null);return r.rovingFocus?h.jsx(Bl,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx(mN,{...s,ref:t})}):h.jsx(mN,{...s,ref:t})});Yq.displayName=xg;let mN;mN=H.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=qq(xg,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(dN,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),zg=wg,Vg=Yq;const Gq=Wa("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Ake=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(fN,{ref:a,className:G(Gq({variant:t,size:n,className:e})),...r}));Ake.displayName=fN.displayName;const Xq=g.createContext({size:"default",variant:"default"}),Zq=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(zg,{ref:o,className:G("flex items-center justify-center gap-1",e),...a,children:h.jsx(Xq.Provider,{value:{variant:t,size:n},children:r})}));Zq.displayName=zg.displayName;const Jq=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(Xq);return h.jsx(Vg,{ref:o,className:G(Gq({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});Jq.displayName=Vg.displayName;function Tke(){const e=Ze(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function Ike({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function Rke({limit:e=20}){const[t,n]=g.useState([]),r=Tt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(Ike,{change:i},s))})}function Dke(){const{getInternalNode:e}=lr(),t=Nce();return h.jsx(Oce,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(Lke,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function Lke({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function $ke({tools:e}){return h.jsx(dc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(Zq,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(Jq,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function Qq(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx($ke,{tools:i}),n&&h.jsx(dc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(Rke,{})}),e&&h.jsx(Dke,{}),a&&h.jsx(dc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(Tke,{})})]})}Qq.displayName="DevTools";const Fke=()=>{const e=g.useRef({}),t=g.useRef({}),n=De(N=>N.flowEdges),r=Qe(N=>N.currentSession),a=De(N=>N.setNodes),o=De(N=>N.updateNodes),i=De(N=>N.updateEdges),s=De(N=>N.addConnectionToEdges),c=De(N=>N.reset),l=De(N=>N.findFlowEdges),u=De(N=>N.deleteFlowNode),d=De(N=>N.deleteFlowEdge),f=De(N=>N.updateFlowNode),p=De(N=>N.getNodes),y=De(N=>N.findFlowNodesWithSource),m=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});m.current=n;const _=g.useCallback(async(N,P)=>{try{v.current=N,c(),await(P==null?void 0:P())}catch{v.current=void 0}},[c]),x=g.useCallback(async N=>{try{if(!(r!=null&&r.id))return;w(k=>({...k,loading:!0}));const P=await y({...N,where:{...N.where,session_id:r.id}}),I=await l({where:[{source:Oa(P.map(k=>k.id))},{target:Oa(P.map(k=>k.id))}]});return{flowNodes:P,flowEdges:I}}finally{w(P=>({...P,loading:!1}))}},[y,l,r==null?void 0:r.id]),j=g.useCallback(async N=>{var P,I;for(const k of N)if("id"in k&&Object.values(td).includes(k.id)&&k.type!=="remove")o([k]);else if(k.type==="position"&&k.position&&!isNaN(k.position.x)&&!isNaN(k.position.y)){o([k]);const C=k.position.x,A=k.position.y;clearTimeout(e.current[k.id]),e.current[k.id]=setTimeout(async()=>{e.current[k.id]=void 0,await f({id:k.id,x:C,y:A},{silent:!0})},200)}else if(k.type==="remove"){const C=(P=p([k.id]))==null?void 0:P[0];if(!(C!=null&&C.type)||Jle.includes(C.type))return;await u({id:k.id})}else if(k.type==="dimensions"&&k.dimensions&&!isNaN(k.dimensions.width)&&!isNaN(k.dimensions.height)){const C=(I=p([k.id]))==null?void 0:I[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;o([k]),clearTimeout(t.current[k.id]);const A=k.dimensions.width,T=k.dimensions.height;t.current[k.id]=setTimeout(async()=>{await f({id:k.id,width:A,height:T},{silent:!0})},200)}else k.type==="select"&&o([k])},[o,f,p,u]),S=g.useCallback(N=>{Promise.all(N.map(async P=>{if(P.type==="remove")return d({id:P.id})})),i(N)},[d,i]),E=g.useCallback(N=>{s(N)},[s]),O=g.useCallback(()=>{var N;(N=m.current)==null||N.length},[]),M=g.useCallback(N=>{a(P=>{var A,T;let I;if(typeof N=="function"?I=N(P):I=N,!I)return P;const k=P==null?void 0:P.find(D=>D.id===I.id),C={id:I.id,item:k?$h(k,I):{...I,position:{x:((A=I.position)==null?void 0:A.x)||0,y:((T=I.position)==null?void 0:T.y)||0}},type:k?"replace":"add"};return Ki([C],P)})},[a]);return{syncEdges:O,initialFlow:_,loadingState:b,prepareFlowInfo:x,updateNodeChanges:j,updateEdgeChanges:S,updateOrCreateNode:M,currentSessionIdRef:v,updateEdgeConnection:E}},Bke=e=>{const t=Qe(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=De(u=>u.ready),c=De(u=>u.removeSyncNodeQueue),l=De(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=De.subscribe(f=>f.syncNodeQueue,async(f,p)=>{const y=p.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&c(m.map(v=>v.timestamp))}),d=De.subscribe(f=>f.syncEdgeQueue,async(f,p)=>{const y=p.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&(l(m.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},zke=()=>{const[e,t]=g.useState(!0),n=Fke(),r=Ua(u=>u.selectedModel),a=g.useRef(r),o=Ua(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return Bke(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const f=`${a.current}`;i(p=>{const y=p==null?void 0:p.find(m=>{var v;return(v=m.data)!=null&&v.entity&&typeof m.data.entity=="object"&&"name"in m.data.entity?m.data.entity.name===f:!1});if(y)return y.data.label=d.text,y.data.status=Xe.Loading,d.progress===100&&(y.data.label="",y.data.status=Xe.Loaded),y})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},Vke=()=>{const e=Ml(l=>l.theme),t=De(l=>l.nodes),n=De(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=zke(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Sce,{nodes:t,edges:n,nodeTypes:Wq,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:ti.Free,colorMode:e,fitView:!0,children:[h.jsx(Tce,{variant:wo.Dots,gap:24,size:1}),h.jsx(Bce,{}),h.jsx(Jce,{}),t2e?h.jsx(Qq,{}):void 0]})},Uke=g.memo(Vke);function Wke(){return h.jsx(Uke,{})}const Hke=g.lazy(()=>At(()=>import("./DocumentViewer-CGm2Hp6Z.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),qke=()=>{const{documentId:e}=lP();return h.jsx(g.Suspense,{fallback:h.jsx(EN,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(Hke,{name:e||""})})};function _g(){const e=uP();return If(e),h.jsx(n2e,{})}const Kke=aG(h.jsxs(Yo,{errorElement:h.jsx(_g,{}),children:[h.jsxs(Yo,{element:h.jsx(G2,{requiredSession:!0}),children:[h.jsx(Yo,{path:Mp.whiteboard,Component:Wke,errorElement:h.jsx(_g,{})}),h.jsx(Yo,{path:Mp.application,errorElement:h.jsx(_g,{}),Component:Tme}),h.jsx(Yo,{path:"*",element:h.jsx(tG,{to:gn("whiteboard")})})]}),h.jsx(Yo,{element:h.jsx(G2,{}),children:h.jsx(Yo,{path:Mp.document,errorElement:h.jsx(_g,{}),Component:qke})})]})),Yke=(e,t)=>{switch(oJ){case"browser":return bP(e,t);case"hash":return NG(e);default:return bP(e,t)}},Gke=Yke(Kke,{basename:"/NoLLMChat/"});gK("[BASE_URL]","/NoLLMChat/");let eK;eK=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(EN,{className:"w-screen h-screen",enableLogo:!0,typing:!0}):h.jsx(FG,{router:Gke})},()=>!0),MK=Object.freeze(Object.defineProperty({__proto__:null,default:eK},Symbol.toStringTag,{value:"Module"}))});export{Pt as $,NN as A,kg as B,MN as C,PN as D,Tl as E,Ag as F,Il as G,Ni as H,$f as I,Ff as J,Tg as K,kN as L,AN as M,Es as N,TN as O,IN as P,RN as Q,DN as R,Ig as S,LN as T,$N as U,Rl as V,FN as W,BN as X,zN as Y,VN as Z,Rg as _,o2e as __tla,Dg as a,Lg as a$,Dl as a0,Ll as a1,Mi as a2,Pi as a3,Bf as a4,xK as a5,$l as a6,Os as a7,Cs as a8,_K as a9,jK as aA,$g as aB,UN as aC,WN as aD,HN as aE,SK as aF,Fg as aG,qN as aH,Bg as aI,KN as aJ,Ka as aK,EK as aL,Wo as aM,Fl as aN,Bl as aO,zg as aP,Vg as aQ,Ug as aR,Wg as aS,Hg as aT,qg as aU,Kg as aV,Yg as aW,YN as aX,GN as aY,zf as aZ,Gg as a_,XN as aa,Xg as ab,ZN as ac,JN as ad,OK as ae,QN as af,Zg as ag,CK as ah,eM as ai,tM as aj,nM as ak,Jg as al,rM as am,NK as an,Qg as ao,ev as ap,tv as aq,aM as ar,nv as as,rv as at,av as au,ov as av,iv as aw,sv as ax,oM as ay,iM as az,zl as b,cv as b0,lv as b1,uv as b2,dv as b3,fv as b4,pv as b5,hv as b6,Vf as b7,yn as b8,mv as b9,sM as bA,cM as bB,Ns as bC,Ho as bD,MK as bE,Uf as ba,yv as bb,gv as bc,Vl as bd,Ul as be,PK as bf,lM as bg,nt as bh,Ms as bi,vv as bj,bv as bk,Vn as bl,De as bm,An as bn,Tn as bo,wv as bp,xv as bq,uM as br,dM as bs,_v as bt,jv as bu,ut as bv,fM as bw,Sv as bx,Ev as by,pM as bz,hM as c,Ar as d,Ov as e,mM as f,yM as g,Ps as h,Tr as i,Cv as j,Nv as k,gM as l,pa as m,vM as n,Mv as o,Pv as p,bM as q,wM as r,xM as s,kv as t,In as u,Wl as v,Av as w,Hl as x,ks as y,_M as z};
