const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-BoZoTcMw.js","assets/index-BZHEobNh.js","assets/index-DbmpG02v.css","assets/dot-B_qB-cvQ.js","assets/createLucideIcon-Muq3qkRo.js","assets/index-DyMIM4Bi.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-B7q1QQtt.js","assets/index-Cr8Tc6mT.css","assets/index-PRjZyF7d.js","assets/pdf-BFmBp-D9.js","assets/pdf.min-CNRnjYAA.js","assets/pdf.worker.min-TUvxb0n0.js","assets/index-DHwbNkRp.js","assets/use-prevent-pitch-zoom-NAVppq4E.js","assets/index-DbnoKxRX.js","assets/link-DQ5PXRJj.js","assets/trash-2-BsEr-iwJ.js","assets/text-DVC4riv-.js","assets/external-link-B6jMWfon.js","assets/unlink-Gde0oCpc.js","assets/index-3ru6m7Uf.js","assets/list-ioVjyhiH.js","assets/list-ordered-wXatl_40.js","assets/list-todo-COq32Yvl.js","assets/indent-increase-CbwDoXPc.js","assets/pilcrow-CVgEuaWP.js","assets/heading-1-C31adqed.js","assets/heading-2-Cw9x1mIe.js","assets/heading-3-DrUIBtTz.js","assets/table-R2Qgo9Vs.js","assets/file-code-BFwiea2O.js","assets/quote-DJkhvqAV.js","assets/minus-Bh5eJ-26.js","assets/square-BYv6m8eJ.js","assets/chevron-right-5c-8l4Gh.js","assets/image-nZjM94BA.js","assets/table-of-contents-BbEtCn8o.js","assets/columns-3-Dl1a9Vpn.js","assets/link-2-B9G9cx5m.js","assets/calendar-DVYLhCVr.js","assets/plus-BLQoAH5J.js","assets/wrap-text-BjTGE8zQ.js","assets/pen-mciGO-lq.js","assets/eye-BQGkfN7G.js","assets/indent-decrease-B3wqEPZT.js","assets/pointer-CbEHJ1JO.js","assets/wand-sparkles-Bp0j1-eI.js","assets/bold-BDqMNmA9.js","assets/italic-CGdaWRf0.js","assets/underline-C0JPanIe.js","assets/strikethrough-h4WG4OJy.js","assets/code-xml-OcoVUh1m.js","assets/baseline-PnUHqvnK.js","assets/paint-bucket-BNW1YDDG.js","assets/arrow-up-to-line-BtJ2RvTu.js","assets/index-BCYu3EnN.css","assets/index-Bxl28ONd.js","assets/check-DZsQ2cVP.js","assets/circle-DzzkPGi2.js","assets/index-BiflIZus.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-CL5deAAk.js","assets/DocumentViewer-S48eyvjc.js"])))=>i.map(i=>d[i]);
import{r as g,M as AM,j as h,u as bv,P as hDe,a as TM,L as mDe,m as yDe,c as gDe,f as MG,i as vDe,b as IM,d as kG,e as bDe,g as wDe,_ as PG,h as AG,k as Yl,l as wv,n as oo,o as ti,p as Ql,q as ln,R as xDe,s as ur,t as Pn,v as Ae,w as ge,x as Br,y as jt,z as Z,A as io,S as ni,B as dr,D as xv,C as _De,E as _v,F as fe,G as TG,H as jDe,I as ke,J as pp,K as et,N as so,O as tn,Q as nn,T as de,U as Us,V as hp,W as IG,X as SDe,Y as EDe,Z as RG,$ as Ui,a0 as eu,a1 as jn,a2 as st,a3 as DG,a4 as H,a5 as tu,a6 as ODe,a7 as CDe,a8 as Sn,a9 as ie,aa as NDe,ab as Vi,ac as mp,ad as yp,ae as Ht,af as zr,ag as MDe,ah as kDe,ai as PDe,aj as ADe,ak as gp,al as LG,am as TDe,an as IDe,ao as $G,ap as RM,aq as RDe,ar as DDe,as as FG,at as DM,au as LDe,av as jv,aw as $De,ax as qi,ay as BG,az as FDe,aA as BDe,aB as Ma,aC as zG,aD as zDe,aE as Sv,aF as te,aG as co,aH as nu,aI as ka,aJ as Ev,aK as UG,aL as LM,aM as UDe,aN as VDe,aO as VG,aP as qDe,aQ as Vs,aR as Ov,aS as vp,aT as WDe,aU as Ur,aV as Cv,aW as $M,aX as ru,aY as qG,aZ as HDe,a_ as KDe,a$ as ZDe,b0 as GDe,b1 as XDe,b2 as au,b3 as JDe,b4 as YDe,b5 as WG,b6 as QDe,b7 as e3e,b8 as t3e,b9 as n3e,ba as HG,bb as FM,bc as St,bd as r3e,be as BM,bf as a3e,bg as o3e,bh as i3e,__tla as s3e}from"./index-BZHEobNh.js";import KG,{__tla as c3e}from"./dot-B_qB-cvQ.js";let ou,zM,Nv,UM,VM,iu,Mv,su,Wi,bp,wp,kv,qM,WM,qs,HM,KM,ZM,GM,Pv,XM,JM,YM,QM,ek,tk,Av,Rt,Tv,Iv,cu,Hi,Ki,xp,lu,Ws,Hs,nk,Rv,rk,ak,ZG,Dv,ok,Lv,ik,lo,GG,ri,uu,du,$v,Fv,Bv,zv,Uv,Vv,qv,Wv,sk,ck,_p,Hv,Kv,Zv,Gv,Xv,lk,XG,Jv,JG,uk,dk,fk,Yv,pk,YG,Qv,e0,t0,hk,n0,r0,a0,o0,i0,s0,mk,yk,QG,c0,gk,vk,fu,l0,u0,d0,jp,En,f0,Sp,p0,h0,pu,eX,hu,tX,bk,qe,Ks,m0,y0,Xn,De,Fn,Bn,g0,v0,wk,xk,b0,w0,tt,_k,x0,_0,jk,Sk,Ek,Zs,ai,Ok,Vr,j0,Ck,Nk,Gs,qr,S0,E0,Mk,Pa,kk,O0,C0,Pk,Ak,Tk,N0,zn,mu,M0,yu,Xs,Ik,l3e=Promise.all([(()=>{try{return s3e}catch{}})(),(()=>{try{return c3e}catch{}})()]).then(async()=>{class aX extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function oX({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(AM);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(aX,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const iX=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=bv(sX),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const f of s.values())if(!f)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,f)=>s.set(f,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(oX,{isPresent:n,children:e})),h.jsx(hDe.Provider,{value:u,children:e})};function sX(){return new Map}const Op=e=>e.key||"";function $k(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const cX=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>$k(e),[e]),c=s.map(Op),l=g.useRef(!0),u=g.useRef(s),d=bv(()=>new Map),[f,p]=g.useState(s),[m,y]=g.useState(s);TM(()=>{l.current=!1,u.current=s;for(let w=0;w<m.length;w++){const j=Op(m[w]);c.includes(j)?d.delete(j):d.get(j)!==!0&&d.set(j,!1)}},[m,c.length,c.join("-")]);const v=[];if(s!==f){let w=[...s];for(let j=0;j<m.length;j++){const x=m[j],_=Op(x);c.includes(_)||(w.splice(j,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),y($k(w)),p(s);return}const{forceRender:b}=g.useContext(mDe);return h.jsx(h.Fragment,{children:m.map(w=>{const j=Op(w),x=s===m||c.includes(j),_=()=>{if(d.has(j))d.set(j,!0);else return;let S=!0;d.forEach(E=>{E||(S=!1)}),S&&(b==null||b(),y(u.current),a&&a())};return h.jsx(iX,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:_,children:w},j)})})};function k0(e){const t=bv(()=>yDe(e)),{isStatic:n}=g.useContext(AM);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function Fk(e,t){const n=k0(t()),r=()=>n.set(t());return r(),TM(()=>{const a=()=>MG.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),gDe(r)}}),n}const lX=e=>e&&typeof e=="object"&&e.mix,uX=e=>lX(e)?e.mix:void 0;function dX(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=vDe(a,o,{mixer:uX(o[0]),...i});return t?s(r):s}function fX(e){IM.current=[],e();const t=Fk(IM.current,e);return IM.current=void 0,t}function Bk(e,t,n,r){if(typeof e=="function")return fX(e);const a=typeof t=="function"?t:dX(t,n,r);return Array.isArray(e)?zk(e,a):zk([e],([o])=>a(o))}function zk(e,t){const n=bv(()=>[]);return Fk(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function Uk(e){return typeof e=="number"?e:parseFloat(e)}function pX(e,t={}){const{isStatic:n}=g.useContext(AM),r=g.useRef(null),a=k0(kG(e)?Uk(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(bDe.delta),c(),r.current=wDe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,MG.update(s),a.get()),c),[JSON.stringify(t)]),TM(()=>{if(kG(e))return e.on("change",l=>a.set(Uk(l)))},[a]),a}var Je=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(Je||{}),gu=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(gu||{}),nt=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e.Groq="Groq",e.GoogleGenerativeAI="GoogleGenerativeAI",e))(nt||{}),Wr=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Wr||{}),fr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(fr||{}),Cp=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(Cp||{}),pr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(pr||{}),Js=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(Js||{});function Vk(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=PG(t),i=PG(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(AG(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?Vk(u,d,n,r+"/"+Yl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+Yl(l),value:wv(u)}),n.push({op:"replace",path:r+"/"+Yl(l),value:wv(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+Yl(l),value:wv(u)}),n.push({op:"remove",path:r+"/"+Yl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!AG(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Yl(l),value:wv(t[l])})}}}function hX(e,t,n=!1){var r=[];return Vk(e,t,r,"",n),r}let qk,Wk;qk=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},Wk=()=>{const e=oo(a=>a.toolsCallingStream),t=oo(a=>a.structuredStream),n=oo(a=>a.stream),r=oo(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var p;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&ti("Multiple schemas are not supported. Only the first schema will be used."),u=t(((p=s==null?void 0:s[0])==null?void 0:p.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:f}=await qk(u,c);return l==null||l({content:f,lastChunk:d}),{lastChunk:d,content:f}},[r,n,t,e])}},Mv=globalThis||void 0||self;var vu={},Hk;function mX(){if(Hk)return vu;Hk=1,Object.defineProperty(vu,"__esModule",{value:!0}),vu.parse=i,vu.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,p){const m=new o,y=f.length;if(y<2)return m;const v=(p==null?void 0:p.decode)||u;let b=0;do{const w=f.indexOf("=",b);if(w===-1)break;const j=f.indexOf(";",b),x=j===-1?y:j;if(w>x){b=f.lastIndexOf(";",w-1)+1;continue}const _=s(f,b,w),S=c(f,w,_),E=f.slice(_,S);if(m[E]===void 0){let O=s(f,w+1,x),M=c(f,x,O);const C=v(f.slice(O,M));m[E]=C}b=x+1}while(b<y);return m}function s(f,p,m){do{const y=f.charCodeAt(p);if(y!==32&&y!==9)return p}while(++p<m);return m}function c(f,p,m){for(;p>m;){const y=f.charCodeAt(--p);if(y!==32&&y!==9)return p+1}return m}function l(f,p,m){const y=(m==null?void 0:m.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const v=y(p);if(!t.test(v))throw new TypeError(`argument val is invalid: ${p}`);let b=f+"="+v;if(!m)return b;if(m.maxAge!==void 0){if(!Number.isInteger(m.maxAge))throw new TypeError(`option maxAge is invalid: ${m.maxAge}`);b+="; Max-Age="+m.maxAge}if(m.domain){if(!n.test(m.domain))throw new TypeError(`option domain is invalid: ${m.domain}`);b+="; Domain="+m.domain}if(m.path){if(!r.test(m.path))throw new TypeError(`option path is invalid: ${m.path}`);b+="; Path="+m.path}if(m.expires){if(!d(m.expires)||!Number.isFinite(m.expires.valueOf()))throw new TypeError(`option expires is invalid: ${m.expires}`);b+="; Expires="+m.expires.toUTCString()}if(m.httpOnly&&(b+="; HttpOnly"),m.secure&&(b+="; Secure"),m.partitioned&&(b+="; Partitioned"),m.priority)switch(typeof m.priority=="string"?m.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${m.priority}`)}if(m.sameSite)switch(typeof m.sameSite=="string"?m.sameSite.toLowerCase():m.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${m.sameSite}`)}return b}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return a.call(f)==="[object Date]"}return vu}mX();var Kk="popstate";function yX(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Ys("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:uo(a)}return Gk(t,n,null,e)}function gX(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=fo(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Ys("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:uo(o))}function r(a,o){un(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return Gk(t,n,r,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function un(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function vX(){return Math.random().toString(36).substring(2,10)}function Zk(e,t){return{usr:e.state,key:e.key,idx:t}}function Ys(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?fo(t):t,state:n,key:t&&t.key||r||vX()}}function uo({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function fo(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Gk(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:y.location,delta:b})}function f(v,b){s="PUSH";let w=Ys(y.location,v,b);n&&n(w,v),l=u()+1;let j=Zk(w,l),x=y.createHref(w);try{i.pushState(j,"",x)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(x)}o&&c&&c({action:s,location:y.location,delta:1})}function p(v,b){s="REPLACE";let w=Ys(y.location,v,b);n&&n(w,v),l=u();let j=Zk(w,l),x=y.createHref(w);i.replaceState(j,"",x),o&&c&&c({action:s,location:y.location,delta:0})}function m(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:uo(v);return w=w.replace(/ $/,"%20"),Xe(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let y={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(Kk,d),c=v,()=>{a.removeEventListener(Kk,d),c=null}},createHref(v){return t(a,v)},createURL:m,encodeLocation(v){let b=m(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(v){return i.go(v)}};return y}var bX=new Set(["lazy","caseSensitive","path","id","index","children"]);function wX(e){return e.index===!0}function Np(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Xe(a.index!==!0||!a.children,"Cannot specify children on an index route"),Xe(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),wX(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Np(a.children,t,i,r)),c}})}function oi(e,t,n="/"){return Mp(e,t,n,!1)}function Mp(e,t,n,r){let a=typeof t=="string"?fo(t):t,o=Hr(a.pathname||"/",n);if(o==null)return null;let i=Xk(e);_X(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=TX(o);s=PX(i[c],l,r)}return s}function xX(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function Xk(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Xe(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=Aa([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Xe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),Xk(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:MX(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of Jk(o.path))a(o,i,c)}),t}function Jk(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=Jk(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function _X(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:kX(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var jX=/^:[\w-]+$/,SX=3,EX=2,OX=1,CX=10,NX=-2,Yk=e=>e==="*";function MX(e,t){let n=e.split("/"),r=n.length;return n.some(Yk)&&(r+=NX),t&&(r+=EX),n.filter(a=>!Yk(a)).reduce((a,o)=>a+(jX.test(o)?SX:o===""?OX:CX),r)}function kX(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function PX(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=kp({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=kp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Aa([o,d.pathname]),pathnameBase:DX(Aa([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Aa([o,d.pathnameBase]))}return i}function kp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=AX(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let p=s[d]||"";i=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}const f=s[d];return u&&!f?c[l]=void 0:c[l]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function AX(e,t=!1,n=!0){un(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function TX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return un(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Hr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function IX(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?fo(e):e;return{pathname:n?n.startsWith("/")?n:RX(n,t):t,search:LX(r),hash:$X(a)}}function RX(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function P0(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Qk(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Pp(e){let t=Qk(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Ap(e,t,n,r=!1){let a;typeof e=="string"?a=fo(e):(a={...e},Xe(!a.pathname||!a.pathname.includes("?"),P0("?","pathname","search",a)),Xe(!a.pathname||!a.pathname.includes("#"),P0("#","pathname","hash",a)),Xe(!a.search||!a.search.includes("#"),P0("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}s=d>=0?t[d]:"/"}let c=IX(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var Aa=e=>e.join("/").replace(/\/\/+/g,"/"),DX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),LX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$X=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Tp=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Ip(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var eP=["POST","PUT","PATCH","DELETE"],FX=new Set(eP),BX=["GET",...eP],zX=new Set(BX),UX=new Set([301,302,303,307,308]),VX=new Set([307,308]),A0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},qX={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},bu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},T0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,WX=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),tP="remix-router-transitions",nP=Symbol("ResetLoaderData");function rP(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Xe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||WX,a={},o=Np(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||XX,l=e.patchRoutesOnNavigation,u={...e.future},d=null,f=new Set,p=null,m=null,y=null,v=e.hydrationData!=null,b=oi(o,e.history.location,s),w=null;if(b==null&&!l){let V=Or(404,{pathname:e.history.location.pathname}),{matches:ee,route:oe}=mP(o);b=ee,w={[oe.id]:V}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let j;if(b)if(b.some(V=>V.route.lazy))j=!1;else if(!b.some(V=>V.route.loader))j=!0;else{let V=e.hydrationData?e.hydrationData.loaderData:null,ee=e.hydrationData?e.hydrationData.errors:null;if(ee){let oe=b.findIndex(pe=>ee[pe.route.id]!==void 0);j=b.slice(0,oe+1).every(pe=>!R0(pe.route,V,ee))}else j=b.every(oe=>!R0(oe.route,V,ee))}else{j=!1,b=[];let V=Oe(null,o,e.history.location.pathname);V.active&&V.matches&&(b=V.matches)}let x,_={historyAction:e.history.action,location:e.history.location,matches:b,initialized:j,navigation:A0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,O,M=!1,C=new Map,k=null,T=!1,P=!1,N=new Set,I=new Map,A=0,R=-1,L=new Map,D=new Set,B=new Map,F=new Map,$=new Set,z=new Map,X,G=null;function q(){if(d=e.history.listen(({action:V,location:ee,delta:oe})=>{if(X){X(),X=void 0;return}un(z.size===0||oe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=Zt({currentLocation:_.location,nextLocation:ee,historyAction:V});if(pe&&oe!=null){let Ne=new Promise(Re=>{X=Re});e.history.go(oe*-1),Te(pe,{state:"blocked",location:ee,proceed(){Te(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),Ne.then(()=>e.history.go(oe))},reset(){let Re=new Map(_.blockers);Re.set(pe,bu),W({blockers:Re})}});return}return ce(V,ee)}),n){sJ(t,C);let V=()=>cJ(t,C);t.addEventListener("pagehide",V),k=()=>t.removeEventListener("pagehide",V)}return _.initialized||ce("POP",_.location,{initialHydration:!0}),x}function J(){d&&d(),k&&k(),f.clear(),O&&O.abort(),_.fetchers.forEach((V,ee)=>ir(ee)),_.blockers.forEach((V,ee)=>me(ee))}function K(V){return f.add(V),()=>f.delete(V)}function W(V,ee={}){_={..._,...V};let oe=[],pe=[];_.fetchers.forEach((Ne,Re)=>{Ne.state==="idle"&&($.has(Re)?oe.push(Re):pe.push(Re))}),[...f].forEach(Ne=>Ne(_,{deletedFetchers:oe,viewTransitionOpts:ee.viewTransitionOpts,flushSync:ee.flushSync===!0})),oe.forEach(Ne=>ir(Ne)),pe.forEach(Ne=>_.fetchers.delete(Ne))}function Y(V,ee,{flushSync:oe}={}){var we,ze;let pe=_.actionData!=null&&_.navigation.formMethod!=null&&Kr(_.navigation.formMethod)&&_.navigation.state==="loading"&&((we=V.state)==null?void 0:we._isRedirect)!==!0,Ne;ee.actionData?Object.keys(ee.actionData).length>0?Ne=ee.actionData:Ne=null:pe?Ne=_.actionData:Ne=null;let Re=ee.loaderData?pP(_.loaderData,ee.loaderData,ee.matches||[],ee.errors):_.loaderData,Be=_.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Qe,Dt)=>Be.set(Dt,bu)));let Me=E===!0||_.navigation.formMethod!=null&&Kr(_.navigation.formMethod)&&((ze=V.state)==null?void 0:ze._isRedirect)!==!0;i&&(o=i,i=void 0),T||S==="POP"||(S==="PUSH"?e.history.push(V,V.state):S==="REPLACE"&&e.history.replace(V,V.state));let Pe;if(S==="POP"){let Qe=C.get(_.location.pathname);Qe&&Qe.has(V.pathname)?Pe={currentLocation:_.location,nextLocation:V}:C.has(V.pathname)&&(Pe={currentLocation:V,nextLocation:_.location})}else if(M){let Qe=C.get(_.location.pathname);Qe?Qe.add(V.pathname):(Qe=new Set([V.pathname]),C.set(_.location.pathname,Qe)),Pe={currentLocation:_.location,nextLocation:V}}W({...ee,actionData:Ne,loaderData:Re,historyAction:S,location:V,initialized:!0,navigation:A0,revalidation:"idle",restoreScrollPosition:Ee(V,ee.matches||_.matches),preventScrollReset:Me,blockers:Be},{viewTransitionOpts:Pe,flushSync:oe===!0}),S="POP",E=!1,M=!1,T=!1,P=!1,G==null||G.resolve(),G=null}async function re(V,ee){if(typeof V=="number"){e.history.go(V);return}let oe=I0(_.location,_.matches,s,V,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:pe,submission:Ne,error:Re}=aP(!1,oe,ee),Be=_.location,Me=Ys(_.location,pe,ee&&ee.state);Me={...Me,...e.history.encodeLocation(Me)};let Pe=ee&&ee.replace!=null?ee.replace:void 0,we="PUSH";Pe===!0?we="REPLACE":Pe===!1||Ne!=null&&Kr(Ne.formMethod)&&Ne.formAction===_.location.pathname+_.location.search&&(we="REPLACE");let ze=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,Qe=(ee&&ee.flushSync)===!0,Dt=Zt({currentLocation:Be,nextLocation:Me,historyAction:we});if(Dt){Te(Dt,{state:"blocked",location:Me,proceed(){Te(Dt,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),re(V,ee)},reset(){let zt=new Map(_.blockers);zt.set(Dt,bu),W({blockers:zt})}});return}await ce(we,Me,{submission:Ne,pendingError:Re,preventScrollReset:ze,replace:ee&&ee.replace,enableViewTransition:ee&&ee.viewTransition,flushSync:Qe})}function U(){G||(G=lJ()),lt(),W({revalidation:"loading"});let V=G.promise;return _.navigation.state==="submitting"?V:_.navigation.state==="idle"?(ce(_.historyAction,_.location,{startUninterruptedRevalidation:!0}),V):(ce(S||_.historyAction,_.navigation.location,{overrideNavigation:_.navigation,enableViewTransition:M===!0}),V)}async function ce(V,ee,oe){O&&O.abort(),O=null,S=V,T=(oe&&oe.startUninterruptedRevalidation)===!0,_e(_.location,_.matches),E=(oe&&oe.preventScrollReset)===!0,M=(oe&&oe.enableViewTransition)===!0;let pe=i||o,Ne=oe&&oe.overrideNavigation,Re=oi(pe,ee,s),Be=(oe&&oe.flushSync)===!0,Me=Oe(Re,pe,ee.pathname);if(Me.active&&Me.matches&&(Re=Me.matches),!Re){let{error:it,notFoundMatches:cr,route:Qt}=Bt(ee.pathname);Y(ee,{matches:cr,loaderData:{},errors:{[Qt.id]:it}},{flushSync:Be});return}if(_.initialized&&!P&&nJ(_.location,ee)&&!(oe&&oe.submission&&Kr(oe.submission.formMethod))){Y(ee,{matches:Re},{flushSync:Be});return}O=new AbortController;let Pe=Qs(e.history,ee,O.signal,oe&&oe.submission),we;if(oe&&oe.pendingError)we=[Zi(Re).route.id,{type:"error",error:oe.pendingError}];else if(oe&&oe.submission&&Kr(oe.submission.formMethod)){let it=await ae(Pe,ee,oe.submission,Re,Me.active,{replace:oe.replace,flushSync:Be});if(it.shortCircuited)return;if(it.pendingActionResult){let[cr,Qt]=it.pendingActionResult;if(hr(Qt)&&Ip(Qt.error)&&Qt.error.status===404){O=null,Y(ee,{matches:it.matches,loaderData:{},errors:{[cr]:Qt.error}});return}}Re=it.matches||Re,we=it.pendingActionResult,Ne=$0(ee,oe.submission),Be=!1,Me.active=!1,Pe=Qs(e.history,Pe.url,Pe.signal)}let{shortCircuited:ze,matches:Qe,loaderData:Dt,errors:zt}=await ue(Pe,ee,Re,Me.active,Ne,oe&&oe.submission,oe&&oe.fetcherSubmission,oe&&oe.replace,oe&&oe.initialHydration===!0,Be,we);ze||(O=null,Y(ee,{matches:Qe||Re,...hP(we),loaderData:Dt,errors:zt}))}async function ae(V,ee,oe,pe,Ne,Re={}){lt();let Be=oJ(ee,oe);if(W({navigation:Be},{flushSync:Re.flushSync===!0}),Ne){let we=await Ve(pe,ee.pathname,V.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let ze=Zi(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[ze,{type:"error",error:we.error}]}}else if(we.matches)pe=we.matches;else{let{notFoundMatches:ze,error:Qe,route:Dt}=Bt(ee.pathname);return{matches:ze,pendingActionResult:[Dt.id,{type:"error",error:Qe}]}}}let Me,Pe=wu(pe,ee);if(!Pe.route.action&&!Pe.route.lazy)Me={type:"error",error:Or(405,{method:V.method,pathname:ee.pathname,routeId:Pe.route.id})};else if(Me=(await He("action",_,V,[Pe],pe,null))[Pe.route.id],V.signal.aborted)return{shortCircuited:!0};if(Gi(Me)){let we;return Re&&Re.replace!=null?we=Re.replace:we=uP(Me.response.headers.get("Location"),new URL(V.url),s)===_.location.pathname+_.location.search,await We(V,Me,!0,{submission:oe,replace:we}),{shortCircuited:!0}}if(hr(Me)){let we=Zi(pe,Pe.route.id);return(Re&&Re.replace)!==!0&&(S="PUSH"),{matches:pe,pendingActionResult:[we.route.id,Me]}}return{matches:pe,pendingActionResult:[Pe.route.id,Me]}}async function ue(V,ee,oe,pe,Ne,Re,Be,Me,Pe,we,ze){let Qe=Ne||$0(ee,Re),Dt=Re||Be||bP(Qe),zt=!T&&!Pe;if(pe){if(zt){let lr=je(ze);W({navigation:Qe,...lr!==void 0?{actionData:lr}:{}},{flushSync:we})}let ht=await Ve(oe,ee.pathname,V.signal);if(ht.type==="aborted")return{shortCircuited:!0};if(ht.type==="error"){let lr=Zi(ht.partialMatches).route.id;return{matches:ht.partialMatches,loaderData:{},errors:{[lr]:ht.error}}}else if(ht.matches)oe=ht.matches;else{let{error:lr,notFoundMatches:zs,route:Wt}=Bt(ee.pathname);return{matches:zs,loaderData:{},errors:{[Wt.id]:lr}}}}let it=i||o,[cr,Qt]=iP(e.history,_,oe,Dt,ee,Pe===!0,P,N,$,B,D,it,s,ze);if(R=++A,cr.length===0&&Qt.length===0){let ht=Q();return Y(ee,{matches:oe,loaderData:{},errors:ze&&hr(ze[1])?{[ze[0]]:ze[1].error}:null,...hP(ze),...ht?{fetchers:new Map(_.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(zt){let ht={};if(!pe){ht.navigation=Qe;let lr=je(ze);lr!==void 0&&(ht.actionData=lr)}Qt.length>0&&(ht.fetchers=Le(Qt)),W(ht,{flushSync:we})}Qt.forEach(ht=>{sr(ht.key),ht.controller&&I.set(ht.key,ht.controller)});let Bs=()=>Qt.forEach(ht=>sr(ht.key));O&&O.signal.addEventListener("abort",Bs);let{loaderResults:Na,fetcherResults:zi}=await It(_,oe,cr,Qt,V);if(V.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",Bs),Qt.forEach(ht=>I.delete(ht.key));let ao=Rp(Na);if(ao)return await We(V,ao.result,!0,{replace:Me}),{shortCircuited:!0};if(ao=Rp(zi),ao)return D.add(ao.key),await We(V,ao.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:fp,errors:Fr}=fP(_,oe,Na,ze,Qt,zi);Pe&&_.errors&&(Fr={..._.errors,...Fr});let Gl=Q(),Xl=ne(R),Jl=Gl||Xl||Qt.length>0;return{matches:oe,loaderData:fp,errors:Fr,...Jl?{fetchers:new Map(_.fetchers)}:{}}}function je(V){if(V&&!hr(V[1]))return{[V[0]]:V[1].data};if(_.actionData)return Object.keys(_.actionData).length===0?null:_.actionData}function Le(V){return V.forEach(ee=>{let oe=_.fetchers.get(ee.key),pe=xu(void 0,oe?oe.data:void 0);_.fetchers.set(ee.key,pe)}),new Map(_.fetchers)}async function $e(V,ee,oe,pe){sr(V);let Ne=(pe&&pe.flushSync)===!0,Re=i||o,Be=I0(_.location,_.matches,s,oe,ee,pe==null?void 0:pe.relative),Me=oi(Re,Be,s),Pe=Oe(Me,Re,Be);if(Pe.active&&Pe.matches&&(Me=Pe.matches),!Me){_t(V,ee,Or(404,{pathname:Be}),{flushSync:Ne});return}let{path:we,submission:ze,error:Qe}=aP(!0,Be,pe);if(Qe){_t(V,ee,Qe,{flushSync:Ne});return}let Dt=wu(Me,we),zt=(pe&&pe.preventScrollReset)===!0;if(ze&&Kr(ze.formMethod)){await Se(V,ee,we,Dt,Me,Pe.active,Ne,zt,ze);return}B.set(V,{routeId:ee,path:we}),await Ue(V,ee,we,Dt,Me,Pe.active,Ne,zt,ze)}async function Se(V,ee,oe,pe,Ne,Re,Be,Me,Pe){lt(),B.delete(V);function we(Wt){if(!Wt.route.action&&!Wt.route.lazy){let ei=Or(405,{method:Pe.formMethod,pathname:oe,routeId:ee});return _t(V,ee,ei,{flushSync:Be}),!0}return!1}if(!Re&&we(pe))return;let ze=_.fetchers.get(V);ot(V,iJ(Pe,ze),{flushSync:Be});let Qe=new AbortController,Dt=Qs(e.history,oe,Qe.signal,Pe);if(Re){let Wt=await Ve(Ne,oe,Dt.signal);if(Wt.type==="aborted")return;if(Wt.type==="error"){_t(V,ee,Wt.error,{flushSync:Be});return}else if(Wt.matches){if(Ne=Wt.matches,pe=wu(Ne,oe),we(pe))return}else{_t(V,ee,Or(404,{pathname:oe}),{flushSync:Be});return}}I.set(V,Qe);let zt=A,it=(await He("action",_,Dt,[pe],Ne,V))[pe.route.id];if(Dt.signal.aborted){I.get(V)===Qe&&I.delete(V);return}if($.has(V)){if(Gi(it)||hr(it)){ot(V,ii(void 0));return}}else{if(Gi(it))if(I.delete(V),R>zt){ot(V,ii(void 0));return}else return D.add(V),ot(V,xu(Pe)),We(Dt,it,!1,{fetcherSubmission:Pe,preventScrollReset:Me});if(hr(it)){_t(V,ee,it.error);return}}let cr=_.navigation.location||_.location,Qt=Qs(e.history,cr,Qe.signal),Bs=i||o,Na=_.navigation.state!=="idle"?oi(Bs,_.navigation.location,s):_.matches;Xe(Na,"Didn't find any matches after fetcher action");let zi=++A;L.set(V,zi);let ao=xu(Pe,it.data);_.fetchers.set(V,ao);let[fp,Fr]=iP(e.history,_,Na,Pe,cr,!1,P,N,$,B,D,Bs,s,[pe.route.id,it]);Fr.filter(Wt=>Wt.key!==V).forEach(Wt=>{let ei=Wt.key,vv=_.fetchers.get(ei),kM=xu(void 0,vv?vv.data:void 0);_.fetchers.set(ei,kM),sr(ei),Wt.controller&&I.set(ei,Wt.controller)}),W({fetchers:new Map(_.fetchers)});let Gl=()=>Fr.forEach(Wt=>sr(Wt.key));Qe.signal.addEventListener("abort",Gl);let{loaderResults:Xl,fetcherResults:Jl}=await It(_,Na,fp,Fr,Qt);if(Qe.signal.aborted)return;Qe.signal.removeEventListener("abort",Gl),L.delete(V),I.delete(V),Fr.forEach(Wt=>I.delete(Wt.key));let ht=Rp(Xl);if(ht)return We(Qt,ht.result,!1,{preventScrollReset:Me});if(ht=Rp(Jl),ht)return D.add(ht.key),We(Qt,ht.result,!1,{preventScrollReset:Me});let{loaderData:lr,errors:zs}=fP(_,Na,Xl,void 0,Fr,Jl);if(_.fetchers.has(V)){let Wt=ii(it.data);_.fetchers.set(V,Wt)}ne(zi),_.navigation.state==="loading"&&zi>R?(Xe(S,"Expected pending action"),O&&O.abort(),Y(_.navigation.location,{matches:Na,loaderData:lr,errors:zs,fetchers:new Map(_.fetchers)})):(W({errors:zs,loaderData:pP(_.loaderData,lr,Na,zs),fetchers:new Map(_.fetchers)}),P=!1)}async function Ue(V,ee,oe,pe,Ne,Re,Be,Me,Pe){let we=_.fetchers.get(V);ot(V,xu(Pe,we?we.data:void 0),{flushSync:Be});let ze=new AbortController,Qe=Qs(e.history,oe,ze.signal);if(Re){let it=await Ve(Ne,oe,Qe.signal);if(it.type==="aborted")return;if(it.type==="error"){_t(V,ee,it.error,{flushSync:Be});return}else if(it.matches)Ne=it.matches,pe=wu(Ne,oe);else{_t(V,ee,Or(404,{pathname:oe}),{flushSync:Be});return}}I.set(V,ze);let Dt=A,zt=(await He("loader",_,Qe,[pe],Ne,V))[pe.route.id];if(I.get(V)===ze&&I.delete(V),!Qe.signal.aborted){if($.has(V)){ot(V,ii(void 0));return}if(Gi(zt))if(R>Dt){ot(V,ii(void 0));return}else{D.add(V),await We(Qe,zt,!1,{preventScrollReset:Me});return}if(hr(zt)){_t(V,ee,zt.error);return}ot(V,ii(zt.data))}}async function We(V,ee,oe,{submission:pe,fetcherSubmission:Ne,preventScrollReset:Re,replace:Be}={}){ee.response.headers.has("X-Remix-Revalidate")&&(P=!0);let Me=ee.response.headers.get("Location");Xe(Me,"Expected a Location header on the redirect Response"),Me=uP(Me,new URL(V.url),s);let Pe=Ys(_.location,Me,{_isRedirect:!0});if(n){let it=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))it=!0;else if(T0.test(Me)){const cr=e.history.createURL(Me);it=cr.origin!==t.location.origin||Hr(cr.pathname,s)==null}if(it){Be?t.location.replace(Me):t.location.assign(Me);return}}O=null;let we=Be===!0||ee.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ze,formAction:Qe,formEncType:Dt}=_.navigation;!pe&&!Ne&&ze&&Qe&&Dt&&(pe=bP(_.navigation));let zt=pe||Ne;if(VX.has(ee.response.status)&&zt&&Kr(zt.formMethod))await ce(we,Pe,{submission:{...zt,formAction:Me},preventScrollReset:Re||E,enableViewTransition:oe?M:void 0});else{let it=$0(Pe,pe);await ce(we,Pe,{overrideNavigation:it,fetcherSubmission:Ne,preventScrollReset:Re||E,enableViewTransition:oe?M:void 0})}}async function He(V,ee,oe,pe,Ne,Re){let Be,Me={};try{Be=await JX(c,V,ee,oe,pe,Ne,Re,a,r)}catch(Pe){return pe.forEach(we=>{Me[we.route.id]={type:"error",error:Pe}}),Me}for(let[Pe,we]of Object.entries(Be))if(rJ(we)){let ze=we.result;Me[Pe]={type:"redirect",response:eJ(ze,oe,Pe,Ne,s)}}else Me[Pe]=await QX(we);return Me}async function It(V,ee,oe,pe,Ne){let Re=He("loader",V,Ne,oe,ee,null),Be=Promise.all(pe.map(async we=>{if(we.matches&&we.match&&we.controller){let ze=(await He("loader",V,Qs(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:ze}}else return Promise.resolve({[we.key]:{type:"error",error:Or(404,{pathname:we.path})}})})),Me=await Re,Pe=(await Be).reduce((we,ze)=>Object.assign(we,ze),{});return{loaderResults:Me,fetcherResults:Pe}}function lt(){P=!0,B.forEach((V,ee)=>{I.has(ee)&&N.add(ee),sr(ee)})}function ot(V,ee,oe={}){_.fetchers.set(V,ee),W({fetchers:new Map(_.fetchers)},{flushSync:(oe&&oe.flushSync)===!0})}function _t(V,ee,oe,pe={}){let Ne=Zi(_.matches,ee);ir(V),W({errors:{[Ne.route.id]:oe},fetchers:new Map(_.fetchers)},{flushSync:(pe&&pe.flushSync)===!0})}function Yt(V){return F.set(V,(F.get(V)||0)+1),$.has(V)&&$.delete(V),_.fetchers.get(V)||qX}function ir(V){let ee=_.fetchers.get(V);I.has(V)&&!(ee&&ee.state==="loading"&&L.has(V))&&sr(V),B.delete(V),L.delete(V),D.delete(V),$.delete(V),N.delete(V),_.fetchers.delete(V)}function no(V){let ee=(F.get(V)||0)-1;ee<=0?(F.delete(V),$.add(V)):F.set(V,ee),W({fetchers:new Map(_.fetchers)})}function sr(V){let ee=I.get(V);ee&&(ee.abort(),I.delete(V))}function ro(V){for(let ee of V){let oe=Yt(ee),pe=ii(oe.data);_.fetchers.set(ee,pe)}}function Q(){let V=[],ee=!1;for(let oe of D){let pe=_.fetchers.get(oe);Xe(pe,`Expected fetcher: ${oe}`),pe.state==="loading"&&(D.delete(oe),V.push(oe),ee=!0)}return ro(V),ee}function ne(V){let ee=[];for(let[oe,pe]of L)if(pe<V){let Ne=_.fetchers.get(oe);Xe(Ne,`Expected fetcher: ${oe}`),Ne.state==="loading"&&(sr(oe),L.delete(oe),ee.push(oe))}return ro(ee),ee.length>0}function le(V,ee){let oe=_.blockers.get(V)||bu;return z.get(V)!==ee&&z.set(V,ee),oe}function me(V){_.blockers.delete(V),z.delete(V)}function Te(V,ee){let oe=_.blockers.get(V)||bu;Xe(oe.state==="unblocked"&&ee.state==="blocked"||oe.state==="blocked"&&ee.state==="blocked"||oe.state==="blocked"&&ee.state==="proceeding"||oe.state==="blocked"&&ee.state==="unblocked"||oe.state==="proceeding"&&ee.state==="unblocked",`Invalid blocker state transition: ${oe.state} -> ${ee.state}`);let pe=new Map(_.blockers);pe.set(V,ee),W({blockers:pe})}function Zt({currentLocation:V,nextLocation:ee,historyAction:oe}){if(z.size===0)return;z.size>1&&un(!1,"A router only supports one blocker at a time");let pe=Array.from(z.entries()),[Ne,Re]=pe[pe.length-1],Be=_.blockers.get(Ne);if(!(Be&&Be.state==="proceeding")&&Re({currentLocation:V,nextLocation:ee,historyAction:oe}))return Ne}function Bt(V){let ee=Or(404,{pathname:V}),oe=i||o,{matches:pe,route:Ne}=mP(oe);return{notFoundMatches:pe,route:Ne,error:ee}}function Ze(V,ee,oe){if(p=V,y=ee,m=oe||null,!v&&_.navigation===A0){v=!0;let pe=Ee(_.location,_.matches);pe!=null&&W({restoreScrollPosition:pe})}return()=>{p=null,y=null,m=null}}function be(V,ee){return m&&m(V,ee.map(oe=>xX(oe,_.loaderData)))||V.key}function _e(V,ee){if(p&&y){let oe=be(V,ee);p[oe]=y()}}function Ee(V,ee){if(p){let oe=be(V,ee),pe=p[oe];if(typeof pe=="number")return pe}return null}function Oe(V,ee,oe){if(l)if(V){if(Object.keys(V[0].params).length>0)return{active:!0,matches:Mp(ee,oe,s,!0)}}else return{active:!0,matches:Mp(ee,oe,s,!0)||[]};return{active:!1,matches:null}}async function Ve(V,ee,oe){if(!l)return{type:"success",matches:V};let pe=V;for(;;){let Ne=i==null,Re=i||o,Be=a;try{await l({path:ee,matches:pe,patch:(we,ze)=>{oe.aborted||cP(we,ze,Re,Be,r)}})}catch(we){return{type:"error",error:we,partialMatches:pe}}finally{Ne&&!oe.aborted&&(o=[...o])}if(oe.aborted)return{type:"aborted"};let Me=oi(Re,ee,s);if(Me)return{type:"success",matches:Me};let Pe=Mp(Re,ee,s,!0);if(!Pe||pe.length===Pe.length&&pe.every((we,ze)=>we.route.id===Pe[ze].route.id))return{type:"success",matches:null};pe=Pe}}function Mt(V){a={},i=Np(V,r,void 0,a)}function qt(V,ee){let oe=i==null;cP(V,ee,i||o,a,r),oe&&(o=[...o],W({}))}return x={get basename(){return s},get future(){return u},get state(){return _},get routes(){return o},get window(){return t},initialize:q,subscribe:K,enableScrollRestoration:Ze,navigate:re,fetch:$e,revalidate:U,createHref:V=>e.history.createHref(V),encodeLocation:V=>e.history.encodeLocation(V),getFetcher:Yt,deleteFetcher:no,dispose:J,getBlocker:le,deleteBlocker:me,patchRoutes:qt,_internalFetchControllers:I,_internalSetRoutes:Mt},x}function HX(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function I0(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=Ap(r||".",Pp(i),Hr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=L0(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let f=u.toString();c.search=f?`?${f}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:Aa([n,c.pathname])),uo(c)}function aP(e,t,n){if(!n||!HX(n))return{path:t};if(n.formMethod&&!aJ(n.formMethod))return{path:t,error:Or(405,{method:n.formMethod})};let r=()=>({path:t,error:Or(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=yP(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Kr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[f,p])=>`${d}${f}=${p}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Kr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=D0(n.formData),s=n.formData;else if(n.body instanceof FormData)i=D0(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=dP(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=dP(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Kr(c.formMethod))return{path:t,submission:c};let l=fo(t);return e&&l.search&&L0(l.search)&&i.append("index",""),l.search=`?${i}`,{path:uo(l),submission:c}}function oP(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function iP(e,t,n,r,a,o,i,s,c,l,u,d,f,p){let m=p?hr(p[1])?p[1].error:p[1].data:void 0,y=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=oP(n,Object.keys(t.errors)[0],!0):p&&hr(p[1])&&(b=oP(n,p[0]));let w=p?p[1].statusCode:void 0,j=w&&w>=400,x=b.filter((S,E)=>{let{route:O}=S;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return R0(O,t.loaderData,t.errors);if(KX(t.loaderData,t.matches[E],S))return!0;let M=t.matches[E],C=S;return sP(S,{currentUrl:y,currentParams:M.params,nextUrl:v,nextParams:C.params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:j?!1:i||y.pathname+y.search===v.pathname+v.search||y.search!==v.search||ZX(M,C)})}),_=[];return l.forEach((S,E)=>{if(o||!n.some(T=>T.route.id===S.routeId)||c.has(E))return;let O=oi(d,S.path,f);if(!O){_.push({key:E,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let M=t.fetchers.get(E),C=wu(O,S.path),k=!1;u.has(E)?k=!1:s.has(E)?(s.delete(E),k=!0):M&&M.state!=="idle"&&M.data===void 0?k=i:k=sP(C,{currentUrl:y,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:j?!1:i}),k&&_.push({key:E,routeId:S.routeId,path:S.path,matches:O,match:C,controller:new AbortController})}),[x,_]}function R0(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function KX(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function ZX(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function sP(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function cP(e,t,n,r,a){let o;if(e){let c=r[e];Xe(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>lP(c,l))),s=Np(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function lP(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>lP(n,o))}):!1}async function GX(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Xe(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";un(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!bX.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function XX({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function JX(e,t,n,r,a,o,i,s,c,l){let u=o.map(p=>p.route.lazy?GX(p.route,c,s):void 0),d=o.map((p,m)=>{let y=u[m],v=a.some(b=>b.route.id===p.route.id);return{...p,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(v=!0),v?YX(t,r,p,y,b,l):Promise.resolve({type:"data",result:void 0}))}}),f=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return f}async function YX(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((m,y)=>u=y);s=()=>u(),t.signal.addEventListener("abort",s);let f=m=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...m!==void 0?[m]:[]),p=(async()=>{try{return{type:"data",result:await(a?a(m=>f(m)):f())}}catch(m){return{type:"error",result:m}}})();return Promise.race([p,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw Or(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw Or(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function QX(e){var r,a,o,i;let{result:t,type:n}=e;if(vP(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Tp(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(gP(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Tp(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:Ip(t)?t.status:void 0}}return gP(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function eJ(e,t,n,r,a){let o=e.headers.get("Location");if(Xe(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!T0.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=I0(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function uP(e,t,n){if(T0.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Hr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function Qs(e,t,n,r){let a=e.createURL(yP(t)).toString(),o={signal:n};if(r&&Kr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=D0(r.formData):o.body=r.formData}return new Request(a,o)}function D0(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function dP(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function tJ(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&hr(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,p=t[f];if(Xe(!Gi(p),"Cannot handle redirect results in processLoaderData"),hr(p)){let m=p.error;if(u!==void 0&&(m=u,u=void 0),i=i||{},a)i[f]=m;else{let y=Zi(e,f);i[y.route.id]==null&&(i[y.route.id]=m)}r||(o[f]=nP),c||(c=!0,s=Ip(p.error)?p.error.status:500),p.headers&&(l[f]=p.headers)}else o[f]=p.data,p.statusCode&&p.statusCode!==200&&!c&&(s=p.statusCode),p.headers&&(l[f]=p.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function fP(e,t,n,r,a,o){let{loaderData:i,errors:s}=tJ(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,f=o[l];if(Xe(f,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(hr(f)){let p=Zi(e.matches,u==null?void 0:u.route.id);s&&s[p.route.id]||(s={...s,[p.route.id]:f.error}),e.fetchers.delete(l)}else if(Gi(f))Xe(!1,"Unhandled fetcher revalidation redirect");else{let p=ii(f.data);e.fetchers.set(l,p)}}),{loaderData:i,errors:s}}function pP(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==nP).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function hP(e){return e?hr(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Zi(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function mP(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Or(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Tp(e||500,i,new Error(s),!0)}function Rp(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Gi(a))return{key:r,result:a}}}function yP(e){let t=typeof e=="string"?fo(e):e;return uo({...t,hash:""})}function nJ(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function rJ(e){return vP(e.result)&&UX.has(e.result.status)}function hr(e){return e.type==="error"}function Gi(e){return(e&&e.type)==="redirect"}function gP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function vP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function aJ(e){return zX.has(e.toUpperCase())}function Kr(e){return FX.has(e.toUpperCase())}function L0(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function wu(e,t){let n=typeof t=="string"?fo(t).search:t.search;if(e[e.length-1].route.index&&L0(n||""))return e[e.length-1];let r=Qk(e);return r[r.length-1]}function bP(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function $0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function oJ(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function xu(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function iJ(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ii(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function sJ(e,t){try{let n=e.sessionStorage.getItem(tP);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function cJ(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(tP,JSON.stringify(n))}catch(r){un(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function lJ(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Xi=g.createContext(null);Xi.displayName="DataRouter";var _u=g.createContext(null);_u.displayName="DataRouterState";var F0=g.createContext({isTransitioning:!1});F0.displayName="ViewTransition";var wP=g.createContext(new Map);wP.displayName="Fetchers";var uJ=g.createContext(null);uJ.displayName="Await";var Zr=g.createContext(null);Zr.displayName="Navigation";var Dp=g.createContext(null);Dp.displayName="Location";var Cr=g.createContext({outlet:null,matches:[],isDataRoute:!1});Cr.displayName="Route";var B0=g.createContext(null);B0.displayName="RouteError";function dJ(e,{relative:t}={}){Xe(ec(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Zr),{hash:a,pathname:o,search:i}=ju(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:Aa([n,o])),r.createHref({pathname:s,search:i,hash:a})}function ec(){return g.useContext(Dp)!=null}function Ta(){return Xe(ec(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(Dp).location}var xP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _P(e){g.useContext(Zr).static||g.useLayoutEffect(e)}function Ji(){let{isDataRoute:e}=g.useContext(Cr);return e?EJ():fJ()}function fJ(){Xe(ec(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Xi),{basename:t,navigator:n}=g.useContext(Zr),{matches:r}=g.useContext(Cr),{pathname:a}=Ta(),o=JSON.stringify(Pp(r)),i=g.useRef(!1);return _P(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(un(i.current,xP),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=Ap(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:Aa([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var pJ=g.createContext(null);function hJ(e){let t=g.useContext(Cr).outlet;return t&&g.createElement(pJ.Provider,{value:e},t)}function Lp(){let{matches:e}=g.useContext(Cr),t=e[e.length-1];return t?t.params:{}}function ju(e,{relative:t}={}){let{matches:n}=g.useContext(Cr),{pathname:r}=Ta(),a=JSON.stringify(Pp(n));return g.useMemo(()=>Ap(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function mJ(e,t,n,r){Xe(ec(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Zr),{matches:o}=g.useContext(Cr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";EP(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=Ta(),f;f=d;let p=f.pathname||"/",m=p;if(l!=="/"){let v=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=oi(e,{pathname:m});return un(u||y!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),un(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),wJ(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:Aa([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Aa([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function yJ(){let e=jP(),t=Ip(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var gJ=g.createElement(yJ,null),vJ=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(Cr.Provider,{value:this.props.routeContext},g.createElement(B0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function bJ({routeContext:e,match:t,children:n}){let r=g.useContext(Xi);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(Cr.Provider,{value:e},n)}function wJ(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Xe(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,f=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,f=!1,p=null,m=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,p=l.route.errorElement||gJ,i&&(s<0&&u===0?(EP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):s===u&&(f=!0,m=l.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=p:f?b=m:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(bJ,{match:l,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(vJ,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}function z0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xJ(e){let t=g.useContext(Xi);return Xe(t,z0(e)),t}function _J(e){let t=g.useContext(_u);return Xe(t,z0(e)),t}function jJ(e){let t=g.useContext(Cr);return Xe(t,z0(e)),t}function U0(e){let t=jJ(e),n=t.matches[t.matches.length-1];return Xe(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function SJ(){return U0("useRouteId")}function jP(){var r;let e=g.useContext(B0),t=_J("useRouteError"),n=U0("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function EJ(){let{router:e}=xJ("useNavigate"),t=U0("useNavigate"),n=g.useRef(!1);return _P(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{un(n.current,xP),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var SP={};function EP(e,t,n){!t&&!SP[e]&&(SP[e]=!0,un(!1,n))}var OP={};function CP(e,t){!e&&!OP[t]&&(OP[t]=!0,console.warn(t))}function NP(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&un(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&un(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&un(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var OJ=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function CJ({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[f,p]=g.useState(),m=g.useRef(new Map),y=g.useCallback((j,{deletedFetchers:x,flushSync:_,viewTransitionOpts:S})=>{x.forEach(O=>m.current.delete(O)),j.fetchers.forEach((O,M)=>{O.data!==void 0&&m.current.set(M,O.data)}),CP(_===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(CP(S==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!E){t&&_?t(()=>r(j)):g.startTransition(()=>r(j));return}if(t&&_){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(j))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),p({state:j,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(o(j),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(y),[e,y]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new OJ)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let j=a,x=c.promise,_=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(j)),await x});_.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(_)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&f&&(o(f.state),s({isTransitioning:!0,flushSync:!1,currentLocation:f.currentLocation,nextLocation:f.nextLocation}),p(void 0))},[i.isTransitioning,f]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:j=>e.navigate(j),push:(j,x,_)=>e.navigate(j,{state:x,preventScrollReset:_==null?void 0:_.preventScrollReset}),replace:(j,x,_)=>e.navigate(j,{replace:!0,state:x,preventScrollReset:_==null?void 0:_.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Xi.Provider,{value:w},g.createElement(_u.Provider,{value:n},g.createElement(wP.Provider,{value:m.current},g.createElement(F0.Provider,{value:i},g.createElement(AJ,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(NJ,{routes:e.routes,future:e.future,state:n})))))),null)}var NJ=g.memo(MJ);function MJ({routes:e,future:t,state:n}){return mJ(e,void 0,n,t)}function kJ({to:e,replace:t,state:n,relative:r}){Xe(ec(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Zr);un(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(Cr),{pathname:i}=Ta(),s=Ji(),c=Ap(e,Pp(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function PJ(e){return hJ(e.context)}function si(e){Xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function AJ({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Xe(!ec(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=fo(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:f="default"}=n,p=g.useMemo(()=>{let m=Hr(c,i);return m==null?null:{location:{pathname:m,search:l,hash:u,state:d,key:f},navigationType:r}},[i,c,l,u,d,f,r]);return un(p!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:g.createElement(Zr.Provider,{value:s},g.createElement(Dp.Provider,{children:t,value:p}))}function V0(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,V0(r.props.children,o));return}Xe(r.type===si,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=V0(r.props.children,o)),n.push(i)}),n}var TJ=V0,$p="get",Fp="application/x-www-form-urlencoded";function Bp(e){return e!=null&&typeof e.tagName=="string"}function IJ(e){return Bp(e)&&e.tagName.toLowerCase()==="button"}function RJ(e){return Bp(e)&&e.tagName.toLowerCase()==="form"}function DJ(e){return Bp(e)&&e.tagName.toLowerCase()==="input"}function LJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $J(e,t){return e.button===0&&(!t||t==="_self")&&!LJ(e)}var zp=null;function FJ(){if(zp===null)try{new FormData(document.createElement("form"),0),zp=!1}catch{zp=!0}return zp}var BJ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function q0(e){return e!=null&&!BJ.has(e)?(un(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Fp}"`),null):e}function zJ(e,t){let n,r,a,o,i;if(RJ(e)){let s=e.getAttribute("action");r=s?Hr(s,t):null,n=e.getAttribute("method")||$p,a=q0(e.getAttribute("enctype"))||Fp,o=new FormData(e)}else if(IJ(e)||DJ(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Hr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||$p,a=q0(e.getAttribute("formenctype"))||q0(s.getAttribute("enctype"))||Fp,o=new FormData(s,e),!FJ()){let{name:l,type:u,value:d}=e;if(u==="image"){let f=l?`${l}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else l&&o.append(l,d)}}else{if(Bp(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=$p,r=null,a=Fp,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function W0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function UJ(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VJ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function qJ(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await UJ(o,n);return i.links?i.links():[]}return[]}));return ZJ(r.flat(1).filter(VJ).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function MP(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function WJ(e,t){return HJ(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function HJ(e){return[...new Set(e)]}function KJ(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function ZJ(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(KJ(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function GJ(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function XJ(){let e=g.useContext(Xi);return W0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function JJ(){let e=g.useContext(_u);return W0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var H0=g.createContext(void 0);H0.displayName="FrameworkContext";function kP(){let e=g.useContext(H0);return W0(e,"You must render this element inside a <HydratedRouter> element"),e}function YJ(e,t){let n=g.useContext(H0),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let y=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(y,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[r]);let p=()=>{a(!0)},m=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,f,{}]:[o,f,{onFocus:Su(s,p),onBlur:Su(c,m),onMouseEnter:Su(l,p),onMouseLeave:Su(u,m),onTouchStart:Su(d,p)}]:[!1,f,{}]}function Su(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function QJ({page:e,...t}){let{router:n}=XJ(),r=g.useMemo(()=>oi(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(tY,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function eY(e){let{manifest:t,routeModules:n}=kP(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return qJ(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function tY({page:e,matches:t,...n}){let r=Ta(),{manifest:a,routeModules:o}=kP(),{loaderData:i,matches:s}=JJ(),c=g.useMemo(()=>MP(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>MP(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let p=new Set,m=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(j=>j.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?m=!0:p.add(v.route.id))}),p.size===0)return[];let y=GJ(e);return m&&p.size>0&&y.searchParams.set("_routes",t.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>WJ(l,a),[l,a]),f=eY(l);return g.createElement(g.Fragment,null,u.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:m})=>g.createElement("link",{key:p,...m})))}function nY(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var PP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{PP&&(window.__reactRouterVersion="7.0.2")}catch{}function AP(e,t){return rP({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:yX({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||TP(),routes:e,mapRouteProperties:NP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function rY(e,t){return rP({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:gX({window:t==null?void 0:t.window}),hydrationData:TP(),routes:e,mapRouteProperties:NP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function TP(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:aY(e.errors)}),e}function aY(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Tp(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var IP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,K0=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=g.useContext(Zr),m=typeof c=="string"&&IP.test(c),y,v=!1;if(typeof c=="string"&&m&&(y=c,PP))try{let O=new URL(window.location.href),M=c.startsWith("//")?new URL(O.protocol+c):new URL(c),C=Hr(M.pathname,p);M.origin===O.origin&&C!=null?c=C+M.search+M.hash:v=!0}catch{un(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=dJ(c,{relative:r}),[w,j,x]=YJ(n,d),_=cY(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(O){e&&e(O),O.defaultPrevented||_(O)}let E=g.createElement("a",{...d,...x,href:y||b,onClick:v||a?e:S,ref:nY(f,j),target:s,"data-discover":!m&&t==="render"?"true":void 0});return w&&!m?g.createElement(g.Fragment,null,E,g.createElement(QJ,{page:b})):E});K0.displayName="Link";var oY=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=ju(o,{relative:c.relative}),d=Ta(),f=g.useContext(_u),{navigator:p,basename:m}=g.useContext(Zr),y=f!=null&&pY(u)&&i===!0,v=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=Hr(w,m)||w);const j=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(j)==="/",_=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:x,isPending:_,isTransitioning:y},E=x?e:void 0,O;typeof n=="function"?O=n(S):O=[n,x?"active":null,_?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(S):a;return g.createElement(K0,{...c,"aria-current":E,className:O,ref:l,style:M,to:o,viewTransition:i},typeof s=="function"?s(S):s)});oY.displayName="NavLink";var iY=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=$p,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=dY(),y=fY(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&IP.test(s),w=j=>{if(c&&c(j),j.defaultPrevented)return;j.preventDefault();let x=j.nativeEvent.submitter,_=(x==null?void 0:x.getAttribute("formmethod"))||i;m(x||j.currentTarget,{fetcherKey:t,method:_,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:p,method:v,action:y,onSubmit:r?c:w,...f,"data-discover":!b&&e==="render"?"true":void 0})});iY.displayName="Form";function sY(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RP(e){let t=g.useContext(Xi);return Xe(t,sY(e)),t}function cY(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=Ji(),c=Ta(),l=ju(e,{relative:o});return g.useCallback(u=>{if($J(u,t)){u.preventDefault();let d=n!==void 0?n:uo(c)===uo(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var lY=0,uY=()=>`__${String(++lY)}__`;function dY(){let{router:e}=RP("useSubmit"),{basename:t}=g.useContext(Zr),n=SJ();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=zJ(r,t);if(a.navigate===!1){let u=a.fetcherKey||uY();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function fY(e,{relative:t}={}){let{basename:n}=g.useContext(Zr),r=g.useContext(Cr);Xe(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...ju(e||".",{relative:t})},i=Ta();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Aa([n,o.pathname])),uo(o)}function pY(e,t={}){let n=g.useContext(F0);Xe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=RP("useViewTransitionState"),a=ju(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Hr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Hr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return kp(a.pathname,i)!=null||kp(a.pathname,o)!=null}new TextEncoder;function hY(e){return g.createElement(CJ,{flushSync:Ql.flushSync,...e})}var mY=xDe.useId||(()=>{}),yY=0;Rt=function(e){const[t,n]=g.useState(mY());return ln(()=>{e||n(r=>r??String(yY++))},[e]),e||(t?`radix-${t}`:"")};var Z0="Collapsible",[gY,DP]=ur(Z0),[vY,G0]=gY(Z0),LP=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Pn({prop:r,defaultProp:a,onChange:i});return h.jsx(vY,{scope:n,disabled:o,contentId:Rt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Ae.div,{"data-state":Q0(c),"data-disabled":o?"":void 0,...s,ref:t})})});LP.displayName=Z0;var $P="CollapsibleTrigger",X0=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=G0($P,n);return h.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Q0(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});X0.displayName=$P;var J0="CollapsibleContent",Y0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=G0(J0,e.__scopeCollapsible);return h.jsx(Br,{present:n||a.open,children:({present:o})=>h.jsx(bY,{...r,ref:t,present:o})})});Y0.displayName=J0;var bY=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=G0(J0,n),[s,c]=g.useState(r),l=g.useRef(null),u=jt(t,l),d=g.useRef(0),f=d.current,p=g.useRef(0),m=p.current,y=i.open||s,v=g.useRef(y),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),ln(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const j=w.getBoundingClientRect();d.current=j.height,p.current=j.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Ae.div,{"data-state":Q0(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!y,...o,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...e.style},children:y&&a})});function Q0(e){return e?"open":"closed"}var FP=LP,wY=X0,xY=Y0;const _Y=FP,jY=X0,SY=Y0,eb=768;function EY(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${eb-1}px)`),r=()=>{t(window.innerWidth<eb)};return n.addEventListener("change",r),t(window.innerWidth<eb),()=>n.removeEventListener("change",r)},[]),!!e}let Eu;Eu=io("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),tt=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?ni:"button";return h.jsx(i,{className:Z(Eu({variant:t,size:n,className:e})),ref:o,...a})}),tt.displayName="Button";const Gt=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Gt.displayName="Input";var OY="Separator",BP="horizontal",CY=["horizontal","vertical"],zP=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=BP,...a}=e,o=NY(r)?r:BP,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Ae.div,{"data-orientation":o,...i,...a,ref:t})});zP.displayName=OY;function NY(e){return CY.includes(e)}Jv=zP,Ks=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Jv,{ref:a,decorative:n,orientation:t,className:Z("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Ks.displayName=Jv.displayName;var tb="focusScope.autoFocusOnMount",nb="focusScope.autoFocusOnUnmount",UP={bubbles:!1,cancelable:!0},MY="FocusScope",Up=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=dr(a),u=dr(o),d=g.useRef(null),f=jt(t,y=>c(y)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(j){if(p.paused||!s)return;const x=j.target;s.contains(x)?d.current=x:ci(d.current,{select:!0})},v=function(j){if(p.paused||!s)return;const x=j.relatedTarget;x!==null&&(s.contains(x)||ci(d.current,{select:!0}))},b=function(j){if(document.activeElement===document.body)for(const x of j)x.removedNodes.length>0&&ci(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){WP.add(p);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(tb,UP);s.addEventListener(tb,l),s.dispatchEvent(v),v.defaultPrevented||(kY(RY(VP(s)),{select:!0}),document.activeElement===y&&ci(s))}return()=>{s.removeEventListener(tb,l),setTimeout(()=>{const v=new CustomEvent(nb,UP);s.addEventListener(nb,u),s.dispatchEvent(v),v.defaultPrevented||ci(y??document.body,{select:!0}),s.removeEventListener(nb,u),WP.remove(p)},0)}}},[s,l,u,p]);const m=g.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[j,x]=PY(w);j&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&ci(j,{select:!0})):y.shiftKey&&b===j&&(y.preventDefault(),n&&ci(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,p.paused]);return h.jsx(Ae.div,{tabIndex:-1,...i,ref:f,onKeyDown:m})});Up.displayName=MY;function kY(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ci(r,{select:t}),document.activeElement!==n)return}function PY(e){const t=VP(e),n=qP(t,e),r=qP(t.reverse(),e);return[n,r]}function VP(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function qP(e,t){for(const n of e)if(!AY(n,{upTo:t}))return n}function AY(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function TY(e){return e instanceof HTMLInputElement&&"select"in e}function ci(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&TY(e)&&t&&e.select()}}var WP=IY();function IY(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=HP(e,t),e.unshift(t)},remove(t){var n;e=HP(e,t),(n=e[0])==null||n.resume()}}}function HP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function RY(e){return e.filter(t=>t.tagName!=="A")}var rb=0;hu=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??KP()),document.body.insertAdjacentElement("beforeend",e[1]??KP()),rb++,()=>{rb===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),rb--}},[])};function KP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}En=function(){return En=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},En.apply(this,arguments)},jp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},p0=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var Vp="right-scroll-bar-position",qp="width-before-scroll-bar",DY="with-scroll-bars-hidden",LY="--removed-body-scroll-bar-size";function ab(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function $Y(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var FY=typeof window<"u"?g.useLayoutEffect:g.useEffect,ZP=new WeakMap;function BY(e,t){var n=$Y(null,function(r){return e.forEach(function(a){return ab(a,r)})});return FY(function(){var r=ZP.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||ab(s,null)}),o.forEach(function(s){a.has(s)||ab(s,i)})}ZP.set(n,e)},[e]),n}function zY(e){return e}function UY(e,t){t===void 0&&(t=zY);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}d0=function(e){e===void 0&&(e={});var t=UY(null);return t.options=En({async:!0,ssr:!1},e),t};var GP=function(e){var t=e.sideCar,n=jp(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,En({},n))};GP.isSideCarExport=!0,h0=function(e,t){return e.useMedium(t),GP};var XP=d0(),ob=function(){},Wp=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:ob,onWheelCapture:ob,onTouchMoveCapture:ob}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,j=jp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,_=BY([n,t]),S=En(En({},j),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:XP,removeScrollBar:l,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),En(En({},S),{ref:_})):g.createElement(b,En({},S,{className:c,ref:_}),s))});Wp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Wp.classNames={fullWidth:qp,zeroRight:Vp},f0=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function VY(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=f0();return t&&e.setAttribute("nonce",t),e}function qY(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function WY(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let JP,YP,QP,Hp,eA,tA,nA,Yi,rA,ib,aA,oA,Kp;if(JP=function(){var e=0,t=null;return{add:function(n){e==0&&(t=VY())&&(qY(t,n),WY(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},YP=function(){var e=JP();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Sp=function(){var e=YP(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},QP={left:0,top:0,right:0,gap:0},Hp=function(e){return parseInt(e||"",10)||0},eA=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Hp(n),Hp(r),Hp(a)]},tA=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return QP;var t=eA(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},nA=Sp(),Yi="data-scroll-locked",rA=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(DY,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Yi,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Vp,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(qp,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Vp," .").concat(Vp,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(qp," .").concat(qp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Yi,`] {
    `).concat(LY,": ").concat(s,`px;
  }
`)},ib=function(){var e=parseInt(document.body.getAttribute(Yi)||"0",10);return isFinite(e)?e:0},aA=function(){g.useEffect(function(){return document.body.setAttribute(Yi,(ib()+1).toString()),function(){var e=ib()-1;e<=0?document.body.removeAttribute(Yi):document.body.setAttribute(Yi,e.toString())}},[])},oA=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;aA();var o=g.useMemo(function(){return tA(a)},[a]);return g.createElement(nA,{styles:rA(o,!t,a,n?"":"!important")})},Kp=!1,typeof window<"u")try{var Zp=Object.defineProperty({},"passive",{get:function(){return Kp=!0,!0}});window.addEventListener("test",Zp,Zp),window.removeEventListener("test",Zp,Zp)}catch{Kp=!1}var tc=Kp?{passive:!1}:!1,HY=function(e){return e.tagName==="TEXTAREA"},iA=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!HY(e)&&n[t]==="visible")},KY=function(e){return iA(e,"overflowY")},ZY=function(e){return iA(e,"overflowX")},sA=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=cA(e,r);if(a){var o=lA(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},GY=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},XY=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},cA=function(e,t){return e==="v"?KY(t):ZY(t)},lA=function(e,t){return e==="v"?GY(t):XY(t)},JY=function(e,t){return e==="h"&&t==="rtl"?-1:1},YY=function(e,t,n,r,a){var o=JY(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=lA(e,s),m=p[0],y=p[1],v=p[2],b=y-v-o*m;(m||b)&&cA(e,s)&&(d+=b,f+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},Gp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},uA=function(e){return[e.deltaX,e.deltaY]},dA=function(e){return e&&"current"in e?e.current:e},QY=function(e,t){return e[0]===t[0]&&e[1]===t[1]},eQ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},tQ=0,nc=[];function nQ(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(tQ++)[0],o=g.useState(Sp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=p0([e.lockRef.current],(e.shards||[]).map(dA),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Gp(y),w=n.current,j="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],_,S=y.target,E=Math.abs(j)>Math.abs(x)?"h":"v";if("touches"in y&&E==="h"&&S.type==="range")return!1;var O=sA(E,S);if(!O)return!0;if(O?_=E:(_=E==="v"?"h":"v",O=sA(E,S)),!O)return!1;if(!r.current&&"changedTouches"in y&&(j||x)&&(r.current=_),!_)return!0;var M=r.current||_;return YY(M,v,y,M==="h"?j:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!nc.length||nc[nc.length-1]!==o)){var b="deltaY"in v?uA(v):Gp(v),w=t.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&QY(_.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var j=(i.current.shards||[]).map(dA).filter(Boolean).filter(function(_){return _.contains(v.target)}),x=j.length>0?s(v,j[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var j={name:y,delta:v,target:b,should:w,shadowParent:rQ(b)};t.current.push(j),setTimeout(function(){t.current=t.current.filter(function(x){return x!==j})},1)},[]),u=g.useCallback(function(y){n.current=Gp(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,uA(y),y.target,s(y,e.lockRef.current))},[]),f=g.useCallback(function(y){l(y.type,Gp(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return nc.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,tc),document.addEventListener("touchmove",c,tc),document.addEventListener("touchstart",u,tc),function(){nc=nc.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,tc),document.removeEventListener("touchmove",c,tc),document.removeEventListener("touchstart",u,tc)}},[]);var p=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:eQ(a)}):null,p?g.createElement(oA,{gapMode:e.gapMode}):null)}function rQ(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const aQ=h0(XP,nQ);var Xp=g.forwardRef(function(e,t){return g.createElement(Wp,En({},e,{ref:t,sideCar:aQ}))});Xp.classNames=Wp.classNames;let fA,Qi,Ou,Cu,Jp,sb,pA,hA,Yp,cb,lb,mA,Nr,ub;fA=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Qi=new WeakMap,Ou=new WeakMap,Cu={},Jp=0,sb=function(e){return e&&(e.host||sb(e.parentNode))},pA=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=sb(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},hA=function(e,t,n,r){var a=pA(t,Array.isArray(e)?e:[e]);Cu[n]||(Cu[n]=new WeakMap);var o=Cu[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))u(f);else try{var p=f.getAttribute(r),m=p!==null&&p!=="false",y=(Qi.get(f)||0)+1,v=(o.get(f)||0)+1;Qi.set(f,y),o.set(f,v),i.push(f),y===1&&m&&Ou.set(f,!0),v===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),s.clear(),Jp++,function(){i.forEach(function(d){var f=Qi.get(d)-1,p=o.get(d)-1;Qi.set(d,f),o.set(d,p),f||(Ou.has(d)||d.removeAttribute(r),Ou.delete(d)),p||d.removeAttribute(n)}),Jp--,Jp||(Qi=new WeakMap,Qi=new WeakMap,Ou=new WeakMap,Cu={})}},pu=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=fA(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),hA(r,a,n,"aria-hidden")):function(){return null}},Yp="Dialog",[cb,lb]=ur(Yp),[mA,Nr]=cb(Yp),ub=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Pn({prop:r,defaultProp:a,onChange:o});return h.jsx(mA,{scope:t,triggerRef:s,contentRef:c,contentId:Rt(),titleId:Rt(),descriptionId:Rt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},ub.displayName=Yp;var yA="DialogTrigger",gA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(yA,n),o=jt(t,a.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":pb(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});gA.displayName=yA;var db="DialogPortal",[oQ,vA]=cb(db,{forceMount:void 0}),bA=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=Nr(db,t);return h.jsx(oQ,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Br,{present:n||o.open,children:h.jsx(_v,{asChild:!0,container:a,children:i})}))})};bA.displayName=db;var Qp="DialogOverlay",wA=g.forwardRef((e,t)=>{const n=vA(Qp,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Nr(Qp,e.__scopeDialog);return o.modal?h.jsx(Br,{present:r||o.open,children:h.jsx(iQ,{...a,ref:t})}):null});wA.displayName=Qp;var iQ=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(Qp,n);return h.jsx(Xp,{as:ni,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Ae.div,{"data-state":pb(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),es="DialogContent",xA=g.forwardRef((e,t)=>{const n=vA(es,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Nr(es,e.__scopeDialog);return h.jsx(Br,{present:r||o.open,children:o.modal?h.jsx(sQ,{...a,ref:t}):h.jsx(cQ,{...a,ref:t})})});xA.displayName=es;var sQ=g.forwardRef((e,t)=>{const n=Nr(es,e.__scopeDialog),r=g.useRef(null),a=jt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return pu(o)},[]),h.jsx(_A,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),cQ=g.forwardRef((e,t)=>{const n=Nr(es,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(_A,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),_A=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=Nr(es,n),c=g.useRef(null),l=jt(t,c);return hu(),h.jsxs(h.Fragment,{children:[h.jsx(Up,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(xv,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":pb(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(MA,{titleId:s.titleId}),h.jsx(PA,{contentRef:c,descriptionId:s.descriptionId})]})]})}),fb="DialogTitle",jA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(fb,n);return h.jsx(Ae.h2,{id:a.titleId,...r,ref:t})});jA.displayName=fb;var SA="DialogDescription",EA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(SA,n);return h.jsx(Ae.p,{id:a.descriptionId,...r,ref:t})});EA.displayName=SA;var OA="DialogClose",CA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(OA,n);return h.jsx(Ae.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});CA.displayName=OA;function pb(e){return e?"open":"closed"}let hb,NA,mb,MA,kA,PA,AA;hb="DialogTitleWarning",[NA,mb]=_De(hb,{contentName:es,titleName:fb,docsSlug:"dialog"}),MA=({titleId:e})=>{const t=mb(hb),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},kA="DialogDescriptionWarning",PA=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${mb(kA).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},ou=ub,AA=gA,cu=bA,Hi=wA,Ki=xA,Ws=jA,Hs=EA,lu=CA;const lQ=ou,uQ=cu,TA=g.forwardRef(({className:e,...t},n)=>h.jsx(Hi,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));TA.displayName=Hi.displayName;const dQ=io("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),IA=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(uQ,{children:[h.jsx(TA,{}),h.jsxs(Ki,{ref:a,className:Z(dQ({side:e}),t),...r,children:[n,h.jsxs(lu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(fe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));IA.displayName=Ki.displayName;const fQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ws,{ref:n,className:Z("text-lg font-semibold text-foreground",e),...t}));fQ.displayName=Ws.displayName;const pQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Hs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));pQ.displayName=Hs.displayName;function RA({className:e,...t}){return h.jsx("div",{className:Z("animate-pulse rounded-md bg-muted",e),...t})}const hQ=["top","right","bottom","left"],Ia=Math.min,mr=Math.max,eh=Math.round,th=Math.floor,li=e=>({x:e,y:e}),mQ={left:"right",right:"left",bottom:"top",top:"bottom"},yQ={start:"end",end:"start"};function yb(e,t,n){return mr(e,Ia(t,n))}function po(e,t){return typeof e=="function"?e(t):e}function ho(e){return e.split("-")[0]}function rc(e){return e.split("-")[1]}function gb(e){return e==="x"?"y":"x"}function vb(e){return e==="y"?"height":"width"}function ui(e){return["top","bottom"].includes(ho(e))?"y":"x"}function bb(e){return gb(ui(e))}function gQ(e,t,n){n===void 0&&(n=!1);const r=rc(e),a=bb(e),o=vb(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=nh(i)),[i,nh(i)]}function vQ(e){const t=nh(e);return[wb(e),t,wb(t)]}function wb(e){return e.replace(/start|end/g,t=>yQ[t])}function bQ(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function wQ(e,t,n,r){const a=rc(e);let o=bQ(ho(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(wb)))),o}function nh(e){return e.replace(/left|right|bottom|top/g,t=>mQ[t])}function xQ(e){return{top:0,right:0,bottom:0,left:0,...e}}function DA(e){return typeof e!="number"?xQ(e):{top:e,right:e,bottom:e,left:e}}function rh(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function LA(e,t,n){let{reference:r,floating:a}=e;const o=ui(t),i=bb(t),s=vb(i),c=ho(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,f=r[s]/2-a[s]/2;let p;switch(c){case"top":p={x:u,y:r.y-a.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-a.width,y:d};break;default:p={x:r.x,y:r.y}}switch(rc(t)){case"start":p[i]-=f*(n&&l?-1:1);break;case"end":p[i]+=f*(n&&l?-1:1);break}return p}const _Q=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=LA(l,r,c),f=r,p={},m=0;for(let y=0;y<s.length;y++){const{name:v,fn:b}=s[y],{x:w,y:j,data:x,reset:_}=await b({x:u,y:d,initialPlacement:r,placement:f,strategy:a,middlewareData:p,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=j??d,p={...p,[v]:{...p[v],...x}},_&&m<=50&&(m++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(l=_.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):_.rects),{x:u,y:d}=LA(l,f,c)),y=-1)}return{x:u,y:d,placement:f,strategy:a,middlewareData:p}};async function Nu(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=po(t,e),m=DA(p),y=s[f?d==="floating"?"reference":"floating":d],v=rh(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(y)))==null||n?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),j=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=rh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+m.top)/j.y,bottom:(x.bottom-v.bottom+m.bottom)/j.y,left:(v.left-x.left+m.left)/j.x,right:(x.right-v.right+m.right)/j.x}}const jQ=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=po(e,t)||{};if(l==null)return{};const d=DA(u),f={x:n,y:r},p=bb(a),m=vb(p),y=await i.getDimensions(l),v=p==="y",b=v?"top":"left",w=v?"bottom":"right",j=v?"clientHeight":"clientWidth",x=o.reference[m]+o.reference[p]-f[p]-o.floating[m],_=f[p]-o.reference[p],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=S?S[j]:0;(!E||!await(i.isElement==null?void 0:i.isElement(S)))&&(E=s.floating[j]||o.floating[m]);const O=x/2-_/2,M=E/2-y[m]/2-1,C=Ia(d[b],M),k=Ia(d[w],M),T=C,P=E-y[m]-k,N=E/2-y[m]/2+O,I=yb(T,N,P),A=!c.arrow&&rc(a)!=null&&N!==I&&o.reference[m]/2-(N<T?C:k)-y[m]/2<0,R=A?N<T?N-T:N-P:0;return{[p]:f[p]+R,data:{[p]:I,centerOffset:N-I-R,...A&&{alignmentOffset:R}},reset:A}}}),SQ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...v}=po(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=ho(a),w=ui(s),j=ho(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),_=f||(j||!y?[nh(s)]:vQ(s)),S=m!=="none";!f&&S&&_.push(...wQ(s,y,m,x));const E=[s,..._],O=await Nu(t,v),M=[];let C=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&M.push(O[b]),d){const N=gQ(a,i,x);M.push(O[N[0]],O[N[1]])}if(C=[...C,{placement:a,overflows:M}],!M.every(N=>N<=0)){var k,T;const N=(((k=o.flip)==null?void 0:k.index)||0)+1,I=E[N];if(I)return{data:{index:N,overflows:C},reset:{placement:I}};let A=(T=C.filter(R=>R.overflows[0]<=0).sort((R,L)=>R.overflows[1]-L.overflows[1])[0])==null?void 0:T.placement;if(!A)switch(p){case"bestFit":{var P;const R=(P=C.filter(L=>{if(S){const D=ui(L.placement);return D===w||D==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(D=>D>0).reduce((D,B)=>D+B,0)]).sort((L,D)=>L[1]-D[1])[0])==null?void 0:P[0];R&&(A=R);break}case"initialPlacement":A=s;break}if(a!==A)return{reset:{placement:A}}}return{}}}};function $A(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function FA(e){return hQ.some(t=>e[t]>=0)}const EQ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=po(e,t);switch(r){case"referenceHidden":{const o=await Nu(t,{...a,elementContext:"reference"}),i=$A(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:FA(i)}}}case"escaped":{const o=await Nu(t,{...a,altBoundary:!0}),i=$A(o,n.floating);return{data:{escapedOffsets:i,escaped:FA(i)}}}default:return{}}}}};async function OQ(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=ho(n),s=rc(n),c=ui(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=po(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof m=="number"&&(p=s==="end"?m*-1:m),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}const CQ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await OQ(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},NQ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=po(e,t),l={x:n,y:r},u=await Nu(t,c),d=ui(ho(a)),f=gb(d);let p=l[f],m=l[d];if(o){const v=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=p+u[v],j=p-u[b];p=yb(w,p,j)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=m+u[v],j=m-u[b];m=yb(w,m,j)}const y=s.fn({...t,[f]:p,[d]:m});return{...y,data:{x:y.x-n,y:y.y-r}}}}},MQ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=po(e,t),u={x:n,y:r},d=ui(a),f=gb(d);let p=u[f],m=u[d];const y=po(s,t),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(c){const j=f==="y"?"height":"width",x=o.reference[f]-o.floating[j]+v.mainAxis,_=o.reference[f]+o.reference[j]-v.mainAxis;p<x?p=x:p>_&&(p=_)}if(l){var b,w;const j=f==="y"?"width":"height",x=["top","left"].includes(ho(a)),_=o.reference[d]-o.floating[j]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),S=o.reference[d]+o.reference[j]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);m<_?m=_:m>S&&(m=S)}return{[f]:p,[d]:m}}}},kQ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=po(e,t),c=await Nu(t,s),l=ho(n),u=rc(n),d=ui(n)==="y",{width:f,height:p}=r.floating;let m,y;l==="top"||l==="bottom"?(m=l,y=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(y=l,m=u==="end"?"top":"bottom");const v=p-c.top-c.bottom,b=f-c.left-c.right,w=Ia(p-c[m],v),j=Ia(f-c[y],b),x=!t.middlewareData.shift;let _=w,S=j;if(d?S=u||x?Ia(j,b):b:_=u||x?Ia(w,v):v,x&&!u){const O=mr(c.left,0),M=mr(c.right,0),C=mr(c.top,0),k=mr(c.bottom,0);d?S=f-2*(O!==0||M!==0?O+M:mr(c.left,c.right)):_=p-2*(C!==0||k!==0?C+k:mr(c.top,c.bottom))}await i({...t,availableWidth:S,availableHeight:_});const E=await a.getDimensions(o.floating);return f!==E.width||p!==E.height?{reset:{rects:!0}}:{}}}};function ac(e){return BA(e)?(e.nodeName||"").toLowerCase():"#document"}function yr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function mo(e){var t;return(t=(BA(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function BA(e){return e instanceof Node||e instanceof yr(e).Node}function Gr(e){return e instanceof Element||e instanceof yr(e).Element}function Ra(e){return e instanceof HTMLElement||e instanceof yr(e).HTMLElement}function zA(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof yr(e).ShadowRoot}function Mu(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Xr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function PQ(e){return["table","td","th"].includes(ac(e))}function ah(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function xb(e){const t=_b(),n=Gr(e)?Xr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function AQ(e){let t=di(e);for(;Ra(t)&&!oc(t);){if(xb(t))return t;if(ah(t))return null;t=di(t)}return null}function _b(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function oc(e){return["html","body","#document"].includes(ac(e))}function Xr(e){return yr(e).getComputedStyle(e)}function oh(e){return Gr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function di(e){if(ac(e)==="html")return e;const t=e.assignedSlot||e.parentNode||zA(e)&&e.host||mo(e);return zA(t)?t.host:t}function UA(e){const t=di(e);return oc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ra(t)&&Mu(t)?t:UA(t)}function ku(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=UA(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=yr(a);if(o){const s=jb(i);return t.concat(i,i.visualViewport||[],Mu(a)?a:[],s&&n?ku(s):[])}return t.concat(a,ku(a,[],n))}function jb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function VA(e){const t=Xr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Ra(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=eh(n)!==o||eh(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function Sb(e){return Gr(e)?e:e.contextElement}function ic(e){const t=Sb(e);if(!Ra(t))return li(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=VA(t);let i=(o?eh(n.width):n.width)/r,s=(o?eh(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const TQ=li(0);function qA(e){const t=yr(e);return!_b()||!t.visualViewport?TQ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function IQ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==yr(e)?!1:t}function ts(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Sb(e);let i=li(1);t&&(r?Gr(r)&&(i=ic(r)):i=ic(e));const s=IQ(o,n,r)?qA(o):li(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const f=yr(o),p=r&&Gr(r)?yr(r):r;let m=f,y=jb(m);for(;y&&r&&p!==m;){const v=ic(y),b=y.getBoundingClientRect(),w=Xr(y),j=b.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=j,l+=x,m=yr(y),y=jb(m)}}return rh({width:u,height:d,x:c,y:l})}function RQ(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=mo(r),s=t?ah(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=li(1);const u=li(0),d=Ra(r);if((d||!d&&!o)&&((ac(r)!=="body"||Mu(i))&&(c=oh(r)),Ra(r))){const f=ts(r);l=ic(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function DQ(e){return Array.from(e.getClientRects())}function WA(e){return ts(mo(e)).left+oh(e).scrollLeft}function LQ(e){const t=mo(e),n=oh(e),r=e.ownerDocument.body,a=mr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=mr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+WA(e);const s=-n.scrollTop;return Xr(r).direction==="rtl"&&(i+=mr(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function $Q(e,t){const n=yr(e),r=mo(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=_b();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function FQ(e,t){const n=ts(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=Ra(e)?ic(e):li(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function HA(e,t,n){let r;if(t==="viewport")r=$Q(e,n);else if(t==="document")r=LQ(mo(e));else if(Gr(t))r=FQ(t,n);else{const a=qA(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return rh(r)}function KA(e,t){const n=di(e);return n===t||!Gr(n)||oc(n)?!1:Xr(n).position==="fixed"||KA(n,t)}function BQ(e,t){const n=t.get(e);if(n)return n;let r=ku(e,[],!1).filter(s=>Gr(s)&&ac(s)!=="body"),a=null;const o=Xr(e).position==="fixed";let i=o?di(e):e;for(;Gr(i)&&!oc(i);){const s=Xr(i),c=xb(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||Mu(i)&&!c&&KA(e,i))?r=r.filter(l=>l!==i):a=s,i=di(i)}return t.set(e,r),r}function zQ(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?ah(t)?[]:BQ(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=HA(t,l,a);return c.top=mr(u.top,c.top),c.right=Ia(u.right,c.right),c.bottom=Ia(u.bottom,c.bottom),c.left=mr(u.left,c.left),c},HA(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function UQ(e){const{width:t,height:n}=VA(e);return{width:t,height:n}}function VQ(e,t,n){const r=Ra(t),a=mo(t),o=n==="fixed",i=ts(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=li(0);if(r||!r&&!o)if((ac(t)!=="body"||Mu(a))&&(s=oh(t)),r){const d=ts(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=WA(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function Eb(e){return Xr(e).position==="static"}function ZA(e,t){return!Ra(e)||Xr(e).position==="fixed"?null:t?t(e):e.offsetParent}function GA(e,t){const n=yr(e);if(ah(e))return n;if(!Ra(e)){let a=di(e);for(;a&&!oc(a);){if(Gr(a)&&!Eb(a))return a;a=di(a)}return n}let r=ZA(e,t);for(;r&&PQ(r)&&Eb(r);)r=ZA(r,t);return r&&oc(r)&&Eb(r)&&!xb(r)?n:r||AQ(e)||n}const qQ=async function(e){const t=this.getOffsetParent||GA,n=this.getDimensions,r=await n(e.floating);return{reference:VQ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function WQ(e){return Xr(e).direction==="rtl"}const HQ={convertOffsetParentRelativeRectToViewportRelativeRect:RQ,getDocumentElement:mo,getClippingRect:zQ,getOffsetParent:GA,getElementRects:qQ,getClientRects:DQ,getDimensions:UQ,getScale:ic,isElement:Gr,isRTL:WQ};function KQ(e,t){let n=null,r;const a=mo(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const p=th(u),m=th(a.clientWidth-(l+d)),y=th(a.clientHeight-(u+f)),v=th(l),b={rootMargin:-p+"px "+-m+"px "+-y+"px "+-v+"px",threshold:mr(0,Ia(1,c))||1};let w=!0;function j(x){const _=x[0].intersectionRatio;if(_!==c){if(!w)return i();_?i(!1,_):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(j,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(j,b)}n.observe(e)}return i(!0),o}Av=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=Sb(e),u=a||o?[...l?ku(l):[],...ku(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?KQ(l,n):null;let f=-1,p=null;i&&(p=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var j;(j=p)==null||j.observe(t)})),n()}),l&&!c&&p.observe(l),p.observe(t));let m,y=c?ts(e):null;c&&v();function v(){const b=ts(e);y&&(b.x!==y.x||b.y!==y.y||b.width!==y.width||b.height!==y.height)&&n(),y=b,m=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=p)==null||b.disconnect(),p=null,c&&cancelAnimationFrame(m)}};let XA;QM=CQ,uk=NQ,ek=SQ,fk=kQ,XA=EQ,Yv=jQ,dk=MQ,tk=(e,t,n)=>{const r=new Map,a={platform:HQ,...n},o={...a.platform,_c:r};return _Q(e,t,{...a,platform:o})};var ih=typeof document<"u"?g.useLayoutEffect:g.useEffect;function sh(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!sh(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!sh(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function JA(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function YA(e,t){const n=JA(e);return Math.round(t*n)/n}function QA(e){const t=g.useRef(e);return ih(()=>{t.current=e}),t}Hv=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=g.useState(r);sh(f,r)||p(r);const[m,y]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(R=>{R!==S.current&&(S.current=R,y(R))},[]),j=g.useCallback(R=>{R!==E.current&&(E.current=R,b(R))},[]),x=o||m,_=i||v,S=g.useRef(null),E=g.useRef(null),O=g.useRef(u),M=c!=null,C=QA(c),k=QA(a),T=g.useCallback(()=>{if(!S.current||!E.current)return;const R={placement:t,strategy:n,middleware:f};k.current&&(R.platform=k.current),tk(S.current,E.current,R).then(L=>{const D={...L,isPositioned:!0};P.current&&!sh(O.current,D)&&(O.current=D,Ql.flushSync(()=>{d(D)}))})},[f,t,n,k]);ih(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(R=>({...R,isPositioned:!1})))},[l]);const P=g.useRef(!1);ih(()=>(P.current=!0,()=>{P.current=!1}),[]),ih(()=>{if(x&&(S.current=x),_&&(E.current=_),x&&_){if(C.current)return C.current(x,_,T);T()}},[x,_,T,C,M]);const N=g.useMemo(()=>({reference:S,floating:E,setReference:w,setFloating:j}),[w,j]),I=g.useMemo(()=>({reference:x,floating:_}),[x,_]),A=g.useMemo(()=>{const R={position:n,left:0,top:0};if(!I.floating)return R;const L=YA(I.floating,u.x),D=YA(I.floating,u.y);return s?{...R,transform:"translate("+L+"px, "+D+"px)",...JA(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:D}},[n,s,I.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:T,refs:N,elements:I,floatingStyles:A}),[u,T,N,I,A])};let e2;e2=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Yv({element:r.current,padding:a}).fn(n):{}:r?Yv({element:r,padding:a}).fn(n):{}}}},Kv=(e,t)=>({...QM(e),options:[e,t]}),Zv=(e,t)=>({...uk(e),options:[e,t]}),Gv=(e,t)=>({...dk(e),options:[e,t]}),Xv=(e,t)=>({...ek(e),options:[e,t]}),Iv=(e,t)=>({...fk(e),options:[e,t]}),u0=(e,t)=>({...XA(e),options:[e,t]}),l0=(e,t)=>({...e2(e),options:[e,t]});var ZQ="Arrow",t2=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Ae.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});t2.displayName=ZQ;var GQ=t2;function XQ(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,JQ(a,...t)]}function JQ(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}_p=function(e){const[t,n]=g.useState(void 0);return ln(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var Ob="Popper",[n2,sc]=XQ(Ob),[YQ,r2]=n2(Ob),a2=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(YQ,{scope:t,anchor:r,onAnchorChange:a,children:n})};a2.displayName=Ob;var o2="PopperAnchor",i2=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=r2(o2,n),i=g.useRef(null),s=jt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Ae.div,{...a,ref:s})});i2.displayName=o2;var Cb="PopperContent",[QQ,eee]=n2(Cb),s2=g.forwardRef((e,t)=>{var J,K,W,Y,re,U;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=e,v=r2(Cb,n),[b,w]=g.useState(null),j=jt(t,ce=>w(ce)),[x,_]=g.useState(null),S=_p(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),C=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},k=Array.isArray(l)?l:[l],T=k.length>0,P={padding:C,boundary:k.filter(nee),altBoundary:T},{refs:N,floatingStyles:I,placement:A,isPositioned:R,middlewareData:L}=Hv({strategy:"fixed",placement:M,whileElementsMounted:(...ce)=>Av(...ce,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Kv({mainAxis:a+O,alignmentAxis:i}),c&&Zv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Gv():void 0,...P}),c&&Xv({...P}),Iv({...P,apply:({elements:ce,rects:ae,availableWidth:ue,availableHeight:je})=>{const{width:Le,height:$e}=ae.reference,Se=ce.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&l0({element:x,padding:s}),ree({arrowWidth:E,arrowHeight:O}),f&&u0({strategy:"referenceHidden",...P})]}),[D,B]=u2(A),F=dr(m);ln(()=>{R&&(F==null||F())},[R,F]);const $=(J=L.arrow)==null?void 0:J.x,z=(K=L.arrow)==null?void 0:K.y,X=((W=L.arrow)==null?void 0:W.centerOffset)!==0,[G,q]=g.useState();return ln(()=>{b&&q(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:R?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:G,"--radix-popper-transform-origin":[(Y=L.transformOrigin)==null?void 0:Y.x,(re=L.transformOrigin)==null?void 0:re.y].join(" "),...((U=L.hide)==null?void 0:U.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(QQ,{scope:n,placedSide:D,onArrowChange:_,arrowX:$,arrowY:z,shouldHideArrow:X,children:h.jsx(Ae.div,{"data-side":D,"data-align":B,...y,ref:j,style:{...y.style,animation:R?void 0:"none"}})})})});s2.displayName=Cb;var c2="PopperArrow",tee={top:"bottom",right:"left",bottom:"top",left:"right"},l2=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=eee(c2,n),o=tee[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(GQ,{...r,ref:t,style:{...r.style,display:"block"}})})});l2.displayName=c2;function nee(e){return e!==null}var ree=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=u2(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",m="";return c==="bottom"?(p=o?u:`${d}px`,m=`${-s}px`):c==="top"?(p=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,m=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,m=o?u:`${f}px`),{data:{x:p,y:m}}}});function u2(e){const[t,n="center"]=e.split("-");return[t,n]}var ch=a2,Nb=i2,Mb=s2,kb=l2,[lh,u3e]=ur("Tooltip",[sc]),uh=sc(),d2="TooltipProvider",aee=700,Pb="tooltip.open",[oee,Ab]=lh(d2),f2=e=>{const{__scopeTooltip:t,delayDuration:n=aee,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(oee,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};f2.displayName=d2;var dh="Tooltip",[iee,Pu]=lh(dh),p2=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=Ab(dh,e.__scopeTooltip),l=uh(t),[u,d]=g.useState(null),f=Rt(),p=g.useRef(0),m=i??c.disableHoverableContent,y=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Pn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(Pb))):c.onClose(),o==null||o(E)}}),j=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),_=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),S=g.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},y)},[y,w]);return g.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),h.jsx(ch,{...l,children:h.jsx(iee,{scope:t,contentId:f,open:b,stateAttribute:j,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?S():x()},[c.isOpenDelayed,S,x]),onTriggerLeave:g.useCallback(()=>{m?_():(window.clearTimeout(p.current),p.current=0)},[_,m]),onOpen:x,onClose:_,disableHoverableContent:m,children:n})})};p2.displayName=dh;var Tb="TooltipTrigger",h2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Pu(Tb,n),o=Ab(Tb,n),i=uh(n),s=g.useRef(null),c=jt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(Nb,{asChild:!0,...i,children:h.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});h2.displayName=Tb;var Ib="TooltipPortal",[see,cee]=lh(Ib,{forceMount:void 0}),m2=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=Pu(Ib,t);return h.jsx(see,{scope:t,forceMount:n,children:h.jsx(Br,{present:n||o.open,children:h.jsx(_v,{asChild:!0,container:a,children:r})})})};m2.displayName=Ib;var cc="TooltipContent",y2=g.forwardRef((e,t)=>{const n=cee(cc,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=Pu(cc,e.__scopeTooltip);return h.jsx(Br,{present:r||i.open,children:i.disableHoverableContent?h.jsx(g2,{side:a,...o,ref:t}):h.jsx(lee,{side:a,...o,ref:t})})}),lee=g.forwardRef((e,t)=>{const n=Pu(cc,e.__scopeTooltip),r=Ab(cc,e.__scopeTooltip),a=g.useRef(null),o=jt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,f=g.useCallback(()=>{s(null),d(!1)},[d]),p=g.useCallback((m,y)=>{const v=m.currentTarget,b={x:m.clientX,y:m.clientY},w=pee(b,v.getBoundingClientRect()),j=hee(b,w),x=mee(y.getBoundingClientRect()),_=gee([...j,...x]);s(_),d(!0)},[d]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const m=v=>p(v,u),y=v=>p(v,c);return c.addEventListener("pointerleave",m),u.addEventListener("pointerleave",y),()=>{c.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",y)}}},[c,u,p,f]),g.useEffect(()=>{if(i){const m=y=>{const v=y.target,b={x:y.clientX,y:y.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),j=!yee(b,i);w?f():j&&(f(),l())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[c,u,i,l,f]),h.jsx(g2,{...e,ref:o})}),[uee,dee]=lh(dh,{isInside:!1}),g2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=Pu(cc,n),l=uh(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(Pb,u),()=>document.removeEventListener(Pb,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=f=>{var p;(p=f.target)!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(xv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(Mb,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(TG,{children:r}),h.jsx(uee,{scope:n,isInside:!0,children:h.jsx(jDe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});y2.displayName=cc;var v2="TooltipArrow",fee=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=uh(n);return dee(v2,n).isInside?null:h.jsx(kb,{...a,...r,ref:t})});fee.displayName=v2;function pee(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function hee(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function mee(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function yee(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function gee(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),vee(t)}function vee(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}gk=f2,vk=p2,ak=h2,ZG=m2,Dv=y2;const Au=gk,Da=vk,La=ak,Jr=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Dv,{ref:r,sideOffset:t,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Jr.displayName=Dv.displayName;const bee="sidebar:state",wee=60*60*24*7,xee="16rem",_ee="18rem",jee="3rem",See="b",b2=g.createContext(null);function Tu(){const e=g.useContext(b2);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Rb=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=EY(),[l,u]=g.useState(!1),[d,f]=g.useState(e),p=t??d,m=g.useCallback(w=>{const j=typeof w=="function"?w(p):w;n?n(j):f(j),document.cookie=`${bee}=${j}; path=/; max-age=${wee}`},[n,p]),y=g.useCallback(()=>c?u(w=>!w):m(w=>!w),[c,m,u]);g.useEffect(()=>{const w=j=>{j.key===See&&(j.metaKey||j.ctrlKey)&&(j.preventDefault(),y())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[y]);const v=p?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:p,setOpen:m,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:y}),[v,p,m,c,l,u,y]);return h.jsx(b2.Provider,{value:b,children:h.jsx(Au,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":xee,"--sidebar-width-icon":jee,...a},className:Z("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});Rb.displayName="SidebarProvider";const Db=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=Tu();return n==="none"?h.jsx("div",{className:Z("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(lQ,{open:l,onOpenChange:u,...o,children:h.jsx(IA,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":_ee},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:Z("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:Z("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});Db.displayName="Sidebar";const w2=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=Tu();return h.jsx(tt,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Z("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(fe,{size:32,name:"panel-left"})})});w2.displayName="SidebarTrigger";const x2=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=Tu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Z("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});x2.displayName="SidebarRail";const Lb=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:Z("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Lb.displayName="SidebarInset";const Eee=g.forwardRef(({className:e,...t},n)=>h.jsx(Gt,{ref:n,"data-sidebar":"input",className:Z("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));Eee.displayName="SidebarInput";const Oee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:Z("flex flex-col gap-2 p-2",e),...t}));Oee.displayName="SidebarHeader";const _2=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:Z("flex flex-col gap-2 p-2",e),...t}));_2.displayName="SidebarFooter";const Cee=g.forwardRef(({className:e,...t},n)=>h.jsx(Ks,{ref:n,"data-sidebar":"separator",className:Z("mx-2 w-auto bg-sidebar-border",e),...t}));Cee.displayName="SidebarSeparator";const $b=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:Z("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));$b.displayName="SidebarContent";const Iu=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:Z("relative flex w-full min-w-0 flex-col p-2",e),...t}));Iu.displayName="SidebarGroup";const Ru=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ni:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:Z("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});Ru.displayName="SidebarGroupLabel";const Nee=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ni:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:Z("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});Nee.displayName="SidebarGroupAction";const Mee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:Z("w-full text-sm",e),...t}));Mee.displayName="SidebarGroupContent";const lc=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:Z("flex w-full min-w-0 flex-col gap-1",e),...t}));lc.displayName="SidebarMenu";const yo=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:Z("group/menu-item relative",e),...t}));yo.displayName="SidebarMenuItem";const kee=io("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),go=g.forwardRef(({onClick:e,asChild:t=!1,isActive:n=!1,variant:r="default",size:a="default",tooltip:o,className:i,...s},c)=>{const l=t?ni:"button",{isMobile:u,state:d,toggleSidebar:f}=Tu(),p=h.jsx(l,{ref:c,"data-sidebar":"menu-button","data-size":a,"data-active":n,className:Z(kee({variant:r,size:a}),i),onClick:s!=null&&s.autoHide?m=>{e==null||e(m),f()}:e,...s});return o?(typeof o=="string"&&(o={children:o}),h.jsxs(Da,{children:[h.jsx(La,{asChild:!0,children:p}),h.jsx(Jr,{side:"right",align:"center",hidden:d!=="collapsed"||u,...o})]})):p});go.displayName="SidebarMenuButton";const Pee=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?ni:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:Z("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});Pee.displayName="SidebarMenuAction";const Aee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:Z("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));Aee.displayName="SidebarMenuBadge";const Tee=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Z("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(RA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(RA,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});Tee.displayName="SidebarMenuSkeleton";const j2=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:Z("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));j2.displayName="SidebarMenuSub";const S2=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));S2.displayName="SidebarMenuSubItem";const E2=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?ni:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:Z("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});E2.displayName="SidebarMenuSubButton";const Iee="hash",fh={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},dn=(e,t)=>{let n=fh[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},Ree=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function Dee({items:e}){const{t}=ke("documents");return h.jsxs(Iu,{children:[h.jsx(Ru,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(lc,{children:e.map(n=>{var r;return h.jsx(_Y,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(yo,{children:[h.jsx(jY,{asChild:!0,children:h.jsxs(go,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(fe,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(SY,{children:h.jsx(j2,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(S2,{className:"cursor-pointer",children:h.jsx(E2,{asChild:!0,children:h.jsx(K0,{to:dn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const Lee=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,f=`${Math.random()*100}%`,p=Math.random()>.5?t.first:t.second,m=Math.random()*2,y=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${f}-${Date.now()}`,x:d,y:f,color:p,delay:m,scale:y,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(f=>f.lifespan<=0?s():{...f,lifespan:f.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:Z("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx($ee,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),$ee=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(pp.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function Fee({className:e,onClick:t}){const{t:n}=ke("sidebar");return h.jsxs(go,{className:Z(e,"tw-w-full"),onClick:t,children:[h.jsx(fe,{name:"frame"}),h.jsx(Lee,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const Bee=()=>{const[e,t]=g.useState(!1),n=et(a=>a.createSession),r=g.useCallback(async a=>{try{return t(!0),await n(a)}finally{t(!1)}},[n]);return{loading:e,createSession:r}},fi=ou,zee=cu,O2=g.forwardRef(({className:e,...t},n)=>h.jsx(Hi,{ref:n,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));O2.displayName=Hi.displayName;const vo=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(zee,{children:[h.jsx(O2,{}),h.jsxs(Ki,{ref:r,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs(lu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(fe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));vo.displayName=Ki.displayName;const bo=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});bo.displayName="DialogHeader";const Du=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Du.displayName="DialogFooter";const wo=g.forwardRef(({className:e,...t},n)=>h.jsx(Ws,{ref:n,className:Z("text-lg font-semibold leading-none tracking-tight",e),...t}));wo.displayName=Ws.displayName;const Lu=g.forwardRef(({className:e,...t},n)=>h.jsx(Hs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));Lu.displayName=Hs.displayName;var Uee="Label",C2=g.forwardRef((e,t)=>h.jsx(Ae.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));C2.displayName=Uee;var N2=C2;let M2;M2=io("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qe=g.forwardRef(({className:e,...t},n)=>h.jsx(N2,{ref:n,className:Z(M2(),e),...t})),qe.displayName=N2.displayName;const Vee=so(()=>{const e=tn(),{t}=ke("dialogs"),[n,r]=g.useState(""),{toast:a}=nn(),{loading:o,createSession:i}=Bee(),s=u=>{r(u.target.value)},c=async()=>{try{const u=await i({name:n});r(""),e.resolve(u.id),e.hide()}catch(u){a({variant:"destructive",description:t("create_session.errors.create_failed")}),e.reject(u)}},l=()=>{r(""),e.resolve(void 0),e.hide()};return h.jsx(fi,{open:e.visible,onOpenChange:l,children:h.jsxs(vo,{className:"sm:max-w-[425px]",children:[h.jsxs(bo,{children:[h.jsx(wo,{children:t("create_session.title")}),h.jsx(Lu,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(qe,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(Gt,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(Du,{children:h.jsx(tt,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),qee=()=>{const[e,t]=g.useState(!1),n=et(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([de("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>de("FlowEdge").delete(i.id)))),de("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>de("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var k2="AlertDialog",[Wee,d3e]=ur(k2,[lb]),xo=lb(),P2=e=>{const{__scopeAlertDialog:t,...n}=e,r=xo(t);return h.jsx(ou,{...r,...n,modal:!0})};P2.displayName=k2;var Hee="AlertDialogTrigger",Kee=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xo(n);return h.jsx(AA,{...a,...r,ref:t})});Kee.displayName=Hee;var Zee="AlertDialogPortal",A2=e=>{const{__scopeAlertDialog:t,...n}=e,r=xo(t);return h.jsx(cu,{...r,...n})};A2.displayName=Zee;var Gee="AlertDialogOverlay",T2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xo(n);return h.jsx(Hi,{...a,...r,ref:t})});T2.displayName=Gee;var uc="AlertDialogContent",[Xee,Jee]=Wee(uc),I2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=xo(n),i=g.useRef(null),s=jt(t,i),c=g.useRef(null);return h.jsx(NA,{contentName:uc,titleName:R2,docsSlug:"alert-dialog",children:h.jsx(Xee,{scope:n,cancelRef:c,children:h.jsxs(Ki,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(TG,{children:r}),h.jsx(U2,{contentRef:i})]})})})});I2.displayName=uc;var R2="AlertDialogTitle",D2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xo(n);return h.jsx(Ws,{...a,...r,ref:t})});D2.displayName=R2;var L2="AlertDialogDescription",$2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xo(n);return h.jsx(Hs,{...a,...r,ref:t})});$2.displayName=L2;var Yee="AlertDialogAction",F2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xo(n);return h.jsx(lu,{...a,...r,ref:t})});F2.displayName=Yee;var B2="AlertDialogCancel",z2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=Jee(B2,n),o=xo(n),i=jt(t,a);return h.jsx(lu,{...o,...r,ref:i})});z2.displayName=B2;let U2;U2=({contentRef:e})=>{const t=`\`${uc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${uc}\` by passing a \`${L2}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${uc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},ck=P2,sk=A2,Bv=T2,zv=I2,qv=F2,Wv=z2,Uv=D2,Vv=$2;const V2=ck,Qee=sk,q2=g.forwardRef(({className:e,...t},n)=>h.jsx(Bv,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));q2.displayName=Bv.displayName;const Fb=g.forwardRef(({className:e,...t},n)=>h.jsxs(Qee,{children:[h.jsx(q2,{}),h.jsx(zv,{ref:n,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Fb.displayName=zv.displayName;const Bb=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",e),...t});Bb.displayName="AlertDialogHeader";const zb=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});zb.displayName="AlertDialogFooter";const Ub=g.forwardRef(({className:e,...t},n)=>h.jsx(Uv,{ref:n,className:Z("text-lg font-semibold",e),...t}));Ub.displayName=Uv.displayName;const Vb=g.forwardRef(({className:e,...t},n)=>h.jsx(Vv,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));Vb.displayName=Vv.displayName;const qb=g.forwardRef(({className:e,...t},n)=>h.jsx(qv,{ref:n,className:Z(Eu(),e),...t}));qb.displayName=qv.displayName;const Wb=g.forwardRef(({className:e,...t},n)=>h.jsx(Wv,{ref:n,className:Z(Eu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Wb.displayName=Wv.displayName;const W2=so(({id:e})=>{const{t}=ke("dialogs"),n=tn(),{toast:r}=nn(),{deleteSession:a,loading:o}=qee(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(V2,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(Fb,{children:[h.jsxs(Bb,{children:[h.jsx(Ub,{children:t("delete_session.title")}),h.jsx(Vb,{children:t("delete_session.description")})]}),h.jsxs(zb,{children:[h.jsx(Wb,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(qb,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function ete({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=ke("sidebar"),a=Ji(),{sessionId:o}=Lp(),[i,s]=g.useState(),c=tn(Vee),l=tn(W2),u=g.useCallback(async()=>{try{const p=await c.show({});p&&typeof p=="string"&&a(dn("whiteboard",{sessionId:p}))}catch{}},[c,a]),d=g.useCallback((p,m)=>{p.preventDefault(),p.stopPropagation(),l.show({id:m})},[l]),f=async p=>{try{s(p.id),await n(p),a(dn("whiteboard",{sessionId:p.id}))}catch(m){Us(m),s(void 0)}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Iu,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(Ru,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(lc,{children:[h.jsx(yo,{children:h.jsx(Fee,{onClick:u,className:"w-full"})}),e.map(p=>h.jsx(yo,{className:"cursor-pointer",children:h.jsx(go,{autoHide:!0,disabled:!!i,asChild:!0,onClick:()=>f(p),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[p.id===i?h.jsx(fe,{size:16,name:"loader",className:"animate-spin"}):o===p.id?h.jsx(fe,{size:16,color:"green",name:"check"}):h.jsx(fe,{size:16,name:"chevron-right"}),h.jsx("span",{children:p.name})]}),h.jsx(fe,{onClick:m=>d(m,p.id),size:16,name:"trash-2",className:"!z-50"})]})})},p.id)),e!=null&&e.length?h.jsx(yo,{children:h.jsxs(go,{className:"text-sidebar-foreground/70",children:[h.jsx(fe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var tte=g.createContext(void 0);ri=function(e){const t=g.useContext(tte);return e||t||"ltr"};function nte(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,rte(a,...t)]}function rte(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let ph,H2,$u,hh,Hb,K2,Z2,G2,X2,Kb;ph="rovingFocusGroup.onEntryFocus",H2={bubbles:!1,cancelable:!0},$u="RovingFocusGroup",[hh,Hb,K2]=hp($u),[Z2,lo]=nte($u,[K2]),[G2,X2]=Z2($u),Kb=g.forwardRef((e,t)=>h.jsx(hh.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(hh.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(ate,{...e,ref:t})})})),Kb.displayName=$u;var ate=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,f=g.useRef(null),p=jt(t,f),m=ri(o),[y=null,v]=Pn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),j=dr(l),x=Hb(n),_=g.useRef(!1),[S,E]=g.useState(0);return g.useEffect(()=>{const O=f.current;if(O)return O.addEventListener(ph,j),()=>O.removeEventListener(ph,j)},[j]),h.jsx(G2,{scope:n,orientation:r,dir:m,loop:a,currentTabStopId:y,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx(Ae.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{_.current=!0}),onFocus:ge(e.onFocus,O=>{const M=!_.current;if(O.target===O.currentTarget&&M&&!b){const C=new CustomEvent(ph,H2);if(O.currentTarget.dispatchEvent(C),!C.defaultPrevented){const k=x().filter(I=>I.focusable),T=k.find(I=>I.active),P=k.find(I=>I.id===y),N=[T,P,...k].filter(Boolean).map(I=>I.ref.current);Q2(N,u)}}_.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),J2="RovingFocusGroupItem",Y2=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Rt(),c=o||s,l=X2(J2,n),u=l.currentTabStopId===c,d=Hb(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=l;return g.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),h.jsx(hh.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Ae.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,m=>{r?l.onItemFocus(c):m.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){l.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=ste(m,l.orientation,l.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const b=v.indexOf(m.currentTarget);v=l.loop?cte(v,b+1):v.slice(b+1)}setTimeout(()=>Q2(v))}})})})});Y2.displayName=J2;var ote={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ite(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ste(e,t,n){const r=ite(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return ote[r]}function Q2(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function cte(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let mh,eT,Zb,tT,nT,rT,dc,fc,aT,oT,pi,yh,pc,Gb,Xb,_o,iT,hc,Jb;uu=Kb,du=Y2,mh=["Enter"," "],eT=["ArrowDown","PageUp","Home"],Zb=["ArrowUp","PageDown","End"],tT=[...eT,...Zb],nT={ltr:[...mh,"ArrowRight"],rtl:[...mh,"ArrowLeft"]},rT={ltr:["ArrowLeft"],rtl:["ArrowRight"]},dc="Menu",[fc,aT,oT]=hp(dc),[pi,yh]=ur(dc,[oT,sc,lo]),pc=sc(),Gb=lo(),[Xb,_o]=pi(dc),[iT,hc]=pi(dc),Jb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=pc(t),[c,l]=g.useState(null),u=g.useRef(!1),d=dr(o),f=ri(a);return g.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),h.jsx(ch,{...s,children:h.jsx(Xb,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(iT,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:i,children:r})})})},Jb.displayName=dc;var lte="MenuAnchor",Yb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=pc(n);return h.jsx(Nb,{...a,...r,ref:t})});Yb.displayName=lte;var Qb="MenuPortal",[ute,sT]=pi(Qb,{forceMount:void 0}),cT=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=_o(Qb,t);return h.jsx(ute,{scope:t,forceMount:n,children:h.jsx(Br,{present:n||o.open,children:h.jsx(_v,{asChild:!0,container:a,children:r})})})};cT.displayName=Qb;var Mr="MenuContent",[dte,ew]=pi(Mr),lT=g.forwardRef((e,t)=>{const n=sT(Mr,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=_o(Mr,e.__scopeMenu),i=hc(Mr,e.__scopeMenu);return h.jsx(fc.Provider,{scope:e.__scopeMenu,children:h.jsx(Br,{present:r||o.open,children:h.jsx(fc.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(fte,{...a,ref:t}):h.jsx(pte,{...a,ref:t})})})})}),fte=g.forwardRef((e,t)=>{const n=_o(Mr,e.__scopeMenu),r=g.useRef(null),a=jt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return pu(o)},[]),h.jsx(tw,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),pte=g.forwardRef((e,t)=>{const n=_o(Mr,e.__scopeMenu);return h.jsx(tw,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),tw=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...y}=e,v=_o(Mr,n),b=hc(Mr,n),w=pc(n),j=Gb(n),x=aT(n),[_,S]=g.useState(null),E=g.useRef(null),O=jt(t,E,v.onContentChange),M=g.useRef(0),C=g.useRef(""),k=g.useRef(0),T=g.useRef(null),P=g.useRef("right"),N=g.useRef(0),I=m?Xp:g.Fragment,A=m?{as:ni,allowPinchZoom:!0}:void 0,R=D=>{var J,K;const B=C.current+D,F=x().filter(W=>!W.disabled),$=document.activeElement,z=(J=F.find(W=>W.ref.current===$))==null?void 0:J.textValue,X=F.map(W=>W.textValue),G=Ete(X,B,z),q=(K=F.find(W=>W.textValue===G))==null?void 0:K.ref.current;(function W(Y){C.current=Y,window.clearTimeout(M.current),Y!==""&&(M.current=window.setTimeout(()=>W(""),1e3))})(B),q&&setTimeout(()=>q.focus())};g.useEffect(()=>()=>window.clearTimeout(M.current),[]),hu();const L=g.useCallback(D=>{var B,F;return P.current===((B=T.current)==null?void 0:B.side)&&Cte(D,(F=T.current)==null?void 0:F.area)},[]);return h.jsx(dte,{scope:n,searchRef:C,onItemEnter:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),onItemLeave:g.useCallback(D=>{var B;L(D)||((B=E.current)==null||B.focus(),S(null))},[L]),onTriggerLeave:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),pointerGraceTimerRef:k,onPointerGraceIntentChange:g.useCallback(D=>{T.current=D},[]),children:h.jsx(I,{...A,children:h.jsx(Up,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,D=>{var B;D.preventDefault(),(B=E.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(xv,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(uu,{asChild:!0,...j,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:_,onCurrentTabStopIdChange:S,onEntryFocus:ge(c,D=>{b.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(Mb,{role:"menu","aria-orientation":"vertical","data-state":CT(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...y,ref:O,style:{outline:"none",...y.style},onKeyDown:ge(y.onKeyDown,D=>{const B=D.target.closest("[data-radix-menu-content]")===D.currentTarget,F=D.ctrlKey||D.altKey||D.metaKey,$=D.key.length===1;B&&(D.key==="Tab"&&D.preventDefault(),!F&&$&&R(D.key));const z=E.current;if(D.target!==z||!tT.includes(D.key))return;D.preventDefault();const X=x().filter(G=>!G.disabled).map(G=>G.ref.current);Zb.includes(D.key)&&X.reverse(),jte(X)}),onBlur:ge(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(M.current),C.current="")}),onPointerMove:ge(e.onPointerMove,Bu(D=>{const B=D.target,F=N.current!==D.clientX;if(D.currentTarget.contains(B)&&F){const $=D.clientX>N.current?"right":"left";P.current=$,N.current=D.clientX}}))})})})})})})});lT.displayName=Mr;var hte="MenuGroup",nw=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"group",...r,ref:t})});nw.displayName=hte;var mte="MenuLabel",uT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{...r,ref:t})});uT.displayName=mte;var gh="MenuItem",dT="menu.itemSelect",vh=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=hc(gh,e.__scopeMenu),s=ew(gh,e.__scopeMenu),c=jt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const f=new CustomEvent(dT,{bubbles:!0,cancelable:!0});d.addEventListener(dT,p=>r==null?void 0:r(p),{once:!0}),SDe(d,f),f.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(fT,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var f;(f=e.onPointerDown)==null||f.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var f;l.current||((f=d.currentTarget)==null||f.click())}),onKeyDown:ge(e.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||mh.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});vh.displayName=gh;var fT=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=ew(gh,n),s=Gb(n),c=g.useRef(null),l=jt(t,c),[u,d]=g.useState(!1),[f,p]=g.useState("");return g.useEffect(()=>{const m=c.current;m&&p((m.textContent??"").trim())},[o.children]),h.jsx(fc.ItemSlot,{scope:n,disabled:r,textValue:a??f,children:h.jsx(du,{asChild:!0,...s,focusable:!r,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,Bu(m=>{r?i.onItemLeave(m):(i.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,Bu(m=>i.onItemLeave(m))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),yte="MenuCheckboxItem",pT=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(vT,{scope:e.__scopeMenu,checked:n,children:h.jsx(vh,{role:"menuitemcheckbox","aria-checked":bh(n)?"mixed":n,...a,ref:t,"data-state":ow(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(bh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});pT.displayName=yte;var hT="MenuRadioGroup",[gte,vte]=pi(hT,{value:void 0,onValueChange:()=>{}}),mT=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=dr(r);return h.jsx(gte,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(nw,{...a,ref:t})})});mT.displayName=hT;var yT="MenuRadioItem",gT=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=vte(yT,e.__scopeMenu),o=n===a.value;return h.jsx(vT,{scope:e.__scopeMenu,checked:o,children:h.jsx(vh,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":ow(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});gT.displayName=yT;var rw="MenuItemIndicator",[vT,bte]=pi(rw,{checked:!1}),bT=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=bte(rw,n);return h.jsx(Br,{present:r||bh(o.checked)||o.checked===!0,children:h.jsx(Ae.span,{...a,ref:t,"data-state":ow(o.checked)})})});bT.displayName=rw;var wte="MenuSeparator",wT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});wT.displayName=wte;var xte="MenuArrow",xT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=pc(n);return h.jsx(kb,{...a,...r,ref:t})});xT.displayName=xte;var aw="MenuSub",[_te,_T]=pi(aw),jT=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=_o(aw,t),i=pc(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=dr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(ch,{...i,children:h.jsx(Xb,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(_te,{scope:t,contentId:Rt(),triggerId:Rt(),trigger:s,onTriggerChange:c,children:n})})})};jT.displayName=aw;var Fu="MenuSubTrigger",ST=g.forwardRef((e,t)=>{const n=_o(Fu,e.__scopeMenu),r=hc(Fu,e.__scopeMenu),a=_T(Fu,e.__scopeMenu),o=ew(Fu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(Yb,{asChild:!0,...l,children:h.jsx(fT,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":CT(n.open),...e,ref:IG(t,a.onTriggerChange),onClick:d=>{var f;(f=e.onClick)==null||f.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,Bu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,Bu(d=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const y=(m=n.content)==null?void 0:m.dataset.side,v=y==="right",b=v?-5:5,w=f[v?"left":"right"],j=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:f.top},{x:j,y:f.top},{x:j,y:f.bottom},{x:w,y:f.bottom}],side:y}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var p;const f=o.searchRef.current!=="";e.disabled||f&&d.key===" "||nT[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});ST.displayName=Fu;var ET="MenuSubContent",OT=g.forwardRef((e,t)=>{const n=sT(Mr,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=_o(Mr,e.__scopeMenu),i=hc(Mr,e.__scopeMenu),s=_T(ET,e.__scopeMenu),c=g.useRef(null),l=jt(t,c);return h.jsx(fc.Provider,{scope:e.__scopeMenu,children:h.jsx(Br,{present:r||o.open,children:h.jsx(fc.Slot,{scope:e.__scopeMenu,children:h.jsx(tw,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=rT[i.dir].includes(u.key);d&&f&&(o.onOpenChange(!1),(p=s.trigger)==null||p.focus(),u.preventDefault())})})})})})});OT.displayName=ET;function CT(e){return e?"open":"closed"}function bh(e){return e==="indeterminate"}function ow(e){return bh(e)?"indeterminate":e?"checked":"unchecked"}function jte(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ste(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Ete(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=Ste(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function Ote(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function Cte(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Ote(n,t)}function Bu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var NT=Jb,MT=Yb,kT=cT,PT=lT,AT=nw,TT=uT,IT=vh,RT=pT,DT=mT,LT=gT,$T=bT,FT=wT,BT=xT,Nte=jT,zT=ST,UT=OT,iw="DropdownMenu",[Mte,f3e]=ur(iw,[yh]),An=yh(),[kte,VT]=Mte(iw),qT=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=An(t),l=g.useRef(null),[u=!1,d]=Pn({prop:a,defaultProp:o,onChange:i});return h.jsx(kte,{scope:t,triggerId:Rt(),triggerRef:l,contentId:Rt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(f=>!f),[d]),modal:s,children:h.jsx(NT,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};qT.displayName=iw;var WT="DropdownMenuTrigger",HT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=VT(WT,n),i=An(n);return h.jsx(MT,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:IG(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});HT.displayName=WT;var Pte="DropdownMenuPortal",KT=e=>{const{__scopeDropdownMenu:t,...n}=e,r=An(t);return h.jsx(kT,{...r,...n})};KT.displayName=Pte;var ZT="DropdownMenuContent",GT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=VT(ZT,n),o=An(n),i=g.useRef(!1);return h.jsx(PT,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});GT.displayName=ZT;var Ate="DropdownMenuGroup",XT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(AT,{...a,...r,ref:t})});XT.displayName=Ate;var Tte="DropdownMenuLabel",JT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(TT,{...a,...r,ref:t})});JT.displayName=Tte;var Ite="DropdownMenuItem",YT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(IT,{...a,...r,ref:t})});YT.displayName=Ite;var Rte="DropdownMenuCheckboxItem",QT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(RT,{...a,...r,ref:t})});QT.displayName=Rte;var Dte="DropdownMenuRadioGroup",eI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(DT,{...a,...r,ref:t})});eI.displayName=Dte;var Lte="DropdownMenuRadioItem",tI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(LT,{...a,...r,ref:t})});tI.displayName=Lte;var $te="DropdownMenuItemIndicator",nI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx($T,{...a,...r,ref:t})});nI.displayName=$te;var Fte="DropdownMenuSeparator",rI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(FT,{...a,...r,ref:t})});rI.displayName=Fte;var Bte="DropdownMenuArrow",zte=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(BT,{...a,...r,ref:t})});zte.displayName=Bte;var Ute=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=An(t),[s=!1,c]=Pn({prop:r,defaultProp:o,onChange:a});return h.jsx(Nte,{...i,open:s,onOpenChange:c,children:n})},Vte="DropdownMenuSubTrigger",aI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(zT,{...a,...r,ref:t})});aI.displayName=Vte;var qte="DropdownMenuSubContent",oI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=An(n);return h.jsx(UT,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});oI.displayName=qte,mk=qT,yk=HT,hk=KT,Qv=GT,pk=XT,i0=JT,n0=YT,r0=QT,YG=eI,o0=tI,a0=nI,s0=rI,QG=Ute,e0=aI,t0=oI;const Wte=mk,Hte=yk,Kte=pk,Zte=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(e0,{ref:a,className:Z("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(fe,{name:"chevron-right",className:"ml-auto"})]}));Zte.displayName=e0.displayName;const Gte=g.forwardRef(({className:e,...t},n)=>h.jsx(t0,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Gte.displayName=t0.displayName;const iI=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(hk,{children:h.jsx(Qv,{ref:r,sideOffset:t,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));iI.displayName=Qv.displayName;const sI=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(n0,{ref:r,className:Z("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));sI.displayName=n0.displayName;const Xte=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(r0,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(a0,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),t]}));Xte.displayName=r0.displayName;const Jte=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(o0,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(a0,{children:h.jsx(fe,{name:"circle",className:"h-4 w-4"})})}),t]}));Jte.displayName=o0.displayName;const Yte=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(i0,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Yte.displayName=i0.displayName;const Qte=g.forwardRef(({className:e,...t},n)=>h.jsx(s0,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));Qte.displayName=s0.displayName;function ene(){const{t:e}=ke("sidebar"),{isMobile:t}=Tu();return h.jsx(lc,{children:h.jsx(yo,{children:h.jsxs(Wte,{children:[h.jsx(Hte,{asChild:!0,children:h.jsxs(go,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(fe,{name:"settings",size:28,className:"pr-2"})}),h.jsx(fe,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(iI,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(Kte,{children:h.jsxs(sI,{children:[h.jsx(fe,{name:"sparkles"}),e("contact")]})})})]})})})}function tne({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=ke("sidebar"),a=Ji(),{applicationId:o}=Lp(),[i,s]=g.useState(),c=tn(W2),l=g.useCallback((f,p)=>{f.preventDefault(),f.stopPropagation(),c.show({id:p})},[c]),u=async f=>{try{s(f.id),n(f),a(dn("application",{applicationId:f.id}))}catch(p){console.error(p),s(void 0)}},d=f=>{switch(f.main_source_type){case"Thread":return h.jsx(fe,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Iu,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(Ru,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(lc,{children:[e==null?void 0:e.map(f=>h.jsx(yo,{className:"cursor-pointer",children:h.jsx(go,{disabled:!!i,asChild:!0,autoHide:!0,onClick:()=>u(f),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[f.id===i?h.jsx(fe,{size:16,name:"loader",className:"animate-spin"}):o===f.id?h.jsx(fe,{size:16,color:"green",name:"check"}):h.jsx(fe,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[f.name,d(f)]})]}),h.jsx(fe,{onClick:p=>l(p,f.id),size:16,className:"!z-50",name:"trash-2"})]})})},f.id)),e?h.jsx(yo,{children:h.jsxs(go,{className:"text-sidebar-foreground/70",children:[h.jsx(fe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const nne={navMain:[{title:"playground.title",icon:h.jsx(fe,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(fe,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(fe,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(fe,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function rne({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(Db,{collapsible:"offcanvas",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs($b,{children:[h.jsx(ete,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(tne,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(Dee,{items:nne.navMain})]}),h.jsx(_2,{children:h.jsx(ene,{})}),h.jsx(x2,{})]})}Xn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(tt,{...n,disabled:e.disabled||t,children:t?h.jsx(fe,{name:"loader-circle",className:"animate-spin"}):e.children})});function ane({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const f=Date.now(),p=setInterval(()=>{const m=(Date.now()-f)/n*100;m>=100?(clearInterval(p),u(100)):u(m)},10);return()=>clearInterval(p)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(p=>setTimeout(p,n));const f=t?await t():!0;s(f),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(tt,{className:Z("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:Z("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(fe,{name:"forward",className:Z("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(fe,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(fe,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const $a="NOLLM",one="0123456789abcdef",ine=[8,4,4,4,12];function zu(){return ine.map(e=>EDe(one,e)()).join("-")}const sne=()=>{const e=et(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(RG).filter(c=>c!=="Session");await Promise.all(r.map(c=>de(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${zu()}]`});let a=JSON.stringify({[$a]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},cne=()=>{const[e,t]=g.useState(!1),n=Ji(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(RG).filter(d=>d!==$a);if(!Object.keys(o[$a]).length||typeof o[$a]!="object")throw new Error("Missing Metadata");if(!("session"in o[$a])||!o[$a].session)throw new Error("Missing Session Metadata");const s=o[$a].session;if(!("ids"in o[$a]))throw new Error("Missing Session ID");const c=o[$a].ids.reduce((d,f)=>(d[f]=zu(),d),{}),l=Object.keys(o).filter(d=>d!==$a);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(f=>{if("session_id"in f&&f.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await de("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const f=o[d];if(!f||!f.length)return Promise.resolve();const p=f.map(m=>r(m,{idMap:c,newSessionId:u.id}));return de(d).save(p)})),u.type===Ui.Whiteboard?n(dn("whiteboard",{sessionId:u.id})):u.type===Ui.StandaloneApp&&n(dn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function lne(){const{t:e}=ke("tooltips"),t=Ta(),n=eu(f=>f.setTheme),r=eu(f=>f.theme),{exportSession:a}=sne(),{loading:o,importSession:i}=cne(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(f){return Us(f),!1}},[a]),u=g.useCallback(async f=>{var p;try{const m=(p=f.target.files)==null?void 0:p[0];if(!m)return;const y=await new Promise((v,b)=>{const w=new FileReader;w.onload=j=>{var x;try{const _=(x=j.target)==null?void 0:x.result;v(JSON.parse(_))}catch(_){b(_)}},w.onerror=j=>{b(j)},w.readAsText(m)});await i(y)}catch(m){return Us(m),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(dn("whiteboard")))return e("whiteboard");if(t.pathname.includes(dn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(w2,{}),h.jsx(qe,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(Au,{children:[h.jsxs(Da,{children:[h.jsx(La,{children:h.jsxs(Xn,{loading:o,variant:"ghost",onClick:()=>{var f;return(f=s.current)==null?void 0:f.click()},children:[h.jsx(fe,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Jr,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(Da,{children:[h.jsx(La,{children:h.jsx(ane,{onProcess:l})}),h.jsx(Jr,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(Da,{children:[h.jsx(La,{children:h.jsx(tt,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(fe,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Jr,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(Da,{children:[h.jsx(La,{children:h.jsx(tt,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(fe,{size:18,name:"github"})})})}),h.jsx(Jr,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function cI({requiredSession:e}){const t=Lp(),n=Ji(),r=Ta(),a=g.useRef(r),o=et(u=>u.currentSession),i=et(u=>u.sessions),s=et(u=>u.applications),c=et(u=>u.setCurrentSession),l=et(u=>u.setToDefaultSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(dn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(dn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(dn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(dn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(u=>{if(!u)return l(r.pathname.includes(dn("whiteboard"))?Ui.Whiteboard:Ui.StandaloneApp);Ree().has("flow")&&u.type===Ui.StandaloneApp||(u.type===Ui.StandaloneApp&&a.current.pathname.includes(dn("whiteboard").replace("/",""))?n(dn("application",{applicationId:u.id})):u.type===Ui.Whiteboard&&a.current.pathname.includes(dn("application").replace("/",""))&&n(dn("whiteboard",{sessionId:u.id})))})},[n,t.applicationId,t.sessionId,e,c,l]),h.jsxs(Rb,{defaultOpen:!1,children:[h.jsx(rne,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(Lb,{className:"max-h-screen overflow-hidden",children:[h.jsx(lne,{}),h.jsx(Ks,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(PJ,{})})]})]})}const lI=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:Z("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));lI.displayName="ChatMessageList";var uI="vercel.ai.error",une=Symbol.for(uI),dI,dne=class nX extends Error{constructor({name:t,message:n,cause:r}){super(n),this[dI]=!0,this.name=t,this.cause=r}static isInstance(t){return nX.hasMarker(t,uI)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};dI=une;var mc=dne;function fI(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var pI="AI_InvalidArgumentError",hI=`vercel.ai.error.${pI}`,fne=Symbol.for(hI),mI,pne=class extends mc{constructor({message:e,cause:t,argument:n}){super({name:pI,message:e,cause:t}),this[mI]=!0,this.argument=n}static isInstance(e){return mc.hasMarker(e,hI)}};mI=fne;var yI="AI_JSONParseError",gI=`vercel.ai.error.${yI}`,hne=Symbol.for(gI),vI,bI=class extends mc{constructor({text:e,cause:t}){super({name:yI,message:`JSON parsing failed: Text: ${e}.
Error message: ${fI(t)}`,cause:t}),this[vI]=!0,this.text=e}static isInstance(e){return mc.hasMarker(e,gI)}};vI=hne;var wI="AI_TypeValidationError",xI=`vercel.ai.error.${wI}`,mne=Symbol.for(xI),_I,yne=class Rk extends mc{constructor({value:t,cause:n}){super({name:wI,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${fI(n)}`,cause:n}),this[_I]=!0,this.value=t}static isInstance(t){return mc.hasMarker(t,xI)}static wrap({value:t,cause:n}){return Rk.isInstance(n)&&n.value===t?n:new Rk({value:t,cause:n})}};_I=mne;var jI=yne;let gne=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var ns={exports:{}},SI;function vne(){if(SI)return ns.exports;SI=1;const e=typeof jn<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&jn.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",f=l&&l.constructorAction||"error";if(d==="ignore"&&f==="ignore")return u;if(d!=="ignore"&&f!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&f==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:f,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const f=d;d=[];for(const p of f){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const m in p){const y=p[m];y&&typeof y=="object"&&d.push(y)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return ns.exports=o,ns.exports.default=o,ns.exports.parse=o,ns.exports.safeParse=i,ns.exports.scan=a,ns.exports}var bne=vne();const wne=st(bne);var xne=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=gne(n,t);if(e==null)return a;if(n.includes(r))throw new pne({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},EI=xne(),sw=Symbol.for("vercel.ai.validator");function _ne(e){return{[sw]:!0,validate:e}}function jne(e){return typeof e=="object"&&e!==null&&sw in e&&e[sw]===!0&&"validate"in e}function Sne(e){return jne(e)?e:Ene(e)}function Ene(e){return _ne(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function One({value:e,schema:t}){const n=Sne(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:jI.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:jI.wrap({value:e,cause:r})}}}function OI({text:e,schema:t}){try{const n=wne.parse(e);return t==null?{success:!0,value:n}:One({value:n,schema:t})}catch(n){return{success:!1,error:bI.isInstance(n)?n:new bI({text:e,cause:n})}}}var wh={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},xh={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},_h={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},jh={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Sh={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Cne=[wh,xh,_h,jh,Sh];wh.code+"",xh.code+"",_h.code+"",jh.code+"",Sh.code+"",wh.name+"",wh.code,xh.name+"",xh.code,_h.name+"",_h.code,jh.name+"",jh.code,Sh.name+"",Sh.code,Cne.map(e=>e.code);function Nne(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function Mne(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=OI({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=OI({text:Nne(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Uu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Vu={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},qu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Wu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Hu={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Ku={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Zu={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Gu={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Xu={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Ju={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},kne=[Uu,Vu,qu,Wu,Hu,Ku,Zu,Gu,Xu,Ju],Pne={[Uu.code]:Uu,[Vu.code]:Vu,[qu.code]:qu,[Wu.code]:Wu,[Hu.code]:Hu,[Ku.code]:Ku,[Zu.code]:Zu,[Gu.code]:Gu,[Xu.code]:Xu,[Ju.code]:Ju};Uu.name+"",Uu.code,Vu.name+"",Vu.code,qu.name+"",qu.code,Wu.name+"",Wu.code,Hu.name+"",Hu.code,Ku.name+"",Ku.code,Zu.name+"",Zu.code,Gu.name+"",Gu.code,Xu.name+"",Xu.code,Ju.name+"",Ju.code;var Ane=kne.map(e=>e.code),Tne=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!Ane.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return Pne[r].parse(o)},Ine=10;function Rne(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function Dne({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),f=new TextDecoder,p=[];let m=0;for(;;){const{value:y}=await d.read();if(y&&(p.push(y),m+=y.length,y[y.length-1]!==Ine))continue;if(p.length===0)break;const v=Rne(p,m);m=0;const b=f.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(Tne);for(const{type:w,value:j}of b)switch(w){case"text":await(t==null?void 0:t(j));break;case"data":await(n==null?void 0:n(j));break;case"error":await(r==null?void 0:r(j));break;case"message_annotations":await(c==null?void 0:c(j));break;case"tool_call_streaming_start":await(a==null?void 0:a(j));break;case"tool_call_delta":await(o==null?void 0:o(j));break;case"tool_call":await(i==null?void 0:i(j));break;case"tool_result":await(s==null?void 0:s(j));break;case"finish_message":await(l==null?void 0:l(j));break;case"finish_step":await(u==null?void 0:u(j));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function Lne({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function $ne({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=EI,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const f={};let p={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},m="unknown";function y(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await Dne({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},y()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),f[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),y()},onToolCallDeltaPart(b){const w=v(),j=f[b.toolCallId];j.text+=b.argsTextDelta;const{value:x}=Mne(j.text);w.toolInvocations[j.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:j.toolName,args:x},y()},async onToolCallPart(b){const w=v();if(f[b.toolCallId]!=null?w.toolInvocations[f[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const j=await n({toolCall:b});j!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:j})}y()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const j=w.findIndex(x=>x.toolCallId===b.toolCallId);if(j===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[j]={...w[j],state:"result",...b},y()},onDataPart(b){u.push(...b),y()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),y()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){m=b.finishReason,b.usage!=null&&(p=Lne(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:m,usage:p})}async function Fne({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var Bne=()=>fetch;async function zne({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:f=Bne()}){var p,m;const y=await f(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(p=o==null?void 0:o())==null?void 0:p.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(y)}catch(v){throw v}if(!y.ok)throw i(),new Error((m=await y.text())!=null?m:"Failed to fetch the chat response.");if(!y.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await Fne({stream:y.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await $ne({stream:y.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var CI={exports:{}},cw={},NI;function Une(){if(NI)return cw;NI=1;var e=DG();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,f){var p=f(),m=r({inst:{value:p,getSnapshot:f}}),y=m[0].inst,v=m[1];return o(function(){y.value=p,y.getSnapshot=f,c(y)&&v({inst:y})},[d,p,f]),a(function(){return c(y)&&v({inst:y}),d(function(){c(y)&&v({inst:y})})},[d]),i(p),p}function c(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function l(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return cw.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,cw}var MI;function kI(){return MI||(MI=1,CI.exports=Une()),CI.exports}xp=kI();let jo,Un,Eh,ut,Yr,So,PI,Yu;JG=st(xp),jo=()=>{},Un=jo(),Eh=Object,ut=e=>e===Un,Yr=e=>typeof e=="function",So=(e,t)=>({...e,...t}),PI=e=>Yr(e.then),Yu=new WeakMap;let Vne=0;const Qu=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Eh(e)===e&&!r&&n!=RegExp){if(a=Yu.get(e),a)return a;if(a=++Vne+"~",Yu.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=Qu(e[o])+",";Yu.set(e,a)}if(n==Eh){a="#";const i=Eh.keys(e).sort();for(;!ut(o=i.pop());)ut(e[o])||(a+=o+":"+Qu(e[o])+",");Yu.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},Eo=new WeakMap,lw={},Oh={},uw="undefined",Ch=typeof window!=uw,dw=typeof document!=uw,qne=()=>Ch&&typeof window.requestAnimationFrame!=uw,AI=(e,t)=>{const n=Eo.get(e);return[()=>!ut(t)&&e.get(t)||lw,r=>{if(!ut(t)){const a=e.get(t);t in Oh||(Oh[t]=a),n[5](t,So(a,r),a||lw)}},n[6],()=>!ut(t)&&t in Oh?Oh[t]:!ut(t)&&e.get(t)||lw]};let fw=!0;const Wne=()=>fw,[pw,hw]=Ch&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[jo,jo],Hne=()=>{const e=dw&&document.visibilityState;return ut(e)||e!=="hidden"},Kne=e=>(dw&&document.addEventListener("visibilitychange",e),pw("focus",e),()=>{dw&&document.removeEventListener("visibilitychange",e),hw("focus",e)}),Zne=e=>{const t=()=>{fw=!0,e()},n=()=>{fw=!1};return pw("online",t),pw("offline",n),()=>{hw("online",t),hw("offline",n)}},Gne={isOnline:Wne,isVisible:Hne},Xne={initFocus:Kne,initReconnect:Zne},TI=!H.useId,ed=!Ch||"Deno"in window,Jne=e=>qne()?window.requestAnimationFrame(e):setTimeout(e,1),mw=ed?g.useEffect:g.useLayoutEffect,yw=typeof navigator<"u"&&navigator.connection,II=!ed&&yw&&(["slow-2g","2g"].includes(yw.effectiveType)||yw.saveData),gw=e=>{if(Yr(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Qu(e):"",[e,t]};let Yne=0;const vw=()=>++Yne,RI=0,DI=1,LI=2;var td={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:RI,MUTATE_EVENT:LI,RECONNECT_EVENT:DI};async function $I(...e){const[t,n,r,a]=e,o=So({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=f=>typeof s=="function"?s(f):s!==!1,u=o.throwOnError;if(Yr(n)){const f=n,p=[],m=t.keys();for(const y of m)!/^\$(inf|sub)\$/.test(y)&&f(t.get(y)._k)&&p.push(y);return Promise.all(p.map(d))}return d(n);async function d(f){const[p]=gw(f);if(!p)return;const[m,y]=AI(t,p),[v,b,w,j]=Eo.get(t),x=()=>{const P=v[p];return(Yr(o.revalidate)?o.revalidate(m().data,f):o.revalidate!==!1)&&(delete w[p],delete j[p],P&&P[0])?P[0](LI).then(()=>m().data):m().data};if(e.length<3)return x();let _=r,S;const E=vw();b[p]=[E,0];const O=!ut(c),M=m(),C=M.data,k=M._c,T=ut(k)?C:k;if(O&&(c=Yr(c)?c(T,C):c,y({data:c,_c:T})),Yr(_))try{_=_(T)}catch(P){S=P}if(_&&PI(_))if(_=await _.catch(P=>{S=P}),E!==b[p][0]){if(S)throw S;return _}else S&&O&&l(S)&&(i=!0,y({data:T,_c:Un}));if(i&&!S)if(Yr(i)){const P=i(_,T);y({data:P,error:Un,_c:Un})}else y({data:_,error:Un,_c:Un});if(b[p][1]=vw(),Promise.resolve(x()).then(()=>{y({_c:Un})}),S){if(u)throw S;return}return _}}const FI=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Qne=(e,t)=>{if(!Eo.has(e)){const n=So(Xne,t),r={},a=$I.bind(Un,e);let o=jo;const i={},s=(u,d)=>{const f=i[u]||[];return i[u]=f,f.push(d),()=>f.splice(f.indexOf(d),1)},c=(u,d,f)=>{e.set(u,d);const p=i[u];if(p)for(const m of p)m(d,f)},l=()=>{if(!Eo.has(e)&&(Eo.set(e,[r,{},{},{},a,c,s]),!ed)){const u=n.initFocus(setTimeout.bind(Un,FI.bind(Un,r,RI))),d=n.initReconnect(setTimeout.bind(Un,FI.bind(Un,r,DI)));o=()=>{u&&u(),d&&d(),Eo.delete(e)}}};return l(),[e,a,l,o]}return[e,Eo.get(e)[4]]},ere=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ut(o)&&i>o||setTimeout(r,s,a)},tre=(e,t)=>Qu(e)==Qu(t),[BI,nre]=Qne(new Map),rre=So({onLoadingSlow:jo,onSuccess:jo,onError:jo,onErrorRetry:ere,onDiscarded:jo,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:II?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:II?5e3:3e3,compare:tre,isPaused:()=>!1,cache:BI,mutate:nre,fallback:{}},Gne),are=(e,t)=>{const n=So(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=So(a,i))}return n},ore=g.createContext({}),ire="$inf$",zI=Ch&&window.__SWR_DEVTOOLS_USE__,sre=zI?window.__SWR_DEVTOOLS_USE__:[],cre=()=>{zI&&(window.__SWR_DEVTOOLS_REACT__=H)},lre=e=>Yr(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],ure=()=>So(rre,g.useContext(ore)),dre=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=gw(t),[,,,i]=Eo.get(BI);if(o.startsWith(ire))return n(...a);const s=i[o];return ut(s)?n(...a):(delete i[o],s)}),r),fre=sre.concat(dre),pre=e=>function(...t){const n=ure(),[r,a,o]=lre(t),i=are(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(fre);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},hre=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};cre();const UI=H.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),bw={dedupe:!0},mre=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:f}=n,[p,m,y,v]=Eo.get(r),[b,w]=gw(e),j=g.useRef(!1),x=g.useRef(!1),_=g.useRef(b),S=g.useRef(t),E=g.useRef(n),O=()=>E.current,M=()=>O().isVisible()&&O().isOnline(),[C,k,T,P]=AI(r,b),N=g.useRef({}).current,I=ut(i)?n.fallback[b]:i,A=(U,ce)=>{for(const ae in N){const ue=ae;if(ue==="data"){if(!a(U[ue],ce[ue])&&(!ut(U[ue])||!a(G,ce[ue])))return!1}else if(ce[ue]!==U[ue])return!1}return!0},R=g.useMemo(()=>{const U=!b||!t?!1:ut(s)?O().isPaused()||o?!1:ut(c)?!0:c:s,ce=Se=>{const Ue=So(Se);return delete Ue._k,U?{isValidating:!0,isLoading:!0,...Ue}:Ue},ae=C(),ue=P(),je=ce(ae),Le=ae===ue?je:ce(ue);let $e=je;return[()=>{const Se=ce(C());return A(Se,$e)?($e.data=Se.data,$e.isLoading=Se.isLoading,$e.isValidating=Se.isValidating,$e.error=Se.error,$e):($e=Se,Se)},()=>Le]},[r,b]),L=xp.useSyncExternalStore(g.useCallback(U=>T(b,(ce,ae)=>{A(ae,ce)||U()}),[r,b]),R[0],R[1]),D=!j.current,B=p[b]&&p[b].length>0,F=L.data,$=ut(F)?I:F,z=L.error,X=g.useRef($),G=f?ut(F)?X.current:F:$,q=B&&!ut(z)?!1:D&&!ut(s)?s:O().isPaused()?!1:o?ut($)?!1:c:ut($)||c,J=!!(b&&t&&D&&q),K=ut(L.isValidating)?J:L.isValidating,W=ut(L.isLoading)?J:L.isLoading,Y=g.useCallback(async U=>{const ce=S.current;if(!b||!ce||x.current||O().isPaused())return!1;let ae,ue,je=!0;const Le=U||{},$e=!y[b]||!Le.dedupe,Se=()=>TI?!x.current&&b===_.current&&j.current:b===_.current,Ue={isValidating:!1,isLoading:!1},We=()=>{k(Ue)},He=()=>{const lt=y[b];lt&&lt[1]===ue&&delete y[b]},It={isValidating:!0};ut(C().data)&&(It.isLoading=!0);try{if($e&&(k(It),n.loadingTimeout&&ut(C().data)&&setTimeout(()=>{je&&Se()&&O().onLoadingSlow(b,n)},n.loadingTimeout),y[b]=[ce(w),vw()]),[ae,ue]=y[b],ae=await ae,$e&&setTimeout(He,n.dedupingInterval),!y[b]||y[b][1]!==ue)return $e&&Se()&&O().onDiscarded(b),!1;Ue.error=Un;const lt=m[b];if(!ut(lt)&&(ue<=lt[0]||ue<=lt[1]||lt[1]===0))return We(),$e&&Se()&&O().onDiscarded(b),!1;const ot=C().data;Ue.data=a(ot,ae)?ot:ae,$e&&Se()&&O().onSuccess(ae,b,n)}catch(lt){He();const ot=O(),{shouldRetryOnError:_t}=ot;ot.isPaused()||(Ue.error=lt,$e&&Se()&&(ot.onError(lt,b,ot),(_t===!0||Yr(_t)&&_t(lt))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||M())&&ot.onErrorRetry(lt,b,ot,Yt=>{const ir=p[b];ir&&ir[0]&&ir[0](td.ERROR_REVALIDATE_EVENT,Yt)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,We(),!0},[b,r]),re=g.useCallback((...U)=>$I(r,_.current,...U),[]);if(mw(()=>{S.current=t,E.current=n,ut(F)||(X.current=F)}),mw(()=>{if(!b)return;const U=Y.bind(Un,bw);let ce=0;const ae=hre(b,p,(ue,je={})=>{if(ue==td.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>ce&&M()&&(ce=Le+O().focusThrottleInterval,U())}else if(ue==td.RECONNECT_EVENT)O().revalidateOnReconnect&&M()&&U();else{if(ue==td.MUTATE_EVENT)return Y();if(ue==td.ERROR_REVALIDATE_EVENT)return Y(je)}});return x.current=!1,_.current=b,j.current=!0,k({_k:w}),q&&(ut($)||ed?U():Jne(U)),()=>{x.current=!0,ae()}},[b]),mw(()=>{let U;function ce(){const ue=Yr(l)?l(C().data):l;ue&&U!==-1&&(U=setTimeout(ae,ue))}function ae(){!C().error&&(u||O().isVisible())&&(d||O().isOnline())?Y(bw).then(ce):ce()}return ce(),()=>{U&&(clearTimeout(U),U=-1)}},[l,u,d,b]),g.useDebugValue(G),o&&ut($)&&b){if(!TI&&ed)throw new Error("Fallback data is required when using suspense in SSR.");S.current=t,E.current=n,x.current=!1;const U=v[b];if(!ut(U)){const ce=re(U);UI(ce)}if(ut(z)){const ce=Y(bw);ut(G)||(ce.status="fulfilled",ce.value=!0),UI(ce)}else throw z}return{mutate:re,get data(){return N.data=!0,G},get error(){return N.error=!0,z},get isValidating(){return N.isValidating=!0,K},get isLoading(){return N.isLoading=!0,W}}},Nh=pre(mre);var ww,VI;function yre(){if(VI)return ww;VI=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return ww=e,ww}var gre=yre();const vre=st(gre);function qI(e,t){return t!=null?vre(e,t):e}var bre=async(e,t,n,r,a,o,i,s,c,l,u,d,f,p,m,y,v)=>{var b;const w=i.current;n(t.messages,!1);const j=p?t.messages:t.messages.map(({role:_,content:S,experimental_attachments:E,data:O,annotations:M,toolInvocations:C})=>({role:_,content:S,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...M!==void 0&&{annotations:M},...C!==void 0&&{toolInvocations:C}})),x=a.current;return await zne({api:e,body:(b=m==null?void 0:m({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:j,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(_,S){n([...t.messages,..._],!1),S!=null&&S.length&&r([...x??[],...S],!1)},onToolCall:f,onFinish:u,generateId:c,fetch:y})};function wre({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:f,headers:p,body:m,generateId:y=EI,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const j=g.useId(),x=t??j,_=typeof e=="string"?[e,x]:x,[S]=g.useState([]),{data:E,mutate:O}=Nh([_,"messages"],null,{fallbackData:n??S}),M=g.useRef(E||[]);g.useEffect(()=>{M.current=E||[]},[E]);const{data:C,mutate:k}=Nh([_,"streamData"],null),T=g.useRef(C);g.useEffect(()=>{T.current=C},[C]);const{data:P=!1,mutate:N}=Nh([_,"loading"],null),{data:I=void 0,mutate:A}=Nh([_,"error"],null),R=g.useRef(null),L=g.useRef({credentials:f,headers:p,body:m});g.useEffect(()=>{L.current={credentials:f,headers:p,body:m}},[f,p,m]);const D=g.useCallback(async K=>{const W=M.current.length;try{N(!0),A(void 0);const U=new AbortController;R.current=U,await bre(e,K,qI(O,w),qI(k,w),T,L,M,R,y,c,u,l,o,a,i,v,b),R.current=null}catch(U){if(U.name==="AbortError")return R.current=null,null;d&&U instanceof Error&&d(U),A(U)}finally{N(!1)}const Y=M.current,re=Y[Y.length-1];Y.length>W&&re!=null&&s>1&&WI(re)&&xre(Y)<s&&await D({messages:Y})},[O,N,e,L,l,u,d,A,k,T,c,a,i,o,s,M,R,y,v,b,w]),B=g.useCallback(async(K,{data:W,headers:Y,body:re,experimental_attachments:U}={})=>{var ce,ae;K.id||(K.id=y());const ue=await HI(U),je=M.current.concat({...K,id:(ce=K.id)!=null?ce:y(),createdAt:(ae=K.createdAt)!=null?ae:new Date,experimental_attachments:ue.length>0?ue:void 0});return D({messages:je,headers:Y,body:re,data:W})},[D,y]),F=g.useCallback(async({data:K,headers:W,body:Y}={})=>{const re=M.current;if(re.length===0)return null;const U=re[re.length-1];return D({messages:U.role==="assistant"?re.slice(0,-1):re,headers:W,body:Y,data:K})},[D]),$=g.useCallback(()=>{R.current&&(R.current.abort(),R.current=null)},[]),z=g.useCallback(K=>{typeof K=="function"&&(K=K(M.current)),O(K,!1),M.current=K},[O]),X=g.useCallback(K=>{typeof K=="function"&&(K=K(T.current)),k(K,!1),T.current=K},[k]),[G,q]=g.useState(r),J=g.useCallback(async(K,W={},Y)=>{var re;if((re=K==null?void 0:K.preventDefault)==null||re.call(K),!G&&!W.allowEmptySubmit)return;Y&&(L.current={...L.current,...Y});const U=await HI(W.experimental_attachments),ce={messages:!G&&!U.length&&W.allowEmptySubmit?M.current:M.current.concat({id:y(),createdAt:new Date,role:"user",content:G,experimental_attachments:U.length>0?U:void 0}),headers:W.headers,body:W.body,data:W.data};D(ce),q("")},[G,y,D]);return{messages:E||[],setMessages:z,data:C,setData:X,error:I,append:B,reload:F,stop:$,input:G,setInput:q,handleInputChange:K=>{q(K.target.value)},handleSubmit:J,isLoading:P,addToolResult:({toolCallId:K,result:W})=>{const Y=M.current.map((U,ce,ae)=>ce===ae.length-1&&U.role==="assistant"&&U.toolInvocations?{...U,toolInvocations:U.toolInvocations.map(ue=>ue.toolCallId===K?{...ue,result:W,state:"result"}:ue)}:U);O(Y,!1);const re=Y[Y.length-1];WI(re)&&D({messages:Y})}}}function WI(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function xre(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function HI(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}ok=wre;const Oo=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:Z("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));Oo.displayName="Textarea";function _re({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const jre=48,KI=164;y0=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,f]=g.useState(!1),[p,m]=g.useState(""),{textareaRef:y,adjustHeight:v}=_re({minHeight:o||jre,maxHeight:i||KI}),[b,w]=g.useState(!0),j=g.useCallback(async _=>{try{f(!0),await e(p,_)&&m("")}finally{f(!1)}},[p,e]),x=g.useMemo(()=>({maxHeight:`${i||KI}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:Z("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(Oo,{id:"ai-input-04",value:(l?u:p)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:y,onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),j(_))},onChange:_=>{l||m(_.target.value),v(),l==null||l(_)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(fe,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:Z("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(pp.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(fe,{name:"globe",className:Z("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(cX,{children:b&&h.jsx(pp.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:_=>{j(_)},className:Z("rounded-lg p-2",l&&u||p?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(fe,{name:"send",className:"w-4 h-4"})})})]})]})})})};var xw,ZI;function Sre(){if(ZI)return xw;ZI=1;function e(){this.__data__=[],this.size=0}return xw=e,xw}var _w,GI;su=function(){if(GI)return _w;GI=1;function e(t,n){return t===n||t!==t&&n!==n}return _w=e,_w};var jw,XI;function Mh(){if(XI)return jw;XI=1;var e=su();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return jw=t,jw}var Sw,JI;function Ere(){if(JI)return Sw;JI=1;var e=Mh(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Sw=r,Sw}var Ew,YI;function Ore(){if(YI)return Ew;YI=1;var e=Mh();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Ew=t,Ew}var Ow,QI;function Cre(){if(QI)return Ow;QI=1;var e=Mh();function t(n){return e(this.__data__,n)>-1}return Ow=t,Ow}var Cw,eR;function Nre(){if(eR)return Cw;eR=1;var e=Mh();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return Cw=t,Cw}var Nw,tR;function kh(){if(tR)return Nw;tR=1;var e=Sre(),t=Ere(),n=Ore(),r=Cre(),a=Nre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,Nw=o,Nw}var Mw,nR;function Mre(){if(nR)return Mw;nR=1;var e=kh();function t(){this.__data__=new e,this.size=0}return Mw=t,Mw}var kw,rR;function kre(){if(rR)return kw;rR=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return kw=e,kw}var Pw,aR;function Pre(){if(aR)return Pw;aR=1;function e(t){return this.__data__.get(t)}return Pw=e,Pw}var Aw,oR;function Are(){if(oR)return Aw;oR=1;function e(t){return this.__data__.has(t)}return Aw=e,Aw}var Tw,iR;function sR(){if(iR)return Tw;iR=1;var e=typeof tu=="object"&&tu&&tu.Object===Object&&tu;return Tw=e,Tw}var Iw,cR;Vr=function(){if(cR)return Iw;cR=1;var e=sR(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Iw=n,Iw};var Rw,lR;Gs=function(){if(lR)return Rw;lR=1;var e=Vr(),t=e.Symbol;return Rw=t,Rw};var Dw,uR;function Tre(){if(uR)return Dw;uR=1;var e=Gs(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Dw=o,Dw}var Lw,dR;function Ire(){if(dR)return Lw;dR=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Lw=n,Lw}var $w,fR;function Co(){if(fR)return $w;fR=1;var e=Gs(),t=Tre(),n=Ire(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return $w=i,$w}var Fw,pR;qr=function(){if(pR)return Fw;pR=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Fw=e,Fw};var Bw,hR;wp=function(){if(hR)return Bw;hR=1;var e=Co(),t=qr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return Bw=i,Bw};var zw,mR;function Rre(){if(mR)return zw;mR=1;var e=Vr(),t=e["__core-js_shared__"];return zw=t,zw}var Uw,yR;function Dre(){if(yR)return Uw;yR=1;var e=Rre(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Uw=n,Uw}var Vw,gR;function vR(){if(gR)return Vw;gR=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Vw=n,Vw}var qw,bR;function Lre(){if(bR)return qw;bR=1;var e=wp(),t=Dre(),n=qr(),r=vR(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!n(f)||t(f))return!1;var p=e(f)?u:o;return p.test(r(f))}return qw=d,qw}var Ww,wR;function $re(){if(wR)return Ww;wR=1;function e(t,n){return t==null?void 0:t[n]}return Ww=e,Ww}var Hw,xR;function rs(){if(xR)return Hw;xR=1;var e=Lre(),t=$re();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Hw=n,Hw}var Kw,_R;function Zw(){if(_R)return Kw;_R=1;var e=rs(),t=Vr(),n=e(t,"Map");return Kw=n,Kw}var Gw,jR;function Ph(){if(jR)return Gw;jR=1;var e=rs(),t=e(Object,"create");return Gw=t,Gw}var Xw,SR;function Fre(){if(SR)return Xw;SR=1;var e=Ph();function t(){this.__data__=e?e(null):{},this.size=0}return Xw=t,Xw}var Jw,ER;function Bre(){if(ER)return Jw;ER=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Jw=e,Jw}var Yw,OR;function zre(){if(OR)return Yw;OR=1;var e=Ph(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return Yw=a,Yw}var Qw,CR;function Ure(){if(CR)return Qw;CR=1;var e=Ph(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return Qw=r,Qw}var ex,NR;function Vre(){if(NR)return ex;NR=1;var e=Ph(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return ex=n,ex}var tx,MR;function qre(){if(MR)return tx;MR=1;var e=Fre(),t=Bre(),n=zre(),r=Ure(),a=Vre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,tx=o,tx}var nx,kR;function Wre(){if(kR)return nx;kR=1;var e=qre(),t=kh(),n=Zw();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return nx=r,nx}var rx,PR;function Hre(){if(PR)return rx;PR=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return rx=e,rx}var ax,AR;function Ah(){if(AR)return ax;AR=1;var e=Hre();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return ax=t,ax}var ox,TR;function Kre(){if(TR)return ox;TR=1;var e=Ah();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return ox=t,ox}var ix,IR;function Zre(){if(IR)return ix;IR=1;var e=Ah();function t(n){return e(this,n).get(n)}return ix=t,ix}var sx,RR;function Gre(){if(RR)return sx;RR=1;var e=Ah();function t(n){return e(this,n).has(n)}return sx=t,sx}var cx,DR;function Xre(){if(DR)return cx;DR=1;var e=Ah();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return cx=t,cx}var lx,LR;function ux(){if(LR)return lx;LR=1;var e=Wre(),t=Kre(),n=Zre(),r=Gre(),a=Xre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,lx=o,lx}var dx,$R;function Jre(){if($R)return dx;$R=1;var e=kh(),t=Zw(),n=ux(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return dx=a,dx}var fx,FR;C0=function(){if(FR)return fx;FR=1;var e=kh(),t=Mre(),n=kre(),r=Pre(),a=Are(),o=Jre();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,fx=i,fx};var px,BR;function Yre(){if(BR)return px;BR=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return px=t,px}var hx,zR;function Qre(){if(zR)return hx;zR=1;function e(t){return this.__data__.has(t)}return hx=e,hx}var mx,UR;function VR(){if(UR)return mx;UR=1;var e=ux(),t=Yre(),n=Qre();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,mx=r,mx}var yx,qR;function WR(){if(qR)return yx;qR=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return yx=e,yx}var gx,HR;function KR(){if(HR)return gx;HR=1;function e(t,n){return t.has(n)}return gx=e,gx}var vx,ZR;function GR(){if(ZR)return vx;ZR=1;var e=VR(),t=WR(),n=KR(),r=1,a=2;function o(i,s,c,l,u,d){var f=c&r,p=i.length,m=s.length;if(p!=m&&!(f&&m>p))return!1;var y=d.get(i),v=d.get(s);if(y&&v)return y==s&&v==i;var b=-1,w=!0,j=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<p;){var x=i[b],_=s[b];if(l)var S=f?l(_,x,b,s,i,d):l(x,_,b,i,s,d);if(S!==void 0){if(S)continue;w=!1;break}if(j){if(!t(s,function(E,O){if(!n(j,O)&&(x===E||u(x,E,c,l,d)))return j.push(O)})){w=!1;break}}else if(!(x===_||u(x,_,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return vx=o,vx}var bx,XR;Nk=function(){if(XR)return bx;XR=1;var e=Vr(),t=e.Uint8Array;return bx=t,bx};var wx,JR;function eae(){if(JR)return wx;JR=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return wx=e,wx}var xx,YR;function _x(){if(YR)return xx;YR=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return xx=e,xx}var jx,QR;function tae(){if(QR)return jx;QR=1;var e=Gs(),t=Nk(),n=su(),r=GR(),a=eae(),o=_x(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",f="[object Number]",p="[object RegExp]",m="[object Set]",y="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",j=e?e.prototype:void 0,x=j?j.valueOf:void 0;function _(S,E,O,M,C,k,T){switch(O){case w:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case b:return!(S.byteLength!=E.byteLength||!k(new t(S),new t(E)));case c:case l:case f:return n(+S,+E);case u:return S.name==E.name&&S.message==E.message;case p:case y:return S==E+"";case d:var P=a;case m:var N=M&i;if(P||(P=o),S.size!=E.size&&!N)return!1;var I=T.get(S);if(I)return I==E;M|=s,T.set(S,E);var A=r(P(S),P(E),M,C,k,T);return T.delete(S),A;case v:if(x)return x.call(S)==x.call(E)}return!1}return jx=_,jx}var Sx,eD;function Ex(){if(eD)return Sx;eD=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Sx=e,Sx}var Ox,tD;zn=function(){if(tD)return Ox;tD=1;var e=Array.isArray;return Ox=e,Ox};var Cx,nD;function rD(){if(nD)return Cx;nD=1;var e=Ex(),t=zn();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return Cx=n,Cx}var Nx,aD;function nae(){if(aD)return Nx;aD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return Nx=e,Nx}var Mx,oD;function iD(){if(oD)return Mx;oD=1;function e(){return[]}return Mx=e,Mx}var kx,sD;j0=function(){if(sD)return kx;sD=1;var e=nae(),t=iD(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return kx=o,kx};var Px,cD;function rae(){if(cD)return Px;cD=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Px=e,Px}var Ax,lD;Pa=function(){if(lD)return Ax;lD=1;function e(t){return t!=null&&typeof t=="object"}return Ax=e,Ax};var Tx,uD;function aae(){if(uD)return Tx;uD=1;var e=Co(),t=Pa(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Tx=r,Tx}var Ix,dD;bp=function(){if(dD)return Ix;dD=1;var e=aae(),t=Pa(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return Ix=o,Ix};var Th={exports:{}},Rx,fD;function oae(){if(fD)return Rx;fD=1;function e(){return!1}return Rx=e,Rx}Th.exports;var pD;N0=function(){return pD||(pD=1,function(e,t){var n=Vr(),r=oae(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Th,Th.exports)),Th.exports};var Dx,hD;function Ih(){if(hD)return Dx;hD=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Dx=n,Dx}var Lx,mD;function $x(){if(mD)return Lx;mD=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return Lx=t,Lx}var Fx,yD;function iae(){if(yD)return Fx;yD=1;var e=Co(),t=$x(),n=Pa(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",f="[object RegExp]",p="[object Set]",m="[object String]",y="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",j="[object Float64Array]",x="[object Int8Array]",_="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",M="[object Uint16Array]",C="[object Uint32Array]",k={};k[w]=k[j]=k[x]=k[_]=k[S]=k[E]=k[O]=k[M]=k[C]=!0,k[r]=k[a]=k[v]=k[o]=k[b]=k[i]=k[s]=k[c]=k[l]=k[u]=k[d]=k[f]=k[p]=k[m]=k[y]=!1;function T(P){return n(P)&&t(P.length)&&!!k[e(P)]}return Fx=T,Fx}var Bx,gD;O0=function(){if(gD)return Bx;gD=1;function e(t){return function(n){return t(n)}}return Bx=e,Bx};var Rh={exports:{}};Rh.exports;var vD;kk=function(){return vD||(vD=1,function(e,t){var n=sR(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(Rh,Rh.exports)),Rh.exports};var zx,bD;kv=function(){if(bD)return zx;bD=1;var e=iae(),t=O0(),n=kk(),r=n&&n.isTypedArray,a=r?t(r):e;return zx=a,zx};var Ux,wD;function xD(){if(wD)return Ux;wD=1;var e=rae(),t=bp(),n=zn(),r=N0(),a=Ih(),o=kv(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),f=!d&&t(l),p=!d&&!f&&r(l),m=!d&&!f&&!p&&o(l),y=d||f||p||m,v=y?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(y&&(w=="length"||p&&(w=="offset"||w=="parent")||m&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return Ux=c,Ux}var Vx,_D;E0=function(){if(_D)return Vx;_D=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return Vx=t,Vx};var qx,jD;function SD(){if(jD)return qx;jD=1;function e(t,n){return function(r){return t(n(r))}}return qx=e,qx}var Wx,ED;function sae(){if(ED)return Wx;ED=1;var e=SD(),t=e(Object.keys,Object);return Wx=t,Wx}var Hx,OD;function cae(){if(OD)return Hx;OD=1;var e=E0(),t=sae(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Hx=a,Hx}var Kx,CD;Wi=function(){if(CD)return Kx;CD=1;var e=wp(),t=$x();function n(r){return r!=null&&t(r.length)&&!e(r)}return Kx=n,Kx};var Zx,ND;fu=function(){if(ND)return Zx;ND=1;var e=xD(),t=cae(),n=Wi();function r(a){return n(a)?e(a):t(a)}return Zx=r,Zx};var Gx,MD;Pk=function(){if(MD)return Gx;MD=1;var e=rD(),t=j0(),n=fu();function r(a){return e(a,n,t)}return Gx=r,Gx};var Xx,kD;function lae(){if(kD)return Xx;kD=1;var e=Pk(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,f=e(o),p=f.length,m=e(i),y=m.length;if(p!=y&&!d)return!1;for(var v=p;v--;){var b=f[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),j=u.get(i);if(w&&j)return w==i&&j==o;var x=!0;u.set(o,i),u.set(i,o);for(var _=d;++v<p;){b=f[v];var S=o[b],E=i[b];if(c)var O=d?c(E,S,b,i,o,u):c(S,E,b,o,i,u);if(!(O===void 0?S===E||l(S,E,s,c,u):O)){x=!1;break}_||(_=b=="constructor")}if(x&&!_){var M=o.constructor,C=i.constructor;M!=C&&"constructor"in o&&"constructor"in i&&!(typeof M=="function"&&M instanceof M&&typeof C=="function"&&C instanceof C)&&(x=!1)}return u.delete(o),u.delete(i),x}return Xx=a,Xx}var Jx,PD;function uae(){if(PD)return Jx;PD=1;var e=rs(),t=Vr(),n=e(t,"DataView");return Jx=n,Jx}var Yx,AD;function dae(){if(AD)return Yx;AD=1;var e=rs(),t=Vr(),n=e(t,"Promise");return Yx=n,Yx}var Qx,TD;function ID(){if(TD)return Qx;TD=1;var e=rs(),t=Vr(),n=e(t,"Set");return Qx=n,Qx}var e1,RD;function fae(){if(RD)return e1;RD=1;var e=rs(),t=Vr(),n=e(t,"WeakMap");return e1=n,e1}var t1,DD;Mk=function(){if(DD)return t1;DD=1;var e=uae(),t=Zw(),n=dae(),r=ID(),a=fae(),o=Co(),i=vR(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",f="[object DataView]",p=i(e),m=i(t),y=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=f||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(j){var x=o(j),_=x==c?j.constructor:void 0,S=_?i(_):"";if(S)switch(S){case p:return f;case m:return s;case y:return l;case v:return u;case b:return d}return x}),t1=w,t1};var n1,LD;function pae(){if(LD)return n1;LD=1;var e=C0(),t=GR(),n=tae(),r=lae(),a=Mk(),o=zn(),i=N0(),s=kv(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,p=f.hasOwnProperty;function m(y,v,b,w,j,x){var _=o(y),S=o(v),E=_?u:a(y),O=S?u:a(v);E=E==l?d:E,O=O==l?d:O;var M=E==d,C=O==d,k=E==O;if(k&&i(y)){if(!i(v))return!1;_=!0,M=!1}if(k&&!M)return x||(x=new e),_||s(y)?t(y,v,b,w,j,x):n(y,v,E,b,w,j,x);if(!(b&c)){var T=M&&p.call(y,"__wrapped__"),P=C&&p.call(v,"__wrapped__");if(T||P){var N=T?y.value():y,I=P?v.value():v;return x||(x=new e),j(N,I,b,w,x)}}return k?(x||(x=new e),r(y,v,b,w,j,x)):!1}return n1=m,n1}var r1,$D;function a1(){if($D)return r1;$D=1;var e=pae(),t=Pa();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return r1=n,r1}var o1,FD;function hae(){if(FD)return o1;FD=1;var e=C0(),t=a1(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var f=s[l];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++l<u;){f=s[l];var p=f[0],m=o[p],y=f[1];if(d&&f[2]){if(m===void 0&&!(p in o))return!1}else{var v=new e;if(c)var b=c(m,y,p,o,i,v);if(!(b===void 0?t(y,m,n|r,c,v):b))return!1}}return!0}return o1=a,o1}var i1,BD;function zD(){if(BD)return i1;BD=1;var e=qr();function t(n){return n===n&&!e(n)}return i1=t,i1}var s1,UD;function mae(){if(UD)return s1;UD=1;var e=zD(),t=fu();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return s1=n,s1}var c1,VD;function qD(){if(VD)return c1;VD=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return c1=e,c1}var l1,WD;function yae(){if(WD)return l1;WD=1;var e=hae(),t=mae(),n=qD();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return l1=r,l1}var u1,HD;function yc(){if(HD)return u1;HD=1;var e=Co(),t=Pa(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return u1=r,u1}var d1,KD;function f1(){if(KD)return d1;KD=1;var e=zn(),t=yc(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return d1=a,d1}var p1,ZD;function GD(){if(ZD)return p1;ZD=1;var e=ux(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,p1=n,p1}var h1,XD;function gae(){if(XD)return h1;XD=1;var e=GD(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return h1=n,h1}var m1,JD;function vae(){if(JD)return m1;JD=1;var e=gae(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return m1=r,m1}var y1,YD;iu=function(){if(YD)return y1;YD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return y1=e,y1};var g1,QD;function bae(){if(QD)return g1;QD=1;var e=Gs(),t=iu(),n=zn(),r=yc(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return g1=s,g1}var v1,e3;function t3(){if(e3)return v1;e3=1;var e=bae();function t(n){return n==null?"":e(n)}return v1=t,v1}var b1,n3;yu=function(){if(n3)return b1;n3=1;var e=zn(),t=f1(),n=vae(),r=t3();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return b1=a,b1};var w1,r3;Xs=function(){if(r3)return w1;r3=1;var e=yc(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return w1=n,w1};var x1,a3;mu=function(){if(a3)return x1;a3=1;var e=yu(),t=Xs();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return x1=n,x1};var _1,o3;function i3(){if(o3)return _1;o3=1;var e=mu();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return _1=t,_1}var j1,s3;function wae(){if(s3)return j1;s3=1;function e(t,n){return t!=null&&n in Object(t)}return j1=e,j1}var S1,c3;function xae(){if(c3)return S1;c3=1;var e=yu(),t=bp(),n=zn(),r=Ih(),a=$x(),o=Xs();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var p=o(c[u]);if(!(f=s!=null&&l(s,p)))break;s=s[p]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&a(d)&&r(p,d)&&(n(s)||t(s)))}return S1=i,S1}var E1,l3;JM=function(){if(l3)return E1;l3=1;var e=wae(),t=xae();function n(r,a){return r!=null&&t(r,a,e)}return E1=n,E1};var O1,u3;function _ae(){if(u3)return O1;u3=1;var e=a1(),t=i3(),n=JM(),r=f1(),a=zD(),o=qD(),i=Xs(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(f){var p=t(f,u);return p===void 0&&p===d?n(f,u):e(d,p,s|c)}}return O1=l,O1}var C1,d3;function gc(){if(d3)return C1;d3=1;function e(t){return t}return C1=e,C1}var N1,f3;function jae(){if(f3)return N1;f3=1;function e(t){return function(n){return n==null?void 0:n[t]}}return N1=e,N1}var M1,p3;function Sae(){if(p3)return M1;p3=1;var e=mu();function t(n){return function(r){return e(r,n)}}return M1=t,M1}var k1,h3;function Eae(){if(h3)return k1;h3=1;var e=jae(),t=Sae(),n=f1(),r=Xs();function a(o){return n(o)?e(r(o)):t(o)}return k1=a,k1}var P1,m3;function Fa(){if(m3)return P1;m3=1;var e=yae(),t=_ae(),n=gc(),r=zn(),a=Eae();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return P1=o,P1}var A1,y3;function Oae(){if(y3)return A1;y3=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return A1=t,A1}var T1,g3;function v3(){if(g3)return T1;g3=1;var e=rs(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return T1=t,T1}var I1,b3;Tv=function(){if(b3)return I1;b3=1;var e=v3();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return I1=t,I1};var R1,w3;Ak=function(){if(w3)return R1;w3=1;var e=Tv(),t=su(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return R1=a,R1};var D1,x3;function Cae(){if(x3)return D1;x3=1;var e=Ak(),t=yu(),n=Ih(),r=qr(),a=Xs();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,f=d-1,p=i;p!=null&&++u<d;){var m=a(s[u]),y=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return i;if(u!=f){var v=p[m];y=l?l(v,m,p):void 0,y===void 0&&(y=r(v)?v:n(s[u+1])?[]:{})}e(p,m,y),p=p[m]}return i}return D1=o,D1}var L1,_3;XM=function(){if(_3)return L1;_3=1;var e=mu(),t=Cae(),n=yu();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return L1=r,L1};var $1,j3;S0=function(){if(j3)return $1;j3=1;var e=SD(),t=e(Object.getPrototypeOf,Object);return $1=t,$1};var F1,S3;Ck=function(){if(S3)return F1;S3=1;var e=Ex(),t=S0(),n=j0(),r=iD(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return F1=o,F1};var B1,E3;function Nae(){if(E3)return B1;E3=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return B1=e,B1}var z1,O3;function Mae(){if(O3)return z1;O3=1;var e=qr(),t=E0(),n=Nae(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return z1=o,z1}var U1,C3;Ok=function(){if(C3)return U1;C3=1;var e=xD(),t=Mae(),n=Wi();function r(a){return n(a)?e(a,!0):t(a)}return U1=r,U1};var V1,N3;Tk=function(){if(N3)return V1;N3=1;var e=rD(),t=Ck(),n=Ok();function r(a){return e(a,n,t)}return V1=r,V1};var q1,M3;function kae(){if(M3)return q1;M3=1;var e=iu(),t=Fa(),n=XM(),r=Tk();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return q1=a,q1}var W1,k3;function Pae(){if(k3)return W1;k3=1;var e=Fa(),t=Oae(),n=kae();function r(a,o){return n(a,t(e(o)))}return W1=r,W1}var Aae=Pae();const nd=st(Aae);var H1,P3;function Tae(){if(P3)return H1;P3=1;function e(t){return t===void 0}return H1=e,H1}var Iae=Tae();const rd=st(Iae);function rn(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=rn(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Rae={value:()=>{}};function Dh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Lh(n)}function Lh(e){this._=e}function Dae(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Lh.prototype=Dh.prototype={constructor:Lh,on:function(e,t){var n=this._,r=Dae(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=Lae(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=A3(n[a],e.name,t);else if(t==null)for(a in n)n[a]=A3(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Lh(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function Lae(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function A3(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=Rae,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var K1="http://www.w3.org/1999/xhtml";const T3={svg:"http://www.w3.org/2000/svg",xhtml:K1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $h(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),T3.hasOwnProperty(t)?{space:T3[t],local:e}:e}function $ae(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===K1&&t.documentElement.namespaceURI===K1?t.createElement(e):t.createElementNS(n,e)}}function Fae(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function I3(e){var t=$h(e);return(t.local?Fae:$ae)(t)}function Bae(){}function Z1(e){return e==null?Bae:function(){return this.querySelector(e)}}function zae(e){typeof e!="function"&&(e=Z1(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new gr(r,this._parents)}function Uae(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Vae(){return[]}function R3(e){return e==null?Vae:function(){return this.querySelectorAll(e)}}function qae(e){return function(){return Uae(e.apply(this,arguments))}}function Wae(e){typeof e=="function"?e=qae(e):e=R3(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new gr(r,a)}function D3(e){return function(){return this.matches(e)}}function L3(e){return function(t){return t.matches(e)}}var Hae=Array.prototype.find;function Kae(e){return function(){return Hae.call(this.children,e)}}function Zae(){return this.firstElementChild}function Gae(e){return this.select(e==null?Zae:Kae(typeof e=="function"?e:L3(e)))}var Xae=Array.prototype.filter;function Jae(){return Array.from(this.children)}function Yae(e){return function(){return Xae.call(this.children,e)}}function Qae(e){return this.selectAll(e==null?Jae:Yae(typeof e=="function"?e:L3(e)))}function eoe(e){typeof e!="function"&&(e=D3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new gr(r,this._parents)}function $3(e){return new Array(e.length)}function toe(){return new gr(this._enter||this._groups.map($3),this._parents)}function Fh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Fh.prototype={constructor:Fh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function noe(e){return function(){return e}}function roe(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new Fh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function aoe(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,f=new Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=i.call(c,c.__data__,s,t)+"",l.has(p)?a[s]=c:l.set(p,c));for(s=0;s<d;++s)p=i.call(e,o[s],s,o)+"",(c=l.get(p))?(r[s]=c,c.__data__=o[s],l.delete(p)):n[s]=new Fh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(a[s]=c)}function ooe(e){return e.__data__}function ioe(e,t){if(!arguments.length)return Array.from(this,ooe);var n=t?aoe:roe,r=this._parents,a=this._groups;typeof e!="function"&&(e=noe(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],f=d.length,p=soe(e.call(u,u&&u.__data__,l,r)),m=p.length,y=s[l]=new Array(m),v=i[l]=new Array(m),b=c[l]=new Array(f);n(u,d,y,v,b,p,t);for(var w=0,j=0,x,_;w<m;++w)if(x=y[w]){for(w>=j&&(j=w+1);!(_=v[j])&&++j<m;);x._next=_||null}}return i=new gr(i,r),i._enter=s,i._exit=c,i}function soe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function coe(){return new gr(this._exit||this._groups.map($3),this._parents)}function loe(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function uoe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<a;++c)s[c]=n[c];return new gr(s,this._parents)}function doe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function foe(e){e||(e=poe);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new gr(a,this._parents).order()}function poe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function hoe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function moe(){return Array.from(this)}function yoe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function goe(){let e=0;for(const t of this)++e;return e}function voe(){return!this.node()}function boe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function woe(e){return function(){this.removeAttribute(e)}}function xoe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function _oe(e,t){return function(){this.setAttribute(e,t)}}function joe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Soe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Eoe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ooe(e,t){var n=$h(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?xoe:woe:typeof t=="function"?n.local?Eoe:Soe:n.local?joe:_oe)(n,t))}function F3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Coe(e){return function(){this.style.removeProperty(e)}}function Noe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Moe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function koe(e,t,n){return arguments.length>1?this.each((t==null?Coe:typeof t=="function"?Moe:Noe)(e,t,n??"")):vc(this.node(),e)}function vc(e,t){return e.style.getPropertyValue(t)||F3(e).getComputedStyle(e,null).getPropertyValue(t)}function Poe(e){return function(){delete this[e]}}function Aoe(e,t){return function(){this[e]=t}}function Toe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ioe(e,t){return arguments.length>1?this.each((t==null?Poe:typeof t=="function"?Toe:Aoe)(e,t)):this.node()[e]}function B3(e){return e.trim().split(/^|\s+/)}function G1(e){return e.classList||new z3(e)}function z3(e){this._node=e,this._names=B3(e.getAttribute("class")||"")}z3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function U3(e,t){for(var n=G1(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function V3(e,t){for(var n=G1(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Roe(e){return function(){U3(this,e)}}function Doe(e){return function(){V3(this,e)}}function Loe(e,t){return function(){(t.apply(this,arguments)?U3:V3)(this,e)}}function $oe(e,t){var n=B3(e+"");if(arguments.length<2){for(var r=G1(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?Loe:t?Roe:Doe)(n,t))}function Foe(){this.textContent=""}function Boe(e){return function(){this.textContent=e}}function zoe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Uoe(e){return arguments.length?this.each(e==null?Foe:(typeof e=="function"?zoe:Boe)(e)):this.node().textContent}function Voe(){this.innerHTML=""}function qoe(e){return function(){this.innerHTML=e}}function Woe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Hoe(e){return arguments.length?this.each(e==null?Voe:(typeof e=="function"?Woe:qoe)(e)):this.node().innerHTML}function Koe(){this.nextSibling&&this.parentNode.appendChild(this)}function Zoe(){return this.each(Koe)}function Goe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Xoe(){return this.each(Goe)}function Joe(e){var t=typeof e=="function"?e:I3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Yoe(){return null}function Qoe(e,t){var n=typeof e=="function"?e:I3(e),r=t==null?Yoe:typeof t=="function"?t:Z1(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function eie(){var e=this.parentNode;e&&e.removeChild(this)}function tie(){return this.each(eie)}function nie(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function rie(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function aie(e){return this.select(e?rie:nie)}function oie(e){return arguments.length?this.property("__data__",e):this.node().__data__}function iie(e){return function(t){e.call(this,t,this.__data__)}}function sie(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function cie(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function lie(e,t,n){return function(){var r=this.__on,a,o=iie(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function uie(e,t,n){var r=sie(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?lie:cie,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function q3(e,t,n){var r=F3(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function die(e,t){return function(){return q3(this,e,t)}}function fie(e,t){return function(){return q3(this,e,t.apply(this,arguments))}}function pie(e,t){return this.each((typeof t=="function"?fie:die)(e,t))}function*hie(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var W3=[null];function gr(e,t){this._groups=e,this._parents=t}function ad(){return new gr([[document.documentElement]],W3)}function mie(){return this}gr.prototype=ad.prototype={constructor:gr,select:zae,selectAll:Wae,selectChild:Gae,selectChildren:Qae,filter:eoe,data:ioe,enter:toe,exit:coe,join:loe,merge:uoe,selection:mie,order:doe,sort:foe,call:hoe,nodes:moe,node:yoe,size:goe,empty:voe,each:boe,attr:Ooe,style:koe,property:Ioe,classed:$oe,text:Uoe,html:Hoe,raise:Zoe,lower:Xoe,append:Joe,insert:Qoe,remove:tie,clone:aie,datum:oie,on:uie,dispatch:pie,[Symbol.iterator]:hie};function vr(e){return typeof e=="string"?new gr([[document.querySelector(e)]],[document.documentElement]):new gr([[e]],W3)}function yie(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Qr(e,t){if(e=yie(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const gie={passive:!1},od={capture:!0,passive:!1};function X1(e){e.stopImmediatePropagation()}function bc(e){e.preventDefault(),e.stopImmediatePropagation()}function H3(e){var t=e.document.documentElement,n=vr(e).on("dragstart.drag",bc,od);"onselectstart"in t?n.on("selectstart.drag",bc,od):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function K3(e,t){var n=e.document.documentElement,r=vr(e).on("dragstart.drag",null);t&&(r.on("click.drag",bc,od),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Bh=e=>()=>e;function J1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}J1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function vie(e){return!e.ctrlKey&&!e.button}function bie(){return this.parentNode}function wie(e,t){return t??{x:e.x,y:e.y}}function xie(){return navigator.maxTouchPoints||"ontouchstart"in this}function Z3(){var e=vie,t=bie,n=wie,r=xie,a={},o=Dh("start","drag","end"),i=0,s,c,l,u,d=0;function f(x){x.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,gie).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(x,_){if(!(u||!e.call(this,x,_))){var S=j(this,t.call(this,x,_),x,_,"mouse");S&&(vr(x.view).on("mousemove.drag",m,od).on("mouseup.drag",y,od),H3(x.view),X1(x),l=!1,s=x.clientX,c=x.clientY,S("start",x))}}function m(x){if(bc(x),!l){var _=x.clientX-s,S=x.clientY-c;l=_*_+S*S>d}a.mouse("drag",x)}function y(x){vr(x.view).on("mousemove.drag mouseup.drag",null),K3(x.view,l),bc(x),a.mouse("end",x)}function v(x,_){if(e.call(this,x,_)){var S=x.changedTouches,E=t.call(this,x,_),O=S.length,M,C;for(M=0;M<O;++M)(C=j(this,E,x,_,S[M].identifier,S[M]))&&(X1(x),C("start",x,S[M]))}}function b(x){var _=x.changedTouches,S=_.length,E,O;for(E=0;E<S;++E)(O=a[_[E].identifier])&&(bc(x),O("drag",x,_[E]))}function w(x){var _=x.changedTouches,S=_.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<S;++E)(O=a[_[E].identifier])&&(X1(x),O("end",x,_[E]))}function j(x,_,S,E,O,M){var C=o.copy(),k=Qr(M||S,_),T,P,N;if((N=n.call(x,new J1("beforestart",{sourceEvent:S,target:f,identifier:O,active:i,x:k[0],y:k[1],dx:0,dy:0,dispatch:C}),E))!=null)return T=N.x-k[0]||0,P=N.y-k[1]||0,function I(A,R,L){var D=k,B;switch(A){case"start":a[O]=I,B=i++;break;case"end":delete a[O],--i;case"drag":k=Qr(L||R,_),B=i;break}C.call(A,x,new J1(A,{sourceEvent:R,subject:N,target:f,identifier:O,active:B,x:k[0]+T,y:k[1]+P,dx:k[0]-D[0],dy:k[1]-D[1],dispatch:C}),E)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Bh(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:Bh(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Bh(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Bh(!!x),f):r},f.on=function(){var x=o.on.apply(o,arguments);return x===o?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function Y1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function G3(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function id(){}var sd=.7,zh=1/sd,wc="\\s*([+-]?\\d+)\\s*",cd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ba="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_ie=/^#([0-9a-f]{3,8})$/,jie=new RegExp(`^rgb\\(${wc},${wc},${wc}\\)$`),Sie=new RegExp(`^rgb\\(${Ba},${Ba},${Ba}\\)$`),Eie=new RegExp(`^rgba\\(${wc},${wc},${wc},${cd}\\)$`),Oie=new RegExp(`^rgba\\(${Ba},${Ba},${Ba},${cd}\\)$`),Cie=new RegExp(`^hsl\\(${cd},${Ba},${Ba}\\)$`),Nie=new RegExp(`^hsla\\(${cd},${Ba},${Ba},${cd}\\)$`),X3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Y1(id,as,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J3,formatHex:J3,formatHex8:Mie,formatHsl:kie,formatRgb:Y3,toString:Y3});function J3(){return this.rgb().formatHex()}function Mie(){return this.rgb().formatHex8()}function kie(){return r4(this).formatHsl()}function Y3(){return this.rgb().formatRgb()}function as(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=_ie.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Q3(t):n===3?new Jn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Uh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Uh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jie.exec(e))?new Jn(t[1],t[2],t[3],1):(t=Sie.exec(e))?new Jn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Eie.exec(e))?Uh(t[1],t[2],t[3],t[4]):(t=Oie.exec(e))?Uh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Cie.exec(e))?n4(t[1],t[2]/100,t[3]/100,1):(t=Nie.exec(e))?n4(t[1],t[2]/100,t[3]/100,t[4]):X3.hasOwnProperty(e)?Q3(X3[e]):e==="transparent"?new Jn(NaN,NaN,NaN,0):null}function Q3(e){return new Jn(e>>16&255,e>>8&255,e&255,1)}function Uh(e,t,n,r){return r<=0&&(e=t=n=NaN),new Jn(e,t,n,r)}function Pie(e){return e instanceof id||(e=as(e)),e?(e=e.rgb(),new Jn(e.r,e.g,e.b,e.opacity)):new Jn}function Q1(e,t,n,r){return arguments.length===1?Pie(e):new Jn(e,t,n,r??1)}function Jn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Y1(Jn,Q1,G3(id,{brighter(e){return e=e==null?zh:Math.pow(zh,e),new Jn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?sd:Math.pow(sd,e),new Jn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Jn(os(this.r),os(this.g),os(this.b),Vh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e4,formatHex:e4,formatHex8:Aie,formatRgb:t4,toString:t4}));function e4(){return`#${is(this.r)}${is(this.g)}${is(this.b)}`}function Aie(){return`#${is(this.r)}${is(this.g)}${is(this.b)}${is((isNaN(this.opacity)?1:this.opacity)*255)}`}function t4(){const e=Vh(this.opacity);return`${e===1?"rgb(":"rgba("}${os(this.r)}, ${os(this.g)}, ${os(this.b)}${e===1?")":`, ${e})`}`}function Vh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function os(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function is(e){return e=os(e),(e<16?"0":"")+e.toString(16)}function n4(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ea(e,t,n,r)}function r4(e){if(e instanceof ea)return new ea(e.h,e.s,e.l,e.opacity);if(e instanceof id||(e=as(e)),!e)return new ea;if(e instanceof ea)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new ea(i,s,c,e.opacity)}function Tie(e,t,n,r){return arguments.length===1?r4(e):new ea(e,t,n,r??1)}function ea(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Y1(ea,Tie,G3(id,{brighter(e){return e=e==null?zh:Math.pow(zh,e),new ea(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?sd:Math.pow(sd,e),new ea(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Jn(e_(e>=240?e-240:e+120,a,r),e_(e,a,r),e_(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new ea(a4(this.h),qh(this.s),qh(this.l),Vh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vh(this.opacity);return`${e===1?"hsl(":"hsla("}${a4(this.h)}, ${qh(this.s)*100}%, ${qh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function a4(e){return e=(e||0)%360,e<0?e+360:e}function qh(e){return Math.max(0,Math.min(1,e||0))}function e_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const t_=e=>()=>e;function Iie(e,t){return function(n){return e+n*t}}function Rie(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Die(e){return(e=+e)==1?o4:function(t,n){return n-t?Rie(t,n,e):t_(isNaN(t)?n:t)}}function o4(e,t){var n=t-e;return n?Iie(e,n):t_(isNaN(e)?t:e)}const Wh=function e(t){var n=Die(t);function r(a,o){var i=n((a=Q1(a)).r,(o=Q1(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=o4(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function Lie(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function $ie(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Fie(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=xc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function Bie(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ta(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function zie(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=xc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var n_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,r_=new RegExp(n_.source,"g");function Uie(e){return function(){return e}}function Vie(e){return function(t){return e(t)+""}}function i4(e,t){var n=n_.lastIndex=r_.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=n_.exec(e))&&(a=r_.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:ta(r,a)})),n=r_.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?Vie(c[0].x):Uie(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function xc(e,t){var n=typeof t,r;return t==null||n==="boolean"?t_(t):(n==="number"?ta:n==="string"?(r=as(t))?(t=r,Wh):i4:t instanceof as?Wh:t instanceof Date?Bie:$ie(t)?Lie:Array.isArray(t)?Fie:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?zie:ta)(e,t)}function a_(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var s4=180/Math.PI,c4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function l4(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*s4,skewX:Math.atan(c)*s4,scaleX:i,scaleY:s}}var Hh;function qie(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?c4:l4(t.a,t.b,t.c,t.d,t.e,t.f)}function Wie(e){return e==null||(Hh||(Hh=document.createElementNS("http://www.w3.org/2000/svg","g")),Hh.setAttribute("transform",e),!(e=Hh.transform.baseVal.consolidate()))?c4:(e=e.matrix,l4(e.a,e.b,e.c,e.d,e.e,e.f))}function u4(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,p,m){if(l!==d||u!==f){var y=p.push("translate(",null,t,null,n);m.push({i:y-4,x:ta(l,d)},{i:y-2,x:ta(u,f)})}else(d||f)&&p.push("translate("+d+t+f+n)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(a(d)+"rotate(",null,r)-2,x:ta(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(a(d)+"skewX(",null,r)-2,x:ta(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,f,p,m){if(l!==d||u!==f){var y=p.push(a(p)+"scale(",null,",",null,")");m.push({i:y-4,x:ta(l,d)},{i:y-2,x:ta(u,f)})}else(d!==1||f!==1)&&p.push(a(p)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(p){for(var m=-1,y=f.length,v;++m<y;)d[(v=f[m]).i]=v.x(p);return d.join("")}}}var Hie=u4(qie,"px, ","px)","deg)"),Kie=u4(Wie,", ",")",")"),Zie=1e-12;function d4(e){return((e=Math.exp(e))+1/e)/2}function Gie(e){return((e=Math.exp(e))-1/e)/2}function Xie(e){return((e=Math.exp(2*e))-1)/(e+1)}const Jie=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],f=i[2],p=u-s,m=d-c,y=p*p+m*m,v,b;if(y<Zie)b=Math.log(f/l)/t,v=function(E){return[s+E*p,c+E*m,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(y),j=(f*f-l*l+r*y)/(2*l*n*w),x=(f*f-l*l-r*y)/(2*f*n*w),_=Math.log(Math.sqrt(j*j+1)-j),S=Math.log(Math.sqrt(x*x+1)-x);b=(S-_)/t,v=function(E){var O=E*b,M=d4(_),C=l/(n*w)*(M*Xie(t*O+_)-Gie(_));return[s+C*p,c+C*m,l*M/d4(t*O+_)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Yie(e,t){t===void 0&&(t=e,e=xc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var _c=0,ld=0,ud=0,f4=1e3,Kh,dd,Zh=0,ss=0,Gh=0,fd=typeof performance=="object"&&performance.now?performance:Date,p4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function o_(){return ss||(p4(Qie),ss=fd.now()+Gh)}function Qie(){ss=0}function Xh(){this._call=this._time=this._next=null}Xh.prototype=h4.prototype={constructor:Xh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?o_():+n)+(t==null?0:+t),!this._next&&dd!==this&&(dd?dd._next=this:Kh=this,dd=this),this._call=e,this._time=n,i_()},stop:function(){this._call&&(this._call=null,this._time=1/0,i_())}};function h4(e,t,n){var r=new Xh;return r.restart(e,t,n),r}function ese(){o_(),++_c;for(var e=Kh,t;e;)(t=ss-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_c}function m4(){ss=(Zh=fd.now())+Gh,_c=ld=0;try{ese()}finally{_c=0,nse(),ss=0}}function tse(){var e=fd.now(),t=e-Zh;t>f4&&(Gh-=t,Zh=e)}function nse(){for(var e,t=Kh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Kh=n);dd=e,i_(r)}function i_(e){if(!_c){ld&&(ld=clearTimeout(ld));var t=e-ss;t>24?(e<1/0&&(ld=setTimeout(m4,e-fd.now()-Gh)),ud&&(ud=clearInterval(ud))):(ud||(Zh=fd.now(),ud=setInterval(tse,f4)),_c=1,p4(m4))}}function y4(e,t,n){var r=new Xh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var rse=Dh("start","end","cancel","interrupt"),ase=[],g4=0,v4=1,s_=2,Jh=3,b4=4,c_=5,Yh=6;function Qh(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;ose(e,n,{name:t,index:r,group:a,on:rse,tween:ase,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:g4})}function l_(e,t){var n=na(e,t);if(n.state>g4)throw new Error("too late; already scheduled");return n}function za(e,t){var n=na(e,t);if(n.state>Jh)throw new Error("too late; already running");return n}function na(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ose(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=h4(o,0,n.time);function o(l){n.state=v4,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,f,p;if(n.state!==v4)return c();for(u in r)if(p=r[u],p.name===n.name){if(p.state===Jh)return y4(i);p.state===b4?(p.state=Yh,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=Yh,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(y4(function(){n.state===Jh&&(n.state=b4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=s_,n.on.call("start",e,e.__data__,n.index,n.group),n.state===s_){for(n.state=Jh,a=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=p);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=c_,1),d=-1,f=a.length;++d<f;)a[d].call(e,u);n.state===c_&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Yh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function em(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>s_&&r.state<c_,r.state=Yh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function ise(e){return this.each(function(){em(this,e)})}function sse(e,t){var n,r;return function(){var a=za(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function cse(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=za(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function lse(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=na(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?sse:cse)(n,e,t))}function u_(e,t,n){var r=e._id;return e.each(function(){var a=za(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return na(a,r).value[t]}}function w4(e,t){var n;return(typeof t=="number"?ta:t instanceof as?Wh:(n=as(t))?(t=n,Wh):i4)(e,t)}function use(e){return function(){this.removeAttribute(e)}}function dse(e){return function(){this.removeAttributeNS(e.space,e.local)}}function fse(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function pse(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function hse(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function mse(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function yse(e,t){var n=$h(e),r=n==="transform"?Kie:w4;return this.attrTween(e,typeof t=="function"?(n.local?mse:hse)(n,r,u_(this,"attr."+e,t)):t==null?(n.local?dse:use)(n):(n.local?pse:fse)(n,r,t))}function gse(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function vse(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function bse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&vse(e,o)),n}return a._value=t,a}function wse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&gse(e,o)),n}return a._value=t,a}function xse(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=$h(e);return this.tween(n,(r.local?bse:wse)(r,t))}function _se(e,t){return function(){l_(this,e).delay=+t.apply(this,arguments)}}function jse(e,t){return t=+t,function(){l_(this,e).delay=t}}function Sse(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?_se:jse)(t,e)):na(this.node(),t).delay}function Ese(e,t){return function(){za(this,e).duration=+t.apply(this,arguments)}}function Ose(e,t){return t=+t,function(){za(this,e).duration=t}}function Cse(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ese:Ose)(t,e)):na(this.node(),t).duration}function Nse(e,t){if(typeof t!="function")throw new Error;return function(){za(this,e).ease=t}}function Mse(e){var t=this._id;return arguments.length?this.each(Nse(t,e)):na(this.node(),t).ease}function kse(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;za(this,e).ease=n}}function Pse(e){if(typeof e!="function")throw new Error;return this.each(kse(this._id,e))}function Ase(e){typeof e!="function"&&(e=D3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new No(r,this._parents,this._name,this._id)}function Tse(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)i[s]=t[s];return new No(i,this._parents,this._name,this._id)}function Ise(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Rse(e,t,n){var r,a,o=Ise(t)?l_:za;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function Dse(e,t){var n=this._id;return arguments.length<2?na(this.node(),n).on.on(e):this.each(Rse(n,e,t))}function Lse(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function $se(){return this.on("end.remove",Lse(this._id))}function Fse(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Z1(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,Qh(l[f],t,n,f,l,na(u,n)));return new No(o,this._parents,t,n)}function Bse(e){var t=this._name,n=this._id;typeof e!="function"&&(e=R3(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=na(u,n),y=0,v=f.length;y<v;++y)(p=f[y])&&Qh(p,t,n,y,f,m);o.push(f),i.push(u)}return new No(o,i,t,n)}var zse=ad.prototype.constructor;function Use(){return new zse(this._groups,this._parents)}function Vse(e,t){var n,r,a;return function(){var o=vc(this,e),i=(this.style.removeProperty(e),vc(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function x4(e){return function(){this.style.removeProperty(e)}}function qse(e,t,n){var r,a=n+"",o;return function(){var i=vc(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function Wse(e,t,n){var r,a,o;return function(){var i=vc(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),vc(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function Hse(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=za(this,e),l=c.on,u=c.value[o]==null?s||(s=x4(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function Kse(e,t,n){var r=(e+="")=="transform"?Hie:w4;return t==null?this.styleTween(e,Vse(e,r)).on("end.style."+e,x4(e)):typeof t=="function"?this.styleTween(e,Wse(e,r,u_(this,"style."+e,t))).each(Hse(this._id,e)):this.styleTween(e,qse(e,r,t),n).on("end.style."+e,null)}function Zse(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Gse(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&Zse(e,i,n)),r}return o._value=t,o}function Xse(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Gse(e,t,n??""))}function Jse(e){return function(){this.textContent=e}}function Yse(e){return function(){var t=e(this);this.textContent=t??""}}function Qse(e){return this.tween("text",typeof e=="function"?Yse(u_(this,"text",e)):Jse(e==null?"":e+""))}function ece(e){return function(t){this.textContent=e.call(this,t)}}function tce(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&ece(a)),t}return r._value=e,r}function nce(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,tce(e))}function rce(){for(var e=this._name,t=this._id,n=_4(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=na(c,t);Qh(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new No(r,this._parents,e,n)}function ace(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=za(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var oce=0;function No(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function _4(){return++oce}var Mo=ad.prototype;No.prototype={constructor:No,select:Fse,selectAll:Bse,selectChild:Mo.selectChild,selectChildren:Mo.selectChildren,filter:Ase,merge:Tse,selection:Use,transition:rce,call:Mo.call,nodes:Mo.nodes,node:Mo.node,size:Mo.size,empty:Mo.empty,each:Mo.each,on:Dse,attr:yse,attrTween:xse,style:Kse,styleTween:Xse,text:Qse,textTween:nce,remove:$se,tween:lse,delay:Sse,duration:Cse,ease:Mse,easeVarying:Pse,end:ace,[Symbol.iterator]:Mo[Symbol.iterator]};function ice(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var sce={time:null,delay:0,duration:250,ease:ice};function cce(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function lce(e){var t,n;e instanceof No?(t=e._id,e=e._name):(t=_4(),(n=sce).time=o_(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&Qh(c,e,t,l,i,n||cce(c,t));return new No(r,this._parents,e,t)}ad.prototype.interrupt=ise,ad.prototype.transition=lce;const tm=e=>()=>e;function uce(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function ko(e,t,n){this.k=e,this.x=t,this.y=n}ko.prototype={constructor:ko,scale:function(e){return e===1?this:new ko(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ko(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nm=new ko(1,0,0);j4.prototype=ko.prototype;function j4(e){for(;!e.__zoom;)if(!(e=e.parentNode))return nm;return e.__zoom}function d_(e){e.stopImmediatePropagation()}function pd(e){e.preventDefault(),e.stopImmediatePropagation()}function dce(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function fce(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function S4(){return this.__zoom||nm}function pce(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function hce(){return navigator.maxTouchPoints||"ontouchstart"in this}function mce(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function E4(){var e=dce,t=fce,n=mce,r=pce,a=hce,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Jie,l=Dh("start","zoom","end"),u,d,f,p=500,m=150,y=0,v=10;function b(N){N.property("__zoom",S4).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",C).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(N,I,A,R){var L=N.selection?N.selection():N;L.property("__zoom",S4),N!==L?_(N,I,A,R):L.interrupt().each(function(){S(this,arguments).event(R).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},b.scaleBy=function(N,I,A,R){b.scaleTo(N,function(){var L=this.__zoom.k,D=typeof I=="function"?I.apply(this,arguments):I;return L*D},A,R)},b.scaleTo=function(N,I,A,R){b.transform(N,function(){var L=t.apply(this,arguments),D=this.__zoom,B=A==null?x(L):typeof A=="function"?A.apply(this,arguments):A,F=D.invert(B),$=typeof I=="function"?I.apply(this,arguments):I;return n(j(w(D,$),B,F),L,i)},A,R)},b.translateBy=function(N,I,A,R){b.transform(N,function(){return n(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,R)},b.translateTo=function(N,I,A,R,L){b.transform(N,function(){var D=t.apply(this,arguments),B=this.__zoom,F=R==null?x(D):typeof R=="function"?R.apply(this,arguments):R;return n(nm.translate(F[0],F[1]).scale(B.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof A=="function"?-A.apply(this,arguments):-A),D,i)},R,L)};function w(N,I){return I=Math.max(o[0],Math.min(o[1],I)),I===N.k?N:new ko(I,N.x,N.y)}function j(N,I,A){var R=I[0]-A[0]*N.k,L=I[1]-A[1]*N.k;return R===N.x&&L===N.y?N:new ko(N.k,R,L)}function x(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function _(N,I,A,R){N.on("start.zoom",function(){S(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(R).end()}).tween("zoom",function(){var L=this,D=arguments,B=S(L,D).event(R),F=t.apply(L,D),$=A==null?x(F):typeof A=="function"?A.apply(L,D):A,z=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),X=L.__zoom,G=typeof I=="function"?I.apply(L,D):I,q=c(X.invert($).concat(z/X.k),G.invert($).concat(z/G.k));return function(J){if(J===1)J=G;else{var K=q(J),W=z/K[2];J=new ko(W,$[0]-K[0]*W,$[1]-K[1]*W)}B.zoom(null,J)}})}function S(N,I,A){return!A&&N.__zooming||new E(N,I)}function E(N,I){this.that=N,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,I),this.taps=0}E.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,I){return this.mouse&&N!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var I=vr(this.that).datum();l.call(N,this.that,new uce(N,{sourceEvent:this.sourceEvent,target:b,type:N,transform:this.that.__zoom,dispatch:l}),I)}};function O(N,...I){if(!e.apply(this,arguments))return;var A=S(this,I).event(N),R=this.__zoom,L=Math.max(o[0],Math.min(o[1],R.k*Math.pow(2,r.apply(this,arguments)))),D=Qr(N);if(A.wheel)(A.mouse[0][0]!==D[0]||A.mouse[0][1]!==D[1])&&(A.mouse[1]=R.invert(A.mouse[0]=D)),clearTimeout(A.wheel);else{if(R.k===L)return;A.mouse=[D,R.invert(D)],em(this),A.start()}pd(N),A.wheel=setTimeout(B,m),A.zoom("mouse",n(j(w(R,L),A.mouse[0],A.mouse[1]),A.extent,i));function B(){A.wheel=null,A.end()}}function M(N,...I){if(f||!e.apply(this,arguments))return;var A=N.currentTarget,R=S(this,I,!0).event(N),L=vr(N.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",z,!0),D=Qr(N,A),B=N.clientX,F=N.clientY;H3(N.view),d_(N),R.mouse=[D,this.__zoom.invert(D)],em(this),R.start();function $(X){if(pd(X),!R.moved){var G=X.clientX-B,q=X.clientY-F;R.moved=G*G+q*q>y}R.event(X).zoom("mouse",n(j(R.that.__zoom,R.mouse[0]=Qr(X,A),R.mouse[1]),R.extent,i))}function z(X){L.on("mousemove.zoom mouseup.zoom",null),K3(X.view,R.moved),pd(X),R.event(X).end()}}function C(N,...I){if(e.apply(this,arguments)){var A=this.__zoom,R=Qr(N.changedTouches?N.changedTouches[0]:N,this),L=A.invert(R),D=A.k*(N.shiftKey?.5:2),B=n(j(w(A,D),R,L),t.apply(this,I),i);pd(N),s>0?vr(this).transition().duration(s).call(_,B,R,N):vr(this).call(b.transform,B,R,N)}}function k(N,...I){if(e.apply(this,arguments)){var A=N.touches,R=A.length,L=S(this,I,N.changedTouches.length===R).event(N),D,B,F,$;for(d_(N),B=0;B<R;++B)F=A[B],$=Qr(F,this),$=[$,this.__zoom.invert($),F.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,D=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},p)),em(this),L.start())}}function T(N,...I){if(this.__zooming){var A=S(this,I).event(N),R=N.changedTouches,L=R.length,D,B,F,$;for(pd(N),D=0;D<L;++D)B=R[D],F=Qr(B,this),A.touch0&&A.touch0[2]===B.identifier?A.touch0[0]=F:A.touch1&&A.touch1[2]===B.identifier&&(A.touch1[0]=F);if(B=A.that.__zoom,A.touch1){var z=A.touch0[0],X=A.touch0[1],G=A.touch1[0],q=A.touch1[1],J=(J=G[0]-z[0])*J+(J=G[1]-z[1])*J,K=(K=q[0]-X[0])*K+(K=q[1]-X[1])*K;B=w(B,Math.sqrt(J/K)),F=[(z[0]+G[0])/2,(z[1]+G[1])/2],$=[(X[0]+q[0])/2,(X[1]+q[1])/2]}else if(A.touch0)F=A.touch0[0],$=A.touch0[1];else return;A.zoom("touch",n(j(B,F,$),A.extent,i))}}function P(N,...I){if(this.__zooming){var A=S(this,I).event(N),R=N.changedTouches,L=R.length,D,B;for(d_(N),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),D=0;D<L;++D)B=R[D],A.touch0&&A.touch0[2]===B.identifier?delete A.touch0:A.touch1&&A.touch1[2]===B.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(B=Qr(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var F=vr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return b.wheelDelta=function(N){return arguments.length?(r=typeof N=="function"?N:tm(+N),b):r},b.filter=function(N){return arguments.length?(e=typeof N=="function"?N:tm(!!N),b):e},b.touchable=function(N){return arguments.length?(a=typeof N=="function"?N:tm(!!N),b):a},b.extent=function(N){return arguments.length?(t=typeof N=="function"?N:tm([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),b):t},b.scaleExtent=function(N){return arguments.length?(o[0]=+N[0],o[1]=+N[1],b):[o[0],o[1]]},b.translateExtent=function(N){return arguments.length?(i[0][0]=+N[0][0],i[1][0]=+N[1][0],i[0][1]=+N[0][1],i[1][1]=+N[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(N){return arguments.length?(n=N,b):n},b.duration=function(N){return arguments.length?(s=+N,b):s},b.interpolate=function(N){return arguments.length?(c=N,b):c},b.on=function(){var N=l.on.apply(l,arguments);return N===l?b:N},b.clickDistance=function(N){return arguments.length?(y=(N=+N)*N,b):Math.sqrt(y)},b.tapDistance=function(N){return arguments.length?(v=+N,b):v},b}const Po={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},hd=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],O4=["Enter"," ","Escape"];var jc;(function(e){e.Strict="strict",e.Loose="loose"})(jc||(jc={}));var hi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(hi||(hi={}));var md;(function(e){e.Partial="partial",e.Full="full"})(md||(md={}));const C4={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var mi;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(mi||(mi={}));var rm;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(rm||(rm={}));var he;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(he||(he={}));const N4={[he.Left]:he.Right,[he.Right]:he.Left,[he.Top]:he.Bottom,[he.Bottom]:he.Top};function yce(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function M4(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function k4(e){return e===null?null:e?"valid":"invalid"}const P4=e=>"id"in e&&"source"in e&&"target"in e,gce=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),f_=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),yd=(e,t=[0,0])=>{const{width:n,height:r}=Ao(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},vce=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):f_(a)?a:t.nodeLookup.get(a.id));const s=i?im(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return am(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return om(n)},gd=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=im(r);n=am(n,a)}}),om(n)},A4=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...bd(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(i&&!d||f)continue;const p=u.width??l.width??l.initialWidth??null,m=u.height??l.height??l.initialHeight??null,y=vd(s,Ec(l)),v=(p??0)*(m??0),b=o&&y>0;(!l.internals.handleBounds||b||y>=v||l.dragging)&&c.push(l)}return c},bce=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function p_(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function h_({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=gd(e),c=y_(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function T4({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",Po.error005());else{const p=s.measured.width,m=s.measured.height;p&&m&&(d=[[c,l],[c+p,l+m]])}else s&&Oc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=Oc(d)?cs(t,d,i.measured):t;return{position:{x:f.x-c+i.measured.width*u[0],y:f.y-l+i.measured.height*u[1]},positionAbsolute:f}}async function wce({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const f=o.has(d.id),p=!f&&d.parentId&&i.find(m=>m.id===d.parentId);(f||p)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=bce(i,c);for(const d of c)s.has(d.id)&&!l.find(f=>f.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const Sc=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),cs=(e={x:0,y:0},t,n)=>({x:Sc(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Sc(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function I4(e,t,n){const{width:r,height:a}=Ao(n),{x:o,y:i}=n.internals.positionAbsolute;return cs(e,[[o,i],[o+r,i+a]],t)}const R4=(e,t,n)=>e<t?Sc(Math.abs(e-t),1,t)/t:e>n?-Sc(Math.abs(e-n),1,t)/t:0,D4=(e,t,n=15,r=40)=>{const a=R4(e.x,r,t.width-r)*n,o=R4(e.y,r,t.height-r)*n;return[a,o]},am=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),m_=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),om=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ec=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=f_(e)?e.internals.positionAbsolute:yd(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},im=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=f_(e)?e.internals.positionAbsolute:yd(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},L4=(e,t)=>om(am(m_(e),m_(t))),vd=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},$4=e=>ra(e.width)&&ra(e.height)&&ra(e.x)&&ra(e.y),ra=e=>!isNaN(e)&&isFinite(e),xce=(e,t)=>{},sm=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),bd=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?sm(s,i):s},F4=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),y_=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=Sc(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l;return{x:f,y:p,zoom:l}},cm=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Oc(e){return e!==void 0&&e!=="parent"}function Ao(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function B4(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function z4(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function wd(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=To(e),s=bd({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?sm(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const lm=e=>({width:e.offsetWidth,height:e.offsetHeight}),U4=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},_ce=["INPUT","SELECT","TEXTAREA"];function g_(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return _ce.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const V4=e=>"clientX"in e,To=(e,t)=>{var o,i;const n=V4(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},q4=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...lm(i)}})};function W4({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function um(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function H4({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case he.Left:return[t-um(t-r,o),n];case he.Right:return[t+um(r-t,o),n];case he.Top:return[t,n-um(n-a,o)];case he.Bottom:return[t,n+um(a-n,o)]}}function K4({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,curvature:i=.25}){const[s,c]=H4({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=H4({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,f,p,m]=W4({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,f,p,m]}function Z4({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function jce({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function Sce({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=am(im(e),im(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return vd(i,om(o))>0}const Ece=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Oce=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),G4=(e,t)=>{if(!e.source||!e.target)return t;let n;return P4(e)?n={...e}:n={...e,id:Ece(e)},Oce(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function X4({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=Z4({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const J4={[he.Left]:{x:-1,y:0},[he.Right]:{x:1,y:0},[he.Top]:{x:0,y:-1},[he.Bottom]:{x:0,y:1}},Cce=({source:e,sourcePosition:t=he.Bottom,target:n})=>t===he.Left||t===he.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Y4=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Nce({source:e,sourcePosition:t=he.Bottom,target:n,targetPosition:r=he.Top,center:a,offset:o}){const i=J4[t],s=J4[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=Cce({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let p=[],m,y;const v={x:0,y:0},b={x:0,y:0},[w,j,x,_]=Z4({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){m=a.x??w,y=a.y??j;const S=[{x:m,y:c.y},{x:m,y:l.y}],E=[{x:c.x,y},{x:l.x,y}];i[d]===f?p=d==="x"?S:E:p=d==="x"?E:S}else{const S=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?p=i.x===f?E:S:p=i.y===f?S:E,t===r){const T=Math.abs(e[d]-n[d]);if(T<=o){const P=Math.min(o-1,o-T);i[d]===f?v[d]=(c[d]>e[d]?-1:1)*P:b[d]=(l[d]>n[d]?-1:1)*P}}if(t!==r){const T=d==="x"?"y":"x",P=i[d]===s[T],N=c[T]>l[T],I=c[T]<l[T];(i[d]===1&&(!P&&N||P&&I)||i[d]!==1&&(!P&&I||P&&N))&&(p=d==="x"?S:E)}const O={x:c.x+v.x,y:c.y+v.y},M={x:l.x+b.x,y:l.y+b.y},C=Math.max(Math.abs(O.x-p[0].x),Math.abs(M.x-p[0].x)),k=Math.max(Math.abs(O.y-p[0].y),Math.abs(M.y-p[0].y));C>=k?(m=(O.x+M.x)/2,y=p[0].y):(m=p[0].x,y=(O.y+M.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...p,{x:l.x+b.x,y:l.y+b.y},n],m,y,x,_]}function Mce(e,t,n,r){const a=Math.min(Y4(e,t)/2,Y4(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function v_({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,p,m]=Nce({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((y,v,b)=>{let w="";return b>0&&b<u.length-1?w=Mce(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,y+=w,y},""),d,f,p,m]}function Q4(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function kce(e){var d;const{sourceNode:t,targetNode:n}=e;if(!Q4(t)||!Q4(n))return null;const r=t.internals.handleBounds||e5(t.handles),a=n.internals.handleBounds||e5(n.handles),o=t5((r==null?void 0:r.source)??[],e.sourceHandle),i=t5(e.connectionMode===jc.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",Po.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||he.Bottom,c=(i==null?void 0:i.position)||he.Top,l=xd(t,o,s),u=xd(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function e5(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function xd(e,t,n=he.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??Ao(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case he.Top:return{x:a+i/2,y:o};case he.Right:return{x:a+i,y:o+s/2};case he.Bottom:return{x:a+i/2,y:o+s};case he.Left:return{x:a,y:o+s/2}}}function t5(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function b_(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function Pce(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=b_(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const w_={nodeOrigin:[0,0],nodeExtent:hd,elevateNodesOnSelect:!0,defaults:{}},Ace={...w_,checkEquality:!0};function x_(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Tce(e,t,n){const r=x_(w_,n);for(const a of e.values())if(a.parentId)j_(a,e,t,r);else{const o=yd(a,r.nodeOrigin),i=Oc(a.extent)?a.extent:r.nodeExtent,s=cs(o,i,Ao(a));a.internals.positionAbsolute=s}}function __(e,t,n,r){var s,c;const a=x_(Ace,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=yd(l,a.nodeOrigin),f=Oc(l.extent)?l.extent:a.nodeExtent,p=cs(d,f,Ao(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:n5(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&j_(u,t,n,r)}}function Ice(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function j_(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=x_(w_,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Ice(e,n);const l=a?1e3:0,{x:u,y:d,z:f}=Rce(e,c,o,i,l),{positionAbsolute:p}=e.internals,m=u!==p.x||d!==p.y;(m||f!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:m?{x:u,y:d}:p,z:f})}function n5(e,t){return(ra(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Rce(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=Ao(e),c=yd(e,n),l=Oc(e.extent)?cs(c,e.extent,s):c;let u=cs({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=I4(u,s,t));const d=n5(e,a),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function S_(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??Ec(c),u=L4(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var j;const u=c.internals.positionAbsolute,d=Ao(c),f=c.origin??r,p=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,m=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,y=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(y-d.width)*f[0],w=(v-d.height)*f[1];(p>0||m>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-p+b,y:c.position.y-m+w}}),(j=n.get(l))==null||j.forEach(x=>{e.some(_=>_.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+p,y:x.position.y+m}})})),(d.width<s.width||d.height<s.height||p||m)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(p?f[0]*p-b:0),height:v+(m?f[1]*m-w:0)}})}),a}function Dce(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const p=t.get(f.id);if(p)if(p.hidden)p.internals={...p.internals,handleBounds:void 0},s=!0;else{const m=lm(f.nodeElement),y=p.measured.width!==m.width||p.measured.height!==m.height;if(m.width&&m.height&&(y||!p.internals.handleBounds||f.force)){const v=f.nodeElement.getBoundingClientRect(),b=Oc(p.extent)?p.extent:o;let{positionAbsolute:w}=p.internals;p.parentId&&p.extent==="parent"?w=I4(w,m,t.get(p.parentId)):b&&(w=cs(w,b,m)),p.measured=m,p.internals={...p.internals,positionAbsolute:w,handleBounds:{source:q4("source",f.nodeElement,v,u,p.id),target:q4("target",f.nodeElement,v,u,p.id)}},p.parentId&&j_(p,t,n,{nodeOrigin:a}),s=!0,y&&(c.push({id:p.id,type:"dimensions",dimensions:m}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:Ec(p,a)}))}}}if(d.length>0){const f=S_(d,t,n,a);c.push(...f)}return{changes:c,updatedInternals:s}}async function Lce({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function r5(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,f={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,f)),e.set(l,d.set(`${a}-${i}`,f))}}function a5(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:a5(n,t):!1}function o5(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function $ce(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!a5(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function E_({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function Fce({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,p=!1;function m({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:j,nodeId:x,nodeClickDistance:_=0}){f=vr(w);function S({x:C,y:k},T){const{nodeLookup:P,nodeExtent:N,snapGrid:I,snapToGrid:A,nodeOrigin:R,onNodeDrag:L,onSelectionDrag:D,onError:B,updateNodePositions:F}=t();o={x:C,y:k};let $=!1,z={x:0,y:0,x2:0,y2:0};if(s.size>1&&N){const X=gd(s);z=m_(X)}for(const[X,G]of s){if(!P.has(X))continue;let q={x:C-G.distance.x,y:k-G.distance.y};A&&(q=sm(q,I));let J=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];if(s.size>1&&N&&!G.extent){const{positionAbsolute:Y}=G.internals,re=Y.x-z.x+N[0][0],U=Y.x+G.measured.width-z.x2+N[1][0],ce=Y.y-z.y+N[0][1],ae=Y.y+G.measured.height-z.y2+N[1][1];J=[[re,ce],[U,ae]]}const{position:K,positionAbsolute:W}=T4({nodeId:X,nextPosition:q,nodeLookup:P,nodeExtent:J,nodeOrigin:R,onError:B});$=$||G.position.x!==K.x||G.position.y!==K.y,G.position=K,G.internals.positionAbsolute=W}if($&&(F(s,!0),T&&(r||L||!x&&D))){const[X,G]=E_({nodeId:x,dragItems:s,nodeLookup:P});r==null||r(T,s,X,G),L==null||L(T,X,G),x||(D==null||D(T,G))}}async function E(){if(!u)return;const{transform:C,panBy:k,autoPanSpeed:T}=t(),[P,N]=D4(l,u,T);(P!==0||N!==0)&&(o.x=(o.x??0)-P/C[2],o.y=(o.y??0)-N/C[2],await k({x:P,y:N})&&S(o,null)),i=requestAnimationFrame(E)}function O(C){var $;const{nodeLookup:k,multiSelectionActive:T,nodesDraggable:P,transform:N,snapGrid:I,snapToGrid:A,selectNodesOnDrag:R,onNodeDragStart:L,onSelectionDragStart:D,unselectNodesAndEdges:B}=t();d=!0,(!R||!j)&&!T&&x&&(($=k.get(x))!=null&&$.selected||B()),j&&R&&x&&(e==null||e(x));const F=wd(C.sourceEvent,{transform:N,snapGrid:I,snapToGrid:A,containerBounds:u});if(o=F,s=$ce(k,P,F,x),s.size>0&&(n||L||!x&&D)){const[z,X]=E_({nodeId:x,dragItems:s,nodeLookup:k});n==null||n(C.sourceEvent,s,z,X),L==null||L(C.sourceEvent,z,X),x||(D==null||D(C.sourceEvent,X))}}const M=Z3().clickDistance(_).on("start",C=>{const{domNode:k,nodeDragThreshold:T,transform:P,snapGrid:N,snapToGrid:I}=t();u=(k==null?void 0:k.getBoundingClientRect())||null,p=!1,T===0&&O(C),o=wd(C.sourceEvent,{transform:P,snapGrid:N,snapToGrid:I,containerBounds:u}),l=To(C.sourceEvent,u)}).on("drag",C=>{const{autoPanOnNodeDrag:k,transform:T,snapGrid:P,snapToGrid:N,nodeDragThreshold:I,nodeLookup:A}=t(),R=wd(C.sourceEvent,{transform:T,snapGrid:P,snapToGrid:N,containerBounds:u});if((C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1||x&&!A.has(x))&&(p=!0),!p){if(!c&&k&&d&&(c=!0,E()),!d){const L=R.xSnapped-(o.x??0),D=R.ySnapped-(o.y??0);Math.sqrt(L*L+D*D)>I&&O(C)}(o.x!==R.xSnapped||o.y!==R.ySnapped)&&s&&d&&(l=To(C.sourceEvent,u),S(R,C.sourceEvent))}}).on("end",C=>{if(!(!d||p)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:k,updateNodePositions:T,onNodeDragStop:P,onSelectionDragStop:N}=t();if(T(s,!1),a||P||!x&&N){const[I,A]=E_({nodeId:x,dragItems:s,nodeLookup:k,dragging:!1});a==null||a(C.sourceEvent,s,I,A),P==null||P(C.sourceEvent,I,A),x||(N==null||N(C.sourceEvent,A))}}}).filter(C=>{const k=C.target;return!C.button&&(!v||!o5(k,`.${v}`,w))&&(!b||o5(k,b,w))});f.call(M)}function y(){f==null||f.on(".drag",null)}return{update:m,destroy:y}}function Bce(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())vd(a,Ec(o))>0&&r.push(o);return r}const zce=250;function Uce(e,t,n,r){var s,c;let a=[],o=1/0;const i=Bce(e,n,t+zce);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:p}=xd(l,d,d.position,!0),m=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(p-e.y,2));m>t||(m<o?(a=[{...d,x:f,y:p}],o=m):m===o&&a.push({...d,x:f,y:p}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function i5(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(f=>f.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...xd(i,c,c.position,!0)}:c}function s5(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Vce(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const c5=()=>!0;function qce(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:p,onConnectStart:m,onConnect:y,onConnectEnd:v,isValidConnection:b=c5,onReconnectEnd:w,updateConnection:j,getTransform:x,getFromHandle:_,autoPanSpeed:S}){const E=U4(e.target);let O=0,M;const{x:C,y:k}=To(e),T=E==null?void 0:E.elementFromPoint(C,k),P=s5(o,T),N=s==null?void 0:s.getBoundingClientRect();if(!N||!P)return;const I=i5(a,P,r,c,t);if(!I)return;let A=To(e,N),R=!1,L=null,D=!1,B=null;function F(){if(!u||!N)return;const[K,W]=D4(A,N,S);f({x:K,y:W}),O=requestAnimationFrame(F)}const $={...I,nodeId:a,type:P,position:I.position},z=c.get(a),X={inProgress:!0,isValid:null,from:xd(z,$,he.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:z,to:A,toHandle:null,toPosition:N4[$.position],toNode:null};j(X);let G=X;m==null||m(e,{nodeId:a,handleId:r,handleType:P});function q(K){if(!_()||!$){J(K);return}const W=x();A=To(K,N),M=Uce(bd(A,W,!1,[1,1]),n,c,$),R||(F(),R=!0);const Y=l5(K,{handle:M,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});B=Y.handleDomNode,L=Y.connection,D=Vce(!!M,Y.isValid);const re={...G,isValid:D,to:M&&D?F4({x:M.x,y:M.y},W):A,toHandle:Y.toHandle,toPosition:D&&Y.toHandle?Y.toHandle.position:N4[$.position],toNode:Y.toHandle?c.get(Y.toHandle.nodeId):null};D&&M&&G.toHandle&&re.toHandle&&G.toHandle.type===re.toHandle.type&&G.toHandle.nodeId===re.toHandle.nodeId&&G.toHandle.id===re.toHandle.id&&G.to.x===re.to.x&&G.to.y===re.to.y||(j(re),G=re)}function J(K){(M||B)&&L&&D&&(y==null||y(L));const{inProgress:W,...Y}=G,re={...Y,toPosition:G.toHandle?G.toPosition:null};v==null||v(K,re),o&&(w==null||w(K,re)),p(),cancelAnimationFrame(O),R=!1,D=!1,L=null,B=null,E.removeEventListener("mousemove",q),E.removeEventListener("mouseup",J),E.removeEventListener("touchmove",q),E.removeEventListener("touchend",J)}E.addEventListener("mousemove",q),E.addEventListener("mouseup",J),E.addEventListener("touchmove",q),E.addEventListener("touchend",J)}function l5(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=c5,nodeLookup:u}){const d=o==="target",f=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y:m}=To(e),y=i.elementFromPoint(p,m),v=y!=null&&y.classList.contains(`${s}-flow__handle`)?y:f,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=s5(void 0,v),j=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),_=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!j||!w)return b;const E={source:d?j:r,sourceHandle:d?x:a,target:d?r:j,targetHandle:d?a:x};b.connection=E;const O=_&&S&&(n===jc.Strict?d&&w==="source"||!d&&w==="target":j!==r||x!==a);b.isValid=O&&l(E),b.toHandle=i5(j,w,x,u,n,!1)}return b}const O_={onPointerDown:qce,isValid:l5};function Wce({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=vr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:p=!1}){const m=j=>{const x=n();if(j.sourceEvent.type!=="wheel"||!t)return;const _=-j.sourceEvent.deltaY*(j.sourceEvent.deltaMode===1?.05:j.sourceEvent.deltaMode?1:.002)*u,S=x[2]*Math.pow(2,_);t.scaleTo(S)};let y=[0,0];const v=j=>{(j.sourceEvent.type==="mousedown"||j.sourceEvent.type==="touchstart")&&(y=[j.sourceEvent.clientX??j.sourceEvent.touches[0].clientX,j.sourceEvent.clientY??j.sourceEvent.touches[0].clientY])},b=j=>{const x=n();if(j.sourceEvent.type!=="mousemove"&&j.sourceEvent.type!=="touchmove"||!t)return;const _=[j.sourceEvent.clientX??j.sourceEvent.touches[0].clientX,j.sourceEvent.clientY??j.sourceEvent.touches[0].clientY],S=[_[0]-y[0],_[1]-y[1]];y=_;const E=r()*Math.max(x[2],Math.log(x[2]))*(p?-1:1),O={x:x[0]-S[0]*E,y:x[1]-S[1]*E},M=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},M,s)},w=E4().on("start",v).on("zoom",d?b:null).on("zoom.wheel",f?m:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:Qr}}const Hce=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,dm=e=>({x:e.x,y:e.y,zoom:e.k}),C_=({x:e,y:t,zoom:n})=>nm.translate(e,t).scale(n),Cc=(e,t)=>e.target.closest(`.${t}`),u5=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),N_=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},d5=e=>{const t=e.ctrlKey&&cm()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Kce({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Cc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=Qr(u),b=d5(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const f=u.deltaMode===1?20:1;let p=a===hi.Vertical?0:u.deltaX*f,m=a===hi.Horizontal?0:u.deltaY*f;!cm()&&u.shiftKey&&a!==hi.Vertical&&(p=u.deltaY*f,m=0),r.translateBy(n,-(p/d)*o,-(m/d)*o,{internal:!0});const y=dm(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,y)),e.isPanScrolling&&(c==null||c(u,y),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,y),e.isPanScrolling=!1},150))}}function Zce({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||Cc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function Gce({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=dm(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function Xce({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&u5(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,dm(o.transform)))}}function Jce({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&u5(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&Hce(e.prevViewport,i.transform))){const c=dm(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Yce({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var m;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Cc(u,`${l}-flow__node`)||Cc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||Cc(u,s)&&u.type==="wheel"||Cc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const p=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&p}}function Qce({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=E4().clickDistance(!ra(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),p=vr(e).call(f);j({x:o.x,y:o.y,zoom:Sc(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const m=p.on("wheel.zoom"),y=p.on("dblclick.zoom");f.wheelDelta(d5);function v(T,P){return p?new Promise(N=>{f==null||f.transform(N_(p,P==null?void 0:P.duration,()=>N(!0)),T)}):Promise.resolve(!1)}function b({noWheelClassName:T,noPanClassName:P,onPaneContextMenu:N,userSelectionActive:I,panOnScroll:A,panOnDrag:R,panOnScrollMode:L,panOnScrollSpeed:D,preventScrolling:B,zoomOnPinch:F,zoomOnScroll:$,zoomOnDoubleClick:z,zoomActivationKeyPressed:X,lib:G,onTransformChange:q}){I&&!u.isZoomingOrPanning&&w();const J=A&&!X&&!I?Kce({zoomPanValues:u,noWheelClassName:T,d3Selection:p,d3Zoom:f,panOnScrollMode:L,panOnScrollSpeed:D,zoomOnPinch:F,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):Zce({noWheelClassName:T,preventScrolling:B,d3ZoomHandler:m});if(p.on("wheel.zoom",J,{passive:!1}),!I){const W=Gce({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});f.on("start",W);const Y=Xce({zoomPanValues:u,panOnDrag:R,onPaneContextMenu:!!N,onPanZoom:i,onTransformChange:q});f.on("zoom",Y);const re=Jce({zoomPanValues:u,panOnDrag:R,panOnScroll:A,onPaneContextMenu:N,onPanZoomEnd:c,onDraggingChange:l});f.on("end",re)}const K=Yce({zoomActivationKeyPressed:X,panOnDrag:R,zoomOnScroll:$,panOnScroll:A,zoomOnDoubleClick:z,zoomOnPinch:F,userSelectionActive:I,noPanClassName:P,noWheelClassName:T,lib:G});f.filter(K),z?p.on("dblclick.zoom",y):p.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function j(T,P,N){const I=C_(T),A=f==null?void 0:f.constrain()(I,P,N);return A&&await v(A),new Promise(R=>R(A))}async function x(T,P){const N=C_(T);return await v(N,P),new Promise(I=>I(N))}function _(T){if(p){const P=C_(T),N=p.property("__zoom");(N.k!==T.zoom||N.x!==T.x||N.y!==T.y)&&(f==null||f.transform(p,P,null,{sync:!0}))}}function S(){const T=p?j4(p.node()):{x:0,y:0,k:1};return{x:T.x,y:T.y,zoom:T.k}}function E(T,P){return p?new Promise(N=>{f==null||f.scaleTo(N_(p,P==null?void 0:P.duration,()=>N(!0)),T)}):Promise.resolve(!1)}function O(T,P){return p?new Promise(N=>{f==null||f.scaleBy(N_(p,P==null?void 0:P.duration,()=>N(!0)),T)}):Promise.resolve(!1)}function M(T){f==null||f.scaleExtent(T)}function C(T){f==null||f.translateExtent(T)}function k(T){const P=!ra(T)||T<0?0:T;f==null||f.clickDistance(P)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:j,getViewport:S,scaleTo:E,scaleBy:O,setScaleExtent:M,setTranslateExtent:C,syncViewport:_,setClickDistance:k}}var Nc;(function(e){e.Line="line",e.Handle="handle"})(Nc||(Nc={}));const ele=["top-left","top-right","bottom-left","bottom-right"],tle=["top","right","bottom","left"];function nle({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function rle(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function yi(e,t){return Math.max(0,t-e)}function gi(e,t){return Math.max(0,e-t)}function fm(e,t,n){return Math.max(0,t-e,e-n)}function f5(e,t){return e?!t:t}function ale(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:p,ySnapped:m}=n,{minWidth:y,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:j,y:x,width:_,height:S,aspectRatio:E}=e;let O=Math.floor(u?p-e.pointerX:0),M=Math.floor(d?m-e.pointerY:0);const C=_+(c?-O:O),k=S+(l?-M:M),T=-o[0]*_,P=-o[1]*S;let N=fm(C,y,v),I=fm(k,b,w);if(i){let L=0,D=0;c&&O<0?L=yi(j+O+T,i[0][0]):!c&&O>0&&(L=gi(j+C+T,i[1][0])),l&&M<0?D=yi(x+M+P,i[0][1]):!l&&M>0&&(D=gi(x+k+P,i[1][1])),N=Math.max(N,L),I=Math.max(I,D)}if(s){let L=0,D=0;c&&O>0?L=gi(j+O,s[0][0]):!c&&O<0&&(L=yi(j+C,s[1][0])),l&&M>0?D=gi(x+M,s[0][1]):!l&&M<0&&(D=yi(x+k,s[1][1])),N=Math.max(N,L),I=Math.max(I,D)}if(a){if(u){const L=fm(C/E,b,w)*E;if(N=Math.max(N,L),i){let D=0;!c&&!l||c&&!l&&f?D=gi(x+P+C/E,i[1][1])*E:D=yi(x+P+(c?O:-O)/E,i[0][1])*E,N=Math.max(N,D)}if(s){let D=0;!c&&!l||c&&!l&&f?D=yi(x+C/E,s[1][1])*E:D=gi(x+(c?O:-O)/E,s[0][1])*E,N=Math.max(N,D)}}if(d){const L=fm(k*E,y,v)/E;if(I=Math.max(I,L),i){let D=0;!c&&!l||l&&!c&&f?D=gi(j+k*E+T,i[1][0])/E:D=yi(j+(l?M:-M)*E+T,i[0][0])/E,I=Math.max(I,D)}if(s){let D=0;!c&&!l||l&&!c&&f?D=yi(j+k*E,s[1][0])/E:D=gi(j+(l?M:-M)*E,s[0][0])/E,I=Math.max(I,D)}}}M=M+(M<0?I:-I),O=O+(O<0?N:-N),a&&(f?C>k*E?M=(f5(c,l)?-O:O)/E:O=(f5(c,l)?-M:M)*E:u?(M=O/E,l=c):(O=M*E,c=l));const A=c?j+O:j,R=l?x+M:x;return{width:_+(c?-O:O),height:S+(l?-M:M),x:o[0]*O*(c?-1:1)+A,y:o[1]*M*(l?-1:1)+R}}const p5={width:0,height:0,x:0,y:0},ole={...p5,pointerX:0,pointerY:0,aspectRatio:1};function ile(e){return[[0,0],[e.measured.width,e.measured.height]]}function sle(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function cle({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=vr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:p,shouldResize:m}){let y={...p5},v={...ole};const b=rle(c);let w,j=null,x=[],_,S,E;const O=Z3().on("start",M=>{const{nodeLookup:C,transform:k,snapGrid:T,snapToGrid:P,nodeOrigin:N,paneDomNode:I}=n();if(w=C.get(t),!w)return;j=(I==null?void 0:I.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:R}=wd(M.sourceEvent,{transform:k,snapGrid:T,snapToGrid:P,containerBounds:j});y={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...y,pointerX:A,pointerY:R,aspectRatio:y.width/y.height},_=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(_=C.get(w.parentId),S=_&&w.extent==="parent"?ile(_):void 0),x=[],E=void 0;for(const[L,D]of C)if(D.parentId===t&&(x.push({id:L,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const B=sle(D,w,D.origin??N);E?E=[[Math.min(B[0][0],E[0][0]),Math.min(B[0][1],E[0][1])],[Math.max(B[1][0],E[1][0]),Math.max(B[1][1],E[1][1])]]:E=B}d==null||d(M,{...y})}).on("drag",M=>{const{transform:C,snapGrid:k,snapToGrid:T,nodeOrigin:P}=n(),N=wd(M.sourceEvent,{transform:C,snapGrid:k,snapToGrid:T,containerBounds:j}),I=[];if(!w)return;const{x:A,y:R,width:L,height:D}=y,B={},F=w.origin??P,{width:$,height:z,x:X,y:G}=ale(v,b,N,l,u,F,S,E),q=$!==L,J=z!==D,K=X!==A&&q,W=G!==R&&J;if(!K&&!W&&!q&&!J)return;if((K||W||F[0]===1||F[1]===1)&&(B.x=K?X:y.x,B.y=W?G:y.y,y.x=B.x,y.y=B.y,x.length>0)){const U=X-A,ce=G-R;for(const ae of x)ae.position={x:ae.position.x-U+F[0]*($-L),y:ae.position.y-ce+F[1]*(z-D)},I.push(ae)}if((q||J)&&(B.width=q?$:y.width,B.height=J?z:y.height,y.width=B.width,y.height=B.height),_&&w.expandParent){const U=F[0]*(B.width??0);B.x&&B.x<U&&(y.x=U,v.x=v.x-(B.x-U));const ce=F[1]*(B.height??0);B.y&&B.y<ce&&(y.y=ce,v.y=v.y-(B.y-ce))}const Y=nle({width:y.width,prevWidth:L,height:y.height,prevHeight:D,affectsX:b.affectsX,affectsY:b.affectsY}),re={...y,direction:Y};(m==null?void 0:m(M,re))!==!1&&(f==null||f(M,re),r(B,I))}).on("end",M=>{p==null||p(M,{...y}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var h5={exports:{}},M_={},m5;function lle(){if(m5)return M_;m5=1;var e=DG(),t=kI();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return M_.useSyncExternalStoreWithSelector=function(l,u,d,f,p){var m=o(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=s(function(){function b(S){if(!w){if(w=!0,j=S,S=f(S),p!==void 0&&y.hasValue){var E=y.value;if(p(E,S))return x=E}return x=S}if(E=x,r(j,S))return E;var O=f(S);return p!==void 0&&p(E,O)?E:(j=S,x=O)}var w=!1,j,x,_=d===void 0?null:d;return[function(){return b(u())},_===null?void 0:function(){return b(_())}]},[u,d,f,p]);var v=a(l,m[0],m[1]);return i(function(){y.hasValue=!0,y.value=v},[v]),c(v),v},M_}var y5;function ule(){return y5||(y5=1,h5.exports=lle()),h5.exports}var dle=ule();let g5,k_,v5,b5,w5,x5;ZM=st(dle),g5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},k_=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(g5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},v5=e=>e?k_(e):k_,{useDebugValue:b5}=H,{useSyncExternalStoreWithSelector:w5}=ZM,x5=e=>e;function _5(e,t=x5,n){const r=w5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return b5(r),r}const j5=(e,t)=>{const n=v5(e),r=(a,o=t)=>_5(n,a,o);return Object.assign(r,n),r},fle=(e,t)=>e?j5(e,t):j5;function Ut(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const pm=g.createContext(null),ple=pm.Provider,S5=Po.error001();function Ye(e,t){const n=g.useContext(pm);if(n===null)throw new Error(S5);return _5(n,e,t)}function Lt(){const e=g.useContext(pm);if(e===null)throw new Error(S5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const E5={display:"none"},hle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},O5="react-flow__node-desc",C5="react-flow__edge-desc",mle="react-flow__aria-live",yle=e=>e.ariaLiveMessage;function gle({rfId:e}){const t=Ye(yle);return h.jsx("div",{id:`${mle}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:hle,children:t})}function vle({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${O5}-${e}`,style:E5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${C5}-${e}`,style:E5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(gle,{rfId:e})]})}const ble=e=>e.userSelectionActive?"none":"all";function Mc({position:e="top-left",children:t,className:n,style:r,...a}){const o=Ye(ble),i=`${e}`.split("-");return h.jsx("div",{className:rn(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function wle({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(Mc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const xle=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},hm=e=>e.id;function _le(e,t){return Ut(e.selectedNodes.map(hm),t.selectedNodes.map(hm))&&Ut(e.selectedEdges.map(hm),t.selectedEdges.map(hm))}function jle({onSelectionChange:e}){const t=Lt(),{selectedNodes:n,selectedEdges:r}=Ye(xle,_le);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const Sle=e=>!!e.onSelectionChangeHandlers;function Ele({onSelectionChange:e}){const t=Ye(Sle);return e||t?h.jsx(jle,{onSelectionChange:e}):null}const N5=[0,0],Ole={x:0,y:0,zoom:1},Cle=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],M5=[...Cle,"rfId"],Nle=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),k5={translateExtent:hd,nodeOrigin:N5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Mle(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Ye(Nle,Ut),u=Lt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=k5,s()}),[]);const d=g.useRef(k5);return g.useEffect(()=>{for(const f of M5){const p=e[f],m=d.current[f];p!==m&&(typeof e[f]>"u"||(f==="nodes"?t(p):f==="edges"?n(p):f==="minZoom"?r(p):f==="maxZoom"?a(p):f==="translateExtent"?o(p):f==="nodeExtent"?i(p):f==="paneClickDistance"?l(p):f==="fitView"?u.setState({fitViewOnInit:p}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:p}):u.setState({[f]:p})))}d.current=e},M5.map(f=>e[f])),null}function P5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function kle(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=P5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=P5())!=null&&r.matches?"dark":"light"}const A5=typeof document<"u"?document:null;function _d(e=null,t={target:A5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||A5;if(e!==null){const l=f=>{if(a.current=f.ctrlKey||f.metaKey||f.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&g_(f))return!1;const p=I5(f.code,s);o.current.add(f[p]),T5(i,o.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&g_(f))return!1;const p=I5(f.code,s);T5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(f[p]),f.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function T5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function I5(e,t){return t.includes(e)?"code":"key"}const Ple=()=>{const e=Lt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=p_(n,t),{width:c,height:l}=lm(i);return h_({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=y_(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return bd(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=F4(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function R5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)Ale(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function Ale(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ls(e,t){return R5(e,t)}function jd(e,t){return R5(e,t)}function us(e,t){return{id:e,type:"select",selected:t}}function kc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(us(o.id,i)))}return r}function D5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function L5(e){return{id:e.id,type:"remove"}}const $5=e=>gce(e),Tle=e=>P4(e);function F5(e){return g.forwardRef(e)}const Ile=typeof window<"u"?g.useLayoutEffect:g.useEffect;function B5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>Rle(()=>n(a=>a+BigInt(1))));return Ile(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function Rle(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const z5=g.createContext(null);function Dle({children:e}){const t=Lt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let p=c;for(const m of s)p=typeof m=="function"?m(p):m;u?l(p):d&&d(D5({items:p,lookup:f}))},[]),r=B5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let p=c;for(const m of s)p=typeof m=="function"?m(p):m;u?l(p):d&&d(D5({items:p,lookup:f}))},[]),o=B5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(z5.Provider,{value:i,children:e})}function Lle(){const e=g.useContext(z5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const $le=e=>!!e.panZoom;function br(){const e=Ple(),t=Lt(),n=Lle(),r=Ye($le),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:f,nodeOrigin:p}=t.getState(),m=$5(d)?d:f.get(d.id),y=m.parentId?z4(m.position,m.measured,m.parentId,f,p):m.position,v={id:m.id,position:y,width:((b=m.measured)==null?void 0:b.width)??m.width,height:((w=m.measured)==null?void 0:w.height)??m.height,data:m.data};return Ec(v)},l=(d,f,p={replace:!1})=>{i(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return p.replace&&$5(v)?v:{...y,...v}}return y}))},u=(d,f,p={replace:!1})=>{s(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return p.replace&&Tle(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=o(d))==null?void 0:f.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:p}=t.getState(),[m,y,v]=p;return{nodes:d.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:m,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:p,edges:m,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:j,onBeforeDelete:x}=t.getState(),{nodes:_,edges:S}=await wce({nodesToRemove:d,edgesToRemove:f,nodes:p,edges:m,onBeforeDelete:x}),E=S.length>0,O=_.length>0;if(E){const M=S.map(L5);v==null||v(S),w(M)}if(O){const M=_.map(L5);y==null||y(_),b(M)}return(O||E)&&(j==null||j({nodes:_,edges:S})),{deletedNodes:_,deletedEdges:S}},getIntersectingNodes:(d,f=!0,p)=>{const m=$4(d),y=m?d:c(d),v=p!==void 0;return y?(p||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!m&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const j=Ec(v?b:w),x=vd(j,y);return f&&x>0||x>=y.width*y.height}):[]},isNodeIntersecting:(d,f,p=!0)=>{const m=$4(d)?d:c(d);if(!m)return!1;const y=vd(m,f);return p&&y>0||y>=m.width*m.height},updateNode:l,updateNodeData:(d,f,p={replace:!1})=>{l(d,m=>{const y=typeof f=="function"?f(m):f;return p.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},p)},updateEdge:u,updateEdgeData:(d,f,p={replace:!1})=>{u(d,m=>{const y=typeof f=="function"?f(m):f;return p.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},p)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return vce(d,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:d,id:f,nodeId:p})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${p}-${d}-${f??null}`))==null?void 0:m.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const U5=e=>e.selected,Fle={actInsideInputWithModifier:!1},Ble=typeof window<"u"?window:void 0;function zle({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Lt(),{deleteElements:r}=br(),a=_d(e,Fle),o=_d(t,{target:Ble});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(U5),edges:i.filter(U5)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function Ule(e){const t=Lt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=lm(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",Po.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const mm={position:"absolute",width:"100%",height:"100%",top:0,left:0},Vle=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function qle({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=hi.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:m,noWheelClassName:y,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:j}){const x=Lt(),_=g.useRef(null),{userSelectionActive:S,lib:E}=Ye(Vle,Ut),O=_d(f),M=g.useRef();Ule(_);const C=g.useCallback(k=>{b==null||b({x:k[0],y:k[1],zoom:k[2]}),w||x.setState({transform:k})},[b,w]);return g.useEffect(()=>{if(_.current){M.current=Qce({domNode:_.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:j,onDraggingChange:N=>x.setState({paneDragging:N}),onPanZoomStart:(N,I)=>{const{onViewportChangeStart:A,onMoveStart:R}=x.getState();R==null||R(N,I),A==null||A(I)},onPanZoom:(N,I)=>{const{onViewportChange:A,onMove:R}=x.getState();R==null||R(N,I),A==null||A(I)},onPanZoomEnd:(N,I)=>{const{onViewportChangeEnd:A,onMoveEnd:R}=x.getState();R==null||R(N,I),A==null||A(I)}});const{x:k,y:T,zoom:P}=M.current.getViewport();return x.setState({panZoom:M.current,transform:[k,T,P],domNode:_.current.closest(".react-flow")}),()=>{var N;(N=M.current)==null||N.destroy()}}},[]),g.useEffect(()=>{var k;(k=M.current)==null||k.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:p,noPanClassName:v,userSelectionActive:S,noWheelClassName:y,lib:E,onTransformChange:C})},[e,t,n,r,a,o,i,s,O,p,v,S,y,E,C]),h.jsx("div",{className:"react-flow__renderer",ref:_,style:mm,children:m})}const Wle=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Hle(){const{userSelectionActive:e,userSelectionRect:t}=Ye(Wle,Ut);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const P_=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Kle=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function Zle({isSelecting:e,selectionKeyPressed:t,selectionMode:n=md.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:p}){const m=g.useRef(null),y=Lt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),j=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:_,dragging:S}=Ye(Kle,Ut),E=_&&(e||x),O=g.useRef(!1),M=g.useRef(!1),C=()=>{y.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},k=L=>{if(O.current){O.current=!1;return}s==null||s(L),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},T=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},P=l?L=>l(L):void 0,N=L=>{var X,G,q,J;const{resetSelectedElements:D,domNode:B,edgeLookup:F}=y.getState();if(w.current=B==null?void 0:B.getBoundingClientRect(),!_||!e||L.button!==0||L.target!==m.current||!w.current)return;(G=(X=L.target)==null?void 0:X.setPointerCapture)==null||G.call(X,L.pointerId),M.current=!0,O.current=!1,j.current=new Map;for(const[K,W]of F)j.current.set(W.source,((q=j.current.get(W.source))==null?void 0:q.add(K))||new Set([K])),j.current.set(W.target,((J=j.current.get(W.target))==null?void 0:J.add(K))||new Set([K]));const{x:$,y:z}=To(L.nativeEvent,w.current);D(),y.setState({userSelectionRect:{width:0,height:0,startX:$,startY:z,x:$,y:z}}),o==null||o(L)},I=L=>{const{userSelectionRect:D,edgeLookup:B,transform:F,nodeLookup:$,triggerNodeChanges:z,triggerEdgeChanges:X}=y.getState();if(!w.current||!D)return;O.current=!0;const{x:G,y:q}=To(L.nativeEvent,w.current),{startX:J,startY:K}=D,W={startX:J,startY:K,x:G<J?G:J,y:q<K?q:K,width:Math.abs(G-J),height:Math.abs(q-K)},Y=A4($,W,F,n===md.Partial,!0),re=new Set,U=new Set;for(const ce of Y){U.add(ce.id);const ae=j.current.get(ce.id);if(ae)for(const ue of ae)re.add(ue)}if(v.current!==U.size){v.current=U.size;const ce=kc($,U,!0);z(ce)}if(b.current!==re.size){b.current=re.size;const ce=kc(B,re);X(ce)}y.setState({userSelectionRect:W,userSelectionActive:!0,nodesSelectionActive:!1})},A=L=>{var B,F;if(L.button!==0||!M.current)return;(F=(B=L.target)==null?void 0:B.releasePointerCapture)==null||F.call(B,L.pointerId);const{userSelectionRect:D}=y.getState();!x&&D&&L.target===m.current&&(k==null||k(L)),v.current>0&&y.setState({nodesSelectionActive:!0}),C(),i==null||i(L),(t||a)&&(O.current=!1),M.current=!1},R=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:rn(["react-flow__pane",{draggable:R,dragging:S,selection:e}]),onClick:E?void 0:P_(k,m),onContextMenu:P_(T,m),onWheel:P_(P,m),onPointerEnter:E?void 0:u,onPointerDown:E?N:d,onPointerMove:E?I:d,onPointerUp:E?A:void 0,onPointerLeave:f,ref:m,style:mm,children:[p,h.jsx(Hle,{})]})}function A_({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",Po.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function V5({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Lt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=Fce({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{A_({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var p;(p=u.current)==null||p.destroy()}},[n,r,t,o,e,a]),c}const Gle=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function q5(){const e=Lt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=Gle(o),f=r?a[0]:5,p=r?a[1]:5,m=t.direction.x*f*t.factor,y=t.direction.y*p*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+m,y:v.internals.positionAbsolute.y+y};r&&(b=sm(b,a));const{position:w,positionAbsolute:j}=T4({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=j,u.set(v.id,v)}s(u)},[])}const T_=g.createContext(null),Xle=T_.Provider;T_.Consumer;const I_=()=>g.useContext(T_),Jle=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Yle=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===jc.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Qle({type:e="source",position:t=he.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},p){var N,I;const m=i||null,y=e==="target",v=Lt(),b=I_(),{connectOnClick:w,noPanClassName:j,rfId:x}=Ye(Jle,Ut),{connectingFrom:_,connectingTo:S,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:M,valid:C}=Ye(Yle(b,m,e),Ut);b||((I=(N=v.getState()).onError)==null||I.call(N,"010",Po.error010()));const k=A=>{const{defaultEdgeOptions:R,onConnect:L,hasDefaultEdges:D}=v.getState(),B={...R,...A};if(D){const{edges:F,setEdges:$}=v.getState();$(G4(B,F))}L==null||L(B),s==null||s(B)},T=A=>{if(!b)return;const R=V4(A.nativeEvent);if(a&&(R&&A.button===0||!R)){const L=v.getState();O_.onPointerDown(A.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:y,handleId:m,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:k,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}R?u==null||u(A):d==null||d(A)},P=A=>{const{onClickConnectStart:R,onClickConnectEnd:L,connectionClickStartHandle:D,connectionMode:B,isValidConnection:F,lib:$,rfId:z,nodeLookup:X,connection:G}=v.getState();if(!b||!D&&!a)return;if(!D){R==null||R(A.nativeEvent,{nodeId:b,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:m}});return}const q=U4(A.target),J=n||F,{connection:K,isValid:W}=O_.isValid(A.nativeEvent,{handle:{nodeId:b,id:m,type:e},connectionMode:B,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:J,flowId:z,doc:q,lib:$,nodeLookup:X});W&&K&&k(K);const Y=structuredClone(G);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,L==null||L(A,Y),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":m,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${m}-${e}`,className:rn(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",j,l,{source:!y,target:y,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:_,connectingto:S,valid:C,connectionindicator:r&&(!M||O)&&(M?o:a)}]),onMouseDown:T,onTouchStart:T,onClick:w?P:void 0,ref:p,...f,children:c})}const Sd=g.memo(F5(Qle));function eue({data:e,isConnectable:t,sourcePosition:n=he.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(Sd,{type:"source",position:n,isConnectable:t})]})}function tue({data:e,isConnectable:t,targetPosition:n=he.Top,sourcePosition:r=he.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(Sd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(Sd,{type:"source",position:r,isConnectable:t})]})}function nue(){return null}function rue({data:e,isConnectable:t,targetPosition:n=he.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(Sd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const ym={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},W5={input:eue,default:tue,output:rue,group:nue};function aue(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const oue=e=>{const{width:t,height:n,x:r,y:a}=gd(e.nodeLookup,{filter:o=>!!o.selected});return{width:ra(t)?t:null,height:ra(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function iue({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Lt(),{width:a,height:o,transformString:i,userSelectionActive:s}=Ye(oue,Ut),c=q5(),l=g.useRef(null);if(g.useEffect(()=>{var f;n||((f=l.current)==null||f.focus({preventScroll:!0}))},[n]),V5({nodeRef:l}),s||!a||!o)return null;const u=e?f=>{const p=r.getState().nodes.filter(m=>m.selected);e(f,p)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(ym,f.key)&&c({direction:ym[f.key],factor:f.shiftKey?4:1})};return h.jsx("div",{className:rn(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const H5=typeof window<"u"?window:void 0,sue=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function K5({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:x,panOnScrollSpeed:_,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:M,translateExtent:C,minZoom:k,maxZoom:T,preventScrolling:P,onSelectionContextMenu:N,noWheelClassName:I,noPanClassName:A,disableKeyboardA11y:R,onViewportChange:L,isControlledViewport:D}){const{nodesSelectionActive:B,userSelectionActive:F}=Ye(sue),$=_d(l,{target:H5}),z=_d(y,{target:H5}),X=z||O,G=z||x,q=u&&X!==!0,J=$||F||q;return zle({deleteKeyCode:c,multiSelectionKeyCode:m}),h.jsx(qle,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:G,panOnScrollSpeed:_,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:!$&&X,defaultViewport:M,translateExtent:C,minZoom:k,maxZoom:T,zoomActivationKeyCode:v,preventScrolling:P,noWheelClassName:I,noPanClassName:A,onViewportChange:L,isControlledViewport:D,paneClickDistance:s,children:h.jsxs(Zle,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:X,isSelecting:!!J,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:q,children:[e,B&&h.jsx(iue,{onSelectionContextMenu:N,noPanClassName:A,disableKeyboardA11y:R})]})})}K5.displayName="FlowRenderer";const cue=g.memo(K5),lue=e=>t=>e?A4(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function uue(e){return Ye(g.useCallback(lue(e),[e]),Ut)}const due=e=>e.updateNodeInternals;function fue(){const e=Ye(due),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function pue({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Lt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,f=s.current!==e.sourcePosition,p=c.current!==e.targetPosition;(d||f||p)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function hue({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:m,rfId:y,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:j}){const{node:x,internals:_,isParent:S}=Ye(K=>{const W=K.nodeLookup.get(e),Y=K.parentLookup.has(e);return{node:W,internals:W.internals,isParent:Y}},Ut);let E=x.type||"default",O=(v==null?void 0:v[E])||W5[E];O===void 0&&(j==null||j("003",Po.error003(E)),E="default",O=W5.default);const M=!!(x.draggable||s&&typeof x.draggable>"u"),C=!!(x.selectable||c&&typeof x.selectable>"u"),k=!!(x.connectable||l&&typeof x.connectable>"u"),T=!!(x.focusable||u&&typeof x.focusable>"u"),P=Lt(),N=B4(x),I=pue({node:x,nodeType:E,hasDimensions:N,resizeObserver:d}),A=V5({nodeRef:I,disabled:x.hidden||!M,noDragClassName:f,handleSelector:x.dragHandle,nodeId:e,isSelectable:C,nodeClickDistance:w}),R=q5();if(x.hidden)return null;const L=Ao(x),D=aue(x),B=C||M||t||n||r||a,F=n?K=>n(K,{..._.userNode}):void 0,$=r?K=>r(K,{..._.userNode}):void 0,z=a?K=>a(K,{..._.userNode}):void 0,X=o?K=>o(K,{..._.userNode}):void 0,G=i?K=>i(K,{..._.userNode}):void 0,q=K=>{const{selectNodesOnDrag:W,nodeDragThreshold:Y}=P.getState();C&&(!W||!M||Y>0)&&A_({id:e,store:P,nodeRef:I}),t&&t(K,{..._.userNode})},J=K=>{if(!(g_(K.nativeEvent)||m))if(O4.includes(K.key)&&C){const W=K.key==="Escape";A_({id:e,store:P,unselect:W,nodeRef:I})}else M&&x.selected&&Object.prototype.hasOwnProperty.call(ym,K.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~_.positionAbsolute.x}, y: ${~~_.positionAbsolute.y}`}),R({direction:ym[K.key],factor:K.shiftKey?4:1}))};return h.jsx("div",{className:rn(["react-flow__node",`react-flow__node-${E}`,{[p]:M},x.className,{selected:x.selected,selectable:C,parent:S,draggable:M,dragging:A}]),ref:I,style:{zIndex:_.z,transform:`translate(${_.positionAbsolute.x}px,${_.positionAbsolute.y}px)`,pointerEvents:B?"all":"none",visibility:N?"visible":"hidden",...x.style,...D},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:$,onMouseLeave:z,onContextMenu:X,onClick:q,onDoubleClick:G,onKeyDown:T?J:void 0,tabIndex:T?0:void 0,role:T?"button":void 0,"aria-describedby":m?void 0:`${O5}-${y}`,"aria-label":x.ariaLabel,children:h.jsx(Xle,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:_.positionAbsolute.x,positionAbsoluteY:_.positionAbsolute.y,selected:x.selected,selectable:C,draggable:M,deletable:x.deletable??!0,isConnectable:k,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:A,dragHandle:x.dragHandle,zIndex:_.z,parentId:x.parentId,...L})})})}const mue=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Z5(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=Ye(mue,Ut),i=uue(e.onlyRenderVisibleElements),s=fue();return h.jsx("div",{className:"react-flow__nodes",style:mm,children:i.map(c=>h.jsx(hue,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}Z5.displayName="NodeRenderer";const yue=g.memo(Z5);function gue(e){return Ye(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&Sce({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),Ut)}const vue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),bue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),G5={[rm.Arrow]:vue,[rm.ArrowClosed]:bue};function wue(e){const t=Lt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(G5,e)?G5[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",Po.error009(e)),null)},[e])}const xue=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=wue(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},X5=({defaultColor:e,rfId:t})=>{const n=Ye(o=>o.edges),r=Ye(o=>o.defaultEdgeOptions),a=g.useMemo(()=>Pce(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(xue,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};X5.displayName="MarkerDefinitions";var _ue=g.memo(X5);function J5({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,f]=g.useState({x:1,y:0,width:0,height:0}),p=rn(["react-flow__edge-textwrapper",l]),m=g.useRef(null);return g.useEffect(()=>{if(m.current){const y=m.current.getBBox();f({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:m,style:r,children:n}),c]})}J5.displayName="EdgeText";const jue=g.memo(J5);function gm({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,className:p,interactionWidth:m=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:rn(["react-flow__edge-path",p]),markerEnd:d,markerStart:f}),m&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),a&&ra(n)&&ra(r)?h.jsx(jue,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function Y5({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===he.Left||e===he.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function Q5({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top}){const[i,s]=Y5({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=Y5({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,f,p]=W4({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,f,p]}function eL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:b})=>{const[w,j,x]=Q5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),_=e.isInternal?void 0:t;return h.jsx(gm,{id:_,path:w,labelX:j,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:b})})}const Sue=eL({isInternal:!1}),tL=eL({isInternal:!0});Sue.displayName="SimpleBezierEdge",tL.displayName="SimpleBezierEdgeInternal";function nL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:p=he.Bottom,targetPosition:m=he.Top,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[j,x,_]=v_({sourceX:n,sourceY:r,sourcePosition:p,targetX:a,targetY:o,targetPosition:m,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),S=e.isInternal?void 0:t;return h.jsx(gm,{id:S,path:j,labelX:x,labelY:_,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:v,interactionWidth:w})})}const rL=nL({isInternal:!1}),aL=nL({isInternal:!0});rL.displayName="SmoothStepEdge",aL.displayName="SmoothStepEdgeInternal";function oL(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(rL,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Eue=oL({isInternal:!1}),iL=oL({isInternal:!0});Eue.displayName="StepEdge",iL.displayName="StepEdgeInternal";function sL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:y})=>{const[v,b,w]=X4({sourceX:n,sourceY:r,targetX:a,targetY:o}),j=e.isInternal?void 0:t;return h.jsx(gm,{id:j,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:y})})}const Oue=sL({isInternal:!1}),cL=sL({isInternal:!0});Oue.displayName="StraightEdge",cL.displayName="StraightEdgeInternal";function lL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[j,x,_]=K4({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return h.jsx(gm,{id:S,path:j,labelX:x,labelY:_,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:w})})}const Cue=lL({isInternal:!1}),uL=lL({isInternal:!0});Cue.displayName="BezierEdge",uL.displayName="BezierEdgeInternal";const dL={default:uL,straight:cL,step:iL,smoothstep:aL,simplebezier:tL},fL={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Nue=(e,t,n)=>n===he.Left?e-t:n===he.Right?e+t:e,Mue=(e,t,n)=>n===he.Top?e-t:n===he.Bottom?e+t:e,pL="react-flow__edgeupdater";function hL({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:rn([pL,`${pL}-${s}`]),cx:Nue(t,r,e),cy:Mue(n,r,e),r,stroke:"transparent",fill:"transparent"})}function kue({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){const m=Lt(),y=(x,_)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:E,isValidConnection:O,connectionMode:M,connectionRadius:C,lib:k,onConnectStart:T,onConnectEnd:P,cancelConnection:N,nodeLookup:I,rfId:A,panBy:R,updateConnection:L}=m.getState(),D=_.type==="target";f(!0),u==null||u(x,n,_.type);const B=($,z)=>{f(!1),d==null||d($,n,_.type,z)},F=$=>l==null?void 0:l(n,$);O_.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:M,connectionRadius:C,domNode:E,handleId:_.id,nodeId:_.nodeId,nodeLookup:I,isTarget:D,edgeUpdaterType:_.type,lib:k,flowId:A,cancelConnection:N,panBy:R,isValidConnection:O,onConnect:F,onConnectStart:T,onConnectEnd:P,onReconnectEnd:B,updateConnection:L,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle})},v=x=>y(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>y(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),j=()=>p(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(hL,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:j,type:"source"}),(e===!0||e==="target")&&h.jsx(hL,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:j,type:"target"})]})}function Pue({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,rfId:m,edgeTypes:y,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let j=Ye(U=>U.edgeLookup.get(e));const x=Ye(U=>U.defaultEdgeOptions);j=x?{...x,...j}:j;let _=j.type||"default",S=(y==null?void 0:y[_])||dL[_];S===void 0&&(b==null||b("011",Po.error011(_)),_="default",S=dL.default);const E=!!(j.focusable||t&&typeof j.focusable>"u"),O=typeof d<"u"&&(j.reconnectable||n&&typeof j.reconnectable>"u"),M=!!(j.selectable||r&&typeof j.selectable>"u"),C=g.useRef(null),[k,T]=g.useState(!1),[P,N]=g.useState(!1),I=Lt(),{zIndex:A,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$}=Ye(g.useCallback(U=>{const ce=U.nodeLookup.get(j.source),ae=U.nodeLookup.get(j.target);if(!ce||!ae)return{zIndex:j.zIndex,...fL};const ue=kce({id:e,sourceNode:ce,targetNode:ae,sourceHandle:j.sourceHandle||null,targetHandle:j.targetHandle||null,connectionMode:U.connectionMode,onError:b});return{zIndex:jce({selected:j.selected,zIndex:j.zIndex,sourceNode:ce,targetNode:ae,elevateOnSelect:U.elevateEdgesOnSelect}),...ue||fL}},[j.source,j.target,j.sourceHandle,j.targetHandle,j.selected,j.zIndex]),Ut),z=g.useMemo(()=>j.markerStart?`url('#${b_(j.markerStart,m)}')`:void 0,[j.markerStart,m]),X=g.useMemo(()=>j.markerEnd?`url('#${b_(j.markerEnd,m)}')`:void 0,[j.markerEnd,m]);if(j.hidden||R===null||L===null||D===null||B===null)return null;const G=U=>{var je;const{addSelectedEdges:ce,unselectNodesAndEdges:ae,multiSelectionActive:ue}=I.getState();M&&(I.setState({nodesSelectionActive:!1}),j.selected&&ue?(ae({nodes:[],edges:[j]}),(je=C.current)==null||je.blur()):ce([e])),a&&a(U,j)},q=o?U=>{o(U,{...j})}:void 0,J=i?U=>{i(U,{...j})}:void 0,K=s?U=>{s(U,{...j})}:void 0,W=c?U=>{c(U,{...j})}:void 0,Y=l?U=>{l(U,{...j})}:void 0,re=U=>{var ce;if(!w&&O4.includes(U.key)&&M){const{unselectNodesAndEdges:ae,addSelectedEdges:ue}=I.getState();U.key==="Escape"?((ce=C.current)==null||ce.blur(),ae({edges:[j]})):ue([e])}};return h.jsx("svg",{style:{zIndex:A},children:h.jsxs("g",{className:rn(["react-flow__edge",`react-flow__edge-${_}`,j.className,v,{selected:j.selected,animated:j.animated,inactive:!M&&!a,updating:k,selectable:M}]),onClick:G,onDoubleClick:q,onContextMenu:J,onMouseEnter:K,onMouseMove:W,onMouseLeave:Y,onKeyDown:E?re:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":j.ariaLabel===null?void 0:j.ariaLabel||`Edge from ${j.source} to ${j.target}`,"aria-describedby":E?`${C5}-${m}`:void 0,ref:C,children:[!P&&h.jsx(S,{id:e,source:j.source,target:j.target,type:j.type,selected:j.selected,animated:j.animated,selectable:M,deletable:j.deletable??!0,label:j.label,labelStyle:j.labelStyle,labelShowBg:j.labelShowBg,labelBgStyle:j.labelBgStyle,labelBgPadding:j.labelBgPadding,labelBgBorderRadius:j.labelBgBorderRadius,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,data:j.data,style:j.style,sourceHandleId:j.sourceHandle,targetHandleId:j.targetHandle,markerStart:z,markerEnd:X,pathOptions:"pathOptions"in j?j.pathOptions:void 0,interactionWidth:j.interactionWidth}),O&&h.jsx(kue,{edge:j,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,setUpdateHover:T,setReconnecting:N})]})})}const Aue=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function mL({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:j}=Ye(Aue,Ut),x=gue(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(_ue,{defaultColor:e,rfId:n}),x.map(_=>h.jsx(Pue,{id:_,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:j,edgeTypes:r,disableKeyboardA11y:y},_))]})}mL.displayName="EdgeRenderer";const Tue=g.memo(mL),Iue=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Rue({children:e}){const t=Ye(Iue);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Due(e){const t=br(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Lue=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function $ue(e){const t=Ye(Lue),n=Lt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Fue(e){return e.connection.inProgress?{...e.connection,to:bd(e.connection.to,e.transform)}:{...e.connection}}function Bue(e){return Fue}function zue(e){const t=Bue();return Ye(t,Ut)}const Uue=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Vue({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=Ye(Uue,Ut);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:rn(["react-flow__connection",k4(s)]),children:h.jsx(yL,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const yL=({style:e,type:t=mi.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=zue();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:k4(r),toNode:u,toHandle:d});let p="";const m={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case mi.Bezier:[p]=K4(m);break;case mi.SimpleBezier:[p]=Q5(m);break;case mi.Step:[p]=v_({...m,borderRadius:0});break;case mi.SmoothStep:[p]=v_(m);break;default:[p]=X4(m)}return h.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};yL.displayName="ConnectionLine";const que={};function gL(e=que){g.useRef(e),Lt(),g.useEffect(()=>{},[e])}function Wue(){Lt(),g.useRef(!1),g.useEffect(()=>{},[])}function vL({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:j,selectionMode:x,multiSelectionKeyCode:_,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:M,elementsSelectable:C,defaultViewport:k,translateExtent:T,minZoom:P,maxZoom:N,preventScrolling:I,defaultMarkerColor:A,zoomOnScroll:R,zoomOnPinch:L,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,zoomOnDoubleClick:$,panOnDrag:z,onPaneClick:X,onPaneMouseEnter:G,onPaneMouseMove:q,onPaneMouseLeave:J,onPaneScroll:K,onPaneContextMenu:W,paneClickDistance:Y,nodeClickDistance:re,onEdgeContextMenu:U,onEdgeMouseEnter:ce,onEdgeMouseMove:ae,onEdgeMouseLeave:ue,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,noDragClassName:Ue,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:It,nodeExtent:lt,rfId:ot,viewport:_t,onViewportChange:Yt}){return gL(e),gL(t),Wue(),Due(n),$ue(_t),h.jsx(cue,{onPaneClick:X,onPaneMouseEnter:G,onPaneMouseMove:q,onPaneMouseLeave:J,onPaneContextMenu:W,onPaneScroll:K,paneClickDistance:Y,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:j,selectionMode:x,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:_,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:C,zoomOnScroll:R,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,panOnDrag:z,defaultViewport:k,translateExtent:T,minZoom:P,maxZoom:N,onSelectionContextMenu:d,preventScrolling:I,noDragClassName:Ue,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:It,onViewportChange:Yt,isControlledViewport:!!_t,children:h.jsxs(Rue,{children:[h.jsx(Tue,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,onlyRenderVisibleElements:M,onEdgeContextMenu:U,onEdgeMouseEnter:ce,onEdgeMouseMove:ae,onEdgeMouseLeave:ue,reconnectRadius:je,defaultMarkerColor:A,noPanClassName:He,disableKeyboardA11y:It,rfId:ot}),h.jsx(Vue,{style:y,type:m,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(yue,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:re,onlyRenderVisibleElements:M,noPanClassName:He,noDragClassName:Ue,disableKeyboardA11y:It,nodeExtent:lt,rfId:ot}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}vL.displayName="GraphView";const Hue=g.memo(vL),bL=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,p=r??t??[],m=n??e??[],y=s??[0,0],v=c??hd;r5(d,f,p),__(m,l,u,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=gd(l,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:j,y:x,zoom:_}=y_(w,a,o,.5,2,.1);b=[j,x,_]}return{rfId:"1",width:0,height:0,transform:b,nodes:m,nodeLookup:l,parentLookup:u,edges:p,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:hd,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:jc.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...C4},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:xce,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Kue=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>fle((l,u)=>({...bL({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:p,nodeOrigin:m,elevateNodesOnSelect:y}=u();__(d,f,p,{nodeOrigin:m,nodeExtent:c,elevateNodesOnSelect:y,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:p}=u();r5(f,p,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:p}=u();p(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:p}=u();p(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:p,nodeLookup:m,parentLookup:y,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:j,nodeOrigin:x,nodeExtent:_,debug:S,fitViewSync:E}=u(),{changes:O,updatedInternals:M}=Dce(d,m,y,j,x,_);if(M){if(Tce(m,y,{nodeOrigin:x,nodeExtent:_}),f.triggerFitView){let C=b;!b&&v&&(C=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:C})}else l({});(O==null?void 0:O.length)>0&&(S&&console.log("React Flow: trigger node changes",O),p==null||p(O))}},updateNodePositions:(d,f=!1)=>{const p=[],m=[];for(const[y,v]of d){const b={id:y,type:"position",position:v.position,dragging:f};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(p.push({id:y,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),m.push(b)}if(p.length>0){const{nodeLookup:y,parentLookup:v,nodeOrigin:b}=u(),w=S_(p,y,v,b);m.push(...w)}u().triggerNodeChanges(m)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:p,nodes:m,hasDefaultNodes:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=ls(d,m);p(b)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:p,edges:m,hasDefaultEdges:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=jd(d,m);p(b)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>us(w,!0));y(b);return}y(kc(m,new Set([...d]),!0)),v(kc(p))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>us(w,!0));v(b);return}v(kc(p,new Set([...d]))),y(kc(m,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:p,nodes:m,nodeLookup:y,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||m,j=f||p,x=w.map(S=>{const E=y.get(S.id);return E&&(E.selected=!1),us(S.id,!1)}),_=j.map(S=>us(S.id,!1));v(x),b(_)},setMinZoom:d=>{const{panZoom:f,maxZoom:p}=u();f==null||f.setScaleExtent([d,p]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:p}=u();f==null||f.setScaleExtent([p,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:p,triggerEdgeChanges:m}=u(),y=f.reduce((b,w)=>w.selected?[...b,us(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,us(w.id,!1)]:b,[]);p(y),m(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:p,parentLookup:m,nodeOrigin:y,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(__(f,p,m,{nodeOrigin:y,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:p,height:m,panZoom:y,translateExtent:v}=u();return Lce({delta:d,panZoom:y,transform:f,translateExtent:v,width:p,height:m})},fitView:d=>{const{panZoom:f,width:p,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!f)return Promise.resolve(!1);const w=p_(b,d);return h_({nodes:w,width:p,height:m,panZoom:f,minZoom:y,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:p,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!f)return!1;const w=p_(b,d);return h_({nodes:w,width:p,height:m,panZoom:f,minZoom:y,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...C4}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...bL()})}),Object.is);function Zue({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>Kue({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(ple,{value:u,children:h.jsx(Dle,{children:l})})}function Gue({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(pm)?h.jsx(h.Fragment,{children:e}):h.jsx(Zue,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const Xue={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Jue({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:j,onNodeMouseLeave:x,onNodeContextMenu:_,onNodeDoubleClick:S,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onNodesDelete:C,onEdgesDelete:k,onDelete:T,onSelectionChange:P,onSelectionDragStart:N,onSelectionDrag:I,onSelectionDragStop:A,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onBeforeDelete:B,connectionMode:F,connectionLineType:$=mi.Bezier,connectionLineStyle:z,connectionLineComponent:X,connectionLineContainerStyle:G,deleteKeyCode:q="Backspace",selectionKeyCode:J="Shift",selectionOnDrag:K=!1,selectionMode:W=md.Full,panActivationKeyCode:Y="Space",multiSelectionKeyCode:re=cm()?"Meta":"Control",zoomActivationKeyCode:U=cm()?"Meta":"Control",snapToGrid:ce,snapGrid:ae,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,nodeOrigin:Ue=N5,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:It=!0,defaultViewport:lt=Ole,minZoom:ot=.5,maxZoom:_t=2,translateExtent:Yt=hd,preventScrolling:ir=!0,nodeExtent:no,defaultMarkerColor:sr="#b1b1b7",zoomOnScroll:ro=!0,zoomOnPinch:Q=!0,panOnScroll:ne=!1,panOnScrollSpeed:le=.5,panOnScrollMode:me=hi.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Zt=!0,onPaneClick:Bt,onPaneMouseEnter:Ze,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ve=0,nodeClickDistance:Mt=0,children:qt,onReconnect:V,onReconnectStart:ee,onReconnectEnd:oe,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:Pe=10,onNodesChange:we,onEdgesChange:ze,noDragClassName:Qe="nodrag",noWheelClassName:Dt="nowheel",noPanClassName:zt="nopan",fitView:it,fitViewOptions:cr,connectOnClick:Qt,attributionPosition:Bs,proOptions:Na,defaultEdgeOptions:zi,elevateNodesOnSelect:ao,elevateEdgesOnSelect:fp,disableKeyboardA11y:Fr=!1,autoPanOnConnect:Gl,autoPanOnNodeDrag:Xl,autoPanSpeed:Jl,connectionRadius:ht,isValidConnection:lr,onError:zs,style:Wt,id:ei,nodeDragThreshold:vv,viewport:kM,onViewportChange:iDe,width:sDe,height:cDe,colorMode:lDe="light",debug:uDe,...dDe},fDe){const PM=ei||"1",pDe=kle(lDe);return h.jsx("div",{...dDe,style:{...Wt,...Xue},ref:fDe,className:rn(["react-flow",a,pDe]),"data-testid":"rf__wrapper",id:ei,children:h.jsxs(Gue,{nodes:e,edges:t,width:sDe,height:cDe,fitView:it,nodeOrigin:Ue,nodeExtent:no,children:[h.jsx(Hue,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:j,onNodeMouseLeave:x,onNodeContextMenu:_,onNodeDoubleClick:S,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:z,connectionLineComponent:X,connectionLineContainerStyle:G,selectionKeyCode:J,selectionOnDrag:K,selectionMode:W,deleteKeyCode:q,multiSelectionKeyCode:re,panActivationKeyCode:Y,zoomActivationKeyCode:U,onlyRenderVisibleElements:ue,defaultViewport:lt,translateExtent:Yt,minZoom:ot,maxZoom:_t,preventScrolling:ir,zoomOnScroll:ro,zoomOnPinch:Q,zoomOnDoubleClick:Te,panOnScroll:ne,panOnScrollSpeed:le,panOnScrollMode:me,panOnDrag:Zt,onPaneClick:Bt,onPaneMouseEnter:Ze,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ve,nodeClickDistance:Mt,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onReconnect:V,onReconnectStart:ee,onReconnectEnd:oe,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:Pe,defaultMarkerColor:sr,noDragClassName:Qe,noWheelClassName:Dt,noPanClassName:zt,rfId:PM,disableKeyboardA11y:Fr,nodeExtent:no,viewport:kM,onViewportChange:iDe}),h.jsx(Mle,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:It,elevateNodesOnSelect:ao,elevateEdgesOnSelect:fp,minZoom:ot,maxZoom:_t,nodeExtent:no,onNodesChange:we,onEdgesChange:ze,snapToGrid:ce,snapGrid:ae,connectionMode:F,translateExtent:Yt,connectOnClick:Qt,defaultEdgeOptions:zi,fitView:it,fitViewOptions:cr,onNodesDelete:C,onEdgesDelete:k,onDelete:T,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onSelectionDrag:I,onSelectionDragStart:N,onSelectionDragStop:A,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:zt,nodeOrigin:Ue,rfId:PM,autoPanOnConnect:Gl,autoPanOnNodeDrag:Xl,autoPanSpeed:Jl,onError:zs,connectionRadius:ht,isValidConnection:lr,selectNodesOnDrag:je,nodeDragThreshold:vv,onBeforeDelete:B,paneClickDistance:Ve,debug:uDe}),h.jsx(Ele,{onSelectionChange:P}),qt,h.jsx(wle,{proOptions:Na,position:Bs}),h.jsx(vle,{rfId:PM,disableKeyboardA11y:Fr})]})})}var Yue=F5(Jue);const Que=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function ede({children:e}){const t=Ye(Que);return t?Ql.createPortal(e,t):null}const tde=e=>e.nodes;function nde(){return Ye(tde,Ut)}function vm({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=I_(),i=n??o,s=g.useRef(null),c=Ye(l=>l.connectionLookup.get(`${i}-${e}-${t}`),yce);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;M4(s.current,l,a),M4(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Bn=function(e){return Ye(g.useCallback(t=>t.nodeLookup.get(e),[e]),Ut)};function rde({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:rn(["react-flow__background-pattern",n,r])})}function ade({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:rn(["react-flow__background-pattern","dots",t])})}var Io;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Io||(Io={}));const ode={[Io.Dots]:1,[Io.Lines]:1,[Io.Cross]:6},ide=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function wL({id:e,variant:t=Io.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:f,patternId:p}=Ye(ide,Ut),m=r||ode[t],y=t===Io.Dots,v=t===Io.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*f[2]||1,b[1]*f[2]||1],j=m*f[2],x=Array.isArray(o)?o:[o,o],_=v?[j,j]:w,S=[x[0]*f[2]||1+_[0]/2,x[1]*f[2]||1+_[1]/2],E=`${p}${e||""}`;return h.jsxs("svg",{className:rn(["react-flow__background",l]),style:{...c,...mm,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:y?h.jsx(ade,{radius:j/2,className:u}):h.jsx(rde,{dimensions:_,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}wL.displayName="Background";const sde=g.memo(wL);function cde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function lde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function ude(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function dde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function fde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function bm({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:rn(["react-flow__controls-button",t]),...n,children:e})}const pde=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function xL({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":p="React Flow controls"}){const m=Lt(),{isInteractive:y,minZoomReached:v,maxZoomReached:b}=Ye(pde,Ut),{zoomIn:w,zoomOut:j,fitView:x}=br(),_=()=>{w(),o==null||o()},S=()=>{j(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)},M=f==="horizontal"?"horizontal":"vertical";return h.jsxs(Mc,{className:rn(["react-flow__controls",M,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":p,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(bm,{onClick:_,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(cde,{})}),h.jsx(bm,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(lde,{})})]}),n&&h.jsx(bm,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx(ude,{})}),r&&h.jsx(bm,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:y?h.jsx(fde,{}):h.jsx(dde,{})}),u]})}xL.displayName="Controls";const hde=g.memo(xL);function mde({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:p}){const{background:m,backgroundColor:y}=o||{},v=i||m||y;return h.jsx("rect",{className:rn(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:p?b=>p(b,e):void 0})}const yde=g.memo(mde),gde=e=>e.nodes.map(t=>t.id),R_=e=>e instanceof Function?e:()=>e;function vde({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=yde,onClick:i}){const s=Ye(gde,Ut),c=R_(t),l=R_(e),u=R_(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(f=>h.jsx(wde,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},f))})}function bde({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:f,height:p}=Ye(m=>{const y=m.nodeLookup.get(e),{x:v,y:b}=y.internals.positionAbsolute,{width:w,height:j}=Ao(y);return{node:y,x:v,y:b,width:w,height:j}},Ut);return!l||l.hidden||!B4(l)?null:h.jsx(s,{x:u,y:d,width:f,height:p,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const wde=g.memo(bde);var xde=g.memo(vde);const _de=200,jde=150,Sde=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?L4(gd(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Ede="react-flow__minimap-desc";function _L({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:p,onNodeClick:m,pannable:y=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:j=10,offsetScale:x=5}){const _=Lt(),S=g.useRef(null),{boundingRect:E,viewBB:O,rfId:M,panZoom:C,translateExtent:k,flowWidth:T,flowHeight:P}=Ye(Sde,Ut),N=(e==null?void 0:e.width)??_de,I=(e==null?void 0:e.height)??jde,A=E.width/N,R=E.height/I,L=Math.max(A,R),D=L*N,B=L*I,F=x*L,$=E.x-(D-E.width)/2-F,z=E.y-(B-E.height)/2-F,X=D+F*2,G=B+F*2,q=`${Ede}-${M}`,J=g.useRef(0),K=g.useRef();J.current=L,g.useEffect(()=>{if(S.current&&C)return K.current=Wce({domNode:S.current,panZoom:C,getTransform:()=>_.getState().transform,getViewScale:()=>J.current}),()=>{var re;(re=K.current)==null||re.destroy()}},[C]),g.useEffect(()=>{var re;(re=K.current)==null||re.update({translateExtent:k,width:T,height:P,inversePan:w,pannable:y,zoomStep:j,zoomable:v})},[y,v,w,j,k,T,P]);const W=p?re=>{var ae;const[U,ce]=((ae=K.current)==null?void 0:ae.pointer(re))||[0,0];p(re,{x:U,y:ce})}:void 0,Y=m?g.useCallback((re,U)=>{const ce=_.getState().nodeLookup.get(U);m(re,ce)},[]):void 0;return h.jsx(Mc,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:rn(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:N,height:I,viewBox:`${$} ${z} ${X} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":q,ref:S,onClick:W,children:[b&&h.jsx("title",{id:q,children:b}),h.jsx(xde,{onClick:Y,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-F},${z-F}h${X+F*2}v${G+F*2}h${-X-F*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}_L.displayName="MiniMap";const Ode=g.memo(_L);function Cde({nodeId:e,position:t,variant:n=Nc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:m,onResizeEnd:y}){const v=I_(),b=typeof e=="string"?e:v,w=Lt(),j=g.useRef(null),x=n===Nc.Line?"right":"bottom-right",_=t??x,S=g.useRef(null);g.useEffect(()=>{if(!(!j.current||!b))return S.current||(S.current=cle({domNode:j.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:C,transform:k,snapGrid:T,snapToGrid:P,nodeOrigin:N,domNode:I}=w.getState();return{nodeLookup:C,transform:k,snapGrid:T,snapToGrid:P,nodeOrigin:N,paneDomNode:I}},onChange:(C,k)=>{const{triggerNodeChanges:T,nodeLookup:P,parentLookup:N,nodeOrigin:I}=w.getState(),A=[],R={x:C.x,y:C.y},L=P.get(b);if(L&&L.expandParent&&L.parentId){const D=L.origin??I,B=C.width??L.measured.width,F=C.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:B,height:F,...z4({x:C.x??L.position.x,y:C.y??L.position.y},{width:B,height:F},L.parentId,P,D)}},z=S_([$],P,N,I);A.push(...z),R.x=C.x?Math.max(D[0]*B,C.x):void 0,R.y=C.y?Math.max(D[1]*F,C.y):void 0}if(R.x!==void 0&&R.y!==void 0){const D={id:b,type:"position",position:{...R}};A.push(D)}if(C.width!==void 0&&C.height!==void 0){const D={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:C.width,height:C.height}};A.push(D)}for(const D of k){const B={...D,type:"position"};A.push(B)}T(A)},onEnd:()=>{const C={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([C])}})),S.current.update({controlPosition:_,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:p,onResize:m,onResizeEnd:y,shouldResize:f}),()=>{var C;(C=S.current)==null||C.destroy()}},[_,s,c,l,u,d,p,m,y,f]);const E=_.split("-"),O=n===Nc.Line?"borderColor":"backgroundColor",M=i?{...a,[O]:i}:a;return h.jsx("div",{className:rn(["react-flow__resize-control","nodrag",...E,n,r]),ref:j,style:M,children:o})}const jL=g.memo(Cde);function Nde({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:m,onResizeEnd:y}){return t?h.jsxs(h.Fragment,{children:[tle.map(v=>h.jsx(jL,{className:a,style:o,nodeId:e,position:v,variant:Nc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:m,onResizeEnd:y},v)),ele.map(v=>h.jsx(jL,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:m,onResizeEnd:y},v))]}):null}var D_,SL;function Mde(){if(SL)return D_;SL=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?y(i(b),b,w):b}function c(b,w,j){return b.concat(w).map(function(x){return s(x,j)})}function l(b,w){if(!w.customMerge)return y;var j=w.customMerge(b);return typeof j=="function"?j:y}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function f(b,w){try{return w in b}catch{return!1}}function p(b,w){return f(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function m(b,w,j){var x={};return j.isMergeableObject(b)&&d(b).forEach(function(_){x[_]=s(b[_],j)}),d(w).forEach(function(_){p(b,_)||(f(b,_)&&j.isMergeableObject(w[_])?x[_]=l(_,j)(b[_],w[_],j):x[_]=s(w[_],j))}),x}function y(b,w,j){j=j||{},j.arrayMerge=j.arrayMerge||c,j.isMergeableObject=j.isMergeableObject||e,j.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),_=Array.isArray(b),S=x===_;return S?x?j.arrayMerge(b,w,j):m(b,w,j):s(w,j)}y.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(j,x){return y(j,x,w)},{})};var v=y;return D_=v,D_}var kde=Mde();const wm=st(kde);var EL={},OL;function Pde(){if(OL)return EL;OL=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof tu=="object"?tu:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,f){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:f}),u&&u(d,f)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return ro(Object.create(null))}:l?function(){return ro({__proto__:null})}:function(){return ro({})},has:u?function(Q,ne){return a.call(Q,ne)}:function(Q,ne){return ne in Q},get:u?function(Q,ne){return a.call(Q,ne)?Q[ne]:void 0}:function(Q,ne){return Q[ne]}},f=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ir(),m=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:no(),y=typeof WeakMap=="function"?WeakMap:sr(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=lt(),w=ot(b);function j(Q,ne,le,me){if(z(le)){if(!U(Q))throw new TypeError;if(!ae(ne))throw new TypeError;return P(Q,ne)}else{if(!U(Q))throw new TypeError;if(!q(ne))throw new TypeError;if(!q(me)&&!z(me)&&!X(me))throw new TypeError;return X(me)&&(me=void 0),le=re(le),N(Q,ne,le,me)}}n("decorate",j);function x(Q,ne){function le(me,Te){if(!q(me))throw new TypeError;if(!z(Te)&&!ue(Te))throw new TypeError;D(Q,ne,me,Te)}return le}n("metadata",x);function _(Q,ne,le,me){if(!q(le))throw new TypeError;return z(me)||(me=re(me)),D(Q,ne,le,me)}n("defineMetadata",_);function S(Q,ne,le){if(!q(ne))throw new TypeError;return z(le)||(le=re(le)),I(Q,ne,le)}n("hasMetadata",S);function E(Q,ne,le){if(!q(ne))throw new TypeError;return z(le)||(le=re(le)),A(Q,ne,le)}n("hasOwnMetadata",E);function O(Q,ne,le){if(!q(ne))throw new TypeError;return z(le)||(le=re(le)),R(Q,ne,le)}n("getMetadata",O);function M(Q,ne,le){if(!q(ne))throw new TypeError;return z(le)||(le=re(le)),L(Q,ne,le)}n("getOwnMetadata",M);function C(Q,ne){if(!q(Q))throw new TypeError;return z(ne)||(ne=re(ne)),B(Q,ne)}n("getMetadataKeys",C);function k(Q,ne){if(!q(Q))throw new TypeError;return z(ne)||(ne=re(ne)),F(Q,ne)}n("getOwnMetadataKeys",k);function T(Q,ne,le){if(!q(ne))throw new TypeError;if(z(le)||(le=re(le)),!q(ne))throw new TypeError;z(le)||(le=re(le));var me=Yt(ne,le,!1);return z(me)?!1:me.OrdinaryDeleteMetadata(Q,ne,le)}n("deleteMetadata",T);function P(Q,ne){for(var le=Q.length-1;le>=0;--le){var me=Q[le],Te=me(ne);if(!z(Te)&&!X(Te)){if(!ae(Te))throw new TypeError;ne=Te}}return ne}function N(Q,ne,le,me){for(var Te=Q.length-1;Te>=0;--Te){var Zt=Q[Te],Bt=Zt(ne,le,me);if(!z(Bt)&&!X(Bt)){if(!q(Bt))throw new TypeError;me=Bt}}return me}function I(Q,ne,le){var me=A(Q,ne,le);if(me)return!0;var Te=He(ne);return X(Te)?!1:I(Q,Te,le)}function A(Q,ne,le){var me=Yt(ne,le,!1);return z(me)?!1:W(me.OrdinaryHasOwnMetadata(Q,ne,le))}function R(Q,ne,le){var me=A(Q,ne,le);if(me)return L(Q,ne,le);var Te=He(ne);if(!X(Te))return R(Q,Te,le)}function L(Q,ne,le){var me=Yt(ne,le,!1);if(!z(me))return me.OrdinaryGetOwnMetadata(Q,ne,le)}function D(Q,ne,le,me){var Te=Yt(le,me,!0);Te.OrdinaryDefineOwnMetadata(Q,ne,le,me)}function B(Q,ne){var le=F(Q,ne),me=He(Q);if(me===null)return le;var Te=B(me,ne);if(Te.length<=0)return le;if(le.length<=0)return Te;for(var Zt=new m,Bt=[],Ze=0,be=le;Ze<be.length;Ze++){var _e=be[Ze],Ee=Zt.has(_e);Ee||(Zt.add(_e),Bt.push(_e))}for(var Oe=0,Ve=Te;Oe<Ve.length;Oe++){var _e=Ve[Oe],Ee=Zt.has(_e);Ee||(Zt.add(_e),Bt.push(_e))}return Bt}function F(Q,ne){var le=Yt(Q,ne,!1);return le?le.OrdinaryOwnMetadataKeys(Q,ne):[]}function $(Q){if(Q===null)return 1;switch(typeof Q){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Q===null?1:6;default:return 6}}function z(Q){return Q===void 0}function X(Q){return Q===null}function G(Q){return typeof Q=="symbol"}function q(Q){return typeof Q=="object"?Q!==null:typeof Q=="function"}function J(Q,ne){switch($(Q)){case 0:return Q;case 1:return Q;case 2:return Q;case 3:return Q;case 4:return Q;case 5:return Q}var le="string",me=Le(Q,i);if(me!==void 0){var Te=me.call(Q,le);if(q(Te))throw new TypeError;return Te}return K(Q)}function K(Q,ne){var le,me;{var Te=Q.toString;if(ce(Te)){var me=Te.call(Q);if(!q(me))return me}var le=Q.valueOf;if(ce(le)){var me=le.call(Q);if(!q(me))return me}}throw new TypeError}function W(Q){return!!Q}function Y(Q){return""+Q}function re(Q){var ne=J(Q);return G(ne)?ne:Y(ne)}function U(Q){return Array.isArray?Array.isArray(Q):Q instanceof Object?Q instanceof Array:Object.prototype.toString.call(Q)==="[object Array]"}function ce(Q){return typeof Q=="function"}function ae(Q){return typeof Q=="function"}function ue(Q){switch($(Q)){case 3:return!0;case 4:return!0;default:return!1}}function je(Q,ne){return Q===ne||Q!==Q&&ne!==ne}function Le(Q,ne){var le=Q[ne];if(le!=null){if(!ce(le))throw new TypeError;return le}}function $e(Q){var ne=Le(Q,s);if(!ce(ne))throw new TypeError;var le=ne.call(Q);if(!q(le))throw new TypeError;return le}function Se(Q){return Q.value}function Ue(Q){var ne=Q.next();return ne.done?!1:ne}function We(Q){var ne=Q.return;ne&&ne.call(Q)}function He(Q){var ne=Object.getPrototypeOf(Q);if(typeof Q!="function"||Q===f||ne!==f)return ne;var le=Q.prototype,me=le&&Object.getPrototypeOf(le);if(me==null||me===Object.prototype)return ne;var Te=me.constructor;return typeof Te!="function"||Te===Q?ne:Te}function It(){var Q;!z(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Q=_t(r.Reflect));var ne,le,me,Te=new y,Zt={registerProvider:Bt,getProvider:be,setProvider:Ee};return Zt;function Bt(Oe){if(!Object.isExtensible(Zt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Q===Oe:break;case z(ne):ne=Oe;break;case ne===Oe:break;case z(le):le=Oe;break;case le===Oe:break;default:me===void 0&&(me=new m),me.add(Oe);break}}function Ze(Oe,Ve){if(!z(ne)){if(ne.isProviderFor(Oe,Ve))return ne;if(!z(le)){if(le.isProviderFor(Oe,Ve))return ne;if(!z(me))for(var Mt=$e(me);;){var qt=Ue(Mt);if(!qt)return;var V=Se(qt);if(V.isProviderFor(Oe,Ve))return We(Mt),V}}}if(!z(Q)&&Q.isProviderFor(Oe,Ve))return Q}function be(Oe,Ve){var Mt=Te.get(Oe),qt;return z(Mt)||(qt=Mt.get(Ve)),z(qt)&&(qt=Ze(Oe,Ve),z(qt)||(z(Mt)&&(Mt=new p,Te.set(Oe,Mt)),Mt.set(Ve,qt))),qt}function _e(Oe){if(z(Oe))throw new TypeError;return ne===Oe||le===Oe||!z(me)&&me.has(Oe)}function Ee(Oe,Ve,Mt){if(!_e(Mt))throw new Error("Metadata provider not registered.");var qt=be(Oe,Ve);if(qt!==Mt){if(!z(qt))return!1;var V=Te.get(Oe);z(V)&&(V=new p,Te.set(Oe,V)),V.set(Ve,Mt)}return!0}}function lt(){var Q;return!z(v)&&q(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Q=r.Reflect[v]),z(Q)&&(Q=It()),!z(v)&&q(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Q}),Q}function ot(Q){var ne=new y,le={isProviderFor:function(_e,Ee){var Oe=ne.get(_e);return z(Oe)?!1:Oe.has(Ee)},OrdinaryDefineOwnMetadata:Bt,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Zt,OrdinaryOwnMetadataKeys:Ze,OrdinaryDeleteMetadata:be};return b.registerProvider(le),le;function me(_e,Ee,Oe){var Ve=ne.get(_e),Mt=!1;if(z(Ve)){if(!Oe)return;Ve=new p,ne.set(_e,Ve),Mt=!0}var qt=Ve.get(Ee);if(z(qt)){if(!Oe)return;if(qt=new p,Ve.set(Ee,qt),!Q.setProvider(_e,Ee,le))throw Ve.delete(Ee),Mt&&ne.delete(_e),new Error("Wrong provider for target.")}return qt}function Te(_e,Ee,Oe){var Ve=me(Ee,Oe,!1);return z(Ve)?!1:W(Ve.has(_e))}function Zt(_e,Ee,Oe){var Ve=me(Ee,Oe,!1);if(!z(Ve))return Ve.get(_e)}function Bt(_e,Ee,Oe,Ve){var Mt=me(Oe,Ve,!0);Mt.set(_e,Ee)}function Ze(_e,Ee){var Oe=[],Ve=me(_e,Ee,!1);if(z(Ve))return Oe;for(var Mt=Ve.keys(),qt=$e(Mt),V=0;;){var ee=Ue(qt);if(!ee)return Oe.length=V,Oe;var oe=Se(ee);try{Oe[V]=oe}catch(pe){try{We(qt)}finally{throw pe}}V++}}function be(_e,Ee,Oe){var Ve=me(Ee,Oe,!1);if(z(Ve)||!Ve.delete(_e))return!1;if(Ve.size===0){var Mt=ne.get(Ee);z(Mt)||(Mt.delete(Oe),Mt.size===0&&ne.delete(Mt))}return!0}}function _t(Q){var ne=Q.defineMetadata,le=Q.hasOwnMetadata,me=Q.getOwnMetadata,Te=Q.getOwnMetadataKeys,Zt=Q.deleteMetadata,Bt=new y,Ze={isProviderFor:function(be,_e){var Ee=Bt.get(be);return!z(Ee)&&Ee.has(_e)?!0:Te(be,_e).length?(z(Ee)&&(Ee=new m,Bt.set(be,Ee)),Ee.add(_e),!0):!1},OrdinaryDefineOwnMetadata:ne,OrdinaryHasOwnMetadata:le,OrdinaryGetOwnMetadata:me,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Zt};return Ze}function Yt(Q,ne,le){var me=b.getProvider(Q,ne);if(!z(me))return me;if(le){if(b.setProvider(Q,ne,w))return w;throw new Error("Illegal state.")}}function ir(){var Q={},ne=[],le=function(){function Ze(be,_e,Ee){this._index=0,this._keys=be,this._values=_e,this._selector=Ee}return Ze.prototype["@@iterator"]=function(){return this},Ze.prototype[s]=function(){return this},Ze.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=ne,this._values=ne):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ze.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),be},Ze.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),{value:be,done:!0}},Ze}(),me=function(){function Ze(){this._keys=[],this._values=[],this._cacheKey=Q,this._cacheIndex=-2}return Object.defineProperty(Ze.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ze.prototype.has=function(be){return this._find(be,!1)>=0},Ze.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ze.prototype.set=function(be,_e){var Ee=this._find(be,!0);return this._values[Ee]=_e,this},Ze.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Ee=this._keys.length,Oe=_e+1;Oe<Ee;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=Q,this._cacheIndex=-2),!0}return!1},Ze.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Q,this._cacheIndex=-2},Ze.prototype.keys=function(){return new le(this._keys,this._values,Te)},Ze.prototype.values=function(){return new le(this._keys,this._values,Zt)},Ze.prototype.entries=function(){return new le(this._keys,this._values,Bt)},Ze.prototype["@@iterator"]=function(){return this.entries()},Ze.prototype[s]=function(){return this.entries()},Ze.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Ee=0;Ee<this._keys.length;Ee++)if(je(this._keys[Ee],be)){this._cacheIndex=Ee;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ze}();return me;function Te(Ze,be){return Ze}function Zt(Ze,be){return be}function Bt(Ze,be){return[Ze,be]}}function no(){var Q=function(){function ne(){this._map=new p}return Object.defineProperty(ne.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ne.prototype.has=function(le){return this._map.has(le)},ne.prototype.add=function(le){return this._map.set(le,le),this},ne.prototype.delete=function(le){return this._map.delete(le)},ne.prototype.clear=function(){this._map.clear()},ne.prototype.keys=function(){return this._map.keys()},ne.prototype.values=function(){return this._map.keys()},ne.prototype.entries=function(){return this._map.entries()},ne.prototype["@@iterator"]=function(){return this.keys()},ne.prototype[s]=function(){return this.keys()},ne}();return Q}function sr(){var Q=16,ne=d.create(),le=me();return function(){function be(){this._key=me()}return be.prototype.has=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.has(Ee,this._key):!1},be.prototype.get=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.get(Ee,this._key):void 0},be.prototype.set=function(_e,Ee){var Oe=Te(_e,!0);return Oe[this._key]=Ee,this},be.prototype.delete=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?delete Ee[this._key]:!1},be.prototype.clear=function(){this._key=me()},be}();function me(){var be;do be="@@WeakMap@@"+Ze();while(d.has(ne,be));return ne[be]=!0,be}function Te(be,_e){if(!a.call(be,le)){if(!_e)return;Object.defineProperty(be,le,{value:d.create()})}return be[le]}function Zt(be,_e){for(var Ee=0;Ee<_e;++Ee)be[Ee]=Math.random()*255|0;return be}function Bt(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Zt(_e,be),_e}return Zt(new Array(be),be)}function Ze(){var be=Bt(Q);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Ee=0;Ee<Q;++Ee){var Oe=be[Ee];(Ee===4||Ee===6||Ee===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function ro(Q){return Q.__=void 0,delete Q.__,Q}})}(e||(e={})),EL}Pde(),typeof window<"u"&&(window.Buffer=ODe),typeof Mv<"u"&&typeof require<"u"&&(Mv.Buffer=require("buffer/").Buffer);class an{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class Pc extends xe{constructor(){super("Locking not supported on given driver.")}}class L_ extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class At{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class Ade extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return At.isEntitySchema(t)?t.options.name:typeof t=="function"||an.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class CL extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class NL extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class Tde extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class xm extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Ua extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Ua.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class Ide extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class Rde extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class Ed extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class Dde extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class Lde extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class $de extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class ML{constructor(t){an.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Va{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var $_={exports:{}},F_={exports:{}},kL;function Ac(){return kL||(kL=1,typeof Object.create=="function"?F_.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:F_.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),F_.exports}var B_={exports:{}},PL;function ds(){return PL||(PL=1,function(e,t){var n=CDe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(B_,B_.exports)),B_.exports}var z_,AL;function Tc(){if(AL)return z_;AL=1;var e=ds().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},z_=t,z_}var U_,TL;function Fde(){if(TL)return U_;TL=1;var e=Ac(),t=Tc(),n=ds().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,f){return l===0?u&d|~u&f:l===2?u&d|u&f|d&f:u^d^f}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,f=this._b|0,p=this._c|0,m=this._d|0,y=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),j=i(d)+c(w,f,p,m)+y+u[b]+r[w]|0;y=m,m=p,p=s(f),f=d,d=j}this._a=d+this._a|0,this._b=f+this._b|0,this._c=p+this._c|0,this._d=m+this._d|0,this._e=y+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},U_=o,U_}var V_,IL;function Bde(){if(IL)return V_;IL=1;var e=Ac(),t=Tc(),n=ds().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,f,p){return u===0?d&f|~d&p:u===2?d&f|d&p|f&p:d^f^p}return o.prototype._update=function(u){for(var d=this._w,f=this._a|0,p=this._b|0,m=this._c|0,y=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var j=~~(w/20),x=s(f)+l(j,p,m,y)+v+d[w]+r[j]|0;v=y,y=m,m=c(p),p=f,f=x}this._a=f+this._a|0,this._b=p+this._b|0,this._c=m+this._c|0,this._d=y+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},V_=o,V_}var q_,RL;function DL(){if(RL)return q_;RL=1;var e=Ac(),t=Tc(),n=ds().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(f,p,m){return m^f&(p^m)}function s(f,p,m){return f&p|m&(f|p)}function c(f){return(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10)}function l(f){return(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7)}function u(f){return(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3}function d(f){return(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10}return o.prototype._update=function(f){for(var p=this._w,m=this._a|0,y=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,j=this._f|0,x=this._g|0,_=this._h|0,S=0;S<16;++S)p[S]=f.readInt32BE(S*4);for(;S<64;++S)p[S]=d(p[S-2])+p[S-7]+u(p[S-15])+p[S-16]|0;for(var E=0;E<64;++E){var O=_+l(w)+i(w,j,x)+r[E]+p[E]|0,M=c(m)+s(m,y,v)|0;_=x,x=j,j=w,w=b+O|0,b=v,v=y,y=m,m=O+M|0}this._a=m+this._a|0,this._b=y+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=j+this._f|0,this._g=x+this._g|0,this._h=_+this._h|0},o.prototype._hash=function(){var f=n.allocUnsafe(32);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f.writeInt32BE(this._h,28),f},q_=o,q_}var W_,LL;function zde(){if(LL)return W_;LL=1;var e=Ac(),t=DL(),n=Tc(),r=ds().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},W_=o,W_}var H_,$L;function FL(){if($L)return H_;$L=1;var e=Ac(),t=Tc(),n=ds().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(y,v,b){return b^y&(v^b)}function s(y,v,b){return y&v|b&(y|v)}function c(y,v){return(y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25)}function l(y,v){return(y>>>14|v<<18)^(y>>>18|v<<14)^(v>>>9|y<<23)}function u(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^y>>>7}function d(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^(y>>>7|v<<25)}function f(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^y>>>6}function p(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^(y>>>6|v<<26)}function m(y,v){return y>>>0<v>>>0?1:0}return o.prototype._update=function(y){for(var v=this._w,b=this._ah|0,w=this._bh|0,j=this._ch|0,x=this._dh|0,_=this._eh|0,S=this._fh|0,E=this._gh|0,O=this._hh|0,M=this._al|0,C=this._bl|0,k=this._cl|0,T=this._dl|0,P=this._el|0,N=this._fl|0,I=this._gl|0,A=this._hl|0,R=0;R<32;R+=2)v[R]=y.readInt32BE(R*4),v[R+1]=y.readInt32BE(R*4+4);for(;R<160;R+=2){var L=v[R-30],D=v[R-15*2+1],B=u(L,D),F=d(D,L);L=v[R-2*2],D=v[R-2*2+1];var $=f(L,D),z=p(D,L),X=v[R-7*2],G=v[R-7*2+1],q=v[R-16*2],J=v[R-16*2+1],K=F+G|0,W=B+X+m(K,F)|0;K=K+z|0,W=W+$+m(K,z)|0,K=K+J|0,W=W+q+m(K,J)|0,v[R]=W,v[R+1]=K}for(var Y=0;Y<160;Y+=2){W=v[Y],K=v[Y+1];var re=s(b,w,j),U=s(M,C,k),ce=c(b,M),ae=c(M,b),ue=l(_,P),je=l(P,_),Le=r[Y],$e=r[Y+1],Se=i(_,S,E),Ue=i(P,N,I),We=A+je|0,He=O+ue+m(We,A)|0;We=We+Ue|0,He=He+Se+m(We,Ue)|0,We=We+$e|0,He=He+Le+m(We,$e)|0,We=We+K|0,He=He+W+m(We,K)|0;var It=ae+U|0,lt=ce+re+m(It,ae)|0;O=E,A=I,E=S,I=N,S=_,N=P,P=T+We|0,_=x+He+m(P,T)|0,x=j,T=k,j=w,k=C,w=b,C=M,M=We+It|0,b=He+lt+m(M,We)|0}this._al=this._al+M|0,this._bl=this._bl+C|0,this._cl=this._cl+k|0,this._dl=this._dl+T|0,this._el=this._el+P|0,this._fl=this._fl+N|0,this._gl=this._gl+I|0,this._hl=this._hl+A|0,this._ah=this._ah+b+m(this._al,M)|0,this._bh=this._bh+w+m(this._bl,C)|0,this._ch=this._ch+j+m(this._cl,k)|0,this._dh=this._dh+x+m(this._dl,T)|0,this._eh=this._eh+_+m(this._el,P)|0,this._fh=this._fh+S+m(this._fl,N)|0,this._gh=this._gh+E+m(this._gl,I)|0,this._hh=this._hh+O+m(this._hl,A)|0},o.prototype._hash=function(){var y=n.allocUnsafe(64);function v(b,w,j){y.writeInt32BE(b,j),y.writeInt32BE(w,j+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),y},H_=o,H_}var K_,BL;function Ude(){if(BL)return K_;BL=1;var e=Ac(),t=FL(),n=Tc(),r=ds().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},K_=o,K_}var zL;function Vde(){if(zL)return $_.exports;zL=1;var e=$_.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=Fde(),e.sha1=Bde(),e.sha224=zde(),e.sha256=DL(),e.sha384=Ude(),e.sha512=FL(),$_.exports}var qde=Vde();const Wde=st(qde);function Hde(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function Kde(e,t={}){const n=Wde("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class Zde{static isGreaterOrEqual(t,n){const r=UL(t),a=UL(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function UL(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&Zde.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=Hde(o);if(i.length<t)return i}return Kde(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,f="";const p=l.indexOf(":");p!==-1&&(d=l.substr(0,p),f=l.substr(p+1));const[m,y]=u.split(":");return{type:n,host:m,username:decodeURIComponent(d),password:decodeURIComponent(f),port:y?parseInt(y):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,f,p={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const _=c.split("&");let S,E;_.forEach(O=>{S=O.split("=")[0],E=O.split("=")[1],p[S]=E}),f=p.replicaSet,s=s.substr(0,s.indexOf("?"))}const m=i.lastIndexOf("@"),y=i.substr(0,m),v=i.substr(m+1);let b=y,w="";const j=y.indexOf(":");j!==-1&&(b=y.substr(0,j),w=y.substr(j+1)),f?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[_,S]of Object.entries(p))x[_]=S;return x}}class VL{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&an.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Va.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Va.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Va.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class Z_{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,an.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class G_{constructor(t,n){this.expressionMap=t,an.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Va.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class X_{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new ML;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new X_(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new ML(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new VL(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new Z_(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new G_(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class qL{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class J_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class Od{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return At.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return At.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return At.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return At.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(At.isFindOperator(this._value))return this._value}get getSql(){return At.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof Od?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&J_.transformTo(t,n)):J_.transformTo(t,this._value)}}function qa(e){return new Od("in",e,!0,!0)}const Gde=/[.*+\-?^${}()|[\]\\]/g,Xde=e=>e.replace(Gde,"\\$&");class Xt{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,At.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new X_(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Xt.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),At.isSelectQueryBuilder(this)?this:Xt.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",At.isInsertQueryBuilder(this)?this:Xt.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=At.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,At.isUpdateQueryBuilder(this)?this:Xt.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",At.isDeleteQueryBuilder(this)?this:Xt.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",At.isSoftDeleteQueryBuilder(this)?this:Xt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",At.isSoftDeleteQueryBuilder(this)?this:Xt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return At.isRelationQueryBuilder(this)?this:Xt.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>Xde(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${Od.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!At.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(At.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:qa(r.map(o=>a.getEntityValue(o,!1)))}}return new qL(a=>{for(const o of r)a.orWhere(new qL(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Ua(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||At.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(At.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(At.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:At.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Xt.queryBuilderRegistry={};class Jde{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Yde extends Xt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=Jde.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=At.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new xm;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let _m;const Qde=new Uint8Array(16);function efe(){if(!_m&&(_m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!_m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _m(Qde)}const On=[];for(let e=0;e<256;++e)On.push((e+256).toString(16).slice(1));function tfe(e,t=0){return On[e[t+0]]+On[e[t+1]]+On[e[t+2]]+On[e[t+3]]+"-"+On[e[t+4]]+On[e[t+5]]+"-"+On[e[t+6]]+On[e[t+7]]+"-"+On[e[t+8]]+On[e[t+9]]+"-"+On[e[t+10]]+On[e[t+11]]+On[e[t+12]]+On[e[t+13]]+On[e[t+14]]+On[e[t+15]]}const nfe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),WL={randomUUID:nfe};function rfe(e,t,n){if(WL.randomUUID&&!t&&!e)return WL.randomUUID();e=e||{};const r=e.random||(e.rng||efe)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,tfe(r)}class HL{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class KL{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class Y_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,f,p)=>(d[this.expressionMap.extraReturningColumns[p].databaseName]=f[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class afe extends Xt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new KL;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new HL;t.forEach(m=>{n.broadcaster.broadcastBeforeInsertEvent(p,this.expressionMap.mainAlias.metadata,m)}),await p.wait()}let a=null,o=null;const i=new Y_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(p=>!s.includes(p)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(p=>p!=null).join(`;

`),d=await n.query(u,l,!0),f=KL.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(f,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new HL;t.forEach(m=>{n.broadcaster.broadcastAfterInsertEvent(p,this.expressionMap.mainAlias.metadata,m)}),await p.wait()}return r&&await n.commitTransaction(),f}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=At.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new xm;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:f}=this.expressionMap.onUpdate;let p="ON CONFLICT";if(Array.isArray(u)){if(p+=` ( ${u.map(y=>this.escape(y)).join(", ")} )`,f&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");f&&ve.isPostgresFamily(this.connection.driver)&&(p+=` WHERE ( ${f} )`)}else u&&(p+=` ON CONSTRAINT ${this.escape(u)}`);const m=[];Array.isArray(c)?m.push(...c.map(y=>`${this.escape(y)} = EXCLUDED.${this.escape(y)}`)):l&&m.push(...l.map(y=>`${this.escape(y)} = :${y}`)),m.length>0&&(o+=` ${p} DO UPDATE SET `,m.push(...this.expressionMap.mainAlias.metadata.columns.filter(y=>y.isUpdateDate&&!(c!=null&&c.includes(y.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(y=>`${this.escape(y.databaseName)} = DEFAULT`)),o+=m.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(y=>`${t}.${this.escape(y)} IS DISTINCT FROM EXCLUDED.${this.escape(y)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=rfe(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(an.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new Rde}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class ZL{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=an.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const f="joinColumn_"+l+"_"+d;o[f]=an.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${f}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=an.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(f=>{d[f.databaseName]=an.isObject(l)?f.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(f=>{d[f.databaseName]=an.isObject(u)?f.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class ofe{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,f)=>[...n.inverseRelation.joinColumns.map((p,m)=>{const y="joinColumn_"+u+"_"+f+"_"+m;return i[y]=an.isObject(l)?p.referencedColumn.getEntityValue(l):l,`${p.propertyPath} = :${y}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((p,m)=>{const y="primaryColumn_"+f+"_"+f+"_"+m;return i[y]=an.isObject(d)?p.getEntityValue(d):d,`${p.propertyPath} = :${y}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,f)=>{l.push(...s.map((p,m)=>[...r.ownerColumns.map((y,v)=>{const b="firstValue_"+f+"_"+m+"_"+v;return c[b]=an.isObject(d)?y.referencedColumn.getEntityValue(d):d,`${y.databaseName} = :${b}`}),...r.inverseColumns.map((y,v)=>{const b="secondValue_"+f+"_"+m+"_"+v;return c[b]=an.isObject(p)?y.referencedColumn.getEntityValue(p):p,`${y.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class ife extends Xt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!an.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new ZL(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!an.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new ZL(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new ofe(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!an.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class Cn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)Cn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:Cn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class sfe{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return jn.isBuffer(l)?l.toString("hex"):an.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(f=>f===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],f=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),p=(m,y,v)=>{const b=m.shift();if(b&&m.length===0)return y[b]=v,y;if(b&&m.length>0)p(m,y[b],v);else return y};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(p(f,r,d[0]),o=!0):(p(f,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),Cn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),Cn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let cfe=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((p,m)=>{const y=[],v={},b=a.map(j=>{const x=j.databaseName+m,_=p[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,j.referencedColumn.databaseName)],S=`${s}:${j.propertyPath}:${_}`;return y.indexOf(S)!==-1?"":(y.push(S),v[x]=_,s+"."+j.propertyPath+" = :"+x)}).filter(j=>j).join(" AND ");y.sort();const w=y.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(p=>p).map(p=>"("+p+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);Cn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],p=>p.propertyPath).forEach(p=>{d.addSelect(s+"."+p.propertyPath,p.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const f=await d.getRawMany();return f.forEach(p=>{a.forEach(m=>{p[m.databaseName]=this.connection.driver.prepareHydratedValue(p[m.databaseName],m.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(m=>{p[m.databaseName]=this.connection.driver.prepareHydratedValue(p[m.databaseName],m)})}),{relationIdAttribute:n,results:f}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((j,x)=>(j[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],j),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},f={},p=u.map((w,j)=>{const x=[],_={},S=Object.keys(w).map(O=>{const M=O+j,C=w[O],k=`${i}:${O}:${C}`;return x.indexOf(k)!==-1?"":(x.push(k),_[M]=C,i+"."+O+" = :"+M)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return f[E]?"":(f[E]=!0,Object.assign(d,_),S)}).filter(w=>w),m=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),y=p.map(w=>"("+w+" AND "+m+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,y).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(j=>{w[j.databaseName]=this.connection.driver.prepareHydratedValue(w[j.databaseName],j.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class lfe{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const f={entity:d,related:o?[]:void 0},p=s.filter(m=>u.every(y=>y.compareEntityValue(d,m[y.entityMetadata.name+"_"+y.propertyAliasName])));return p.length&&c.forEach(m=>{p.forEach(y=>{l.every(v=>v.compareEntityValue(m,y[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?f.related.push(m):f.related=m)})}),f})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)}),s.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)});let l="";if(i.length===1){const f=n.map(p=>i[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?l=`${o}.${i[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values1",f),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((f,p)=>i.map(m=>{const y="entity1_"+p+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(f)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const f=r.map(p=>s[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?u=`${o}.${s[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values2",f),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((f,p)=>s.map(m=>{const y="entity2_"+p+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(f)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const d=[l,u].filter(f=>f.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const f=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[f]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(f=>{const p=f.getEntityValue(l),m=f.referencedColumn.getEntityValue(d);if(!(p===void 0||m===void 0)&&p===m){const y=f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[y]=m}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const f="entity"+l+"_"+d;return i.setParameter(f,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),f=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[f]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class ufe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new Z_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class dfe{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let f=t.map(m=>m[a.parentAlias+"_"+s]).filter(m=>!!m);if(f=f.filter(n),f.length===0)return{relationCountAttribute:a,results:[]};const p=this.connection.createQueryBuilder(this.queryRunner);return p.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",f),a.queryBuilderFactory&&a.queryBuilderFactory(p),{relationCountAttribute:a,results:await p.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,f=a.alias||d,p=a.relation.junctionEntityMetadata.tableName,m=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+f+"."+i,y=this.connection.createQueryBuilder(this.queryRunner);return y.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+y.escape(f)+"."+y.escape(i)+")","cnt").from(d,f).innerJoin(p,u,m).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(y),{relationCountAttribute:a,results:await y.getRawMany()}}});return Promise.all(r)}}class ffe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new G_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class Q_{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(Q_.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new Dde(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const f=t.expressionMap.joinAttributes.find(p=>p.entityOrProperty===l);u=f.metadata,d=f.alias.name}if(!d||!u)throw new Ua(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const f=a.relations.find(p=>p.propertyName===s.propertyPath);f&&this.joinEagerRelations(t,c,f.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class ej extends Xt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new Z_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new G_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Ed;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new CL(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new CL(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new Ade(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Ed;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new VL(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const p=n(this.subQuery());this.setParameters(p.getParameters()),d=p.getQuery()}else d=n;const f=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:f===!1?n:void 0,subQuery:f===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new $de}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new Pc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new Pc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new Pc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new Pc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new Pc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new Pc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(f=>f.selection===t+"."+l.propertyPath);if(d.length)d.forEach(f=>{s.push({selection:u,aliasName:f.aliasName?f.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:f.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?Cn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?Cn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&Q_.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new Lde;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new Ide(i.name)}const n=new cfe(this.connection,t,this.expressionMap.relationIdAttributes),r=new dfe(this.connection,t,this.expressionMap.relationCountAttributes);new ufe(this.expressionMap).transform(),new ffe(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(p=>{const m=this.escape("distinctAlias"),y=this.escape(ve.buildAlias(this.connection.driver,void 0,l,p.databaseName));s[y]||(s[y]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,p.databaseName);return`${m}.${y} AS ${this.escape(v)}`}),d=this.clone(),f=d.expressionMap.timeTravel;if(a=await new ej(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(f).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let p="";const m={};if(c.hasMultiplePrimaryKeys)p=a.map((y,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,j=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return m[w]=y[j],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const y=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[y]);v.every(b=>typeof b=="number")?p=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(m.orm_distinct_ids=v,p=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:p}).setParameters(m).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new sfe(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new lfe(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?Cn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?Cn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,f=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?Cn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?Cn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?Cn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const p=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,f);o.forEach(m=>{const y=p.find(v=>v.entity===m);if(y){const v=y.related===void 0?null:y.related;s.setEntityValue(m,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return an.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ua(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ua(c,r);if(l)this.buildRelations(s,typeof n=="object"?Cn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?Cn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ua(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?Cn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let p=d+"_"+f.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},d,p),this.joins.find(m=>m.alias===p)||this.joins.push({type:"left",select:!0,alias:p,parentAlias:d,selection:void 0,relationMetadata:f}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?Cn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ua(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let f=`${r}.${i}`;this.addOrderBy(f,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Ua(c,n);if(l){let f=`${r}.${c}`;l.isVirtualProperty&&l.query&&(f=`(${l.query(r)})`);let p=t[s];At.isEqualOperator(t[s])&&(p=t[s].value),l.transformer&&(p instanceof Od?p.transformValue(l.transformer):p=J_.transformTo(l.transformer,p)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,p)))}else if(u){const f=this.buildWhere(t[s],n,r,c);f&&i.push(f)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(f=>t[s][f]===void 0))continue;if(At.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let f="";t[s].type==="moreThan"?f=">":t[s].type==="lessThan"?f="<":t[s].type==="moreThanOrEqual"?f=">=":t[s].type==="lessThanOrEqual"&&(f="<=");const p=this.subQuery();if(d.isManyToManyOwner)p.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(m=>`${d.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)p.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(m=>`${d.inverseRelation.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)p.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(m=>`${d.inverseEntityMetadata.tableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(p.getSql()+" "+f+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const f=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let f=r+"_"+d.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},r,f),this.joins.find(m=>m.alias===f)||this.joins.push({type:"left",select:!1,selection:void 0,alias:f,parentAlias:r,relationMetadata:d});const p=this.buildWhere(t[s],d.inverseEntityMetadata,f);p&&i.push(p)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class GL{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class pfe extends Xt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new Y_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=GL.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=At.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new xm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new Tde(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new L_;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new NL}return""}}class hfe extends Xt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new Y_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(f=>!i.includes(f)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(f=>f!=null).join(`;

`),c,!0),d=GL.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new xm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Ua(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!jn.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const f=this.createParameter(d);let p=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const m=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?p=`${m}(${f}, ${u.srid})`:p=`${m}(${f})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?p=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:p=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?p=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":p=f;a.push(this.escape(u.databaseName)+" = "+p)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new L_;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new NL}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new L_}}function mfe(){Xt.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Yde(e)),Xt.registerQueryBuilderClass("InsertQueryBuilder",e=>new afe(e)),Xt.registerQueryBuilderClass("RelationQueryBuilder",e=>new ife(e)),Xt.registerQueryBuilderClass("SelectQueryBuilder",e=>new ej(e)),Xt.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new pfe(e)),Xt.registerQueryBuilderClass("UpdateQueryBuilder",e=>new hfe(e))}var XL;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(XL||(XL={}));var tj={exports:{}},nj,JL;function yfe(){if(JL)return nj;JL=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;nj=function(u,d){d=d||{};var f=typeof u;if(f==="string"&&u.length>0)return i(u);if(f==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var f=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*o;case"weeks":case"week":case"w":return f*a;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,f,p){var m=d>=f*1.5;return Math.round(u/f)+" "+p+(m?"s":"")}return nj}var rj,YL;function gfe(){if(YL)return rj;YL=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=yfe(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=n;function r(d){let f,p=null,m,y;function v(...b){if(!v.enabled)return;const w=v,j=Number(new Date),x=j-(f||j);w.diff=x,w.prev=f,w.curr=j,f=j,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let _=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(S,E)=>{if(S==="%%")return"%";_++;const O=r.formatters[E];if(typeof O=="function"){const M=b[_];S=O.call(w,M),b.splice(_,1),_--}return S}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==r.namespaces&&(m=r.namespaces,y=r.enabled(d)),y),set:b=>{p=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,f){const p=r(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),m=p.length;for(f=0;f<m;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(f=>"-"+f)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=r.skips.length;f<p;f++)if(r.skips[f].test(d))return!1;for(f=0,p=r.names.length;f<p;f++)if(r.names[f].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return rj=e,rj}var QL;function vfe(){return QL||(QL=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,f=0;l[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof Sn<"u"&&"env"in Sn&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=gfe()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(tj,tj.exports)),tj.exports}vfe(),mfe();const e6=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),bfe=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),t6=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),wfe=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),aj=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=e6(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?wm({...o||{},data:void 0},nd(s,rd)):s}}),newIds:[]}},oj=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:t6(o)}):(n.push(o.id),{type:"replace",item:t6(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},ij={width:440,height:360},jm={width:380,height:650},Cd={[ie.Toolbox]:"toolbox",[ie.SessionInfo]:"session-info",[ie.DefaultEmbeddingModel]:"default-embedding-model",[ie.ApplicationBar]:"application-bar"},xfe={id:Cd[ie.Toolbox],type:ie.Toolbox,position:{x:10+jm.width+20,y:10},measured:ij,data:{}},_fe={id:Cd[ie.SessionInfo],type:ie.SessionInfo,position:{x:10,y:10},measured:jm,data:{}},jfe={id:Cd[ie.DefaultEmbeddingModel],type:ie.DefaultEmbeddingModel,position:{x:10+jm.width+ij.width+40,y:10},data:{model:NDe}},Sfe={id:Cd[ie.ApplicationBar],type:ie.ApplicationBar,position:{x:10+jm.width+ij.width+40,y:80},data:{}},Efe=[xfe,_fe,jfe,Sfe],Ofe=[ie.Toolbox,ie.SessionInfo,ie.ApplicationBar,ie.EditorApp,ie.CodeContainerApp],n6={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Efe},Sm=async e=>{const t=await de("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await de(i).find({where:{id:qa(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},Cfe=(e,t)=>({reset:()=>{e(n6)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:ls(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:jd(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:G4(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=aj(n,a,r);e({nodes:ls(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=oj(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:jd(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Sm(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return e6(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=aj(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:ls(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await de("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>bfe(s))});else{const s=t().edges,{changes:c}=oj(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:jd(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await de("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await de("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await de(r.source_type).delete(r.source_id).catch(i=>{ti("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:ls([{type:"remove",id:r.id}],o)})}}catch(r){ti("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await de("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await de("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){ti("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=et.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await de("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){ti("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=et.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(p=>p.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await de("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=wm(s,nd(n,rd)),r!=null&&r.lazy?de("FlowNode").update(s.id,i):await de("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Vi(),de("FlowNode").save(i)):i=await de("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(p=>p.id===i.id);i.source_type&&!l?c=await de(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:f}=aj([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(p=>p.id!==i.id),i],nodes:ls(f,d)}),i}catch(o){ti("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=et.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await de("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=wm(i,nd(n,rd)),r!=null&&r.lazy?de("FlowEdge").update(i.id,o):await de("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Vi(),de("FlowEdge").save(o)):o=await de("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:jd(oj([o],c).changes,c)}),o}catch(a){ti("Failed to create or update flow node",a)}}}),Em=()=>{const e=oo(t=>t.loadModel);return{loadModel:g.useCallback(async(t,...n)=>{switch(t){case nt.WebLLM:return e(...n);default:return}},[e])}};var Nfe=Object.defineProperty,Mfe=Object.defineProperties,kfe=Object.getOwnPropertyDescriptors,Om=Object.getOwnPropertySymbols,r6=Object.prototype.hasOwnProperty,a6=Object.prototype.propertyIsEnumerable,o6=(e,t,n)=>t in e?Nfe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pfe=(e,t)=>{for(var n in t||(t={}))r6.call(t,n)&&o6(e,n,t[n]);if(Om)for(var n of Om(t))a6.call(t,n)&&o6(e,n,t[n]);return e},Afe=(e,t)=>Mfe(e,kfe(t)),Tfe=(e,t)=>{var n={};for(var r in e)r6.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Om)for(var r of Om(e))t.indexOf(r)<0&&a6.call(e,r)&&(n[r]=e[r]);return n};function Ife(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function Rfe(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Dfe=18,i6=40,Lfe=`${i6}px`,$fe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Ffe({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let f=e.current,p=t.current;if(!f||!p||c||n==="none")return;let m=f,y=m.getBoundingClientRect().left+m.offsetWidth,v=m.getBoundingClientRect().top+m.offsetHeight/2,b=y-Dfe,w=v;document.querySelectorAll($fe).length===0&&document.elementFromPoint(b,w)===f||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let f=e.current;if(!f||n==="none")return;function p(){let y=window.innerWidth-f.getBoundingClientRect().right;s(y>=i6)}p();let m=setInterval(p,1e3);return()=>{clearInterval(m)}},[e,n]),g.useEffect(()=>{let f=r||document.activeElement===t.current;if(n==="none"||!f)return;let p=setTimeout(d,0),m=setTimeout(d,2e3),y=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(p),clearTimeout(m),clearTimeout(y),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Lfe}}var s6=g.createContext({}),c6=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:f,containerClassName:p,noScriptCSSFallback:m=Bfe,render:y,children:v}=n,b=Tfe(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,j,x,_,S;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),M=r??E,C=Rfe(M),k=g.useCallback(ae=>{a==null||a(ae),O(ae)},[a]),T=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),P=g.useRef(null),N=g.useRef(null),I=g.useRef({value:M,onChange:k,isIOS:typeof window<"u"&&((j=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:j.call(w,"-webkit-touch-callout","none"))}),A=g.useRef({prev:[(x=P.current)==null?void 0:x.selectionStart,(_=P.current)==null?void 0:_.selectionEnd,(S=P.current)==null?void 0:S.selectionDirection]});g.useImperativeHandle(t,()=>P.current,[]),g.useEffect(()=>{let ae=P.current,ue=N.current;if(!ae||!ue)return;I.current.value!==ae.value&&I.current.onChange(ae.value),A.current.prev=[ae.selectionStart,ae.selectionEnd,ae.selectionDirection];function je(){if(document.activeElement!==ae){$(null),X(null);return}let Se=ae.selectionStart,Ue=ae.selectionEnd,We=ae.selectionDirection,He=ae.maxLength,It=ae.value,lt=A.current.prev,ot=-1,_t=-1,Yt;if(It.length!==0&&Se!==null&&Ue!==null){let ro=Se===Ue,Q=Se===It.length&&It.length<He;if(ro&&!Q){let ne=Se;if(ne===0)ot=0,_t=1,Yt="forward";else if(ne===He)ot=ne-1,_t=ne,Yt="backward";else if(He>1&&It.length>1){let le=0;if(lt[0]!==null&&lt[1]!==null){Yt=ne<lt[1]?"backward":"forward";let me=lt[0]===lt[1]&&lt[0]<He;Yt==="backward"&&!me&&(le=-1)}ot=le+ne,_t=le+ne+1}}ot!==-1&&_t!==-1&&ot!==_t&&P.current.setSelectionRange(ot,_t,Yt)}let ir=ot!==-1?ot:Se,no=_t!==-1?_t:Ue,sr=Yt??We;$(ir),X(no),A.current.prev=[ir,no,sr]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===ae&&B(!0),!document.getElementById("input-otp-style")){let Se=document.createElement("style");if(Se.id="input-otp-style",document.head.appendChild(Se),Se.sheet){let Ue="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Nd(Se.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Nd(Se.sheet,`[data-input-otp]:autofill { ${Ue} }`),Nd(Se.sheet,`[data-input-otp]:-webkit-autofill { ${Ue} }`),Nd(Se.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Nd(Se.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{ue&&ue.style.setProperty("--root-height",`${ae.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(ae),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[R,L]=g.useState(!1),[D,B]=g.useState(!1),[F,$]=g.useState(null),[z,X]=g.useState(null);g.useEffect(()=>{Ife(()=>{var ae,ue,je,Le;(ae=P.current)==null||ae.dispatchEvent(new Event("input"));let $e=(ue=P.current)==null?void 0:ue.selectionStart,Se=(je=P.current)==null?void 0:je.selectionEnd,Ue=(Le=P.current)==null?void 0:Le.selectionDirection;$e!==null&&Se!==null&&($($e),X(Se),A.current.prev=[$e,Se,Ue])})},[M,D]),g.useEffect(()=>{C!==void 0&&M!==C&&C.length<o&&M.length===o&&(u==null||u(M))},[o,u,C,M]);let G=Ffe({containerRef:N,inputRef:P,pushPasswordManagerStrategy:d,isFocused:D}),q=g.useCallback(ae=>{let ue=ae.currentTarget.value.slice(0,o);if(ue.length>0&&T&&!T.test(ue)){ae.preventDefault();return}typeof C=="string"&&ue.length<C.length&&document.dispatchEvent(new Event("selectionchange")),k(ue)},[o,k,C,T]),J=g.useCallback(()=>{var ae;if(P.current){let ue=Math.min(P.current.value.length,o-1),je=P.current.value.length;(ae=P.current)==null||ae.setSelectionRange(ue,je),$(ue),X(je)}B(!0)},[o]),K=g.useCallback(ae=>{var ue,je;let Le=P.current;if(!f&&(!I.current.isIOS||!ae.clipboardData||!Le))return;let $e=ae.clipboardData.getData("text/plain"),Se=f?f($e):$e;ae.preventDefault();let Ue=(ue=P.current)==null?void 0:ue.selectionStart,We=(je=P.current)==null?void 0:je.selectionEnd,He=(Ue!==We?M.slice(0,Ue)+Se+M.slice(We):M.slice(0,Ue)+Se+M.slice(Ue)).slice(0,o);if(He.length>0&&T&&!T.test(He))return;Le.value=He,k(He);let It=Math.min(He.length,o-1),lt=He.length;Le.setSelectionRange(It,lt),$(It),X(lt)},[o,k,T,M]),W=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),Y=g.useMemo(()=>({position:"absolute",inset:0,width:G.willPushPWMBadge?`calc(100% + ${G.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:G.willPushPWMBadge?`inset(0 ${G.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[G.PWM_BADGE_SPACE_WIDTH,G.willPushPWMBadge,i]),re=g.useMemo(()=>g.createElement("input",Afe(Pfe({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":M.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":z,inputMode:l,pattern:T==null?void 0:T.source,"aria-placeholder":c,style:Y,maxLength:o,value:M,ref:P,onPaste:ae=>{var ue;K(ae),(ue=b.onPaste)==null||ue.call(b,ae)},onChange:q,onMouseOver:ae=>{var ue;L(!0),(ue=b.onMouseOver)==null||ue.call(b,ae)},onMouseLeave:ae=>{var ue;L(!1),(ue=b.onMouseLeave)==null||ue.call(b,ae)},onFocus:ae=>{var ue;J(),(ue=b.onFocus)==null||ue.call(b,ae)},onBlur:ae=>{var ue;B(!1),(ue=b.onBlur)==null||ue.call(b,ae)}})),[q,J,K,l,Y,o,z,F,b,T==null?void 0:T.source,M]),U=g.useMemo(()=>({slots:Array.from({length:o}).map((ae,ue)=>{var je;let Le=D&&F!==null&&z!==null&&(F===z&&ue===F||ue>=F&&ue<z),$e=M[ue]!==void 0?M[ue]:null,Se=M[0]!==void 0?null:(je=c==null?void 0:c[ue])!=null?je:null;return{char:$e,placeholderChar:Se,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:D,isHovering:!b.disabled&&R}),[D,R,o,z,F,b.disabled,M]),ce=g.useMemo(()=>y?y(U):g.createElement(s6.Provider,{value:U},v),[v,U,y]);return g.createElement(g.Fragment,null,m!==null&&g.createElement("noscript",null,g.createElement("style",null,m)),g.createElement("div",{ref:N,"data-input-otp-container":!0,style:W,className:p},ce,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},re)))});c6.displayName="Input";function Nd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Bfe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const sj=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(c6,{ref:r,containerClassName:Z("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...n}));sj.displayName="InputOTP";const Md=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center",e),...t}));Md.displayName="InputOTPGroup";const wr=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(s6),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:Z("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(KG,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});wr.displayName="InputOTPSlot";const cj=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(KG,{})}));cj.displayName="InputOTPSeparator";const kd=so(({onConfirm:e,onCancel:t})=>{const n=tn(),{t:r}=ke("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{(a==null?void 0:a.length)===6&&(await(e==null?void 0:e(a)),o(""),n.resolve(!0),n.hide())},c=async()=>{await(t==null?void 0:t()),o(""),n.resolve(!1),n.hide()};return h.jsx(fi,{open:n.visible,onOpenChange:c,children:h.jsxs(vo,{className:"w-[330px]",children:[h.jsxs(bo,{children:[h.jsx(wo,{children:r("session_passkey.title")}),h.jsx(Lu,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(sj,{onChange:i,maxLength:6,children:[h.jsxs(Md,{children:[h.jsx(wr,{index:0,hidden:!0}),h.jsx(wr,{index:1,hidden:!0}),h.jsx(wr,{index:2,hidden:!0})]}),h.jsx(cj,{}),h.jsxs(Md,{children:[h.jsx(wr,{index:3,hidden:!0}),h.jsx(wr,{index:4,hidden:!0}),h.jsx(wr,{index:5,hidden:!0})]})]})}),h.jsx(Du,{children:h.jsx(tt,{disabled:(a==null?void 0:a.length)!==6,onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),Pd=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},l6=e=>new TextEncoder().encode(e).buffer,zfe=async e=>{const t=l6(e);return await crypto.subtle.digest("SHA-256",t)},lj=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Ufe=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return lj(e)},uj=async e=>{const t=await zfe(e);return lj(t)},u6=async e=>(await uj(e)).substring(0,32),d6=async(e,t)=>{const n=await uj(t),r=await u6(t),a=l6(e),o=await Vfe(a,n,r);return lj(o)},dj=async(e,t)=>{const n=await uj(t),r=await u6(t),a=Pd(e),o=await qfe(a,n,r);return new TextDecoder().decode(o)},Vfe=async(e,t,n)=>{const r=Pd(n),a=Pd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},qfe=async(e,t,n)=>{const r=Pd(n),a=Pd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},f6=async(e,t)=>{const n={};return await Promise.all(Object.entries(e||{}).map(async([r,a])=>{const o=await d6(a,t);n[r]=o})),n},Cm=async(e,t)=>{let n;if(await new Promise((r,a)=>{t.show({onConfirm:async o=>{try{n=await dj(e,o),await mp.set("passphrase",n),r(!0)}catch(i){a(i)}finally{t.hide()}},onCancel:()=>{a()}})}),!n)throw new Error("Passphrase is required");return n},Ic=e=>{const t=tn(e),n=g.useRef(t);return n.current=t,{modal:t,modalRef:n}},Wfe=()=>{var E,O;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),f=et(M=>M.currentSession),{loadModel:p}=Em(),{modalRef:m}=Ic(kd),y=g.useCallback(async M=>{var k;if(!f)return;const C=await de("JSONData").findOne({where:{id:M.source_id,session_id:f==null?void 0:f.id}});C&&((k=u.current)==null||k.call(u,C.data?C.data:[]),l({node:M,enity:C}))},[f]),v=g.useCallback(async M=>{var A;const C=(M==null?void 0:M.sessionId)||(f==null?void 0:f.id),k=(M==null?void 0:M.threadNode)||(n==null?void 0:n.threadNode),T=(M==null?void 0:M.prompts)||(e==null?void 0:e.prompts);if(!C||!(k!=null&&k.id))return;const P=T==null?void 0:T.map(R=>{if(R.type!=="few_shot_example")switch(R.role){case"ai":case"assistant":case"tool":return{id:R.id,content:R.content,role:"assistant"};case"system":return{id:R.id,content:R.content,role:"system"};default:return{id:R.id,content:R.content,role:"user"}}}).filter(Boolean),N=await de("JSONData").save({headers:"item",session_id:C,json:"",data:P});if(!N)return;const I=await de("FlowNode").save({session_id:C,source_id:N.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(I)return await de("FlowEdge").save({session_id:C,source:k.id,target:I.id}),(A=u.current)==null||A.call(u,P),l({node:I,enity:N}),{jsonData:N,jsonDataNode:I}},[e==null?void 0:e.prompts,f==null?void 0:f.id,n==null?void 0:n.threadNode]),b=g.useCallback(async(M,C)=>{if(!f)return;const k=await de("FlowEdge").findOne({where:{session_id:f.id,source:M.id},order:{id:"DESC"}});if(k){const T=await de("FlowNode").findOne({where:{id:k.target,session_id:f.id}});if(!T)return;await y(T)}else if(!await v({sessionId:f.id,threadNode:M,prompts:C||[]}))return},[v,f,y]),w=g.useCallback(async M=>{if(M!=null&&M.length&&(f!=null&&f.id)){const C=(await Promise.all(M.map(async k=>de("FlowEdge").find({where:{target:k.source.id}}).then(T=>Sm({where:{session_id:f.id,id:qa(T.map(P=>P.source))}}).then(P=>({...P,...k})))))).map(k=>{var A,R,L,D;const T=k.flowNodes.find(B=>B.source_type==="Prompt"),P=k.flowNodes.find(B=>B.source_type==="VectorDatabase");if(!P||!T)return;const N=(R=(A=k.flowNodeDatas)==null?void 0:A.Prompt)==null?void 0:R.find(B=>B.id===T.source_id),I=(D=(L=k.flowNodeDatas)==null?void 0:L.VectorDatabase)==null?void 0:D.find(B=>B.id===P.source_id);return{promptNode:T,vectorDatabaseNode:P,placeholderNode:k.source,placeholderEntity:k.entity,promptEntity:N,vectorDatabaseEntity:I}}).filter(Boolean);s(C)}},[f==null?void 0:f.id]),j=g.useCallback(async()=>{try{if(d.current.handling=f==null?void 0:f.id,!(f!=null&&f.id)||!(f!=null&&f.main_source_id)||(f==null?void 0:f.main_source_type)!=="Thread")return;const[M,C]=await Promise.all([de("Thread").findOne({where:{id:f.main_source_id,session_id:f.id}}),de("FlowNode").findOne({where:{id:f.main_node_id}})]);if(!M||!C)return;const k=await de("FlowEdge").find({where:{session_id:f.id,target:C.id}}),{flowNodes:T,flowNodeDatas:P}=await Sm({where:{session_id:f.id,id:qa(k.map(F=>F.source))}}),N=(await de("FlowEdge").find({where:{session_id:f.id}})).filter(F=>F.target===C.id).map(F=>{var z;const $=T.find(X=>X.id===F.source);return{connection:F,source:$,entity:(z=P==null?void 0:P[$.source_type])==null?void 0:z.find(X=>X.id===$.source_id)}}),I=N.find(F=>F.source.source_type==="LLM"),A=N.filter(F=>F.source.source_type==="Prompt"),R=N.find(F=>F.source.source_type==="Schema"),L=I==null?void 0:I.entity;if(!L)return;f.passphrase&&await Cm(f.passphrase,m.current);const D=N.filter(F=>F.source.source_type==="FlowNodePlaceholder");await w(D),await b(C,(A==null?void 0:A.map(F=>F.entity))||[]),o({llm:L,status:L.status||Je.Started,progress:""}),r({thread:M,threadNode:C});const B=R==null?void 0:R.entity;if(B){const F=await de("SchemaItem").find({where:{schema_id:B.id}});B.schema_items=F||[]}t({prompts:(A==null?void 0:A.map(F=>F.entity))||[],schema:B}),d.current.handled=f.id}finally{d.current.handling=void 0}},[f==null?void 0:f.id,f==null?void 0:f.main_node_id,f==null?void 0:f.main_source_id,f==null?void 0:f.main_source_type,f==null?void 0:f.passphrase,w,b,m]),x=g.useCallback(async()=>{var M;if((M=a==null?void 0:a.llm)!=null&&M.name)try{o(C=>C&&{...C,status:Je.Loading}),await p(a.llm.provider,a==null?void 0:a.llm.name,C=>{o(k=>k&&{...k,progress:C.text})}),o(C=>C&&{...C,status:Je.Loaded,progress:""})}catch{o(C=>C&&{...C,status:Je.Started,progress:""})}},[(E=a==null?void 0:a.llm)==null?void 0:E.name,(O=a==null?void 0:a.llm)==null?void 0:O.provider,p]),_=g.useCallback(M=>(u.current=M,()=>{u.current=void 0}),[]),S=g.useCallback(async M=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await de("JSONData").save({...c.enity,data:M})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(f==null?void 0:f.id)||j()},[f==null?void 0:f.id,j]),{...e,loadLLM:x,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:S,addNewDataNode:v,selectDataNode:y,setLLMInfo:o,onThreadMessagesLoaded:_}};class Hfe extends yp{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await Ht(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>S6);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await Ht(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>S6);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await Ht(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-BoZoTcMw.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class p6 extends MDe{}class h6 extends p6{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new zr(this.value)]}}class Kfe extends p6{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return kDe(this.messages)}toChatMessages(){return this.messages}}Sk=class extends Hfe{async formatPromptValue(e){const t=await this.format(e);return new h6(t)}};var Zfe=Object.prototype.toString,Rc=Array.isArray||function(e){return Zfe.call(e)==="[object Array]"};function fj(e){return typeof e=="function"}function Gfe(e){return Rc(e)?"array":typeof e}function pj(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function m6(e,t){return e!=null&&typeof e=="object"&&t in e}function Xfe(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var Jfe=RegExp.prototype.test;function Yfe(e,t){return Jfe.call(e,t)}var Qfe=/\S/;function epe(e){return!Yfe(Qfe,e)}var tpe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function npe(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return tpe[t]})}var rpe=/\s*/,ape=/\s+/,y6=/\s*=/,ope=/\s*\}/,ipe=/#|\^|\/|>|\{|&|=|!/;function spe(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,f,p;function m(O){if(typeof O=="string"&&(O=O.split(ape,2)),!Rc(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(pj(O[0])+"\\s*"),f=new RegExp("\\s*"+pj(O[1])),p=new RegExp("\\s*"+pj("}"+O[1]))}m(t||Yn.tags);for(var y=new Ad(e),v,b,w,j,x,_;!y.eos();){if(v=y.pos,w=y.scanUntil(d),w)for(var S=0,E=w.length;S<E;++S)j=w.charAt(S),epe(j)?(o.push(a.length),c+=j):(s=!0,n=!0,c+=" "),a.push(["text",j,v,v+1]),v+=1,j===`
`&&(u(),c="",l=0,n=!1);if(!y.scan(d))break;if(i=!0,b=y.scan(ipe)||"name",y.scan(rpe),b==="="?(w=y.scanUntil(y6),y.scan(y6),y.scanUntil(f)):b==="{"?(w=y.scanUntil(p),y.scan(ope),y.scanUntil(f),b="&"):w=y.scanUntil(f),!y.scan(f))throw new Error("Unclosed tag at "+y.pos);if(b==">"?x=[b,w,v,y.pos,c,l,n]:x=[b,w,v,y.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(_=r.pop(),!_)throw new Error('Unopened section "'+w+'" at '+v);if(_[1]!==w)throw new Error('Unclosed section "'+_[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&m(w)}if(u(),_=r.pop(),_)throw new Error('Unclosed section "'+_[1]+'" at '+y.pos);return lpe(cpe(a))}function cpe(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function lpe(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function Ad(e){this.string=e,this.tail=e,this.pos=0}Ad.prototype.eos=function(){return this.tail===""},Ad.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Ad.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function Dc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}Dc.prototype.push=function(e){return new Dc(e,this)},Dc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=m6(a,o[i])||Xfe(a,o[i])),a=a[o[i++]];else a=r.view[e],s=m6(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return fj(n)&&(n=n.call(this.view)),n};function Vn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Vn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Vn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||Yn.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=spe(e,t),a&&n.set(r,o)),o},Vn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof Dc?t:new Dc(t,void 0);return this.renderTokens(o,i,n,e,r)},Vn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Vn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(Rc(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(fj(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Vn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||Rc(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Vn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Vn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=fj(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Vn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Vn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||Yn.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Yn.escape?String(a):r(a)},Vn.prototype.rawValue=function(e){return e[1]},Vn.prototype.getConfigTags=function(e){return Rc(e)?e:e&&typeof e=="object"?e.tags:void 0},Vn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Rc(e))return e.escape};var Yn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){Td.templateCache=e},get templateCache(){return Td.templateCache}},Td=new Vn;Yn.clearCache=function(){return Td.clearCache()},Yn.parse=function(e,t){return Td.parse(e,t)},Yn.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Gfe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Td.render(e,t,n,r)},Yn.escape=npe,Yn.Scanner=Ad,Yn.Context=Dc,Yn.Writer=Vn;function g6(){Yn.escape=e=>e}let hj,v6,b6,w6,x6,Nm,_6,j6;hj=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},v6=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),b6=e=>{g6();const t=Yn.parse(e);return v6(t)},w6=(e,t)=>hj(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),x6=(e,t)=>(g6(),Yn.render(e,t)),Nm={"f-string":w6,mustache:x6},_6={"f-string":hj,mustache:b6},Zs=(e,t,n)=>Nm[t](e,n),j6=(e,t)=>_6[t](e),Ek=(e,t,n)=>{if(!(t in Nm)){const r=Object.keys(Nm);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Zs(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Zs(a.image_url,t,r);else{const o=a.image_url.url;Zs(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Zs(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},ai=class extends Sk{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),Ek(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Zs(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new ai({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return j6(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new ai({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new ai(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new ai({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const S6=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:ai},Symbol.toStringTag,{value:"Module"})),mj="RFC3986",yj={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},upe="RFC1738",dpe=Array.isArray,Wa=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),gj=1024,fpe=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=gj){const c=o.length>=gj?o.slice(s,s+gj):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===upe&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Wa[d];continue}if(d<2048){l[l.length]=Wa[192|d>>6]+Wa[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Wa[224|d>>12]+Wa[128|d>>6&63]+Wa[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Wa[240|d>>18]+Wa[128|d>>12&63]+Wa[128|d>>6&63]+Wa[128|d&63]}i+=l.join("")}return i};function ppe(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function E6(e,t){if(dpe(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const hpe=Object.prototype.hasOwnProperty,O6={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ha=Array.isArray,mpe=Array.prototype.push,C6=function(e,t){mpe.apply(e,Ha(t)?t:[t])},ype=Date.prototype.toISOString,fn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:fpe,encodeValuesOnly:!1,format:mj,formatter:yj[mj],indices:!1,serializeDate(e){return ype.call(e)},skipNulls:!1,strictNullHandling:!1};function gpe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const vj={};function N6(e,t,n,r,a,o,i,s,c,l,u,d,f,p,m,y,v,b){let w=e,j=b,x=0,_=!1;for(;(j=j.get(vj))!==void 0&&!_;){const C=j.get(e);if(x+=1,typeof C<"u"){if(C===x)throw new RangeError("Cyclic object value");_=!0}typeof j.get(vj)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=f==null?void 0:f(w):n==="comma"&&Ha(w)&&(w=E6(w,function(C){return C instanceof Date?f==null?void 0:f(C):C})),w===null){if(o)return c&&!y?c(t,fn.encoder,v,"key",p):t;w=""}if(gpe(w)||ppe(w)){if(c){const C=y?t:c(t,fn.encoder,v,"key",p);return[(m==null?void 0:m(C))+"="+(m==null?void 0:m(c(w,fn.encoder,v,"value",p)))]}return[(m==null?void 0:m(t))+"="+(m==null?void 0:m(String(w)))]}const S=[];if(typeof w>"u")return S;let E;if(n==="comma"&&Ha(w))y&&c&&(w=E6(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ha(l))E=l;else{const C=Object.keys(w);E=u?C.sort(u):C}const O=s?String(t).replace(/\./g,"%2E"):String(t),M=r&&Ha(w)&&w.length===1?O+"[]":O;if(a&&Ha(w)&&w.length===0)return M+"[]";for(let C=0;C<E.length;++C){const k=E[C],T=typeof k=="object"&&typeof k.value<"u"?k.value:w[k];if(i&&T===null)continue;const P=d&&s?k.replace(/\./g,"%2E"):k,N=Ha(w)?typeof n=="function"?n(M,P):M:M+(d?"."+P:"["+P+"]");b.set(e,x);const I=new WeakMap;I.set(vj,b),C6(S,N6(T,N,n,r,a,o,i,s,n==="comma"&&y&&Ha(w)?null:c,l,u,d,f,p,m,y,v,I))}return S}function vpe(e=fn){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||fn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=mj;if(typeof e.format<"u"){if(!hpe.call(yj,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=yj[n];let a=fn.filter;(typeof e.filter=="function"||Ha(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in O6?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=fn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:fn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:fn.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:fn.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:fn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?fn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:fn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:fn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:fn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:fn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:fn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:fn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:fn.strictNullHandling}}function bpe(e,t={}){let n=e;const r=vpe(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Ha(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=O6[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let f=0;f<a.length;++f){const p=a[f];r.skipNulls&&n[p]===null||C6(i,N6(n[p],p,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Lc="4.78.1";let M6=!1,Id,k6,P6,bj,A6,T6,I6,R6,D6;function wpe(e,t={auto:!1}){if(M6)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Id)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Id}'\``);M6=t.auto,Id=e.kind,k6=e.fetch,P6=e.FormData,bj=e.File,A6=e.ReadableStream,T6=e.getMultipartRequestOptions,I6=e.getDefaultAgent,R6=e.fileFromPath,D6=e.isFsReadStream}let xpe=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function _pe({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new xpe(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Id||wpe(_pe(),{auto:!0});class rt extends Error{}let Qn=class Dk extends rt{constructor(t,n,r,a){super(`${Dk.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Mm({message:r,cause:jj(n)});const o=n==null?void 0:n.error;return t===400?new L6(t,o,r,a):t===401?new $6(t,o,r,a):t===403?new F6(t,o,r,a):t===404?new B6(t,o,r,a):t===409?new z6(t,o,r,a):t===422?new U6(t,o,r,a):t===429?new V6(t,o,r,a):t>=500?new q6(t,o,r,a):new Dk(t,o,r,a)}},kr=class extends Qn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Mm=class extends Qn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},km=class extends Mm{constructor({message:e}={}){super({message:e??"Request timed out."})}},L6=class extends Qn{},$6=class extends Qn{},F6=class extends Qn{},B6=class extends Qn{},z6=class extends Qn{},U6=class extends Qn{},V6=class extends Qn{},q6=class extends Qn{};class W6 extends rt{constructor(){super("Could not parse response content as the length limit was reached")}}class H6 extends rt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let Pm=class Lk{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Lk.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(Lk.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof jn<"u"){if(t instanceof jn)return t.toString();if(t instanceof Uint8Array)return jn.from(t).toString();throw new rt(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new rt(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new rt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}};Pm.NEWLINE_CHARS=new Set([`
`,"\r"]),Pm.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let Rd=class Ep{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of jpe(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new Qn(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new Qn(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Ep(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Pm,s=K6(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Ep(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Ep(()=>a(t),this.controller),new Ep(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new A6({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}};async function*jpe(e,t){if(!e.body)throw t.abort(),new rt("Attempted to iterate over a response with no body");const n=new Ope,r=new Pm,a=K6(e.body);for await(const o of Spe(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*Spe(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Epe(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Epe(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}let Ope=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Cpe(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function Cpe(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function K6(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Z6=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",G6=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Am(e),Am=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Npe=e=>G6(e)||Z6(e)||D6(e);async function X6(e,t,n){var a;if(e=await e,G6(e))return e;if(Z6(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Am(o)?[await o.arrayBuffer()]:[o];return new bj(i,t,n)}const r=await Mpe(e);if(t||(t=Ppe(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new bj(r,t,n)}async function Mpe(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Am(e))t.push(await e.arrayBuffer());else if(Ape(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${kpe(e)}`);return t}function kpe(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Ppe(e){var t;return wj(e.name)||wj(e.filename)||((t=wj(e.path))==null?void 0:t.split(/[\\/]/).pop())}const wj=e=>{if(typeof e=="string")return e;if(typeof jn<"u"&&e instanceof jn)return String(e)},Ape=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",J6=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",$c=async e=>{const t=await Tpe(e.body);return T6(t,e)},Tpe=async e=>{const t=new P6;return await Promise.all(Object.entries(e||{}).map(([n,r])=>xj(t,n,r))),t},xj=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Npe(n)){const r=await X6(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>xj(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>xj(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Fc={},Ipe=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Rpe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Tm;async function Y6(e){const{response:t}=e;if(e.options.stream)return Bc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Rd.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Bc("response",t.status,t.url,t.headers,a),Q6(a,t)}const r=await t.text();return Bc("response",t.status,t.url,t.headers,r),r}function Q6(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}let e$=class rX extends Promise{constructor(t,n=Y6){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new rX(this.responsePromise,async n=>Q6(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}},Dpe=class{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=_j("maxRetries",t),this.timeout=_j("timeout",n),this.httpAgent=r,this.fetch=a??k6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Upe(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Hpe()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&Am(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof jn<"u")return jn.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:n,path:r,query:a,headers:o={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:J6(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in e&&_j("timeout",e.timeout);const l=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??I6(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:o,contentLength:s,retryCount:t});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:e.signal??null},url:c,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return s$(a,o),s$(a,t),J6(e.body)&&Id!=="node"&&delete a["content-type"],c$(o,"x-stainless-retry-count")===void 0&&c$(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return Qn.generate(e,t,n,r)}request(e,t=null){return new e$(this.makeRequest(e,t))}async makeRequest(e,t){var u,d;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:o,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:o,options:n}),Bc("request",o,n,a.headers),(u=n.signal)==null?void 0:u.aborted)throw new kr;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(jj);if(c instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new kr;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new km:new Mm({cause:c})}const l=$pe(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const y=`retrying, ${t} attempts remaining`;return Bc(`response (error; ${y})`,c.status,o,l),this.retryRequest(n,t,l)}const f=await c.text().catch(y=>jj(y).message),p=Vpe(f),m=p?void 0:f;throw Bc(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,p,m,l)}return{response:c,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Lpe(this,n,e)}buildURL(e,t){const n=Wpe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return o$(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new rt(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>r.abort());const i=setTimeout(()=>r.abort(),n),s={signal:r.signal,...o};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally(()=>{clearTimeout(i)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const i=parseFloat(a);Number.isNaN(i)||(r=i)}const o=n==null?void 0:n["retry-after"];if(o&&!r){const i=parseFloat(o);Number.isNaN(i)?r=Date.parse(o)-Date.now():r=i*1e3}if(!(r&&0<=r&&r<60*1e3)){const i=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,i)}return await Dd(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e,r=Math.min(.5*Math.pow(2,n),8),a=1-Math.random()*.25;return r*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Lc}`}};class t${constructor(t,n,r,a){Tm.set(this,void 0),Ipe(this,Tm,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new rt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Rpe(this,Tm,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Tm=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}let Lpe=class extends e${constructor(e,t,n){super(t,async r=>new n(e,r.response,await Y6(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const $pe=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Fpe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},er=e=>typeof e=="object"&&e!==null&&!o$(e)&&Object.keys(e).every(t=>i$(Fpe,t)),Bpe=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":r$(Deno.build.os),"X-Stainless-Arch":n$(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Sn.version};if(Object.prototype.toString.call(typeof Sn<"u"?Sn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":r$(Sn.platform),"X-Stainless-Arch":n$(Sn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Sn.version};const e=zpe();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function zpe(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const n$=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",r$=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let a$;const Upe=()=>a$??(a$=Bpe()),Vpe=e=>{try{return JSON.parse(e)}catch{return}},qpe=/^[a-z][a-z0-9+.-]*:/i,Wpe=e=>qpe.test(e),Dd=e=>new Promise(t=>setTimeout(t,e)),_j=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new rt(`${e} must be an integer`);if(t<0)throw new rt(`${e} must be a positive integer`);return t},jj=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Im=e=>{var t,n,r,a;if(typeof Sn<"u")return((t=Fc==null?void 0:Fc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function o$(e){if(!e)return!0;for(const t in e)return!1;return!0}function i$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s$(e,t){for(const n in t){if(!i$(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Bc(e,...t){typeof Sn<"u"&&(Fc==null?void 0:Fc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Hpe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Kpe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Zpe=e=>typeof(e==null?void 0:e.get)=="function",c$=(e,t)=>{var r;const n=t.toLowerCase();if(Zpe(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function Sj(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Gpe extends t${constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class aa extends t${constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}let mt=class{constructor(e){this._client=e}},l$=class extends mt{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Ej=class extends mt{constructor(){super(...arguments),this.completions=new l$(this._client)}};Ej.Completions=l$;class u$ extends mt{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}let d$=class extends mt{create(e,t){return this._client.post("/audio/transcriptions",$c({body:e,...t}))}},f$=class extends mt{create(e,t){return this._client.post("/audio/translations",$c({body:e,...t}))}},Ld=class extends mt{constructor(){super(...arguments),this.transcriptions=new d$(this._client),this.translations=new f$(this._client),this.speech=new u$(this._client)}};Ld.Transcriptions=d$,Ld.Translations=f$,Ld.Speech=u$;class Oj extends mt{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return er(t)?this.list({},t):this._client.getAPIList("/batches",Cj,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class Cj extends aa{}Oj.BatchesPage=Cj;class Nj extends mt{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return er(t)?this.list({},t):this._client.getAPIList("/assistants",Mj,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Mj extends aa{}Nj.AssistantsPage=Mj;function p$(e){return typeof e.parse=="function"}const zc=e=>(e==null?void 0:e.role)==="assistant",h$=e=>(e==null?void 0:e.role)==="function",m$=e=>(e==null?void 0:e.role)==="tool";var oa=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Kt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},kj,Rm,Dm,$d,Fd,Lm,Bd,Ro,zd,$m,Fm,Uc,y$;class g${constructor(){kj.add(this),this.controller=new AbortController,Rm.set(this,void 0),Dm.set(this,()=>{}),$d.set(this,()=>{}),Fd.set(this,void 0),Lm.set(this,()=>{}),Bd.set(this,()=>{}),Ro.set(this,{}),zd.set(this,!1),$m.set(this,!1),Fm.set(this,!1),Uc.set(this,!1),oa(this,Rm,new Promise((t,n)=>{oa(this,Dm,t,"f"),oa(this,$d,n,"f")}),"f"),oa(this,Fd,new Promise((t,n)=>{oa(this,Lm,t,"f"),oa(this,Bd,n,"f")}),"f"),Kt(this,Rm,"f").catch(()=>{}),Kt(this,Fd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Kt(this,kj,"m",y$).bind(this))},0)}_connected(){this.ended||(Kt(this,Dm,"f").call(this),this._emit("connect"))}get ended(){return Kt(this,zd,"f")}get errored(){return Kt(this,$m,"f")}get aborted(){return Kt(this,Fm,"f")}abort(){this.controller.abort()}on(t,n){return(Kt(this,Ro,"f")[t]||(Kt(this,Ro,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Kt(this,Ro,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Kt(this,Ro,"f")[t]||(Kt(this,Ro,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{oa(this,Uc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){oa(this,Uc,!0,"f"),await Kt(this,Fd,"f")}_emit(t,...n){if(Kt(this,zd,"f"))return;t==="end"&&(oa(this,zd,!0,"f"),Kt(this,Lm,"f").call(this));const r=Kt(this,Ro,"f")[t];if(r&&(Kt(this,Ro,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Kt(this,Uc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Kt(this,$d,"f").call(this,a),Kt(this,Bd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Kt(this,Uc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Kt(this,$d,"f").call(this,a),Kt(this,Bd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Rm=new WeakMap,Dm=new WeakMap,$d=new WeakMap,Fd=new WeakMap,Lm=new WeakMap,Bd=new WeakMap,Ro=new WeakMap,zd=new WeakMap,$m=new WeakMap,Fm=new WeakMap,Uc=new WeakMap,kj=new WeakSet,y$=function(e){if(oa(this,$m,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new kr),e instanceof kr)return oa(this,Fm,!0,"f"),this._emit("abort",e);if(e instanceof rt)return this._emit("error",e);if(e instanceof Error){const t=new rt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new rt(String(e)))};function Xpe(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function v$(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Jpe(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function Ud(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Ype(e,t){return!t||!b$(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:Pj(e,t)}function Pj(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new W6;if(r.finish_reason==="content_filter")throw new H6;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>ehe(t,o)))??[],parsed:r.message.content&&!r.message.refusal?Qpe(t,r.message.content):null}}});return{...e,choices:n}}function Qpe(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function ehe(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Ud(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function the(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return Ud(n)||(n==null?void 0:n.function.strict)||!1}function b$(e){var t;return v$(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Ud(n)||n.type==="function"&&n.function.strict===!0))??!1}function nhe(e){for(const t of e??[]){if(t.type!=="function")throw new rt(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new rt(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var tr=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Tn,Aj,Bm,Tj,Ij,Rj,w$,Dj;const x$=10;class _$ extends g${constructor(){super(...arguments),Tn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(h$(t)||m$(t))&&t.content)this._emit("functionCallResult",t.content);else if(zc(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(zc(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new rt("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),tr(this,Tn,"m",Aj).call(this)}async finalMessage(){return await this.done(),tr(this,Tn,"m",Bm).call(this)}async finalFunctionCall(){return await this.done(),tr(this,Tn,"m",Tj).call(this)}async finalFunctionCallResult(){return await this.done(),tr(this,Tn,"m",Ij).call(this)}async totalUsage(){return await this.done(),tr(this,Tn,"m",Rj).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=tr(this,Tn,"m",Bm).call(this);n&&this._emit("finalMessage",n);const r=tr(this,Tn,"m",Aj).call(this);r&&this._emit("finalContent",r);const a=tr(this,Tn,"m",Tj).call(this);a&&this._emit("finalFunctionCall",a);const o=tr(this,Tn,"m",Ij).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",tr(this,Tn,"m",Rj).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),tr(this,Tn,"m",w$).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Pj(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var f;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=x$}=r||{},u={};for(const p of n.functions)u[p.name||p.function.name]=p;const d=n.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const m=(f=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!m)throw new rt("missing message in ChatCompletion response");if(!m.function_call)return;const{name:y,arguments:v}=m.function_call,b=u[y];if(b){if(c&&c!==y){const _=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:y,content:_});continue}}else{const _=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${d.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:y,content:_});continue}let w;try{w=p$(b)?await b.parse(v):v}catch(_){this._addMessage({role:a,name:y,content:_ instanceof Error?_.message:String(_)});continue}const j=await b.function(w,this),x=tr(this,Tn,"m",Dj).call(this,j);if(this._addMessage({role:a,name:y,content:x}),c)return}}async _runTools(t,n,r){var p,m,y;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((p=o==null?void 0:o.function)==null?void 0:p.name),{maxChatCompletions:l=x$}=r||{},u=n.tools.map(v=>{if(Ud(v)){if(!v.$callback)throw new rt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const f="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(m=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:m.message;if(!b)throw new rt("missing message in ChatCompletion response");if(!((y=b.tool_calls)!=null&&y.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const j=w.id,{name:x,arguments:_}=w.function,S=d[x];if(S){if(c&&c!==x){const C=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:j,content:C});continue}}else{const C=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(k=>JSON.stringify(k)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:j,content:C});continue}let E;try{E=p$(S)?await S.parse(_):_}catch(C){const k=C instanceof Error?C.message:String(C);this._addMessage({role:a,tool_call_id:j,content:k});continue}const O=await S.function(E,this),M=tr(this,Tn,"m",Dj).call(this,O);if(this._addMessage({role:a,tool_call_id:j,content:M}),c)return}}}}Tn=new WeakSet,Aj=function(){return tr(this,Tn,"m",Bm).call(this).content??null},Bm=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(zc(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new rt("stream ended without producing a ChatCompletionMessage with role=assistant")},Tj=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(zc(r)&&(r!=null&&r.function_call))return r.function_call;if(zc(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},Ij=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(h$(t)&&t.content!=null||m$(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},Rj=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},w$=function(e){if(e.n!=null&&e.n>1)throw new rt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Dj=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Vd extends _${static runFunctions(t,n,r){const a=new Vd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Vd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),zc(t)&&t.content&&this._emit("content",t.content)}}const j$=1,S$=2,E$=4,O$=8,C$=16,N$=32,M$=64,k$=128,P$=256,A$=k$|P$,T$=C$|N$|A$|M$,I$=j$|S$|T$,R$=E$|O$,rhe=I$|R$,gn={STR:j$,NUM:S$,ARR:E$,OBJ:O$,NULL:C$,BOOL:N$,NAN:M$,INFINITY:k$,MINUS_INFINITY:P$,INF:A$,SPECIAL:T$,ATOM:I$,COLLECTION:R$,ALL:rhe};class ahe extends Error{}class ohe extends Error{}function ihe(e,t=gn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return she(e.trim(),t)}const she=(e,t)=>{const n=e.length;let r=0;const a=f=>{throw new ahe(`${f} at position ${r}`)},o=f=>{throw new ohe(`${f} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||gn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||gn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||gn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||gn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||gn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||gn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const f=r;let p=!1;for(r++;r<n&&(e[r]!=='"'||p&&e[r-1]==="\\");)p=e[r]==="\\"?!p:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(f,++r-Number(p)))}catch(m){o(String(m))}else if(gn.STR&t)try{return JSON.parse(e.substring(f,r-Number(p))+'"')}catch{return JSON.parse(e.substring(f,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const f={};try{for(;e[r]!=="}";){if(d(),r>=n&&gn.OBJ&t)return f;const p=s();d(),r++;try{const m=i();Object.defineProperty(f,p,{value:m,writable:!0,enumerable:!0,configurable:!0})}catch(m){if(gn.OBJ&t)return f;throw m}d(),e[r]===","&&r++}}catch{if(gn.OBJ&t)return f;a("Expected '}' at end of object")}return r++,f},l=()=>{r++;const f=[];try{for(;e[r]!=="]";)f.push(i()),d(),e[r]===","&&r++}catch{if(gn.ARR&t)return f;a("Expected ']' at end of array")}return r++,f},u=()=>{if(r===0){e==="-"&&gn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(p){if(gn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(p))}}const f=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(gn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(f,r))}catch{e.substring(f,r)==="-"&&gn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(f,e.lastIndexOf("e")))}catch(p){o(String(p))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},D$=e=>ihe(e,gn.ALL^gn.NUM);var Vc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},kt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},pn,Do,qc,vi,Lj,zm,$j,Fj,Bj,Um,zj,L$;class qd extends _${constructor(t){super(),pn.add(this),Do.set(this,void 0),qc.set(this,void 0),vi.set(this,void 0),Vc(this,Do,t,"f"),Vc(this,qc,[],"f")}get currentChatCompletionSnapshot(){return kt(this,vi,"f")}static fromReadableStream(t){const n=new qd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new qd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),kt(this,pn,"m",Lj).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)kt(this,pn,"m",$j).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new kr;return this._addChatCompletion(kt(this,pn,"m",Um).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),kt(this,pn,"m",Lj).call(this),this._connected();const a=Rd.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(kt(this,pn,"m",Um).call(this)),kt(this,pn,"m",$j).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new kr;return this._addChatCompletion(kt(this,pn,"m",Um).call(this))}[(Do=new WeakMap,qc=new WeakMap,vi=new WeakMap,pn=new WeakSet,Lj=function(){this.ended||Vc(this,vi,void 0,"f")},zm=function(t){let n=kt(this,qc,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},kt(this,qc,"f")[t.index]=n,n)},$j=function(t){var r,a,o,i,s,c,l,u,d,f,p,m,y,v,b;if(this.ended)return;const n=kt(this,pn,"m",L$).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const j=n.choices[w.index];w.delta.content!=null&&((r=j.message)==null?void 0:r.role)==="assistant"&&((a=j.message)!=null&&a.content)&&(this._emit("content",w.delta.content,j.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:j.message.content,parsed:j.message.parsed})),w.delta.refusal!=null&&((o=j.message)==null?void 0:o.role)==="assistant"&&((i=j.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:j.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=j.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=j.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((f=j.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=w.logprobs)==null?void 0:p.refusal,snapshot:((m=j.logprobs)==null?void 0:m.refusal)??[]});const x=kt(this,pn,"m",zm).call(this,j);j.finish_reason&&(kt(this,pn,"m",Bj).call(this,j),x.current_tool_call_index!=null&&kt(this,pn,"m",Fj).call(this,j,x.current_tool_call_index));for(const _ of w.delta.tool_calls??[])x.current_tool_call_index!==_.index&&(kt(this,pn,"m",Bj).call(this,j),x.current_tool_call_index!=null&&kt(this,pn,"m",Fj).call(this,j,x.current_tool_call_index)),x.current_tool_call_index=_.index;for(const _ of w.delta.tool_calls??[]){const S=(y=j.message.tool_calls)==null?void 0:y[_.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=S.function)==null?void 0:v.name,index:_.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((b=_.function)==null?void 0:b.arguments)??""}):S==null||S.type)}}},Fj=function(t,n){var a,o,i;if(kt(this,pn,"m",zm).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=kt(this,Do,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:Ud(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},Bj=function(t){var r,a;const n=kt(this,pn,"m",zm).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=kt(this,pn,"m",zj).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Um=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");const t=kt(this,vi,"f");if(!t)throw new rt("request ended without sending any chunks");return Vc(this,vi,void 0,"f"),Vc(this,qc,[],"f"),che(t,kt(this,Do,"f"))},zj=function(){var n;const t=(n=kt(this,Do,"f"))==null?void 0:n.response_format;return v$(t)?t:null},L$=function(t){var n,r,a,o;let i=kt(this,vi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Vc(this,vi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:f=null,...p}of t.choices){let m=i.choices[d];if(m||(m=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:f,...p}),f)if(!m.logprobs)m.logprobs=Object.assign({},f);else{const{content:_,refusal:S,...E}=f;Object.assign(m.logprobs,E),_&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(..._)),S&&((r=m.logprobs).refusal??(r.refusal=[]),m.logprobs.refusal.push(...S))}if(u&&(m.finish_reason=u,kt(this,Do,"f")&&b$(kt(this,Do,"f")))){if(u==="length")throw new W6;if(u==="content_filter")throw new H6}if(Object.assign(m,p),!l)continue;const{content:y,refusal:v,function_call:b,role:w,tool_calls:j,...x}=l;if(Object.assign(m.message,x),v&&(m.message.refusal=(m.message.refusal||"")+v),w&&(m.message.role=w),b&&(m.message.function_call?(b.name&&(m.message.function_call.name=b.name),b.arguments&&((a=m.message.function_call).arguments??(a.arguments=""),m.message.function_call.arguments+=b.arguments)):m.message.function_call=b),y&&(m.message.content=(m.message.content||"")+y,!m.message.refusal&&kt(this,pn,"m",zj).call(this)&&(m.message.parsed=D$(m.message.content))),j){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:_,id:S,type:E,function:O,...M}of j){const C=(o=m.message.tool_calls)[_]??(o[_]={});Object.assign(C,M),S&&(C.id=S),E&&(C.type=E),O&&(C.function??(C.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(C.function.name=O.name),O!=null&&O.arguments&&(C.function.arguments+=O.arguments,the(kt(this,Do,"f"),C)&&(C.function.parsed_arguments=D$(C.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Rd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function che(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:f,...p})=>{if(!u)throw new rt(`missing finish_reason for choice ${d}`);const{content:m=null,function_call:y,tool_calls:v,...b}=l,w=l.role;if(!w)throw new rt(`missing role for choice ${d}`);if(y){const{arguments:j,name:x}=y;if(j==null)throw new rt(`missing function_call.arguments for choice ${d}`);if(!x)throw new rt(`missing function_call.name for choice ${d}`);return{...p,message:{content:m,function_call:{arguments:j,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}return v?{...p,index:d,finish_reason:u,logprobs:f,message:{...b,role:w,content:m,refusal:l.refusal??null,tool_calls:v.map((j,x)=>{const{function:_,type:S,id:E,...O}=j,{arguments:M,name:C,...k}=_||{};if(E==null)throw new rt(`missing choices[${d}].tool_calls[${x}].id
${Vm(e)}`);if(S==null)throw new rt(`missing choices[${d}].tool_calls[${x}].type
${Vm(e)}`);if(C==null)throw new rt(`missing choices[${d}].tool_calls[${x}].function.name
${Vm(e)}`);if(M==null)throw new rt(`missing choices[${d}].tool_calls[${x}].function.arguments
${Vm(e)}`);return{...O,id:E,type:S,function:{...k,name:C,arguments:M}}})}}:{...p,message:{...b,content:m,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Ype(c,t)}function Vm(e){return JSON.stringify(e)}class Wc extends qd{static fromReadableStream(t){const n=new Wc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Wc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Wc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let $$=class extends mt{parse(e,t){return nhe(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Pj(n,e))}runFunctions(e,t){return e.stream?Wc.runFunctions(this._client,e,t):Vd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Wc.runTools(this._client,e,t):Vd.runTools(this._client,e,t)}stream(e,t){return qd.createChatCompletion(this._client,e,t)}},Uj=class extends mt{constructor(){super(...arguments),this.completions=new $$(this._client)}};(function(e){e.Completions=$$})(Uj||(Uj={}));class F$ extends mt{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Vj extends mt{constructor(){super(...arguments),this.sessions=new F$(this._client)}}Vj.Sessions=F$;var Ie=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},xr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Nn,qj,Ka,qm,ia,fs,Hc,ps,Wm,_r,Hm,Km,Wd,Hd,Kd,B$,z$,U$,V$,q$,W$,H$;class sa extends g${constructor(){super(...arguments),Nn.add(this),qj.set(this,[]),Ka.set(this,{}),qm.set(this,{}),ia.set(this,void 0),fs.set(this,void 0),Hc.set(this,void 0),ps.set(this,void 0),Wm.set(this,void 0),_r.set(this,void 0),Hm.set(this,void 0),Km.set(this,void 0),Wd.set(this,void 0)}[(qj=new WeakMap,Ka=new WeakMap,qm=new WeakMap,ia=new WeakMap,fs=new WeakMap,Hc=new WeakMap,ps=new WeakMap,Wm=new WeakMap,_r=new WeakMap,Hm=new WeakMap,Km=new WeakMap,Wd=new WeakMap,Nn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new sa;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Rd.fromReadableStream(t,this.controller);for await(const i of a)Ie(this,Nn,"m",Hd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new kr;return this._addRun(Ie(this,Nn,"m",Kd).call(this))}toReadableStream(){return new Rd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new sa;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Ie(this,Nn,"m",Hd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new kr;return this._addRun(Ie(this,Nn,"m",Kd).call(this))}static createThreadAssistantStream(t,n,r){const a=new sa;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new sa;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Ie(this,Hm,"f")}currentRun(){return Ie(this,Km,"f")}currentMessageSnapshot(){return Ie(this,ia,"f")}currentRunStepSnapshot(){return Ie(this,Wd,"f")}async finalRunSteps(){return await this.done(),Object.values(Ie(this,Ka,"f"))}async finalMessages(){return await this.done(),Object.values(Ie(this,qm,"f"))}async finalRun(){if(await this.done(),!Ie(this,fs,"f"))throw Error("Final run was not received.");return Ie(this,fs,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Ie(this,Nn,"m",Hd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new kr;return this._addRun(Ie(this,Nn,"m",Kd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Ie(this,Nn,"m",Hd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new kr;return this._addRun(Ie(this,Nn,"m",Kd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(Sj(o)&&Sj(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!Sj(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}Hd=function(e){if(!this.ended)switch(xr(this,Hm,e,"f"),Ie(this,Nn,"m",U$).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ie(this,Nn,"m",H$).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ie(this,Nn,"m",z$).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ie(this,Nn,"m",B$).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Kd=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");if(!Ie(this,fs,"f"))throw Error("Final run has not been received");return Ie(this,fs,"f")},B$=function(e){const[t,n]=Ie(this,Nn,"m",q$).call(this,e,Ie(this,ia,"f"));xr(this,ia,t,"f"),Ie(this,qm,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Ie(this,Hc,"f")){if(Ie(this,ps,"f"))switch(Ie(this,ps,"f").type){case"text":this._emit("textDone",Ie(this,ps,"f").text,Ie(this,ia,"f"));break;case"image_file":this._emit("imageFileDone",Ie(this,ps,"f").image_file,Ie(this,ia,"f"));break}xr(this,Hc,r.index,"f")}xr(this,ps,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ie(this,Hc,"f")!==void 0){const r=e.data.content[Ie(this,Hc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Ie(this,ia,"f"));break;case"text":this._emit("textDone",r.text,Ie(this,ia,"f"));break}}Ie(this,ia,"f")&&this._emit("messageDone",e.data),xr(this,ia,void 0,"f")}},z$=function(e){const t=Ie(this,Nn,"m",V$).call(this,e);switch(xr(this,Wd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Ie(this,Wm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Ie(this,_r,"f")&&this._emit("toolCallDone",Ie(this,_r,"f")),xr(this,Wm,r.index,"f"),xr(this,_r,t.step_details.tool_calls[r.index],"f"),Ie(this,_r,"f")&&this._emit("toolCallCreated",Ie(this,_r,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":xr(this,Wd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ie(this,_r,"f")&&(this._emit("toolCallDone",Ie(this,_r,"f")),xr(this,_r,void 0,"f")),this._emit("runStepDone",e.data,t);break}},U$=function(e){Ie(this,qj,"f").push(e),this._emit("event",e)},V$=function(e){switch(e.event){case"thread.run.step.created":return Ie(this,Ka,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ie(this,Ka,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=sa.accumulateDelta(t,n.delta);Ie(this,Ka,"f")[e.data.id]=r}return Ie(this,Ka,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ie(this,Ka,"f")[e.data.id]=e.data;break}if(Ie(this,Ka,"f")[e.data.id])return Ie(this,Ka,"f")[e.data.id];throw new Error("No snapshot available")},q$=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Ie(this,Nn,"m",W$).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},W$=function(e,t){return sa.accumulateDelta(t,e)},H$=function(e){switch(xr(this,Km,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":xr(this,fs,e.data,"f"),Ie(this,_r,"f")&&(this._emit("toolCallDone",Ie(this,_r,"f")),xr(this,_r,void 0,"f"));break}};class Wj extends mt{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return er(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,Hj,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Hj extends aa{}Wj.MessagesPage=Hj;class Kj extends mt{retrieve(t,n,r,a={},o){return er(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return er(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,Zj,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class Zj extends aa{}Kj.RunStepsPage=Zj;class Zd extends mt{constructor(){super(...arguments),this.steps=new Kj(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return er(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,Gj,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return sa.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Dd(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return sa.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return sa.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class Gj extends aa{}Zd.RunsPage=Gj,Zd.Steps=Kj,Zd.RunStepsPage=Zj;class Kc extends mt{constructor(){super(...arguments),this.runs=new Zd(this._client),this.messages=new Wj(this._client)}create(t={},n){return er(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return sa.createThreadAssistantStream(t,this._client.beta.threads,n)}}Kc.Runs=Zd,Kc.RunsPage=Gj,Kc.Messages=Wj,Kc.MessagesPage=Hj;const lhe=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let Xj=class extends mt{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return er(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Zm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await Dd(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class Zm extends aa{}Xj.VectorStoreFilesPage=Zm;class K$ extends mt{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return er(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,Zm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Dd(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(f){for(let p of f){const m=await s.files.create({file:p,purpose:"assistants"},a);l.push(m.id)}}const d=Array(i).fill(c).map(u);return await lhe(d),await this.createAndPoll(t,{file_ids:l})}}class Zc extends mt{constructor(){super(...arguments),this.files=new Xj(this._client),this.fileBatches=new K$(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return er(t)?this.list({},t):this._client.getAPIList("/vector_stores",Jj,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Jj extends aa{}Zc.VectorStoresPage=Jj,Zc.Files=Xj,Zc.VectorStoreFilesPage=Zm,Zc.FileBatches=K$;class bi extends mt{constructor(){super(...arguments),this.realtime=new Vj(this._client),this.vectorStores=new Zc(this._client),this.chat=new Uj(this._client),this.assistants=new Nj(this._client),this.threads=new Kc(this._client)}}bi.Realtime=Vj,bi.VectorStores=Zc,bi.VectorStoresPage=Jj,bi.Assistants=Nj,bi.AssistantsPage=Mj,bi.Threads=Kc;let Z$=class extends mt{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}},G$=class extends mt{create(e,t){return this._client.post("/embeddings",{body:e,...t})}};class Yj extends mt{create(t,n){return this._client.post("/files",$c({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return er(t)?this.list({},t):this._client.getAPIList("/files",Qj,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await Dd(n),i=await this.retrieve(t),Date.now()-o>r)throw new km({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class Qj extends aa{}Yj.FileObjectsPage=Qj;class eS extends mt{list(t,n={},r){return er(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,tS,{query:n,...r})}}class tS extends aa{}eS.FineTuningJobCheckpointsPage=tS;class Gc extends mt{constructor(){super(...arguments),this.checkpoints=new eS(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return er(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",nS,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return er(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,rS,{query:n,...r})}}class nS extends aa{}class rS extends aa{}Gc.FineTuningJobsPage=nS,Gc.FineTuningJobEventsPage=rS,Gc.Checkpoints=eS,Gc.FineTuningJobCheckpointsPage=tS;class Gd extends mt{constructor(){super(...arguments),this.jobs=new Gc(this._client)}}Gd.Jobs=Gc,Gd.FineTuningJobsPage=nS,Gd.FineTuningJobEventsPage=rS;class X$ extends mt{createVariation(t,n){return this._client.post("/images/variations",$c({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",$c({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}let aS=class extends mt{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",oS,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class oS extends Gpe{}aS.ModelsPage=oS;class J$ extends mt{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class Y$ extends mt{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,$c({body:n,...r}))}}class iS extends mt{constructor(){super(...arguments),this.parts=new Y$(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}iS.Parts=Y$;var Q$;let ct=class extends Dpe{constructor({baseURL:e=Im("OPENAI_BASE_URL"),apiKey:t=Im("OPENAI_API_KEY"),organization:n=Im("OPENAI_ORG_ID")??null,project:r=Im("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new rt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Kpe())throw new rt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Z$(this),this.chat=new Ej(this),this.embeddings=new G$(this),this.files=new Yj(this),this.images=new X$(this),this.audio=new Ld(this),this.moderations=new J$(this),this.models=new aS(this),this.fineTuning=new Gd(this),this.beta=new bi(this),this.batches=new Oj(this),this.uploads=new iS(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return bpe(e,{arrayFormat:"brackets"})}};Q$=ct,ct.OpenAI=Q$,ct.DEFAULT_TIMEOUT=6e5,ct.OpenAIError=rt,ct.APIError=Qn,ct.APIConnectionError=Mm,ct.APIConnectionTimeoutError=km,ct.APIUserAbortError=kr,ct.NotFoundError=B6,ct.ConflictError=z6,ct.RateLimitError=V6,ct.BadRequestError=L6,ct.AuthenticationError=$6,ct.InternalServerError=q6,ct.PermissionDeniedError=F6,ct.UnprocessableEntityError=U6,ct.toFile=X6,ct.fileFromPath=R6,ct.Completions=Z$,ct.Chat=Ej,ct.Embeddings=G$,ct.Files=Yj,ct.FileObjectsPage=Qj,ct.Images=X$,ct.Audio=Ld,ct.Moderations=J$,ct.Models=aS,ct.ModelsPage=oS,ct.FineTuning=Gd,ct.Beta=bi,ct.Batches=Oj,ct.BatchesPage=Cj,ct.Uploads=iS;var uhe=typeof window=="object"?window:{},Ge="0123456789abcdef".split(""),dhe=[-2147483648,8388608,32768,128],ca=[24,16,8,0],vn=[];function la(e){e?(vn[0]=vn[16]=vn[1]=vn[2]=vn[3]=vn[4]=vn[5]=vn[6]=vn[7]=vn[8]=vn[9]=vn[10]=vn[11]=vn[12]=vn[13]=vn[14]=vn[15]=0,this.blocks=vn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}la.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===uhe.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<ca[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<ca[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<ca[a++&3],i[a>>2]|=(128|n&63)<<ca[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<ca[a++&3],i[a>>2]|=(128|n>>6&63)<<ca[a++&3],i[a>>2]|=(128|n&63)<<ca[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<ca[a++&3],i[a>>2]|=(128|n>>12&63)<<ca[a++&3],i[a>>2]|=(128|n>>6&63)<<ca[a++&3],i[a>>2]|=(128|n&63)<<ca[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},la.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=dhe[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},la.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},la.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Ge[e>>28&15]+Ge[e>>24&15]+Ge[e>>20&15]+Ge[e>>16&15]+Ge[e>>12&15]+Ge[e>>8&15]+Ge[e>>4&15]+Ge[e&15]+Ge[t>>28&15]+Ge[t>>24&15]+Ge[t>>20&15]+Ge[t>>16&15]+Ge[t>>12&15]+Ge[t>>8&15]+Ge[t>>4&15]+Ge[t&15]+Ge[n>>28&15]+Ge[n>>24&15]+Ge[n>>20&15]+Ge[n>>16&15]+Ge[n>>12&15]+Ge[n>>8&15]+Ge[n>>4&15]+Ge[n&15]+Ge[r>>28&15]+Ge[r>>24&15]+Ge[r>>20&15]+Ge[r>>16&15]+Ge[r>>12&15]+Ge[r>>8&15]+Ge[r>>4&15]+Ge[r&15]+Ge[a>>28&15]+Ge[a>>24&15]+Ge[a>>20&15]+Ge[a>>16&15]+Ge[a>>12&15]+Ge[a>>8&15]+Ge[a>>4&15]+Ge[a&15]},la.prototype.toString=la.prototype.hex,la.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},la.prototype.array=la.prototype.digest,la.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const fhe=e=>new la(!0).update(e).hex(),e8=(...e)=>fhe(e.join("_"));class phe{}const hhe=new Map;class sS extends phe{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(e8(t,n))??null)}async update(t,n,r){this.cache.set(e8(t,n),r)}static global(){return new sS(hhe)}}const mhe=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function cS(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const yhe=()=>!1;class ghe extends yp{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??yhe(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class vhe extends ghe{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=sS.global():this.cache=void 0,this.caller=new PDe(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await ADe("modelName"in this?mhe(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new h6(t):Array.isArray(t)?new Kfe(t.map(gp)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class wi extends yp{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=LG(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=LG(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=$G(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new TDe(new IDe({steps:t}))}}function Xd(e){return typeof(e==null?void 0:e.parse)=="function"}class Za extends vhe{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=Za._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===Za.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=Za._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await RM.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const f of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(f.message.id==null){const p=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;p!=null&&f.message._updateId(`run-${p}`)}f.message.response_metadata={...f.generationInfo,...f.message.response_metadata},yield f.message,d?d=d.concat(f):d=f}}catch(f){throw await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMError(f))),f}await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var f,p;const a=t.map(m=>m.map(gp)),o={...r.metadata,...this.getLsParams(n)},i=await RM.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(m=>RDe(m)||DDe(m))&&a.length===1&&this._streamResponseChunks!==Za.prototype._streamResponseChunks)try{const m=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let y;for await(const v of m){if(v.message.id==null){const b=(f=c==null?void 0:c.at(0))==null?void 0:f.runId;b!=null&&v.message._updateId(`run-${b}`)}y===void 0?y=v:y=$G(y,v)}if(y===void 0)throw new Error("Received empty response from chat model call.");l.push([y]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(m){throw await(c==null?void 0:c[0].handleLLMError(m)),m}else{const m=await Promise.allSettled(a.map((y,v)=>this._generate(y,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(m.map(async(y,v)=>{var b,w,j;if(y.status==="fulfilled"){const x=y.value;for(const _ of x.generations){if(_.message.id==null){const S=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;S!=null&&_.message._updateId(`run-${S}`)}_.message.response_metadata={..._.generationInfo,..._.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((j=c==null?void 0:c[v])==null?void 0:j.handleLLMError(y.reason)),Promise.reject(y.reason)}))}const d={generations:l,llmOutput:u.length?(p=this._combineLLMOutput)==null?void 0:p.call(this,...u):void 0};return Object.defineProperty(d,FG,{value:c?{runIds:c==null?void 0:c.map(m=>m.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(y=>y.map(gp)),s={...o.metadata,...this.getLsParams(a)},c=await RM.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],f=(await Promise.allSettled(i.map(async(y,v)=>{const b=Za._convertInputToPromptValue(y).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((y,v)=>({result:y,runManager:u==null?void 0:u[v]})).filter(({result:y})=>y.status==="fulfilled"&&y.value!=null||y.status==="rejected"),p=[];await Promise.all(f.map(async({result:y,runManager:v},b)=>{if(y.status==="fulfilled"){const w=y.value;return p[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(y.reason)),Promise.reject(y.reason)}));const m={generations:p,missingPromptIndices:d};return Object.defineProperty(m,FG,{value:u?{runIds:u==null?void 0:u.map(y=>y.runId)}:void 0,configurable:!0}),m}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(p=>p.map(gp)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let f={};if(d.length>0){const p=await this._generateUncached(d.map(m=>o[m]),s,i);await Promise.all(p.generations.map(async(m,y)=>{const v=d[y];u[v]=m;const b=Za._convertInputToPromptValue(o[v]).toString();return c.update(b,l,m)})),f=p.llmOutput??{}}return{generations:u,llmOutput:f}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(gp)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new zr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;Xd(r)?l=[{type:"function",function:{name:c,description:o,parameters:DM(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=LDe.from(y=>{if(!y.tool_calls||y.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=y.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const f=wi.assign({parsed:(y,v)=>d.invoke(y.raw,v)}),p=wi.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[p]});return jv.from([{raw:u},m]).withConfig({runName:"StructuredOutputRunnable"})}}class t8 extends yp{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class n8 extends t8{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class Gm extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function lS(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!lS(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!lS(e[o],t[o]))return!1;return!0}return e===t}class bhe extends n8{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class r8 extends bhe{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if($De(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new qi({message:a,text:a.content})}else if(BG(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new qi({message:FDe(a),text:a.content})}else o=new BDe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!lS(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class uS extends n8{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=Ma.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,Ma.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(DM(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new Gm(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class dS extends r8{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?hX(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return zG(t[0].text)}async parse(t){return zG(t,JSON.parse)}getFormatInstructions(){return""}}function fS(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=zDe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new Gm([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function a8(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function o8(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class whe extends r8{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(Sv(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>fS(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class Xm extends whe{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new Gm(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const xhe=Symbol("Let zodToJsonSchema decide on which parser to use"),_he={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},jhe=e=>({..._he,...e}),She=e=>{const t=jhe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function i8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Et(e,t,n,r,a){e[t]=n,i8(e,t,r,a)}function Ehe(){return{}}function Ohe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==te.ZodAny&&(n.items=yt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Et(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Et(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Et(n,"minItems",e.exactLength.value,e.exactLength.message,t),Et(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Che(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Et(n,"minimum",r.value,r.message,t):Et(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Et(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Et(n,"maximum",r.value,r.message,t):Et(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Et(n,"maximum",r.value,r.message,t));break;case"multipleOf":Et(n,"multipleOf",r.value,r.message,t);break}return n}function Nhe(){return{type:"boolean"}}function Mhe(e,t){return yt(e.type._def,t)}const khe=(e,t)=>yt(e.innerType._def,t);function s8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>s8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Phe(e,t)}}const Phe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Et(n,"minimum",r.value,r.message,t);break;case"max":Et(n,"maximum",r.value,r.message,t);break}return n};function Ahe(e,t){return{...yt(e.innerType._def,t),default:e.defaultValue()}}function The(e,t){return t.effectStrategy==="input"?yt(e.schema._def,t):{}}function Ihe(e){return{type:"string",enum:e.values}}const Rhe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Dhe(e,t){const n=[yt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),yt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Rhe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Lhe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let pS;const hs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(pS===void 0&&(pS=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),pS),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function c8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?$he(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Et(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Et(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ua(n,"email",a.message,t);break;case"format:idn-email":ua(n,"idn-email",a.message,t);break;case"pattern:zod":da(n,hs.email,a.message,t);break}break;case"url":ua(n,"uri",a.message,t);break;case"uuid":ua(n,"uuid",a.message,t);break;case"regex":da(n,a.regex,a.message,t);break;case"cuid":da(n,hs.cuid,a.message,t);break;case"cuid2":da(n,hs.cuid2,a.message,t);break;case"startsWith":da(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":da(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ua(n,"date-time",a.message,t);break;case"date":ua(n,"date",a.message,t);break;case"time":ua(n,"time",a.message,t);break;case"duration":ua(n,"duration",a.message,t);break;case"length":Et(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Et(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{da(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ua(n,"ipv4",a.message,t),a.version!=="v4"&&ua(n,"ipv6",a.message,t);break}case"emoji":da(n,hs.emoji,a.message,t);break;case"ulid":{da(n,hs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ua(n,"binary",a.message,t);break}case"contentEncoding:base64":{Et(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{da(n,hs.base64,a.message,t);break}}break}case"nanoid":da(n,hs.nanoid,a.message,t)}return n}const $he=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ua=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Et(e,"format",t,n,r)},da=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:l8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Et(e,"pattern",l8(t,r),n,r)},l8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function u8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===te.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===te.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(c8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===te.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Fhe(e,t){if(t.mapStrategy==="record")return u8(e,t);const n=yt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Bhe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function zhe(){return{not:{}}}function Uhe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Jm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Vhe(e,t){if(t.target==="openApi3")return d8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Jm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Jm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return d8(e,t)}const d8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>yt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function qhe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Jm[e.innerType._def.typeName],nullable:!0}:{type:[Jm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=yt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Whe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",i8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Et(n,"minimum",r.value,r.message,t):Et(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Et(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Et(n,"maximum",r.value,r.message,t):Et(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Et(n,"maximum",r.value,r.message,t));break;case"multipleOf":Et(n,"multipleOf",r.value,r.message,t);break}return n}function Hhe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Khe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=yt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Hhe(e,t)};return n.required.length||delete n.required,n}const Zhe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return yt(e.innerType._def,t);const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Ghe=(e,t)=>{if(t.pipeStrategy==="input")return yt(e.in._def,t);if(t.pipeStrategy==="output")return yt(e.out._def,t);const n=yt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=yt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Xhe(e,t){return yt(e.type._def,t)}function Jhe(e,t){const n={type:"array",uniqueItems:!0,items:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Et(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Et(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Yhe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:yt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Qhe(){return{not:{}}}function eme(){return{}}const tme=(e,t)=>yt(e.innerType._def,t);function yt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==xhe)return s}if(r&&!n){const s=nme(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=ame(e,e.typeName,t);return o&&ome(e,t,o),a.jsonSchema=o,o}const nme=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:rme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},rme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},ame=(e,t,n)=>{switch(t){case te.ZodString:return c8(e,n);case te.ZodNumber:return Whe(e,n);case te.ZodObject:return Khe(e,n);case te.ZodBigInt:return Che(e,n);case te.ZodBoolean:return Nhe();case te.ZodDate:return s8(e,n);case te.ZodUndefined:return Qhe();case te.ZodNull:return Uhe(n);case te.ZodArray:return Ohe(e,n);case te.ZodUnion:case te.ZodDiscriminatedUnion:return Vhe(e,n);case te.ZodIntersection:return Dhe(e,n);case te.ZodTuple:return Yhe(e,n);case te.ZodRecord:return u8(e,n);case te.ZodLiteral:return Lhe(e,n);case te.ZodEnum:return Ihe(e);case te.ZodNativeEnum:return Bhe(e);case te.ZodNullable:return qhe(e,n);case te.ZodOptional:return Zhe(e,n);case te.ZodMap:return Fhe(e,n);case te.ZodSet:return Jhe(e,n);case te.ZodLazy:return yt(e.getter()._def,n);case te.ZodPromise:return Xhe(e,n);case te.ZodNaN:case te.ZodNever:return zhe();case te.ZodEffects:return The(e,n);case te.ZodAny:return Ehe();case te.ZodUnknown:return eme();case te.ZodDefault:return Ahe(e,n);case te.ZodBranded:return Mhe(e,n);case te.ZodReadonly:return tme(e,n);case te.ZodCatch:return khe(e,n);case te.ZodPipeline:return Ghe(e,n);case te.ZodFunction:case te.ZodVoid:case te.ZodSymbol:return;default:return(r=>{})()}},ome=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),ime=(e,t)=>{const n=She(t),r=void 0,a=t==null?void 0:t.name,o=yt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},sme=Symbol("Let zodToJsonSchema decide on which parser to use"),f8={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},cme=e=>typeof e=="string"?{...f8,basePath:["#"],definitions:{},name:e}:{...f8,basePath:["#"],definitions:{},...e},hS=e=>"_def"in e?e._def:e;function lme(e){if(!e)return!0;for(const t in e)return!1;return!0}const ume=e=>{const t=cme(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[hS(a),{def:hS(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function p8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ot(e,t,n,r,a){e[t]=n,p8(e,t,r,a)}function dme(){return{}}function fme(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==te.ZodAny&&(n.items=ft(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ot(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ot(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ot(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ot(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function pme(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ot(n,"minimum",r.value,r.message,t):Ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ot(n,"maximum",r.value,r.message,t):Ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ot(n,"multipleOf",r.value,r.message,t);break}return n}function hme(){return{type:"boolean"}}function mme(e,t){return ft(e.type._def,t)}const yme=(e,t)=>ft(e.innerType._def,t);function h8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>h8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return gme(e,t)}}const gme=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ot(n,"minimum",r.value,r.message,t);break;case"max":Ot(n,"maximum",r.value,r.message,t);break}return n};function vme(e,t){return{...ft(e.innerType._def,t),default:e.defaultValue()}}function bme(e,t,n){return t.effectStrategy==="input"?ft(e.schema._def,t,n):{}}function wme(e){return{type:"string",enum:[...e.values]}}const xme=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function _me(e,t){const n=[ft(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),ft(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(xme(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function jme(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let mS;const ms={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(mS===void 0&&(mS=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),mS),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function m8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Sme(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":fa(n,"email",a.message,t);break;case"format:idn-email":fa(n,"idn-email",a.message,t);break;case"pattern:zod":pa(n,ms.email,a.message,t);break}break;case"url":fa(n,"uri",a.message,t);break;case"uuid":fa(n,"uuid",a.message,t);break;case"regex":pa(n,a.regex,a.message,t);break;case"cuid":pa(n,ms.cuid,a.message,t);break;case"cuid2":pa(n,ms.cuid2,a.message,t);break;case"startsWith":pa(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":pa(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":fa(n,"date-time",a.message,t);break;case"date":fa(n,"date",a.message,t);break;case"time":fa(n,"time",a.message,t);break;case"duration":fa(n,"duration",a.message,t);break;case"length":Ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{pa(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&fa(n,"ipv4",a.message,t),a.version!=="v4"&&fa(n,"ipv6",a.message,t);break}case"emoji":pa(n,ms.emoji,a.message,t);break;case"ulid":{pa(n,ms.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{fa(n,"binary",a.message,t);break}case"contentEncoding:base64":{Ot(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{pa(n,ms.base64,a.message,t);break}}break}case"nanoid":pa(n,ms.nanoid,a.message,t)}return n}const Sme=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),fa=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ot(e,"format",t,n,r)},pa=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:y8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ot(e,"pattern",y8(t,r),n,r)},y8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function g8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===te.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:ft(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:ft(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===te.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(m8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===te.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Eme(e,t){if(t.mapStrategy==="record")return g8(e,t);const n=ft(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=ft(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Ome(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Cme(){return{not:{}}}function Nme(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Ym={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Mme(e,t){if(t.target==="openApi3")return v8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Ym&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Ym[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return v8(e,t)}const v8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>ft(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function kme(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:Ym[e.innerType._def.typeName],nullable:!0}:{type:[Ym[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=ft(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=ft(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Pme(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",p8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ot(n,"minimum",r.value,r.message,t):Ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ot(n,"maximum",r.value,r.message,t):Ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ot(n,"multipleOf",r.value,r.message,t);break}return n}function Ame(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":ft(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":ft(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Tme(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=ft(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Ame(e,t)};return n.required.length||delete n.required,n}const Ime=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return ft(e.innerType._def,t);const n=ft(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Rme=(e,t)=>{if(t.pipeStrategy==="input")return ft(e.in._def,t);if(t.pipeStrategy==="output")return ft(e.out._def,t);const n=ft(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=ft(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Dme(e,t){return ft(e.type._def,t)}function Lme(e,t){const n={type:"array",uniqueItems:!0,items:ft(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ot(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ot(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function $me(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>ft(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:ft(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>ft(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Fme(){return{not:{}}}function Bme(){return{}}const zme=(e,t)=>ft(e.innerType._def,t);function ft(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==sme)return s}if(r&&!n){const s=Ume(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=qme(e,e.typeName,t,n);return o&&Wme(e,t,o),a.jsonSchema=o,o}const Ume=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:Vme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Vme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},qme=(e,t,n,r)=>{switch(t){case te.ZodString:return m8(e,n);case te.ZodNumber:return Pme(e,n);case te.ZodObject:return Tme(e,n);case te.ZodBigInt:return pme(e,n);case te.ZodBoolean:return hme();case te.ZodDate:return h8(e,n);case te.ZodUndefined:return Fme();case te.ZodNull:return Nme(n);case te.ZodArray:return fme(e,n);case te.ZodUnion:case te.ZodDiscriminatedUnion:return Mme(e,n);case te.ZodIntersection:return _me(e,n);case te.ZodTuple:return $me(e,n);case te.ZodRecord:return g8(e,n);case te.ZodLiteral:return jme(e,n);case te.ZodEnum:return wme(e);case te.ZodNativeEnum:return Ome(e);case te.ZodNullable:return kme(e,n);case te.ZodOptional:return Ime(e,n);case te.ZodMap:return Eme(e,n);case te.ZodSet:return Lme(e,n);case te.ZodLazy:return ft(e.getter()._def,n);case te.ZodPromise:return Dme(e,n);case te.ZodNaN:case te.ZodNever:return Cme();case te.ZodEffects:return bme(e,n,r);case te.ZodAny:return dme();case te.ZodUnknown:return Bme();case te.ZodDefault:return vme(e,n);case te.ZodBranded:return mme(e,n);case te.ZodReadonly:return zme(e,n);case te.ZodCatch:return yme(e,n);case te.ZodPipeline:return Rme(e,n);case te.ZodFunction:case te.ZodVoid:case te.ZodSymbol:return;default:return(a=>{})()}},Wme=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Hme=(e,t)=>{const n=ume(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=ft(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(lme(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([f])=>!l.has(f));if(d.length===0)break;for(const[f,p]of d)c[f]=ft(hS(p),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},l.add(f)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function b8(e,t){return Hme(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Kme(e,t,n){return Xpe({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:b8(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function Zme(e){return Jpe({type:"function",function:{name:e.name,parameters:b8(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function Gme(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function w8(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:DM(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function Xme(e,t){let n;return Qm(e)?n={type:"function",function:w8(e)}:n=e,n}function Jme(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function Yme(e){return e!==void 0&&yp.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function Qme(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&Xd(e.schema)}function Qm(e){return Qme(e)||Yme(e)||Jme(e)}function ey(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function x8(e){let t;return e.constructor.name===km.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===kr.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=ey(e,"INVALID_TOOL_RESULTS"):e.status===401?t=ey(e,"MODEL_AUTHENTICATION"):e.status===429?t=ey(e,"MODEL_RATE_LIMIT"):e.status===404?t=ey(e,"MODEL_NOT_FOUND"):t=e,t}function eye(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function tye(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function nye(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(_8(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function _8(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${ty(o,t)},`):n.push(`${a}?: ${ty(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function ty(e,t){if(tye(e))return e.anyOf.map(n=>ty(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",_8(e,t+2),"}"].join(`
`);case"array":return e.items?`${ty(e.items,t)}[]`:"any[]";default:return""}}function rye(e,t){let n;if(Qm(e)){const r=Zme({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:w8(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function aye(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function j8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!Ev.isInstance(e))throw new Error("Invalid generic chat message");return aye(e)}default:throw new Error(`Unknown message type: ${t}`)}}function oye(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(fS(c,{returnId:!0}))}catch(l){o.push(o8(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new ka({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new Ev(e.content||"",e.role??"unknown")}}function iye(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new UG({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new nu({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new LM({content:o,response_metadata:s}):a==="developer"?new LM({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new UDe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new VDe({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new VG({content:o,role:a,response_metadata:s})}function S8(e,t){return e.flatMap(n=>{var o;let r=j8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),Sv(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(a8),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function E8(e,t){return cS(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:rye(e,t)}class sye extends Za{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??co("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??co("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??co("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??co("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??co("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??co("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??co("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??co("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const f=this.azureOpenAIBasePath.split("/openai/deployments/");if(f.length===2){const[,p]=f;this.azureOpenAIApiDeploymentName=p}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>E8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&ny(t.json_schema.schema)?Kme(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>E8(c,{strict:r})):void 0,tool_choice:eye(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,f,p,m,y,v,b,w;const a=S8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const j of s){const x=(l=j==null?void 0:j.choices)==null?void 0:l[0];if(j.usage&&(c=j.usage),!x)continue;const{delta:_}=x;if(!_)continue;const S=iye(_,j,i,this.__includeRawResponse);i=_.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=j.system_fingerprint,O.model_name=j.model),this.logprobs&&(O.logprobs=x.logprobs);const M=new qi({message:S,text:S.content,generationInfo:O});yield M,await(r==null?void 0:r.handleLLMNewToken(M.text??"",E,void 0,void 0,void 0,{chunk:M}))}if(c){const j={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((f=c.prompt_tokens_details)==null?void 0:f.cached_tokens)!==null&&{cache_read:(p=c.prompt_tokens_details)==null?void 0:p.cached_tokens}},x={...((m=c.completion_tokens_details)==null?void 0:m.audio_tokens)!==null&&{audio:(y=c.completion_tokens_details)==null?void 0:y.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new qi({message:new nu({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(j).length>0&&{input_token_details:j},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=S8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:f,function_call:p}=this.invocationParams(n),m=await this.getEstimatedTokenCountFromPrompt(t,f,p),y=await this.getNumTokensFromGenerations(d);return a.input_tokens=m,a.output_tokens=y,a.total_tokens=m+y,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:f,prompt_tokens_details:p,completion_tokens_details:m}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),f&&(a.total_tokens=(a.total_tokens??0)+f),((p==null?void 0:p.audio_tokens)!==null||(p==null?void 0:p.cached_tokens)!==null)&&(a.input_token_details={...(p==null?void 0:p.audio_tokens)!==null&&{audio:p==null?void 0:p.audio_tokens},...(p==null?void 0:p.cached_tokens)!==null&&{cache_read:p==null?void 0:p.cached_tokens}}),((m==null?void 0:m.audio_tokens)!==null||(m==null?void 0:m.reasoning_tokens)!==null)&&(a.output_token_details={...(m==null?void 0:m.audio_tokens)!==null&&{audio:m==null?void 0:m.audio_tokens},...(m==null?void 0:m.reasoning_tokens)!==null&&{reasoning:m==null?void 0:m.reasoning_tokens}});const y=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:oye(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},Sv(b.message)&&(b.message.usage_metadata=a),b.message=new ka(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),y.push(b)}return{generations:y,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=nye(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var f,p,m,y,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(j8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(f=d.additional_kwargs)!=null&&f.function_call&&(u+=3),(p=d==null?void 0:d.additional_kwargs.function_call)!=null&&p.name&&(u+=await this.getNumTokens((m=d.additional_kwargs.function_call)==null?void 0:m.name)),(y=d.additional_kwargs.function_call)==null?void 0:y.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw x8(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw x8(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=Gme(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new ct(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;cye(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),ny(r)?c=uS.fromZodSchema(r):c=new dS;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),ny(r)?c=uS.fromZodSchema(r):c=new dS;else{let f=a??"extract";if(ny(r)){const p=ime(r);s=this.bind({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Xm({returnSingle:!0,keyName:f,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,f=r.name):(f=r.title??f,p={name:f,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Xm({returnSingle:!0,keyName:f})}}if(!i)return s.pipe(c);const l=wi.assign({parsed:(f,p)=>c.invoke(f.raw,p)}),u=wi.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return jv.from([{raw:s},d])}}function ny(e){return typeof(e==null?void 0:e.parse)=="function"}function cye(e){return e!==void 0&&typeof e.schema=="object"}const lye=Symbol("Let zodToJsonSchema decide on which parser to use"),uye={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},dye=e=>({...uye,...e}),fye=e=>{const t=dye(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function O8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ct(e,t,n,r,a){e[t]=n,O8(e,t,r,a)}function pye(){return{}}function hye(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==te.ZodAny&&(n.items=gt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ct(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ct(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ct(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ct(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function mye(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,t):Ct(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,t):Ct(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,t);break}return n}function yye(){return{type:"boolean"}}function gye(e,t){return gt(e.type._def,t)}const vye=(e,t)=>gt(e.innerType._def,t);function C8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>C8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return bye(e,t)}}const bye=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ct(n,"minimum",r.value,r.message,t);break;case"max":Ct(n,"maximum",r.value,r.message,t);break}return n};function wye(e,t){return{...gt(e.innerType._def,t),default:e.defaultValue()}}function xye(e,t){return t.effectStrategy==="input"?gt(e.schema._def,t):{}}function _ye(e){return{type:"string",enum:e.values}}const jye=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Sye(e,t){const n=[gt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),gt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(jye(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Eye(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let yS;const ys={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(yS===void 0&&(yS=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),yS),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function N8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Oye(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Ct(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ha(n,"email",a.message,t);break;case"format:idn-email":ha(n,"idn-email",a.message,t);break;case"pattern:zod":ma(n,ys.email,a.message,t);break}break;case"url":ha(n,"uri",a.message,t);break;case"uuid":ha(n,"uuid",a.message,t);break;case"regex":ma(n,a.regex,a.message,t);break;case"cuid":ma(n,ys.cuid,a.message,t);break;case"cuid2":ma(n,ys.cuid2,a.message,t);break;case"startsWith":ma(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ma(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ha(n,"date-time",a.message,t);break;case"date":ha(n,"date",a.message,t);break;case"time":ha(n,"time",a.message,t);break;case"duration":ha(n,"duration",a.message,t);break;case"length":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Ct(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ma(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ha(n,"ipv4",a.message,t),a.version!=="v4"&&ha(n,"ipv6",a.message,t);break}case"emoji":ma(n,ys.emoji,a.message,t);break;case"ulid":{ma(n,ys.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ha(n,"binary",a.message,t);break}case"contentEncoding:base64":{Ct(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ma(n,ys.base64,a.message,t);break}}break}case"nanoid":ma(n,ys.nanoid,a.message,t)}return n}const Oye=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ha=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ct(e,"format",t,n,r)},ma=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:M8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ct(e,"pattern",M8(t,r),n,r)},M8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function k8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===te.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===te.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(N8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===te.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Cye(e,t){if(t.mapStrategy==="record")return k8(e,t);const n=gt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Nye(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Mye(){return{not:{}}}function kye(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ry={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Pye(e,t){if(t.target==="openApi3")return P8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ry&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=ry[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return P8(e,t)}const P8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>gt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Aye(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:ry[e.innerType._def.typeName],nullable:!0}:{type:[ry[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=gt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=gt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Tye(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",O8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,t):Ct(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,t):Ct(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,t);break}return n}function Iye(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":gt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":gt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Rye(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=gt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Iye(e,t)};return n.required.length||delete n.required,n}const Dye=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return gt(e.innerType._def,t);const n=gt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Lye=(e,t)=>{if(t.pipeStrategy==="input")return gt(e.in._def,t);if(t.pipeStrategy==="output")return gt(e.out._def,t);const n=gt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=gt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function $ye(e,t){return gt(e.type._def,t)}function Fye(e,t){const n={type:"array",uniqueItems:!0,items:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ct(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ct(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Bye(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>gt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:gt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>gt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function zye(){return{not:{}}}function Uye(){return{}}const Vye=(e,t)=>gt(e.innerType._def,t);function gt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==lye)return s}if(r&&!n){const s=qye(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Hye(e,e.typeName,t);return o&&Kye(e,t,o),a.jsonSchema=o,o}const qye=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Wye(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Wye=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Hye=(e,t,n)=>{switch(t){case te.ZodString:return N8(e,n);case te.ZodNumber:return Tye(e,n);case te.ZodObject:return Rye(e,n);case te.ZodBigInt:return mye(e,n);case te.ZodBoolean:return yye();case te.ZodDate:return C8(e,n);case te.ZodUndefined:return zye();case te.ZodNull:return kye(n);case te.ZodArray:return hye(e,n);case te.ZodUnion:case te.ZodDiscriminatedUnion:return Pye(e,n);case te.ZodIntersection:return Sye(e,n);case te.ZodTuple:return Bye(e,n);case te.ZodRecord:return k8(e,n);case te.ZodLiteral:return Eye(e,n);case te.ZodEnum:return _ye(e);case te.ZodNativeEnum:return Nye(e);case te.ZodNullable:return Aye(e,n);case te.ZodOptional:return Dye(e,n);case te.ZodMap:return Cye(e,n);case te.ZodSet:return Fye(e,n);case te.ZodLazy:return gt(e.getter()._def,n);case te.ZodPromise:return $ye(e,n);case te.ZodNaN:case te.ZodNever:return Mye();case te.ZodEffects:return xye(e,n);case te.ZodAny:return pye();case te.ZodUnknown:return Uye();case te.ZodDefault:return wye(e,n);case te.ZodBranded:return gye(e,n);case te.ZodReadonly:return Vye(e,n);case te.ZodCatch:return vye(e,n);case te.ZodPipeline:return Lye(e,n);case te.ZodFunction:case te.ZodVoid:case te.ZodSymbol:return;default:return(r=>{})()}},Kye=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Zye=(e,t)=>{const n=fye(t),r=void 0,a=t==null?void 0:t.name,o=gt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},Xc="0.5.0";let A8=!1,Jd,T8,I8,gS,R8,D8,L8,$8,F8;function Gye(e,t={auto:!1}){if(A8)throw new Error(`you must \`import 'groq-sdk/shims/${e.kind}'\` before importing anything else from groq-sdk`);if(Jd)throw new Error(`can't \`import 'groq-sdk/shims/${e.kind}'\` after \`import 'groq-sdk/shims/${Jd}'\``);A8=t.auto,Jd=e.kind,T8=e.fetch,I8=e.FormData,gS=e.File,R8=e.ReadableStream,D8=e.getMultipartRequestOptions,L8=e.getDefaultAgent,$8=e.fileFromPath,F8=e.isFsReadStream}class Xye{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Jye({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new Xye(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:i=>!1}}Jd||Gye(Jye(),{auto:!0});class ya extends Error{}class In extends ya{constructor(t,n,r,a){super(`${In.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.error=n}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t)return new ay({cause:jS(n)});const o=n;return t===400?new z8(t,o,r,a):t===401?new U8(t,o,r,a):t===403?new V8(t,o,r,a):t===404?new q8(t,o,r,a):t===409?new W8(t,o,r,a):t===422?new H8(t,o,r,a):t===429?new K8(t,o,r,a):t>=500?new Z8(t,o,r,a):new In(t,o,r,a)}}class vS extends In{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class ay extends In{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class B8 extends ay{constructor({message:t}={}){super({message:t??"Request timed out."})}}class z8 extends In{constructor(){super(...arguments),this.status=400}}class U8 extends In{constructor(){super(...arguments),this.status=401}}class V8 extends In{constructor(){super(...arguments),this.status=403}}class q8 extends In{constructor(){super(...arguments),this.status=404}}class W8 extends In{constructor(){super(...arguments),this.status=409}}class H8 extends In{constructor(){super(...arguments),this.status=422}}class K8 extends In{constructor(){super(...arguments),this.status=429}}class Z8 extends In{}class Jc{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;const a=new Yye;async function*o(){if(!t.body)throw n.abort(),new ya("Attempted to iterate over a response with no body");const s=new gs,c=G8(t.body);for await(const l of c)for(const u of s.decode(l)){const d=a.decode(u);d&&(yield d)}for(const l of s.flush()){const u=a.decode(l);u&&(yield u)}}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const c of o())if(!s){if(c.data.startsWith("[DONE]")){s=!0;continue}if(c.event===null){let l;try{l=JSON.parse(c.data)}catch(u){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),u}if(l&&l.error)throw new In(void 0,l.error,void 0,void 0);yield l}}s=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{s||n.abort()}}return new Jc(i,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new gs,s=G8(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Jc(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Jc(()=>a(t),this.controller),new Jc(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new R8({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}class Yye{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=Qye(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}class gs{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=gs.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(gs.NEWLINE_REGEXP);return a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof jn<"u"){if(t instanceof jn)return t.toString();if(t instanceof Uint8Array)return jn.from(t).toString();throw new ya(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new ya(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new ya("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}gs.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","\x85","\u2028","\u2029"]),gs.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function Qye(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function G8(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const X8=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",J8=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&bS(e),bS=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",ege=e=>J8(e)||X8(e)||F8(e);async function Y8(e,t,n){var a;if(e=await e,n??(n=J8(e)?{lastModified:e.lastModified,type:e.type}:{}),X8(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new gS([o],t,n)}const r=await tge(e);if(t||(t=rge(e)??"unknown_file"),!n.type){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new gS(r,t,n)}async function tge(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(bS(e))t.push(await e.arrayBuffer());else if(age(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${nge(e)}`);return t}function nge(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function rge(e){var t;return wS(e.name)||wS(e.filename)||((t=wS(e.path))==null?void 0:t.split(/[\\/]/).pop())}const wS=e=>{if(typeof e=="string")return e;if(typeof jn<"u"&&e instanceof jn)return String(e)},age=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Q8=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",e9=async e=>{const t=await oge(e.body);return D8(t,e)},oge=async e=>{const t=new I8;return await Promise.all(Object.entries(e||{}).map(([n,r])=>xS(t,n,r))),t},xS=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(ege(n)){const r=await Y8(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>xS(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>xS(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Yc={};async function t9(e){const{response:t}=e;if(e.options.stream)return Qc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Jc.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Qc("response",t.status,t.url,t.headers,a),a}const r=await t.text();return Qc("response",t.status,t.url,t.headers,r),r}class oy extends Promise{constructor(t,n=t9){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new oy(this.responsePromise,async n=>t(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class ige{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e4,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=_S("maxRetries",n),this.timeout=_S("timeout",r),this.httpAgent=a,this.fetch=o??T8}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...dge(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${vge()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&bS(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof jn<"u")return jn.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){var p;const{method:n,path:r,query:a,headers:o={}}=t,i=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:Q8(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in t&&_S("timeout",t.timeout);const l=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??L8(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const f=this.buildHeaders({options:t,headers:o,contentLength:s});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:t.signal??null},url:c,timeout:l}}buildHeaders({options:t,headers:n,contentLength:r}){const a={};r&&(a["content-length"]=r);const o=this.defaultHeaders(t);return i9(a,o),i9(a,n),Q8(t.body)&&Jd!=="node"&&delete a["content-type"],this.validateHeaders(a,n),a}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return In.generate(t,n,r,a)}request(t,n=null){return new oy(this.makeRequest(t,n))}async makeRequest(t,n){var u,d;const r=await t;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:a,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(a,{url:o,options:r}),Qc("request",o,r,a.headers),(u=r.signal)==null?void 0:u.aborted)throw new vS;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(jS);if(c instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new vS;if(n)return this.retryRequest(r,n);throw c.name==="AbortError"?new B8:new ay({cause:c})}const l=cge(c.headers);if(!c.ok){if(n&&this.shouldRetry(c)){const y=`retrying, ${n} attempts remaining`;return Qc(`response (error; ${y})`,c.status,o,l),this.retryRequest(r,n,l)}const f=await c.text().catch(y=>jS(y).message),p=fge(f),m=p?void 0:f;throw Qc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,p,m,l)}return{response:c,options:r,controller:s}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new sge(this,r,t)}buildURL(t,n){const r=hge(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return yge(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ya(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r);return this.getRequestClient().fetch.call(void 0,t,{signal:a.signal,...i}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await mge(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Xc}`}}class sge extends oy{constructor(t,n,r){super(n,async a=>new r(t,a.response,await t9(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const cge=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),lge=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":r9(Deno.build.os),"X-Stainless-Arch":n9(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Sn.version};if(Object.prototype.toString.call(typeof Sn<"u"?Sn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":r9(Sn.platform),"X-Stainless-Arch":n9(Sn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Sn.version};const e=uge();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function uge(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const n9=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",r9=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let a9;const dge=()=>a9??(a9=lge()),fge=e=>{try{return JSON.parse(e)}catch{return}},pge=new RegExp("^(?:[a-z]+:)?//","i"),hge=e=>pge.test(e),mge=e=>new Promise(t=>setTimeout(t,e)),_S=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new ya(`${e} must be an integer`);if(t<0)throw new ya(`${e} must be a positive integer`);return t},jS=e=>e instanceof Error?e:new Error(e),o9=e=>{var t,n,r,a;if(typeof Sn<"u")return((t=Yc==null?void 0:Yc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function yge(e){if(!e)return!0;for(const t in e)return!1;return!0}function gge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function i9(e,t){for(const n in t){if(!gge(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Qc(e,...t){typeof Sn<"u"&&(Yc==null?void 0:Yc.DEBUG)==="true"&&console.log(`Groq:DEBUG:${e}`,...t)}const vge=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),bge=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class xi{constructor(t){this._client=t}}class iy extends xi{create(t,n){return this._client.post("/openai/v1/audio/transcriptions",e9({body:t,...n}))}}iy||(iy={});class sy extends xi{create(t,n){return this._client.post("/openai/v1/audio/translations",e9({body:t,...n}))}}sy||(sy={});class cy extends xi{constructor(){super(...arguments),this.transcriptions=new iy(this._client),this.translations=new sy(this._client)}}(function(e){e.Transcriptions=iy,e.Translations=sy})(cy||(cy={}));let ly=class extends xi{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};ly||(ly={});class uy extends xi{constructor(){super(...arguments),this.completions=new ly(this._client)}}(function(e){e.Completions=ly})(uy||(uy={}));class dy extends xi{}dy||(dy={});class fy extends xi{create(t,n){return this._client.post("/openai/v1/embeddings",{body:t,...n})}}fy||(fy={});class py extends xi{retrieve(t,n){return this._client.get(`/openai/v1/models/${t}`,n)}list(t){return this._client.get("/openai/v1/models",t)}delete(t,n){return this._client.delete(`/openai/v1/models/${t}`,n)}}py||(py={});var s9;class on extends ige{constructor({baseURL:t=o9("GROQ_BASE_URL"),apiKey:n=o9("GROQ_API_KEY"),...r}={}){if(n===void 0)throw new ya("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const a={apiKey:n,...r,baseURL:t||"https://api.groq.com"};if(!a.dangerouslyAllowBrowser&&bge())throw new ya(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:a.baseURL,timeout:a.timeout??6e4,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new dy(this),this.chat=new uy(this),this.embeddings=new fy(this),this.audio=new cy(this),this.models=new py(this),this._options=a,this.apiKey=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}s9=on,on.Groq=s9,on.GroqError=ya,on.APIError=In,on.APIConnectionError=ay,on.APIConnectionTimeoutError=B8,on.APIUserAbortError=vS,on.NotFoundError=q8,on.ConflictError=W8,on.RateLimitError=K8,on.BadRequestError=z8,on.AuthenticationError=U8,on.InternalServerError=Z8,on.PermissionDeniedError=V8,on.UnprocessableEntityError=H8,on.toFile=Y8,on.fileFromPath=$8,function(e){e.Completions=dy,e.Chat=uy,e.Embeddings=fy,e.Audio=cy,e.Models=py}(on||(on={}));function wge(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${t}`)}}function c9(e){return e.map(t=>{var r;if(typeof t.content!="string")throw new Error("Non string message content not supported");const n={role:wge(t),content:t.content,name:t.name,function_call:t.additional_kwargs.function_call,tool_calls:t.additional_kwargs.tool_calls,tool_call_id:t.tool_call_id};return Sv(t)&&((r=t.tool_calls)!=null&&r.length)?n.tool_calls=t.tool_calls.map(a8):(t.additional_kwargs.tool_calls!=null&&(n.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(n.tool_call_id=t.tool_call_id)),n})}function xge(e,t){const n=e.tool_calls;switch(e.role){case"assistant":{const r=[],a=[];for(const o of n??[])try{r.push(fS(o,{returnId:!0}))}catch(i){a.push(o8(o,i.message))}return new ka({content:e.content||"",additional_kwargs:{tool_calls:n},tool_calls:r,invalid_tool_calls:a,usage_metadata:t})}default:return new Ev(e.content||"",e.role??"unknown")}}function _ge(e,t){if(e!=null&&e.length)return e.map(n=>{var r,a;return{id:n.id,name:(r=n.function)==null?void 0:r.name,args:(a=n.function)==null?void 0:a.arguments,type:"tool_call_chunk",index:t}})}function jge(e,t,n){const{role:r}=e,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={};let i,s;if(n!=null&&n.usage&&(i={input_tokens:n.usage.prompt_tokens,output_tokens:n.usage.completion_tokens,total_tokens:n.usage.total_tokens},s=n.id),r==="user")return{message:new UG({content:a})};if(r==="assistant"){const c=_ge(e.tool_calls,t);return{message:new nu({content:a,additional_kwargs:o,tool_call_chunks:c?c.map(l=>({type:l.type,args:l.args,index:l.index})):void 0,usage_metadata:i,id:s}),toolCallData:c?c.map(l=>({id:l.id??"",name:l.name??"",index:l.index??t,type:"tool_call_chunk"})):void 0}}else return r==="system"?{message:new LM({content:a})}:{message:new VG({content:a,role:r})}}class Sge extends Za{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(t){super(t??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const n=(t==null?void 0:t.apiKey)||co("GROQ_API_KEY");if(!n)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const r={"User-Agent":"langchainjs",...(t==null?void 0:t.defaultHeaders)??{}};this.client=new on({apiKey:n,dangerouslyAllowBrowser:!0,baseURL:t==null?void 0:t.baseUrl,timeout:t==null?void 0:t.timeout,httpAgent:t==null?void 0:t.httpAgent,fetch:t==null?void 0:t.fetch,maxRetries:0,defaultHeaders:r,defaultQuery:t==null?void 0:t.defaultQuery}),this.apiKey=n,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.stop=(t==null?void 0:t.stopSequences)??(typeof(t==null?void 0:t.stop)=="string"?[t.stop]:t==null?void 0:t.stop)??[],this.stopSequences=this.stop,this.maxTokens=t==null?void 0:t.maxTokens}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??this.temperature,ls_max_tokens:n.max_tokens??this.maxTokens,ls_stop:t.stop}}async completionWithRetry(t,n){return this.caller.call(async()=>this.client.chat.completions.create(t,n))}invocationParams(t){const n=super.invocationParams(t);return t.tool_choice!==void 0&&(n.tool_choice=t.tool_choice),t.tools!==void 0&&(n.tools=t.tools),t.response_format!==void 0&&(n.response_format=t.response_format),{...n,stop:t.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(t,n){return this.bind({tools:t.map(r=>Xme(r)),...n})}async*_streamResponseChunks(t,n,r){var u,d;const a=this.invocationParams(n),o=c9(t),i=await this.completionWithRetry({...a,messages:o,stream:!0},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});let s="";const c=[];let l;for await(const f of i){l=f;const p=f==null?void 0:f.choices[0];if(!p)continue;(u=p.delta)!=null&&u.role&&(s=p.delta.role);const{message:m,toolCallData:y}=jge({...p.delta,role:s},p.index,f.x_groq);if(y){const b=y.filter(w=>c.every(j=>j.id!==w.id));c.push(...b),yield new qi({message:new nu({content:"",tool_call_chunks:b}),text:""})}const v=new qi({message:m,text:p.delta.content??"",generationInfo:{finishReason:p.finish_reason}});yield v,r==null||r.handleLLMNewToken(v.text??"")}if(l&&("choices"in l&&delete l.choices,yield new qi({message:new nu({content:"",response_metadata:l}),text:""})),(d=n.signal)==null?void 0:d.aborted)throw new Error("AbortError")}async _generate(t,n,r){var a;if(this.streaming){const o={},i=this._streamResponseChunks(t,n,r),s={};for await(const c of i){const l=((a=c.generationInfo)==null?void 0:a.completion)??0;s[l]===void 0?s[l]=c:s[l]=s[l].concat(c)}return{generations:Object.entries(s).sort(([c],[l])=>parseInt(c,10)-parseInt(l,10)).map(([c,l])=>l),llmOutput:{estimatedTokenUsage:o}}}else return this._generateNonStreaming(t,n,r)}async _generateNonStreaming(t,n,r){var l;const a={},o=this.invocationParams(n),i=c9(t),s=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});if("usage"in s&&s.usage){const{completion_tokens:u,prompt_tokens:d,total_tokens:f}=s.usage;u&&(a.completionTokens=(a.completionTokens??0)+u),d&&(a.promptTokens=(a.promptTokens??0)+d),f&&(a.totalTokens=(a.totalTokens??0)+f)}const c=[];if("choices"in s&&s.choices)for(const u of s.choices){const d=((l=u.message)==null?void 0:l.content)??"";let f;a.totalTokens!==void 0&&(f={input_tokens:a.promptTokens??0,output_tokens:a.completionTokens??0,total_tokens:a.totalTokens});const p={text:d,message:xge(u.message??{role:"assistant"},f)};p.generationInfo={...u.finish_reason?{finish_reason:u.finish_reason}:{},...u.logprobs?{logprobs:u.logprobs}:{}},c.push(p)}return{generations:c,llmOutput:{tokenUsage:a}}}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;let s=a??"extract",c,l;if(o==="jsonMode")l=this.bind({response_format:{type:"json_object"}}),Xd(r)?c=uS.fromZodSchema(r):c=new dS;else if(Xd(r)){const p=Zye(r);l=this.bind({tools:[{type:"function",function:{name:s,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:s}}}),c=new Xm({returnSingle:!0,keyName:s,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,s=r.name):(s=r.title??s,p={name:s,description:r.description??"",parameters:r}),l=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:s}}}),c=new Xm({returnSingle:!0,keyName:s})}if(!i)return l.pipe(c).withConfig({runName:"ChatGroqStructuredOutput"});const u=wi.assign({parsed:(p,m)=>c.invoke(p.raw,m)}),d=wi.assign({parsed:()=>null}),f=u.withFallbacks({fallbacks:[d]});return jv.from([{raw:l},f]).withConfig({runName:"ChatGroqStructuredOutput"})}}var l9;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(l9||(l9={}));var u9;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(u9||(u9={}));var d9;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(d9||(d9={}));const f9=["user","model","function","system"];var p9;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(p9||(p9={}));var h9;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(h9||(h9={}));var m9;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(m9||(m9={}));var y9;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(y9||(y9={}));var Yd;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER"})(Yd||(Yd={}));var g9;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(g9||(g9={}));var el;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(el||(el={}));var v9;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(v9||(v9={}));class nr extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class tl extends nr{constructor(t,n){super(t),this.response=n}}class b9 extends nr{constructor(t,n,r,a){super(t),this.status=n,this.statusText=r,this.errorDetails=a}}class _i extends nr{}const Ege="https://generativelanguage.googleapis.com",Oge="v1beta",Cge="0.21.0",Nge="genai-js";var vs;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(vs||(vs={}));class Mge{constructor(t,n,r,a,o){this.model=t,this.task=n,this.apiKey=r,this.stream=a,this.requestOptions=o}toString(){var t,n;const r=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||Oge;let a=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||Ege}/${r}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function kge(e){const t=[];return e!=null&&e.apiClient&&t.push(e.apiClient),t.push(`${Nge}/${Cge}`),t.join(" ")}async function Pge(e){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",kge(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let r=(t=e.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(a){throw new _i(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${a.message}`)}for(const[a,o]of r.entries()){if(a==="x-goog-api-key")throw new _i(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new _i(`Header name ${a} can only be set using the apiClient field`);n.append(a,o)}}return n}async function Age(e,t,n,r,a,o){const i=new Mge(e,t,n,r,o);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},Dge(o)),{method:"POST",headers:await Pge(i),body:a})}}async function Qd(e,t,n,r,a,o={},i=fetch){const{url:s,fetchOptions:c}=await Age(e,t,n,r,a,o);return Tge(s,c,i)}async function Tge(e,t,n=fetch){let r;try{r=await n(e,t)}catch(a){Ige(a,e)}return r.ok||await Rge(r,e),r}function Ige(e,t){let n=e;throw e instanceof b9||e instanceof _i||(n=new nr(`Error fetching from ${t.toString()}: ${e.message}`),n.stack=e.stack),n}async function Rge(e,t){let n="",r;try{const a=await e.json();n=a.error.message,a.error.details&&(n+=` ${JSON.stringify(a.error.details)}`,r=a.error.details)}catch{}throw new b9(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,r)}function Dge(e){const t={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const n=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}function SS(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),hy(e.candidates[0]))throw new tl(`${ji(e)}`,e);return Lge(e)}else if(e.promptFeedback)throw new tl(`Text not available. ${ji(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),hy(e.candidates[0]))throw new tl(`${ji(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),w9(e)[0]}else if(e.promptFeedback)throw new tl(`Function call not available. ${ji(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),hy(e.candidates[0]))throw new tl(`${ji(e)}`,e);return w9(e)}else if(e.promptFeedback)throw new tl(`Function call not available. ${ji(e)}`,e)},e}function Lge(e){var t,n,r,a;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const i of(a=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)i.text&&o.push(i.text),i.executableCode&&o.push("\n```"+i.executableCode.language+`
`+i.executableCode.code+"\n```\n"),i.codeExecutionResult&&o.push("\n```\n"+i.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function w9(e){var t,n,r,a;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const i of(a=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)i.functionCall&&o.push(i.functionCall);if(o.length>0)return o}const $ge=[Yd.RECITATION,Yd.SAFETY,Yd.LANGUAGE];function hy(e){return!!e.finishReason&&$ge.includes(e.finishReason)}function ji(e){var t,n,r;let a="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)a+="Response was blocked",!((t=e.promptFeedback)===null||t===void 0)&&t.blockReason&&(a+=` due to ${e.promptFeedback.blockReason}`),!((n=e.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(a+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((r=e.candidates)===null||r===void 0)&&r[0]){const o=e.candidates[0];hy(o)&&(a+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(a+=`: ${o.finishMessage}`))}return a}function ef(e){return this instanceof ef?(this.v=e,this):new ef(e)}function Fge(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,o=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(f){r[f]&&(a[f]=function(p){return new Promise(function(m,y){o.push([f,p,m,y])>1||s(f,p)})})}function s(f,p){try{c(r[f](p))}catch(m){d(o[0][3],m)}}function c(f){f.value instanceof ef?Promise.resolve(f.value.v).then(l,u):d(o[0][2],f)}function l(f){s("next",f)}function u(f){s("throw",f)}function d(f,p){f(p),o.shift(),o.length&&s(o[0][0],o[0][1])}}const x9=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Bge(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=Vge(t),[r,a]=n.tee();return{stream:Uge(r),response:zge(a)}}async function zge(e){const t=[],n=e.getReader();for(;;){const{done:r,value:a}=await n.read();if(r)return SS(qge(t));t.push(a)}}function Uge(e){return Fge(this,arguments,function*(){const t=e.getReader();for(;;){const{value:n,done:r}=yield ef(t.read());if(r)break;yield yield ef(SS(n))}})}function Vge(e){const t=e.getReader();return new ReadableStream({start(n){let r="";return a();function a(){return t.read().then(({value:o,done:i})=>{if(i){if(r.trim()){n.error(new nr("Failed to parse stream"));return}n.close();return}r+=o;let s=r.match(x9),c;for(;s;){try{c=JSON.parse(s[1])}catch{n.error(new nr(`Error parsing JSON response: "${s[1]}"`));return}n.enqueue(c),r=r.substring(s[0].length),s=r.match(x9)}return a()})}}})}function qge(e){const t=e[e.length-1],n={promptFeedback:t==null?void 0:t.promptFeedback};for(const r of e){if(r.candidates)for(const a of r.candidates){const o=a.index;if(n.candidates||(n.candidates=[]),n.candidates[o]||(n.candidates[o]={index:a.index}),n.candidates[o].citationMetadata=a.citationMetadata,n.candidates[o].groundingMetadata=a.groundingMetadata,n.candidates[o].finishReason=a.finishReason,n.candidates[o].finishMessage=a.finishMessage,n.candidates[o].safetyRatings=a.safetyRatings,a.content&&a.content.parts){n.candidates[o].content||(n.candidates[o].content={role:a.content.role||"user",parts:[]});const i={};for(const s of a.content.parts)s.text&&(i.text=s.text),s.functionCall&&(i.functionCall=s.functionCall),s.executableCode&&(i.executableCode=s.executableCode),s.codeExecutionResult&&(i.codeExecutionResult=s.codeExecutionResult),Object.keys(i).length===0&&(i.text=""),n.candidates[o].content.parts.push(i)}}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}async function _9(e,t,n,r){const a=await Qd(t,vs.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),r);return Bge(a)}async function j9(e,t,n,r){const a=await(await Qd(t,vs.GENERATE_CONTENT,e,!1,JSON.stringify(n),r)).json();return{response:SS(a)}}function S9(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function tf(e){let t=[];if(typeof e=="string")t=[{text:e}];else for(const n of e)typeof n=="string"?t.push({text:n}):t.push(n);return Wge(t)}function Wge(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,a=!1;for(const o of e)"functionResponse"in o?(n.parts.push(o),a=!0):(t.parts.push(o),r=!0);if(r&&a)throw new nr("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!a)throw new nr("No content is provided for sending chat message.");return r?t:n}function Hge(e,t){var n;let r={model:t==null?void 0:t.model,generationConfig:t==null?void 0:t.generationConfig,safetySettings:t==null?void 0:t.safetySettings,tools:t==null?void 0:t.tools,toolConfig:t==null?void 0:t.toolConfig,systemInstruction:t==null?void 0:t.systemInstruction,cachedContent:(n=t==null?void 0:t.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const a=e.generateContentRequest!=null;if(e.contents){if(a)throw new _i("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=e.contents}else if(a)r=Object.assign(Object.assign({},r),e.generateContentRequest);else{const o=tf(e);r.contents=[o]}return{generateContentRequest:r}}function E9(e){let t;return e.contents?t=e:t={contents:[tf(e)]},e.systemInstruction&&(t.systemInstruction=S9(e.systemInstruction)),t}function Kge(e){return typeof e=="string"||Array.isArray(e)?{content:tf(e)}:e}const O9=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Zge={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Gge(e){let t=!1;for(const n of e){const{role:r,parts:a}=n;if(!t&&r!=="user")throw new nr(`First content should be with role 'user', got ${r}`);if(!f9.includes(r))throw new nr(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(f9)}`);if(!Array.isArray(a))throw new nr("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new nr("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const s of a)for(const c of O9)c in s&&(o[c]+=1);const i=Zge[r];for(const s of O9)if(!i.includes(s)&&o[s]>0)throw new nr(`Content with role '${r}' can't contain '${s}' part`);t=!0}}const C9="SILENT_ERROR";class Xge{constructor(t,n,r,a={}){this.model=n,this.params=r,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,r!=null&&r.history&&(Gge(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,n={}){var r,a,o,i,s,c;await this._sendPromise;const l=tf(t),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),n);let f;return this._sendPromise=this._sendPromise.then(()=>j9(this._apiKey,this.model,u,d)).then(p=>{var m;if(p.response.candidates&&p.response.candidates.length>0){this._history.push(l);const y=Object.assign({parts:[],role:"model"},(m=p.response.candidates)===null||m===void 0?void 0:m[0].content);this._history.push(y)}else{const y=ji(p.response);y&&console.warn(`sendMessage() was unsuccessful. ${y}. Inspect response object for details.`)}f=p}),await this._sendPromise,f}async sendMessageStream(t,n={}){var r,a,o,i,s,c;await this._sendPromise;const l=tf(t),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),n),f=_9(this._apiKey,this.model,u,d);return this._sendPromise=this._sendPromise.then(()=>f).catch(p=>{throw new Error(C9)}).then(p=>p.response).then(p=>{if(p.candidates&&p.candidates.length>0){this._history.push(l);const m=Object.assign({},p.candidates[0].content);m.role||(m.role="model"),this._history.push(m)}else{const m=ji(p);m&&console.warn(`sendMessageStream() was unsuccessful. ${m}. Inspect response object for details.`)}}).catch(p=>{p.message!==C9&&console.error(p)}),f}}async function Jge(e,t,n,r){return(await Qd(t,vs.COUNT_TOKENS,e,!1,JSON.stringify(n),r)).json()}async function Yge(e,t,n,r){return(await Qd(t,vs.EMBED_CONTENT,e,!1,JSON.stringify(n),r)).json()}async function Qge(e,t,n,r){const a=n.requests.map(o=>Object.assign(Object.assign({},o),{model:t}));return(await Qd(t,vs.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:a}),r)).json()}class N9{constructor(t,n,r={}){this.apiKey=t,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=S9(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(t,n={}){var r;const a=E9(t),o=Object.assign(Object.assign({},this._requestOptions),n);return j9(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}async generateContentStream(t,n={}){var r;const a=E9(t),o=Object.assign(Object.assign({},this._requestOptions),n);return _9(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}startChat(t){var n;return new Xge(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},t),this._requestOptions)}async countTokens(t,n={}){const r=Hge(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),n);return Jge(this.apiKey,this.model,r,a)}async embedContent(t,n={}){const r=Kge(t),a=Object.assign(Object.assign({},this._requestOptions),n);return Yge(this.apiKey,this.model,r,a)}async batchEmbedContents(t,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return Qge(this.apiKey,this.model,t,r)}}class M9{constructor(t){this.apiKey=t}getGenerativeModel(t,n){if(!t.model)throw new nr("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new N9(this.apiKey,t,n)}getGenerativeModelFromCachedContent(t,n,r){if(!t.name)throw new _i("Cached content must contain a `name` field.");if(!t.model)throw new _i("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const i of a)if(n!=null&&n[i]&&t[i]&&(n==null?void 0:n[i])!==t[i]){if(i==="model"){const s=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(s===c)continue}throw new _i(`Different value for "${i}" specified in modelParams (${n[i]}) and cachedContent (${t[i]})`)}const o=Object.assign(Object.assign({},n),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new N9(this.apiKey,o,r)}}const eve=Symbol("Let zodToJsonSchema decide on which parser to use"),tve={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},nve=e=>({...tve,...e}),rve=e=>{const t=nve(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function k9(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Nt(e,t,n,r,a){e[t]=n,k9(e,t,r,a)}function ave(){return{}}function ove(e,t){var r,a,o;const n={type:"array"};return(r=e.type)!=null&&r._def&&((o=(a=e.type)==null?void 0:a._def)==null?void 0:o.typeName)!==te.ZodAny&&(n.items=vt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Nt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Nt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Nt(n,"minItems",e.exactLength.value,e.exactLength.message,t),Nt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function ive(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function sve(){return{type:"boolean"}}function P9(e,t){return vt(e.type._def,t)}const cve=(e,t)=>vt(e.innerType._def,t);function A9(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>A9(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return lve(e,t)}}const lve=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Nt(n,"minimum",r.value,r.message,t);break;case"max":Nt(n,"maximum",r.value,r.message,t);break}return n};function uve(e,t){return{...vt(e.innerType._def,t),default:e.defaultValue()}}function dve(e,t){return t.effectStrategy==="input"?vt(e.schema._def,t):{}}function fve(e){return{type:"string",enum:Array.from(e.values)}}const pve=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function hve(e,t){const n=[vt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),vt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(pve(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function mve(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let ES;const ga={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ES===void 0&&(ES=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ES),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function T9(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":va(n,"email",r.message,t);break;case"format:idn-email":va(n,"idn-email",r.message,t);break;case"pattern:zod":qn(n,ga.email,r.message,t);break}break;case"url":va(n,"uri",r.message,t);break;case"uuid":va(n,"uuid",r.message,t);break;case"regex":qn(n,r.regex,r.message,t);break;case"cuid":qn(n,ga.cuid,r.message,t);break;case"cuid2":qn(n,ga.cuid2,r.message,t);break;case"startsWith":qn(n,RegExp(`^${OS(r.value,t)}`),r.message,t);break;case"endsWith":qn(n,RegExp(`${OS(r.value,t)}$`),r.message,t);break;case"datetime":va(n,"date-time",r.message,t);break;case"date":va(n,"date",r.message,t);break;case"time":va(n,"time",r.message,t);break;case"duration":va(n,"duration",r.message,t);break;case"length":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{qn(n,RegExp(OS(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&va(n,"ipv4",r.message,t),r.version!=="v4"&&va(n,"ipv6",r.message,t);break}case"base64url":qn(n,ga.base64url,r.message,t);break;case"jwt":qn(n,ga.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&qn(n,ga.ipv4Cidr,r.message,t),r.version!=="v4"&&qn(n,ga.ipv6Cidr,r.message,t);break}case"emoji":qn(n,ga.emoji(),r.message,t);break;case"ulid":{qn(n,ga.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{va(n,"binary",r.message,t);break}case"contentEncoding:base64":{Nt(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{qn(n,ga.base64,r.message,t);break}}break}case"nanoid":qn(n,ga.nanoid,r.message,t)}return n}function OS(e,t){return t.patternStrategy==="escape"?gve(e):e}const yve=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function gve(e){let t="";for(let n=0;n<e.length;n++)yve.has(e[n])||(t+="\\"),t+=e[n];return t}function va(e,t,n,r){var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Nt(e,"format",t,n,r)}function qn(e,t,n,r){var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:I9(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Nt(e,"pattern",I9(t,r),n,r)}function I9(e,t){var c;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let a="",o=!1,i=!1,s=!1;for(let l=0;l<r.length;l++){if(o){a+=r[l],o=!1;continue}if(n.i){if(i){if(r[l].match(/[a-z]/)){s?(a+=r[l],a+=`${r[l-2]}-${r[l]}`.toUpperCase(),s=!1):r[l+1]==="-"&&((c=r[l+2])!=null&&c.match(/[a-z]/))?(a+=r[l],s=!0):a+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){a+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(n.m){if(r[l]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[l]==="."){a+=i?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}a+=r[l],r[l]==="\\"?o=!0:i&&r[l]==="]"?i=!1:!i&&r[l]==="["&&(i=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function R9(e,t){var r,a,o,i,s,c;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===te.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((l,u)=>({...l,[u]:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===te.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const{type:l,...u}=T9(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((i=e.keyType)==null?void 0:i._def.typeName)===te.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((s=e.keyType)==null?void 0:s._def.typeName)===te.ZodBranded&&e.keyType._def.type._def.typeName===te.ZodString&&((c=e.keyType._def.type._def.checks)!=null&&c.length)){const{type:l,...u}=P9(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function vve(e,t){if(t.mapStrategy==="record")return R9(e,t);const n=vt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function bve(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function wve(){return{not:{}}}function xve(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const my={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function _ve(e,t){if(t.target==="openApi3")return D9(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in my&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=my[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return D9(e,t)}const D9=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>vt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function jve(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:my[e.innerType._def.typeName],nullable:!0}:{type:[my[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=vt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Sve(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",k9(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function Eve(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Ove(e,t){const n=t.target==="openAi",r={type:"object",...Object.entries(e.shape()).reduce((a,[o,i])=>{if(i===void 0||i._def===void 0)return a;let s=i.isOptional();s&&n&&(i instanceof qDe&&(i=i._def.innerType),i.isNullable()||(i=i.nullable()),s=!1);const c=vt(i._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});return c===void 0?a:{properties:{...a.properties,[o]:c},required:s?a.required:[...a.required,o]}},{properties:{},required:[]}),additionalProperties:Eve(e,t)};return r.required.length||delete r.required,r}const Cve=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return vt(e.innerType._def,t);const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Nve=(e,t)=>{if(t.pipeStrategy==="input")return vt(e.in._def,t);if(t.pipeStrategy==="output")return vt(e.out._def,t);const n=vt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=vt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Mve(e,t){return vt(e.type._def,t)}function kve(e,t){const n={type:"array",uniqueItems:!0,items:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Nt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Nt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Pve(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:vt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Ave(){return{not:{}}}function Tve(){return{}}const Ive=(e,t)=>vt(e.innerType._def,t);function vt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==eve)return s}if(r&&!n){const s=Rve(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Lve(e,e.typeName,t);return o&&$ve(e,t,o),a.jsonSchema=o,o}const Rve=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Dve(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Dve=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Lve=(e,t,n)=>{switch(t){case te.ZodString:return T9(e,n);case te.ZodNumber:return Sve(e,n);case te.ZodObject:return Ove(e,n);case te.ZodBigInt:return ive(e,n);case te.ZodBoolean:return sve();case te.ZodDate:return A9(e,n);case te.ZodUndefined:return Ave();case te.ZodNull:return xve(n);case te.ZodArray:return ove(e,n);case te.ZodUnion:case te.ZodDiscriminatedUnion:return _ve(e,n);case te.ZodIntersection:return hve(e,n);case te.ZodTuple:return Pve(e,n);case te.ZodRecord:return R9(e,n);case te.ZodLiteral:return mve(e,n);case te.ZodEnum:return fve(e);case te.ZodNativeEnum:return bve(e);case te.ZodNullable:return jve(e,n);case te.ZodOptional:return Cve(e,n);case te.ZodMap:return vve(e,n);case te.ZodSet:return kve(e,n);case te.ZodLazy:return vt(e.getter()._def,n);case te.ZodPromise:return Mve(e,n);case te.ZodNaN:case te.ZodNever:return wve();case te.ZodEffects:return dve(e,n);case te.ZodAny:return ave();case te.ZodUnknown:return Tve();case te.ZodDefault:return uve(e,n);case te.ZodBranded:return P9(e,n);case te.ZodReadonly:return Ive(e,n);case te.ZodCatch:return cve(e,n);case te.ZodPipeline:return Nve(e,n);case te.ZodFunction:case te.ZodVoid:case te.ZodSymbol:return;default:return(r=>{})()}},$ve=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Fve=(e,t)=>{const n=rve(t),r=void 0,a=t==null?void 0:t.name,o=vt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};function nf(e){if(typeof e=="object"&&e!==null){const t={...e};"additionalProperties"in t&&delete t.additionalProperties,"$schema"in t&&delete t.$schema;for(const n in t)n in t&&(Array.isArray(t[n])?t[n]=t[n].map(nf):typeof t[n]=="object"&&t[n]!==null&&(t[n]=nf(t[n])));return t}return e}function L9(e){const t=nf(Fve(e)),{$schema:n,...r}=t;return r}function Bve(e){const t=nf(e),{$schema:n,...r}=t;return r}function zve(e){const t=e._getType();return Ev.isInstance(e)?e.role:t==="tool"?t:e.name??t}function Uve(e){switch(e){case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${e}`)}}function Vve(e){if("mimeType"in e&&"data"in e)return{inlineData:{mimeType:e.mimeType,data:e.data}};if("mimeType"in e&&"fileUri"in e)return{fileData:{mimeType:e.mimeType,fileUri:e.fileUri}};throw new Error("Invalid media content")}function qve(e,t){if(typeof e.content=="string"&&e.content!=="")return[{text:e.content}];let n=[],r=[],a=[];return"tool_calls"in e&&Array.isArray(e.tool_calls)&&e.tool_calls.length>0?n=e.tool_calls.map(o=>({functionCall:{name:o.name,args:o.args}})):e.getType()==="tool"&&e.name&&e.content?r=[{functionResponse:{name:e.name,response:e.content}}]:Array.isArray(e.content)&&(a=e.content.map(o=>{var i;if(o.type==="text")return{text:o.text};if(o.type==="executableCode")return{executableCode:o.executableCode};if(o.type==="codeExecutionResult")return{codeExecutionResult:o.codeExecutionResult};if(o.type==="image_url"){if(!t)throw new Error("This model does not support images");let s;if(typeof o.image_url=="string")s=o.image_url;else if(typeof o.image_url=="object"&&"url"in o.image_url)s=o.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[c,l]=s.split(",");if(!c.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[u,d]=c.replace(/^data:/,"").split(";");if(d!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:l,mimeType:u}}}else{if(o.type==="media")return Vve(o);if(o.type==="tool_use")return{functionCall:{name:o.name,args:o.input}};if((i=o.type)!=null&&i.includes("/")&&o.type.split("/").length===2&&"data"in o&&typeof o.data=="string")return{inlineData:{mimeType:o.type,data:o.data}}}throw new Error(`Unknown content type ${o.type}`)})),[...a,...n,...r]}function $9(e,t,n=!1){return e.reduce((r,a,o)=>{if(!BG(a))throw new Error("Unsupported message input");const i=zve(a);if(i==="system"&&o!==0)throw new Error("System message should be the first one");const s=Uve(i),c=r.content[r.content.length];if(!r.mergeWithPreviousContent&&c&&c.role===s)throw new Error("Google Generative AI requires alternate messages between authors");const l=qve(a,t);if(r.mergeWithPreviousContent){const f=r.content[r.content.length-1];if(!f)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return f.parts.push(...l),{mergeWithPreviousContent:!1,content:r.content}}let u=s;(u==="function"||u==="system"&&!n)&&(u="user");const d={role:u,parts:l};return{mergeWithPreviousContent:i==="system"&&!n,content:[...r.content,d]}},{content:[],mergeWithPreviousContent:!1}).content}function Wve(e,t){if(!e.candidates||e.candidates.length===0||!e.candidates[0])return{generations:[],llmOutput:{filters:e.promptFeedback}};const n=e.functionCalls(),[r]=e.candidates,{content:a,...o}=r;let i;(a==null?void 0:a.parts.length)===1&&a.parts[0].text?i=a.parts[0].text:i=a.parts.map(c=>"text"in c?{type:"text",text:c.text}:"executableCode"in c?{type:"executableCode",executableCode:c.executableCode}:"codeExecutionResult"in c?{type:"codeExecutionResult",codeExecutionResult:c.codeExecutionResult}:c);let s="";return typeof i=="string"?s=i:"text"in i[0]&&(s=i[0].text),{generations:[{text:s,message:new ka({content:i,tool_calls:n==null?void 0:n.map(c=>({...c,type:"tool_call"})),additional_kwargs:{...o},usage_metadata:t==null?void 0:t.usageMetadata}),generationInfo:o}]}}function Hve(e,t){if(!e.candidates||e.candidates.length===0)return null;const n=e.functionCalls(),[r]=e.candidates,{content:a,...o}=r;let i;a!=null&&a.parts&&a.parts.every(l=>"text"in l)?i=a.parts.map(l=>l.text).join(""):a.parts&&(i=a.parts.map(l=>"text"in l?{type:"text",text:l.text}:"executableCode"in l?{type:"executableCode",executableCode:l.executableCode}:"codeExecutionResult"in l?{type:"codeExecutionResult",codeExecutionResult:l.codeExecutionResult}:l));let s="";i&&typeof i=="string"?s=i:i&&typeof i=="object"&&"text"in i[0]&&(s=i[0].text);const c=[];return n&&c.push(...n.map(l=>({...l,args:JSON.stringify(l.args),index:t.index,type:"tool_call_chunk"}))),new qi({text:s,message:new nu({content:i||"",name:a?a.role:void 0,tool_call_chunks:c,additional_kwargs:{},usage_metadata:t.usageMetadata}),generationInfo:o})}function Kve(e){return e.every(t=>"functionDeclarations"in t&&Array.isArray(t.functionDeclarations))?e:[{functionDeclarations:e.map(t=>{if(Qm(t)){const n=L9(t.schema);return{name:t.name,description:t.description,parameters:n}}return cS(t)?{name:t.function.name,description:t.function.description??"A function available to call.",parameters:Bve(t.function.parameters)}:t})}]}class F9 extends t8{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new Gm(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parseResult(t){const n=t.flatMap(a=>{const{message:o}=a;return!("tool_calls"in o)||!Array.isArray(o.tool_calls)?[]:o.tool_calls});if(n[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[r]=n;return await this._validateResult(r.args)}}function B9(e,t){const n=Zve(e),r=Xve(n,t);return{tools:n,toolConfig:r}}function Zve(e){let t=[];const n=[];return e.forEach(r=>{if(Qm(r)){const[a]=Kve([r]);a.functionDeclarations&&t.push(...a.functionDeclarations)}else if(cS(r)){const{functionDeclarations:a}=Gve(r);if(a)t.push(...a);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else n.push(r)}),n.find(r=>"functionDeclarations"in r)?n.map(r=>{if((t==null?void 0:t.length)>0&&"functionDeclarations"in r){const a={functionDeclarations:[...r.functionDeclarations||[],...t]};return t=[],a}return r}):[...n,...t.length>0?[{functionDeclarations:t}]:[]]}function Gve(e){return{functionDeclarations:[{name:e.function.name,description:e.function.description,parameters:nf(e.function.parameters)}]}}function Xve(e,t){if(!e.length||!t)return;const{toolChoice:n,allowedFunctionNames:r}=t,a={any:el.ANY,auto:el.AUTO,none:el.NONE};if(n&&["any","auto","none"].includes(n))return{functionCallingConfig:{mode:a[n]??"MODE_UNSPECIFIED",allowedFunctionNames:r}};if(typeof n=="string"||r)return{functionCallingConfig:{mode:el.ANY,allowedFunctionNames:[...r??[],...n&&typeof n=="string"?[n]:[]]}}}class Jve extends Za{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(t){var n,r;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=((n=t==null?void 0:t.model)==null?void 0:n.replace(/^models\//,""))??((r=t==null?void 0:t.modelName)==null?void 0:r.replace(/^models\//,""))??this.model,this.model=this.modelName,this.maxOutputTokens=(t==null?void 0:t.maxOutputTokens)??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.temperature&&(this.temperature<0||this.temperature>1))throw new Error("`temperature` must be in the range of [0.0,1.0]");if(this.topP=(t==null?void 0:t.topP)??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=(t==null?void 0:t.topK)??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=(t==null?void 0:t.stopSequences)??this.stopSequences,this.apiKey=(t==null?void 0:t.apiKey)??co("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=(t==null?void 0:t.safetySettings)??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(a=>a.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.client=new M9(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{candidateCount:1,stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...t!=null&&t.json?{responseMimeType:"application/json"}:{}}},{apiVersion:t==null?void 0:t.apiVersion,baseUrl:t==null?void 0:t.baseUrl}),this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage}useCachedContent(t,n,r){this.apiKey&&(this.client=new M9(this.apiKey).getGenerativeModelFromCachedContent(t,n,r))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.modelName==="gemini-1.0-pro-001"||this.modelName.startsWith("gemini-pro-vision")||this.modelName.startsWith("gemini-1.0-pro-vision")?!1:this.modelName!=="gemini-pro"}getLsParams(t){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:t.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(t,n){var r;return this.bind({tools:(r=B9(t))==null?void 0:r.tools,...n})}invocationParams(t){var r;const n=(r=t==null?void 0:t.tools)!=null&&r.length?B9(t.tools,{toolChoice:t.tool_choice,allowedFunctionNames:t.allowedFunctionNames}):void 0;return{...n!=null&&n.tools?{tools:n.tools}:{},...n!=null&&n.toolConfig?{toolConfig:n.toolConfig}:{}}}async _generate(t,n,r){var u;const a=$9(t,this._isMultimodalModel,this.useSystemInstruction);let o=a;if(a[0].role==="system"){const[d]=a;this.client.systemInstruction=d,o=a.slice(1)}const i=this.invocationParams(n);if(this.streaming){const d={},f=this._streamResponseChunks(t,n,r),p={};for await(const m of f){const y=((u=m.generationInfo)==null?void 0:u.completion)??0;p[y]===void 0?p[y]=m:p[y]=p[y].concat(m)}return{generations:Object.entries(p).sort(([m],[y])=>parseInt(m,10)-parseInt(y,10)).map(([m,y])=>y),llmOutput:{estimatedTokenUsage:d}}}const s=await this.completionWithRetry({...i,contents:o});let c;if("usageMetadata"in s.response){const d=s.response.usageMetadata;c={input_tokens:d.promptTokenCount??0,output_tokens:d.candidatesTokenCount??0,total_tokens:d.totalTokenCount??0}}const l=Wve(s.response,{usageMetadata:c});return await(r==null?void 0:r.handleLLMNewToken(l.generations[0].text??"")),l}async*_streamResponseChunks(t,n,r){const a=$9(t,this._isMultimodalModel,this.useSystemInstruction);let o=a;if(a[0].role==="system"){const[u]=a;this.client.systemInstruction=u,o=a.slice(1)}const i={...this.invocationParams(n),contents:o},s=await this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{const{stream:u}=await this.client.generateContentStream(i);return u});let c,l=0;for await(const u of s){if("usageMetadata"in u&&this.streamUsage!==!1&&n.streamUsage!==!1){const f=u.usageMetadata;if(!c)c={input_tokens:f.promptTokenCount,output_tokens:f.candidatesTokenCount,total_tokens:f.totalTokenCount};else{const p=f.candidatesTokenCount-c.output_tokens;c={input_tokens:0,output_tokens:p,total_tokens:p}}}const d=Hve(u,{usageMetadata:c,index:l});l+=1,d&&(yield d,await(r==null?void 0:r.handleLLMNewToken(d.text??"")))}}async completionWithRetry(t,n){return this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{var r;try{return await this.client.generateContent(t)}catch(a){throw(r=a.message)!=null&&r.includes("400 Bad Request")&&(a.status=400),a}})}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;if(o==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "functionCalling" as a method.');let s=a??"extract",c,l;if(Xd(r)){const m=L9(r);l=[{functionDeclarations:[{name:s,description:m.description??"A function available to call.",parameters:m}]}],c=new F9({returnSingle:!0,keyName:s,zodSchema:r})}else{let m;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(m=r,s=r.name):m={name:s,description:r.description??"",parameters:r},l=[{functionDeclarations:[m]}],c=new F9({returnSingle:!0,keyName:s})}const u=this.bind({tools:l,tool_choice:s});if(!i)return u.pipe(c).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const d=wi.assign({parsed:(m,y)=>c.invoke(m.raw,y)}),f=wi.assign({parsed:()=>null}),p=d.withFallbacks({fallbacks:[f]});return jv.from([{raw:u},p]).withConfig({runName:"StructuredOutputRunnable"})}}const Yve=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},z9=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},Qve=e=>{const t={},n={string:Ma.string,number:Ma.number,boolean:Ma.boolean,enum:()=>Ma.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=Ma.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=Ma.array(Ma.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=Ma.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),Ma.object(t)},CS=async(e,t,{schemas:n,onMessageUpdate:r})=>{let a="",o;if(n!=null&&n.length){const i=n.filter(c=>{var l;return(l=c.schema_items)==null?void 0:l.length}).flatMap(c=>c.schema_items),s=await e.withStructuredOutput(Qve(i)).stream(t);for await(const c of s)a=JSON.stringify(c),r==null||r({content:a})}else{const i=await e.stream(t);for await(const s of i)a+=`${s.content}`,o=s,r==null||r({content:a,chunk:s})}return{lastChunk:o,content:a}},e0e=()=>{const{toast:e}=nn(),{t}=ke("errors"),n=et(a=>a.currentSession),{modalRef:r}=Ic(kd);return{stream:g.useCallback(async(a,o)=>{var y,v,b,w,j;const{schemas:i,onMessageUpdate:s,onMessageFinish:c}=o||{};if(!(n!=null&&n.passphrase))throw new Error("Session is not found");await mp.exists("passphrase")||await new Promise((x,_)=>{r.current.show({onConfirm:async S=>{try{const E=await dj(n.passphrase,S);await mp.set("passphrase",E),x()}catch(E){e({content:t("invalid_passphrase"),variant:"destructive"}),_(E)}finally{r.current.hide()}},onCancel:()=>{_()}})});const l=(y=o==null?void 0:o.llm)==null?void 0:y.parameters,u=((v=o==null?void 0:o.llm)==null?void 0:v.options)||{};if(!(l!=null&&l.key)||typeof l.key!="string")throw new Error("API Key is not found");const d=await mp.get("passphrase");if(!d)throw new Error("Passphrase is not found");const f=await dj(l.key,d);if(!f)throw new Error("API Key is not found");let p="",m;switch(o==null?void 0:o.provider){case nt.GoogleGenerativeAI:{const x=new Jve({apiKey:f,model:(b=o==null?void 0:o.llm)==null?void 0:b.name,temperature:u!=null&&u.temperature?+u.temperature:void 0,topK:u!=null&&u.topK?+u.topK:void 0,topP:u!=null&&u.topP?+u.topP:void 0,stopSequences:u!=null&&u.stop?u.stop:void 0,maxOutputTokens:u!=null&&u.maxTokens?+u.maxTokens:void 0});if(l!=null&&l.enabled_google_search_retrieval){const S={googleSearchRetrieval:{dynamicRetrievalConfig:{mode:"MODE_DYNAMIC",dynamicThreshold:.7}}};x.bindTools([S])}const _=await CS(x,a,{schemas:i,onMessageUpdate:s});p=_.content,m=_.lastChunk}break;case nt.Groq:{const x=new Sge({apiKey:f,model:(w=o==null?void 0:o.llm)==null?void 0:w.name,temperature:u!=null&&u.temperature?+u.temperature:void 0,stopSequences:u!=null&&u.stop?u.stop:void 0,maxTokens:u!=null&&u.maxTokens?+u.maxTokens:void 0}),_=await CS(x,a,{schemas:i,onMessageUpdate:s});p=_.content,m=_.lastChunk}break;case nt.OpenAI:{const x=new sye({apiKey:f,model:(j=o==null?void 0:o.llm)==null?void 0:j.name,temperature:u!=null&&u.temperature?+u.temperature:void 0,topP:u!=null&&u.topP?+u.topP:void 0,stopSequences:u!=null&&u.stop?u.stop:void 0,maxTokens:u!=null&&u.maxTokens?+u.maxTokens:void 0}),_=await CS(x,a,{schemas:i,onMessageUpdate:s});p=_.content,m=_.lastChunk}break;default:throw new Error("Provider is not supported")}return c==null||c({content:p,lastChunk:m}),{lastChunk:m,content:p}},[n,r,t,e])}},nl=()=>{const e=Wk(),t=e0e();return{stream:g.useCallback((n,r,a)=>{switch(n){case nt.WebLLM:return e.stream(r,a);case nt.GoogleGenerativeAI:case nt.Groq:case nt.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},t0e=e=>{const[t]=g.useState(!1),n=Vs(i=>i.similaritySearchWithScore),{stream:r}=nl(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,f,p,m;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case Js.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const y=(d=u.metadata)!=null&&d.k?+((f=u.metadata)==null?void 0:f.k):1;let v=(p=u.metadata)!=null&&p.minimalScore?+((m=u.metadata)==null?void 0:m.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,y);if(!b)return[];const w=new ai({template:l.promptEntity.content,inputVariables:["context"]});c.push(new ka(await w.format({context:v?b.filter(([,j])=>j>=v).map(([j])=>j.pageContent).join(`
`):b.map(([j])=>j.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:f})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==Je.Loaded)throw new Error("LLM not found");const p=[];c!=null&&c.length&&(p.push(...await a(i,c)),f==null||f(p));const m=s.map(w=>w.role==="system"?new Ov(w.content):w.role==="user"?new zr(w.content):new ka(w.content));d==null||d();const{content:y}=await r(e.mainLLMInfo.llm.provider,m,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:y}}),y},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},n0e=so(({onDelete:e})=>{const{t}=ke("dialogs"),[n,r]=g.useState(!1),a=tn(),{toast:o}=nn(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(V2,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(Fb,{children:[h.jsxs(Bb,{children:[h.jsx(Ub,{children:t("delete_chat_data_node.title")}),h.jsx(Vb,{children:t("delete_chat_data_node.description")})]}),h.jsxs(zb,{children:[h.jsx(Wb,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(qb,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function yy(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const r0e=g.lazy(()=>Ht(()=>import("./index-DyMIM4Bi.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([5,6,1,2,7,8]))),NS=g.memo(({source:e,className:t,...n})=>{const r=eu(o=>o.theme),a=g.useMemo(()=>({pre:({children:o,className:i,...s})=>h.jsx("pre",{...s,className:Z(i,"nowheel"),children:o}),think:({children:o})=>h.jsxs(h.Fragment,{children:[h.jsx("code",{className:"!rounded-none",children:"Think: "}),h.jsx("blockquote",{className:"think",children:o})]})}),[]);return h.jsx(g.Suspense,{children:h.jsx(r0e,{className:Z("!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",t),source:e,wrapperElement:{"data-color-mode":r==="dark"?"dark":"light"},components:a,...n})})},(e,t)=>e.source===t.source),en=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));en.displayName="Card";const Wn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex flex-col space-y-1.5 p-6",e),...t}));Wn.displayName="CardHeader";const rr=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:Z("text-2xl font-semibold leading-none tracking-tight",e),...t}));rr.displayName="CardTitle";const U9=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));U9.displayName="CardDescription";const Hn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("p-6 pt-0",e),...t}));Hn.displayName="CardContent";const Si=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center p-6 pt-0",e),...t}));Si.displayName="CardFooter";const V9=g.memo(e=>{const[t,n]=g.useState(!1),[r,a]=g.useState(e.llmOptions||{}),{t:o}=ke("atoms"),i=()=>{t||a(e.llmOptions||{}),n(!t)},s=()=>{var c;(c=e.onChangeOptions)==null||c.call(e,r||{}),n(!1)};return h.jsxs("div",{className:e.className,children:[h.jsxs("div",{className:"flex justify-end gap-2",children:[t?h.jsx(tt,{variant:"secondary",onClick:s,children:o("llm_setting.save")}):void 0,h.jsxs(tt,{onClick:i,variant:"link",className:"flex items-center px-0",children:[h.jsx(fe,{name:"settings"}),h.jsx(qe,{children:o(t?"llm_setting.hide":"llm_setting.title")})]})]}),t?h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsxs(qe,{children:[o("llm_setting.temperature"),":"]}),h.jsx(Gt,{type:"number",value:r.temperature?`${r.temperature}`:"",onChange:c=>a(l=>({...l,temperature:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(qe,{children:[o("llm_setting.top_p"),":"]}),h.jsx(Gt,{type:"number",value:r.topP?`${r.topP}`:"",onChange:c=>a(l=>({...l,topP:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(qe,{children:[o("llm_setting.top_k"),":"]}),h.jsx(Gt,{type:"number",value:r.topK?`${r.topK}`:"",onChange:c=>a(l=>({...l,topK:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(qe,{children:[o("llm_setting.max_tokens"),":"]}),h.jsx(Gt,{type:"number",value:r.max_tokens?`${r.max_tokens}`:"",onChange:c=>a(l=>({...l,maxTokens:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(qe,{children:[o("llm_setting.stop_sequences"),":"]}),h.jsx(Gt,{placeholder:o("llm_setting.stop_sequences_placeholder"),value:r.stop?`${r.stop}`:"",onChange:c=>a(l=>({...l,stop:c.target.value}))})]}),h.jsx("div",{className:"flex justify-end mt-4"})]}):void 0]})}),a0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),o0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),i0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),s0e=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),c0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),l0e="/NoLLMChat/assets/qwen-B-gSh3_v.webp",u0e="/NoLLMChat/assets/smollm-CikBjd4F.png",d0e="/NoLLMChat/assets/stablelm-BquePdQ7.png",f0e="/NoLLMChat/assets/nomic-BjJqoFji.webp",p0e="/NoLLMChat/assets/joshua-ByaReJuI.webp",h0e="/NoLLMChat/assets/deepseek-CRqFMahi.png",m0e="/NoLLMChat/assets/redpajama-CmUGqSQW.png",y0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),g0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Pr=g.memo(({name:e,className:t,...n})=>{const r=eu(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(y0e,{className:Z("w-5 h-5",t),...n}):h.jsx(g0e,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("deepseek")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:h0e,alt:"deepseek",...n}):e!=null&&e.includes("redpajama")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:m0e,alt:"deepseek",...n}):e.includes("gemma")||e.includes("gemini")?h.jsx(o0e,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:Z("w-5 h-5",t),src:l0e,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(i0e,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(s0e,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:Z("w-5 h-5",t),src:u0e,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(c0e,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(a0e,{className:Z("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:d0e,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:f0e,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:p0e,alt:"Xenova",...n}):h.jsx(fe,{className:Z("w-5 h-5",t),name:"brain"})}),MS=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC","DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC"],v0e=io("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function bn({className:e,variant:t,...n}){return h.jsx("div",{className:Z(v0e({variant:t}),e),...n})}const rf=g.memo(e=>{var l;const{cloud:t,name:n,model:r,isCached:a,isFunctionCalling:o}=e,{t:i}=ke("atoms"),s=g.useCallback(u=>u===1?"llm_info.model_types.embedding":u===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),c=g.useMemo(()=>{if(r)switch(r.model_type){case 0:case 1:return h.jsx(bn,{className:"",children:i(s(r.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(bn,{className:"",children:i(s(0))}),h.jsx(bn,{className:"",children:i(s(r.model_type))})]})}},[r,s,i]);if(r)return h.jsxs(h.Fragment,{children:[c,MS.some(u=>n&&u.includes(n))?h.jsx(bn,{className:"",variant:"outline",children:i("llm_info.recommended")}):null,a?h.jsx(bn,{className:"",variant:"outline",children:i("llm_info.cached")}):null,t?h.jsx(bn,{className:"",variant:"outline",children:i("llm_info.cloud")}):null,o?h.jsx(bn,{className:"",variant:"outline",children:i("llm_info.function_calling")}):null,r!=null&&r.low_resource_required?h.jsx(bn,{className:"",variant:"outline",children:i("llm_info.low_resource_required")}):null,(l=r==null?void 0:r.overrides)!=null&&l.context_window_size?h.jsxs(bn,{className:"",variant:"outline",children:[r.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,r!=null&&r.vram_required_MB?h.jsxs(bn,{className:"",variant:"outline",children:["VRAM: ",r.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),b0e=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=ke("flows"),[o,i]=g.useState();g.useEffect(()=>{if(!(o||!(e!=null&&e.name))){if((e==null?void 0:e.provider)!=="WebLLM"){i({hasCache:!1,cloud:!0,isFunctionCalling:!0,info:{model_id:e==null?void 0:e.name,model:e==null?void 0:e.name,model_lib:e==null?void 0:e.provider,model_type:2}});return}Ht(()=>import("./index-PRjZyF7d.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const f=await l(e==null?void 0:e.name);i({hasCache:f,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(p=>p.model_id===(e==null?void 0:e.name))})})}},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case Je.Downloading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Je.Loaded:return h.jsx(Pr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(Pr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(en,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(rf,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1,cloud:(o==null?void 0:o.cloud)||!1}),t!==Je.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(tt,{disabled:t===Je.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})});class w0e{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class q9 extends w0e{constructor(t,{splitPages:n=!0,pdfjs:r=x0e,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new vp({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new vp({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function x0e(){try{const{default:e}=await Ht(async()=>{const{default:r}=await import("./pdf-BFmBp-D9.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([10,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var kS="Tabs",[_0e,h3e]=ur(kS,[lo]),W9=lo(),[j0e,PS]=_0e(kS),H9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=ri(s),[d,f]=Pn({prop:r,onChange:a,defaultProp:o});return h.jsx(j0e,{scope:n,baseId:Rt(),value:d,onValueChange:f,orientation:i,dir:u,activationMode:c,children:h.jsx(Ae.div,{dir:u,"data-orientation":i,...l,ref:t})})});H9.displayName=kS;var K9="TabsList",Z9=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=PS(K9,n),i=W9(n);return h.jsx(uu,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});Z9.displayName=K9;var G9="TabsTrigger",X9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=PS(G9,n),s=W9(n),c=Q9(i.baseId,r),l=eF(i.baseId,r),u=r===i.value;return h.jsx(du,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});X9.displayName=G9;var J9="TabsContent",Y9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=PS(J9,n),c=Q9(s.baseId,r),l=eF(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Br,{present:a||u,children:({present:f})=>h.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&o})})});Y9.displayName=J9;function Q9(e,t){return`${e}-trigger-${t}`}function eF(e,t){return`${e}-content-${t}`}var S0e=H9,tF=Z9,nF=X9,rF=Y9;const AS=S0e,gy=g.forwardRef(({className:e,...t},n)=>h.jsx(tF,{ref:n,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));gy.displayName=tF.displayName;const ba=g.forwardRef(({className:e,...t},n)=>h.jsx(nF,{ref:n,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ba.displayName=nF.displayName;const wa=g.forwardRef(({className:e,...t},n)=>h.jsx(rF,{ref:n,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));wa.displayName=rF.displayName,v0=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function aF(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var E0e=[" ","Enter","ArrowUp","ArrowDown"],O0e=[" ","Enter"],af="Select",[vy,by,C0e]=hp(af),[rl,m3e]=ur(af,[C0e,sc]),wy=sc(),[N0e,Ei]=rl(af),[M0e,k0e]=rl(af),oF=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:f,required:p,form:m}=e,y=wy(t),[v,b]=g.useState(null),[w,j]=g.useState(null),[x,_]=g.useState(!1),S=ri(l),[E=!1,O]=Pn({prop:r,defaultProp:a,onChange:o}),[M,C]=Pn({prop:i,defaultProp:s,onChange:c}),k=g.useRef(null),T=v?m||!!v.closest("form"):!0,[P,N]=g.useState(new Set),I=Array.from(P).map(A=>A.props.value).join(";");return h.jsx(ch,{...y,children:h.jsxs(N0e,{required:p,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:j,valueNodeHasChildren:x,onValueNodeHasChildrenChange:_,contentId:Rt(),value:M,onValueChange:C,open:E,onOpenChange:O,dir:S,triggerPointerDownPosRef:k,disabled:f,children:[h.jsx(vy.Provider,{scope:t,children:h.jsx(M0e,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(A=>{N(R=>new Set(R).add(A))},[]),onNativeOptionRemove:g.useCallback(A=>{N(R=>{const L=new Set(R);return L.delete(A),L})},[]),children:n})}),T?h.jsxs(kF,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:M,onChange:A=>C(A.target.value),disabled:f,form:m,children:[M===void 0?h.jsx("option",{value:""}):null,Array.from(P)]},I):null]})})};oF.displayName=af;var iF="SelectTrigger",sF=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=wy(n),i=Ei(iF,n),s=i.disabled||r,c=jt(t,i.onTriggerChange),l=by(n),u=g.useRef("touch"),[d,f,p]=PF(y=>{const v=l().filter(j=>!j.disabled),b=v.find(j=>j.value===i.value),w=AF(v,y,b);w!==void 0&&i.onValueChange(w.value)}),m=y=>{s||(i.onOpenChange(!0),p()),y&&(i.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return h.jsx(Nb,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":MF(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&m(y)}),onPointerDown:ge(a.onPointerDown,y=>{u.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:ge(a.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&f(y.key),!(v&&y.key===" ")&&E0e.includes(y.key)&&(m(),y.preventDefault())})})})});sF.displayName=iF;var cF="SelectValue",lF=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=Ei(cF,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=jt(t,c.onValueNodeChange);return ln(()=>{l(u)},[l,u]),h.jsx(Ae.span,{...s,ref:d,style:{pointerEvents:"none"},children:MF(c.value)?h.jsx(h.Fragment,{children:i}):o})});lF.displayName=cF;var P0e="SelectIcon",uF=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});uF.displayName=P0e;var A0e="SelectPortal",dF=e=>h.jsx(_v,{asChild:!0,...e});dF.displayName=A0e;var bs="SelectContent",fF=g.forwardRef((e,t)=>{const n=Ei(bs,e.__scopeSelect),[r,a]=g.useState();if(ln(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Ql.createPortal(h.jsx(pF,{scope:e.__scopeSelect,children:h.jsx(vy.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(hF,{...e,ref:t})});fF.displayName=bs;var xa=10,[pF,Oi]=rl(bs),T0e="SelectContentImpl",hF=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v,...b}=e,w=Ei(bs,n),[j,x]=g.useState(null),[_,S]=g.useState(null),E=jt(t,J=>x(J)),[O,M]=g.useState(null),[C,k]=g.useState(null),T=by(n),[P,N]=g.useState(!1),I=g.useRef(!1);g.useEffect(()=>{if(j)return pu(j)},[j]),hu();const A=g.useCallback(J=>{const[K,...W]=T().map(U=>U.ref.current),[Y]=W.slice(-1),re=document.activeElement;for(const U of J)if(U===re||(U==null||U.scrollIntoView({block:"nearest"}),U===K&&_&&(_.scrollTop=0),U===Y&&_&&(_.scrollTop=_.scrollHeight),U==null||U.focus(),document.activeElement!==re))return},[T,_]),R=g.useCallback(()=>A([O,j]),[A,O,j]);g.useEffect(()=>{P&&R()},[P,R]);const{onOpenChange:L,triggerPointerDownPosRef:D}=w;g.useEffect(()=>{if(j){let J={x:0,y:0};const K=Y=>{var re,U;J={x:Math.abs(Math.round(Y.pageX)-(((re=D.current)==null?void 0:re.x)??0)),y:Math.abs(Math.round(Y.pageY)-(((U=D.current)==null?void 0:U.y)??0))}},W=Y=>{J.x<=10&&J.y<=10?Y.preventDefault():j.contains(Y.target)||L(!1),document.removeEventListener("pointermove",K),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",K),document.addEventListener("pointerup",W,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",W,{capture:!0})}}},[j,L,D]),g.useEffect(()=>{const J=()=>L(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[L]);const[B,F]=PF(J=>{const K=T().filter(re=>!re.disabled),W=K.find(re=>re.ref.current===document.activeElement),Y=AF(K,J,W);Y&&setTimeout(()=>Y.ref.current.focus())}),$=g.useCallback((J,K,W)=>{const Y=!I.current&&!W;(w.value!==void 0&&w.value===K||Y)&&(M(J),Y&&(I.current=!0))},[w.value]),z=g.useCallback(()=>j==null?void 0:j.focus(),[j]),X=g.useCallback((J,K,W)=>{const Y=!I.current&&!W;(w.value!==void 0&&w.value===K||Y)&&k(J)},[w.value]),G=r==="popper"?TS:mF,q=G===TS?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v}:{};return h.jsx(pF,{scope:n,content:j,viewport:_,onViewportChange:S,itemRefCallback:$,selectedItem:O,onItemLeave:z,itemTextRefCallback:X,focusSelectedItem:R,selectedItemText:C,position:r,isPositioned:P,searchRef:B,children:h.jsx(Xp,{as:ni,allowPinchZoom:!0,children:h.jsx(Up,{asChild:!0,trapped:w.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:ge(a,J=>{var K;(K=w.trigger)==null||K.focus({preventScroll:!0}),J.preventDefault()}),children:h.jsx(xv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(G,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:J=>J.preventDefault(),...b,...q,onPlaced:()=>N(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,J=>{const K=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!K&&J.key.length===1&&F(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let W=T().filter(Y=>!Y.disabled).map(Y=>Y.ref.current);if(["ArrowUp","End"].includes(J.key)&&(W=W.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const Y=J.target,re=W.indexOf(Y);W=W.slice(re+1)}setTimeout(()=>A(W)),J.preventDefault()}})})})})})})});hF.displayName=T0e;var I0e="SelectItemAlignedPosition",mF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=Ei(bs,n),i=Oi(bs,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=jt(t,E=>u(E)),f=by(n),p=g.useRef(!1),m=g.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,j=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&y&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),M=o.valueNode.getBoundingClientRect(),C=b.getBoundingClientRect();if(o.dir!=="rtl"){const Y=C.left-O.left,re=M.left-Y,U=E.left-re,ce=E.width+U,ae=Math.max(ce,O.width),ue=window.innerWidth-xa,je=v0(re,[xa,Math.max(xa,ue-ae)]);s.style.minWidth=ce+"px",s.style.left=je+"px"}else{const Y=O.right-C.right,re=window.innerWidth-M.right-Y,U=window.innerWidth-E.right-re,ce=E.width+U,ae=Math.max(ce,O.width),ue=window.innerWidth-xa,je=v0(re,[xa,Math.max(xa,ue-ae)]);s.style.minWidth=ce+"px",s.style.right=je+"px"}const k=f(),T=window.innerHeight-xa*2,P=y.scrollHeight,N=window.getComputedStyle(l),I=parseInt(N.borderTopWidth,10),A=parseInt(N.paddingTop,10),R=parseInt(N.borderBottomWidth,10),L=parseInt(N.paddingBottom,10),D=I+A+P+L+R,B=Math.min(v.offsetHeight*5,D),F=window.getComputedStyle(y),$=parseInt(F.paddingTop,10),z=parseInt(F.paddingBottom,10),X=E.top+E.height/2-xa,G=T-X,q=v.offsetHeight/2,J=v.offsetTop+q,K=I+A+J,W=D-K;if(K<=X){const Y=k.length>0&&v===k[k.length-1].ref.current;s.style.bottom="0px";const re=l.clientHeight-y.offsetTop-y.offsetHeight,U=Math.max(G,q+(Y?z:0)+re+R),ce=K+U;s.style.height=ce+"px"}else{const Y=k.length>0&&v===k[0].ref.current;s.style.top="0px";const re=Math.max(X,I+y.offsetTop+(Y?$:0)+q)+W;s.style.height=re+"px",y.scrollTop=K-X+y.offsetTop}s.style.margin=`${xa}px 0`,s.style.minHeight=B+"px",s.style.maxHeight=T+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,o.trigger,o.valueNode,s,l,y,v,b,o.dir,r]);ln(()=>j(),[j]);const[x,_]=g.useState();ln(()=>{l&&_(window.getComputedStyle(l).zIndex)},[l]);const S=g.useCallback(E=>{E&&m.current===!0&&(j(),w==null||w(),m.current=!1)},[j,w]);return h.jsx(D0e,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:p,onScrollButtonChange:S,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});mF.displayName=I0e;var R0e="SelectPopperPosition",TS=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=xa,...o}=e,i=wy(n);return h.jsx(Mb,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});TS.displayName=R0e;var[D0e,IS]=rl(bs,{}),RS="SelectViewport",yF=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=Oi(RS,n),i=IS(RS,n),s=jt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(vy.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&d){const p=Math.abs(c.current-u.scrollTop);if(p>0){const m=window.innerHeight-xa*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(y,v);if(b<m){const w=b+p,j=Math.min(m,w),x=w-j;d.style.height=j+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});yF.displayName=RS;var gF="SelectGroup",[L0e,$0e]=rl(gF),F0e=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Rt();return h.jsx(L0e,{scope:n,id:a,children:h.jsx(Ae.div,{role:"group","aria-labelledby":a,...r,ref:t})})});F0e.displayName=gF;var vF="SelectLabel",bF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=$0e(vF,n);return h.jsx(Ae.div,{id:a.id,...r,ref:t})});bF.displayName=vF;var xy="SelectItem",[B0e,wF]=rl(xy),xF=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=Ei(xy,n),c=Oi(xy,n),l=s.value===r,[u,d]=g.useState(o??""),[f,p]=g.useState(!1),m=jt(t,w=>{var j;return(j=c.itemRefCallback)==null?void 0:j.call(c,w,r,a)}),y=Rt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(B0e,{scope:n,value:r,disabled:a,textId:y,isSelected:l,onItemTextChange:g.useCallback(w=>{d(j=>j||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(vy.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Ae.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:m,onFocus:ge(i.onFocus,()=>p(!0)),onBlur:ge(i.onBlur,()=>p(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var j;v.current=w.pointerType,a?(j=c.onItemLeave)==null||j.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var j;w.currentTarget===document.activeElement&&((j=c.onItemLeave)==null||j.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var j;((j=c.searchRef)==null?void 0:j.current)!==""&&w.key===" "||(O0e.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});xF.displayName=xy;var of="SelectItemText",_F=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=Ei(of,n),s=Oi(of,n),c=wF(of,n),l=k0e(of,n),[u,d]=g.useState(null),f=jt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),p=u==null?void 0:u.textContent,m=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=l;return ln(()=>(y(m),()=>v(m)),[y,v,m]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Ql.createPortal(o.children,i.valueNode):null]})});_F.displayName=of;var jF="SelectItemIndicator",SF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return wF(jF,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:t}):null});SF.displayName=jF;var DS="SelectScrollUpButton",EF=g.forwardRef((e,t)=>{const n=Oi(DS,e.__scopeSelect),r=IS(DS,e.__scopeSelect),[a,o]=g.useState(!1),i=jt(t,r.onScrollButtonChange);return ln(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(CF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});EF.displayName=DS;var LS="SelectScrollDownButton",OF=g.forwardRef((e,t)=>{const n=Oi(LS,e.__scopeSelect),r=IS(LS,e.__scopeSelect),[a,o]=g.useState(!1),i=jt(t,r.onScrollButtonChange);return ln(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(CF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});OF.displayName=LS;var CF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=Oi("SelectScrollButton",n),i=g.useRef(null),s=by(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),ln(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),z0e="SelectSeparator",NF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:t})});NF.displayName=z0e;var $S="SelectArrow",U0e=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=wy(n),o=Ei($S,n),i=Oi($S,n);return o.open&&i.position==="popper"?h.jsx(kb,{...a,...r,ref:t}):null});U0e.displayName=$S;function MF(e){return e===""||e===void 0}var kF=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=jt(t,a),i=aF(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(WDe,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});kF.displayName="BubbleSelect";function PF(e){const t=dr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function AF(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=V0e(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function V0e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var q0e=oF,TF=sF,W0e=lF,H0e=uF,K0e=dF,IF=fF,Z0e=yF,RF=bF,DF=xF,G0e=_F,X0e=SF,LF=EF,$F=OF,FF=NF;const Lo=q0e,$o=W0e,Ga=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(TF,{ref:r,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(H0e,{asChild:!0,children:h.jsx(fe,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ga.displayName=TF.displayName;const BF=g.forwardRef(({className:e,...t},n)=>h.jsx(LF,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(fe,{name:"chevron-up",className:"h-4 w-4"})}));BF.displayName=LF.displayName;const zF=g.forwardRef(({className:e,...t},n)=>h.jsx($F,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(fe,{name:"chevron-down",className:"h-4 w-4"})}));zF.displayName=$F.displayName;const Xa=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(K0e,{children:h.jsxs(IF,{ref:a,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(BF,{}),h.jsx(Z0e,{className:Z("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(zF,{})]})}));Xa.displayName=IF.displayName;const J0e=g.forwardRef(({className:e,...t},n)=>h.jsx(RF,{ref:n,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));J0e.displayName=RF.displayName;const ar=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(DF,{ref:r,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(X0e,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),h.jsx(G0e,{children:t})]}));ar.displayName=DF.displayName;const Y0e=g.forwardRef(({className:e,...t},n)=>h.jsx(FF,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));Y0e.displayName=FF.displayName;var Fo="Accordion",Q0e=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[FS,ebe,tbe]=hp(Fo),[_y,y3e]=ur(Fo,[tbe,DP]),BS=DP(),UF=H.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(FS.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(obe,{...o,ref:t}):h.jsx(abe,{...a,ref:t})})});UF.displayName=Fo;var[VF,nbe]=_y(Fo),[qF,rbe]=_y(Fo,{collapsible:!1}),abe=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Pn({prop:n,defaultProp:r,onChange:a});return h.jsx(VF,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:H.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(qF,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(WF,{...i,ref:t})})})}),obe=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Pn({prop:n,defaultProp:r,onChange:a}),c=H.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=H.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(VF,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(qF,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(WF,{...o,ref:t})})})}),[ibe,jy]=_y(Fo),WF=H.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=H.useRef(null),c=jt(s,t),l=ebe(n),u=ri(a)==="ltr",d=ge(e.onKeyDown,f=>{var E;if(!Q0e.includes(f.key))return;const p=f.target,m=l().filter(O=>{var M;return!((M=O.ref.current)!=null&&M.disabled)}),y=m.findIndex(O=>O.ref.current===p),v=m.length;if(y===-1)return;f.preventDefault();let b=y;const w=0,j=v-1,x=()=>{b=y+1,b>j&&(b=w)},_=()=>{b=y-1,b<w&&(b=j)};switch(f.key){case"Home":b=w;break;case"End":b=j;break;case"ArrowRight":o==="horizontal"&&(u?x():_());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?_():x());break;case"ArrowUp":o==="vertical"&&_();break}const S=b%v;(E=m[S].ref.current)==null||E.focus()});return h.jsx(ibe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(FS.Slot,{scope:n,children:h.jsx(Ae.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Sy="AccordionItem",[sbe,zS]=_y(Sy),HF=H.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=jy(Sy,n),i=nbe(Sy,n),s=BS(n),c=Rt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(sbe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(FP,{"data-orientation":o.orientation,"data-state":YF(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});HF.displayName=Sy;var KF="AccordionHeader",ZF=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=jy(Fo,n),o=zS(KF,n);return h.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":YF(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});ZF.displayName=KF;var US="AccordionTrigger",GF=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=jy(Fo,n),o=zS(US,n),i=rbe(US,n),s=BS(n);return h.jsx(FS.ItemSlot,{scope:n,children:h.jsx(wY,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});GF.displayName=US;var XF="AccordionContent",JF=H.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=jy(Fo,n),o=zS(XF,n),i=BS(n);return h.jsx(xY,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});JF.displayName=XF;function YF(e){return e?"open":"closed"}let QF;wk=UF,xk=HF,QF=ZF,b0=GF,w0=JF;const eB=wk,VS=g.forwardRef(({className:e,...t},n)=>h.jsx(xk,{ref:n,className:Z("border-b",e),...t}));VS.displayName="AccordionItem";const qS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(QF,{className:"flex",children:h.jsxs(b0,{ref:r,className:Z("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(fe,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));qS.displayName=b0.displayName;const WS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(w0,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:Z("pb-4 pt-0",e),children:t})}));WS.displayName=w0.displayName;const cbe=[1,2,3,4,5,6,7,8,9,10],tB=g.memo(e=>{const{t}=ke("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,f=async()=>{o(await l(n,+i)),r("")},p=async m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),f())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(Lo,{value:`${i}`,onValueChange:m=>s(m),children:[h.jsx(Ga,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx($o,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(Xa,{children:cbe.map(m=>h.jsx(ar,{value:`${m}`,children:m},`${m}`))})]}),h.jsx(Oo,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:Z("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:p,onChange:m=>{r(m.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:f,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(fe,{name:c?"loader-circle":"arrow-right",className:Z("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(eB,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([m,y],v)=>h.jsxs(VS,{value:`${v}`,children:[h.jsxs(qS,{children:[`[${y.toFixed(2)}] ${m.pageContent}`.substring(0,32),"..."]}),h.jsx(WS,{children:m.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(tt,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(tt,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),nB=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=ke("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(qe,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(Gt,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(qe,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(Oo,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Xn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),HS=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:Z("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function lbe({accept:e,maxSize:t}){const{t:n}=ke("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=f=>{var m;const p=(m=f.target.files)==null?void 0:m[0];d(p)},d=f=>{if(i(""),f){if(t&&f.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(f.size/1024/1024).toFixed(2)}));return}const p=e==null?void 0:e.split(",").map(m=>m.replace(".","").trim());if(e&&!f.type.match(e.replace("/*",""))&&!(p!=null&&p.some(m=>f.type.includes(m)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(f.size),a(f.name),f}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function ube({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=nn(),{t:i}=ke("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:f,validateAndSetFile:p,fileSize:m}=lbe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{f&&o({title:f,variant:"destructive"})},[f,o]);function y(x){const _=p(x);_&&t(_)}function v(x){x.preventDefault(),c(!1);const _=x.dataTransfer.files[0];_&&y(_)}function b(x){var S;const _=(S=x.target.files)==null?void 0:S[0];_&&y(_)}function w(){d(),t(void 0)}const j=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(fe,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(fe,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:Z("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var _;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(_=u.current)==null||_.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[j,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:m?`(${(m/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(fe,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(HS,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(fe,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function rB({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=ke("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(ube,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(Xn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const Ey=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:Z("w-full caption-bottom text-sm",e),...t})}));Ey.displayName="Table";const Oy=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:Z("[&_tr]:border-b",e),...t}));Oy.displayName="TableHeader";const Cy=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:Z("[&_tr:last-child]:border-0",e),...t}));Cy.displayName="TableBody";const dbe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:Z("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));dbe.displayName="TableFooter";const ws=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ws.displayName="TableRow";const al=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:Z("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));al.displayName="TableHead";const ol=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:Z("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));ol.displayName="TableCell";const fbe=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:Z("mt-4 text-sm text-muted-foreground",e),...t}));fbe.displayName="TableCaption";const aB=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:Z("mx-auto flex w-full justify-center",e),...t});aB.displayName="Pagination";const oB=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:Z("flex flex-row items-center gap-1",e),...t}));oB.displayName="PaginationContent";const il=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:Z("",e),...t}));il.displayName="PaginationItem";const Ny=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:Z(Eu({variant:t?"outline":"ghost",size:n}),e),...r});Ny.displayName="PaginationLink";const iB=({className:e,...t})=>{const{t:n}=ke("atoms");return h.jsxs(Ny,{"aria-label":"Go to previous page",size:"default",className:Z("gap-1 pl-2.5",e),...t,children:[h.jsx(fe,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};iB.displayName="PaginationPrevious";const sB=({className:e,...t})=>{const{t:n}=ke("atoms");return h.jsxs(Ny,{"aria-label":"Go to next page",size:"default",className:Z("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(fe,{name:"chevron-right",className:"h-4 w-4"})]})};sB.displayName="PaginationNext";const KS=({className:e,...t})=>{const{t:n}=ke("atoms");return h.jsxs("span",{"aria-hidden":!0,className:Z("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(fe,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};KS.displayName="PaginationEllipsis";const cB=so(({title:e,content:t})=>{const n=tn();return h.jsx(fi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(vo,{className:"sm:max-w-2xl",children:[h.jsx(bo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(wo,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),My=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=tn(cB);g.useEffect(()=>{c(p=>({...p,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let p=!1,m=!1;return h.jsx(aB,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(oB,{children:[s.page>1?h.jsx(il,{onClick:()=>c(y=>({...y,page:y.page-1})),children:h.jsx(iB,{})}):null,Array.from({length:s.maxPage},(y,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&m?null:!w&&b>s.page+o?(m=!0,h.jsx(il,{children:h.jsx(KS,{})},v)):!w&&b<s.page-o&&p?null:!w&&b<s.page-o?(p=!0,h.jsx(il,{children:h.jsx(KS,{})},v)):h.jsx(il,{onClick:()=>c(j=>({...j,page:b})),children:h.jsx(Ny,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(il,{onClick:()=>c(y=>({...y,page:y.page+1})),children:h.jsx(sB,{})}):null]})})},[s.maxPage,s.page,o]),f=(p,m)=>{if(!p)return;const y=Array.isArray(p)?p:n.map(v=>p[v]);return h.jsxs(ws,{children:[h.jsx(ol,{children:h.jsx("div",{className:"font-bold",children:m+1})}),y.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),j=n[b],x=(r==null?void 0:r[j])||i,_=w.length>x;return h.jsx(ol,{className:"p-4",children:h.jsxs("div",{onClick:_?()=>l.show({title:j,content:w}):void 0,className:"flex gap-4",children:[_?`${w.substring(0,x)}...`:w,_?h.jsx(fe,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${m}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(Ey,{className:"w-full",children:[h.jsx(Oy,{children:h.jsxs(ws,{children:[h.jsx(al,{},"index"),n?n.map(p=>h.jsx(al,{children:h.jsx("div",{className:"font-bold",children:p})},p)):void 0]})}),h.jsx(Cy,{children:u!=null&&u.length?u==null?void 0:u.map(f):void 0})]}),d]})});var ZS,lB;M0=function(){if(lB)return ZS;lB=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return ZS=e,ZS};var GS,uB;qs=function(){if(uB)return GS;uB=1;var e=su(),t=Wi(),n=Ih(),r=qr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return GS=a,GS};var XS,dB;function pbe(){if(dB)return XS;dB=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return XS=t,XS}var JS,fB;function hbe(){if(fB)return JS;fB=1;var e=pbe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return JS=n,JS}var YS,pB;function hB(){if(pB)return YS;pB=1;var e=hbe(),t=qr(),n=yc(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return YS=c,YS}var QS,mB;function yB(){if(mB)return QS;mB=1;var e=hB(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return QS=r,QS}var eE,gB;function vB(){if(gB)return eE;gB=1;var e=yB();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return eE=t,eE}var tE,bB;function mbe(){if(bB)return tE;bB=1;var e=M0(),t=qs(),n=vB(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,f=Array(r(l/s));u<l;)f[d++]=e(i,u,u+=s);return f}return tE=o,tE}var ybe=mbe();const nE=st(ybe),gbe=()=>{const[e,t]=g.useState(!1),{t:n}=ke("flows"),{toast:r}=nn(),a=Vs(c=>c.index),o=Vs(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Ur.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new vp({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Ur.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=nE(d,10);let p=0;for(const m of f)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:m.length,handled:p,total:d.length}),await a({databaseId:l.vectorDatabase.id},m),p+=m.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},vbe=so(({retriverInfo:e})=>{var y,v,b;const{t}=ke("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=gbe(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=tn(),u=g.useMemo(()=>{var x,_;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],j=Cv((_=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:_.raw);return{headers:w,rows:j.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(y=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:y.raw]),d=g.useCallback(async(...w)=>{const[j,x]=w;await a(j,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),f=g.useCallback(async(w,j)=>{const x=w.trim(),_=await r(x,{k:j,vectorDatabase:e.vectorDatabaseEntity});if(_!=null&&_.length)return _},[e.vectorDatabaseEntity,r]),p=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const j=new FileReader;j.onload=async x=>{var S;const _=(S=x.target)==null?void 0:S.result;await d({content:_},{vectorDatabase:e.vectorDatabaseEntity})},j.readAsText(w)}else if(w.type.endsWith("pdf")){const j=new Blob([w],{type:"application/pdf"}),x=await new q9(j,{pdfjs:async()=>{const _=await Ht(()=>import("./pdf.min-CNRnjYAA.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([11,1,2,3,4]));return await Ht(()=>import("./pdf.worker.min-TUvxb0n0.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([12,1,2,3,4])),_.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),_},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:_=>{c((_.handled+_.handling)/_.total)}})}},[d,e.vectorDatabaseEntity]),m=g.useMemo(()=>{switch(o){case"search":return h.jsx(wa,{value:"search",children:h.jsx(tB,{loading:n,onSimilaritySearch:f})});case"new":return h.jsx(wa,{className:"min-w-80",value:"new",children:h.jsx(nB,{loading:n,onCreateData:d})});case"file":return h.jsx(wa,{value:"file",children:h.jsx(rB,{loading:n,progress:s,onFileSubmit:p,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(wa,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(My,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,p,f,n,o,s,u]);return h.jsx(fi,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(vo,{className:"max-w-3xl",children:[h.jsx(bo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(wo,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(AS,{value:o,onValueChange:i,defaultValue:"search",className:Z("w-full h-full mt-4"),children:[h.jsxs(gy,{className:Z("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===Ur.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ba,{value:"search",children:t("chat.search")}),h.jsx(ba,{value:"new",children:t("chat.text")}),h.jsx(ba,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===Ur.DatabaseNode?h.jsx(ba,{value:"view",children:t("chat.view")}):void 0]}),m]})})})]})})}),bbe=e=>{const[t,n]=g.useState([]),r=et(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await de("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Sm({where:{session_id:r.id,id:qa(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var f;const d=(f=c[u.source_type])==null?void 0:f.find(p=>p.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await de("FlowNode").delete(i.id),await de("JSONData").delete(i.source_id);const s=await de("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>de("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};function wbe({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,setLLMInfo:c,changeLLMOptions:l,...u}){var O,M;const{t:d}=ke("applications"),[f,p]=g.useState(!1),m=tn(n0e),y=tn(vbe),{chatList:v,getChatList:b,deleteChat:w}=bbe(a),j=g.useCallback(async()=>{try{p(!0),await(i==null?void 0:i()),b()}finally{p(!1)}},[b,i]),x=g.useCallback(()=>{y.show({retriverInfo:r[0]})},[r,y]),_=g.useCallback(async(C,k)=>{C.stopPropagation(),m.show({onDelete:()=>w(k)})},[w,m]),S=g.useCallback(async C=>{t!=null&&t.llm&&(await l(t==null?void 0:t.llm,C),c(k=>k?{...k,llm:{...k.llm,options:C}}:void 0))},[l,t==null?void 0:t.llm,c]),E=g.useMemo(()=>{var C;return h.jsx(NS,{className:Z("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(C=e==null?void 0:e.schema_items)!=null&&C.length?`\`\`\`javascript
${z9((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})},[e==null?void 0:e.schema_items]);return h.jsxs(Db,{variant:"sidebar",side:"right",collapsible:"none",...u,children:[h.jsx("div",{className:"h-1"}),h.jsxs(Ru,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:d("chat.history")}),h.jsx(Xn,{loading:f,onClick:j,variant:"link",className:"mr-[-6px]",children:h.jsx(fe,{name:"circle-plus"})})]}),h.jsxs($b,{children:[h.jsx(Iu,{className:"flex-1",children:h.jsx(lc,{children:v.map(({node:C},k)=>{var T;return h.jsx(yo,{onClick:()=>o(C),children:h.jsx(go,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(fe,{size:16,name:((T=s==null?void 0:s.node)==null?void 0:T.id)===C.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${k+1}`})]}),h.jsx(fe,{onClick:P=>_(P,C),size:16,name:"trash-2"})]})})},C.id)})})}),r!=null&&r.length?h.jsxs(en,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((C,k)=>{var T;return h.jsx("span",{children:((T=C.promptEntity)==null?void 0:T.content)||""},`${k}`)})}),h.jsx(tt,{onClick:x,className:"w-full mt-4",children:d("chat.vector_database")})]}):void 0,(O=e==null?void 0:e.schema_items)!=null&&O.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(yy,{}),children:E})}):void 0,h.jsx(V9,{llmOptions:(M=t==null?void 0:t.llm)==null?void 0:M.options,onChangeOptions:S,className:"p-2"}),h.jsx(b0e,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var rE="Avatar",[xbe,g3e]=ur(rE),[_be,wB]=xbe(rE),xB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(_be,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Ae.span,{...r,ref:t})})});xB.displayName=rE;var _B="AvatarImage",jB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=wB(_B,n),s=jbe(r,o.referrerPolicy),c=dr(l=>{a(l),i.onImageLoadingStatusChange(l)});return ln(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Ae.img,{...o,ref:t,src:r}):null});jB.displayName=_B;var SB="AvatarFallback",EB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=wB(SB,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Ae.span,{...a,ref:t}):null});EB.displayName=SB;function jbe(e,t){const[n,r]=g.useState("idle");return ln(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var OB=xB,CB=jB,NB=EB;const MB=g.forwardRef(({className:e,...t},n)=>h.jsx(OB,{ref:n,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));MB.displayName=OB.displayName;const kB=g.forwardRef(({className:e,...t},n)=>h.jsx(CB,{ref:n,className:Z("aspect-square h-full w-full",e),...t}));kB.displayName=CB.displayName;const PB=g.forwardRef(({className:e,...t},n)=>h.jsx(NB,{ref:n,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));PB.displayName=NB.displayName;const Sbe=io("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),AB=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:Z(Sbe({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));AB.displayName="ChatBubble";const Ebe=({src:e,fallback:t,className:n})=>h.jsxs(MB,{className:n,children:[h.jsx(kB,{src:e,alt:"Avatar"}),h.jsx(PB,{children:t})]}),Obe=io("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"border border-border rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),TB=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:Z(Obe({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(yy,{})}):a}));TB.displayName="ChatBubbleMessage";const Cbe=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(tt,{variant:r,size:a,className:n,onClick:t,...o,children:e}),Nbe=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:Z("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));Nbe.displayName="ChatBubbleActionWrapper";const Mbe=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],kbe=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>{const i=g.useMemo(()=>h.jsx(NS,{style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""}),[a,e.content]);return h.jsxs(AB,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(Ebe,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(TB,{children:[r&&n&&(!e.content||a)?h.jsx(yy,{}):h.jsxs(g.Suspense,{fallback:h.jsx(yy,{}),children:[e.role==="system"?h.jsx(bn,{className:"!text-sm mb-1",children:"System"}):void 0,i]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:Mbe.map((s,c)=>h.jsx(Cbe,{variant:"ghost",className:"size-5",icon:h.jsx(fe,{name:s.icon,className:"size-3"}),onClick:()=>o(s.label,e)},c))})})]})]},t)},()=>!1),Pbe=()=>({changeLLMOptions:g.useCallback(async(e,t)=>{e&&await de("LLM").update(e.id,{options:t})},[])}),Abe=g.memo(()=>{const{t:e}=ke("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},50)},[]),o=Wfe(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,setLLMInfo:f,addNewDataNode:p,selectDataNode:m,updateMessagesData:y,onThreadMessagesLoaded:v}=o,{changeLLMOptions:b}=Pbe(),{sendMessage:w}=t0e(o),{input:j,messages:x,isLoading:_,reload:S,setInput:E,handleSubmit:O,handleInputChange:M,setMessages:C}=ok({fetch:async(A,R)=>{try{r(!0);const L=JSON.parse(R==null?void 0:R.body),D=Vi(),B=L.messages[L.messages.length-1];return t.current=!0,C(F=>[...F,{id:Vi(),content:B.content,role:"user"}]),await w(B.content,L.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:F=>{F.length&&C($=>[...$,...F.map(z=>z._getType()==="system"?{id:Vi(),content:`${z.content}`,role:"system",data:{injectedMessage:!0}}:z._getType()==="human"?{id:Vi(),content:`${z.content}`,role:"user",data:{injectedMessage:!0}}:{id:Vi(),content:`${z.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:F=>{C($=>[...$,{id:D,content:F||"",role:"assistant"}])},onMessageUpdate:F=>{C($=>{const z=[...$],X=z.findIndex(G=>G.id===D);return X!==-1&&(z[X]={...z[X],content:F.nodeData.content||""}),z}),t.current&&a()}}),C(F=>(y(F),F)),r(!1),E(""),t.current&&a(),new Response}finally{r(!1)}}}),k=g.useRef(null);g.useEffect(()=>{const A=v(R=>{C(R||[]),a()});return()=>{A()}},[C,v,a]);const T=async(A,R)=>(r(!0),await O(R),!0),P=g.useCallback(async(A,R)=>{if(A==="Refresh"){r(!0);try{await S()}finally{r(!1)}}A==="Copy"&&R&&R.role==="assistant"&&navigator.clipboard.writeText(R.content),A==="Volume"&&(R!=null&&R.content)&&await $M.speak((R==null?void 0:R.content)||"")},[S]),N=g.useCallback(()=>t.current=!1,[]),I=g.useMemo(()=>x&&x.map((A,R)=>h.jsx(kbe,{message:A,index:R,isLastMessage:R===x.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},A.id||`${R}`)),[x,n,i,P]);return h.jsxs(Rb,{onClick:N,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(Lb,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(lI,{className:"!max-h-full",ref:k,children:I})}),h.jsx(y0,{className:"!max-w-2xl px-4",onSubmit:T,disabled:_||n||(c==null?void 0:c.status)!==Je.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:j,onChange:M})]})}),h.jsx(wbe,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:p,onSelectThread:m,changeLLMOptions:b,setLLMInfo:f})]})}),Tbe=()=>{const[e,t]=g.useState(),n=et(u=>u.currentSession),{t:r}=ke("flows"),{toast:a}=nn(),{stream:o}=nl(),{loadModel:i}=Em(),{modalRef:s}=Ic(kd),c=g.useCallback(async(u,d)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==Je.Loaded&&(await i(e.llm.provider,e.llm.name,f=>{t(p=>p&&{...p,progress:f.text})}),t(f=>f&&{...f,status:Je.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof u=="string"?[new zr(u)]:u,{onMessageUpdate:f=>{d==null||d(f.content)},llm:e==null?void 0:e.llm})).content}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),l=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const u=await de("FlowEdge").find({where:{target:n.main_node_id}}),d=(await de("FlowNode").find({where:{id:qa(u.map(p=>p.source))}})).find(p=>p.source_type===ie.LLM);if(!d)return;const f=await de("LLM").findOne({where:{id:d.source_id}});f&&(n.passphrase&&await Cm(n.passphrase,s.current),await i(f.provider,f.name,p=>{t(m=>m&&{...m,llm:f,progress:p.text})}),t({llm:f,status:Je.Loaded}))},[n==null?void 0:n.main_node_id,n==null?void 0:n.passphrase,i,s]);return g.useEffect(()=>{n!=null&&n.main_node_id&&l()},[n==null?void 0:n.main_node_id,l]),{mainLLMInfo:e,createMessage:c}},Ibe=()=>{const e=et(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await de("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&de("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},Rbe=g.lazy(()=>Ht(()=>import("./index-DHwbNkRp.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Dbe=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=Ibe(),{mainLLMInfo:n,createMessage:r}=Tbe(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Au,{children:h.jsx(Da,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===Je.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(Pr,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(La,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===Je.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(fe,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Jr,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(ru,{simple:!0}),children:e?h.jsx(Rbe,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(ru,{simple:!0})})]})}),Lbe=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=et(p=>p.currentSession),{t:o}=ke("flows"),{toast:i}=nn(),{loadModel:s}=Em(),{stream:c}=nl(),{modalRef:l}=Ic(kd),u=g.useCallback(async(p,m,y)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==Je.Loaded&&(await s(n.llm.provider,n.llm.name,v=>{r(b=>b&&{...b,progress:v.text})}),r(v=>v&&{...v,status:Je.Loaded,progress:""}));try{const v=m.map(w=>w.role==="system"?new Ov(w.content):w.role==="assistant"?new ka(w.content):new zr(w.content)),{content:b}=await c(n.llm.provider,[...v,new zr(p)],{onMessageUpdate:({content:w})=>{y==null||y(w)},llm:n.llm});return y==null||y(b),b}catch(v){if(v instanceof Error&&v.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),d=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const p=await de("FlowEdge").find({where:{target:a.main_node_id}}),m=(await de("FlowNode").find({where:{id:qa(p.map(v=>v.source))}})).find(v=>v.source_type===ie.LLM);if(!m)return;const y=await de("LLM").findOne({where:{id:m.source_id}});if(!y)return;a.passphrase&&await Cm(a.passphrase,l.current),await s(y.provider,y.name,v=>{r(b=>b&&{...b,llm:y,progress:v.text})}),r({llm:y,status:Je.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,a==null?void 0:a.passphrase,s,l]),f=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,p=>{r(m=>m&&{...m,progress:p.text})}),r(p=>p&&{...p,status:Je.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&d()},[a==null?void 0:a.main_node_id,d]),{loading:e,mainLLMInfo:n,createMessage:u,loadCurrentModel:f}};_k=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Vi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=_k(a.directory,i)),n.push(c)}return n},x0=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},g0=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},_0=function(e,t){return qG(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const $be=()=>{const e=et(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await de("FlowNode").update(i,{raw:g0(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=_0(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await de("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?x0(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},Fbe=g.lazy(()=>Ht(()=>import("./index-Bxl28ONd.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Bbe=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=Lbe(),{fileSystemTree:a,updateCodeContainerFile:o}=$be(),i=g.useCallback((d,f,p)=>r(d,f,p),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Au,{children:h.jsx(Da,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===Je.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(Pr,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(La,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===Je.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(fe,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==Je.Loaded?h.jsx(fe,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Jr,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(ru,{simple:!0}),children:a!==void 0?h.jsx(Fbe,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function zbe(){var t,n;const e=et(r=>r.currentSession);if(!e)return h.jsx(ru,{simple:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(Abe,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(Dbe,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(Bbe,{})}var ky="Menubar",[aE,Ube,Vbe]=hp(ky),[IB,v3e]=ur(ky,[Vbe,lo]),Kn=yh(),RB=lo(),[qbe,oE]=IB(ky),DB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=ri(s),u=RB(n),[d="",f]=Pn({prop:r,onChange:a,defaultProp:o}),[p,m]=g.useState(null);return h.jsx(qbe,{scope:n,value:d,onMenuOpen:g.useCallback(y=>{f(y),m(y)},[f]),onMenuClose:g.useCallback(()=>f(""),[f]),onMenuToggle:g.useCallback(y=>{f(v=>v?"":y),m(y)},[f]),dir:l,loop:i,children:h.jsx(aE.Provider,{scope:n,children:h.jsx(aE.Slot,{scope:n,children:h.jsx(uu,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:p,onCurrentTabStopIdChange:m,children:h.jsx(Ae.div,{role:"menubar",...c,ref:t})})})})})});DB.displayName=ky;var iE="MenubarMenu",[Wbe,LB]=IB(iE),$B=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Rt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=oE(iE,t),s=Kn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(Wbe,{scope:t,value:o,triggerId:Rt(),triggerRef:c,contentId:Rt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(NT,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};$B.displayName=iE;var sE="MenubarTrigger",FB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=RB(n),i=Kn(n),s=oE(sE,n),c=LB(sE,n),l=g.useRef(null),u=jt(t,l,c.triggerRef),[d,f]=g.useState(!1),p=s.value===c.value;return h.jsx(aE.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(du,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(MT,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":p,"aria-controls":p?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":p?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,m=>{!r&&m.button===0&&m.ctrlKey===!1&&(s.onMenuOpen(c.value),p||m.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var m;s.value&&!p&&(s.onMenuOpen(c.value),(m=l.current)==null||m.focus())}),onKeyDown:ge(e.onKeyDown,m=>{r||(["Enter"," "].includes(m.key)&&s.onMenuToggle(c.value),m.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(m.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,m.preventDefault()))}),onFocus:ge(e.onFocus,()=>f(!0)),onBlur:ge(e.onBlur,()=>f(!1))})})})})});FB.displayName=sE;var Hbe="MenubarPortal",BB=e=>{const{__scopeMenubar:t,...n}=e,r=Kn(t);return h.jsx(kT,{...r,...n})};BB.displayName=Hbe;var cE="MenubarContent",zB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Kn(n),i=oE(cE,n),s=LB(cE,n),c=Ube(n),l=g.useRef(!1);return h.jsx(PT,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(f=>{var p;return(p=f.ref.current)==null?void 0:p.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,f=d.hasAttribute("data-radix-menubar-subtrigger"),p=d.closest("[data-radix-menubar-content]")!==u.currentTarget,m=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!m&&f||p&&m)return;let y=c().filter(w=>!w.disabled).map(w=>w.value);m&&y.reverse();const v=y.indexOf(s.value);y=i.loop?swe(y,v+1):y.slice(v+1);const[b]=y;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});zB.displayName=cE;var Kbe="MenubarGroup",Zbe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(AT,{...a,...r,ref:t})});Zbe.displayName=Kbe;var Gbe="MenubarLabel",UB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(TT,{...a,...r,ref:t})});UB.displayName=Gbe;var Xbe="MenubarItem",VB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(IT,{...a,...r,ref:t})});VB.displayName=Xbe;var Jbe="MenubarCheckboxItem",qB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(RT,{...a,...r,ref:t})});qB.displayName=Jbe;var Ybe="MenubarRadioGroup",Qbe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(DT,{...a,...r,ref:t})});Qbe.displayName=Ybe;var ewe="MenubarRadioItem",WB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(LT,{...a,...r,ref:t})});WB.displayName=ewe;var twe="MenubarItemIndicator",HB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx($T,{...a,...r,ref:t})});HB.displayName=twe;var nwe="MenubarSeparator",KB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(FT,{...a,...r,ref:t})});KB.displayName=nwe;var rwe="MenubarArrow",awe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(BT,{...a,...r,ref:t})});awe.displayName=rwe;var owe="MenubarSubTrigger",ZB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(zT,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});ZB.displayName=owe;var iwe="MenubarSubContent",GB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Kn(n);return h.jsx(UT,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});GB.displayName=iwe;function swe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var XB=DB,cwe=$B,JB=FB,lwe=BB,YB=zB,QB=UB,e7=VB,t7=qB,n7=WB,r7=HB,a7=KB,o7=ZB,i7=GB;const lE=cwe,s7=g.forwardRef(({className:e,...t},n)=>h.jsx(XB,{ref:n,className:Z("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));s7.displayName=XB.displayName;const uE=g.forwardRef(({className:e,...t},n)=>h.jsx(JB,{ref:n,className:Z("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));uE.displayName=JB.displayName;const uwe=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(o7,{ref:a,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(fe,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));uwe.displayName=o7.displayName;const dwe=g.forwardRef(({className:e,...t},n)=>h.jsx(i7,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));dwe.displayName=i7.displayName;const c7=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(lwe,{children:h.jsx(YB,{ref:o,align:t,alignOffset:n,sideOffset:r,className:Z("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));c7.displayName=YB.displayName;const l7=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(e7,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));l7.displayName=e7.displayName;const fwe=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(t7,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(r7,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),t]}));fwe.displayName=t7.displayName;const pwe=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(n7,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(r7,{children:h.jsx(fe,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));pwe.displayName=n7.displayName;const hwe=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(QB,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));hwe.displayName=QB.displayName;const mwe=g.forwardRef(({className:e,...t},n)=>h.jsx(a7,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));mwe.displayName=a7.displayName;let u7;De=HDe()(KDe(ZDe((e,t)=>({...n6,...Cfe(e,t)})))),u7=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.pushSyncNodeQueue),a=De(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await de("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):de("LLM").save({name:`${s.name}`,status:s.provider===nt.WebLLM?Je.Started:Je.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||gu.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,f;return await a({source_id:l.id,source_type:"LLM",node_type:ie.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((f=i.measured)==null?void 0:f.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function Ci(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function d7(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function f7(...e){return t=>{let n=!1;const r=e.map(a=>{const o=d7(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():d7(e[a],null)}}}}function Ni(...e){return g.useCallback(f7(...e),e)}var dE=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(gwe);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(fE,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(fE,{...r,ref:t,children:n})});dE.displayName="Slot";var fE=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=bwe(n);return g.cloneElement(n,{...vwe(r,n.props),ref:t?f7(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});fE.displayName="SlotClone";var ywe=({children:e})=>h.jsx(h.Fragment,{children:e});function gwe(e){return g.isValidElement(e)&&e.type===ywe}function vwe(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function bwe(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var wwe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Bo=wwe.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?dE:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function xwe(e,t){e&&Ql.flushSync(()=>e.dispatchEvent(t))}var _we="DismissableLayer",pE="dismissableLayer.update",jwe="dismissableLayer.pointerDownOutside",Swe="dismissableLayer.focusOutside",p7,h7=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),m7=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(h7),[u,d]=g.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),m=Ni(t,E=>d(E)),y=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(v),w=u?y.indexOf(u):-1,j=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,_=Cwe(E=>{const O=E.target,M=[...l.branches].some(C=>C.contains(O));!x||M||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f),S=Nwe(E=>{const O=E.target;[...l.branches].some(M=>M.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f);return GDe(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(p7=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),y7(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=p7)}},[u,f,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),y7())},[u,l]),g.useEffect(()=>{const E=()=>p({});return document.addEventListener(pE,E),()=>document.removeEventListener(pE,E)},[]),h.jsx(Bo.div,{...c,ref:m,style:{pointerEvents:j?x?"auto":"none":void 0,...e.style},onFocusCapture:Ci(e.onFocusCapture,S.onFocusCapture),onBlurCapture:Ci(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:Ci(e.onPointerDownCapture,_.onPointerDownCapture)})});m7.displayName=_we;var Ewe="DismissableLayerBranch",Owe=g.forwardRef((e,t)=>{const n=g.useContext(h7),r=g.useRef(null),a=Ni(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Bo.div,{...e,ref:a})});Owe.displayName=Ewe;function Cwe(e,t=globalThis==null?void 0:globalThis.document){const n=dr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){g7(jwe,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Nwe(e,t=globalThis==null?void 0:globalThis.document){const n=dr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&g7(Swe,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function y7(){const e=new CustomEvent(pE);document.dispatchEvent(e)}function g7(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?xwe(a,o):a.dispatchEvent(o)}var hE="focusScope.autoFocusOnMount",mE="focusScope.autoFocusOnUnmount",v7={bubbles:!1,cancelable:!0},Mwe="FocusScope",b7=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=dr(a),u=dr(o),d=g.useRef(null),f=Ni(t,y=>c(y)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(j){if(p.paused||!s)return;const x=j.target;s.contains(x)?d.current=x:Mi(d.current,{select:!0})},v=function(j){if(p.paused||!s)return;const x=j.relatedTarget;x!==null&&(s.contains(x)||Mi(d.current,{select:!0}))},b=function(j){if(document.activeElement===document.body)for(const x of j)x.removedNodes.length>0&&Mi(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){_7.add(p);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(hE,v7);s.addEventListener(hE,l),s.dispatchEvent(v),v.defaultPrevented||(kwe(Rwe(w7(s)),{select:!0}),document.activeElement===y&&Mi(s))}return()=>{s.removeEventListener(hE,l),setTimeout(()=>{const v=new CustomEvent(mE,v7);s.addEventListener(mE,u),s.dispatchEvent(v),v.defaultPrevented||Mi(y??document.body,{select:!0}),s.removeEventListener(mE,u),_7.remove(p)},0)}}},[s,l,u,p]);const m=g.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[j,x]=Pwe(w);j&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&Mi(j,{select:!0})):y.shiftKey&&b===j&&(y.preventDefault(),n&&Mi(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,p.paused]);return h.jsx(Bo.div,{tabIndex:-1,...i,ref:f,onKeyDown:m})});b7.displayName=Mwe;function kwe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Mi(r,{select:t}),document.activeElement!==n)return}function Pwe(e){const t=w7(e),n=x7(t,e),r=x7(t.reverse(),e);return[n,r]}function w7(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function x7(e,t){for(const n of e)if(!Awe(n,{upTo:t}))return n}function Awe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Twe(e){return e instanceof HTMLInputElement&&"select"in e}function Mi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Twe(e)&&t&&e.select()}}var _7=Iwe();function Iwe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=j7(e,t),e.unshift(t)},remove(t){var n;e=j7(e,t),(n=e[0])==null||n.resume()}}}function j7(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Rwe(e){return e.filter(t=>t.tagName!=="A")}var Dwe="Arrow",S7=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Bo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});S7.displayName=Dwe;var Lwe=S7,yE="Popper",[E7,O7]=ur(yE),[$we,C7]=E7(yE),N7=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx($we,{scope:t,anchor:r,onAnchorChange:a,children:n})};N7.displayName=yE;var M7="PopperAnchor",k7=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=C7(M7,n),i=g.useRef(null),s=Ni(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Bo.div,{...a,ref:s})});k7.displayName=M7;var gE="PopperContent",[Fwe,Bwe]=E7(gE),P7=g.forwardRef((e,t)=>{var J,K,W,Y,re,U;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=e,v=C7(gE,n),[b,w]=g.useState(null),j=Ni(t,ce=>w(ce)),[x,_]=g.useState(null),S=_p(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),C=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},k=Array.isArray(l)?l:[l],T=k.length>0,P={padding:C,boundary:k.filter(Uwe),altBoundary:T},{refs:N,floatingStyles:I,placement:A,isPositioned:R,middlewareData:L}=Hv({strategy:"fixed",placement:M,whileElementsMounted:(...ce)=>Av(...ce,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Kv({mainAxis:a+O,alignmentAxis:i}),c&&Zv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Gv():void 0,...P}),c&&Xv({...P}),Iv({...P,apply:({elements:ce,rects:ae,availableWidth:ue,availableHeight:je})=>{const{width:Le,height:$e}=ae.reference,Se=ce.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&l0({element:x,padding:s}),Vwe({arrowWidth:E,arrowHeight:O}),f&&u0({strategy:"referenceHidden",...P})]}),[D,B]=I7(A),F=dr(m);ln(()=>{R&&(F==null||F())},[R,F]);const $=(J=L.arrow)==null?void 0:J.x,z=(K=L.arrow)==null?void 0:K.y,X=((W=L.arrow)==null?void 0:W.centerOffset)!==0,[G,q]=g.useState();return ln(()=>{b&&q(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:R?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:G,"--radix-popper-transform-origin":[(Y=L.transformOrigin)==null?void 0:Y.x,(re=L.transformOrigin)==null?void 0:re.y].join(" "),...((U=L.hide)==null?void 0:U.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(Fwe,{scope:n,placedSide:D,onArrowChange:_,arrowX:$,arrowY:z,shouldHideArrow:X,children:h.jsx(Bo.div,{"data-side":D,"data-align":B,...y,ref:j,style:{...y.style,animation:R?void 0:"none"}})})})});P7.displayName=gE;var A7="PopperArrow",zwe={top:"bottom",right:"left",bottom:"top",left:"right"},T7=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=Bwe(A7,n),o=zwe[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(Lwe,{...r,ref:t,style:{...r.style,display:"block"}})})});T7.displayName=A7;function Uwe(e){return e!==null}var Vwe=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=I7(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",m="";return c==="bottom"?(p=o?u:`${d}px`,m=`${-s}px`):c==="top"?(p=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,m=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,m=o?u:`${f}px`),{data:{x:p,y:m}}}});function I7(e){const[t,n="center"]=e.split("-");return[t,n]}var qwe=N7,R7=k7,Wwe=P7,Hwe=T7,Kwe="Portal",D7=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);ln(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?XDe.createPortal(h.jsx(Bo.div,{...r,ref:t}),i):null});D7.displayName=Kwe;function Zwe(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var vE=e=>{const{present:t,children:n}=e,r=Gwe(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=Ni(r.ref,Xwe(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};vE.displayName="Presence";function Gwe(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=Zwe(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=Py(r.current);o.current=s==="mounted"?l:"none"},[s]),ln(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,f=Py(l);e?c("MOUNT"):f==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),ln(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=p=>{const m=Py(r.current).includes(p.animationName);if(p.target===t&&m&&(c("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},f=p=>{p.target===t&&(o.current=Py(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function Py(e){return(e==null?void 0:e.animationName)||"none"}function Xwe(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Ay="right-scroll-bar-position",Ty="width-before-scroll-bar",Jwe="with-scroll-bars-hidden",Ywe="--removed-body-scroll-bar-size";function bE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Qwe(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var exe=typeof window<"u"?g.useLayoutEffect:g.useEffect,L7=new WeakMap;function txe(e,t){var n=Qwe(null,function(r){return e.forEach(function(a){return bE(a,r)})});return exe(function(){var r=L7.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||bE(s,null)}),o.forEach(function(s){a.has(s)||bE(s,i)})}L7.set(n,e)},[e]),n}var $7=d0(),wE=function(){},Iy=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:wE,onWheelCapture:wE,onTouchMoveCapture:wE}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,j=jp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,_=txe([n,t]),S=En(En({},j),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:$7,removeScrollBar:l,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),En(En({},S),{ref:_})):g.createElement(b,En({},S,{className:c,ref:_}),s))});Iy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Iy.classNames={fullWidth:Ty,zeroRight:Ay};function nxe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=f0();return t&&e.setAttribute("nonce",t),e}function rxe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function axe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var oxe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=nxe())&&(rxe(t,n),axe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ixe=function(){var e=oxe();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},sxe=function(){var e=ixe(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},cxe={left:0,top:0,right:0,gap:0},xE=function(e){return parseInt(e||"",10)||0},lxe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[xE(n),xE(r),xE(a)]},uxe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return cxe;var t=lxe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},dxe=sxe(),sl="data-scroll-locked",fxe=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Jwe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(sl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ay,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Ty,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Ay," .").concat(Ay,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Ty," .").concat(Ty,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(sl,`] {
    `).concat(Ywe,": ").concat(s,`px;
  }
`)},F7=function(){var e=parseInt(document.body.getAttribute(sl)||"0",10);return isFinite(e)?e:0},pxe=function(){g.useEffect(function(){return document.body.setAttribute(sl,(F7()+1).toString()),function(){var e=F7()-1;e<=0?document.body.removeAttribute(sl):document.body.setAttribute(sl,e.toString())}},[])},hxe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;pxe();var o=g.useMemo(function(){return uxe(a)},[a]);return g.createElement(dxe,{styles:fxe(o,!t,a,n?"":"!important")})},_E=!1;if(typeof window<"u")try{var Ry=Object.defineProperty({},"passive",{get:function(){return _E=!0,!0}});window.addEventListener("test",Ry,Ry),window.removeEventListener("test",Ry,Ry)}catch{_E=!1}var cl=_E?{passive:!1}:!1,mxe=function(e){return e.tagName==="TEXTAREA"},B7=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!mxe(e)&&n[t]==="visible")},yxe=function(e){return B7(e,"overflowY")},gxe=function(e){return B7(e,"overflowX")},z7=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=U7(e,r);if(a){var o=V7(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},vxe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},bxe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},U7=function(e,t){return e==="v"?yxe(t):gxe(t)},V7=function(e,t){return e==="v"?vxe(t):bxe(t)},wxe=function(e,t){return e==="h"&&t==="rtl"?-1:1},xxe=function(e,t,n,r,a){var o=wxe(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=V7(e,s),m=p[0],y=p[1],v=p[2],b=y-v-o*m;(m||b)&&U7(e,s)&&(d+=b,f+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},Dy=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},q7=function(e){return[e.deltaX,e.deltaY]},W7=function(e){return e&&"current"in e?e.current:e},_xe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},jxe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Sxe=0,ll=[];function Exe(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(Sxe++)[0],o=g.useState(Sp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=p0([e.lockRef.current],(e.shards||[]).map(W7),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Dy(y),w=n.current,j="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],_,S=y.target,E=Math.abs(j)>Math.abs(x)?"h":"v";if("touches"in y&&E==="h"&&S.type==="range")return!1;var O=z7(E,S);if(!O)return!0;if(O?_=E:(_=E==="v"?"h":"v",O=z7(E,S)),!O)return!1;if(!r.current&&"changedTouches"in y&&(j||x)&&(r.current=_),!_)return!0;var M=r.current||_;return xxe(M,v,y,M==="h"?j:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!ll.length||ll[ll.length-1]!==o)){var b="deltaY"in v?q7(v):Dy(v),w=t.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&_xe(_.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var j=(i.current.shards||[]).map(W7).filter(Boolean).filter(function(_){return _.contains(v.target)}),x=j.length>0?s(v,j[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var j={name:y,delta:v,target:b,should:w,shadowParent:Oxe(b)};t.current.push(j),setTimeout(function(){t.current=t.current.filter(function(x){return x!==j})},1)},[]),u=g.useCallback(function(y){n.current=Dy(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,q7(y),y.target,s(y,e.lockRef.current))},[]),f=g.useCallback(function(y){l(y.type,Dy(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return ll.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,cl),document.addEventListener("touchmove",c,cl),document.addEventListener("touchstart",u,cl),function(){ll=ll.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,cl),document.removeEventListener("touchmove",c,cl),document.removeEventListener("touchstart",u,cl)}},[]);var p=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:jxe(a)}):null,p?g.createElement(hxe,{gapMode:e.gapMode}):null)}function Oxe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Cxe=h0($7,Exe);var H7=g.forwardRef(function(e,t){return g.createElement(Iy,En({},e,{ref:t,sideCar:Cxe}))});H7.classNames=Iy.classNames;var jE="Popover",[K7,b3e]=ur(jE,[O7]),sf=O7(),[Nxe,ki]=K7(jE),Z7=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=sf(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,f]=Pn({prop:r,defaultProp:a,onChange:o});return h.jsx(qwe,{...s,children:h.jsx(Nxe,{scope:t,contentId:Rt(),triggerRef:c,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};Z7.displayName=jE;let SE;SE="PopoverAnchor",c0=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=ki(SE,n),o=sf(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(R7,{...o,...r,ref:t})}),c0.displayName=SE;var G7="PopoverTrigger",EE=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=ki(G7,n),o=sf(n),i=Ni(t,a.triggerRef),s=h.jsx(Bo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":ez(a.open),...r,ref:i,onClick:Ci(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(R7,{asChild:!0,...o,children:s})});EE.displayName=G7;var OE="PopoverPortal",[Mxe,kxe]=K7(OE,{forceMount:void 0}),X7=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=ki(OE,t);return h.jsx(Mxe,{scope:t,forceMount:n,children:h.jsx(vE,{present:n||o.open,children:h.jsx(D7,{asChild:!0,container:a,children:r})})})};X7.displayName=OE;var ul="PopoverContent",J7=g.forwardRef((e,t)=>{const n=kxe(ul,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=ki(ul,e.__scopePopover);return h.jsx(vE,{present:r||o.open,children:o.modal?h.jsx(Pxe,{...a,ref:t}):h.jsx(Axe,{...a,ref:t})})});J7.displayName=ul;var Pxe=g.forwardRef((e,t)=>{const n=ki(ul,e.__scopePopover),r=g.useRef(null),a=Ni(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return pu(i)},[]),h.jsx(H7,{as:dE,allowPinchZoom:!0,children:h.jsx(Y7,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ci(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:Ci(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:Ci(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Axe=g.forwardRef((e,t)=>{const n=ki(ul,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(Y7,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Y7=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,f=ki(ul,n),p=sf(n);return hu(),h.jsx(b7,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(m7,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(Wwe,{"data-state":ez(f.open),role:"dialog",id:f.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Q7="PopoverClose",Txe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=ki(Q7,n);return h.jsx(Bo.button,{type:"button",...r,ref:t,onClick:Ci(e.onClick,()=>a.onOpenChange(!1))})});Txe.displayName=Q7;var Ixe="PopoverArrow",Rxe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=sf(n);return h.jsx(Hwe,{...a,...r,ref:t})});Rxe.displayName=Ixe;function ez(e){return e?"open":"closed"}rk=Z7,XG=c0,lk=EE,nk=X7,Rv=J7,bk=rk,tX=lk,m0=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(nk,{children:h.jsx(Rv,{ref:a,align:t,sideOffset:n,className:Z("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),m0.displayName=Rv.displayName;var tz=1,Dxe=.9,Lxe=.8,$xe=.17,CE=.1,NE=.999,Fxe=.9999,Bxe=.99,zxe=/[\\\/_+.#"@\[\(\{&]/,Uxe=/[\\\/_+.#"@\[\(\{&]/g,Vxe=/[\s-]/,nz=/[\s-]/g;function ME(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?tz:Bxe;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,f,p,m;l>=0;)d=ME(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=tz:zxe.test(e.charAt(l-1))?(d*=Lxe,p=e.slice(a,l-1).match(Uxe),p&&a>0&&(d*=Math.pow(NE,p.length))):Vxe.test(e.charAt(l-1))?(d*=Dxe,m=e.slice(a,l-1).match(nz),m&&a>0&&(d*=Math.pow(NE,m.length))):(d*=$xe,a>0&&(d*=Math.pow(NE,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=Fxe)),(d<CE&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(f=ME(e,t,n,r,l+1,o+2,i),f*CE>d&&(d=f*CE)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function rz(e){return e.toLowerCase().replace(nz," ")}function qxe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,ME(e,t,rz(e),rz(t),0,0,{})}var cf='[cmdk-group=""]',kE='[cmdk-group-items=""]',Wxe='[cmdk-group-heading=""]',PE='[cmdk-item=""]',az=`${PE}:not([aria-disabled="true"])`,AE="cmdk-item-select",xs="data-value",Hxe=(e,t,n)=>qxe(e,t,n),oz=g.createContext(void 0),lf=()=>g.useContext(oz),iz=g.createContext(void 0),TE=()=>g.useContext(iz),sz=g.createContext(void 0),cz=g.forwardRef((e,t)=>{let n=dl(()=>{var $,z;return{search:"",value:(z=($=e.value)!=null?$:e.defaultValue)!=null?z:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=dl(()=>new Set),a=dl(()=>new Map),o=dl(()=>new Map),i=dl(()=>new Set),s=lz(e),{label:c,children:l,value:u,onValueChange:d,filter:f,shouldFilter:p,loop:m,disablePointerSelection:y=!1,vimBindings:v=!0,...b}=e,w=Rt(),j=Rt(),x=Rt(),_=g.useRef(null),S=r1e();_s(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,E.emit()}},[u]),_s(()=>{S(6,P)},[]);let E=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,z,X)=>{var G,q,J;if(!Object.is(n.current[$],z)){if(n.current[$]=z,$==="search")T(),C(),S(1,k);else if($==="value"&&(X||S(5,P),((G=s.current)==null?void 0:G.value)!==void 0)){let K=z??"";(J=(q=s.current).onValueChange)==null||J.call(q,K);return}E.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,z,X)=>{var G;z!==((G=o.current.get($))==null?void 0:G.value)&&(o.current.set($,{value:z,keywords:X}),n.current.filtered.items.set($,M(z,X)),S(2,()=>{C(),E.emit()}))},item:($,z)=>(r.current.add($),z&&(a.current.has(z)?a.current.get(z).add($):a.current.set(z,new Set([$]))),S(3,()=>{T(),C(),n.current.value||k(),E.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let X=N();S(4,()=>{T(),(X==null?void 0:X.getAttribute("id"))===$&&k(),E.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:j,listInnerRef:_}),[]);function M($,z){var X,G;let q=(G=(X=s.current)==null?void 0:X.filter)!=null?G:Hxe;return $?q($,n.current.search,z):0}function C(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,z=[];n.current.filtered.groups.forEach(G=>{let q=a.current.get(G),J=0;q.forEach(K=>{let W=$.get(K);J=Math.max(W,J)}),z.push([G,J])});let X=_.current;I().sort((G,q)=>{var J,K;let W=G.getAttribute("id"),Y=q.getAttribute("id");return((J=$.get(Y))!=null?J:0)-((K=$.get(W))!=null?K:0)}).forEach(G=>{let q=G.closest(kE);q?q.appendChild(G.parentElement===q?G:G.closest(`${kE} > *`)):X.appendChild(G.parentElement===X?G:G.closest(`${kE} > *`))}),z.sort((G,q)=>q[1]-G[1]).forEach(G=>{var q;let J=(q=_.current)==null?void 0:q.querySelector(`${cf}[${xs}="${encodeURIComponent(G[0])}"]`);J==null||J.parentElement.appendChild(J)})}function k(){let $=I().find(X=>X.getAttribute("aria-disabled")!=="true"),z=$==null?void 0:$.getAttribute(xs);E.setState("value",z||void 0)}function T(){var $,z,X,G;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let q=0;for(let J of r.current){let K=(z=($=o.current.get(J))==null?void 0:$.value)!=null?z:"",W=(G=(X=o.current.get(J))==null?void 0:X.keywords)!=null?G:[],Y=M(K,W);n.current.filtered.items.set(J,Y),Y>0&&q++}for(let[J,K]of a.current)for(let W of K)if(n.current.filtered.items.get(W)>0){n.current.filtered.groups.add(J);break}n.current.filtered.count=q}function P(){var $,z,X;let G=N();G&&((($=G.parentElement)==null?void 0:$.firstChild)===G&&((X=(z=G.closest(cf))==null?void 0:z.querySelector(Wxe))==null||X.scrollIntoView({block:"nearest"})),G.scrollIntoView({block:"nearest"}))}function N(){var $;return($=_.current)==null?void 0:$.querySelector(`${PE}[aria-selected="true"]`)}function I(){var $;return Array.from((($=_.current)==null?void 0:$.querySelectorAll(az))||[])}function A($){let z=I()[$];z&&E.setState("value",z.getAttribute(xs))}function R($){var z;let X=N(),G=I(),q=G.findIndex(K=>K===X),J=G[q+$];(z=s.current)!=null&&z.loop&&(J=q+$<0?G[G.length-1]:q+$===G.length?G[0]:G[q+$]),J&&E.setState("value",J.getAttribute(xs))}function L($){let z=N(),X=z==null?void 0:z.closest(cf),G;for(;X&&!G;)X=$>0?t1e(X,cf):n1e(X,cf),G=X==null?void 0:X.querySelector(az);G?E.setState("value",G.getAttribute(xs)):R($)}let D=()=>A(I().length-1),B=$=>{$.preventDefault(),$.metaKey?D():$.altKey?L(1):R(1)},F=$=>{$.preventDefault(),$.metaKey?A(0):$.altKey?L(-1):R(-1)};return g.createElement(Ae.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var z;if((z=b.onKeyDown)==null||z.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&B($);break}case"ArrowDown":{B($);break}case"p":case"k":{v&&$.ctrlKey&&F($);break}case"ArrowUp":{F($);break}case"Home":{$.preventDefault(),A(0);break}case"End":{$.preventDefault(),D();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let X=N();if(X){let G=new Event(AE);X.dispatchEvent(G)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:o1e},c),Ly(e,$=>g.createElement(iz.Provider,{value:E},g.createElement(oz.Provider,{value:O},$))))}),Kxe=g.forwardRef((e,t)=>{var n,r;let a=Rt(),o=g.useRef(null),i=g.useContext(sz),s=lf(),c=lz(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;_s(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=uz(a,o,[e.value,e.children,o],e.keywords),d=TE(),f=js(S=>S.value&&S.value===u.current),p=js(S=>l||s.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);g.useEffect(()=>{let S=o.current;if(!(!S||e.disabled))return S.addEventListener(AE,m),()=>S.removeEventListener(AE,m)},[p,e.onSelect,e.disabled]);function m(){var S,E;y(),(E=(S=c.current).onSelect)==null||E.call(S,u.current)}function y(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:b,onSelect:w,forceMount:j,keywords:x,..._}=e;return g.createElement(Ae.div,{ref:uf([o,t]),..._,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||s.getDisablePointerSelection()?void 0:y,onClick:v?void 0:m},e.children)}),Zxe=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Rt(),s=g.useRef(null),c=g.useRef(null),l=Rt(),u=lf(),d=js(p=>a||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);_s(()=>u.group(i),[]),uz(i,s,[e.value,e.heading,c]);let f=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Ae.div,{ref:uf([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),Ly(e,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(sz.Provider,{value:f},p))))}),Gxe=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=js(i=>!i.search);return!n&&!o?null:g.createElement(Ae.div,{ref:uf([a,t]),...r,"cmdk-separator":"",role:"separator"})}),Xxe=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=TE(),i=js(u=>u.search),s=js(u=>u.value),c=lf(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${PE}[${xs}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Ae.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),Jxe=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=lf();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;l.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Ae.div,{ref:uf([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},Ly(e,c=>g.createElement("div",{ref:uf([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),Yxe=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(ou,{open:n,onOpenChange:r},g.createElement(cu,{container:i},g.createElement(Hi,{"cmdk-overlay":"",className:a}),g.createElement(Ki,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(cz,{ref:t,...s}))))}),Qxe=g.forwardRef((e,t)=>js(n=>n.filtered.count===0)?g.createElement(Ae.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),e1e=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Ae.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Ly(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),or=Object.assign(cz,{List:Jxe,Item:Kxe,Input:Xxe,Group:Zxe,Separator:Gxe,Dialog:Yxe,Empty:Qxe,Loading:e1e});function t1e(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function n1e(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function lz(e){let t=g.useRef(e);return _s(()=>{t.current=e}),t}var _s=typeof window>"u"?g.useEffect:g.useLayoutEffect;function dl(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function uf(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function js(e){let t=TE(),n=()=>e(t.snapshot());return xp.useSyncExternalStore(t.subscribe,n,n)}function uz(e,t,n,r=[]){let a=g.useRef(),o=lf();return _s(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(xs,s),a.current=s}),a}var r1e=()=>{let[e,t]=g.useState(),n=dl(()=>new Map);return _s(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function a1e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Ly({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(a1e(t),{ref:t.ref},n(t.props.children)):n(t)}var o1e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const dz=g.forwardRef(({className:e,...t},n)=>h.jsx(or,{ref:n,className:Z("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));dz.displayName=or.displayName;const fz=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(fe,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(or.Input,{ref:n,className:Z("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));fz.displayName=or.Input.displayName;const pz=g.forwardRef(({className:e,...t},n)=>h.jsx(or.List,{ref:n,className:Z("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));pz.displayName=or.List.displayName;const hz=g.forwardRef((e,t)=>h.jsx(or.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));hz.displayName=or.Empty.displayName;const mz=g.forwardRef(({className:e,...t},n)=>h.jsx(or.Group,{ref:n,className:Z("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));mz.displayName=or.Group.displayName;const i1e=g.forwardRef(({className:e,...t},n)=>h.jsx(or.Separator,{ref:n,className:Z("-mx-1 h-px bg-border",e),...t}));i1e.displayName=or.Separator.displayName;const df=g.forwardRef(({className:e,...t},n)=>h.jsx(or.Item,{ref:n,className:Z("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));df.displayName=or.Item.displayName;const s1e=io("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),_a=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:Z(s1e({variant:t}),e),...n}));_a.displayName="Alert";const zo=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:Z("mb-1 font-medium leading-none tracking-tight",e),...t}));zo.displayName="AlertTitle";const fl=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("text-sm [&_p]:leading-relaxed",e),...t}));fl.displayName="AlertDescription";const c1e=so(({onConfirm:e,onCancel:t})=>{const n=tn(),{t:r}=ke("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{try{if((a==null?void 0:a.length)!==6)return;await(e==null?void 0:e(a)),o(""),n.resolve(!0),n.hide()}catch(l){n.reject(l)}},c=()=>{t==null||t(),o(""),n.resolve(!1),n.hide()};return h.jsx(fi,{open:n.visible,onOpenChange:c,children:h.jsxs(vo,{className:"w-[330px]",children:[h.jsxs(bo,{children:[h.jsx(wo,{children:r("create_session_passkey.title")}),h.jsx(Lu,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(sj,{onChange:i,maxLength:6,children:[h.jsxs(Md,{children:[h.jsx(wr,{index:0,hidden:!0}),h.jsx(wr,{index:1,hidden:!0}),h.jsx(wr,{index:2,hidden:!0})]}),h.jsx(cj,{}),h.jsxs(Md,{children:[h.jsx(wr,{index:3,hidden:!0}),h.jsx(wr,{index:4,hidden:!0}),h.jsx(wr,{index:5,hidden:!0})]})]})}),h.jsx(Du,{children:h.jsx(tt,{disabled:(a==null?void 0:a.length)!==6,onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),l1e=()=>{const[e,t]=g.useState(!1),n=et(o=>o.currentSession),r=et(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Ufe(),s=await d6(i,o);await de("Session").update(n.id,{passphrase:s});const c=await de("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}};var IE="Checkbox",[u1e,w3e]=ur(IE),[d1e,f1e]=u1e(IE),yz=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[f,p]=g.useState(null),m=jt(t,x=>p(x)),y=g.useRef(!1),v=f?u||!!f.closest("form"):!0,[b=!1,w]=Pn({prop:a,defaultProp:o,onChange:l}),j=g.useRef(b);return g.useEffect(()=>{const x=f==null?void 0:f.form;if(x){const _=()=>w(j.current);return x.addEventListener("reset",_),()=>x.removeEventListener("reset",_)}},[f,w]),h.jsxs(d1e,{scope:n,state:b,disabled:s,children:[h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":Pi(b)?"mixed":b,"aria-required":i,"data-state":bz(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:m,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(_=>Pi(_)?!0:!_),v&&(y.current=x.isPropagationStopped(),y.current||x.stopPropagation())})}),v&&h.jsx(p1e,{control:f,bubbles:!y.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Pi(o)?!1:o})]})});yz.displayName=IE;var gz="CheckboxIndicator",vz=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=f1e(gz,n);return h.jsx(Br,{present:r||Pi(o.state)||o.state===!0,children:h.jsx(Ae.span,{"data-state":bz(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});vz.displayName=gz;var p1e=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=aF(n),c=_p(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&f){const p=new Event("click",{bubbles:r});u.indeterminate=Pi(n),f.call(u,Pi(n)?!1:n),u.dispatchEvent(p)}},[s,n,r]);const l=g.useRef(Pi(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Pi(e){return e==="indeterminate"}function bz(e){return Pi(e)?"indeterminate":e?"checked":"unchecked"}Lv=yz,ik=vz;const RE=g.forwardRef(({className:e,...t},n)=>h.jsx(Lv,{ref:n,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(ik,{className:Z("flex items-center justify-center text-current"),children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}));RE.displayName=Lv.displayName;const h1e=[nt.WebLLM,nt.OpenAI,nt.GoogleGenerativeAI,nt.Groq],m1e=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"],y1e=["deepseek-r1-distill-llama-70b","llama-3.2-90b-vision-preview","llama-3.3-70b-versatile","llama-3.3-70b-specdec","llama3-70b-8192","gemma2-9b-it","llama3-8b-8192","mixtral-8x7b-32768"],g1e=["llama-3.2-90b-vision-preview"],v1e=["gemini-2.0-flash-exp","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-flash-8b"],wz="https://aistudio.google.com/app/apikey",xz="https://platform.openai.com/api-keys",_z="https://console.groq.com/keys";function b1e(e){var X,G;const{id:t,setDialog:n}=e,{t:r}=ke("components"),{toast:a}=nn(),o=Bn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[f,p]=g.useState(""),[m,y]=g.useState(),[v,b]=g.useState(nt.WebLLM),[w,j]=g.useState(!1),[x,_]=g.useState(),{updateSessionPassphrase:S}=l1e(),E=et(q=>q.currentSession),O=oo(q=>q.syncCachedLLMURLs),M=oo(q=>q.cachedLLMURLs),{loading:C,createLLM:k}=u7(),{modalRef:T}=Ic(c1e),{modalRef:P}=Ic(kd);g.useEffect(()=>{Ht(()=>import("./index-PRjZyF7d.js").then(async q=>(await q.__tla,q)),__vite__mapDeps([9,1,2,3,4])).then(async({functionCallingModelIds:q,prebuiltAppConfig:J})=>{const K=J.model_list;_({modelList:K,functionCallingModelIds:q})})},[]),g.useEffect(()=>{O()},[O]);const N=g.useMemo(()=>c?v!==nt.WebLLM:!1,[c,v]),I=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((f?x==null?void 0:x.modelList.filter(q=>q.model_id.toLowerCase().includes(f.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((q,J)=>{const K=M.some(ae=>ae.includes(q.model_id)),W=M.some(ae=>ae.includes(J.model_id));if(K&&!W)return-1;if(!K&&W)return 1;const Y=MS.includes(q.model_id),re=MS.includes(J.model_id);if(Y&&!re)return-1;if(!Y&&re)return 1;const U=x==null?void 0:x.functionCallingModelIds.includes(q.model_id),ce=x==null?void 0:x.functionCallingModelIds.includes(J.model_id);return U&&!ce?-1:!U&&ce?1:q.vram_required_MB&&J.vram_required_MB&&q.vram_required_MB!==J.vram_required_MB?q.vram_required_MB-J.vram_required_MB:q.model_id.localeCompare(J.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,f,M]),A=g.useMemo(()=>{if(c)switch(v){case nt.WebLLM:return(x==null?void 0:x.modelList)&&I.find(q=>q.model_id===c);case nt.Groq:return y({}),{model:c,model_id:c,model_type:g1e.includes(c)?2:0,overrides:{}};case nt.OpenAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}};case nt.GoogleGenerativeAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,I,v]);g.useEffect(()=>{!(A!=null&&A.model_id)||!M||j(M.some(q=>q.includes(A.model_id)))},[M,A==null?void 0:A.model_id]),g.useEffect(()=>{E!=null&&E.id&&(b(nt.WebLLM),l(""),p(""),y({}))},[E==null?void 0:E.id]);const R=g.useCallback(q=>{l(q),d(!1)},[]),L=g.useCallback(q=>{p(q)},[]),D=g.useCallback(q=>{b(q),l(""),p(""),y({})},[]),B=async()=>{var q;if(!(!o||!E))try{s(!0);let J="",K;if(N&&!E.passphrase){await T.current.show({onConfirm:async Y=>{J=Y}});const W=await S(J);if(!W||!Object.keys(m||{}).length)throw new Error("Failed to update session passphrase");await mp.set("passphrase",W.passphrase),K=await f6(m||{},W.passphrase)}else if(N&&E.passphrase){const W=await Cm(E.passphrase,P.current);K=await f6(m||{},W)}await k(o,{name:c,model_type:F(A==null?void 0:A.model_type),function_calling:A!=null&&A.model_id?(q=x==null?void 0:x.functionCallingModelIds)==null?void 0:q.includes(A==null?void 0:A.model_id):!1,parameters:K,provider:v}),n==null||n(!1)}catch(J){Us(J),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),b(nt.WebLLM),y({}),l(""),p("")}},F=g.useCallback(q=>q===1?gu.embedding:q===2?gu.VLM:gu.LLM,[]),$=g.useMemo(()=>{switch(v){case nt.WebLLM:return I.map(q=>{var J;return h.jsxs(df,{value:q.model_id,onSelect:R,children:[c===q.model_id?h.jsx(fe,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(Pr,{name:q.model_id}),q.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(rf,{model:q,isFunctionCalling:((J=x==null?void 0:x.functionCallingModelIds)==null?void 0:J.includes(q.model_id))||!1,name:q.model_id,isCached:M.some(K=>K.includes(q.model_id))||!1,cloud:v!==nt.WebLLM})})]})]},q.model_id)});case nt.OpenAI:return m1e.map(q=>h.jsxs(df,{value:q,onSelect:R,children:[c===q?h.jsx(fe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Pr,{name:q}),q]})})]},q));case nt.GoogleGenerativeAI:return v1e.map(q=>h.jsxs(df,{value:q,onSelect:R,children:[c===q?h.jsx(fe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Pr,{name:q}),q]})})]},q));case nt.Groq:return y1e.map(q=>h.jsxs(df,{value:q,onSelect:R,children:[c===q?h.jsx(fe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Pr,{name:q}),q]})})]},q))}},[M,R,c,x==null?void 0:x.functionCallingModelIds,I,v]),z=g.useMemo(()=>{if(N)switch(v){case nt.Groq:case nt.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(_a,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(qe,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(tt,{variant:"link",className:"px-1",children:h.jsxs("a",{href:v===nt.OpenAI?xz:_z,target:"_blank",rel:"noreferrer",children:["(",v===nt.OpenAI?xz:_z,")"]})}),h.jsx(Gt,{type:"password",value:(m==null?void 0:m.key)||"",onChange:q=>y(J=>({...J,key:q.target.value}))})]})]});case nt.GoogleGenerativeAI:return h.jsxs(h.Fragment,{children:[h.jsx(_a,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(qe,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(tt,{variant:"link",className:"px-1",children:h.jsxs("a",{href:wz,target:"_blank",rel:"noreferrer",children:["(",wz,")"]})}),h.jsx(Gt,{type:"password",value:(m==null?void 0:m.key)||"",onChange:q=>y(J=>({...J,key:q.target.value}))})]}),h.jsxs("div",{className:"mt-4 flex items-center",children:[h.jsx(qe,{children:r("add_llm_card.encrypted_fields.enabled_google_search_retreival")}),h.jsx(RE,{checked:!!(m!=null&&m.enabled_google_search_retreival),className:"ml-2",onCheckedChange:q=>{y(J=>({...J,enabled_google_search_retreival:q?"true":""}))}})]})]})}},[N,v,r,m]);return h.jsxs(en,{className:"max-w-lg",children:[h.jsx(Wn,{children:h.jsx(rr,{children:r("add_llm_card.title")})}),h.jsxs(Hn,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(qe,{children:r("add_llm_card.provider")}),h.jsxs(Lo,{value:v,onValueChange:D,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(Xa,{children:Object.values(h1e).map(q=>h.jsx(ar,{value:q,children:r(`add_llm_card.providers.${q.toLowerCase()}`)},q))})]}),h.jsx(qe,{children:r("add_llm_card.model_name")}),h.jsxs(bk,{open:u,onOpenChange:d,children:[h.jsx(EE,{asChild:!0,children:h.jsxs(tt,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?A==null?void 0:A.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(fe,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(m0,{className:"w-full p-0",children:h.jsxs(dz,{children:[h.jsx(fz,{onValueChange:L,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(pz,{children:[h.jsx(hz,{children:r("add_llm_card.no_model")}),h.jsx(mz,{children:$})]})]})})]})]}),A?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(Pr,{name:A.model_id,className:"mr-2"}),h.jsx(rf,{model:A,isFunctionCalling:((X=x==null?void 0:x.functionCallingModelIds)==null?void 0:X.includes(A.model_id))||!1,name:A.model_id,isCached:M.some(q=>q.includes(A.model_id))||!1,cloud:v!==nt.WebLLM})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),A.model]}),A.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),A.model_lib]}):void 0,A.overrides&&((G=Object.keys(A.overrides))!=null&&G.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(A.overrides)]}):void 0]}):null,z]}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{loading:C||i,disabled:!(c!=null&&c.length),onClick:B,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const jz=()=>{const e=et(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),f=await de("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||fr.System,status:Wr.Started,session_id:e,type:i.type||pr.Chat});if(!f)throw new Error("Failed to save prompt");if(!await r({source_id:f.id,source_type:"Prompt",node_type:ie.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},w1e={[pr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:pr.Chat},[pr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:pr.FewShotExample}},x1e={[fr.System]:{label:"add_prompt_card.prompt_roles.system",value:fr.System},[fr.Human]:{label:"add_prompt_card.prompt_roles.human",value:fr.Human},[fr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:fr.AI}},DE=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||pr.Chat),[d,f]=g.useState(t),[p,m]=g.useState(""),{t:y}=ke("components"),v=g.useCallback(_=>{c(_.target.value)},[]),b=g.useCallback(_=>{m(_.target.value)},[]),w=g.useCallback(_=>{_===pr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(_)},[]),j=g.useCallback(_=>{f(_)},[]),x=async()=>{await i({content:s,role:d,prefix:p,type:l})&&(c(""),f(void 0),u("chat"),m(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(qe,{children:y("add_prompt_card.prompt_type")}),h.jsxs(Lo,{value:l,onValueChange:w,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:y("add_prompt_card.type_select_placeholder")})}),h.jsx(Xa,{children:Object.values(w1e).map(_=>h.jsx(ar,{value:_.value,children:y(_.label)},_.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(qe,{children:y("add_prompt_card.prompt_role")}),h.jsxs(Lo,{value:d,onValueChange:j,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:y("add_prompt_card.role_select_placeholder")})}),h.jsx(Xa,{children:Object.values(x1e).map(_=>h.jsx(ar,{value:_.value,children:y(_.label)},_.value))})]})]}),l===pr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(qe,{children:y("add_prompt_card.prompt_prefix")}),h.jsx(Oo,{value:p,onChange:b,disabled:!1,className:"h-20",placeholder:y("add_prompt_card.placeholder"),id:"message"}),h.jsx(qe,{children:y("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),y("add_prompt_card.few_shot_example_note")]})]}),h.jsx(Oo,{value:s,onChange:v,disabled:!1,placeholder:y("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Xn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:y("add_prompt_card.button")})})]})}),_1e=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=ke("components"),{toast:o}=nn(),i=Bn(t),{createPrompt:s,loading:c}=jz(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(en,{className:"mw-full",children:[h.jsx(Wn,{children:h.jsx(rr,{children:a("add_prompt_card.title")})}),h.jsx(Hn,{children:h.jsx(DE,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),j1e=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||zu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,f=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),p=await de("Schema").save({name:"Untitled Schema",session_id:e});if(!p)throw new Error("Failed to save schema");const m=a(p.id,s,[],void 0);if(!(m!=null&&m.length))throw new Error("Failed to convert schema items");if(await de("SchemaItem").save(m),!await r({source_id:p.id,source_type:"Schema",node_type:ie.Schema,x:d,y:f+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}},Sz=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=ke("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(y=>y.id===n)||a,[t,a,n]),s=g.useCallback(y=>{y.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(y.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:y.target.value||""}:b)]):o(v=>({...v,name:y.target.value||""})))},[n,e]),c=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:y.target.value||""}:b)]):o(v=>({...v,description:y.target.value||""}))},[n,e]),l=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:y||""}:b)]):o(v=>({...v,type:y||"string"}))},[n,e]),u=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!y||!1}:b)]):o(v=>({...v,required:!!y||!1}))},[n,e]),d=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:y.target.value||""}:b)]):o(v=>({...v,enum:y.target.value||""}))},[n,e]),f=g.useCallback(()=>{if(t.find(y=>y.name===a.name))return au({variant:"destructive",content:"Name already exists"});a.id=zu(),e(y=>[...y,{...a}]),o({name:"",description:"",type:"string",required:!1,id:zu(),parent:n||void 0,data:[]})},[t,a,e,n]),p=g.useCallback(y=>{e(v=>[...v.map(b=>b.id===n?{...b,data:y(b.data||[])}:b)])},[n,e]),m=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(qe,{children:r("add_schema_card.field.name")}),h.jsx(Gt,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(qe,{children:r("add_schema_card.field.description")}),h.jsx(Gt,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(qe,{children:r("add_schema_card.field.type")}),h.jsxs(Lo,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Ga,{children:h.jsx($o,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(Xa,{children:[h.jsx(ar,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(ar,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(ar,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(ar,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(ar,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(qe,{children:r("add_schema_card.field.required")}),h.jsx(RE,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),m?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(qe,{children:r("add_schema_card.children")}),h.jsx(Ez,{data:(i==null?void 0:i.data)||[],setData:p})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(qe,{children:r("add_schema_card.field.enum")}),h.jsx(Gt,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(tt,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:f,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),Ez=g.memo(({data:e,setData:t})=>h.jsxs(eB,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(VS,{value:`${n.id}`,children:[h.jsx(qS,{children:n.name}),h.jsx(WS,{children:h.jsx(Sz,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(en,{className:"p-2 mt-4",children:h.jsx(Sz,{setData:t,data:e})})]})),S1e=g.memo(e=>{const{t}=ke("components"),{id:n}=e,r=Bn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=j1e(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){au({variant:"destructive",title:`${l}`})}};return h.jsxs(en,{className:"max-w-lg",children:[h.jsx(Wn,{children:h.jsx(rr,{children:t("add_schema_card.title")})}),h.jsx(Hn,{className:"min-w-96",children:h.jsx(Ez,{setData:o,data:a})}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),Oz=()=>{const e=et(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,f=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),p=JDe(i,s),m=await de("CSVData").save({headers:p.headers,csv:p.data,session_id:e});if(!m)throw new Error("Failed to save");if(!await r({source_id:m.id,source_type:"CSVData",node_type:ie.CSVData,x:d,y:f+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function E1e({data:e}){const{t}=ke("components");return h.jsxs(Ey,{className:"w-full",children:[h.jsx(Oy,{children:h.jsxs(ws,{children:[h.jsx(al,{children:t("add_few_shot_example_card.input")}),h.jsx(al,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(Cy,{children:e==null?void 0:e.map((n,r)=>h.jsxs(ws,{children:[h.jsx(ol,{className:"p-4",children:n.input}),h.jsx(ol,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const O1e=g.memo(e=>{const{id:t}=e,{t:n}=ke("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Bn(t),{createCSVData:u,loading:d}=Oz(),f=()=>{a(m=>[...m,{input:o,output:s}]),i(""),c("")},p=async()=>{l&&await u(l,["input","output"],r.map(m=>[m.input,m.output]))};return h.jsxs(en,{className:"mw-full",children:[h.jsx(Wn,{children:h.jsx(rr,{children:n("add_few_shot_example_card.title")})}),h.jsxs(Hn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(qe,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(Gt,{value:o,onChange:m=>i(m.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(qe,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(Oo,{value:s,onChange:m=>c(m.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(tt,{disabled:!o||!s,onClick:f,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(E1e,{data:r||[]})]}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{loading:d,disabled:!(r!=null&&r.length),onClick:p,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),C1e=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await de("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!m)throw new Error("Failed create tool.");const y=await r({source_id:m.id,source_type:"ToolDefinition",node_type:ie.ToolDefinition,x:f,y:p+20});if(!y)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:y.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},N1e=g.memo(e=>{const{t}=ke("components"),{toast:n}=nn(),{id:r}=e,a=Bn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=C1e(),d=m=>{i(m.target.value)},f=m=>{c(m.target.value)},p=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(m){ti(m),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(en,{className:"mw-full",children:[h.jsx(Wn,{children:h.jsx(rr,{children:t("add_tool_card.title")})}),h.jsxs(Hn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(qe,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(Gt,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(qe,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(Oo,{onChange:f,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{loading:u,onClick:p,className:"w-full",children:t("add_tool_card.create")})})]})}),M1e=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await de("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||YDe.Local,storage:s.storage||Ur.DatabaseNode,raw:"",provider:s.provider||WG.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!m)throw new Error("Failed to save vectorDatabase");const y=await r({source_id:m.id,source_type:"VectorDatabase",node_type:ie.VectorDatabase,x:f,y:p+30});if(!y)throw new Error("Failed to save vectorDatabase node");if(s.storage===Ur.DataNode){const v=await de("JSONLData").save({headers:QDe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:ie.JSONLData,x:f+80,y:p+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:y.id})}return{vectorDatabase:m,vectorDatabaseNode:y}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},ff=[WG.Memory],pf=[Ur.DatabaseNode],k1e=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],P1e=g.memo(e=>{const{t}=ke("components"),{id:n}=e,r=Bn(n),{toast:a}=nn(),[o,i]=g.useState(""),[s,c]=g.useState(ff[0]),[l,u]=g.useState(pf[0]),[d,f]=g.useState({}),{loading:p,createVectorDatabase:m}=M1e(),y=g.useCallback(S=>{c(S)},[]),v=g.useCallback(S=>{u(S)},[]),b=g.useCallback(S=>{f(E=>({...E,type:S,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(S=>{i(S.target.value||"")},[]),j=g.useCallback(S=>{f(E=>({...E,chunkSize:Number(S.target.value)}))},[]),x=g.useCallback(S=>{f(E=>({...E,chunkOverlap:Number(S.target.value)}))},[]),_=async()=>{try{if(!r)return;await m(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),f({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(en,{className:"mw-full",children:[h.jsx(Wn,{children:h.jsx(rr,{children:t("create_vector_database_card.title")})}),h.jsx(Hn,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(qe,{children:t("create_vector_database_card.name")}),h.jsx(Gt,{className:"mb-4",value:o,onChange:w}),(pf==null?void 0:pf.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(qe,{children:t("create_vector_database_card.storage_type")}),h.jsxs(Lo,{value:l,onValueChange:v,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Xa,{children:Object.values(pf).map(S=>h.jsx(ar,{value:S,children:t(`create_vector_database_card.storage_types.${S.toLowerCase()}`)},S))})]})]}):void 0,(ff==null?void 0:ff.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(qe,{children:t("create_vector_database_card.provider")}),h.jsxs(Lo,{value:s,onValueChange:y,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Xa,{children:Object.values(ff).map(S=>h.jsx(ar,{value:S,children:t(`create_vector_database_card.providers.${S.toLowerCase()}`)},S))})]})]}):void 0,h.jsx(qe,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(Lo,{value:d.type,onValueChange:b,children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(Xa,{children:Object.values(k1e).map(S=>h.jsx(ar,{value:S,children:t(`create_vector_database_card.text_splitters.${S.toLowerCase()}`)},S))})]}),d.type?h.jsxs(en,{children:[h.jsx(Wn,{children:h.jsx(rr,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs(Hn,{children:[h.jsx(qe,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(Gt,{value:d.chunkSize,onChange:j,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(qe,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(Gt,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{disabled:!d.type||!o,loading:p,onClick:_,className:"w-full",children:t("create_vector_database_card.create")})})]})});function A1e({data:e}){const{t}=ke("components");return h.jsxs(Ey,{className:"w-full",children:[h.jsx(Oy,{children:h.jsx(ws,{children:h.jsx(al,{children:t("add_text_data.text")})})}),h.jsx(Cy,{children:e==null?void 0:e.map((n,r)=>h.jsx(ws,{children:h.jsx(ol,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const T1e=g.memo(e=>{const{id:t}=e,{t:n}=ke("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Bn(t),{createCSVData:c,loading:l}=Oz(),u=()=>{a(f=>[...f,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(f=>[f.text]))};return h.jsxs(en,{className:"mw-full",children:[h.jsx(Wn,{children:h.jsx(rr,{children:n("add_text_data.title")})}),h.jsxs(Hn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(qe,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(Oo,{value:o,onChange:f=>i(f.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(tt,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(A1e,{data:r||[]})]}),h.jsx(Si,{className:"flex justify-between",children:h.jsx(Xn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var Uo=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(Uo||{});const I1e=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],R1e=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let Cz=0,Nz,Mz,kz,Pz,Az,Tz,Rn,dt,Iz,Rz,Dz,Lz,$y,LE,$E,FE,$z,Fz,BE,Bz,zz,Uz;Nz=(e,t)=>{Cz++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=R1e();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,M=(t==null?void 0:t.speedUp)||Math.random()*25,C=Math.random()*360,k=Math.random()*35*(Math.random()<=.5?-1:1),T=c-E/2,P=s-E/2,N=Math.random()<=.5?-1:1,I=document.createElement("div");if(n==="circle"){const A="http://www.w3.org/2000/svg",R=document.createElementNS(A,"svg"),L=document.createElementNS(A,"circle");L.setAttributeNS(null,"cx",(E/2).toString()),L.setAttributeNS(null,"cy",(E/2).toString()),L.setAttributeNS(null,"r",(E/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),R.appendChild(L),R.setAttribute("width",E.toString()),R.setAttribute("height",E.toString()),I.appendChild(R)}else I.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;I.style.position="absolute",I.style.transform=`translate3d(${P}px, ${T}px, 0px) rotate(${C}deg)`,l.appendChild(I),o.push({direction:N,element:I,left:P,size:E,speedHorz:O,speedUp:M,spinSpeed:k,spinVal:C,top:T})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let f,p=0;const m=30;function y(){const E=performance.now();i&&o.length<a&&E-p>m&&(u(),p=E),d(),f=requestAnimationFrame(y)}y();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",j=v?"touchmove":"mousemove",x=E=>{var O,M;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(M=E.touches)==null?void 0:M[0].clientY):(s=E.clientX,c=E.clientY)},_=E=>{x(E),i=!0},S=()=>{i=!1};return e.addEventListener(j,x,{passive:!0}),e.addEventListener(b,_,{passive:!0}),e.addEventListener(w,S,{passive:!0}),e.addEventListener("mouseleave",S,{passive:!0}),()=>{e.removeEventListener(j,x),e.removeEventListener(b,_),e.removeEventListener(w,S),e.removeEventListener("mouseleave",S);const E=setInterval(()=>{f&&o.length===0&&(cancelAnimationFrame(f),clearInterval(E),--Cz===0&&l.remove())},500)}},Mz=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return Nz(n.current,t)},[t]),H.cloneElement(e,{ref:n})},kz=g.memo(e=>{const{t}=ke("flows"),n=eu(s=>s.theme),[r,a]=g.useState(`${Uo.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(s7,{children:[h.jsx(lE,{children:h.jsx(Mz,{children:h.jsx(tt,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(e3e,{width:32,height:32,className:Z(n==="dark"?"fill-white":"fill-black")})})})}),I1e.map(s=>typeof s=="object"?h.jsxs(lE,{children:[h.jsx(uE,{children:s.icon?h.jsx(fe,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(c7,{children:s.children.map(c=>h.jsx(l7,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(lE,{children:h.jsx(uE,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case Uo.ADD_LLM:return h.jsx(b1e,{...e});case Uo.ADD_PROMPT:return h.jsx(_1e,{...e});case Uo.ADD_SCHEMA:return h.jsx(S1e,{...e});case Uo.ADD_FEW_SHOT_EXAMPLE:return h.jsx(O1e,{...e});case Uo.ADD_TOOL_DEFINITION:return h.jsx(N1e,{...e});case Uo.ADD_VECTOR_DATABASE:return h.jsx(P1e,{...e});case Uo.ADD_TEXT_DATA:return h.jsx(T1e,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),Pz=()=>{const[e,t]=g.useState(!1),n=Ji(),r=et(s=>s.currentSession),a=et(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var p;const d=(p=c.data)==null?void 0:p.entity;let f=c.type?t3e[c.type]:void 0;if(f&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){f=f;const m=await de(f).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,m.id);const y=await de("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await de("FlowNode").save({...y||c.data.flowNode,session_id:s.id,id:void 0,source_type:f,source_id:m.id});return u.set(`${c.id}`,v.id),{entityName:f,entity:m,node:v}}else if(!u.has(`${c.id}`)){const m=await de("FlowNode").findOne({where:{id:c.data.flowNode.id}}),y=await de("FlowNode").save({...m||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,y.id),{node:y}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await de("Session").save({type:Ui.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:n3e.Started,passphrase:r.passphrase});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,f=await o(l,s,u,d);if(!f)throw new Error("Failed to clone main node");await de("Session").update(l.id,{main_node_id:f.node.id,main_source_id:f!=null&&f.entity?f.entity.id:void 0,main_source_type:f.entityName?f.entityName:void 0});for(const{node:p,connectedNodes:m}of c.connections)if(await o(l,p,u,d),m)for(const y of m)await o(l,y,u,d);for(const{connections:p}of c.connections)for(const m of p){const y=d.get(`${m.source}`),v=d.get(`${m.target}`);if(!y||!v)throw new Error("Failed to get connected flow node id");await de("FlowEdge").save({source:y,target:v,sourceHandle:m.sourceHandle,targetHandle:m.targetHandle,session_id:l.id})}return a(),n(dn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},Az=()=>{const[e,t]=g.useState(!1),n=De(o=>o.updateNodes),r=De(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await de("FlowNode").delete(o);const i=await de("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>de("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},Tz=so(({cloneStandaloneSession:e})=>{const t=tn(),{t:n}=ke("dialogs"),[r,a]=g.useState(""),{toast:o}=nn(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(fi,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(vo,{className:"sm:max-w-[425px]",children:[h.jsxs(bo,{children:[h.jsx(wo,{children:n("create_session.title")}),h.jsx(Lu,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(qe,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(Gt,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(Du,{children:h.jsx(tt,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Rn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=ke("common"),{getNode:o}=br(),{loading:i,deleteNodeFlow:s}=Az(),{createStandaloneSession:c}=Pz(),{toast:l}=nn(),u=tn(Tz),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),f=g.useCallback(async m=>{try{const y=o(e);if(!y)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(y,{name:m,connections:v}),l({description:a("standalone_session_created")})}catch(y){Us(y),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),p=g.useCallback(()=>{u.show({cloneStandaloneSession:f})},[f,u]);return h.jsxs("div",{className:Z("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(tt,{className:"!rounded-none !px-2",onClick:p,variant:"ghost",children:h.jsx(fe,{name:"package-plus",size:16})}):void 0,h.jsx(Xn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(fe,{name:"trash-2",size:16})})]})}),dt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(Sd,{className:Z("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===he.Top?"!top-[-2px]":"",t),...n})}),Iz=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),f=await de("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:Cp.Started,messages:[],session_id:e}),p=await r({source_id:f.id,source_type:"Thread",node_type:ie.Thread,x:u,y:d+60});if(!p)throw new Error("Failed to create thread node");const m=await a({source:i.id,target:p.id});return{thread:f,flowNode:p,flowEdge:m}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},Rz=(e,t)=>{var j;const{t:n}=ke("flows"),{toast:r}=nn(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Bn(e),{loadModel:l}=Em(),{createThread:u,loading:d}=Iz(),f=De(x=>x.updateNodes),p=De(x=>x.pushSyncNodeQueue),{getNodes:m}=br(),y=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const x=await de("Thread").find({where:{initial_llm_id:t.entity.id}});p("Thread",{where:{source_type:"Thread",source_id:qa(x.map(_=>_.id))}})}}finally{s(!1)}},[(j=t==null?void 0:t.entity)==null?void 0:j.id,p]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,_=>{c.data.status=_.progress===100?Je.Loaded:Je.Loading,c.data.label=_.text,f([{id:e,type:"replace",item:c}])}));const x=m().filter(_=>_.type===ie.LLM?_.data.entity.provider===nt.WebLLM:!1).map(_=>(_.data.status=Je.Started,{id:_.id,type:"replace",item:_}));c.data.label="",c.data.status=Je.Loaded,x.push({id:e,type:"replace",item:c}),f(x),await y()}}catch(x){ti(x),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,m,e,l,c,y,n,r,f]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]),w=g.useCallback(async x=>{t.entity&&c&&(c.data.entity.options=x,await de("LLM").update(t.entity.id,{options:x}),f([{id:e,type:"replace",item:c}]))},[t.entity,e,c,f]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,f([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,changeLLMOptions:w,loadModel:v,createThread:b,queryThreads:y}},Fn=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=br();vm({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...wfe(l)])}});const c=g.useCallback(async(l,u,d,f)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:f})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async f=>{const p="edgeId"in f?f.edgeId:void 0,m=s(f.source);if(!m||!d)return;const y=await c(`${p}`,m,d,f);y!=null&&y.deleteEdgeId&&u.push(...Array.isArray(y.deleteEdgeId)?y.deleteEdgeId:[y.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(f=>({id:f}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},Dz=e=>{const t=g.useCallback(async()=>{},[]);Fn(e,t)},Lz=g.memo(e=>{var b,w,j,x,_,S;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=ke("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d,changeLLMOptions:f}=Rz(t,n);Dz(t);const p=[Je.Loading,Je.Downloading].includes(n.status);g.useEffect(()=>{var E,O,M,C,k;if(!(a||!((E=n==null?void 0:n.entity)!=null&&E.name))){if(((O=n==null?void 0:n.entity)==null?void 0:O.provider)!==nt.WebLLM){o({hasCache:!1,cloud:!0,isFunctionCalling:!0,info:{model_id:(M=n==null?void 0:n.entity)==null?void 0:M.name,model:(C=n==null?void 0:n.entity)==null?void 0:C.name,model_lib:(k=n==null?void 0:n.entity)==null?void 0:k.provider,model_type:2}});return}Ht(()=>import("./index-PRjZyF7d.js").then(async T=>(await T.__tla,T)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:T,functionCallingModelIds:P,prebuiltAppConfig:N})=>{var A,R;const I=await T((A=n==null?void 0:n.entity)==null?void 0:A.name);o({hasCache:I,isFunctionCalling:P.includes((R=n==null?void 0:n.entity)==null?void 0:R.name),info:N.model_list.find(L=>{var D;return L.model_id===((D=n==null?void 0:n.entity)==null?void 0:D.name)})})})}},[(b=n==null?void 0:n.entity)==null?void 0:b.name,(w=n==null?void 0:n.entity)==null?void 0:w.provider,a]);const m=g.useCallback(async E=>{await f(E)},[f]),y=g.useMemo(()=>{var E,O;switch(n.status){case Je.Downloading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Je.Loaded:return h.jsx(Pr,{name:((E=n.entity)==null?void 0:E.name)||"brain",className:"w-7 h-7"});case Je.Loading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(Pr,{name:((O=n.entity)==null?void 0:O.name)||"brain",className:"w-7 h-7"})}},[(j=n.entity)==null?void 0:j.name,n.status]),v=g.useMemo(()=>p?null:d?h.jsx(tt,{disabled:!0,className:"w-full mt-4",children:h.jsx(fe,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===Je.Loaded?h.jsx(tt,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Xn,{loading:l,onClick:u,children:h.jsx(fe,{size:24,name:"message-square-more"})}):null,h.jsx(tt,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[p,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Rn,{id:t}),h.jsxs(_a,{className:"flex justify-center",children:[y,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(zo,{className:"flex gap-2 items-center pr-6",children:`${((x=n==null?void 0:n.entity)==null?void 0:x.name)||""}`}),h.jsx(fl,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(rf,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(_=n==null?void 0:n.entity)==null?void 0:_.name,isCached:(a==null?void 0:a.hasCache)||!1,cloud:(a==null?void 0:a.cloud)||!1})}),h.jsx(V9,{llmOptions:(S=n==null?void 0:n.entity)==null?void 0:S.options,onChangeOptions:m,className:"mt-2"}),v]})]}),p?h.jsx(HS,{className:"rounded-lg"}):void 0]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),$y=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=ke("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(en,{className:"min-w-80",children:[h.jsx(Wn,{children:h.jsx(rr,{children:a("add_message_card.title")})}),h.jsxs(Hn,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(y0,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),LE=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===ie.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==ie.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&LE(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},$E=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const f=t.getNode(d.source);return f?{connections:t.getHandleConnections({nodeId:f.id,type:"target"}),node:f}:void 0}),a=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ie.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:f})});const i=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ie.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);f!=null&&f.find(m=>m.type===ie.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:f})});const c=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ie.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);f&&l.push({node:d.node,connections:d.connections,connectedNodes:f})});const u=r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===ie.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===ie.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},FE=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===ie.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new zr(c.content));break;case"ai":t.push(new ka(c.content));break}}else if(r.type===ie.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===pr.FewShotExample){const u=(s=(i=a.find(d=>d.type===ie.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=HG(u.headers,u.csv);d.forEach(f=>{l+=`${c.content.replace(/{([^{}]*)}/g,(p,m)=>`${f[m]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new zr(l));break;case"system":t.push(new Ov(l));break;default:t.push(new ka(l));break}}}}),t},$z=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===ie.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:FE(n),systems:FE(r)}},Fz=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===ie.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],BE=({getNode:e,getHandleConnections:t})=>{const{t:n}=ke("create_new_message"),[r,a]=g.useState(!1),o=et(m=>m.currentSession),i=De(m=>m.createOrUpdateFlowNode),s=De(m=>m.createOrUpdateFlowEdge),c=Vs(m=>m.similaritySearchWithScore),{stream:l}=nl(),u=g.useCallback(async({content:m,threadId:y,sourceId:v,initialX:b,initialY:w,initialLLMId:j})=>{if(!o)throw new Error("Session is not found");const x=await de("Message").save({thread_id:y,content:m,role:fr.Human,status:Wr.Started,llm_id:j,session_id:o.id});if(!x)throw new Error("Failed to save message");const _=await i({source_id:x.id,source_type:"Message",node_type:ie.Message,x:b,y:w+80});if(!_)throw new Error("Failed to save human message node");await s({source:v,target:_.id});const S=await de("Message").save({thread_id:y,content:n("initial_ai_message"),role:fr.AI,status:Wr.Inprogress,llm_id:j,parent_message_id:x.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const E=await i({source_id:S.id,source_type:"Message",node_type:ie.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:_.id,target:E.id}),{aiMessage:S,humanMessage:x,aiMessageNode:E,humanMessageNode:_}},[s,i,o,n]),d=g.useCallback(async(m,y)=>{const{placeholders:v}=y;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,_,S,E,O,M,C,k,T,P,N,I;const j=(x=w.node.data)==null?void 0:x.entity;if(j)switch(j.placeholder_type){case Js.VECTOR_DATABASE_RETREIVER:{const A=(_=w.connectedNodes)==null?void 0:_.find(z=>z.type===ie.VectorDatabase),R=(S=A==null?void 0:A.data)==null?void 0:S.entity,L=(M=(O=(E=w.connectedNodes)==null?void 0:E.find(z=>z.type===ie.Prompt))==null?void 0:O.data)==null?void 0:M.entity;if(!L||!R||!A)return;const D=(C=j.metadata)!=null&&C.k?+((k=j.metadata)==null?void 0:k.k):1;let B=(T=j.metadata)!=null&&T.minimalScore?+((P=j.metadata)==null?void 0:P.minimalScore):void 0;B&&B>1&&(B=B/100);const F=[];if(R.storage===Ur.DataNode){const z=(I=(N=t({nodeId:A.id,type:"target"}).map(X=>e(X.source)).find(X=>(X==null?void 0:X.type)&&[ie.JSONLData,ie.CSVData].includes(X==null?void 0:X.type)))==null?void 0:N.data)==null?void 0:I.entity;if(!z)return;F.push(...await c({databaseId:R.id,dataSourceId:z.id,dataSourceType:FM(z)},m.humanMessage.content,D))}else F.push(...await c({databaseId:R.id},m.humanMessage.content,D));if(!F)return[];const $=new ai({template:L.content,inputVariables:["context"]});b.push(new ka(await $.format({context:B?F.filter(([,z])=>z>=B).map(([z])=>z.pageContent).join(`
`):F.map(([z])=>z.pageContent).join(`
`)})))}}})),b},[t,e,c]),f=g.useCallback(async(m,y,v,{onMessageUpdate:b})=>{var I;const{prompts:w,tools:j,schemas:x,placeholders:_,llm:S}=y,E=(I=S==null?void 0:S.node.data)==null?void 0:I.entity;if(!E)throw new Error("LLM is not found");const O=[];_!=null&&_.length&&O.push(...await d(m,y));const{history:M,systems:C}=$z(v,w),k=[...C,...O,...M,new zr(m.humanMessage.content)],T=x.map(A=>{var R;return(R=A.node.data)==null?void 0:R.entity}).filter(Boolean),{lastChunk:P,content:N}=await l(E.provider,k,{tools:Fz(j),schemas:T,llm:E,onMessageUpdate:({content:A})=>{b==null||b({id:m.aiMessageNode.id,nodeData:{loading:!0,content:A}})}});return m.aiMessage.content=N,m.aiMessage.metadata=JSON.stringify({message:P}),b==null||b({id:m.aiMessageNode.id,nodeData:{content:N,loading:!1,entity:m.aiMessage}}),m.aiMessage.id&&await de("Message").update(m.aiMessage.id,{content:N,metadata:JSON.stringify({message:P})}),N},[d,l]),p=g.useCallback(async(m,y,v)=>{var S,E,O;const{nodes:b}=LE([m.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(M=>M.type===ie.Thread),j=w==null?void 0:w.data.entity;if(!m||!j||!w)throw new Error("Source or thread is not found");const x=$E(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let _;try{a(!0);const M=((S=m.position)==null?void 0:S.x)||0,C=(((E=m.position)==null?void 0:E.y)||0)+(((O=m.measured)==null?void 0:O.height)||0);return _=await u({content:y,initialX:M,initialY:C,sourceId:m.id,threadId:j.id,initialLLMId:j.initial_llm_id}),await f(_,x,b,v),await de("Message").update(`${_.aiMessage.id}`,{status:Wr.Success}),_.aiMessage.status=Wr.Success,v.onMessageUpdate({id:_.aiMessageNode.id,nodeData:{entity:_.aiMessage,loading:!1}}),!0}catch(M){Us(M),_!=null&&_.aiMessage&&await de("Message").update(`${_.aiMessage.id}`,{status:Wr.Failed,content:n("errors.ai_message_content_failed")}),_!=null&&_.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:_.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{..._.aiMessage,status:Wr.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,u,f,n]);return{loading:r,createMessage:p}},Bz=(e,t)=>{const n=Bn(e),{t:r}=ke("flows"),{getNode:a,getHandleConnections:o}=br(),i=De(f=>f.updateNodes),{createMessage:s,loading:c}=BE({getNode:a,getHandleConnections:o}),l=g.useCallback(f=>{if(!f.id)return;const p=a(f.id);!p||!f.nodeData||i([{id:p.id,type:"replace",item:{...p,data:{...p.data,...nd(f.nodeData,rd)}}}])},[a,i]),u=g.useCallback(async f=>{if(n&&t.entity)try{await s(n,f,{onMessageUpdate:l})}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return au({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});au({variant:"destructive",title:`${p}`})}},[n,t.entity,s,l,r]),d=g.useCallback(f=>{const p=a(f);if(!p)return[];const m=[],y=$E(p,{getNode:a,getHandleConnections:o});return y.thread&&m.push({node:y.thread.node,connectedNodes:[],connections:y.thread.connections}),y.prompts&&m.push(...y.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),y.schemas&&m.push(...y.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),y.placeholders&&y.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);m.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),y.llm&&m.push(y.llm),m},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},zz=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.Prompt&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.Schema&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.ToolDefinition&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.VectorDatabase&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.PlaceHolder&&(o==null?void 0:o.type)===ie.Thread&&a.data.entity.placeholder_type===Js.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},Uz=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=ke("flows"),[o,i]=g.useState(!1),s=vm({type:"source"}),c=vm({type:"target"}),{getNode:l}=br(),{loading:u,createMessage:d,getLinkedConnections:f}=Bz(t,n);zz(t);const p=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),m=g.useMemo(()=>s.length>0,[s]),y=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,j;const b=c.map((x,_)=>{var E;const S=l(x.source);if((S==null?void 0:S.type)===ie.Schema)return h.jsx(bn,{children:a("thread_node.structured_output")},`${_}`);if((S==null?void 0:S.type)===ie.Prompt){const O=S.data.entity;return h.jsx(bn,{children:a(O.type===pr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${_}`)}else if((S==null?void 0:S.type)===ie.PlaceHolder&&((E=S.data.entity)==null?void 0:E.placeholder_type)===Js.VECTOR_DATABASE_RETREIVER)return h.jsx(bn,{children:a("thread_node.vector_database_retriever")},`${_}`)}).filter(Boolean);return e.data.entity&&!((j=(w=e.data.entity)==null?void 0:w.messages)!=null&&j.length)&&!m?h.jsx($y,{disabled:u,loading:u,onSubmit:p,tags:b}):b!=null&&b.length?h.jsxs(en,{className:"p-4 pt-2",children:[h.jsx(rr,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(tt,{onClick:y,variant:"outline",children:[h.jsx(fe,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[m,l,p,y,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Rn,{id:t,enableToStandalone:!0,getLinkedConnections:f}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx($y,{disabled:u,loading:u,onSubmit:p})})})]}):void 0]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});function D1e({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=ke("flows");return h.jsxs(_a,{className:"flex min-w-52",children:[h.jsx(fe,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(zo,{children:"Human"}),h.jsx(fl,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(tt,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(fe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}function L1e({data:e,onNewThread:t,loading:n,showThread:r}){var c,l,u,d,f,p,m,y,v;const{t:a}=ke("flows"),o=g.useMemo(()=>{var b;try{return JSON.parse(((b=e==null?void 0:e.entity)==null?void 0:b.metadata)||"{}")}catch{return{}}},[(c=e==null?void 0:e.entity)==null?void 0:c.metadata]),i=e.entity.status===Wr.Failed,s=g.useMemo(()=>{var b;return h.jsx(NS,{source:`${e.content||((b=e.entity)==null?void 0:b.content)||""}`})},[e.content,(l=e.entity)==null?void 0:l.content]);return h.jsxs(_a,{className:Z("flex min-w-52",i?"bg-background":""),variant:i?"destructive":"default",children:[h.jsx(fe,{className:Z(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(fe,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(zo,{children:a(`message_node.message_roles.${(d=(u=e.entity)==null?void 0:u.role)==null?void 0:d.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:i?e.content||((f=e.entity)==null?void 0:f.content)||"":s}),Array.isArray((p=o==null?void 0:o.message)==null?void 0:p.tool_calls)&&((y=(m=o==null?void 0:o.message)==null?void 0:m.tool_calls)!=null&&y.length)?(v=o==null?void 0:o.message)==null?void 0:v.tool_calls.map((b,w)=>h.jsx(bn,{children:a("message_node.tool_call",{name:b.name,args:Object.entries(b.args).map(([j,x])=>`"${j}": "${x}"`).join(", ")})},`${b.name}_${w}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(tt,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(fe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(HS,{size:350,duration:10}):void 0]})}const $1e=e=>{const{t}=ke("flows"),n=Bn(e),r=De(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=br(),{createMessage:i,loading:s}=BE({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...nd(u.nodeData,rd)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return au({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});au({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},Vz=()=>{const e=et(r=>r.currentSession),t=De(r=>r.createOrUpdateFlowNode),n=De(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var m,y,v,b,w;if(!r||!a||!e)return;const s=(y=(m=i==null?void 0:i.promptNode)==null?void 0:m.data)==null?void 0:y.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await de("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||fr.Human,status:Wr.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:ie.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const f=await n({source:r.id,target:d.id});let p;return i!=null&&i.promptNode&&(p=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:p,messageNode:d,messageEdge:f}},[t,n])}},F1e=e=>{const{createIdieMessage:t}=Vz(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===ie.Prompt&&(o==null?void 0:o.type)===ie.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:Cp.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},B1e=g.memo(e=>{var j,x,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=ke("common"),l=vm({type:"source"}),{loading:u,createMessage:d}=$1e(t),{toast:f}=nn();F1e(t);const p=g.useCallback(async(...S)=>{const E=await d(...S);return o(!1),E},[d]),m=g.useMemo(()=>l.length===0,[l]),y=g.useCallback(()=>{var S;(S=n.entity)!=null&&S.content&&(navigator.clipboard.writeText(n.entity.content),f({description:c("copied")}))},[f,n,c]),v=g.useCallback(async()=>{var S;try{if(i)return await $M.stop(),s(!1);s(!0),await $M.speak(((S=n.entity)==null?void 0:S.content)||"")}catch{f({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(j=n.entity)==null?void 0:j.content,i,c,f]),b=g.useCallback(()=>{o(S=>!S)},[]),w=g.useMemo(()=>{var S;if(!(!m&&!a||n.loading||u||((S=n==null?void 0:n.entity)==null?void 0:S.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx($y,{disabled:u,loading:u,onSubmit:p})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,p,m,u,a]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Rn,{id:t}),h.jsx("div",{children:((_=n.entity)==null?void 0:_.role)===fr.Human?h.jsx(D1e,{data:n,showThread:a,onNewThread:m?void 0:b}):h.jsx(L1e,{data:n,showThread:a,loading:u,onNewThread:m?void 0:b})}),h.jsx(tt,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(fe,{name:i?"circle-stop":"speech",size:16})}),h.jsx(tt,{onClick:y,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(fe,{name:"copy",size:16})})]}),w]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),z1e=e=>{const t=De(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=Vz(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,f=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===ie.Message&&(i==null?void 0:i.type)===ie.Prompt){const p=(l=o==null?void 0:o.data)==null?void 0:l.entity,m=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!m||!p||!i)return{deleteEdgeId:a};await n(o,{id:p==null?void 0:p.thread_id,title:"",status:Cp.Started,initial_llm_id:p.llm_id,session_id:m.session_id},m.content,{promptNode:i});return}else if((o==null?void 0:o.type)===ie.CSVData&&(i==null?void 0:i.type)===ie.Prompt&&(d==null?void 0:d.type)===pr.FewShotExample&&(f!=null&&f.headers.includes("input"))&&(f!=null&&f.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);Fn(e,r)},U1e=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;z1e(t);const a=tn(cB),o=g.useMemo(()=>{var f,p,m;return`${(f=n.entity)!=null&&f.prefix?`${(p=n.entity)==null?void 0:p.prefix}
`:""}${((m=n.entity)==null?void 0:m.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var p;const f=/{(.*?)}/g;return((p=o.match(f))==null?void 0:p.map(m=>m.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Rn,{id:t}),h.jsxs(_a,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(fe,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(zo,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(fl,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(fe,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((f,p)=>h.jsx(bn,{className:"mt-2 mr-1",variant:"default",children:f},p)):void 0]})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});var V1e=i3();const Ar=st(V1e);var zE,qz;function q1e(){if(qz)return zE;qz=1;function e(t){return t==null}return zE=e,zE}var W1e=q1e();const wt=st(W1e);var UE,Wz;function H1e(){if(Wz)return UE;Wz=1;var e=Co(),t=zn(),n=Pa(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return UE=a,UE}var K1e=H1e();const hf=st(K1e);var Z1e=wp();const at=st(Z1e);var G1e=qr();const pl=st(G1e);var Hz={exports:{}},xt={},Kz;function X1e(){if(Kz)return xt;Kz=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),m;m=Symbol.for("react.module.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case f:case d:case o:return v;default:return b}}case t:return b}}}return xt.ContextConsumer=i,xt.ContextProvider=o,xt.Element=e,xt.ForwardRef=c,xt.Fragment=n,xt.Lazy=f,xt.Memo=d,xt.Portal=t,xt.Profiler=a,xt.StrictMode=r,xt.Suspense=l,xt.SuspenseList=u,xt.isAsyncMode=function(){return!1},xt.isConcurrentMode=function(){return!1},xt.isContextConsumer=function(v){return y(v)===i},xt.isContextProvider=function(v){return y(v)===o},xt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},xt.isForwardRef=function(v){return y(v)===c},xt.isFragment=function(v){return y(v)===n},xt.isLazy=function(v){return y(v)===f},xt.isMemo=function(v){return y(v)===d},xt.isPortal=function(v){return y(v)===t},xt.isProfiler=function(v){return y(v)===a},xt.isStrictMode=function(v){return y(v)===r},xt.isSuspense=function(v){return y(v)===l},xt.isSuspenseList=function(v){return y(v)===u},xt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===p||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===m||v.getModuleId!==void 0)},xt.typeOf=y,xt}var Zz;function J1e(){return Zz||(Zz=1,Hz.exports=X1e()),Hz.exports}var Y1e=J1e(),VE,Gz;function Xz(){if(Gz)return VE;Gz=1;var e=Co(),t=Pa(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return VE=r,VE}var qE,Jz;function Q1e(){if(Jz)return qE;Jz=1;var e=Xz();function t(n){return e(n)&&n!=+n}return qE=t,qE}var e_e=Q1e();const mf=st(e_e);var t_e=Xz();const n_e=st(t_e);var ja=function(e){return e===0?0:e>0?1:-1},Ss=function(e){return hf(e)&&e.indexOf("%")===e.length-1},ye=function(e){return n_e(e)&&!mf(e)},hn=function(e){return ye(e)||hf(e)},r_e=0,Fy=function(e){var t=++r_e;return"".concat(e||"").concat(t)},Es=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!hf(e))return n;var a;if(Ss(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return mf(a)&&(a=n),r&&a>t&&(a=t),a},Ai=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},a_e=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},hl=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function WE(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Ar(r,t))===n})}function ml(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function HE(e){"@babel/helpers - typeof";return HE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HE(e)}var o_e=["viewBox","children"],i_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Yz=["points","pathLength"],KE={svg:o_e,polygon:Yz,polyline:Yz},ZE=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],By=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!pl(n))return null;var r={};return Object.keys(n).forEach(function(a){ZE.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},s_e=function(e,t,n){return function(r){return e(t,n,r),null}},zy=function(e,t,n){if(!pl(e)||HE(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];ZE.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=s_e(o,t,n))}),r},c_e=["children"],l_e=["children"];function Qz(e,t){if(e==null)return{};var n=u_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var eU={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Vo=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},tU=null,GE=null,XE=function e(t){if(t===tU&&Array.isArray(GE))return GE;var n=[];return g.Children.forEach(t,function(r){wt(r)||(Y1e.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),GE=n,tU=t,n};function Sa(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Vo(a)}):r=[Vo(t)],XE(e).forEach(function(a){var o=Ar(a,"type.displayName")||Ar(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function jr(e,t){var n=Sa(e,t);return n&&n[0]}var nU=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},d_e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],f_e=function(e){return e&&e.type&&hf(e.type)&&d_e.indexOf(e.type)>=0},p_e=function(e,t,n,r){var a,o=(a=KE==null?void 0:KE[r])!==null&&a!==void 0?a:[];return!at(e)&&(r&&o.includes(t)||i_e.includes(t))||n&&ZE.includes(t)},bt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!pl(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;p_e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},JE=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return rU(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!rU(o,i))return!1}return!0},rU=function(e,t){if(wt(e)&&wt(t))return!0;if(!wt(e)&&!wt(t)){var n=e.props||{},r=n.children,a=Qz(n,c_e),o=t.props||{},i=o.children,s=Qz(o,l_e);return r&&i?ml(a,s)&&JE(r,i):!r&&!i?ml(a,s):!1}return!1},aU=function(e,t){var n=[],r={};return XE(e).forEach(function(a,o){if(f_e(a))n.push(a);else if(a){var i=Vo(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},h_e=function(e){var t=e&&e.type;return t&&eU[t]?eU[t]:null},m_e=function(e,t){return XE(t).indexOf(e)},y_e=["children","width","height","viewBox","className","style","title","desc"];function YE(){return YE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YE.apply(this,arguments)}function g_e(e,t){if(e==null)return{};var n=v_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function v_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function QE(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=g_e(e,y_e),u=a||{width:n,height:r,x:0,y:0},d=St("recharts-surface",o);return H.createElement("svg",YE({},bt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),H.createElement("title",null,s),H.createElement("desc",null,c),t)}var b_e=["children","className"];function eO(){return eO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eO.apply(this,arguments)}function w_e(e,t){if(e==null)return{};var n=x_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var wn=H.forwardRef(function(e,t){var n=e.children,r=e.className,a=w_e(e,b_e),o=St("recharts-layer",r);return H.createElement("g",eO({className:o},bt(a,!0),{ref:t}),n)}),qo=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},tO,oU;function __e(){if(oU)return tO;oU=1;var e=M0();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return tO=t,tO}var nO,iU;function sU(){if(iU)return nO;iU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return nO=c,nO}var rO,cU;function j_e(){if(cU)return rO;cU=1;function e(t){return t.split("")}return rO=e,rO}var aO,lU;function S_e(){if(lU)return aO;lU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",f="[\uD800-\uDBFF][\uDC00-\uDFFF]",p="\\u200d",m=l+"?",y="["+o+"]?",v="(?:"+p+"(?:"+[u,d,f].join("|")+")"+y+m+")*",b=y+m+v,w="(?:"+[u+s+"?",s,d,f,i].join("|")+")",j=RegExp(c+"(?="+c+")|"+w+b,"g");function x(_){return _.match(j)||[]}return aO=x,aO}var oO,uU;function E_e(){if(uU)return oO;uU=1;var e=j_e(),t=sU(),n=S_e();function r(a){return t(a)?n(a):e(a)}return oO=r,oO}var iO,dU;function O_e(){if(dU)return iO;dU=1;var e=__e(),t=sU(),n=E_e(),r=t3();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return iO=a,iO}var sO,fU;function C_e(){if(fU)return sO;fU=1;var e=O_e(),t=e("toUpperCase");return sO=t,sO}var N_e=C_e();const Uy=st(N_e);function $t(e){return function(){return e}}const pU=Math.cos,Vy=Math.sin,Ea=Math.sqrt,qy=Math.PI,Wy=2*qy,cO=Math.PI,lO=2*cO,Os=1e-6,M_e=lO-Os;function hU(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function k_e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hU;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class P_e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hU:k_e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>Os)if(!(Math.abs(d*c-l*u)>Os)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-i,m=a-s,y=c*c+l*l,v=p*p+m*m,b=Math.sqrt(y),w=Math.sqrt(f),j=o*Math.tan((cO-Math.acos((y+f-v)/(2*b*w)))/2),x=j/w,_=j/b;Math.abs(x-1)>Os&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*p>u*m)},${this._x1=t+_*c},${this._y1=n+_*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,f=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Os||Math.abs(this._y1-u)>Os)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%lO+lO),f>M_e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:f>Os&&this._append`A${r},${r},0,${+(f>=cO)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function uO(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new P_e(t)}function dO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mU(e){this._context=e}mU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Hy(e){return new mU(e)}function yU(e){return e[0]}function gU(e){return e[1]}function vU(e,t){var n=$t(!0),r=null,a=Hy,o=null,i=uO(s);e=typeof e=="function"?e:e===void 0?yU:$t(e),t=typeof t=="function"?t:t===void 0?gU:$t(t);function s(c){var l,u=(c=dO(c)).length,d,f=!1,p;for(r==null&&(o=a(p=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(d,l,c),+t(d,l,c));if(p)return o=null,p+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:$t(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:$t(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:$t(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Ky(e,t,n){var r=null,a=$t(!0),o=null,i=Hy,s=null,c=uO(l);e=typeof e=="function"?e:e===void 0?yU:$t(+e),t=typeof t=="function"?t:$t(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?gU:$t(+n);function l(d){var f,p,m,y=(d=dO(d)).length,v,b=!1,w,j=new Array(y),x=new Array(y);for(o==null&&(s=i(w=c())),f=0;f<=y;++f){if(!(f<y&&a(v=d[f],f,d))===b)if(b=!b)p=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),m=f-1;m>=p;--m)s.point(j[m],x[m]);s.lineEnd(),s.areaEnd()}b&&(j[f]=+e(v,f,d),x[f]=+t(v,f,d),s.point(r?+r(v,f,d):j[f],n?+n(v,f,d):x[f]))}if(w)return s=null,w+""||null}function u(){return vU().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:$t(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:$t(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:$t(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:$t(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:$t(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class bU{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function A_e(e){return new bU(e,!0)}function T_e(e){return new bU(e,!1)}const fO={draw(e,t){const n=Ea(t/qy);e.moveTo(n,0),e.arc(0,0,n,0,Wy)}},I_e={draw(e,t){const n=Ea(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},wU=Ea(1/3),R_e=wU*2,D_e={draw(e,t){const n=Ea(t/R_e),r=n*wU;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},L_e={draw(e,t){const n=Ea(t),r=-n/2;e.rect(r,r,n,n)}},$_e=.8908130915292852,xU=Vy(qy/10)/Vy(7*qy/10),F_e=Vy(Wy/10)*xU,B_e=-pU(Wy/10)*xU,z_e={draw(e,t){const n=Ea(t*$_e),r=F_e*n,a=B_e*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Wy*o/5,s=pU(i),c=Vy(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},pO=Ea(3),U_e={draw(e,t){const n=-Ea(t/(pO*3));e.moveTo(0,n*2),e.lineTo(-pO*n,-n),e.lineTo(pO*n,-n),e.closePath()}},Tr=-.5,Ir=Ea(3)/2,hO=1/Ea(12),V_e=(hO/2+1)*3,q_e={draw(e,t){const n=Ea(t/V_e),r=n/2,a=n*hO,o=r,i=n*hO+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(Tr*r-Ir*a,Ir*r+Tr*a),e.lineTo(Tr*o-Ir*i,Ir*o+Tr*i),e.lineTo(Tr*s-Ir*c,Ir*s+Tr*c),e.lineTo(Tr*r+Ir*a,Tr*a-Ir*r),e.lineTo(Tr*o+Ir*i,Tr*i-Ir*o),e.lineTo(Tr*s+Ir*c,Tr*c-Ir*s),e.closePath()}};function W_e(e,t){let n=null,r=uO(a);e=typeof e=="function"?e:$t(e||fO),t=typeof t=="function"?t:$t(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:$t(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:$t(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function Zy(){}function Gy(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function _U(e){this._context=e}_U.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function H_e(e){return new _U(e)}function jU(e){this._context=e}jU.prototype={areaStart:Zy,areaEnd:Zy,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Gy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function K_e(e){return new jU(e)}function SU(e){this._context=e}SU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Gy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Z_e(e){return new SU(e)}function EU(e){this._context=e}EU.prototype={areaStart:Zy,areaEnd:Zy,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function G_e(e){return new EU(e)}function OU(e){return e<0?-1:1}function CU(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(OU(o)+OU(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function NU(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function mO(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function Xy(e){this._context=e}Xy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:mO(this,this._t0,NU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,mO(this,NU(this,n=CU(this,e,t)),n);break;default:mO(this,this._t0,n=CU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function MU(e){this._context=new kU(e)}(MU.prototype=Object.create(Xy.prototype)).point=function(e,t){Xy.prototype.point.call(this,t,e)};function kU(e){this._context=e}kU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function X_e(e){return new Xy(e)}function J_e(e){return new MU(e)}function PU(e){this._context=e}PU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=AU(e),a=AU(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AU(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function Y_e(e){return new PU(e)}function Jy(e,t){this._context=e,this._t=t}Jy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Q_e(e){return new Jy(e,.5)}function eje(e){return new Jy(e,0)}function tje(e){return new Jy(e,1)}function yl(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function yO(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function nje(e,t){return e[t]}function rje(e){const t=[];return t.key=e,t}function aje(){var e=$t([]),t=yO,n=yl,r=nje;function a(o){var i=Array.from(e.apply(this,arguments),rje),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=dO(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:$t(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:$t(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?yO:typeof o=="function"?o:$t(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??yl,a):n},a}function oje(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}yl(e,t)}}function ije(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}yl(e,t)}}function sje(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,p=(d-f)/2,m=0;m<s;++m){var y=e[t[m]],v=y[r][1]||0,b=y[r-1][1]||0;p+=v-b}c+=d,l+=p*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,yl(e,t)}}function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}var cje=["type","size","sizeType"];function gO(){return gO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gO.apply(this,arguments)}function TU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TU(Object(n),!0).forEach(function(r){lje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lje(e,t,n){return t=uje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uje(e){var t=dje(e,"string");return yf(t)=="symbol"?t:t+""}function dje(e,t){if(yf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(yf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fje(e,t){if(e==null)return{};var n=pje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var RU={symbolCircle:fO,symbolCross:I_e,symbolDiamond:D_e,symbolSquare:L_e,symbolStar:z_e,symbolTriangle:U_e,symbolWye:q_e},hje=Math.PI/180,mje=function(e){var t="symbol".concat(Uy(e));return RU[t]||fO},yje=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*hje;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},gje=function(e,t){RU["symbol".concat(Uy(e))]=t},vO=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=fje(e,cje),c=IU(IU({},s),{},{type:n,size:a,sizeType:i}),l=function(){var m=mje(n),y=W_e().type(m).size(yje(a,i,n));return y()},u=c.className,d=c.cx,f=c.cy,p=bt(c,!0);return d===+d&&f===+f&&a===+a?H.createElement("path",gO({},p,{className:St("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};vO.registerSymbol=gje;function gl(e){"@babel/helpers - typeof";return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(e)}function bO(){return bO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bO.apply(this,arguments)}function DU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vje(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DU(Object(n),!0).forEach(function(r){gf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function bje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$U(r.key),r)}}function xje(e,t,n){return t&&wje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _je(e,t,n){return t=Yy(t),jje(e,LU()?Reflect.construct(t,n||[],Yy(e).constructor):t.apply(e,n))}function jje(e,t){if(t&&(gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sje(e)}function Sje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LU=function(){return!!e})()}function Yy(e){return Yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yy(e)}function Eje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wO(e,t)}function wO(e,t){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},wO(e,t)}function gf(e,t,n){return t=$U(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $U(e){var t=Oje(e,"string");return gl(t)=="symbol"?t:t+""}function Oje(e,t){if(gl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rr=32,xO=function(e){function t(){return bje(this,t),_je(this,t,arguments)}return Eje(t,e),xje(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Rr/2,o=Rr/6,i=Rr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return H.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Rr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return H.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Rr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return H.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Rr/8,"h").concat(Rr,"v").concat(Rr*3/4,"h").concat(-Rr,"z"),className:"recharts-legend-icon"});if(H.isValidElement(n.legendIcon)){var c=vje({},n);return delete c.legendIcon,H.cloneElement(n.legendIcon,c)}return H.createElement(vO,{fill:s,cx:a,cy:a,size:Rr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Rr,height:Rr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(f,p){var m=f.formatter||s,y=St(gf(gf({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=at(f.value)?null:f.value;qo(!at(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return H.createElement("li",bO({className:y,style:u,key:"legend-item-".concat(p)},zy(n.props,f,p)),H.createElement(QE,{width:o,height:o,viewBox:l,style:d},n.renderIcon(f)),H.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},m?m(v,f,p):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return H.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);gf(xO,"displayName","Legend"),gf(xO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var _O,FU;function BU(){if(FU)return _O;FU=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return _O=e,_O}var jO,zU;function Cje(){if(zU)return jO;zU=1;function e(t){return t!==t}return jO=e,jO}var SO,UU;function Nje(){if(UU)return SO;UU=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return SO=e,SO}var EO,VU;function Mje(){if(VU)return EO;VU=1;var e=BU(),t=Cje(),n=Nje();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return EO=r,EO}var OO,qU;function kje(){if(qU)return OO;qU=1;var e=Mje();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return OO=t,OO}var CO,WU;function Pje(){if(WU)return CO;WU=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return CO=e,CO}var NO,HU;function Aje(){if(HU)return NO;HU=1;function e(){}return NO=e,NO}var MO,KU;function Tje(){if(KU)return MO;KU=1;var e=ID(),t=Aje(),n=_x(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return MO=a,MO}var kO,ZU;function Ije(){if(ZU)return kO;ZU=1;var e=VR(),t=kje(),n=Pje(),r=KR(),a=Tje(),o=_x(),i=200;function s(c,l,u){var d=-1,f=t,p=c.length,m=!0,y=[],v=y;if(u)m=!1,f=n;else if(p>=i){var b=l?null:a(c);if(b)return o(b);m=!1,f=r,v=new e}else v=l?[]:y;e:for(;++d<p;){var w=c[d],j=l?l(w):w;if(w=u||w!==0?w:0,m&&j===j){for(var x=v.length;x--;)if(v[x]===j)continue e;l&&v.push(j),y.push(w)}else f(v,j,u)||(v!==y&&v.push(j),y.push(w))}return y}return kO=s,kO}var PO,GU;function Rje(){if(GU)return PO;GU=1;var e=Fa(),t=Ije();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return PO=n,PO}var Dje=Rje();const XU=st(Dje);function JU(e,t,n){return t===!0?XU(e,n):at(t)?XU(e,t):e}function vl(e){"@babel/helpers - typeof";return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vl(e)}var Lje=["ref"];function YU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Wo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(n),!0).forEach(function(r){eg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tV(r.key),r)}}function Fje(e,t,n){return t&&QU(e.prototype,t),n&&QU(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bje(e,t,n){return t=Qy(t),zje(e,eV()?Reflect.construct(t,n||[],Qy(e).constructor):t.apply(e,n))}function zje(e,t){if(t&&(vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uje(e)}function Uje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eV=function(){return!!e})()}function Qy(e){return Qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qy(e)}function Vje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},AO(e,t)}function eg(e,t,n){return t=tV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tV(e){var t=qje(e,"string");return vl(t)=="symbol"?t:t+""}function qje(e,t){if(vl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wje(e,t){if(e==null)return{};var n=Hje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Hje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Kje(e){return e.value}function Zje(e,t){if(H.isValidElement(e))return H.cloneElement(e,t);if(typeof e=="function")return H.createElement(e,t);t.ref;var n=Wje(t,Lje);return H.createElement(xO,n)}var nV=1,bl=function(e){function t(){var n;$je(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=Bje(this,t,[].concat(a)),eg(n,"lastBoundingBox",{width:-1,height:-1}),n}return Vje(t,e),Fje(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>nV||Math.abs(r.height-this.lastBoundingBox.height)>nV)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Wo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var f=this.getBBoxSnapshot();u={left:((c||0)-f.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var p=this.getBBoxSnapshot();d={top:((l||0)-p.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return Wo(Wo({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=Wo(Wo({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return H.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},Zje(a,Wo(Wo({},this.props),{},{payload:JU(l,c,Kje)})))}}],[{key:"getWithHeight",value:function(n,r){var a=Wo(Wo({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);eg(bl,"displayName","Legend"),eg(bl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var TO,rV;function Gje(){if(rV)return TO;rV=1;var e=Gs(),t=bp(),n=zn(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return TO=a,TO}var IO,aV;Nv=function(){if(aV)return IO;aV=1;var e=Ex(),t=Gje();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return IO=n,IO};var RO,oV;function Xje(){if(oV)return RO;oV=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return RO=e,RO}var DO,iV;qM=function(){if(iV)return DO;iV=1;var e=Xje(),t=e();return DO=t,DO};var LO,sV;function cV(){if(sV)return LO;sV=1;var e=qM(),t=fu();function n(r,a){return r&&e(r,a,t)}return LO=n,LO}var $O,lV;function Jje(){if(lV)return $O;lV=1;var e=Wi();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return $O=t,$O}var FO,uV;function BO(){if(uV)return FO;uV=1;var e=cV(),t=Jje(),n=t(e);return FO=n,FO}var zO,dV;function fV(){if(dV)return zO;dV=1;var e=BO(),t=Wi();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return zO=n,zO}var UO,pV;function Yje(){if(pV)return UO;pV=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return UO=e,UO}var VO,hV;function Qje(){if(hV)return VO;hV=1;var e=yc();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return VO=t,VO}var qO,mV;function eSe(){if(mV)return qO;mV=1;var e=Qje();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return qO=t,qO}var WO,yV;function tSe(){if(yV)return WO;yV=1;var e=iu(),t=mu(),n=Fa(),r=fV(),a=Yje(),o=O0(),i=eSe(),s=gc(),c=zn();function l(u,d,f){d.length?d=e(d,function(y){return c(y)?function(v){return t(v,y.length===1?y[0]:y)}:y}):d=[s];var p=-1;d=e(d,o(n));var m=r(u,function(y,v,b){var w=e(d,function(j){return j(y)});return{criteria:w,index:++p,value:y}});return a(m,function(y,v){return i(y,v,f)})}return WO=l,WO}var HO,gV;YM=function(){if(gV)return HO;gV=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return HO=e,HO};var KO,vV;VM=function(){if(vV)return KO;vV=1;var e=YM(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return KO=n,KO};var ZO,bV;function nSe(){if(bV)return ZO;bV=1;function e(t){return function(){return t}}return ZO=e,ZO}var GO,wV;function rSe(){if(wV)return GO;wV=1;var e=nSe(),t=v3(),n=gc(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return GO=r,GO}var XO,xV;function aSe(){if(xV)return XO;xV=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return XO=r,XO}var JO,_V;UM=function(){if(_V)return JO;_V=1;var e=rSe(),t=aSe(),n=t(e);return JO=n,JO};var YO,jV;WM=function(){if(jV)return YO;jV=1;var e=gc(),t=VM(),n=UM();function r(a,o){return n(t(a,o,e),a+"")}return YO=r,YO};var QO,SV;function oSe(){if(SV)return QO;SV=1;var e=Nv(),t=tSe(),n=WM(),r=qs(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return QO=a,QO}var iSe=oSe();const eC=st(iSe);function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function tC(){return tC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tC.apply(this,arguments)}function sSe(e,t){return dSe(e)||uSe(e,t)||lSe(e,t)||cSe()}function cSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lSe(e,t){if(e){if(typeof e=="string")return EV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EV(e,t)}}function EV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function dSe(e){if(Array.isArray(e))return e}function OV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function nC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OV(Object(n),!0).forEach(function(r){fSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fSe(e,t,n){return t=pSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pSe(e){var t=hSe(e,"string");return vf(t)=="symbol"?t:t+""}function hSe(e,t){if(vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mSe(e){return Array.isArray(e)&&hn(e[0])&&hn(e[1])?e.join(" ~ "):e}var ySe=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,m=e.label,y=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var C={padding:0,margin:0},k=(d?eC(l,d):l).map(function(T,P){if(T.type==="none")return null;var N=nC({display:"block",paddingTop:4,paddingBottom:4,color:T.color||"#000"},i),I=T.formatter||u||mSe,A=T.value,R=T.name,L=A,D=R;if(I&&L!=null&&D!=null){var B=I(A,R,T,P,l);if(Array.isArray(B)){var F=sSe(B,2);L=F[0],D=F[1]}else L=B}return H.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:N},hn(D)?H.createElement("span",{className:"recharts-tooltip-item-name"},D):null,hn(D)?H.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,H.createElement("span",{className:"recharts-tooltip-item-value"},L),H.createElement("span",{className:"recharts-tooltip-item-unit"},T.unit||""))});return H.createElement("ul",{className:"recharts-tooltip-item-list",style:C},k)}return null},j=nC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=nC({margin:0},c),_=!wt(m),S=_?m:"",E=St("recharts-default-tooltip",f),O=St("recharts-tooltip-label",p);_&&y&&l!==void 0&&l!==null&&(S=y(m,l));var M=b?{role:"status","aria-live":"assertive"}:{};return H.createElement("div",tC({className:E,style:j},M),H.createElement("p",{className:O,style:x},H.isValidElement(S)?S:"".concat(S)),w())};function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function tg(e,t,n){return t=gSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gSe(e){var t=vSe(e,"string");return bf(t)=="symbol"?t:t+""}function vSe(e,t){if(bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wf="recharts-tooltip-wrapper",bSe={visibility:"hidden"};function wSe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return St(wf,tg(tg(tg(tg({},"".concat(wf,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(wf,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(wf,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(wf,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function CV(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var f=u,p=c[r];return f<p?Math.max(d,c[r]):Math.max(u,c[r])}var m=d+s,y=c[r]+l;return m>y?Math.max(u,c[r]):Math.max(d,c[r])}function xSe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function _Se(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=CV({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=CV({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=xSe({translateX:u,translateY:d,useTranslate3d:s})):l=bSe,{cssProperties:l,cssClasses:wSe({translateX:u,translateY:d,coordinate:n})}}function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function NV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function MV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NV(Object(n),!0).forEach(function(r){aC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SSe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,PV(r.key),r)}}function ESe(e,t,n){return t&&SSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function OSe(e,t,n){return t=ng(t),CSe(e,kV()?Reflect.construct(t,n||[],ng(e).constructor):t.apply(e,n))}function CSe(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NSe(e)}function NSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kV=function(){return!!e})()}function ng(e){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ng(e)}function MSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rC(e,t)}function rC(e,t){return rC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},rC(e,t)}function aC(e,t,n){return t=PV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PV(e){var t=kSe(e,"string");return wl(t)=="symbol"?t:t+""}function kSe(e,t){if(wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AV=1,PSe=function(e){function t(){var n;jSe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=OSe(this,t,[].concat(a)),aC(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),aC(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return MSe(t,e),ESe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>AV||Math.abs(n.height-this.state.lastBoundingBox.height)>AV)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,f=r.offset,p=r.position,m=r.reverseDirection,y=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=_Se({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:f,position:p,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:v}),j=w.cssClasses,x=w.cssProperties,_=MV(MV({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return H.createElement("div",{tabIndex:-1,className:j,style:_,ref:function(S){n.wrapperNode=S}},c)}}])}(g.PureComponent),ASe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ti={isSsr:ASe(),get:function(e){return Ti[e]},set:function(e,t){if(typeof e=="string")Ti[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){Ti[r]=e[r]})}}};function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function TV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TV(Object(n),!0).forEach(function(r){iC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ISe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DV(r.key),r)}}function RSe(e,t,n){return t&&ISe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DSe(e,t,n){return t=rg(t),LSe(e,RV()?Reflect.construct(t,n||[],rg(e).constructor):t.apply(e,n))}function LSe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Se(e)}function $Se(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RV=function(){return!!e})()}function rg(e){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rg(e)}function FSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oC(e,t)}function oC(e,t){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},oC(e,t)}function iC(e,t,n){return t=DV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DV(e){var t=BSe(e,"string");return xl(t)=="symbol"?t:t+""}function BSe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zSe(e){return e.dataKey}function USe(e,t){return H.isValidElement(e)?H.cloneElement(e,t):typeof e=="function"?H.createElement(e,t):H.createElement(ySe,t)}var Ja=function(e){function t(){return TSe(this,t),DSe(this,t,arguments)}return FSe(t,e),RSe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,f=r.offset,p=r.payload,m=r.payloadUniqBy,y=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,j=r.wrapperStyle,x=p??[];u&&x.length&&(x=JU(p.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),m,zSe));var _=x.length>0;return H.createElement(PSe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:_,offset:f,position:y,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:j},USe(c,IV(IV({},this.props),{},{payload:x})))}}])}(g.PureComponent);iC(Ja,"displayName","Tooltip"),iC(Ja,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ti.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var sC,LV;function VSe(){if(LV)return sC;LV=1;var e=Vr(),t=function(){return e.Date.now()};return sC=t,sC}var cC,$V;GM=function(){if($V)return cC;$V=1;var e=qr(),t=VSe(),n=hB(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,f,p,m,y,v=0,b=!1,w=!1,j=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,f=w?a(n(l.maxWait)||0,c):f,j="trailing"in l?!!l.trailing:j);function x(P){var N=u,I=d;return u=d=void 0,v=P,p=s.apply(I,N),p}function _(P){return v=P,m=setTimeout(O,c),b?x(P):p}function S(P){var N=P-y,I=P-v,A=c-N;return w?o(A,f-I):A}function E(P){var N=P-y,I=P-v;return y===void 0||N>=c||N<0||w&&I>=f}function O(){var P=t();if(E(P))return M(P);m=setTimeout(O,S(P))}function M(P){return m=void 0,j&&u?x(P):(u=d=void 0,p)}function C(){m!==void 0&&clearTimeout(m),v=0,u=y=d=m=void 0}function k(){return m===void 0?p:M(t())}function T(){var P=t(),N=E(P);if(u=arguments,d=this,y=P,N){if(m===void 0)return _(y);if(w)return clearTimeout(m),m=setTimeout(O,c),x(y)}return m===void 0&&(m=setTimeout(O,c)),p}return T.cancel=C,T.flush=k,T}return cC=i,cC};var lC,FV;function qSe(){if(FV)return lC;FV=1;var e=GM(),t=qr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return lC=r,lC}var WSe=qSe();Pv=st(WSe);function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function BV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ag(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BV(Object(n),!0).forEach(function(r){HSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function HSe(e,t,n){return t=KSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KSe(e){var t=ZSe(e,"string");return xf(t)=="symbol"?t:t+""}function ZSe(e,t){if(xf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GSe(e,t){return QSe(e)||YSe(e,t)||JSe(e,t)||XSe()}function XSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JSe(e,t){if(e){if(typeof e=="string")return zV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zV(e,t)}}function zV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function YSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function QSe(e){if(Array.isArray(e))return e}var eEe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,f=e.maxHeight,p=e.children,m=e.debounce,y=m===void 0?0:m,v=e.id,b=e.className,w=e.onResize,j=e.style,x=j===void 0?{}:j,_=g.useRef(null),S=g.useRef();S.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=GSe(E,2),M=O[0],C=O[1],k=g.useCallback(function(P,N){C(function(I){var A=Math.round(P),R=Math.round(N);return I.containerWidth===A&&I.containerHeight===R?I:{containerWidth:A,containerHeight:R}})},[]);g.useEffect(function(){var P=function(L){var D,B=L[0].contentRect,F=B.width,$=B.height;k(F,$),(D=S.current)===null||D===void 0||D.call(S,F,$)};y>0&&(P=Pv(P,y,{trailing:!0,leading:!1}));var N=new ResizeObserver(P),I=_.current.getBoundingClientRect(),A=I.width,R=I.height;return k(A,R),N.observe(_.current),function(){N.disconnect()}},[k,y]);var T=g.useMemo(function(){var P=M.containerWidth,N=M.containerHeight;if(P<0||N<0)return null;qo(Ss(i)||Ss(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),qo(!n||n>0,"The aspect(%s) must be greater than zero.",n);var I=Ss(i)?P:i,A=Ss(c)?N:c;n&&n>0&&(I?A=I/n:A&&(I=A*n),f&&A>f&&(A=f)),qo(I>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,A,i,c,u,d,n);var R=!Array.isArray(p)&&Vo(p.type).endsWith("Chart");return H.Children.map(p,function(L){return H.isValidElement(L)?g.cloneElement(L,ag({width:I,height:A},R?{style:ag({height:"100%",width:"100%",maxHeight:A,maxWidth:I},L.props.style)}:{})):L})},[n,p,c,f,d,u,M,i]);return H.createElement("div",{id:v?"".concat(v):void 0,className:St("recharts-responsive-container",b),style:ag(ag({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:f}),ref:_},T)}),UV=function(e){return null};UV.displayName="Cell";function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function VV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VV(Object(n),!0).forEach(function(r){tEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tEe(e,t,n){return t=nEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nEe(e){var t=rEe(e,"string");return _f(t)=="symbol"?t:t+""}function rEe(e,t){if(_f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _l={widthCache:{},cacheCount:0},aEe=2e3,oEe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},qV="recharts_measurement_span";function iEe(e){var t=uC({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var jf=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Ti.isSsr)return{width:0,height:0};var n=iEe(t),r=JSON.stringify({text:e,copyStyle:n});if(_l.widthCache[r])return _l.widthCache[r];try{var a=document.getElementById(qV);a||(a=document.createElement("span"),a.setAttribute("id",qV),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=uC(uC({},oEe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return _l.widthCache[r]=s,++_l.cacheCount>aEe&&(_l.cacheCount=0,_l.widthCache={}),s}catch{return{width:0,height:0}}},sEe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function og(e,t){return dEe(e)||uEe(e,t)||lEe(e,t)||cEe()}function cEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lEe(e,t){if(e){if(typeof e=="string")return WV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WV(e,t)}}function WV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function dEe(e){if(Array.isArray(e))return e}function fEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hEe(r.key),r)}}function pEe(e,t,n){return t&&HV(e.prototype,t),n&&HV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hEe(e){var t=mEe(e,"string");return Sf(t)=="symbol"?t:t+""}function mEe(e,t){if(Sf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Sf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var KV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ZV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yEe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,gEe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,GV={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},vEe=Object.keys(GV),jl="NaN";function bEe(e,t){return e*GV[t]}var ig=function(){function e(t,n){fEe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!yEe.test(n)&&(this.num=NaN,this.unit=""),vEe.includes(n)&&(this.num=bEe(t,n),this.unit="px")}return pEe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=gEe.exec(t))!==null&&n!==void 0?n:[],a=og(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function XV(e){if(e.includes(jl))return jl;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=KV.exec(t))!==null&&n!==void 0?n:[],a=og(r,4),o=a[1],i=a[2],s=a[3],c=ig.parse(o??""),l=ig.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return jl;t=t.replace(KV,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,f=(d=ZV.exec(t))!==null&&d!==void 0?d:[],p=og(f,4),m=p[1],y=p[2],v=p[3],b=ig.parse(m??""),w=ig.parse(v??""),j=y==="+"?b.add(w):b.subtract(w);if(j.isNaN())return jl;t=t.replace(ZV,j.toString())}return t}var JV=/\(([^()]*)\)/;function wEe(e){for(var t=e;t.includes("(");){var n=JV.exec(t),r=og(n,2),a=r[1];t=t.replace(JV,XV(a))}return t}function xEe(e){var t=e.replace(/\s+/g,"");return t=wEe(t),t=XV(t),t}function _Ee(e){try{return xEe(e)}catch{return jl}}function dC(e){var t=_Ee(e.slice(5,-1));return t===jl?"":t}var jEe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],SEe=["dx","dy","angle","className","breakAll"];function fC(){return fC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fC.apply(this,arguments)}function YV(e,t){if(e==null)return{};var n=EEe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function QV(e,t){return MEe(e)||NEe(e,t)||CEe(e,t)||OEe()}function OEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CEe(e,t){if(e){if(typeof e=="string")return eq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eq(e,t)}}function eq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function MEe(e){if(Array.isArray(e))return e}var tq=/[ \f\n\r\t\v\u2028\u2029]+/,nq=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];wt(t)||(n?a=t.toString().split(""):a=t.toString().split(tq));var o=a.map(function(s){return{word:s,width:jf(s,r).width}}),i=n?0:jf("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},kEe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.reduce(function(N,I){var A=I.word,R=I.width,L=N[N.length-1];if(L&&(r==null||a||L.width+R+n<Number(r)))L.words.push(A),L.width+=R+n;else{var D={words:[A],width:R};N.push(D)}return N},[])},f=d(t),p=function(P){return P.reduce(function(N,I){return N.width>I.width?N:I})};if(!l)return f;for(var m="\u2026",y=function(P){var N=u.slice(0,P),I=nq({breakAll:c,style:s,children:N+m}).wordsWithComputedWidth,A=d(I),R=A.length>o||p(A).width>Number(r);return[R,A]},v=0,b=u.length-1,w=0,j;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),_=x-1,S=y(_),E=QV(S,2),O=E[0],M=E[1],C=y(x),k=QV(C,1),T=k[0];if(!O&&!T&&(v=x+1),O&&T&&(b=x-1),!O&&T){j=M;break}w++}return j||f},rq=function(e){var t=wt(e)?[]:e.toString().split(tq);return[{words:t}]},PEe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!Ti.isSsr){var s,c,l=nq({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return rq(r);return kEe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return rq(r)},aq="#808080",sg=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,f=d===void 0?"start":d,p=e.verticalAnchor,m=p===void 0?"end":p,y=e.fill,v=y===void 0?aq:y,b=YV(e,jEe),w=g.useMemo(function(){return PEe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),j=b.dx,x=b.dy,_=b.angle,S=b.className,E=b.breakAll,O=YV(b,SEe);if(!hn(n)||!hn(a))return null;var M=n+(ye(j)?j:0),C=a+(ye(x)?x:0),k;switch(m){case"start":k=dC("calc(".concat(c,")"));break;case"middle":k=dC("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:k=dC("calc(".concat(w.length-1," * -").concat(i,")"));break}var T=[];if(u){var P=w[0].width,N=b.width;T.push("scale(".concat((ye(N)?N/P:1)/P,")"))}return _&&T.push("rotate(".concat(_,", ").concat(M,", ").concat(C,")")),T.length&&(O.transform=T.join(" ")),H.createElement("text",fC({},bt(O,!0),{x:M,y:C,className:St("recharts-text",S),textAnchor:f,fill:v.includes("url")?aq:v}),w.map(function(I,A){var R=I.words.join(E?"":" ");return H.createElement("tspan",{x:M,dy:A===0?k:i,key:"".concat(R,"-").concat(A)},R)}))};function Ii(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function AEe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pC(e){let t,n,r;e.length!==2?(t=Ii,n=(s,c)=>Ii(e(s),c),r=(s,c)=>e(s)-c):(t=e===Ii||e===AEe?e:TEe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function TEe(){return 0}function oq(e){return e===null?NaN:+e}function*IEe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const REe=pC(Ii),Ef=REe.right;pC(oq).center;class iq extends Map{constructor(t,n=$Ee){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(sq(this,t))}has(t){return super.has(sq(this,t))}set(t,n){return super.set(DEe(this,t),n)}delete(t){return super.delete(LEe(this,t))}}function sq({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function DEe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function LEe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function $Ee(e){return e!==null&&typeof e=="object"?e.valueOf():e}function FEe(e=Ii){if(e===Ii)return cq;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function cq(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const BEe=Math.sqrt(50),zEe=Math.sqrt(10),UEe=Math.sqrt(2);function cg(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=BEe?10:o>=zEe?5:o>=UEe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?cg(e,t,n*2):[s,c,l]}function hC(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?cg(t,e,n):cg(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function mC(e,t,n){return t=+t,e=+e,n=+n,cg(e,t,n)[2]}function yC(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?mC(t,e,n):mC(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function lq(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function uq(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function dq(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?cq:FEe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),p=Math.max(n,Math.floor(t-l*d/c+f)),m=Math.min(r,Math.floor(t+(c-l)*d/c+f));dq(e,t,p,m,a)}const o=e[t];let i=n,s=r;for(Of(e,n,t),a(e[r],o)>0&&Of(e,n,r);i<s;){for(Of(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?Of(e,n,s):(++s,Of(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Of(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function VEe(e,t,n){if(e=Float64Array.from(IEe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return uq(e);if(t>=1)return lq(e);var r,a=(r-1)*t,o=Math.floor(a),i=lq(dq(e,o).subarray(0,o+1)),s=uq(e.subarray(o+1));return i+(s-i)*(a-o)}}function qEe(e,t,n=oq){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function WEe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function Dr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ho(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const gC=Symbol("implicit");function vC(){var e=new iq,t=[],n=[],r=gC;function a(o){let i=e.get(o);if(i===void 0){if(r!==gC)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new iq;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return vC(t,n).unknown(r)},Dr.apply(a,arguments),a}function Cf(){var e=vC().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var f=t().length,p=a<r,m=p?a:r,y=p?r:a;o=(y-m)/Math.max(1,f-c+l*2),s&&(o=Math.floor(o)),m+=(y-m-o*(f-c))*u,i=o*(1-c),s&&(m=Math.round(m),i=Math.round(i));var v=WEe(f).map(function(b){return m+o*b});return n(p?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,a]=f,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(f){return[r,a]=f,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),d()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return Cf(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},Dr.apply(d(),arguments)}function fq(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return fq(t())},e}function Nf(){return fq(Cf.apply(null,arguments).paddingInner(1))}function HEe(e){return function(){return e}}function lg(e){return+e}var pq=[0,1];function Zn(e){return e}function bC(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:HEe(isNaN(t)?NaN:.5)}function KEe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function ZEe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=bC(a,r),o=n(i,o)):(r=bC(r,a),o=n(o,i)),function(s){return o(r(s))}}function GEe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=bC(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=Ef(e,s,1,r)-1;return o[c](a[c](s))}}function Mf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ug(){var e=pq,t=pq,n=xc,r,a,o,i=Zn,s,c,l;function u(){var f=Math.min(e.length,t.length);return i!==Zn&&(i=KEe(e[0],e[f-1])),s=f>2?GEe:ZEe,c=l=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=s(e.map(r),t,n)))(r(i(f)))}return d.invert=function(f){return i(a((l||(l=s(t,e.map(r),ta)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,lg),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=a_,u()},d.clamp=function(f){return arguments.length?(i=f?!0:Zn,u()):i!==Zn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,p){return r=f,a=p,u()}}function wC(){return ug()(Zn,Zn)}function XEe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function dg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Sl(e){return e=dg(Math.abs(e)),e?e[1]:NaN}function JEe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function YEe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var QEe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kf(e){if(!(t=QEe.exec(e)))throw new Error("invalid format: "+e);var t;return new xC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}kf.prototype=xC.prototype;function xC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}xC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function eOe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var hq;function tOe(e,t){var n=dg(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(hq=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+dg(e,Math.max(0,t+o-1))[0]}function mq(e,t){var n=dg(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const yq={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:XEe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>mq(e*100,t),r:mq,s:tOe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function gq(e){return e}var vq=Array.prototype.map,bq=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function nOe(e){var t=e.grouping===void 0||e.thousands===void 0?gq:JEe(vq.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?gq:YEe(vq.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=kf(d);var f=d.fill,p=d.align,m=d.sign,y=d.symbol,v=d.zero,b=d.width,w=d.comma,j=d.precision,x=d.trim,_=d.type;_==="n"?(w=!0,_="g"):yq[_]||(j===void 0&&(j=12),x=!0,_="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var S=y==="$"?n:y==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=y==="$"?r:/[%p]/.test(_)?i:"",O=yq[_],M=/[defgprs%]/.test(_);j=j===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function C(k){var T=S,P=E,N,I,A;if(_==="c")P=O(k)+P,k="";else{k=+k;var R=k<0||1/k<0;if(k=isNaN(k)?c:O(Math.abs(k),j),x&&(k=eOe(k)),R&&+k==0&&m!=="+"&&(R=!1),T=(R?m==="("?m:s:m==="-"||m==="("?"":m)+T,P=(_==="s"?bq[8+hq/3]:"")+P+(R&&m==="("?")":""),M){for(N=-1,I=k.length;++N<I;)if(A=k.charCodeAt(N),48>A||A>57){P=(A===46?a+k.slice(N+1):k.slice(N))+P,k=k.slice(0,N);break}}}w&&!v&&(k=t(k,1/0));var L=T.length+k.length+P.length,D=L<b?new Array(b-L+1).join(f):"";switch(w&&v&&(k=t(D+k,D.length?b-P.length:1/0),D=""),p){case"<":k=T+k+P+D;break;case"=":k=T+D+k+P;break;case"^":k=D.slice(0,L=D.length>>1)+T+k+P+D.slice(L);break;default:k=D+T+k+P;break}return o(k)}return C.toString=function(){return d+""},C}function u(d,f){var p=l((d=kf(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(Sl(f)/3)))*3,y=Math.pow(10,-m),v=bq[8+m/3];return function(b){return p(y*b)+v}}return{format:l,formatPrefix:u}}var fg,_C,wq;rOe({thousands:",",grouping:[3],currency:["$",""]});function rOe(e){return fg=nOe(e),_C=fg.format,wq=fg.formatPrefix,fg}function aOe(e){return Math.max(0,-Sl(Math.abs(e)))}function oOe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Sl(t)/3)))*3-Sl(Math.abs(e)))}function iOe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Sl(t)-Sl(e))+1}function xq(e,t,n,r){var a=yC(e,t,n),o;switch(r=kf(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=oOe(a,i))&&(r.precision=o),wq(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=iOe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=aOe(a))&&(r.precision=o-(r.type==="%")*2);break}}return _C(r)}function Ri(e){var t=e.domain;return e.ticks=function(n){var r=t();return hC(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return xq(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=mC(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function pg(){var e=wC();return e.copy=function(){return Mf(e,pg())},Dr.apply(e,arguments),Ri(e)}function _q(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,lg),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return _q(e).unknown(t)},e=arguments.length?Array.from(e,lg):[0,1],Ri(n)}function jq(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function Sq(e){return Math.log(e)}function Eq(e){return Math.exp(e)}function sOe(e){return-Math.log(-e)}function cOe(e){return-Math.exp(-e)}function lOe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function uOe(e){return e===10?lOe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function dOe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Oq(e){return(t,n)=>-e(-t,n)}function jC(e){const t=e(Sq,Eq),n=t.domain;let r=10,a,o;function i(){return a=dOe(r),o=uOe(r),n()[0]<0?(a=Oq(a),o=Oq(o),e(sOe,cOe)):e(Sq,Eq),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let f=a(l),p=a(u),m,y;const v=s==null?10:+s;let b=[];if(!(r%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),l>0){for(;f<=p;++f)for(m=1;m<r;++m)if(y=f<0?m/o(-f):m*o(f),!(y<l)){if(y>u)break;b.push(y)}}else for(;f<=p;++f)for(m=r-1;m>=1;--m)if(y=f>0?m/o(-f):m*o(f),!(y<l)){if(y>u)break;b.push(y)}b.length*2<v&&(b=hC(l,u,v))}else b=hC(f,p,Math.min(p-f,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=kf(c)).precision==null&&(c.trim=!0),c=_C(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(jq(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function Cq(){const e=jC(ug()).domain([1,10]);return e.copy=()=>Mf(e,Cq()).base(e.base()),Dr.apply(e,arguments),e}function Nq(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Mq(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function SC(e){var t=1,n=e(Nq(t),Mq(t));return n.constant=function(r){return arguments.length?e(Nq(t=+r),Mq(t)):t},Ri(n)}function kq(){var e=SC(ug());return e.copy=function(){return Mf(e,kq()).constant(e.constant())},Dr.apply(e,arguments)}function Pq(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fOe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function pOe(e){return e<0?-e*e:e*e}function EC(e){var t=e(Zn,Zn),n=1;function r(){return n===1?e(Zn,Zn):n===.5?e(fOe,pOe):e(Pq(n),Pq(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Ri(t)}function OC(){var e=EC(ug());return e.copy=function(){return Mf(e,OC()).exponent(e.exponent())},Dr.apply(e,arguments),e}function hOe(){return OC.apply(null,arguments).exponent(.5)}function Aq(e){return Math.sign(e)*e*e}function mOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Tq(){var e=wC(),t=[0,1],n=!1,r;function a(o){var i=mOe(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(Aq(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,lg)).map(Aq)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return Tq(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Dr.apply(a,arguments),Ri(a)}function Iq(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=qEe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[Ef(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Ii),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return Iq().domain(e).range(t).unknown(r)},Dr.apply(o,arguments)}function Rq(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[Ef(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return Rq().domain([e,t]).range(a).unknown(o)},Dr.apply(Ri(i),arguments)}function Dq(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[Ef(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return Dq().domain(e).range(t).unknown(n)},Dr.apply(a,arguments)}const CC=new Date,NC=new Date;function mn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>mn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(CC.setTime(+o),NC.setTime(+i),e(CC),e(NC),Math.floor(n(CC,NC))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const hg=mn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);hg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?mn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):hg),hg.range;const Ko=1e3,Lr=Ko*60,Zo=Lr*60,Go=Zo*24,MC=Go*7,Lq=Go*30,kC=Go*365,Cs=mn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ko)},(e,t)=>(t-e)/Ko,e=>e.getUTCSeconds());Cs.range;const PC=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ko)},(e,t)=>{e.setTime(+e+t*Lr)},(e,t)=>(t-e)/Lr,e=>e.getMinutes());PC.range;const AC=mn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Lr)},(e,t)=>(t-e)/Lr,e=>e.getUTCMinutes());AC.range;const TC=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ko-e.getMinutes()*Lr)},(e,t)=>{e.setTime(+e+t*Zo)},(e,t)=>(t-e)/Zo,e=>e.getHours());TC.range;const IC=mn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Zo)},(e,t)=>(t-e)/Zo,e=>e.getUTCHours());IC.range;const Pf=mn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Lr)/Go,e=>e.getDate()-1);Pf.range;const mg=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Go,e=>e.getUTCDate()-1);mg.range;const $q=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Go,e=>Math.floor(e/Go));$q.range;function Ns(e){return mn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Lr)/MC)}const yg=Ns(0),gg=Ns(1),yOe=Ns(2),gOe=Ns(3),El=Ns(4),vOe=Ns(5),bOe=Ns(6);yg.range,gg.range,yOe.range,gOe.range,El.range,vOe.range,bOe.range;function Ms(e){return mn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/MC)}const vg=Ms(0),bg=Ms(1),wOe=Ms(2),xOe=Ms(3),Ol=Ms(4),_Oe=Ms(5),jOe=Ms(6);vg.range,bg.range,wOe.range,xOe.range,Ol.range,_Oe.range,jOe.range;const RC=mn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());RC.range;const DC=mn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());DC.range;const Xo=mn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Xo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Xo.range;const Jo=mn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Jo.range;function Fq(e,t,n,r,a,o){const i=[[Cs,1,Ko],[Cs,5,5*Ko],[Cs,15,15*Ko],[Cs,30,30*Ko],[o,1,Lr],[o,5,5*Lr],[o,15,15*Lr],[o,30,30*Lr],[a,1,Zo],[a,3,3*Zo],[a,6,6*Zo],[a,12,12*Zo],[r,1,Go],[r,2,2*Go],[n,1,MC],[t,1,Lq],[t,3,3*Lq],[e,1,kC]];function s(l,u,d){const f=u<l;f&&([l,u]=[u,l]);const p=d&&typeof d.range=="function"?d:c(l,u,d),m=p?p.range(l,+u+1):[];return f?m.reverse():m}function c(l,u,d){const f=Math.abs(u-l)/d,p=pC(([,,v])=>v).right(i,f);if(p===i.length)return e.every(yC(l/kC,u/kC,d));if(p===0)return hg.every(Math.max(yC(l,u,d),1));const[m,y]=i[f/i[p-1][2]<i[p][2]/f?p-1:p];return m.every(y)}return[s,c]}const[SOe,EOe]=Fq(Jo,DC,vg,$q,IC,AC),[OOe,COe]=Fq(Xo,RC,yg,Pf,TC,PC);function LC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $C(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Af(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function NOe(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Tf(a),u=If(a),d=Tf(o),f=If(o),p=Tf(i),m=If(i),y=Tf(s),v=If(s),b=Tf(c),w=If(c),j={a:R,A:L,b:D,B,c:null,d:Wq,e:Wq,f:JOe,g:sCe,G:lCe,H:ZOe,I:GOe,j:XOe,L:Hq,m:YOe,M:QOe,p:F,q:$,Q:Yq,s:Qq,S:eCe,u:tCe,U:nCe,V:rCe,w:aCe,W:oCe,x:null,X:null,y:iCe,Y:cCe,Z:uCe,"%":Jq},x={a:z,A:X,b:G,B:q,c:null,d:Zq,e:Zq,f:hCe,g:SCe,G:OCe,H:dCe,I:fCe,j:pCe,L:Gq,m:mCe,M:yCe,p:J,q:K,Q:Yq,s:Qq,S:gCe,u:vCe,U:bCe,V:wCe,w:xCe,W:_Ce,x:null,X:null,y:jCe,Y:ECe,Z:CCe,"%":Jq},_={a:C,A:k,b:T,B:P,c:N,d:Vq,e:Vq,f:qOe,g:Uq,G:zq,H:qq,I:qq,j:BOe,L:VOe,m:FOe,M:zOe,p:M,q:$Oe,Q:HOe,s:KOe,S:UOe,u:TOe,U:IOe,V:ROe,w:AOe,W:DOe,x:I,X:A,y:Uq,Y:zq,Z:LOe,"%":WOe};j.x=S(n,j),j.X=S(r,j),j.c=S(t,j),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(W,Y){return function(re){var U=[],ce=-1,ae=0,ue=W.length,je,Le,$e;for(re instanceof Date||(re=new Date(+re));++ce<ue;)W.charCodeAt(ce)===37&&(U.push(W.slice(ae,ce)),(Le=Bq[je=W.charAt(++ce)])!=null?je=W.charAt(++ce):Le=je==="e"?" ":"0",($e=Y[je])&&(je=$e(re,Le)),U.push(je),ae=ce+1);return U.push(W.slice(ae,ce)),U.join("")}}function E(W,Y){return function(re){var U=Af(1900,void 0,1),ce=O(U,W,re+="",0),ae,ue;if(ce!=re.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(Y&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ae=$C(Af(U.y,0,1)),ue=ae.getUTCDay(),ae=ue>4||ue===0?bg.ceil(ae):bg(ae),ae=mg.offset(ae,(U.V-1)*7),U.y=ae.getUTCFullYear(),U.m=ae.getUTCMonth(),U.d=ae.getUTCDate()+(U.w+6)%7):(ae=LC(Af(U.y,0,1)),ue=ae.getDay(),ae=ue>4||ue===0?gg.ceil(ae):gg(ae),ae=Pf.offset(ae,(U.V-1)*7),U.y=ae.getFullYear(),U.m=ae.getMonth(),U.d=ae.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),ue="Z"in U?$C(Af(U.y,0,1)).getUTCDay():LC(Af(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(ue+5)%7:U.w+U.U*7-(ue+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,$C(U)):LC(U)}}function O(W,Y,re,U){for(var ce=0,ae=Y.length,ue=re.length,je,Le;ce<ae;){if(U>=ue)return-1;if(je=Y.charCodeAt(ce++),je===37){if(je=Y.charAt(ce++),Le=_[je in Bq?Y.charAt(ce++):je],!Le||(U=Le(W,re,U))<0)return-1}else if(je!=re.charCodeAt(U++))return-1}return U}function M(W,Y,re){var U=l.exec(Y.slice(re));return U?(W.p=u.get(U[0].toLowerCase()),re+U[0].length):-1}function C(W,Y,re){var U=p.exec(Y.slice(re));return U?(W.w=m.get(U[0].toLowerCase()),re+U[0].length):-1}function k(W,Y,re){var U=d.exec(Y.slice(re));return U?(W.w=f.get(U[0].toLowerCase()),re+U[0].length):-1}function T(W,Y,re){var U=b.exec(Y.slice(re));return U?(W.m=w.get(U[0].toLowerCase()),re+U[0].length):-1}function P(W,Y,re){var U=y.exec(Y.slice(re));return U?(W.m=v.get(U[0].toLowerCase()),re+U[0].length):-1}function N(W,Y,re){return O(W,t,Y,re)}function I(W,Y,re){return O(W,n,Y,re)}function A(W,Y,re){return O(W,r,Y,re)}function R(W){return i[W.getDay()]}function L(W){return o[W.getDay()]}function D(W){return c[W.getMonth()]}function B(W){return s[W.getMonth()]}function F(W){return a[+(W.getHours()>=12)]}function $(W){return 1+~~(W.getMonth()/3)}function z(W){return i[W.getUTCDay()]}function X(W){return o[W.getUTCDay()]}function G(W){return c[W.getUTCMonth()]}function q(W){return s[W.getUTCMonth()]}function J(W){return a[+(W.getUTCHours()>=12)]}function K(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var Y=S(W+="",j);return Y.toString=function(){return W},Y},parse:function(W){var Y=E(W+="",!1);return Y.toString=function(){return W},Y},utcFormat:function(W){var Y=S(W+="",x);return Y.toString=function(){return W},Y},utcParse:function(W){var Y=E(W+="",!0);return Y.toString=function(){return W},Y}}}var Bq={"-":"",_:" ",0:"0"},xn=/^\s*\d+/,MOe=/^%/,kOe=/[\\^$*+?|[\]().{}]/g;function pt(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function POe(e){return e.replace(kOe,"\\$&")}function Tf(e){return new RegExp("^(?:"+e.map(POe).join("|")+")","i")}function If(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function AOe(e,t,n){var r=xn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function TOe(e,t,n){var r=xn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function IOe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ROe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function DOe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function zq(e,t,n){var r=xn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Uq(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function LOe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function $Oe(e,t,n){var r=xn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function FOe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Vq(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function BOe(e,t,n){var r=xn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function qq(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function zOe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function UOe(e,t,n){var r=xn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function VOe(e,t,n){var r=xn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function qOe(e,t,n){var r=xn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function WOe(e,t,n){var r=MOe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function HOe(e,t,n){var r=xn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function KOe(e,t,n){var r=xn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Wq(e,t){return pt(e.getDate(),t,2)}function ZOe(e,t){return pt(e.getHours(),t,2)}function GOe(e,t){return pt(e.getHours()%12||12,t,2)}function XOe(e,t){return pt(1+Pf.count(Xo(e),e),t,3)}function Hq(e,t){return pt(e.getMilliseconds(),t,3)}function JOe(e,t){return Hq(e,t)+"000"}function YOe(e,t){return pt(e.getMonth()+1,t,2)}function QOe(e,t){return pt(e.getMinutes(),t,2)}function eCe(e,t){return pt(e.getSeconds(),t,2)}function tCe(e){var t=e.getDay();return t===0?7:t}function nCe(e,t){return pt(yg.count(Xo(e)-1,e),t,2)}function Kq(e){var t=e.getDay();return t>=4||t===0?El(e):El.ceil(e)}function rCe(e,t){return e=Kq(e),pt(El.count(Xo(e),e)+(Xo(e).getDay()===4),t,2)}function aCe(e){return e.getDay()}function oCe(e,t){return pt(gg.count(Xo(e)-1,e),t,2)}function iCe(e,t){return pt(e.getFullYear()%100,t,2)}function sCe(e,t){return e=Kq(e),pt(e.getFullYear()%100,t,2)}function cCe(e,t){return pt(e.getFullYear()%1e4,t,4)}function lCe(e,t){var n=e.getDay();return e=n>=4||n===0?El(e):El.ceil(e),pt(e.getFullYear()%1e4,t,4)}function uCe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pt(t/60|0,"0",2)+pt(t%60,"0",2)}function Zq(e,t){return pt(e.getUTCDate(),t,2)}function dCe(e,t){return pt(e.getUTCHours(),t,2)}function fCe(e,t){return pt(e.getUTCHours()%12||12,t,2)}function pCe(e,t){return pt(1+mg.count(Jo(e),e),t,3)}function Gq(e,t){return pt(e.getUTCMilliseconds(),t,3)}function hCe(e,t){return Gq(e,t)+"000"}function mCe(e,t){return pt(e.getUTCMonth()+1,t,2)}function yCe(e,t){return pt(e.getUTCMinutes(),t,2)}function gCe(e,t){return pt(e.getUTCSeconds(),t,2)}function vCe(e){var t=e.getUTCDay();return t===0?7:t}function bCe(e,t){return pt(vg.count(Jo(e)-1,e),t,2)}function Xq(e){var t=e.getUTCDay();return t>=4||t===0?Ol(e):Ol.ceil(e)}function wCe(e,t){return e=Xq(e),pt(Ol.count(Jo(e),e)+(Jo(e).getUTCDay()===4),t,2)}function xCe(e){return e.getUTCDay()}function _Ce(e,t){return pt(bg.count(Jo(e)-1,e),t,2)}function jCe(e,t){return pt(e.getUTCFullYear()%100,t,2)}function SCe(e,t){return e=Xq(e),pt(e.getUTCFullYear()%100,t,2)}function ECe(e,t){return pt(e.getUTCFullYear()%1e4,t,4)}function OCe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Ol(e):Ol.ceil(e),pt(e.getUTCFullYear()%1e4,t,4)}function CCe(){return"+0000"}function Jq(){return"%"}function Yq(e){return+e}function Qq(e){return Math.floor(+e/1e3)}var Cl,eW,tW;NCe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NCe(e){return Cl=NOe(e),eW=Cl.format,Cl.parse,tW=Cl.utcFormat,Cl.utcParse,Cl}function MCe(e){return new Date(e)}function kCe(e){return e instanceof Date?+e:+new Date(+e)}function FC(e,t,n,r,a,o,i,s,c,l){var u=wC(),d=u.invert,f=u.domain,p=l(".%L"),m=l(":%S"),y=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),j=l("%B"),x=l("%Y");function _(S){return(c(S)<S?p:s(S)<S?m:i(S)<S?y:o(S)<S?v:r(S)<S?a(S)<S?b:w:n(S)<S?j:x)(S)}return u.invert=function(S){return new Date(d(S))},u.domain=function(S){return arguments.length?f(Array.from(S,kCe)):f().map(MCe)},u.ticks=function(S){var E=f();return e(E[0],E[E.length-1],S??10)},u.tickFormat=function(S,E){return E==null?_:l(E)},u.nice=function(S){var E=f();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?f(jq(E,S)):u},u.copy=function(){return Mf(u,FC(e,t,n,r,a,o,i,s,c,l))},u}function PCe(){return Dr.apply(FC(OOe,COe,Xo,RC,yg,Pf,TC,PC,Cs,eW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ACe(){return Dr.apply(FC(SOe,EOe,Jo,DC,vg,mg,IC,AC,Cs,tW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function wg(){var e=0,t=1,n,r,a,o,i=Zn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(f){var p,m;return arguments.length?([p,m]=f,i=d(p,m),l):[i(0),i(1)]}}return l.range=u(xc),l.rangeRound=u(a_),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function Di(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nW(){var e=Ri(wg()(Zn));return e.copy=function(){return Di(e,nW())},Ho.apply(e,arguments)}function rW(){var e=jC(wg()).domain([1,10]);return e.copy=function(){return Di(e,rW()).base(e.base())},Ho.apply(e,arguments)}function aW(){var e=SC(wg());return e.copy=function(){return Di(e,aW()).constant(e.constant())},Ho.apply(e,arguments)}function BC(){var e=EC(wg());return e.copy=function(){return Di(e,BC()).exponent(e.exponent())},Ho.apply(e,arguments)}function TCe(){return BC.apply(null,arguments).exponent(.5)}function oW(){var e=[],t=Zn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Ef(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ii),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>VEe(e,o/r))},n.copy=function(){return oW(t).domain(e)},Ho.apply(n,arguments)}function xg(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Zn,u,d=!1,f;function p(y){return isNaN(y=+y)?f:(y=.5+((y=+u(y))-o)*(r*y<r*o?s:c),l(d?Math.max(0,Math.min(1,y)):y))}p.domain=function(y){return arguments.length?([e,t,n]=y,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p):[e,t,n]},p.clamp=function(y){return arguments.length?(d=!!y,p):d},p.interpolator=function(y){return arguments.length?(l=y,p):l};function m(y){return function(v){var b,w,j;return arguments.length?([b,w,j]=v,l=Yie(y,[b,w,j]),p):[l(0),l(.5),l(1)]}}return p.range=m(xc),p.rangeRound=m(a_),p.unknown=function(y){return arguments.length?(f=y,p):f},function(y){return u=y,a=y(e),o=y(t),i=y(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p}}function iW(){var e=Ri(xg()(Zn));return e.copy=function(){return Di(e,iW())},Ho.apply(e,arguments)}function sW(){var e=jC(xg()).domain([.1,1,10]);return e.copy=function(){return Di(e,sW()).base(e.base())},Ho.apply(e,arguments)}function cW(){var e=SC(xg());return e.copy=function(){return Di(e,cW()).constant(e.constant())},Ho.apply(e,arguments)}function zC(){var e=EC(xg());return e.copy=function(){return Di(e,zC()).exponent(e.exponent())},Ho.apply(e,arguments)}function ICe(){return zC.apply(null,arguments).exponent(.5)}const lW=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Cf,scaleDiverging:iW,scaleDivergingLog:sW,scaleDivergingPow:zC,scaleDivergingSqrt:ICe,scaleDivergingSymlog:cW,scaleIdentity:_q,scaleImplicit:gC,scaleLinear:pg,scaleLog:Cq,scaleOrdinal:vC,scalePoint:Nf,scalePow:OC,scaleQuantile:Iq,scaleQuantize:Rq,scaleRadial:Tq,scaleSequential:nW,scaleSequentialLog:rW,scaleSequentialPow:BC,scaleSequentialQuantile:oW,scaleSequentialSqrt:TCe,scaleSequentialSymlog:aW,scaleSqrt:hOe,scaleSymlog:kq,scaleThreshold:Dq,scaleTime:PCe,scaleUtc:ACe,tickFormat:xq},Symbol.toStringTag,{value:"Module"}));var UC,uW;function dW(){if(uW)return UC;uW=1;var e=yc();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return UC=t,UC}var VC,fW;function RCe(){if(fW)return VC;fW=1;function e(t,n){return t>n}return VC=e,VC}var qC,pW;function DCe(){if(pW)return qC;pW=1;var e=dW(),t=RCe(),n=gc();function r(a){return a&&a.length?e(a,n,t):void 0}return qC=r,qC}var LCe=DCe();const _g=st(LCe);var WC,hW;function $Ce(){if(hW)return WC;hW=1;function e(t,n){return t<n}return WC=e,WC}var HC,mW;function FCe(){if(mW)return HC;mW=1;var e=dW(),t=$Ce(),n=gc();function r(a){return a&&a.length?e(a,n,t):void 0}return HC=r,HC}var BCe=FCe();const jg=st(BCe);var KC,yW;HM=function(){if(yW)return KC;yW=1;var e=iu(),t=Fa(),n=fV(),r=zn();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return KC=a,KC};var ZC,gW;function zCe(){if(gW)return ZC;gW=1;var e=Nv(),t=HM();function n(r,a){return e(t(r,a),1)}return ZC=n,ZC}var UCe=zCe();const VCe=st(UCe);var GC,vW;function qCe(){if(vW)return GC;vW=1;var e=a1();function t(n,r){return e(n,r)}return GC=t,GC}var WCe=qCe();const XC=st(WCe);var Nl=1e9,HCe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},QC,Vt=!0,$r="[DecimalError] ",ks=$r+"Invalid argument: ",JC=$r+"Exponent out of range: ",Ml=Math.floor,Ps=Math.pow,KCe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Sr,_n=1e7,Ft=7,bW=9007199254740991,Sg=Ml(bW/Ft),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Ft;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return Yo(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return Tt(Yo(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return sn(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Sr))throw Error($r+"NaN");if(n.s<1)throw Error($r+(n.s?"NaN":"-Infinity"));return n.eq(Sr)?new r(0):(Vt=!1,t=Yo(Rf(n,o),Rf(e,o),o),Vt=!0,Tt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?jW(t,e):wW(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error($r+"NaN");return n.s?(Vt=!1,t=Yo(n,e,0,1).times(e),Vt=!0,n.minus(t)):Tt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return xW(this)},Ce.naturalLogarithm=Ce.ln=function(){return Rf(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?wW(t,e):jW(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ks+e);if(t=sn(a)+1,r=a.d.length-1,n=r*Ft+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error($r+"NaN")}for(e=sn(s),Vt=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=Qa(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Ml((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus(Yo(s,o,i+2)).times(.5),Qa(o.d).slice(0,i)===(t=Qa(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Tt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Vt=!0,Tt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,f=u.d,p=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=f.length,l=p.length,c<l&&(o=f,f=p,p=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+p[r]*f[a-r-1]+t,o[a--]=s%_n|0,t=s/_n|0;o[a]=(o[a]+t)%_n|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Vt?Tt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Ya(e,0,Nl),t===void 0?t=r.rounding:Ya(t,0,8),Tt(n,e+sn(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=As(r,!0):(Ya(e,0,Nl),t===void 0?t=a.rounding:Ya(t,0,8),r=Tt(new a(r),e+1,t),n=As(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?As(a):(Ya(e,0,Nl),t===void 0?t=o.rounding:Ya(t,0,8),r=Tt(new o(a),e+sn(a)+1,t),n=As(r.abs(),!1,e+sn(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return Tt(new t(e),sn(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(Sr);if(s=new c(s),!s.s){if(e.s<1)throw Error($r+"Infinity");return s}if(s.eq(Sr))return s;if(r=c.precision,e.eq(Sr))return Tt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=bW){for(a=new c(Sr),t=Math.ceil(r/Ft+4),Vt=!1;n%2&&(a=a.times(s),SW(a.d,t)),n=Ml(n/2),n!==0;)s=s.times(s),SW(s.d,t);return Vt=!0,e.s<0?new c(Sr).div(a):Tt(a,r)}}else if(o<0)throw Error($r+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Vt=!1,a=e.times(Rf(s,r+l)),Vt=!0,a=xW(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=sn(a),r=As(a,n<=o.toExpNeg||n>=o.toExpPos)):(Ya(e,1,Nl),t===void 0?t=o.rounding:Ya(t,0,8),a=Tt(new o(a),e,t),n=sn(a),r=As(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Ya(e,1,Nl),t===void 0?t=r.rounding:Ya(t,0,8)),Tt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=sn(e),n=e.constructor;return As(e,t<=n.toExpNeg||t>=n.toExpPos)};function wW(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Vt?Tt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Ft),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/_n|0,c[o]%=_n;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Vt?Tt(t,d):t}function Ya(e,t,n){if(e!==~~e||e<t||e>n)throw Error(ks+e)}function Qa(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Ft-r.length,n&&(o+=Li(n)),o+=r;i=e[t],r=i+"",n=Ft-r.length,n&&(o+=Li(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Yo=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%_n|0,i=o/_n|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*_n+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,f,p,m,y,v,b,w,j,x,_,S,E,O,M=r.constructor,C=r.s==a.s?1:-1,k=r.d,T=a.d;if(!r.s)return new M(r);if(!a.s)throw Error($r+"Division by zero");for(c=r.e-a.e,E=T.length,_=k.length,p=new M(C),m=p.d=[],l=0;T[l]==(k[l]||0);)++l;if(T[l]>(k[l]||0)&&--c,o==null?w=o=M.precision:i?w=o+(sn(r)-sn(a))+1:w=o,w<0)return new M(0);if(w=w/Ft+2|0,l=0,E==1)for(u=0,T=T[0],w++;(l<_||u)&&w--;l++)j=u*_n+(k[l]||0),m[l]=j/T|0,u=j%T|0;else{for(u=_n/(T[0]+1)|0,u>1&&(T=e(T,u),k=e(k,u),E=T.length,_=k.length),x=E,y=k.slice(0,E),v=y.length;v<E;)y[v++]=0;O=T.slice(),O.unshift(0),S=T[0],T[1]>=_n/2&&++S;do u=0,s=t(T,y,E,v),s<0?(b=y[0],E!=v&&(b=b*_n+(y[1]||0)),u=b/S|0,u>1?(u>=_n&&(u=_n-1),d=e(T,u),f=d.length,v=y.length,s=t(d,y,f,v),s==1&&(u--,n(d,E<f?O:T,f))):(u==0&&(s=u=1),d=T.slice()),f=d.length,f<v&&d.unshift(0),n(y,d,v),s==-1&&(v=y.length,s=t(T,y,E,v),s<1&&(u++,n(y,E<v?O:T,v))),v=y.length):s===0&&(u++,y=[0]),m[l++]=u,s&&y[0]?y[v++]=k[x]||0:(y=[k[x]],v=1);while((x++<_||y[0]!==void 0)&&w--)}return m[0]||m.shift(),p.e=c,Tt(p,i?o+sn(p)+1:o)}}();function xW(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(sn(e)>16)throw Error(JC+sn(e));if(!e.s)return new u(Sr);for(t==null?(Vt=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(Ps(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(Sr),u.precision=s;;){if(a=Tt(a.times(e),s),n=n.times(++c),i=o.plus(Yo(a,n,s)),Qa(i.d).slice(0,s)===Qa(o.d).slice(0,s)){for(;l--;)o=Tt(o.times(o),s);return u.precision=d,t==null?(Vt=!0,Tt(o,d)):o}o=i}}function sn(e){for(var t=e.e*Ft,n=e.d[0];n>=10;n/=10)t++;return t}function YC(e,t,n){if(t>e.LN10.sd())throw Vt=!0,n&&(e.precision=n),Error($r+"LN10 precision limit exceeded");return Tt(new e(e.LN10),t)}function Li(e){for(var t="";e--;)t+="0";return t}function Rf(e,t){var n,r,a,o,i,s,c,l,u,d=1,f=10,p=e,m=p.d,y=p.constructor,v=y.precision;if(p.s<1)throw Error($r+(p.s?"NaN":"-Infinity"));if(p.eq(Sr))return new y(0);if(t==null?(Vt=!1,l=v):l=t,p.eq(10))return t==null&&(Vt=!0),YC(y,l);if(l+=f,y.precision=l,n=Qa(m),r=n.charAt(0),o=sn(p),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(e),n=Qa(p.d),r=n.charAt(0),d++;o=sn(p),r>1?(p=new y("0."+n),o++):p=new y(r+"."+n.slice(1))}else return c=YC(y,l+2,v).times(o+""),p=Rf(new y(r+"."+n.slice(1)),l-f).plus(c),y.precision=v,t==null?(Vt=!0,Tt(p,v)):p;for(s=i=p=Yo(p.minus(Sr),p.plus(Sr),l),u=Tt(p.times(p),l),a=3;;){if(i=Tt(i.times(u),l),c=s.plus(Yo(i,new y(a),l)),Qa(c.d).slice(0,l)===Qa(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(YC(y,l+2,v).times(o+""))),s=Yo(s,new y(d),l),y.precision=v,t==null?(Vt=!0,Tt(s,v)):s;s=c,a+=2}}function _W(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=Ml(n/Ft),e.d=[],r=(n+1)%Ft,n<0&&(r+=Ft),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Ft;r<a;)e.d.push(+t.slice(r,r+=Ft));t=t.slice(r),r=Ft-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Vt&&(e.e>Sg||e.e<-Sg))throw Error(JC+n)}else e.s=0,e.e=0,e.d=[0];return e}function Tt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Ft,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Ft),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Ft,a=r-Ft+i}if(n!==void 0&&(o=Ps(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/Ps(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=sn(e),d.length=1,t=t-o-1,d[0]=Ps(10,(Ft-t%Ft)%Ft),e.e=Ml(-t/Ft)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=Ps(10,Ft-r),d[u]=a>0?(l/Ps(10,i-a)%Ps(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==_n&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=_n)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Vt&&(e.e>Sg||e.e<-Sg))throw Error(JC+sn(e));return e}function jW(e,t){var n,r,a,o,i,s,c,l,u,d,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Vt?Tt(t,p):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(p/Ft),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=_n-1;--c[o],c[a]+=_n}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Vt?Tt(t,p):t):new f(0)}function As(e,t,n){var r,a=sn(e),o=Qa(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+Li(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+Li(-a-1)+o,n&&(r=n-i)>0&&(o+=Li(r))):a>=i?(o+=Li(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+Li(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=Li(r))),e.s<0?"-"+o:o}function SW(e,t){if(e.length>t)return e.length=t,!0}function EW(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(ks+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return _W(i,o.toString())}else if(typeof o!="string")throw Error(ks+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,KCe.test(o))_W(i,o);else throw Error(ks+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=EW,a.config=a.set=ZCe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function ZCe(e){if(!e||typeof e!="object")throw Error($r+"Object expected");var t,n,r,a=["precision",1,Nl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(Ml(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(ks+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(ks+n+": "+r);return this}var QC=EW(HCe);Sr=new QC(1);const Pt=QC;function GCe(e){return QCe(e)||YCe(e)||JCe(e)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JCe(e,t){if(e){if(typeof e=="string")return eN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eN(e,t)}}function YCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function QCe(e){if(Array.isArray(e))return eN(e)}function eN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var eNe=function(e){return e},OW={"@@functional/placeholder":!0},CW=function(e){return e===OW},NW=function(e){return function t(){return arguments.length===0||arguments.length===1&&CW(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},tNe=function e(t,n){return t===1?n:NW(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==OW}).length;return i>=t?n.apply(void 0,a):e(t-i,NW(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return CW(d)?c.shift():d});return n.apply(void 0,GCe(u).concat(c))}))})},Eg=function(e){return tNe(e.length,e)},tN=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},nNe=Eg(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),rNe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return eNe;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},nN=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},MW=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function aNe(e){var t;return e===0?t=1:t=Math.floor(new Pt(e).abs().log(10).toNumber())+1,t}function oNe(e,t,n){for(var r=new Pt(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var iNe=Eg(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),sNe=Eg(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),cNe=Eg(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const Og={rangeStep:oNe,getDigitCount:aNe,interpolateNumber:iNe,uninterpolateNumber:sNe,uninterpolateTruncation:cNe};function rN(e){return dNe(e)||uNe(e)||kW(e)||lNe()}function lNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function dNe(e){if(Array.isArray(e))return aN(e)}function Df(e,t){return hNe(e)||pNe(e,t)||kW(e,t)||fNe()}function fNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kW(e,t){if(e){if(typeof e=="string")return aN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aN(e,t)}}function aN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pNe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function hNe(e){if(Array.isArray(e))return e}function PW(e){var t=Df(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function AW(e,t,n){if(e.lte(0))return new Pt(0);var r=Og.getDigitCount(e.toNumber()),a=new Pt(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Pt(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Pt(Math.ceil(c))}function mNe(e,t,n){var r=1,a=new Pt(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Pt(10).pow(Og.getDigitCount(e)-1),a=new Pt(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Pt(Math.floor(e)))}else e===0?a=new Pt(Math.floor((t-1)/2)):n||(a=new Pt(Math.floor(e)));var i=Math.floor((t-1)/2),s=rNe(nNe(function(c){return a.add(new Pt(c-i).mul(r)).toNumber()}),tN);return s(0,t)}function TW(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Pt(0),tickMin:new Pt(0),tickMax:new Pt(0)};var o=AW(new Pt(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Pt(0):(i=new Pt(e).add(t).div(2),i=i.sub(new Pt(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Pt(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?TW(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Pt(s).mul(o)),tickMax:i.add(new Pt(c).mul(o))})}function yNe(e){var t=Df(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=PW([n,r]),c=Df(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(rN(tN(0,a-1).map(function(){return 1/0}))):[].concat(rN(tN(0,a-1).map(function(){return-1/0})),[u]);return n>r?nN(d):d}if(l===u)return mNe(l,a,o);var f=TW(l,u,i,o),p=f.step,m=f.tickMin,y=f.tickMax,v=Og.rangeStep(m,y.add(new Pt(.1).mul(p)),p);return n>r?nN(v):v}function gNe(e,t){var n=Df(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=PW([r,a]),s=Df(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=AW(new Pt(l).sub(c).div(u-1),o,0),f=[].concat(rN(Og.rangeStep(new Pt(c),new Pt(l).sub(new Pt(.99).mul(d)),d)),[l]);return r>a?nN(f):f}var vNe=MW(yNe),bNe=MW(gNe),wNe="Invariant failed";function Ts(e,t){throw new Error(wNe)}var xNe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function kl(e){"@babel/helpers - typeof";return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kl(e)}function Cg(){return Cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cg.apply(this,arguments)}function _Ne(e,t){return ONe(e)||ENe(e,t)||SNe(e,t)||jNe()}function jNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SNe(e,t){if(e){if(typeof e=="string")return IW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IW(e,t)}}function IW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ENe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function ONe(e){if(Array.isArray(e))return e}function CNe(e,t){if(e==null)return{};var n=NNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function NNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function MNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,LW(r.key),r)}}function PNe(e,t,n){return t&&kNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ANe(e,t,n){return t=Ng(t),TNe(e,RW()?Reflect.construct(t,n||[],Ng(e).constructor):t.apply(e,n))}function TNe(e,t){if(t&&(kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return INe(e)}function INe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RW=function(){return!!e})()}function Ng(e){return Ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ng(e)}function RNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oN(e,t)}function oN(e,t){return oN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},oN(e,t)}function DW(e,t,n){return t=LW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LW(e){var t=DNe(e,"string");return kl(t)=="symbol"?t:t+""}function DNe(e,t){if(kl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(kl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mg=function(e){function t(){return MNe(this,t),ANe(this,t,arguments)}return RNe(t,e),PNe(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=CNe(n,xNe),f=bt(d,!1);this.props.direction==="x"&&l.type!=="number"&&Ts();var p=s.map(function(m){var y=c(m,i),v=y.x,b=y.y,w=y.value,j=y.errorVal;if(!j)return null;var x=[],_,S;if(Array.isArray(j)){var E=_Ne(j,2);_=E[0],S=E[1]}else _=S=j;if(a==="vertical"){var O=l.scale,M=b+r,C=M+o,k=M-o,T=O(w-_),P=O(w+S);x.push({x1:P,y1:C,x2:P,y2:k}),x.push({x1:T,y1:M,x2:P,y2:M}),x.push({x1:T,y1:C,x2:T,y2:k})}else if(a==="horizontal"){var N=u.scale,I=v+r,A=I-o,R=I+o,L=N(w-_),D=N(w+S);x.push({x1:A,y1:D,x2:R,y2:D}),x.push({x1:I,y1:L,x2:I,y2:D}),x.push({x1:A,y1:L,x2:R,y2:L})}return H.createElement(wn,Cg({className:"recharts-errorBar",key:"bar-".concat(x.map(function(B){return"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))},f),x.map(function(B){return H.createElement("line",Cg({},B,{key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))}))});return H.createElement(wn,{className:"recharts-errorBars"},p)}}])}(H.Component);DW(Mg,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),DW(Mg,"displayName","ErrorBar");function Lf(e){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lf(e)}function $W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Is(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$W(Object(n),!0).forEach(function(r){LNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$W(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function LNe(e,t,n){return t=$Ne(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Ne(e){var t=FNe(e,"string");return Lf(t)=="symbol"?t:t+""}function FNe(e,t){if(Lf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Lf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FW=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=jr(t,bl);if(!o)return null;var i=bl.defaultProps,s=i!==void 0?Is(Is({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,f=u.props,p=f.sectors||f.data||[];return l.concat(p.map(function(m){return{type:o.props.iconType||d.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,f=d!==void 0?Is(Is({},d),u.props):{},p=f.dataKey,m=f.name,y=f.legendType,v=f.hide;return{inactive:v,dataKey:p,type:s.iconType||y||"square",color:sN(u),value:m||p,payload:f}}),Is(Is(Is({},s),bl.getWithHeight(o,r)),{},{payload:c,item:o})};function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function BW(e){return VNe(e)||UNe(e)||zNe(e)||BNe()}function BNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zNe(e,t){if(e){if(typeof e=="string")return iN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iN(e,t)}}function UNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VNe(e){if(Array.isArray(e))return iN(e)}function iN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zW(Object(n),!0).forEach(function(r){Pl(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Pl(e,t,n){return t=qNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qNe(e){var t=WNe(e,"string");return $f(t)=="symbol"?t:t+""}function WNe(e,t){if($f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eo(e,t,n){return wt(e)||wt(t)?n:hn(t)?Ar(e,t,n):at(t)?t(e):n}function kg(e,t,n,r){var a=VCe(e,function(s){return eo(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[jg(o),_g(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!wt(s)}):a;return i.map(function(s){return hn(s)||s instanceof Date?s:""})}var HNe=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(ja(u-l)!==ja(d-u)){var p=[];if(ja(d-u)===ja(s[1]-s[0])){f=d;var m=u+s[1]-s[0];p[0]=Math.min(m,(m+l)/2),p[1]=Math.max(m,(m+l)/2)}else{f=l;var y=d+s[1]-s[0];p[0]=Math.min(u,(y+u)/2),p[1]=Math.max(u,(y+u)/2)}var v=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var j=0;j<i;j++)if(j===0&&e<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<i-1&&e>(n[j].coordinate+n[j-1].coordinate)/2&&e<=(n[j].coordinate+n[j+1].coordinate)/2||j===i-1&&e>(n[j].coordinate+n[j-1].coordinate)/2){o=n[j].index;break}return o},sN=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?Jt(Jt({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},KNe=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,f=u.length;d<f;d++){var p=l[u[d]],m=p.items,y=p.cateAxisId,v=m.filter(function(S){return Vo(S.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?Jt(Jt({},b),v[0].props):v[0].props,j=w.barSize,x=w[y];o[x]||(o[x]=[]);var _=wt(j)?t:j;o[x].push({item:v[0],stackList:v.slice(1),barSize:wt(_)?void 0:Es(_,n,0)})}}return o},ZNe=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=Es(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,f=r/s,p=o.reduce(function(j,x){return j+x.barSize||0},0);p+=(s-1)*c,p>=r&&(p-=(s-1)*c,c=0),p>=r&&f>0&&(d=!0,f*=.9,p=s*f);var m=(r-p)/2>>0,y={offset:m-c,size:0};l=o.reduce(function(j,x){var _={item:x.item,position:{offset:y.offset+y.size+c,size:d?f:x.barSize}},S=[].concat(BW(j),[_]);return y=S[S.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:y})}),S},u)}else{var v=Es(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(j,x,_){var S=[].concat(BW(j),[{item:x.item,position:{offset:v+(b+c)*_+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},u)}return l},GNe=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=FW({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,f=c.align,p=c.verticalAlign,m=c.layout;if((m==="vertical"||m==="horizontal"&&p==="middle")&&f!=="center"&&ye(e[f]))return Jt(Jt({},e),{},Pl({},f,e[f]+(u||0)));if((m==="horizontal"||m==="vertical"&&f==="center")&&p!=="middle"&&ye(e[p]))return Jt(Jt({},e),{},Pl({},p,e[p]+(d||0)))}return e},XNe=function(e,t,n){return wt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},UW=function(e,t,n,r,a){var o=t.props.children,i=Sa(o,Mg).filter(function(c){return XNe(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=eo(l,n);if(wt(u))return c;var d=Array.isArray(u)?[jg(u),_g(u)]:[u,u],f=s.reduce(function(p,m){var y=eo(l,m,0),v=d[0]-Math.abs(Array.isArray(y)?y[0]:y),b=d[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(v,p[0]),Math.max(b,p[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},JNe=function(e,t,n,r,a){var o=t.map(function(i){return UW(e,i,n,a,r)}).filter(function(i){return!wt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},VW=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&UW(e,s,c,r)||kg(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},qW=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},WW=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},Qo=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ja(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!mf(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},cN=new WeakMap,Pg=function(e,t){if(typeof t!="function")return e;cN.has(e)||cN.set(e,new WeakMap);var n=cN.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},YNe=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:Cf(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:pg(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Nf(),realScaleType:"point"}:a==="category"?{scale:Cf(),realScaleType:"band"}:{scale:pg(),realScaleType:"linear"};if(hf(r)){var s="scale".concat(Uy(r));return{scale:(lW[s]||Nf)(),realScaleType:lW[s]?s:"point"}}return at(r)?{scale:r}:{scale:Nf(),realScaleType:"point"}},HW=1e-4,QNe=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-HW,o=Math.max(r[0],r[1])+HW,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},eMe=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},tMe=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},nMe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=mf(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},rMe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=mf(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},aMe={sign:nMe,expand:oje,none:yl,silhouette:ije,wiggle:sje,positive:rMe},oMe=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=aMe[n],o=aje().keys(r).value(function(i,s){return+eo(i,s,0)}).order(yO).offset(a);return o(e)},iMe=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var f,p=(f=d.type)!==null&&f!==void 0&&f.defaultProps?Jt(Jt({},d.type.defaultProps),d.props):d.props,m=p.stackId,y=p.hide;if(y)return u;var v=p[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(hn(m)){var w=b.stackGroups[m]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[m]=w}else b.stackGroups[Fy("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return Jt(Jt({},u),{},Pl({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var f=c[d];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(m,y){var v=f.stackGroups[y];return Jt(Jt({},m),{},Pl({},y,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:oMe(e,v.items,a)}))},p)}return Jt(Jt({},u),{},Pl({},d,f))},l)},sMe=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=vNe(c,a,i);return e.domain([jg(l),_g(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=bNe(u,a,i);return{niceTicks:d}}return null},KW=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=eo(o,t.dataKey,t.domain[i]);return wt(s)?null:t.scale(s)-a/2+r},cMe=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},lMe=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Jt(Jt({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(hn(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},uMe=function(e){return e.reduce(function(t,n){return[jg(n.concat([t[0]]).filter(ye)),_g(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},ZW=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=uMe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},GW=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,XW=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,lN=function(e,t,n){if(at(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(GW.test(e[0])){var a=+GW.exec(e[0])[1];r[0]=t[0]-a}else at(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(XW.test(e[1])){var o=+XW.exec(e[1])[1];r[1]=t[1]+o}else at(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},Ag=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=eC(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},JW=function(e,t,n){return!e||!e.length||XC(e,Ar(n,"type.defaultProps.domain"))?t:e},YW=function(e,t){var n=e.type.defaultProps?Jt(Jt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return Jt(Jt({},bt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:sN(e),value:eo(t,r),type:s,payload:t,chartType:c,hide:l})};function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function QW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function eH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QW(Object(n),!0).forEach(function(r){dMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dMe(e,t,n){return t=fMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fMe(e){var t=pMe(e,"string");return Ff(t)=="symbol"?t:t+""}function pMe(e,t){if(Ff(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ff(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tg=Math.PI/180,hMe=function(e){return e*180/Math.PI},Mn=function(e,t,n,r){return{x:e+Math.cos(-Tg*r)*n,y:t+Math.sin(-Tg*r)*n}},mMe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},yMe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=mMe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:hMe(c),angleInRadian:c}},gMe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},vMe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},tH=function(e,t){var n=e.x,r=e.y,a=yMe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=gMe(t),u=l.startAngle,d=l.endAngle,f=i,p;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=u}return p?eH(eH({},t),{},{radius:o,angle:vMe(f,t)}):null};function Bf(e){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bf(e)}var bMe=["offset"];function wMe(e){return SMe(e)||jMe(e)||_Me(e)||xMe()}function xMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Me(e,t){if(e){if(typeof e=="string")return uN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uN(e,t)}}function jMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SMe(e){if(Array.isArray(e))return uN(e)}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function EMe(e,t){if(e==null)return{};var n=OMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function nH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nH(Object(n),!0).forEach(function(r){CMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function CMe(e,t,n){return t=NMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NMe(e){var t=MMe(e,"string");return Bf(t)=="symbol"?t:t+""}function MMe(e,t){if(Bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zf(){return zf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zf.apply(this,arguments)}var kMe=function(e){var t=e.value,n=e.formatter,r=wt(e.children)?t:e.children;return at(n)?n(r):r},PMe=function(e,t){var n=ja(t-e),r=Math.min(Math.abs(t-e),360);return n*r},AMe=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,f=s.startAngle,p=s.endAngle,m=s.clockWise,y=(u+d)/2,v=PMe(f,p),b=v>=0?1:-1,w,j;r==="insideStart"?(w=f+b*o,j=m):r==="insideEnd"?(w=p-b*o,j=!m):r==="end"&&(w=p+b*o,j=m),j=v<=0?j:!j;var x=Mn(c,l,y,w),_=Mn(c,l,y,w+(j?1:-1)*359),S="M".concat(x.x,",").concat(x.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(j?0:1,`,
    `).concat(_.x,",").concat(_.y),E=wt(e.id)?Fy("recharts-radial-line-"):e.id;return H.createElement("text",zf({},n,{dominantBaseline:"central",className:St("recharts-radial-bar-label",i)}),H.createElement("defs",null,H.createElement("path",{id:E,d:S})),H.createElement("textPath",{xlinkHref:"#".concat(E)},t))},TMe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var f=Mn(o,i,c+n,d),p=f.x,m=f.y;return{x:p,y:m,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var y=(s+c)/2,v=Mn(o,i,y,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},IMe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,f=u>0?"end":"start",p=u>0?"start":"end",m=c>=0?1:-1,y=m*r,v=m>0?"end":"start",b=m>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:f};return yn(yn({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var j={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:p};return yn(yn({},j),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return yn(yn({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var _={x:i+c+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return yn(yn({},_),n?{width:Math.max(n.x+n.width-_.x,0),height:l}:{})}var S=n?{width:c,height:l}:{};return a==="insideLeft"?yn({x:i+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},S):a==="insideRight"?yn({x:i+c-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},S):a==="insideTop"?yn({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:p},S):a==="insideBottom"?yn({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:f},S):a==="insideTopLeft"?yn({x:i+y,y:s+d,textAnchor:b,verticalAnchor:p},S):a==="insideTopRight"?yn({x:i+c-y,y:s+d,textAnchor:v,verticalAnchor:p},S):a==="insideBottomLeft"?yn({x:i+y,y:s+l-d,textAnchor:b,verticalAnchor:f},S):a==="insideBottomRight"?yn({x:i+c-y,y:s+l-d,textAnchor:v,verticalAnchor:f},S):pl(a)&&(ye(a.x)||Ss(a.x))&&(ye(a.y)||Ss(a.y))?yn({x:i+Es(a.x,c),y:s+Es(a.y,l),textAnchor:"end",verticalAnchor:"end"},S):yn({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},S)},RMe=function(e){return"cx"in e&&ye(e.cx)};function Dn(e){var t=e.offset,n=t===void 0?5:t,r=EMe(e,bMe),a=yn({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,f=a.textBreakAll;if(!o||wt(s)&&wt(c)&&!g.isValidElement(l)&&!at(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var p;if(at(l)){if(p=g.createElement(l,a),g.isValidElement(p))return p}else p=kMe(a);var m=RMe(o),y=bt(a,!0);if(m&&(i==="insideStart"||i==="insideEnd"||i==="end"))return AMe(a,p,y);var v=m?TMe(a):IMe(a);return H.createElement(sg,zf({className:St("recharts-label",d)},y,v,{breakAll:f}),p)}Dn.displayName="Label";var rH=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,f=e.top,p=e.left,m=e.width,y=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(m)&&ye(y)){if(ye(u)&&ye(d))return{x:u,y:d,width:m,height:y};if(ye(f)&&ye(p))return{x:f,y:p,width:m,height:y}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},DMe=function(e,t){return e?e===!0?H.createElement(Dn,{key:"label-implicit",viewBox:t}):hn(e)?H.createElement(Dn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Dn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):H.createElement(Dn,{key:"label-implicit",content:e,viewBox:t}):at(e)?H.createElement(Dn,{key:"label-implicit",content:e,viewBox:t}):pl(e)?H.createElement(Dn,zf({viewBox:t},e,{key:"label-implicit"})):null:null},LMe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=rH(e),o=Sa(r,Dn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=DMe(e.label,t||a);return[i].concat(wMe(o))};Dn.parseViewBox=rH,Dn.renderCallByParent=LMe;var dN,aH;Ik=function(){if(aH)return dN;aH=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return dN=e,dN};var $Me=Ik();KM=st($Me);function Uf(e){"@babel/helpers - typeof";return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uf(e)}var FMe=["valueAccessor"],BMe=["data","dataKey","clockWise","id","textBreakAll"];function zMe(e){return WMe(e)||qMe(e)||VMe(e)||UMe()}function UMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VMe(e,t){if(e){if(typeof e=="string")return fN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fN(e,t)}}function qMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WMe(e){if(Array.isArray(e))return fN(e)}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ig(){return Ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ig.apply(this,arguments)}function oH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(n),!0).forEach(function(r){HMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function HMe(e,t,n){return t=KMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KMe(e){var t=ZMe(e,"string");return Uf(t)=="symbol"?t:t+""}function ZMe(e,t){if(Uf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Uf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sH(e,t){if(e==null)return{};var n=GMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var XMe=function(e){return Array.isArray(e.value)?KM(e.value):e.value};function Rs(e){var t=e.valueAccessor,n=t===void 0?XMe:t,r=sH(e,FMe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=sH(r,BMe);return!a||!a.length?null:H.createElement(wn,{className:"recharts-label-list"},a.map(function(u,d){var f=wt(o)?n(u,d):eo(u&&u.payload,o),p=wt(s)?{}:{id:"".concat(s,"-").concat(d)};return H.createElement(Dn,Ig({},bt(u,!0),l,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:Dn.parseViewBox(wt(i)?u:iH(iH({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}Rs.displayName="LabelList";function JMe(e,t){return e?e===!0?H.createElement(Rs,{key:"labelList-implicit",data:t}):H.isValidElement(e)||at(e)?H.createElement(Rs,{key:"labelList-implicit",data:t,content:e}):pl(e)?H.createElement(Rs,Ig({data:t},e,{key:"labelList-implicit"})):null:null}function YMe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=Sa(r,Rs).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=JMe(e.label,t);return[o].concat(zMe(a))}Rs.renderCallByParent=YMe;function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}function pN(){return pN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pN.apply(this,arguments)}function cH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function lH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cH(Object(n),!0).forEach(function(r){QMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function QMe(e,t,n){return t=eke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eke(e){var t=tke(e,"string");return Vf(t)=="symbol"?t:t+""}function tke(e,t){if(Vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nke=function(e,t){var n=ja(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},Rg=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/Tg,d=c?a:a+o*u,f=Mn(t,n,l,d),p=Mn(t,n,r,d),m=c?a-o*u:a,y=Mn(t,n,l*Math.cos(u*Tg),m);return{center:f,circleTangency:p,lineTangency:y,theta:u}},uH=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=nke(o,i),c=o+s,l=Mn(t,n,a,o),u=Mn(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var f=Mn(t,n,r,o),p=Mn(t,n,r,c);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},rke=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=ja(l-c),d=Rg({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),f=d.circleTangency,p=d.lineTangency,m=d.theta,y=Rg({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=y.circleTangency,b=y.lineTangency,w=y.theta,j=s?Math.abs(c-l):Math.abs(c-l)-m-w;if(j<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):uH({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(j>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var _=Rg({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),S=_.circleTangency,E=_.lineTangency,O=_.theta,M=Rg({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),C=M.circleTangency,k=M.lineTangency,T=M.theta,P=s?Math.abs(c-l):Math.abs(c-l)-O-T;if(P<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(k.x,",").concat(k.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},ake={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},dH=function(e){var t=lH(lH({},ake),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var f=St("recharts-sector",d),p=o-a,m=Es(i,p,0,!0),y;return m>0&&Math.abs(l-u)<360?y=rke({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(m,p/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):y=uH({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),H.createElement("path",pN({},bt(t,!0),{className:f,d:y,role:"img"}))};function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function hN(){return hN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hN.apply(this,arguments)}function fH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function pH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fH(Object(n),!0).forEach(function(r){oke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oke(e,t,n){return t=ike(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ike(e){var t=ske(e,"string");return qf(t)=="symbol"?t:t+""}function ske(e,t){if(qf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(qf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hH={curveBasisClosed:K_e,curveBasisOpen:Z_e,curveBasis:H_e,curveBumpX:A_e,curveBumpY:T_e,curveLinearClosed:G_e,curveLinear:Hy,curveMonotoneX:X_e,curveMonotoneY:J_e,curveNatural:Y_e,curveStep:Q_e,curveStepAfter:tje,curveStepBefore:eje},Dg=function(e){return e.x===+e.x&&e.y===+e.y},Wf=function(e){return e.x},Hf=function(e){return e.y},cke=function(e,t){if(at(e))return e;var n="curve".concat(Uy(e));return(n==="curveMonotone"||n==="curveBump")&&t?hH["".concat(n).concat(t==="vertical"?"Y":"X")]:hH[n]||Hy},lke=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=cke(n,i),u=c?a.filter(function(m){return Dg(m)}):a,d;if(Array.isArray(o)){var f=c?o.filter(function(m){return Dg(m)}):o,p=u.map(function(m,y){return pH(pH({},m),{},{base:f[y]})});return i==="vertical"?d=Ky().y(Hf).x1(Wf).x0(function(m){return m.base.x}):d=Ky().x(Wf).y1(Hf).y0(function(m){return m.base.y}),d.defined(Dg).curve(l),d(p)}return i==="vertical"&&ye(o)?d=Ky().y(Hf).x1(Wf).x0(o):ye(o)?d=Ky().x(Wf).y1(Hf).y0(o):d=vU().x(Wf).y(Hf),d.defined(Dg).curve(l),d(u)},mH=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?lke(e):r;return H.createElement("path",hN({},bt(e,!1),By(e),{className:St("recharts-curve",t),d:o,ref:a}))},yH={exports:{}},mN,gH;function uke(){if(gH)return mN;gH=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return mN=e,mN}var yN,vH;function dke(){if(vH)return yN;vH=1;var e=uke();function t(){}function n(){}return n.resetWarningCache=t,yN=function(){function r(i,s,c,l,u,d){if(d!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},yN}var bH;function fke(){return bH||(bH=1,yH.exports=dke()()),yH.exports}var pke=fke();const Ke=st(pke);var hke=Object.getOwnPropertyNames,mke=Object.getOwnPropertySymbols,yke=Object.prototype.hasOwnProperty;function wH(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Lg(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function xH(e){return hke(e).concat(mke(e))}var _H=Object.hasOwn||function(e,t){return yke.call(e,t)};function Al(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var jH="_owner",SH=Object.getOwnPropertyDescriptor,EH=Object.keys;function gke(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function vke(e,t){return Al(e.getTime(),t.getTime())}function OH(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],p=d[1],m=s.value,y=m[0],v=m[1];!l&&!r[u]&&(l=n.equals(f,y,o,u,e,t,n)&&n.equals(p,v,f,y,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function bke(e,t,n){var r=EH(e),a=r.length;if(EH(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===jH&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!_H(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function Kf(e,t,n){var r=xH(e),a=r.length;if(xH(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===jH&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!_H(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=SH(e,o),s=SH(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function wke(e,t){return Al(e.valueOf(),t.valueOf())}function xke(e,t){return e.source===t.source&&e.flags===t.flags}function CH(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function _ke(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var jke="[object Arguments]",Ske="[object Boolean]",Eke="[object Date]",Oke="[object Map]",Cke="[object Number]",Nke="[object Object]",Mke="[object RegExp]",kke="[object Set]",Pke="[object String]",Ake=Array.isArray,NH=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,MH=Object.assign,Tke=Object.prototype.toString.call.bind(Object.prototype.toString);function Ike(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var f=l.constructor;if(f!==u.constructor)return!1;if(f===Object)return a(l,u,d);if(Ake(l))return t(l,u,d);if(NH!=null&&NH(l))return c(l,u,d);if(f===Date)return n(l,u,d);if(f===RegExp)return i(l,u,d);if(f===Map)return r(l,u,d);if(f===Set)return s(l,u,d);var p=Tke(l);return p===Eke?n(l,u,d):p===Mke?i(l,u,d):p===Oke?r(l,u,d):p===kke?s(l,u,d):p===Nke?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):p===jke?a(l,u,d):p===Ske||p===Cke||p===Pke?o(l,u,d):!1}}function Rke(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Kf:gke,areDatesEqual:vke,areMapsEqual:r?wH(OH,Kf):OH,areObjectsEqual:r?Kf:bke,arePrimitiveWrappersEqual:wke,areRegExpsEqual:xke,areSetsEqual:r?wH(CH,Kf):CH,areTypedArraysEqual:r?Kf:_ke};if(n&&(a=MH({},a,n(a))),t){var o=Lg(a.areArraysEqual),i=Lg(a.areMapsEqual),s=Lg(a.areObjectsEqual),c=Lg(a.areSetsEqual);a=MH({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function Dke(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function Lke(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,f=l.meta;return n(s,c,{cache:d,equals:a,meta:f,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var $ke=$i();$i({strict:!0}),$i({circular:!0}),$i({circular:!0,strict:!0}),$i({createInternalComparator:function(){return Al}}),$i({strict:!0,createInternalComparator:function(){return Al}}),$i({circular:!0,createInternalComparator:function(){return Al}}),$i({circular:!0,createInternalComparator:function(){return Al},strict:!0});function $i(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=Rke(e),c=Ike(s),l=r?r(c):Dke(c);return Lke({circular:n,comparator:c,createState:a,equals:l,strict:i})}function Fke(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function kH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):Fke(a)};requestAnimationFrame(r)}function gN(e){"@babel/helpers - typeof";return gN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gN(e)}function Bke(e){return qke(e)||Vke(e)||Uke(e)||zke()}function zke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uke(e,t){if(e){if(typeof e=="string")return PH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PH(e,t)}}function PH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qke(e){if(Array.isArray(e))return e}function Wke(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=Bke(i),c=s[0],l=s.slice(1);if(typeof c=="number"){kH(a.bind(null,l),c);return}a(c),kH(a.bind(null,l));return}gN(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}function AH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function TH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AH(Object(n),!0).forEach(function(r){IH(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function IH(e,t,n){return t=Hke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hke(e){var t=Kke(e,"string");return Zf(t)==="symbol"?t:String(t)}function Kke(e,t){if(Zf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Zf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zke=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},Gke=function(e){return e},Xke=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},Gf=function(e,t){return Object.keys(t).reduce(function(n,r){return TH(TH({},n),{},IH({},r,e(r,t[r])))},{})},RH=function(e,t,n){return e.map(function(r){return"".concat(Xke(r)," ").concat(t,"ms ").concat(n)}).join(",")};function Jke(e,t){return ePe(e)||Qke(e,t)||DH(e,t)||Yke()}function Yke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qke(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function ePe(e){if(Array.isArray(e))return e}function tPe(e){return aPe(e)||rPe(e)||DH(e)||nPe()}function nPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DH(e,t){if(e){if(typeof e=="string")return vN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vN(e,t)}}function rPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aPe(e){if(Array.isArray(e))return vN(e)}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $g=1e-4,LH=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},$H=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},FH=function(e,t){return function(n){var r=LH(e,t);return $H(r,n)}},oPe=function(e,t){return function(n){var r=LH(e,t),a=[].concat(tPe(r.map(function(o,i){return o*i}).slice(1)),[0]);return $H(a,n)}},BH=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),l=Jke(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=FH(r,o),d=FH(a,i),f=oPe(r,o),p=function(y){return y>1?1:y<0?0:y},m=function(y){for(var v=y>1?1:y,b=v,w=0;w<8;++w){var j=u(b)-v,x=f(b);if(Math.abs(j-v)<$g||x<$g)return d(b);b=p(b-j/x)}return d(b)};return m.isStepper=!1,m},iPe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,f=u*a,p=u+(d-f)*i/1e3,m=u*i/1e3+c;return Math.abs(m-l)<$g&&Math.abs(p)<$g?[l,0]:[m,p]};return s.isStepper=!0,s.dt=i,s},sPe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return BH(r);case"spring":return iPe();default:if(r.split("(")[0]==="cubic-bezier")return BH(r)}return typeof r=="function"?r:null};function Xf(e){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xf(e)}function zH(e){return uPe(e)||lPe(e)||VH(e)||cPe()}function cPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uPe(e){if(Array.isArray(e))return wN(e)}function UH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UH(Object(n),!0).forEach(function(r){bN(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function bN(e,t,n){return t=dPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dPe(e){var t=fPe(e,"string");return Xf(t)==="symbol"?t:String(t)}function fPe(e,t){if(Xf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pPe(e,t){return yPe(e)||mPe(e,t)||VH(e,t)||hPe()}function hPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VH(e,t){if(e){if(typeof e=="string")return wN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function yPe(e){if(Array.isArray(e))return e}var Fg=function(e,t,n){return e+(t-e)*n},xN=function(e){var t=e.from,n=e.to;return t!==n},gPe=function e(t,n,r){var a=Gf(function(o,i){if(xN(i)){var s=t(i.from,i.to,i.velocity),c=pPe(s,2),l=c[0],u=c[1];return kn(kn({},i),{},{from:l,velocity:u})}return i},n);return r<1?Gf(function(o,i){return xN(i)?kn(kn({},i),{},{velocity:Fg(i.velocity,a[o].velocity,r),from:Fg(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const vPe=function(e,t,n,r,a){var o=Zke(e,t),i=o.reduce(function(v,b){return kn(kn({},v),{},bN({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return kn(kn({},v),{},bN({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},f=function(){return Gf(function(v,b){return b.from},s)},p=function(){return!Object.values(s).filter(xN).length},m=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=gPe(n,s,w),a(kn(kn(kn({},e),t),f())),l=v,p()||(c=requestAnimationFrame(d))},y=function(v){u||(u=v);var b=(v-u)/r,w=Gf(function(x,_){return Fg.apply(void 0,zH(_).concat([n(b)]))},i);if(a(kn(kn(kn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var j=Gf(function(x,_){return Fg.apply(void 0,zH(_).concat([n(1)]))},i);a(kn(kn(kn({},e),t),j))}};return d=n.isStepper?m:y,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function Tl(e){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}var bPe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function wPe(e,t){if(e==null)return{};var n=xPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xPe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function _N(e){return EPe(e)||SPe(e)||jPe(e)||_Pe()}function _Pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jPe(e,t){if(e){if(typeof e=="string")return jN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jN(e,t)}}function SPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EPe(e){if(Array.isArray(e))return jN(e)}function jN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qH(Object(n),!0).forEach(function(r){Jf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Jf(e,t,n){return t=WH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WH(r.key),r)}}function NPe(e,t,n){return t&&CPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function WH(e){var t=MPe(e,"string");return Tl(t)==="symbol"?t:String(t)}function MPe(e,t){if(Tl(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Tl(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SN(e,t)}function SN(e,t){return SN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},SN(e,t)}function PPe(e){var t=APe();return function(){var n=Bg(e),r;if(t){var a=Bg(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return EN(this,r)}}function EN(e,t){if(t&&(Tl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ON(e)}function ON(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function APe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bg(e)}var Fi=function(e){kPe(n,e);var t=PPe(n);function n(r,a){var o;OPe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,f=i.children,p=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(ON(o)),o.changeStyle=o.changeStyle.bind(ON(o)),!s||p<=0)return o.state={style:{}},typeof f=="function"&&(o.state={style:u}),EN(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof f=="function")return o.state={style:l},EN(o);o.state={style:c?Jf({},c,l):l}}else o.state={style:{}};return o}return NPe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var f={style:s?Jf({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(f);return}if(!($ke(r.to,l)&&r.canBegin&&r.isActive)){var p=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=p||c?u:r.to;if(this.state&&d){var y={style:s?Jf({},s,m):m};(s&&d[s]!==m||!s&&d!==m)&&this.setState(y)}this.runAnimation(Oa(Oa({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,f=vPe(o,i,sPe(c),s,this.changeStyle),p=function(){a.stopJSAnimation=f()};this.manager.start([d,l,p,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,f=function(p,m,y){if(y===0)return p;var v=m.duration,b=m.easing,w=b===void 0?"ease":b,j=m.style,x=m.properties,_=m.onAnimationEnd,S=y>0?o[y-1]:m,E=x||Object.keys(j);if(typeof w=="function"||w==="spring")return[].concat(_N(p),[a.runJSAnimation.bind(a,{from:S.style,to:j,duration:v,easing:w}),v]);var O=RH(E,v,w),M=Oa(Oa(Oa({},S.style),j),{},{transition:O});return[].concat(_N(p),[M,v,_]).filter(Gke)};return this.manager.start([s].concat(_N(o.reduce(f,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=Wke());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,f=r.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var m=i?Jf({},i,s):s,y=RH(Object.keys(m),o,c);p.start([l,a,Oa(Oa({},m),{},{transition:y}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=wPe(r,bPe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var f=d.props,p=f.style,m=p===void 0?{}:p,y=f.className,v=g.cloneElement(d,Oa(Oa({},s),{},{style:Oa(Oa({},m),l),className:y}));return v};return c===1?u(g.Children.only(a)):H.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);Fi.displayName="Animate",Fi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},Fi.propTypes={from:Ke.oneOfType([Ke.object,Ke.string]),to:Ke.oneOfType([Ke.object,Ke.string]),attributeName:Ke.string,duration:Ke.number,begin:Ke.number,easing:Ke.oneOfType([Ke.string,Ke.func]),steps:Ke.arrayOf(Ke.shape({duration:Ke.number.isRequired,style:Ke.object.isRequired,easing:Ke.oneOfType([Ke.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ke.func]),properties:Ke.arrayOf("string"),onAnimationEnd:Ke.func})),children:Ke.oneOfType([Ke.node,Ke.func]),isActive:Ke.bool,canBegin:Ke.bool,onAnimationEnd:Ke.func,shouldReAnimate:Ke.bool,onAnimationStart:Ke.func,onAnimationReStart:Ke.func},Ke.object,Ke.object,Ke.object,Ke.element,Ke.object,Ke.object,Ke.object,Ke.oneOfType([Ke.array,Ke.element]),Ke.any;function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}function zg(){return zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zg.apply(this,arguments)}function TPe(e,t){return LPe(e)||DPe(e,t)||RPe(e,t)||IPe()}function IPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RPe(e,t){if(e){if(typeof e=="string")return HH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HH(e,t)}}function HH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function DPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function LPe(e){if(Array.isArray(e))return e}function KH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ZH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KH(Object(n),!0).forEach(function(r){$Pe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Pe(e,t,n){return t=FPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FPe(e){var t=BPe(e,"string");return Yf(t)=="symbol"?t:t+""}function BPe(e,t){if(Yf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Yf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GH=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var p=Math.min(o,a);l="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+s*p,",").concat(t,`
            L `).concat(e+n-s*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*p,`
            L `).concat(e+n,",").concat(t+r-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n-s*p,",").concat(t+r,`
            L `).concat(e+s*p,",").concat(t+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*p," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},zPe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},UPe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},CN=function(e){var t=ZH(ZH({},UPe),e),n=g.useRef(),r=g.useState(-1),a=TPe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&i(j)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,f=t.className,p=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=St("recharts-rectangle",f);return b?H.createElement(Fi,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:m,animationEasing:p,isActive:b},function(j){var x=j.width,_=j.height,S=j.x,E=j.y;return H.createElement(Fi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,isActive:v,easing:p},H.createElement("path",zg({},bt(t,!0),{className:w,d:GH(S,E,x,_,d),ref:n})))}):H.createElement("path",zg({},bt(t,!0),{className:w,d:GH(s,c,l,u,d)}))};function NN(){return NN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NN.apply(this,arguments)}var XH=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=St("recharts-dot",a);return t===+t&&n===+n&&r===+r?H.createElement("circle",NN({},bt(e,!1),By(e),{className:o,cx:t,cy:n,r})):null};function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}var VPe=["x","y","top","left","width","height","className"];function MN(){return MN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MN.apply(this,arguments)}function JH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qPe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JH(Object(n),!0).forEach(function(r){WPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WPe(e,t,n){return t=HPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HPe(e){var t=KPe(e,"string");return Qf(t)=="symbol"?t:t+""}function KPe(e,t){if(Qf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Qf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZPe(e,t){if(e==null)return{};var n=GPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var XPe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},JPe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,f=d===void 0?0:d,p=e.className,m=ZPe(e,VPe),y=qPe({x:n,y:a,top:i,left:c,width:u,height:f},m);return!ye(n)||!ye(a)||!ye(u)||!ye(f)||!ye(i)||!ye(c)?null:H.createElement("path",MN({},bt(y,!0),{className:St("recharts-cross",p),d:XPe(n,a,u,f,i,c)}))},kN,YH;zM=function(){if(YH)return kN;YH=1;var e=Co(),t=S0(),n=Pa(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&i.call(f)==c}return kN=l,kN};var YPe=zM();const QPe=st(YPe);var PN,QH;function eAe(){if(QH)return PN;QH=1;var e=Co(),t=Pa(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return PN=r,PN}var tAe=eAe();const nAe=st(tAe);function ep(e){"@babel/helpers - typeof";return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(e)}function Ug(){return Ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ug.apply(this,arguments)}function rAe(e,t){return sAe(e)||iAe(e,t)||oAe(e,t)||aAe()}function aAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oAe(e,t){if(e){if(typeof e=="string")return eK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eK(e,t)}}function eK(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function sAe(e){if(Array.isArray(e))return e}function tK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function nK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tK(Object(n),!0).forEach(function(r){cAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cAe(e,t,n){return t=lAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lAe(e){var t=uAe(e,"string");return ep(t)=="symbol"?t:t+""}function uAe(e,t){if(ep(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ep(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rK=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},dAe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fAe=function(e){var t=nK(nK({},dAe),e),n=g.useRef(),r=g.useState(-1),a=rAe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,f=t.className,p=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=St("recharts-trapezoid",f);return v?H.createElement(Fi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:m,animationEasing:p,isActive:v},function(w){var j=w.upperWidth,x=w.lowerWidth,_=w.height,S=w.x,E=w.y;return H.createElement(Fi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,easing:p},H.createElement("path",Ug({},bt(t,!0),{className:b,d:rK(S,E,j,x,_),ref:n})))}):H.createElement("g",null,H.createElement("path",Ug({},bt(t,!0),{className:b,d:rK(s,c,l,u,d)})))},pAe=["option","shapeType","propTransformer","activeClassName","isActive"];function tp(e){"@babel/helpers - typeof";return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(e)}function hAe(e,t){if(e==null)return{};var n=mAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mAe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function aK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Vg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aK(Object(n),!0).forEach(function(r){yAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yAe(e,t,n){return t=gAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gAe(e){var t=vAe(e,"string");return tp(t)=="symbol"?t:t+""}function vAe(e,t){if(tp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bAe(e,t){return Vg(Vg({},t),e)}function wAe(e,t){return e==="symbols"}function oK(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return H.createElement(CN,n);case"trapezoid":return H.createElement(fAe,n);case"sector":return H.createElement(dH,n);case"symbols":if(wAe(t))return H.createElement(vO,n);break;default:return null}}function xAe(e){return g.isValidElement(e)?e.props:e}function _Ae(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?bAe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=hAe(e,pAe),l;if(g.isValidElement(t))l=g.cloneElement(t,Vg(Vg({},c),xAe(t)));else if(at(t))l=t(c);else if(QPe(t)&&!nAe(t)){var u=a(t,c);l=H.createElement(oK,{shapeType:n,elementProps:u})}else{var d=c;l=H.createElement(oK,{shapeType:n,elementProps:d})}return s?H.createElement(wn,{className:i},l):l}function qg(e,t){return t!=null&&"trapezoids"in e.props}function Wg(e,t){return t!=null&&"sectors"in e.props}function np(e,t){return t!=null&&"points"in e.props}function jAe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function SAe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function EAe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function OAe(e,t){var n;return qg(e,t)?n=jAe:Wg(e,t)?n=SAe:np(e,t)&&(n=EAe),n}function CAe(e,t){var n;return qg(e,t)?n="trapezoids":Wg(e,t)?n="sectors":np(e,t)&&(n="points"),n}function NAe(e,t){if(qg(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Wg(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return np(e,t)?t.payload:{}}function MAe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=CAe(n,t),o=NAe(n,t),i=r.filter(function(c,l){var u=XC(o,c),d=n.props[a].filter(function(m){var y=OAe(n,t);return y(m,t)}),f=n.props[a].indexOf(d[d.length-1]),p=l===f;return u&&p}),s=r.indexOf(i[i.length-1]);return s}var AN,iK;function kAe(){if(iK)return AN;iK=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return AN=n,AN}var TN,sK;function PAe(){if(sK)return TN;sK=1;var e=kAe(),t=qs(),n=yB();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return TN=r,TN}var IN,cK;function AAe(){if(cK)return IN;cK=1;var e=PAe(),t=e();return IN=t,IN}var TAe=AAe();const Hg=st(TAe);function rp(e){"@babel/helpers - typeof";return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(e)}function lK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lK(Object(n),!0).forEach(function(r){dK(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dK(e,t,n){return t=IAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IAe(e){var t=RAe(e,"string");return rp(t)=="symbol"?t:t+""}function RAe(e,t){if(rp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DAe=["Webkit","Moz","O","ms"],LAe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=DAe.reduce(function(a,o){return uK(uK({},a),{},dK({},o+n,t))},{});return r[e]=t,r};function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}function Kg(){return Kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kg.apply(this,arguments)}function fK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function RN(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fK(Object(n),!0).forEach(function(r){Er(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mK(r.key),r)}}function FAe(e,t,n){return t&&pK(e.prototype,t),n&&pK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function BAe(e,t,n){return t=Zg(t),zAe(e,hK()?Reflect.construct(t,n||[],Zg(e).constructor):t.apply(e,n))}function zAe(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UAe(e)}function UAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hK=function(){return!!e})()}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zg(e)}function VAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DN(e,t)}function DN(e,t){return DN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},DN(e,t)}function Er(e,t,n){return t=mK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mK(e){var t=qAe(e,"string");return Il(t)=="symbol"?t:t+""}function qAe(e,t){if(Il(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Il(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WAe=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Nf().domain(Hg(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},yK=function(e){return e.changedTouches&&!!e.changedTouches.length},Rl=function(e){function t(n){var r;return $Ae(this,t),r=BAe(this,t,[n]),Er(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),Er(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),Er(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),Er(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Er(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Er(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Er(r,"handleSlideDragStart",function(a){var o=yK(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return VAe(t,e),FAe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),f=t.getIndexInRange(o,u),p=t.getIndexInRange(o,d);return{startIndex:f-f%s,endIndex:p===l?l:p-p%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=eo(a[n],i,n);return at(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,f=s.endIndex,p=s.onChange,m=n.pageX-a;m>0?m=Math.min(m,c+l-u-i,c+l-u-o):m<0&&(m=Math.max(m,c-o,c-i));var y=this.getIndex({startX:o+m,endX:i+m});(y.startIndex!==d||y.endIndex!==f)&&p&&p(y),this.setState({startX:o+m,endX:i+m,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=yK(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,f=l.travellerWidth,p=l.onChange,m=l.gap,y=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-f-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),j=w.startIndex,x=w.endIndex,_=function(){var S=y.length-1;return o==="startX"&&(i>s?j%m===0:x%m===0)||i<s&&x===S||o==="endX"&&(i>s?x%m===0:j%m===0)||i>s&&x===S};this.setState(Er(Er({},o,c+b),"brushMoveStartX",n.pageX),function(){p&&_()&&p(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var f=i[d];r==="startX"&&f>=c||r==="endX"&&f<=s||this.setState(Er({},r,f),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return H.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?H.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,f=s.ariaLabel,p=s.data,m=s.startIndex,y=s.endIndex,v=Math.max(n,this.props.x),b=RN(RN({},bt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=f||"Min value: ".concat((a=p[m])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=p[y])===null||o===void 0?void 0:o.name);return H.createElement(wn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),i.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return H.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,f=5,p={pointerEvents:"none",fill:c};return H.createElement(wn,{className:"recharts-brush-texts"},H.createElement(sg,Kg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-f,y:o+i/2},p),this.getTextOfTick(r)),H.createElement(sg,Kg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+f,y:o+i/2},p),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,f=d.startX,p=d.endX,m=d.isTextActive,y=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=St("recharts-brush",a),j=H.Children.count(o)===1,x=LAe("userSelect","none");return H.createElement(wn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(m||y||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return H.createElement(H.Fragment,null,H.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),H.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),H.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return H.isValidElement(n)?a=H.cloneElement(n,r):at(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return RN({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?WAe({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(f){return r.scale(f)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);Er(Rl,"displayName","Brush"),Er(Rl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var LN,gK;function HAe(){if(gK)return LN;gK=1;var e=BO();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return LN=t,LN}var $N,vK;function KAe(){if(vK)return $N;vK=1;var e=WR(),t=Fa(),n=HAe(),r=zn(),a=qs();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return $N=o,$N}var ZAe=KAe();const GAe=st(ZAe);var to=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},FN,bK;function XAe(){if(bK)return FN;bK=1;var e=Tv(),t=cV(),n=Fa();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return FN=r,FN}var JAe=XAe();const YAe=st(JAe);var BN,wK;function QAe(){if(wK)return BN;wK=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return BN=e,BN}var zN,xK;function e2e(){if(xK)return zN;xK=1;var e=BO();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return zN=t,zN}var UN,_K;function t2e(){if(_K)return UN;_K=1;var e=QAe(),t=e2e(),n=Fa(),r=zn(),a=qs();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return UN=o,UN}var n2e=t2e();const jK=st(n2e);var r2e=["x","y"];function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function VN(){return VN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VN.apply(this,arguments)}function SK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function op(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SK(Object(n),!0).forEach(function(r){a2e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function a2e(e,t,n){return t=o2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o2e(e){var t=i2e(e,"string");return ap(t)=="symbol"?t:t+""}function i2e(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ap(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s2e(e,t){if(e==null)return{};var n=c2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function l2e(e,t){var n=e.x,r=e.y,a=s2e(e,r2e),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),f=parseInt(d,10);return op(op(op(op(op({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function EK(e){return H.createElement(_Ae,VN({shapeType:"rectangle",propTransformer:l2e,activeClassName:"recharts-active-bar"},e))}var u2e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||Ts(),t)}},d2e=["value","background"],OK;function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}function f2e(e,t){if(e==null)return{};var n=p2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function p2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Gg(){return Gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gg.apply(this,arguments)}function CK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CK(Object(n),!0).forEach(function(r){Bi(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kK(r.key),r)}}function m2e(e,t,n){return t&&NK(e.prototype,t),n&&NK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y2e(e,t,n){return t=Xg(t),g2e(e,MK()?Reflect.construct(t,n||[],Xg(e).constructor):t.apply(e,n))}function g2e(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v2e(e)}function v2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MK=function(){return!!e})()}function Xg(e){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xg(e)}function b2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qN(e,t)}function qN(e,t){return qN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},qN(e,t)}function Bi(e,t,n){return t=kK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kK(e){var t=w2e(e,"string");return Dl(t)=="symbol"?t:t+""}function w2e(e,t){if(Dl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ds=function(e){function t(){var n;h2e(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=y2e(this,t,[].concat(a)),Bi(n,"state",{isAnimationFinished:!1}),Bi(n,"id",Fy("recharts-bar-")),Bi(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Bi(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return b2e(t,e),m2e(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=bt(this.props,!1);return n&&n.map(function(u,d){var f=d===s,p=f?c:o,m=cn(cn(cn({},l),u),{},{isActive:f,option:p,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return H.createElement(wn,Gg({className:"recharts-bar-rectangle"},zy(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),H.createElement(EK,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return H.createElement(Fi,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,m=a.map(function(y,v){var b=d&&d[v];if(b){var w=hl(b.x,y.x),j=hl(b.y,y.y),x=hl(b.width,y.width),_=hl(b.height,y.height);return cn(cn({},y),{},{x:w(p),y:j(p),width:x(p),height:_(p)})}if(o==="horizontal"){var S=hl(0,y.height),E=S(p);return cn(cn({},y),{},{y:y.y+y.height-E,height:E})}var O=hl(0,y.width),M=O(p);return cn(cn({},y),{},{width:M})});return H.createElement(wn,null,n.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!XC(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=bt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=f2e(c,d2e);if(!u)return null;var f=cn(cn(cn(cn(cn({},d),{},{fill:"#eee"},u),s),zy(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return H.createElement(EK,Gg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},f))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=Sa(l,Mg);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,f=function(m,y){var v=Array.isArray(m.value)?m.value[1]:m.value;return{x:m.x,y:m.y,value:v,errorVal:eo(m,y)}},p={clipPath:n?"url(#clipPath-".concat(r,")"):null};return H.createElement(wn,p,u.map(function(m){return H.cloneElement(m,{key:"error-bar-".concat(r,"-").concat(m.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,f=n.isAnimationActive,p=n.background,m=n.id;if(r||!a||!a.length)return null;var y=this.state.isAnimationFinished,v=St("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,j=b||w,x=wt(m)?this.id:m;return H.createElement(wn,{className:v},b||w?H.createElement("defs",null,H.createElement("clipPath",{id:"clipPath-".concat(x)},H.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,H.createElement(wn,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(x,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,x),(!f||y)&&Rs.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);OK=Ds,Bi(Ds,"displayName","Bar"),Bi(Ds,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ti.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Bi(Ds,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,f=e.offset,p=eMe(r,n);if(!p)return null;var m=t.layout,y=n.type.defaultProps,v=y!==void 0?cn(cn({},y),n.props):n.props,b=v.dataKey,w=v.children,j=v.minPointSize,x=m==="horizontal"?i:o,_=l?x.scale.domain():null,S=cMe({numericAxis:x}),E=Sa(w,UV),O=d.map(function(M,C){var k,T,P,N,I,A;l?k=tMe(l[u+C],_):(k=eo(M,b),Array.isArray(k)||(k=[S,k]));var R=u2e(j,OK.defaultProps.minPointSize)(k[1],C);if(m==="horizontal"){var L,D=[i.scale(k[0]),i.scale(k[1])],B=D[0],F=D[1];T=KW({axis:o,ticks:s,bandSize:a,offset:p.offset,entry:M,index:C}),P=(L=F??B)!==null&&L!==void 0?L:void 0,N=p.size;var $=B-F;if(I=Number.isNaN($)?0:$,A={x:T,y:i.y,width:N,height:i.height},Math.abs(R)>0&&Math.abs(I)<Math.abs(R)){var z=ja(I||R)*(Math.abs(R)-Math.abs(I));P-=z,I+=z}}else{var X=[o.scale(k[0]),o.scale(k[1])],G=X[0],q=X[1];if(T=G,P=KW({axis:i,ticks:c,bandSize:a,offset:p.offset,entry:M,index:C}),N=q-G,I=p.size,A={x:o.x,y:P,width:o.width,height:I},Math.abs(R)>0&&Math.abs(N)<Math.abs(R)){var J=ja(N||R)*(Math.abs(R)-Math.abs(N));N+=J}}return cn(cn(cn({},M),{},{x:T,y:P,width:N,height:I,value:l?k:k[1],payload:M,background:A},E&&E[C]&&E[C].props),{},{tooltipPayload:[YW(n,M)],tooltipPosition:{x:T+N/2,y:P+I/2}})});return cn({data:O,layout:m},f)});function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function x2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,TK(r.key),r)}}function _2e(e,t,n){return t&&PK(e.prototype,t),n&&PK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function AK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ca(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AK(Object(n),!0).forEach(function(r){Jg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Jg(e,t,n){return t=TK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TK(e){var t=j2e(e,"string");return ip(t)=="symbol"?t:t+""}function j2e(e,t){if(ip(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ip(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S2e=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!jr(c,Ds);return l.reduce(function(f,p){var m=t[p],y=m.orientation,v=m.domain,b=m.padding,w=b===void 0?{}:b,j=m.mirror,x=m.reversed,_="".concat(y).concat(j?"Mirror":""),S,E,O,M,C;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var k=v[1]-v[0],T=1/0,P=m.categoricalDomain.sort();if(P.forEach(function(z,X){X>0&&(T=Math.min((z||0)-(P[X-1]||0),T))}),Number.isFinite(T)){var N=T/k,I=m.layout==="vertical"?n.height:n.width;if(m.padding==="gap"&&(S=N*I/2),m.padding==="no-gap"){var A=Es(e.barCategoryGap,N*I),R=N*I/2;S=R-A-(R-A)/I*A}}}r==="xAxis"?E=[n.left+(w.left||0)+(S||0),n.left+n.width-(w.right||0)-(S||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(S||0),n.top+n.height-(w.bottom||0)-(S||0)]:E=m.range,x&&(E=[E[1],E[0]]);var L=YNe(m,a,d),D=L.scale,B=L.realScaleType;D.domain(v).range(E),QNe(D);var F=sMe(D,Ca(Ca({},m),{},{realScaleType:B}));r==="xAxis"?(C=y==="top"&&!j||y==="bottom"&&j,O=n.left,M=u[_]-C*m.height):r==="yAxis"&&(C=y==="left"&&!j||y==="right"&&j,O=u[_]-C*m.width,M=n.top);var $=Ca(Ca(Ca({},m),F),{},{realScaleType:B,x:O,y:M,scale:D,width:r==="xAxis"?n.width:m.width,height:r==="yAxis"?n.height:m.height});return $.bandSize=Ag($,F),!m.hide&&r==="xAxis"?u[_]+=(C?-1:1)*$.height:m.hide||(u[_]+=(C?-1:1)*$.width),Ca(Ca({},f),{},Jg({},p,$))},{})},IK=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},E2e=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return IK({x:t,y:n},{x:r,y:a})},RK=function(){function e(t){x2e(this,e),this.scale=t}return _2e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();Jg(RK,"EPS",1e-4);var WN=function(e){var t=Object.keys(e).reduce(function(n,r){return Ca(Ca({},n),{},Jg({},r,RK.create(e[r])))},{});return Ca(Ca({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return YAe(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return jK(n,function(r,a){return t[a].isInRange(r)})}})};function O2e(e){return(e%180+180)%180}var C2e=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=O2e(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},HN,DK;function N2e(){if(DK)return HN;DK=1;var e=Fa(),t=Wi(),n=fu();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return HN=r,HN}var KN,LK;function M2e(){if(LK)return KN;LK=1;var e=BU(),t=Fa(),n=vB(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return KN=a,KN}var ZN,$K;function k2e(){if($K)return ZN;$K=1;var e=N2e(),t=M2e(),n=e(t);return ZN=n,ZN}var P2e=k2e();const A2e=st(P2e);var T2e=GD(),I2e=st(T2e)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),GN=g.createContext(void 0),XN=g.createContext(void 0),FK=g.createContext(void 0),BK=g.createContext({}),zK=g.createContext(void 0),UK=g.createContext(0),VK=g.createContext(0),qK=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=I2e(a);return H.createElement(GN.Provider,{value:n},H.createElement(XN.Provider,{value:r},H.createElement(BK.Provider,{value:a},H.createElement(FK.Provider,{value:l},H.createElement(zK.Provider,{value:o},H.createElement(UK.Provider,{value:c},H.createElement(VK.Provider,{value:s},i)))))))},R2e=function(){return g.useContext(zK)},WK=function(e){var t=g.useContext(GN);t==null&&Ts();var n=t[e];return n==null&&Ts(),n},D2e=function(){var e=g.useContext(GN);return Ai(e)},L2e=function(){var e=g.useContext(XN),t=A2e(e,function(n){return jK(n.domain,Number.isFinite)});return t||Ai(e)},HK=function(e){var t=g.useContext(XN);t==null&&Ts();var n=t[e];return n==null&&Ts(),n},$2e=function(){var e=g.useContext(FK);return e},F2e=function(){return g.useContext(BK)},JN=function(){return g.useContext(VK)},YN=function(){return g.useContext(UK)};function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function B2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z2e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,XK(r.key),r)}}function U2e(e,t,n){return t&&z2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function V2e(e,t,n){return t=Yg(t),q2e(e,KK()?Reflect.construct(t,n||[],Yg(e).constructor):t.apply(e,n))}function q2e(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W2e(e)}function W2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KK=function(){return!!e})()}function Yg(e){return Yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yg(e)}function H2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QN(e,t)}function QN(e,t){return QN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QN(e,t)}function ZK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function GK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZK(Object(n),!0).forEach(function(r){eM(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function eM(e,t,n){return t=XK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XK(e){var t=K2e(e,"string");return Ll(t)=="symbol"?t:t+""}function K2e(e,t){if(Ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z2e(e,t){return Y2e(e)||J2e(e,t)||X2e(e,t)||G2e()}function G2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X2e(e,t){if(e){if(typeof e=="string")return JK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JK(e,t)}}function JK(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J2e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Y2e(e){if(Array.isArray(e))return e}function tM(){return tM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tM.apply(this,arguments)}var Q2e=function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):at(e)?n=e(t):n=H.createElement("line",tM({},t,{className:"recharts-reference-line-line"})),n},eTe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,f=a.height;if(n){var p=c.y,m=e.y.apply(p,{position:o});if(to(c,"discard")&&!e.y.isInRange(m))return null;var y=[{x:l+d,y:m},{x:l,y:m}];return s==="left"?y.reverse():y}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(to(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+f},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var j=c.segment,x=j.map(function(_){return e.apply(_,{position:o})});return to(c,"discard")&&GAe(x,function(_){return!e.isInRange(_)})?null:x}return null};function tTe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=R2e(),u=WK(a),d=HK(o),f=$2e();if(!l||!f)return null;qo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=WN({x:u.scale,y:d.scale}),m=hn(t),y=hn(n),v=r&&r.length===2,b=eTe(p,m,y,v,f,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=Z2e(b,2),j=w[0],x=j.x,_=j.y,S=w[1],E=S.x,O=S.y,M=to(e,"hidden")?"url(#".concat(l,")"):void 0,C=GK(GK({clipPath:M},bt(e,!0)),{},{x1:x,y1:_,x2:E,y2:O});return H.createElement(wn,{className:St("recharts-reference-line",s)},Q2e(i,C),Dn.renderCallByParent(e,E2e({x1:x,y1:_,x2:E,y2:O})))}var nM=function(e){function t(){return B2e(this,t),V2e(this,t,arguments)}return H2e(t,e),U2e(t,[{key:"render",value:function(){return H.createElement(tTe,this.props)}}])}(H.Component);eM(nM,"displayName","ReferenceLine"),eM(nM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function rM(){return rM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rM.apply(this,arguments)}function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function YK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function QK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YK(Object(n),!0).forEach(function(r){ev(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tZ(r.key),r)}}function aTe(e,t,n){return t&&rTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oTe(e,t,n){return t=Qg(t),iTe(e,eZ()?Reflect.construct(t,n||[],Qg(e).constructor):t.apply(e,n))}function iTe(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sTe(e)}function sTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eZ=function(){return!!e})()}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qg(e)}function cTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aM(e,t)}function aM(e,t){return aM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},aM(e,t)}function ev(e,t,n){return t=tZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tZ(e){var t=lTe(e,"string");return $l(t)=="symbol"?t:t+""}function lTe(e,t){if($l(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($l(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uTe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=WN({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return to(e,"discard")&&!o.isInRange(i)?null:i},tv=function(e){function t(){return nTe(this,t),oTe(this,t,arguments)}return cTe(t,e),aTe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=hn(r),l=hn(a);if(qo(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=uTe(this.props);if(!u)return null;var d=u.x,f=u.y,p=this.props,m=p.shape,y=p.className,v=to(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=QK(QK({clipPath:v},bt(this.props,!0)),{},{cx:d,cy:f});return H.createElement(wn,{className:St("recharts-reference-dot",y)},t.renderDot(m,b),Dn.renderCallByParent(this.props,{x:d-o,y:f-o,width:2*o,height:2*o}))}}])}(H.Component);ev(tv,"displayName","ReferenceDot"),ev(tv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),ev(tv,"renderDot",function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):at(e)?n=e(t):n=H.createElement(XH,rM({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function oM(){return oM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oM.apply(this,arguments)}function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}function nZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function rZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(n),!0).forEach(function(r){rv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oZ(r.key),r)}}function pTe(e,t,n){return t&&fTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hTe(e,t,n){return t=nv(t),mTe(e,aZ()?Reflect.construct(t,n||[],nv(e).constructor):t.apply(e,n))}function mTe(e,t){if(t&&(Fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yTe(e)}function yTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aZ=function(){return!!e})()}function nv(e){return nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nv(e)}function gTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iM(e,t)}function iM(e,t){return iM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},iM(e,t)}function rv(e,t,n){return t=oZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oZ(e){var t=vTe(e,"string");return Fl(t)=="symbol"?t:t+""}function vTe(e,t){if(Fl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bTe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=WN({x:l.scale,y:u.scale}),f={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},p={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return to(a,"discard")&&(!d.isInRange(f)||!d.isInRange(p))?null:IK(f,p)},av=function(e){function t(){return dTe(this,t),hTe(this,t,arguments)}return gTe(t,e),pTe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;qo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=hn(r),d=hn(a),f=hn(o),p=hn(i),m=this.props.shape;if(!u&&!d&&!f&&!p&&!m)return null;var y=bTe(u,d,f,p,this.props);if(!y&&!m)return null;var v=to(this.props,"hidden")?"url(#".concat(l,")"):void 0;return H.createElement(wn,{className:St("recharts-reference-area",s)},t.renderRect(m,rZ(rZ({clipPath:v},bt(this.props,!0)),y)),Dn.renderCallByParent(this.props,y))}}])}(H.Component);rv(av,"displayName","ReferenceArea"),rv(av,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),rv(av,"renderRect",function(e,t){var n;return H.isValidElement(e)?n=H.cloneElement(e,t):at(e)?n=e(t):n=H.createElement(CN,oM({},t,{className:"recharts-reference-area-rect"})),n});function iZ(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function wTe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return C2e(r,n)}function xTe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function ov(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function _Te(e,t){return iZ(e,t+1)}function jTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var p=r==null?void 0:r[c];if(p===void 0)return{v:iZ(r,l)};var m=c,y,v=function(){return y===void 0&&(y=n(p,m)),y},b=p.coordinate,w=c===0||ov(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},f;l<=o.length;)if(f=d(),f)return f.v;return[]}function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function sZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ln(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sZ(Object(n),!0).forEach(function(r){STe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function STe(e,t,n){return t=ETe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ETe(e){var t=OTe(e,"string");return sp(t)=="symbol"?t:t+""}function OTe(e,t){if(sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var f=o[d],p,m=function(){return p===void 0&&(p=n(f,d)),p};if(d===i-1){var y=e*(f.coordinate+e*m()/2-c);o[d]=f=Ln(Ln({},f),{},{tickCoord:y>0?f.coordinate-y*e:f.coordinate})}else o[d]=f=Ln(Ln({},f),{},{tickCoord:f.coordinate});var v=ov(e,f.tickCoord,m,s,c);v&&(c=f.tickCoord-e*(m()/2+a),o[d]=Ln(Ln({},f),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function NTe(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);i[s-1]=u=Ln(Ln({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var p=ov(e,u.tickCoord,function(){return d},c,l);p&&(l=u.tickCoord-e*(d/2+a),i[s-1]=Ln(Ln({},u),{},{isShow:!0}))}for(var m=o?s-1:s,y=function(b){var w=i[b],j,x=function(){return j===void 0&&(j=n(w,b)),j};if(b===0){var _=e*(w.coordinate-e*x()/2-c);i[b]=w=Ln(Ln({},w),{},{tickCoord:_<0?w.coordinate-_*e:w.coordinate})}else i[b]=w=Ln(Ln({},w),{},{tickCoord:w.coordinate});var S=ov(e,w.tickCoord,x,c,l);S&&(c=w.tickCoord+e*(x()/2+a),i[b]=Ln(Ln({},w),{},{isShow:!0}))},v=0;v<m;v++)y(v);return i}function sM(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||Ti.isSsr)return _Te(a,typeof c=="number"&&ye(c)?c:0);var f=[],p=s==="top"||s==="bottom"?"width":"height",m=u&&p==="width"?jf(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},y=function(w,j){var x=at(l)?l(w.value,j):w.value;return p==="width"?wTe(jf(x,{fontSize:t,letterSpacing:n}),m,d):jf(x,{fontSize:t,letterSpacing:n})[p]},v=a.length>=2?ja(a[1].coordinate-a[0].coordinate):1,b=xTe(o,v,p);return c==="equidistantPreserveStart"?jTe(v,b,y,a,i):(c==="preserveStart"||c==="preserveStartEnd"?f=NTe(v,b,y,a,i,c==="preserveStartEnd"):f=CTe(v,b,y,a,i),f.filter(function(w){return w.isShow}))}var MTe=["viewBox"],kTe=["viewBox"],PTe=["ticks"];function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function zl(){return zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zl.apply(this,arguments)}function cZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cZ(Object(n),!0).forEach(function(r){uM(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cM(e,t){if(e==null)return{};var n=ATe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ATe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function TTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dZ(r.key),r)}}function ITe(e,t,n){return t&&lZ(e.prototype,t),n&&lZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function RTe(e,t,n){return t=iv(t),DTe(e,uZ()?Reflect.construct(t,n||[],iv(e).constructor):t.apply(e,n))}function DTe(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LTe(e)}function LTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uZ=function(){return!!e})()}function iv(e){return iv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iv(e)}function $Te(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lM(e,t)}function lM(e,t){return lM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},lM(e,t)}function uM(e,t,n){return t=dZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dZ(e){var t=FTe(e,"string");return Bl(t)=="symbol"?t:t+""}function FTe(e,t){if(Bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ul=function(e){function t(n){var r;return TTe(this,t),r=RTe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return $Te(t,e),ITe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=cM(n,MTe),i=this.props,s=i.viewBox,c=cM(i,kTe);return!ml(a,s)||!ml(o,c)||!ml(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,f,p,m,y,v,b,w=u?-1:1,j=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=p=n.coordinate,y=o+ +!u*s,m=y-w*j,b=m-w*d,v=x;break;case"left":m=y=n.coordinate,p=a+ +!u*i,f=p-w*j,v=f-w*d,b=x;break;case"right":m=y=n.coordinate,p=a+ +u*i,f=p+w*j,v=f+w*d,b=x;break;default:f=p=n.coordinate,y=o+ +u*s,m=y+w*j,b=m+w*d,v=x;break}return{line:{x1:f,y1:m,x2:p,y2:y},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=Gn(Gn(Gn({},bt(this.props,!1)),bt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=Gn(Gn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var f=+(s==="left"&&!c||s==="right"&&c);u=Gn(Gn({},u),{},{x1:r+f*o,y1:a,x2:r+f*o,y2:a+i})}return H.createElement("line",zl({},u,{className:St("recharts-cartesian-axis-line",Ar(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,f=sM(Gn(Gn({},this.props),{},{ticks:n}),r,a),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),y=bt(this.props,!1),v=bt(l,!1),b=Gn(Gn({},y),{},{fill:"none"},bt(s,!1)),w=f.map(function(j,x){var _=o.getTickLineCoord(j),S=_.line,E=_.tick,O=Gn(Gn(Gn(Gn({textAnchor:p,verticalAnchor:m},y),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:j,visibleTicksCount:f.length,tickFormatter:u});return H.createElement(wn,zl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},zy(o.props,j,x)),s&&H.createElement("line",zl({},b,S,{className:St("recharts-cartesian-axis-tick-line",Ar(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(at(u)?u(j.value,x):j.value).concat(d||"")))});return H.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,f=cM(u,PTe),p=d;return at(s)&&(p=d&&d.length>0?s(this.props):s(f)),o<=0||i<=0||!p||!p.length?null:H.createElement(wn,{className:St("recharts-cartesian-axis",c),ref:function(m){n.layerReference=m}},a&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Dn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return H.isValidElement(n)?o=H.cloneElement(n,r):at(n)?o=n(r):o=H.createElement(sg,zl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);uM(Ul,"displayName","CartesianAxis"),uM(Ul,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var BTe=["x1","y1","x2","y2","key"],zTe=["offset"];function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function fZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fZ(Object(n),!0).forEach(function(r){UTe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function UTe(e,t,n){return t=VTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VTe(e){var t=qTe(e,"string");return Ls(t)=="symbol"?t:t+""}function qTe(e,t){if(Ls(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ls(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $s(){return $s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$s.apply(this,arguments)}function pZ(e,t){if(e==null)return{};var n=WTe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WTe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var HTe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return H.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function hZ(e,t){var n;if(H.isValidElement(e))n=H.cloneElement(e,t);else if(at(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=pZ(t,BTe),l=bt(c,!1);l.offset;var u=pZ(l,zTe);n=H.createElement("line",$s({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function KTe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=$n($n({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return hZ(a,l)});return H.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function ZTe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=$n($n({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return hZ(a,l)});return H.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function GTe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var m=!u[p+1],y=m?a+i-f:u[p+1]-f;if(y<=0)return null;var v=p%t.length;return H.createElement("rect",{key:"react-".concat(p),y:f,x:r,height:y,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return H.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function XTe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(f){return Math.round(f+o-o)}).sort(function(f,p){return f-p});o!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var m=!u[p+1],y=m?o+s-f:u[p+1]-f;if(y<=0)return null;var v=p%r.length;return H.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:y,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return H.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var JTe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return WW(sM($n($n($n({},Ul.defaultProps),n),{},{ticks:Qo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},YTe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return WW(sM($n($n($n({},Ul.defaultProps),n),{},{ticks:Qo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},Vl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function mZ(e){var t,n,r,a,o,i,s=JN(),c=YN(),l=F2e(),u=$n($n({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Vl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Vl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Vl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Vl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Vl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Vl.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,f=u.y,p=u.width,m=u.height,y=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=D2e(),j=L2e();if(!ye(p)||p<=0||!ye(m)||m<=0||!ye(d)||d!==+d||!ye(f)||f!==+f)return null;var x=u.verticalCoordinatesGenerator||JTe,_=u.horizontalCoordinatesGenerator||YTe,S=u.horizontalPoints,E=u.verticalPoints;if((!S||!S.length)&&at(_)){var O=v&&v.length,M=_({yAxis:j?$n($n({},j),{},{ticks:O?v:j.ticks}):void 0,width:s,height:c,offset:l},O?!0:y);qo(Array.isArray(M),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Ls(M),"]")),Array.isArray(M)&&(S=M)}if((!E||!E.length)&&at(x)){var C=b&&b.length,k=x({xAxis:w?$n($n({},w),{},{ticks:C?b:w.ticks}):void 0,width:s,height:c,offset:l},C?!0:y);qo(Array.isArray(k),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Ls(k),"]")),Array.isArray(k)&&(E=k)}return H.createElement("g",{className:"recharts-cartesian-grid"},H.createElement(HTe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),H.createElement(KTe,$s({},u,{offset:l,horizontalPoints:S,xAxis:w,yAxis:j})),H.createElement(ZTe,$s({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:j})),H.createElement(GTe,$s({},u,{horizontalPoints:S})),H.createElement(XTe,$s({},u,{verticalPoints:E})))}mZ.displayName="CartesianGrid";function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function QTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vZ(r.key),r)}}function tIe(e,t,n){return t&&eIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nIe(e,t,n){return t=sv(t),rIe(e,yZ()?Reflect.construct(t,n||[],sv(e).constructor):t.apply(e,n))}function rIe(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aIe(e)}function aIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yZ=function(){return!!e})()}function sv(e){return sv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sv(e)}function oIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dM(e,t)}function dM(e,t){return dM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},dM(e,t)}function gZ(e,t,n){return t=vZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vZ(e){var t=iIe(e,"string");return ql(t)=="symbol"?t:t+""}function iIe(e,t){if(ql(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ql(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fM(){return fM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fM.apply(this,arguments)}function sIe(e){var t=e.xAxisId,n=JN(),r=YN(),a=WK(t);return a==null?null:H.createElement(Ul,fM({},a,{className:St("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Qo(o,!0)}}))}var cv=function(e){function t(){return QTe(this,t),nIe(this,t,arguments)}return oIe(t,e),tIe(t,[{key:"render",value:function(){return H.createElement(sIe,this.props)}}])}(H.Component);gZ(cv,"displayName","XAxis"),gZ(cv,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function cIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xZ(r.key),r)}}function uIe(e,t,n){return t&&lIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dIe(e,t,n){return t=lv(t),fIe(e,bZ()?Reflect.construct(t,n||[],lv(e).constructor):t.apply(e,n))}function fIe(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pIe(e)}function pIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bZ=function(){return!!e})()}function lv(e){return lv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lv(e)}function hIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pM(e,t)}function pM(e,t){return pM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},pM(e,t)}function wZ(e,t,n){return t=xZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xZ(e){var t=mIe(e,"string");return Wl(t)=="symbol"?t:t+""}function mIe(e,t){if(Wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hM(){return hM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hM.apply(this,arguments)}var yIe=function(e){var t=e.yAxisId,n=JN(),r=YN(),a=HK(t);return a==null?null:H.createElement(Ul,hM({},a,{className:St("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Qo(o,!0)}}))},mM=function(e){function t(){return cIe(this,t),dIe(this,t,arguments)}return hIe(t,e),uIe(t,[{key:"render",value:function(){return H.createElement(yIe,this.props)}}])}(H.Component);wZ(mM,"displayName","YAxis"),wZ(mM,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function _Z(e){return wIe(e)||bIe(e)||vIe(e)||gIe()}function gIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vIe(e,t){if(e){if(typeof e=="string")return yM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yM(e,t)}}function bIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wIe(e){if(Array.isArray(e))return yM(e)}function yM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var gM=function(e,t,n,r,a){var o=Sa(e,nM),i=Sa(e,tv),s=[].concat(_Z(o),_Z(i)),c=Sa(e,av),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(m,y){if(y.props[l]===n&&to(y.props,"extendDomain")&&ye(y.props[u])){var v=y.props[u];return[Math.min(m[0],v),Math.max(m[1],v)]}return m},d)),c.length){var f="".concat(u,"1"),p="".concat(u,"2");d=c.reduce(function(m,y){if(y.props[l]===n&&to(y.props,"extendDomain")&&ye(y.props[f])&&ye(y.props[p])){var v=y.props[f],b=y.props[p];return[Math.min(m[0],v,b),Math.max(m[1],v,b)]}return m},d)}return a&&a.length&&(d=a.reduce(function(m,y){return ye(y)?[Math.min(m[0],y),Math.max(m[1],y)]:m},d)),d},jZ={exports:{}},SZ;function xIe(){return SZ||(SZ=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,d||c,f),m=n?n+l:l;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,f,p){var m=n?n+c:c;if(!this._events[m])return!1;var y=this._events[m],v=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,u),!0;case 4:return y.fn.call(y.context,l,u,d),!0;case 5:return y.fn.call(y.context,l,u,d,f),!0;case 6:return y.fn.call(y.context,l,u,d,f,p),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var j=y.length,x;for(w=0;w<j;w++)switch(y[w].once&&this.removeListener(c,y[w].fn,void 0,!0),v){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,l);break;case 3:y[w].fn.call(y[w].context,l,u);break;case 4:y[w].fn.call(y[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];y[w].fn.apply(y[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var f=n?n+c:c;if(!this._events[f])return this;if(!l)return i(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&i(this,f);else{for(var m=0,y=[],v=p.length;m<v;m++)(p[m].fn!==l||d&&!p[m].once||u&&p[m].context!==u)&&y.push(p[m]);y.length?this._events[f]=y.length===1?y[0]:y:i(this,f)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(jZ)),jZ.exports}var _Ie=xIe();const jIe=st(_Ie);var vM=new jIe,bM="recharts.syncMouseEvents";function cp(e){"@babel/helpers - typeof";return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function SIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,EZ(r.key),r)}}function OIe(e,t,n){return t&&EIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wM(e,t,n){return t=EZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EZ(e){var t=CIe(e,"string");return cp(t)=="symbol"?t:t+""}function CIe(e,t){if(cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NIe=function(){function e(){SIe(this,e),wM(this,"activeIndex",0),wM(this,"coordinateList",[]),wM(this,"layout","horizontal")}return OIe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function MIe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function kIe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function OZ(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=Mn(t,n,r,a),s=Mn(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function PIe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,f=Mn(s,c,l,d),p=Mn(s,c,u,d);r=f.x,a=f.y,o=p.x,i=p.y}else return OZ(t);return[{x:r,y:a},{x:o,y:i}]}function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function CZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CZ(Object(n),!0).forEach(function(r){AIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AIe(e,t,n){return t=TIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TIe(e){var t=IIe(e,"string");return lp(t)=="symbol"?t:t+""}function IIe(e,t){if(lp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RIe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,f=e.chartName,p=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!p||!o||!i||f!=="ScatterChart"&&a!=="axis")return null;var m,y=mH;if(f==="ScatterChart")m=i,y=JPe;else if(f==="BarChart")m=kIe(d,i,c,u),y=CN;else if(d==="radial"){var v=OZ(i),b=v.cx,w=v.cy,j=v.radius,x=v.startAngle,_=v.endAngle;m={cx:b,cy:w,startAngle:x,endAngle:_,innerRadius:j,outerRadius:j},y=dH}else m={points:PIe(d,i,c)},y=mH;var S=uv(uv(uv(uv({stroke:"#ccc",pointerEvents:"none"},c),m),bt(p,!1)),{},{payload:s,payloadIndex:l,className:St("recharts-tooltip-cursor",p.className)});return g.isValidElement(p)?g.cloneElement(p,S):g.createElement(y,S)}var DIe=["item"],LIe=["children","className","width","height","style","compact","title","desc"];function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kl.apply(this,arguments)}function NZ(e,t){return BIe(e)||FIe(e,t)||PZ(e,t)||$Ie()}function $Ie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function BIe(e){if(Array.isArray(e))return e}function MZ(e,t){if(e==null)return{};var n=zIe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function UIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,TZ(r.key),r)}}function qIe(e,t,n){return t&&VIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function WIe(e,t,n){return t=dv(t),HIe(e,kZ()?Reflect.construct(t,n||[],dv(e).constructor):t.apply(e,n))}function HIe(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KIe(e)}function KIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kZ=function(){return!!e})()}function dv(e){return dv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dv(e)}function ZIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xM(e,t)}function xM(e,t){return xM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},xM(e,t)}function Zl(e){return JIe(e)||XIe(e)||PZ(e)||GIe()}function GIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PZ(e,t){if(e){if(typeof e=="string")return _M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _M(e,t)}}function XIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JIe(e){if(Array.isArray(e))return _M(e)}function _M(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function AZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AZ(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=TZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TZ(e){var t=YIe(e,"string");return Hl(t)=="symbol"?t:t+""}function YIe(e,t){if(Hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QIe={xAxis:["bottom","top"],yAxis:["left","right"]},eRe={width:"100%",height:"100%"},IZ={x:0,y:0};function fv(e){return e}var tRe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},nRe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return se(se(se({},r),Mn(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return se(se(se({},r),Mn(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return IZ},pv=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(Zl(i),Zl(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function RZ(e){return e==="number"?[0,"auto"]:void 0}var jM=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=pv(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var f=u===void 0?i:u;d=WE(f,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(Zl(s),[YW(c,d)]):s},[])},DZ=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=tRe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=HNe(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=jM(e,t,l,u),f=nRe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:f}}return null},rRe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,f=qW(l,a);return n.reduce(function(p,m){var y,v=m.type.defaultProps!==void 0?se(se({},m.type.defaultProps),m.props):m.props,b=v.type,w=v.dataKey,j=v.allowDataOverflow,x=v.allowDuplicatedCategory,_=v.scale,S=v.ticks,E=v.includeHidden,O=v[o];if(p[O])return p;var M=pv(e.data,{graphicalItems:r.filter(function(F){var $,z=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o];return z===O}),dataStartIndex:s,dataEndIndex:c}),C=M.length,k,T,P;MIe(v.domain,j,b)&&(k=lN(v.domain,null,j),f&&(b==="number"||_!=="auto")&&(P=kg(M,w,"category")));var N=RZ(b);if(!k||k.length===0){var I,A=(I=v.domain)!==null&&I!==void 0?I:N;if(w){if(k=kg(M,w,b),b==="category"&&f){var R=a_e(k);x&&R?(T=k,k=Hg(0,C)):x||(k=JW(A,k,m).reduce(function(F,$){return F.indexOf($)>=0?F:[].concat(Zl(F),[$])},[]))}else if(b==="category")x?k=k.filter(function(F){return F!==""&&!wt(F)}):k=JW(A,k,m).reduce(function(F,$){return F.indexOf($)>=0||$===""||wt($)?F:[].concat(Zl(F),[$])},[]);else if(b==="number"){var L=JNe(M,r.filter(function(F){var $,z,X=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o],G="hide"in F.props?F.props.hide:(z=F.type.defaultProps)===null||z===void 0?void 0:z.hide;return X===O&&(E||!G)}),w,a,l);L&&(k=L)}f&&(b==="number"||_!=="auto")&&(P=kg(M,w,"category"))}else f?k=Hg(0,C):i&&i[O]&&i[O].hasStack&&b==="number"?k=d==="expand"?[0,1]:ZW(i[O].stackGroups,s,c):k=VW(M,r.filter(function(F){var $=o in F.props?F.props[o]:F.type.defaultProps[o],z="hide"in F.props?F.props.hide:F.type.defaultProps.hide;return $===O&&(E||!z)}),b,l,!0);if(b==="number")k=gM(u,k,O,a,S),A&&(k=lN(A,k,j));else if(b==="category"&&A){var D=A,B=k.every(function(F){return D.indexOf(F)>=0});B&&(k=D)}}return se(se({},p),{},Fe({},O,se(se({},v),{},{axisType:a,domain:k,categoricalDomain:P,duplicateDomain:T,originalDomain:(y=v.domain)!==null&&y!==void 0?y:N,isCategorical:f,layout:l})))},{})},aRe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=pv(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),f=d.length,p=qW(l,a),m=-1;return n.reduce(function(y,v){var b=v.type.defaultProps!==void 0?se(se({},v.type.defaultProps),v.props):v.props,w=b[o],j=RZ("number");if(!y[w]){m++;var x;return p?x=Hg(0,f):i&&i[w]&&i[w].hasStack?(x=ZW(i[w].stackGroups,s,c),x=gM(u,x,w,a)):(x=lN(j,VW(d,n.filter(function(_){var S,E,O=o in _.props?_.props[o]:(S=_.type.defaultProps)===null||S===void 0?void 0:S[o],M="hide"in _.props?_.props.hide:(E=_.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!M}),"number",l),r.defaultProps.allowDataOverflow),x=gM(u,x,w,a)),se(se({},y),{},Fe({},w,se(se({axisType:a},r.defaultProps),{},{hide:!0,orientation:Ar(QIe,"".concat(a,".").concat(m%2),null),domain:x,originalDomain:j,isCategorical:p,layout:l})))}return y},{})},oRe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=Sa(l,a),f={};return d&&d.length?f=rRe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(f=aRe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),f},iRe=function(e){var t=Ai(e),n=Qo(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:eC(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:Ag(t,n)}},LZ=function(e){var t=e.children,n=e.defaultShowTooltip,r=jr(t,Rl),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},sRe=function(e){return!e||!e.length?!1:e.some(function(t){var n=Vo(t&&t.type);return n&&n.indexOf("Bar")>=0})},$Z=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},cRe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},f=jr(u,Rl),p=jr(u,bl),m=Object.keys(s).reduce(function(x,_){var S=s[_],E=S.orientation;return!S.mirror&&!S.hide?se(se({},x),{},Fe({},E,x[E]+S.width)):x},{left:d.left||0,right:d.right||0}),y=Object.keys(o).reduce(function(x,_){var S=o[_],E=S.orientation;return!S.mirror&&!S.hide?se(se({},x),{},Fe({},E,Ar(x,"".concat(E))+S.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=se(se({},y),m),b=v.bottom;f&&(v.bottom+=f.props.height||Rl.defaultProps.height),p&&t&&(v=GNe(v,r,n,t));var w=c-v.left-v.right,j=l-v.top-v.bottom;return se(se({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(j,0)})},lRe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},uRe=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(y,v){var b=v.graphicalItems,w=v.stackGroups,j=v.offset,x=v.updateId,_=v.dataStartIndex,S=v.dataEndIndex,E=y.barSize,O=y.layout,M=y.barGap,C=y.barCategoryGap,k=y.maxBarSize,T=$Z(O),P=T.numericAxisName,N=T.cateAxisName,I=sRe(b),A=[];return b.forEach(function(R,L){var D=pv(y.data,{graphicalItems:[R],dataStartIndex:_,dataEndIndex:S}),B=R.type.defaultProps!==void 0?se(se({},R.type.defaultProps),R.props):R.props,F=B.dataKey,$=B.maxBarSize,z=B["".concat(P,"Id")],X=B["".concat(N,"Id")],G={},q=s.reduce(function(Se,Ue){var We=v["".concat(Ue.axisType,"Map")],He=B["".concat(Ue.axisType,"Id")];We&&We[He]||Ue.axisType==="zAxis"||Ts();var It=We[He];return se(se({},Se),{},Fe(Fe({},Ue.axisType,It),"".concat(Ue.axisType,"Ticks"),Qo(It)))},G),J=q[N],K=q["".concat(N,"Ticks")],W=w&&w[z]&&w[z].hasStack&&lMe(R,w[z].stackGroups),Y=Vo(R.type).indexOf("Bar")>=0,re=Ag(J,K),U=[],ce=I&&KNe({barSize:E,stackGroups:w,totalSize:lRe(q,N)});if(Y){var ae,ue,je=wt($)?k:$,Le=(ae=(ue=Ag(J,K,!0))!==null&&ue!==void 0?ue:je)!==null&&ae!==void 0?ae:0;U=ZNe({barGap:M,barCategoryGap:C,bandSize:Le!==re?Le:re,sizeList:ce[X],maxBarSize:je}),Le!==re&&(U=U.map(function(Se){return se(se({},Se),{},{position:se(se({},Se.position),{},{offset:Se.position.offset-Le/2})})}))}var $e=R&&R.type&&R.type.getComposedData;$e&&A.push({props:se(se({},$e(se(se({},q),{},{displayedData:D,props:y,dataKey:F,item:R,bandSize:re,barPosition:U,offset:j,stackedData:W,layout:O,dataStartIndex:_,dataEndIndex:S}))),{},Fe(Fe(Fe({key:R.key||"item-".concat(L)},P,q[P]),N,q[N]),"animationId",x)),childIndex:m_e(R,y.children),item:R})}),A},f=function(y,v){var b=y.props,w=y.dataStartIndex,j=y.dataEndIndex,x=y.updateId;if(!nU({props:b}))return null;var _=b.children,S=b.layout,E=b.stackOffset,O=b.data,M=b.reverseStackOrder,C=$Z(S),k=C.numericAxisName,T=C.cateAxisName,P=Sa(_,n),N=iMe(O,P,"".concat(k,"Id"),"".concat(T,"Id"),E,M),I=s.reduce(function(B,F){var $="".concat(F.axisType,"Map");return se(se({},B),{},Fe({},$,oRe(b,se(se({},F),{},{graphicalItems:P,stackGroups:F.axisType===k&&N,dataStartIndex:w,dataEndIndex:j}))))},{}),A=cRe(se(se({},I),{},{props:b,graphicalItems:P}),v==null?void 0:v.legendBBox);Object.keys(I).forEach(function(B){I[B]=l(b,I[B],A,B.replace("Map",""),t)});var R=I["".concat(T,"Map")],L=iRe(R),D=d(b,se(se({},I),{},{dataStartIndex:w,dataEndIndex:j,updateId:x,graphicalItems:P,stackGroups:N,offset:A}));return se(se({formattedGraphicalItems:D,graphicalItems:P,offset:A,stackGroups:N},L),I)},p=function(y){function v(b){var w,j,x;return UIe(this,v),x=WIe(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new NIe),Fe(x,"handleLegendBBoxUpdate",function(_){if(_){var S=x.state,E=S.dataStartIndex,O=S.dataEndIndex,M=S.updateId;x.setState(se({legendBBox:_},f({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:M},se(se({},x.state),{},{legendBBox:_}))))}}),Fe(x,"handleReceiveSyncEvent",function(_,S,E){if(x.props.syncId===_){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(S)}}),Fe(x,"handleBrushChange",function(_){var S=_.startIndex,E=_.endIndex;if(S!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return se({dataStartIndex:S,dataEndIndex:E},f({props:x.props,dataStartIndex:S,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),Fe(x,"handleMouseEnter",function(_){var S=x.getMouseInfo(_);if(S){var E=se(se({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;at(O)&&O(E,_)}}),Fe(x,"triggeredAfterMouseMove",function(_){var S=x.getMouseInfo(_),E=S?se(se({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;at(O)&&O(E,_)}),Fe(x,"handleItemMouseEnter",function(_){x.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(_){_.persist(),x.throttleTriggeredAfterMouseMove(_)}),Fe(x,"handleMouseLeave",function(_){x.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var E=x.props.onMouseLeave;at(E)&&E(S,_)}),Fe(x,"handleOuterEvent",function(_){var S=h_e(_),E=Ar(x.props,"".concat(S));if(S&&at(E)){var O,M;/.*touch.*/i.test(S)?M=x.getMouseInfo(_.changedTouches[0]):M=x.getMouseInfo(_),E((O=M)!==null&&O!==void 0?O:{},_)}}),Fe(x,"handleClick",function(_){var S=x.getMouseInfo(_);if(S){var E=se(se({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;at(O)&&O(E,_)}}),Fe(x,"handleMouseDown",function(_){var S=x.props.onMouseDown;if(at(S)){var E=x.getMouseInfo(_);S(E,_)}}),Fe(x,"handleMouseUp",function(_){var S=x.props.onMouseUp;if(at(S)){var E=x.getMouseInfo(_);S(E,_)}}),Fe(x,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),Fe(x,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.handleMouseDown(_.changedTouches[0])}),Fe(x,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.handleMouseUp(_.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(_){x.props.syncId!==void 0&&vM.emit(bM,x.props.syncId,_,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(_){var S=x.props,E=S.layout,O=S.syncMethod,M=x.state.updateId,C=_.dataStartIndex,k=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)x.setState(se({dataStartIndex:C,dataEndIndex:k},f({props:x.props,dataStartIndex:C,dataEndIndex:k,updateId:M},x.state)));else if(_.activeTooltipIndex!==void 0){var T=_.chartX,P=_.chartY,N=_.activeTooltipIndex,I=x.state,A=I.offset,R=I.tooltipTicks;if(!A)return;if(typeof O=="function")N=O(R,_);else if(O==="value"){N=-1;for(var L=0;L<R.length;L++)if(R[L].value===_.activeLabel){N=L;break}}var D=se(se({},A),{},{x:A.left,y:A.top}),B=Math.min(T,D.x+D.width),F=Math.min(P,D.y+D.height),$=R[N]&&R[N].value,z=jM(x.state,x.props.data,N),X=R[N]?{x:E==="horizontal"?R[N].coordinate:B,y:E==="horizontal"?F:R[N].coordinate}:IZ;x.setState(se(se({},_),{},{activeLabel:$,activeCoordinate:X,activePayload:z,activeTooltipIndex:N}))}else x.setState(_)}),Fe(x,"renderCursor",function(_){var S,E=x.state,O=E.isTooltipActive,M=E.activeCoordinate,C=E.activePayload,k=E.offset,T=E.activeTooltipIndex,P=E.tooltipAxisBandSize,N=x.getTooltipEventType(),I=(S=_.props.active)!==null&&S!==void 0?S:O,A=x.props.layout,R=_.key||"_recharts-cursor";return H.createElement(RIe,{key:R,activeCoordinate:M,activePayload:C,activeTooltipIndex:T,chartName:t,element:_,isActive:I,layout:A,offset:k,tooltipAxisBandSize:P,tooltipEventType:N})}),Fe(x,"renderPolarAxis",function(_,S,E){var O=Ar(_,"type.axisType"),M=Ar(x.state,"".concat(O,"Map")),C=_.type.defaultProps,k=C!==void 0?se(se({},C),_.props):_.props,T=M&&M[k["".concat(O,"Id")]];return g.cloneElement(_,se(se({},T),{},{className:St(O,T.className),key:_.key||"".concat(S,"-").concat(E),ticks:Qo(T,!0)}))}),Fe(x,"renderPolarGrid",function(_){var S=_.props,E=S.radialLines,O=S.polarAngles,M=S.polarRadius,C=x.state,k=C.radiusAxisMap,T=C.angleAxisMap,P=Ai(k),N=Ai(T),I=N.cx,A=N.cy,R=N.innerRadius,L=N.outerRadius;return g.cloneElement(_,{polarAngles:Array.isArray(O)?O:Qo(N,!0).map(function(D){return D.coordinate}),polarRadius:Array.isArray(M)?M:Qo(P,!0).map(function(D){return D.coordinate}),cx:I,cy:A,innerRadius:R,outerRadius:L,key:_.key||"polar-grid",radialLines:E})}),Fe(x,"renderLegend",function(){var _=x.state.formattedGraphicalItems,S=x.props,E=S.children,O=S.width,M=S.height,C=x.props.margin||{},k=O-(C.left||0)-(C.right||0),T=FW({children:E,formattedGraphicalItems:_,legendWidth:k,legendContent:c});if(!T)return null;var P=T.item,N=MZ(T,DIe);return g.cloneElement(P,se(se({},N),{},{chartWidth:O,chartHeight:M,margin:C,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var _,S=x.props,E=S.children,O=S.accessibilityLayer,M=jr(E,Ja);if(!M)return null;var C=x.state,k=C.isTooltipActive,T=C.activeCoordinate,P=C.activePayload,N=C.activeLabel,I=C.offset,A=(_=M.props.active)!==null&&_!==void 0?_:k;return g.cloneElement(M,{viewBox:se(se({},I),{},{x:I.left,y:I.top}),active:A,label:N,payload:A?P:[],coordinate:T,accessibilityLayer:O})}),Fe(x,"renderBrush",function(_){var S=x.props,E=S.margin,O=S.data,M=x.state,C=M.offset,k=M.dataStartIndex,T=M.dataEndIndex,P=M.updateId;return g.cloneElement(_,{key:_.key||"_recharts-brush",onChange:Pg(x.handleBrushChange,_.props.onChange),data:O,x:ye(_.props.x)?_.props.x:C.left,y:ye(_.props.y)?_.props.y:C.top+C.height+C.brushBottom-(E.bottom||0),width:ye(_.props.width)?_.props.width:C.width,startIndex:k,endIndex:T,updateId:"brush-".concat(P)})}),Fe(x,"renderReferenceElement",function(_,S,E){if(!_)return null;var O=x,M=O.clipPathId,C=x.state,k=C.xAxisMap,T=C.yAxisMap,P=C.offset,N=_.type.defaultProps||{},I=_.props,A=I.xAxisId,R=A===void 0?N.xAxisId:A,L=I.yAxisId,D=L===void 0?N.yAxisId:L;return g.cloneElement(_,{key:_.key||"".concat(S,"-").concat(E),xAxis:k[R],yAxis:T[D],viewBox:{x:P.left,y:P.top,width:P.width,height:P.height},clipPathId:M})}),Fe(x,"renderActivePoints",function(_){var S=_.item,E=_.activePoint,O=_.basePoint,M=_.childIndex,C=_.isRange,k=[],T=S.props.key,P=S.item.type.defaultProps!==void 0?se(se({},S.item.type.defaultProps),S.item.props):S.item.props,N=P.activeDot,I=P.dataKey,A=se(se({index:M,dataKey:I,cx:E.x,cy:E.y,r:4,fill:sN(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},bt(N,!1)),By(N));return k.push(v.renderActiveDot(N,A,"".concat(T,"-activePoint-").concat(M))),O?k.push(v.renderActiveDot(N,se(se({},A),{},{cx:O.x,cy:O.y}),"".concat(T,"-basePoint-").concat(M))):C&&k.push(null),k}),Fe(x,"renderGraphicChild",function(_,S,E){var O=x.filterFormatItem(_,S,E);if(!O)return null;var M=x.getTooltipEventType(),C=x.state,k=C.isTooltipActive,T=C.tooltipAxis,P=C.activeTooltipIndex,N=C.activeLabel,I=x.props.children,A=jr(I,Ja),R=O.props,L=R.points,D=R.isRange,B=R.baseLine,F=O.item.type.defaultProps!==void 0?se(se({},O.item.type.defaultProps),O.item.props):O.item.props,$=F.activeDot,z=F.hide,X=F.activeBar,G=F.activeShape,q=!!(!z&&k&&A&&($||X||G)),J={};M!=="axis"&&A&&A.props.trigger==="click"?J={onClick:Pg(x.handleItemMouseEnter,_.props.onClick)}:M!=="axis"&&(J={onMouseLeave:Pg(x.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:Pg(x.handleItemMouseEnter,_.props.onMouseEnter)});var K=g.cloneElement(_,se(se({},O.props),J));function W(We){return typeof T.dataKey=="function"?T.dataKey(We.payload):null}if(q)if(P>=0){var Y,re;if(T.dataKey&&!T.allowDuplicatedCategory){var U=typeof T.dataKey=="function"?W:"payload.".concat(T.dataKey.toString());Y=WE(L,U,N),re=D&&B&&WE(B,U,N)}else Y=L==null?void 0:L[P],re=D&&B&&B[P];if(G||X){var ce=_.props.activeIndex!==void 0?_.props.activeIndex:P;return[g.cloneElement(_,se(se(se({},O.props),J),{},{activeIndex:ce})),null,null]}if(!wt(Y))return[K].concat(Zl(x.renderActivePoints({item:O,activePoint:Y,basePoint:re,childIndex:P,isRange:D})))}else{var ae,ue=(ae=x.getItemByXY(x.state.activeCoordinate))!==null&&ae!==void 0?ae:{graphicalItem:K},je=ue.graphicalItem,Le=je.item,$e=Le===void 0?_:Le,Se=je.childIndex,Ue=se(se(se({},O.props),J),{},{activeIndex:Se});return[g.cloneElement($e,Ue),null,null]}return D?[K,null,null]:[K,null]}),Fe(x,"renderCustomized",function(_,S,E){return g.cloneElement(_,se(se({key:"recharts-customized-".concat(E)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:fv,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:fv},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:fv},YAxis:{handler:fv},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Fy("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Pv(x.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),x.state={},x}return ZIe(v,y),qIe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,j=b.data,x=b.height,_=b.layout,S=jr(w,Ja);if(S){var E=S.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,M=jM(this.state,j,E,O),C=this.state.tooltipTicks[E].coordinate,k=(this.state.offset.top+x)/2,T=_==="horizontal",P=T?{x:C,y:k}:{y:C,x:k},N=this.state.formattedGraphicalItems.find(function(A){var R=A.item;return R.type.name==="Scatter"});N&&(P=se(se({},P),N.props.points[E].tooltipPosition),M=N.props.points[E].tooltipPayload);var I={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:M,activeCoordinate:P};this.setState(I),this.renderCursor(S),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var j,x;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){JE([jr(b.children,Ja)],[jr(this.props.children,Ja)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=jr(this.props.children,Ja);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,j=w.getBoundingClientRect(),x=sEe(j),_={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},S=j.width/w.offsetWidth||1,E=this.inRange(_.chartX,_.chartY,S);if(!E)return null;var O=this.state,M=O.xAxisMap,C=O.yAxisMap,k=this.getTooltipEventType();if(k!=="axis"&&M&&C){var T=Ai(M).scale,P=Ai(C).scale,N=T&&T.invert?T.invert(_.chartX):null,I=P&&P.invert?P.invert(_.chartY):null;return se(se({},_),{},{xValue:N,yValue:I})}var A=DZ(this.state,this.props.data,this.props.layout,E);return A?se(se({},_),A):null}},{key:"inRange",value:function(b,w){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,_=b/j,S=w/j;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=_>=E.left&&_<=E.left+E.width&&S>=E.top&&S<=E.top+E.height;return O?{x:_,y:S}:null}var M=this.state,C=M.angleAxisMap,k=M.radiusAxisMap;if(C&&k){var T=Ai(C);return tH({x:_,y:S},T)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),j=jr(b,Ja),x={};j&&w==="axis"&&(j.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var _=By(this.props,this.handleOuterEvent);return se(se({},_),x)}},{key:"addListener",value:function(){vM.on(bM,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){vM.removeListener(bM,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,j){for(var x=this.state.formattedGraphicalItems,_=0,S=x.length;_<S;_++){var E=x[_];if(E.item===b||E.props.key===b.key||w===Vo(E.item.type)&&j===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,j=w.left,x=w.top,_=w.height,S=w.width;return H.createElement("defs",null,H.createElement("clipPath",{id:b},H.createElement("rect",{x:j,y:x,height:_,width:S})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,j){var x=NZ(j,2),_=x[0],S=x[1];return se(se({},w),{},Fe({},_,S.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,j){var x=NZ(j,2),_=x[0],S=x[1];return se(se({},w),{},Fe({},_,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,j=w.formattedGraphicalItems,x=w.activeItem;if(j&&j.length)for(var _=0,S=j.length;_<S;_++){var E=j[_],O=E.props,M=E.item,C=M.type.defaultProps!==void 0?se(se({},M.type.defaultProps),M.props):M.props,k=Vo(M.type);if(k==="Bar"){var T=(O.data||[]).find(function(A){return zPe(b,A)});if(T)return{graphicalItem:E,payload:T}}else if(k==="RadialBar"){var P=(O.data||[]).find(function(A){return tH(b,A)});if(P)return{graphicalItem:E,payload:P}}else if(qg(E,x)||Wg(E,x)||np(E,x)){var N=MAe({graphicalItem:E,activeTooltipItem:x,itemData:C.data}),I=C.activeIndex===void 0?N:C.activeIndex;return{graphicalItem:se(se({},E),{},{childIndex:I}),payload:np(E,x)?C.data[N]:E.props.data[N]}}}return null}},{key:"render",value:function(){var b=this;if(!nU(this))return null;var w=this.props,j=w.children,x=w.className,_=w.width,S=w.height,E=w.style,O=w.compact,M=w.title,C=w.desc,k=MZ(w,LIe),T=bt(k,!1);if(O)return H.createElement(qK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},H.createElement(QE,Kl({},T,{width:_,height:S,title:M,desc:C}),this.renderClipPath(),aU(j,this.renderMap)));if(this.props.accessibilityLayer){var P,N;T.tabIndex=(P=this.props.tabIndex)!==null&&P!==void 0?P:0,T.role=(N=this.props.role)!==null&&N!==void 0?N:"application",T.onKeyDown=function(A){b.accessibilityManager.keyboardEvent(A)},T.onFocus=function(){b.accessibilityManager.focus()}}var I=this.parseEventsOfWrapper();return H.createElement(qK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},H.createElement("div",Kl({className:St("recharts-wrapper",x),style:se({position:"relative",cursor:"default",width:_,height:S},E)},I,{ref:function(A){b.container=A}}),H.createElement(QE,Kl({},T,{width:_,height:S,title:M,desc:C,style:eRe}),this.renderClipPath(),aU(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(p,"displayName",t),Fe(p,"defaultProps",se({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(p,"getDerivedStateFromProps",function(y,v){var b=y.dataKey,w=y.data,j=y.children,x=y.width,_=y.height,S=y.layout,E=y.stackOffset,O=y.margin,M=v.dataStartIndex,C=v.dataEndIndex;if(v.updateId===void 0){var k=LZ(y);return se(se(se({},k),{},{updateId:0},f(se(se({props:y},k),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:j})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||_!==v.prevHeight||S!==v.prevLayout||E!==v.prevStackOffset||!ml(O,v.prevMargin)){var T=LZ(y),P={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},N=se(se({},DZ(v,w,S)),{},{updateId:v.updateId+1}),I=se(se(se({},T),P),N);return se(se(se({},I),f(se({props:y},I),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:j})}if(!JE(j,v.prevChildren)){var A,R,L,D,B=jr(j,Rl),F=B&&(A=(R=B.props)===null||R===void 0?void 0:R.startIndex)!==null&&A!==void 0?A:M,$=B&&(L=(D=B.props)===null||D===void 0?void 0:D.endIndex)!==null&&L!==void 0?L:C,z=F!==M||$!==C,X=!wt(w),G=X&&!z?v.updateId:v.updateId+1;return se(se({updateId:G},f(se(se({props:y},v),{},{updateId:G,dataStartIndex:F,dataEndIndex:$}),v)),{},{prevChildren:j,dataStartIndex:F,dataEndIndex:$})}return null}),Fe(p,"renderActiveDot",function(y,v,b){var w;return g.isValidElement(y)?w=g.cloneElement(y,v):at(y)?w=y(v):w=H.createElement(XH,v),H.createElement(wn,{className:"recharts-active-dot",key:b},w)});var m=g.forwardRef(function(y,v){return H.createElement(p,Kl({},y,{ref:v}))});return m.displayName=p.displayName,m},dRe=uRe({chartName:"BarChart",GraphicalChild:Ds,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:cv},{axisType:"yAxis",AxisComp:mM}],formatAxisMap:S2e});const fRe={light:"",dark:".dark"},FZ=g.createContext(null);function BZ(){const e=g.useContext(FZ);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const zZ=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(FZ.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:Z("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(pRe,{id:s,config:r}),h.jsx(eEe,{children:n})]})})});zZ.displayName="Chart";const pRe=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(fRe).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},hRe=Ja,UZ=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:f},p)=>{const{config:m}=BZ(),y=g.useMemo(()=>{var _;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${f||b.dataKey||b.name||"value"}`,j=SM(m,b,w),x=!f&&typeof i=="string"?((_=m[i])==null?void 0:_.label)||i:j==null?void 0:j.label;return s?h.jsx("div",{className:Z("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:Z("font-medium",c),children:x}):null},[i,s,t,a,c,m,f]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:p,className:Z("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:y,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const j=`${d||b.name||b.dataKey||"value"}`,x=SM(m,b,j),_=u||b.payload.fill||b.color;return h.jsx("div",{className:Z("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:Z("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":_,"--color-border":_}}),h.jsxs("div",{className:Z("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?y:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});UZ.displayName="ChartTooltip";const mRe=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=BZ();return n!=null&&n.length?h.jsx("div",{ref:o,className:Z("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=SM(i,s,c);return h.jsxs("div",{className:Z("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});mRe.displayName="ChartLegend";function SM(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const VZ=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},yRe=g.memo(()=>{const{t:e}=ke("flows"),[t,n]=g.useState(),r=oo(m=>m.cachedLLMURLs),a=et(m=>m.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{Ht(async()=>{const{functionCallingModelIds:m,prebuiltAppConfig:y}=await import("./index-PRjZyF7d.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:m,prebuiltAppConfig:y}},__vite__mapDeps([9,1,2,3,4])).then(({functionCallingModelIds:m,prebuiltAppConfig:y})=>{n(r==null?void 0:r.map(v=>{const b=y.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:m.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const f=g.useCallback(async()=>{navigator.storage.estimate().then(m=>{m&&c(e("session_info_node.used_bytes",{used:VZ(m.usage),total:VZ(m==null?void 0:m.quota)}))}),a!=null&&a.id&&(Promise.all([de("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(m=>{const y=m.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(y)}),Promise.all([de("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),de("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),de("Thread").count({where:{session_id:a==null?void 0:a.id}}),de("Prompt").count({where:{session_id:a==null?void 0:a.id}}),de("LLM").count({where:{session_id:a==null?void 0:a.id}}),de("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),de("Schema").count({where:{session_id:a==null?void 0:a.id}}),de("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),de("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),de("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([m,y,v,b,w,j,x,_,S,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:m||0,edges:y||0,threads:v||0,prompts:b||0,llms:w||0,tools:j||0,schemas:x||0,vectorDatabases:_||0,jsonlDatas:S||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),p=g.useCallback(()=>{f()},[f]);return g.useEffect(()=>{f()},[f]),h.jsxs(en,{className:"w-96",children:[h.jsxs(Wn,{children:[h.jsx(rr,{children:e("session_info_node.title")}),h.jsx(U9,{children:o||a!=null&&a.updated_at?r3e(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs(Hn,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(bn,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(m=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[m==null?void 0:m.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(rf,{model:m==null?void 0:m.info,isFunctionCalling:(m==null?void 0:m.isFunctionCalling)||!1,isCached:!0,cloud:!1})})]},m==null?void 0:m.model_id))]})}),h.jsx("div",{children:h.jsx(zZ,{config:d,className:"min-h-28 w-full",children:h.jsxs(dRe,{accessibilityLayer:!0,data:l,children:[h.jsx(mZ,{vertical:!1}),h.jsx(cv,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(hRe,{content:h.jsx(UZ,{})}),Object.entries(d).map(([m,y])=>h.jsx(Ds,{dataKey:m,fill:y.color,radius:4},m))]})})})]}),h.jsx(Si,{children:h.jsxs(tt,{className:"w-full",onClick:p,children:[h.jsx(fe,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),gRe=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Fn(e,t)},vRe=g.memo(e=>{var c,l;const{t}=ke("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Bn(n),s=De(u=>u.updateNodes);return gRe(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,de("SchemaItem").find({where:{schema_id:u.id}}).then(f=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:f}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Rn,{id:n}),h.jsxs(AS,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(gy,{className:"grid w-full grid-cols-2",children:[h.jsx(ba,{value:"account",children:t("schema_node.typescript")}),h.jsx(ba,{value:"password",children:t("schema_node.zod")})]}),h.jsx(wa,{value:"account",children:h.jsx(en,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:Yve(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(wa,{value:"password",children:h.jsx(en,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:z9(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:a})]})}),bRe=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=Cv(n.entity.csv);return{headers:BM(n.entity.headers),rows:s.map(c=>BM(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Rn,{id:t}),h.jsxs(en,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Wn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(fe,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(qe,{className:"!font-medium leading-none tracking-tight pr-8",children:[ie.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx(Hn,{className:"pb-0",children:h.jsx(My,{data:a.rows,headers:a.headers})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),wRe=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.Schema&&(o==null?void 0:o.type)===ie.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},xRe=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return wRe(e),h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(_a,{className:"flex justify-center",children:[h.jsx(fe,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(zo,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(fl,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:n})]})}),_Re=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);Fn(e,t)},jRe=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return _Re(t),h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(_a,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Pr,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(zo,{children:`${n.model||""}`})})]})}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),SRe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,ERe=so(e=>{const{source:t,documents:n}=e,r=tn(),{toast:a}=nn(),{t:o}=ke("dialogs"),{loading:i,createPrompt:s}=jz(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(fi,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(vo,{className:"sm:max-w-[425px]",children:[h.jsx(bo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(wo,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(DE,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:SRe}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),ORe=()=>{const e=et(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,f;try{const p=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!p||!e)throw new Error("Source or Session not found");n(!0);const m=((u=s.position)==null?void 0:u.x)||0,y=(((d=s.position)==null?void 0:d.y)||0)+(((f=s.measured)==null?void 0:f.height)||0),v=await de("Prompt").save({...i,status:(i==null?void 0:i.status)||Wr.Started,role:(i==null?void 0:i.role)||fr.System,type:(i==null?void 0:i.type)||pr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:ie.Prompt,x:m,y:y+20});if(!b)throw new Error("Failed to save prompt node");const w=await de("FlowNodePlaceholder").save({placeholder:`Retriever for ${p.name}`,placeholder_type:Js.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const j=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:ie.PlaceHolder,x:m,y:y+40});if(!j)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:j.id}),await a({source:s.id,target:j.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},CRe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,NRe=so(e=>{const{source:t}=e,n=tn(),{toast:r}=nn(),{t:a}=ke("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=ORe(),d=async m=>{try{const y=m.content;if(!y||!y.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:y},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},f=m=>{i(m.target.value?Number(m.target.value):void 0)},p=m=>{c(m.target.value?Number(m.target.value):void 0)};return h.jsx(fi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(vo,{className:"sm:max-w-[425px]",children:[h.jsx(bo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(wo,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(DE,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:CRe}),h.jsxs(en,{children:[h.jsx(Wn,{children:h.jsx(rr,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs(Hn,{children:[h.jsx(qe,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(Gt,{value:o||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(qe,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(Gt,{value:s||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),MRe=e=>{const t=De(a=>a.createOrUpdateFlowEdge),n=Vs(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===ie.CSVData&&(o==null?void 0:o.type)===ie.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=HG(u.headers,u.csv),f=d.map(p=>new vp({pageContent:`${p.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},f),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);Fn(e,r)},kRe=e=>{const[t,n]=g.useState(!1),{t:r}=ke("flows"),{toast:a}=nn(),{getNode:o,getHandleConnections:i}=br(),s=De(f=>f.updateNodes),c=Vs(f=>f.index),l=Vs(f=>f.similaritySearchWithScore),u=g.useCallback(async(f,p)=>{var m,y,v;try{const b=o(e);if(!b)return;const w=(m=b.data)==null?void 0:m.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===Ur.DataNode){const j=(v=(y=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[ie.JSONLData,ie.CSVData].includes(x==null?void 0:x.type)))==null?void 0:y.data)==null?void 0:v.entity;if(!j){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:j.id,dataSourceType:FM(j)},f,p==null?void 0:p.k)}else return n(!0),await l({databaseId:w.id},f,p==null?void 0:p.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(f,p)=>{var m,y,v,b;try{const w=o(e);if(!w)return;n(!0);const j=f.content?[new vp({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(j!=null&&j.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(m=w.data)==null?void 0:m.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===Ur.DataNode){const _=i({nodeId:e,type:"target"}).map(C=>o(C.source)).find(C=>(C==null?void 0:C.type)&&[ie.JSONLData,ie.CSVData].includes(C==null?void 0:C.type)),S=(y=_==null?void 0:_.data)==null?void 0:y.entity;if(!S){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=FM(S),O=nE(j,10);let M=0;for(const C of O){if((v=p==null?void 0:p.onProgressReport)==null||v.call(p,{handling:C.length,handled:M,total:j.length}),await c({databaseId:x.id,dataSourceId:S.id,dataSourceType:E},C),E&&_){const k=await de(E).findOne({where:{id:S.id}});s([{type:"replace",id:_.id,item:{..._,data:{..._.data,entity:k}}}])}M+=C.length}}else{const _=nE(j,10);let S=0;for(const E of _){(b=p==null?void 0:p.onProgressReport)==null||b.call(p,{handling:E.length,handled:S,total:j.length}),await c({databaseId:x.id},E);const O=await de("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),S+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},PRe=g.memo(e=>{var S,E,O,M;const{t}=ke("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Bn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:f}=kRe(s),p=tn(ERe),m=tn(NRe);MRe(s);const y=g.useCallback(async(...C)=>{i&&await f(...C)},[f,i]),v=g.useCallback(async(C,k)=>{const T=C.trim(),P=await d(T,{k});if(P!=null&&P.length)return P},[d]),b=g.useCallback(C=>{p.show({source:i,documents:C.map(([k])=>k)})},[p,i]),w=g.useCallback(async()=>{m.show({source:i})},[m,i]),j=g.useCallback(async C=>{if(C.type.includes("text")||C.type.includes("txt")){const k=new FileReader;k.onload=async T=>{var N;const P=(N=T.target)==null?void 0:N.result;await y({content:P})},k.readAsText(C)}else if(C.type.endsWith("pdf")){const k=new Blob([C],{type:"application/pdf"}),T=await new q9(k,{pdfjs:async()=>{const P=await Ht(()=>import("./pdf.min-CNRnjYAA.js").then(async N=>(await N.__tla,N)),__vite__mapDeps([11,1,2,3,4]));return await Ht(()=>import("./pdf.worker.min-TUvxb0n0.js").then(async N=>(await N.__tla,N)),__vite__mapDeps([12,1,2,3,4])),P.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),P},parsedItemSeparator:" "}).load();await y({documents:T},{onProgressReport:P=>{r((P.handled+P.handling)/P.total)}})}},[y]),x=g.useMemo(()=>{var T,P;if(!((T=c==null?void 0:c.entity)!=null&&T.raw))return{headers:[],rows:[]};const C=["content","embedding","metadata"],k=Cv((P=c==null?void 0:c.entity)==null?void 0:P.raw);return{headers:C,rows:k.map(N=>{try{return JSON.parse(N)}catch{return[]}})}},[(S=c==null?void 0:c.entity)==null?void 0:S.raw]),_=g.useMemo(()=>{switch(a){case"search":return h.jsx(wa,{value:"search",children:h.jsx(tB,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(wa,{className:"min-w-80",value:"new",children:h.jsx(nB,{loading:u,onCreateData:y})});case"file":return h.jsx(wa,{value:"file",children:h.jsx(rB,{loading:u,progress:n,onFileSubmit:j,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(wa,{value:"view",children:h.jsx(My,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[y,b,w,j,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Rn,{id:s}),h.jsxs(_a,{className:"flex justify-center",variant:"default",children:[h.jsx(fe,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(zo,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(AS,{value:a,onValueChange:o,defaultValue:"search",className:Z("w-full mt-4"),children:[h.jsxs(gy,{className:Z("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===Ur.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ba,{value:"search",children:t("vector_database_node.search")}),h.jsx(ba,{value:"new",children:t("vector_database_node.text")}),h.jsx(ba,{value:"file",children:t("vector_database_node.file")}),((M=c.entity)==null?void 0:M.storage)===Ur.DatabaseNode?h.jsx(ba,{value:"view",children:t("vector_database_node.view")}):void 0]}),_]})]})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:l})]})}),ARe={embedding:32},TRe=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=BM(n.entity.headers||""),l=Cv(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Rn,{id:t}),h.jsxs(en,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Wn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(fe,{name:"file-json",className:"mr-2"}),h.jsxs(qe,{className:"!font-medium leading-none tracking-tight pr-8",children:[ie.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx(Hn,{className:"pb-0",children:h.jsx(My,{data:a.rows,headers:a.headers,limitLengthByColumns:ARe})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),qZ=60,WZ=140,IRe=io("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),HZ=H.forwardRef(({className:e,children:t,magnification:n=qZ,distance:r=WZ,direction:a="bottom",...o},i)=>{const s=k0(1/0),c=()=>H.Children.map(t,l=>H.isValidElement(l)&&l.type===up?H.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(pp.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:Z(IRe({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});HZ.displayName="Dock";const up=({magnification:e=qZ,distance:t=WZ,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=Bk(n||new a3e,u=>{var f;const d=((f=i.current)==null?void 0:f.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=Bk(s,[-t,0,t],[40,e,40]),l=pX(c,{mass:.1,stiffness:150,damping:12});return h.jsx(pp.div,{ref:i,style:{width:l},className:Z("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};up.displayName="DockIcon";let KZ,ZZ,GZ,XZ,hv,JZ,dp,YZ,QZ,eG,tG,nG,rG,aG,oG,iG,sG,cG,lG,uG,dG,fG,pG,hG,mG,yG,gG,vG;KZ=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),ZZ="/NoLLMChat/assets/plate-editor-C1jTW62C.png",GZ={[ie.Shape]:{width:100,height:100},[ie.CircleShape]:{width:100,height:100},[ie.TriangleShape]:{width:100,height:100},[ie.EditorApp]:{width:1240,height:400}},XZ=e=>{const t=Bn(e),n=et(s=>s.currentSession),[r,a]=g.useState(!1),o=De(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,f=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),p=await de("FlowNodeData").save({data:{},session_id:n.id});if(!p)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:p.id,source_type:"FlowNodeData",x:d,y:f+20,...GZ[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},hv={applications:[{key:ie.EditorApp,image:ZZ,label:"application_bar.editor"},{key:ie.VSLiteApp,icon:KZ,label:"application_bar.vslite"}],shapes:[{key:ie.Shape,icon:"square",label:"application_bar.square"},{key:ie.CircleShape,icon:"circle",label:"application_bar.circle"},{key:ie.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:ie.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},JZ=g.memo(e=>{const{t}=ke("flows"),{toast:n}=nn(),{loading:r,createNode:a}=XZ(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(Au,{children:h.jsxs(HZ,{direction:"middle",children:[hv.applications.map(i=>{const s=i.icon;return h.jsx(up,{children:h.jsxs(Da,{children:[h.jsxs(La,{children:[s?h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)}):void 0,i.image?h.jsx("img",{src:i.image,alt:t(i.label),className:"w-8 h-8 rounded-md",onClick:()=>o(i.key)}):void 0]}),h.jsx(Jr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Ks,{orientation:"vertical",className:"h-full"}),hv.shapes.map(i=>h.jsx(up,{children:h.jsxs(Da,{children:[h.jsx(La,{children:h.jsx(fe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Jr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Ks,{orientation:"vertical",className:"h-full"}),hv.old.map(i=>h.jsx(up,{children:h.jsxs(Da,{children:[h.jsx(La,{children:h.jsx(fe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Jr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),dp=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(Nde,{lineClassName:Z("!border-1.5",t),handleClassName:Z("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),YZ=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.CircleShape,ie.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},QZ=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return YZ(t),h.jsxs(h.Fragment,{children:[h.jsx(dp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Rn,{id:t})}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:r})]})}),eG=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.Shape,ie.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},tG=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return eG(t),h.jsxs(h.Fragment,{children:[h.jsx(dp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Rn,{id:t})}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:r})]})}),nG=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.CircleShape,ie.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},rG=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return nG(t),h.jsxs(h.Fragment,{children:[h.jsx(dp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Rn,{id:t,className:"absolute top-0 right-0"}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:o})]})}),aG=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},oG=e=>{const t=Bn(e),{t:n}=ke("flows"),r=g.useRef(null),{toast:a}=nn(),{getNode:o,getHandleConnections:i}=br(),{stream:s}=nl(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await de("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,f)=>{var p;if(t){const m=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===ie.LLM}),y=m?o(m==null?void 0:m.source):void 0,v=(p=y==null?void 0:y.data)==null?void 0:p.entity;if(!y||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(y.data.status!==Je.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new zr(d)]:d,{onMessageUpdate:b=>{f==null||f(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const f=[];return i({nodeId:d,type:"target"}).forEach(p=>{const m=o(p.source);!m||m.type!==ie.LLM||f.push({node:m,connections:[p]})}),f},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},iG=g.lazy(()=>Ht(()=>import("./index-DHwbNkRp.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),sG=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;aG(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=oG(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(dp,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Rn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(iG,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:a})]})}),cG=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Fn(e,t)},lG=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=ke("flows");cG(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs(_a,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Rn,{id:t}),h.jsx(fe,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(zo,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(fl,{children:o?h.jsx(bn,{children:o}):void 0})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),uG=g.lazy(()=>Ht(()=>import("./CodeContainerApp-CL5deAAk.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,6]))),dG=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Rn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(uG,{...e})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:n})]})}),fG=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],pG=async e=>{switch(e){case"empty-source":return Ht(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return Ht(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return Ht(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return Ht(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return Ht(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},jk=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=ke("components"),[r,a]=g.useState();return h.jsxs(en,{className:Z("mw-full",e),children:[h.jsx(Wn,{className:"p-4",children:h.jsx(rr,{children:n("add_source_base.title")})}),h.jsx(Hn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(Lo,{onValueChange:o=>a(o),children:[h.jsx(Ga,{className:"w-full mb-4",children:h.jsx($o,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(Xa,{children:fG.map(o=>h.jsx(ar,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(tt,{className:"w-full",onClick:async()=>r&&t(await pG(r)),children:n("add_source_base.update_source")})]})})]})}),hG=()=>{const{getNode:e,getHandleConnections:t}=br(),{stream:n}=nl(),r=g.useCallback(async(o,i)=>{await de("FlowNode").update(o,{raw:g0(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==ie.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Ov(d.content):d.role==="user"?new zr(d.content):new ka(d.content));c==null||c();const{content:u}=await n(nt.WebLLM,[...l,new zr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},mG=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Fn(e,n)},yG=g.lazy(()=>Ht(()=>import("./index-Bxl28ONd.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),gG=g.memo(e=>{var f,p,m,y;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((f=r==null?void 0:r.flowNode)!=null&&f.raw?x0(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=hG();mG(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(p=r==null?void 0:r.flowNode)==null?void 0:p.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,c]),d=g.useCallback(async v=>{o(b=>{var j;const w=_0(b||{},v);return i((j=r==null?void 0:r.flowNode)==null?void 0:j.id,w),w})},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Rn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(yG,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(jk,{className:"w-64",onUpdateSourceBase:l})})}),vG={[ie.LLM]:Lz,[ie.Toolbox]:kz,[ie.Thread]:Uz,[ie.Message]:B1e,[ie.Prompt]:U1e,[ie.SessionInfo]:yRe,[ie.Schema]:vRe,[ie.CSVData]:bRe,[ie.ToolDefinition]:xRe,[ie.DefaultEmbeddingModel]:jRe,[ie.VectorDatabase]:PRe,[ie.JSONLData]:TRe,[ie.ApplicationBar]:JZ,[ie.Shape]:QZ,[ie.CircleShape]:tG,[ie.TriangleShape]:rG,[ie.EditorApp]:sG,[ie.PlaceHolder]:lG,[ie.CodeContainerApp]:dG,[ie.VSLiteApp]:gG};function RRe(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,DRe(a,...t)]}function DRe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var LRe="Toggle",EM=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Pn({prop:n,onChange:a,defaultProp:r});return h.jsx(Ae.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});EM.displayName=LRe;let OM,Fs,CM,NM,mv;OM=EM,Fs="ToggleGroup",[CM,GG]=RRe(Fs,[lo]),NM=lo(),mv=H.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx($Re,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(FRe,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${Fs}\``)}),mv.displayName=Fs;var[bG,wG]=CM(Fs),$Re=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Pn({prop:n,defaultProp:r,onChange:a});return h.jsx(bG,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:H.useCallback(()=>s(""),[s]),children:h.jsx(xG,{...o,ref:t})})}),FRe=H.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Pn({prop:n,defaultProp:r,onChange:a}),c=H.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=H.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(bG,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(xG,{...o,ref:t})})});mv.displayName=Fs;var[BRe,zRe]=CM(Fs),xG=H.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=NM(n),u=ri(i),d={role:"group",dir:u,...c};return h.jsx(BRe,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(uu,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Ae.div,{...d,ref:t})}):h.jsx(Ae.div,{...d,ref:t})})}),yv="ToggleGroupItem",_G=H.forwardRef((e,t)=>{const n=wG(yv,e.__scopeToggleGroup),r=zRe(yv,e.__scopeToggleGroup),a=NM(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=H.useRef(null);return r.rovingFocus?h.jsx(du,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx(MM,{...s,ref:t})}):h.jsx(MM,{...s,ref:t})});_G.displayName=yv;let MM;MM=H.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=wG(yv,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(EM,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),$v=mv,Fv=_G;const jG=io("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),URe=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(OM,{ref:a,className:Z(jG({variant:t,size:n,className:e})),...r}));URe.displayName=OM.displayName;const SG=g.createContext({size:"default",variant:"default"}),EG=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx($v,{ref:o,className:Z("flex items-center justify-center gap-1",e),...a,children:h.jsx(SG.Provider,{value:{variant:t,size:n},children:r})}));EG.displayName=$v.displayName;const OG=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(SG);return h.jsx(Fv,{ref:o,className:Z(jG({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});OG.displayName=Fv.displayName;function VRe(){const e=Ye(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function qRe({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function WRe({limit:e=20}){const[t,n]=g.useState([]),r=Lt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(qRe,{change:i},s))})}function HRe(){const{getInternalNode:e}=br(),t=nde();return h.jsx(ede,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(KRe,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function KRe({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function ZRe({tools:e}){return h.jsx(Mc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(EG,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(OG,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function CG(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx(ZRe,{tools:i}),n&&h.jsx(Mc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(WRe,{})}),e&&h.jsx(HRe,{}),a&&h.jsx(Mc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(VRe,{})})]})}CG.displayName="DevTools";const GRe=()=>{const e=g.useRef({}),t=g.useRef({}),n=De(C=>C.flowEdges),r=et(C=>C.currentSession),a=De(C=>C.setNodes),o=De(C=>C.updateNodes),i=De(C=>C.updateEdges),s=De(C=>C.addConnectionToEdges),c=De(C=>C.reset),l=De(C=>C.findFlowEdges),u=De(C=>C.deleteFlowNode),d=De(C=>C.deleteFlowEdge),f=De(C=>C.updateFlowNode),p=De(C=>C.getNodes),m=De(C=>C.findFlowNodesWithSource),y=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});y.current=n;const j=g.useCallback(async(C,k)=>{try{v.current=C,c(),await(k==null?void 0:k())}catch{v.current=void 0}},[c]),x=g.useCallback(async C=>{try{if(!(r!=null&&r.id))return;w(P=>({...P,loading:!0}));const k=await m({...C,where:{...C.where,session_id:r.id}}),T=await l({where:[{source:qa(k.map(P=>P.id))},{target:qa(k.map(P=>P.id))}]});return{flowNodes:k,flowEdges:T}}finally{w(k=>({...k,loading:!1}))}},[m,l,r==null?void 0:r.id]),_=g.useCallback(async C=>{var k,T;for(const P of C)if("id"in P&&Object.values(Cd).includes(P.id)&&P.type!=="remove")o([P]);else if(P.type==="position"&&P.position&&!isNaN(P.position.x)&&!isNaN(P.position.y)){o([P]);const N=P.position.x,I=P.position.y;clearTimeout(e.current[P.id]),e.current[P.id]=setTimeout(async()=>{e.current[P.id]=void 0,await f({id:P.id,x:N,y:I},{silent:!0})},200)}else if(P.type==="remove"){const N=(k=p([P.id]))==null?void 0:k[0];if(!(N!=null&&N.type)||Ofe.includes(N.type))return;await u({id:P.id})}else if(P.type==="dimensions"&&P.dimensions&&!isNaN(P.dimensions.width)&&!isNaN(P.dimensions.height)){const N=(T=p([P.id]))==null?void 0:T[0];if(!(N!=null&&N.width)&&!(N!=null&&N.height))return;o([P]),clearTimeout(t.current[P.id]);const I=P.dimensions.width,A=P.dimensions.height;t.current[P.id]=setTimeout(async()=>{await f({id:P.id,width:I,height:A},{silent:!0})},200)}else P.type==="select"&&o([P])},[o,f,p,u]),S=g.useCallback(C=>{Promise.all(C.map(async k=>{if(k.type==="remove")return d({id:k.id})})),i(C)},[d,i]),E=g.useCallback(C=>{s(C)},[s]),O=g.useCallback(()=>{var C;(C=y.current)==null||C.length},[]),M=g.useCallback(C=>{a(k=>{var I,A;let T;if(typeof C=="function"?T=C(k):T=C,!T)return k;const P=k==null?void 0:k.find(R=>R.id===T.id),N={id:T.id,item:P?wm(P,T):{...T,position:{x:((I=T.position)==null?void 0:I.x)||0,y:((A=T.position)==null?void 0:A.y)||0}},type:P?"replace":"add"};return ls([N],k)})},[a]);return{syncEdges:O,initialFlow:j,loadingState:b,prepareFlowInfo:x,updateNodeChanges:_,updateEdgeChanges:S,updateOrCreateNode:M,currentSessionIdRef:v,updateEdgeConnection:E}},XRe=e=>{const t=et(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=De(u=>u.ready),c=De(u=>u.removeSyncNodeQueue),l=De(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=De.subscribe(f=>f.syncNodeQueue,async(f,p)=>{const m=p.map(v=>v.timestamp),y=f.filter(v=>!m.includes(v.timestamp));y.length&&c(y.map(v=>v.timestamp))}),d=De.subscribe(f=>f.syncEdgeQueue,async(f,p)=>{const m=p.map(v=>v.timestamp),y=f.filter(v=>!m.includes(v.timestamp));y.length&&(l(y.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},JRe=()=>{const[e,t]=g.useState(!0),n=GRe(),r=oo(u=>u.selectedModel),a=g.useRef(r),o=oo(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return XRe(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const f=`${a.current}`;i(p=>{const m=p==null?void 0:p.find(y=>{var v;return(v=y.data)!=null&&v.entity&&typeof y.data.entity=="object"&&"name"in y.data.entity?y.data.entity.name===f:!1});if(m)return m.data.label=d.text,m.data.status=Je.Loading,d.progress===100&&(m.data.label="",m.data.status=Je.Loaded),m})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},YRe=()=>{const e=eu(l=>l.theme),t=De(l=>l.nodes),n=De(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=JRe(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Yue,{nodes:t,edges:n,nodeTypes:vG,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:hi.Free,colorMode:e,fitView:!0,children:[h.jsx(sde,{variant:Io.Dots,gap:24,size:1}),h.jsx(hde,{}),h.jsx(Ode,{}),o3e?h.jsx(CG,{}):void 0]})},QRe=g.memo(YRe);function eDe(){return h.jsx(QRe,{})}const tDe=g.lazy(()=>Ht(()=>import("./DocumentViewer-S48eyvjc.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),nDe=()=>{const{documentId:e}=Lp();return h.jsx(g.Suspense,{fallback:h.jsx(ru,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(tDe,{name:e||""})})};function gv(){const e=jP();return Us(e),h.jsx(i3e,{})}const rDe=TJ(h.jsxs(si,{errorElement:h.jsx(gv,{}),children:[h.jsxs(si,{element:h.jsx(cI,{requiredSession:!0}),children:[h.jsx(si,{path:fh.whiteboard,Component:eDe,errorElement:h.jsx(gv,{})}),h.jsx(si,{path:fh.application,errorElement:h.jsx(gv,{}),Component:zbe}),h.jsx(si,{path:"*",element:h.jsx(kJ,{to:dn("whiteboard")})})]}),h.jsx(si,{element:h.jsx(cI,{}),children:h.jsx(si,{path:fh.document,errorElement:h.jsx(gv,{}),Component:nDe})})]})),aDe=(e,t)=>{switch(Iee){case"browser":return AP(e,t);case"hash":return rY(e);default:return AP(e,t)}},oDe=aDe(rDe,{basename:"/NoLLMChat/"});qG("[BASE_URL]","/NoLLMChat/");let NG;NG=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(ru,{className:"w-screen h-screen",simple:!0}):h.jsx(hY,{router:oDe})},()=>!0),eX=Object.freeze(Object.defineProperty({__proto__:null,default:NG},Symbol.toStringTag,{value:"Module"}))});export{ou as $,zM as A,Nv as B,UM as C,VM as D,iu as E,Mv as F,su as G,Wi as H,bp as I,wp as J,kv as K,qM as L,WM as M,qs as N,HM as O,KM as P,ZM as Q,GM as R,Pv as S,XM as T,JM as U,YM as V,QM as W,ek as X,tk as Y,Av as Z,Rt as _,l3e as __tla,Tv as a,Iv as a$,cu as a0,Hi as a1,Ki as a2,xp as a3,lu as a4,Ws as a5,Hs as a6,nk as a7,Rv as a8,rk as a9,ak as aA,ZG as aB,Dv as aC,ok as aD,Lv as aE,ik as aF,lo as aG,GG as aH,ri as aI,uu as aJ,du as aK,$v as aL,Fv as aM,Bv as aN,zv as aO,Uv as aP,Vv as aQ,qv as aR,Wv as aS,sk as aT,ck as aU,_p as aV,Hv as aW,Kv as aX,Zv as aY,Gv as aZ,Xv as a_,lk as aa,XG as ab,Jv as ac,JG as ad,uk as ae,dk as af,fk as ag,Yv as ah,pk as ai,YG as aj,Qv as ak,e0 as al,t0 as am,hk as an,n0 as ao,r0 as ap,a0 as aq,o0 as ar,i0 as as,s0 as at,mk as au,yk as av,QG as aw,c0 as ax,gk as ay,vk as az,fu as b,l0 as b0,u0 as b1,d0 as b2,jp as b3,En as b4,f0 as b5,Sp as b6,p0 as b7,h0 as b8,pu as b9,eX as bA,hu as ba,tX as bb,bk as bc,qe as bd,Ks as be,m0 as bf,y0 as bg,Xn as bh,De as bi,Fn as bj,Bn as bk,g0 as bl,v0 as bm,wk as bn,xk as bo,b0 as bp,w0 as bq,tt as br,_k as bs,x0 as bt,_0 as bu,jk as bv,Sk as bw,Ek as bx,Zs as by,ai as bz,Ok as c,Vr as d,j0 as e,Ck as f,Nk as g,Gs as h,qr as i,S0 as j,E0 as k,Mk as l,Pa as m,kk as n,O0 as o,C0 as p,Pk as q,Ak as r,Tk as s,N0 as t,zn as u,mu as v,M0 as w,yu as x,Xs as y,Ik as z};
