const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-DSdXkoPe.js","assets/index-DwrWqtDD.js","assets/index-D2CYecmu.css","assets/copy-Biaduc2C.js","assets/createLucideIcon-7d8mBqtE.js","assets/refresh-ccw-CS7dBfxL.js","assets/volume-2-CfZifQMa.js","assets/index-BG3xyZmB.js","assets/pdf-LFgu0vye.js","assets/pdf.min-Dzflniks.js","assets/pdf.worker.min-B2T89Jua.js","assets/index-DapbfuH2.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-CglnB9WG.js","assets/index-Cr8Tc6mT.css","assets/PlateEditor-JAHzsm90.js","assets/chevron-down-F9L9qeqr.js","assets/chevron-right-CkxfyHKr.js","assets/check-Ct42ok_s.js","assets/ellipsis-Bgt4jp0N.js","assets/highlighter-CnsB_ADF.js","assets/keyboard-CijNbOZa.js","assets/superscript-DeF0mZWZ.js","assets/subscript-BnwYua2b.js","assets/align-left-fSViB0c9.js","assets/align-center-BSNZ2cF2.js","assets/align-right-CoRpcQjg.js","assets/align-justify-CR-sY3By.js","assets/plus-DUQnLVkr.js","assets/eraser-lRlTRwOP.js","assets/star-DhQIHT5Y.js","assets/flag-DF_h5FDg.js","assets/apple-Cnwmulp_.js","assets/clock-CNOdy8XT.js","assets/leaf-Cg69bJIM.js","assets/lightbulb-C4Tt7aOg.js","assets/smile-DxI8DquG.js","assets/compass-Bz_GlMz3.js","assets/music-OgHaZDeB.js","assets/x-DlkWaALo.js","assets/search-C5bxCwL-.js","assets/external-link-vEhD0ywo.js","assets/redo-2-ZFxPmShe.js","assets/undo-2-mZMK5Q-W.js","assets/list-Yi6AaAe1.js","assets/list-ordered-D2h9p6oH.js","assets/list-todo-i1M2cIVW.js","assets/indent-increase-_2b7tjog.js","assets/pilcrow-BpwgOCXz.js","assets/heading-1-D_RFowFe.js","assets/heading-2-oxNuoYaQ.js","assets/heading-3-Dhk6D5ft.js","assets/table-WCR3P-Id.js","assets/file-code-DsBBxo0X.js","assets/quote-D6Gn3--h.js","assets/minus-CXvHdY24.js","assets/square-bfj4I5ap.js","assets/image-C5aExs6F.js","assets/table-of-contents-LezsLgXQ.js","assets/columns-3-BEzwC5Ae.js","assets/link-2-WOx1l9kt.js","assets/calendar-lzt0yEtn.js","assets/wrap-text-DnvOtwcE.js","assets/link-C5t5Qm7u.js","assets/pen-fbeQtnrs.js","assets/eye-COyoGKDQ.js","assets/indent-decrease-QTY1nb10.js","assets/trash-DH0CsrJh.js","assets/rectangle-vertical-B50D554i.js","assets/rectangle-horizontal-C6VMEB4Z.js","assets/list-collapse-DRuqYGr5.js","assets/pointer-CxjOA2cE.js","assets/wand-sparkles-CfsNVog-.js","assets/bold-YwFvmO22.js","assets/italic-C8nCVxmE.js","assets/underline-CsPerbh0.js","assets/strikethrough-C4DBHJIX.js","assets/code-xml-GoXL_Jt-.js","assets/baseline-BHaUgbek.js","assets/paint-bucket-8qf_QR8a.js","assets/arrow-up-to-line-D86T14ww.js","assets/circle-D4kIqUXv.js","assets/text-CMHfkMey.js","assets/unlink-BNyMKiQh.js","assets/arrow-left-Lgr4dkDw.js","assets/arrow-right-C7Z1em7j.js","assets/download-DQQTfYXF.js","assets/chevrons-up-down-BHXcSIGN.js","assets/trash-2-Dp_09X-N.js","assets/chevron-left-BGuoACkn.js","assets/sparkles-FEn3u6B3.js","assets/combine-DFKhEa49.js","assets/ungroup-DQU_r_zU.js","assets/grip-vertical-CUnmzbIC.js","assets/pen-line-51lOnsz5.js","assets/badge-help-B42ryp-S.js","assets/wand-COFTDxDH.js","assets/list-end-BJnhDRW1.js","assets/list-plus-CaNJpQHE.js","assets/list-minus-Le007RBY.js","assets/feather-C9A0vjU4.js","assets/album-Cj5zIk13.js","assets/corner-up-left-ClbIUTMZ.js","assets/loader-circle-C6hlR96S.js","assets/use-prevent-pitch-zoom-Cg-pi43c.js","assets/PlateEditor-BQPW60dV.css","assets/index-Dn1R432j.js","assets/index-CLQQLuRg.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-BNeiHUaV.js","assets/folder-open-B9y7EWkV.js","assets/folder-BtmGXONw.js","assets/file-Bsr1OJpy.js"])))=>i.map(i=>d[i]);
import{r as g,M as jE,j as p,u as qh,P as vwe,a as EE,L as bwe,m as xwe,c as wwe,f as I9,i as _we,b as SE,d as D9,e as jwe,g as Ewe,h as sn,l as Or,k as Du,n as xn,R as Swe,o as Vn,p as en,q as Oe,s as he,t as Mn,v as rt,w as K,x as Jr,S as Gr,y as Vo,D as Lu,z as Cwe,A as Fu,B as le,C as L9,E as Owe,F as Me,G as Bu,H as Je,I as $u,J as ba,K as Kt,N as Bt,O as ce,Q as zu,T as F9,U as Nwe,V as Mwe,W as B9,X as Zs,Y as Yh,Z as Kh,_ as Xe,$ as $9,a0 as V,a1 as ec,a2 as kwe,a3 as Pwe,a4 as z9,a5 as oe,a6 as Awe,a7 as xa,a8 as Twe,a9 as Nt,aa as Vu,ab as Rwe,ac as fi,ad as Uu,ae as V9,af as Hu,ag as Iwe,ah as tr,ai as Xh,aj as Dwe,ak as Lwe,al as CE,am as U9,an as Fwe,ao as Bwe,ap as $we,aq as tc,ar as zwe,as as Vwe,at as H9,au as Uwe,av as Hwe,aw as Wwe,ax as qwe,ay as W9,az as OE,aA as ut,aB as Ywe,aC as NE,aD as Kwe,aE as Xwe,aF as Qwe,aG as Jwe,__tla as Gwe}from"./index-DwrWqtDD.js";import Zwe,{__tla as e1e}from"./copy-Biaduc2C.js";import t1e,{__tla as n1e}from"./refresh-ccw-CS7dBfxL.js";import r1e,{__tla as o1e}from"./volume-2-CfZifQMa.js";let q9,ME,Qh,kE,PE,nc,Jh,rc,wa,Wu,qu,Gh,AE,TE,pi,RE,IE,DE,LE,Zh,FE,BE,$E,zE,VE,UE,HE,Zr,em,oc,Uo,ac,tm,ic,nm,rm,Y9,WE,K9,qE,om,am,im,sm,YE,KE,Yu,cm,lm,um,dm,fm,pm,hm,mm,ym,gm,vm,bm,xm,wm,_m,XE,jm,QE,X9,mt,JE,GE,Q9,Em,sc,ZE,J9,Sm,Cm,Om,eS,Nm,Mm,km,Pm,Am,Tm,tS,nS,G9,rS,Z9,oS,Rm,Im,Dm,cc,lc,_a,ja,Ku,uc,hi,mi,ez,aS,iS,sS,Lm,Fm,cS,Qe,wn,Ae,cn,ln,Bm,$m,lS,uS,zm,Vm,at,dS,Um,Hm,fS,pS,hS,yi,Ho,tz,mS,nr,Wm,yS,gS,gi,rr,qm,Ym,vS,Nr,bS,Km,Xm,xS,wS,_S,Qm,un,dc,Jm,fc,vi,jS,a1e=Promise.all([(()=>{try{return Gwe}catch{}})(),(()=>{try{return e1e}catch{}})(),(()=>{try{return n1e}catch{}})(),(()=>{try{return o1e}catch{}})()]).then(async()=>{class rz extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function oz({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0}),{nonce:a}=g.useContext(jE);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=o.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return a&&(u.nonce=a),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),p.jsx(rz,{isPresent:t,childRef:r,sizeRef:o,children:g.cloneElement(e,{ref:r})})}const az=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:o,presenceAffectsLayout:a,mode:i})=>{const s=qh(iz),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const f of s.values())if(!f)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:o,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),a?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,f)=>s.set(f,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=p.jsx(oz,{isPresent:n,children:e})),p.jsx(vwe.Provider,{value:u,children:e})};function iz(){return new Map}const Xu=e=>e.key||"";function SS(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const sz=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:o,presenceAffectsLayout:a=!0,mode:i="sync"})=>{const s=g.useMemo(()=>SS(e),[e]),c=s.map(Xu),l=g.useRef(!0),u=g.useRef(s),d=qh(()=>new Map),[f,h]=g.useState(s),[y,m]=g.useState(s);EE(()=>{l.current=!1,u.current=s;for(let x=0;x<y.length;x++){const _=Xu(y[x]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[y,c.length,c.join("-")]);const v=[];if(s!==f){let x=[...s];for(let _=0;_<y.length;_++){const w=y[_],j=Xu(w);c.includes(j)||(x.splice(_,0,w),v.push(w))}i==="wait"&&v.length&&(x=v),m(SS(x)),h(s);return}const{forceRender:b}=g.useContext(bwe);return p.jsx(p.Fragment,{children:y.map(x=>{const _=Xu(x),w=s===y||c.includes(_),j=()=>{if(d.has(_))d.set(_,!0);else return;let E=!0;d.forEach(S=>{S||(E=!1)}),E&&(b==null||b(),m(u.current),o&&o())};return p.jsx(az,{isPresent:w,initial:!l.current||r?void 0:!1,custom:w?void 0:n,presenceAffectsLayout:a,mode:i,onExitComplete:w?void 0:j,children:x},_)})})};function Gm(e){const t=qh(()=>xwe(e)),{isStatic:n}=g.useContext(jE);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function CS(e,t){const n=Gm(t()),r=()=>n.set(t());return r(),EE(()=>{const o=()=>I9.preRender(r,!1,!0),a=e.map(i=>i.on("change",o));return()=>{a.forEach(i=>i()),wwe(r)}}),n}const cz=e=>e&&typeof e=="object"&&e.mix,lz=e=>cz(e)?e.mix:void 0;function uz(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],o=e[1+n],a=e[2+n],i=e[3+n],s=_we(o,a,{mixer:lz(a[0]),...i});return t?s(r):s}function dz(e){SE.current=[],e();const t=CS(SE.current,e);return SE.current=void 0,t}function OS(e,t,n,r){if(typeof e=="function")return dz(e);const o=typeof t=="function"?t:uz(t,n,r);return Array.isArray(e)?NS(e,o):NS([e],([a])=>o(a))}function NS(e,t){const n=qh(()=>[]);return CS(e,()=>{n.length=0;const r=e.length;for(let o=0;o<r;o++)n[o]=e[o].get();return t(n)})}function MS(e){return typeof e=="number"?e:parseFloat(e)}function fz(e,t={}){const{isStatic:n}=g.useContext(jE),r=g.useRef(null),o=Gm(D9(e)?MS(e.get()):e),a=g.useRef(o.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(jwe.delta),c(),r.current=Ewe({keyframes:[o.get(),a.current],velocity:o.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>o.attach((l,u)=>n?u(l):(a.current=l,i.current=u,I9.update(s),o.get()),c),[JSON.stringify(t)]),EE(()=>{if(D9(e))return e.on("change",l=>o.set(MS(l)))},[o]),o}var et=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(et||{}),pc=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(pc||{}),Qu=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e))(Qu||{}),eo=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(eo||{}),kn=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(kn||{}),Ju=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(Ju||{}),Pn=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(Pn||{}),bi=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(bi||{});let kS,Zm;kS=async(e,t)=>{let n="",r="",o;const a=[];await e;for await(const i of e)i&&(Array.isArray(i)?(a.push(...i.map(s=>s.content)),a!=null&&a.length&&(r=a.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),o=i);return{lastChunk:o,content:n}},Zm=()=>{const e=sn(r=>r.toolsCallingStream),t=sn(r=>r.structuredStream),n=sn(r=>r.stream);return{stream:g.useCallback(async(r,{tools:o,schemas:a,onMessageUpdate:i,onMessageFinish:s})=>{var d;let c;if(a!=null&&a.length?(a&&(a==null?void 0:a.length)>1&&Or("Multiple schemas are not supported. Only the first schema will be used."),c=t(((d=a==null?void 0:a[0])==null?void 0:d.schema_items)||[],r)):o!=null&&o.length?c=e(o,r):c=n(r),!c)throw new Error("Stream is not supported");const{lastChunk:l,content:u}=await kS(c,i);return s==null||s({content:u,lastChunk:l}),{lastChunk:l,content:u}},[n,t,e])}},Jh=globalThis||void 0||self;var hc={},PS;function pz(){if(PS)return hc;PS=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.parse=i,hc.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,a=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,h){const y=new a,m=f.length;if(m<2)return y;const v=(h==null?void 0:h.decode)||u;let b=0;do{const x=f.indexOf("=",b);if(x===-1)break;const _=f.indexOf(";",b),w=_===-1?m:_;if(x>w){b=f.lastIndexOf(";",x-1)+1;continue}const j=s(f,b,x),E=c(f,x,j),S=f.slice(j,E);if(y[S]===void 0){let O=s(f,x+1,w),k=c(f,w,O);const N=v(f.slice(O,k));y[S]=N}b=w+1}while(b<m);return y}function s(f,h,y){do{const m=f.charCodeAt(h);if(m!==32&&m!==9)return h}while(++h<y);return y}function c(f,h,y){for(;h>y;){const m=f.charCodeAt(--h);if(m!==32&&m!==9)return h+1}return y}function l(f,h,y){const m=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const v=m(h);if(!t.test(v))throw new TypeError(`argument val is invalid: ${h}`);let b=f+"="+v;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return o.call(f)==="[object Date]"}return hc}pz();var AS="popstate";function hz(e={}){function t(r,o){let{pathname:a,search:i,hash:s}=r.location;return xi("",{pathname:a,search:i,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:to(o)}return RS(t,n,null,e)}function mz(e={}){function t(o,a){let{pathname:i="/",search:s="",hash:c=""}=no(o.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),xi("",{pathname:i,search:s,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(o,a){let i=o.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=o.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof a=="string"?a:to(a))}function r(o,a){$t(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return RS(t,n,r,e)}function $e(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $t(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yz(){return Math.random().toString(36).substring(2,10)}function TS(e,t){return{usr:e.state,key:e.key,idx:t}}function xi(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?no(t):t,state:n,key:t&&t.key||r||yz()}}function to({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function no(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function RS(e,t,n,r={}){let{window:o=document.defaultView,v5Compat:a=!1}=r,i=o.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:m.location,delta:b})}function f(v,b){s="PUSH";let x=xi(m.location,v,b);n&&n(x,v),l=u()+1;let _=TS(x,l),w=m.createHref(x);try{i.pushState(_,"",w)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;o.location.assign(w)}a&&c&&c({action:s,location:m.location,delta:1})}function h(v,b){s="REPLACE";let x=xi(m.location,v,b);n&&n(x,v),l=u();let _=TS(x,l),w=m.createHref(x);i.replaceState(_,"",w),a&&c&&c({action:s,location:m.location,delta:0})}function y(v){let b=o.location.origin!=="null"?o.location.origin:o.location.href,x=typeof v=="string"?v:to(v);return x=x.replace(/ $/,"%20"),$e(b,`No window.location.(origin|href) available to create URL for href: ${x}`),new URL(x,b)}let m={get action(){return s},get location(){return e(o,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return o.addEventListener(AS,d),c=v,()=>{o.removeEventListener(AS,d),c=null}},createHref(v){return t(o,v)},createURL:y,encodeLocation(v){let b=y(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:h,go(v){return i.go(v)}};return m}var gz=new Set(["lazy","caseSensitive","path","id","index","children"]);function vz(e){return e.index===!0}function Gu(e,t,n=[],r={}){return e.map((o,a)=>{let i=[...n,String(a)],s=typeof o.id=="string"?o.id:i.join("-");if($e(o.index!==!0||!o.children,"Cannot specify children on an index route"),$e(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),vz(o)){let c={...o,...t(o),id:s};return r[s]=c,c}else{let c={...o,...t(o),id:s,children:void 0};return r[s]=c,o.children&&(c.children=Gu(o.children,t,i,r)),c}})}function Wo(e,t,n="/"){return Zu(e,t,n,!1)}function Zu(e,t,n,r){let o=typeof t=="string"?no(t):t,a=or(o.pathname||"/",n);if(a==null)return null;let i=IS(e);xz(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=Pz(a);s=Mz(i[c],l,r)}return s}function bz(e,t){let{route:n,pathname:r,params:o}=e;return{id:n.id,pathname:r,params:o,data:t[n.id],handle:n.handle}}function IS(e,t=[],n=[],r=""){let o=(a,i,s)=>{let c={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&($e(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=Mr([r,c.relativePath]),u=n.concat(c);a.children&&a.children.length>0&&($e(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),IS(a.children,t,u,l)),!(a.path==null&&!a.index)&&t.push({path:l,score:Oz(l,a.index),routesMeta:u})};return e.forEach((a,i)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))o(a,i);else for(let c of DS(a.path))o(a,i,c)}),t}function DS(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return o?[a,""]:[a];let i=DS(r.join("/")),s=[];return s.push(...i.map(c=>c===""?a:[a,c].join("/"))),o&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function xz(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Nz(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var wz=/^:[\w-]+$/,_z=3,jz=2,Ez=1,Sz=10,Cz=-2,LS=e=>e==="*";function Oz(e,t){let n=e.split("/"),r=n.length;return n.some(LS)&&(r+=Cz),t&&(r+=jz),n.filter(o=>!LS(o)).reduce((o,a)=>o+(wz.test(a)?_z:a===""?Ez:Sz),r)}function Nz(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function Mz(e,t,n=!1){let{routesMeta:r}=e,o={},a="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=a==="/"?t:t.slice(a.length)||"/",d=ed({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=ed({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(o,d.params),i.push({params:o,pathname:Mr([a,d.pathname]),pathnameBase:Rz(Mr([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=Mr([a,d.pathnameBase]))}return i}function ed(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=kz(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],i=a.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let h=s[d]||"";i=a.slice(0,a.length-h.length).replace(/(.)\/+$/,"$1")}const f=s[d];return u&&!f?c[l]=void 0:c[l]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function kz(e,t=!1,n=!0){$t(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function Pz(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return $t(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function or(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Az(e,t="/"){let{pathname:n,search:r="",hash:o=""}=typeof e=="string"?no(e):e;return{pathname:n?n.startsWith("/")?n:Tz(n,t):t,search:Iz(r),hash:Dz(o)}}function Tz(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function ey(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function FS(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function td(e){let t=FS(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function nd(e,t,n,r=!1){let o;typeof e=="string"?o=no(e):(o={...e},$e(!o.pathname||!o.pathname.includes("?"),ey("?","pathname","search",o)),$e(!o.pathname||!o.pathname.includes("#"),ey("#","pathname","hash",o)),$e(!o.search||!o.search.includes("#"),ey("#","search","hash",o)));let a=e===""||o.pathname==="",i=a?"/":o.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?t[d]:"/"}let c=Az(o,s),l=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var Mr=e=>e.join("/").replace(/\/\/+/g,"/"),Rz=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Iz=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Dz=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,rd=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function od(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var BS=["POST","PUT","PATCH","DELETE"],Lz=new Set(BS),Fz=["GET",...BS],Bz=new Set(Fz),$z=new Set([301,302,303,307,308]),zz=new Set([307,308]),ty={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Vz={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},mc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ny=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Uz=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),$S="remix-router-transitions",zS=Symbol("ResetLoaderData");function VS(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";$e(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||Uz,o={},a=Gu(e.routes,r,void 0,o),i,s=e.basename||"/",c=e.dataStrategy||Kz,l=e.patchRoutesOnNavigation,u={...e.future},d=null,f=new Set,h=null,y=null,m=null,v=e.hydrationData!=null,b=Wo(a,e.history.location,s),x=null;if(b==null&&!l){let z=Un(404,{pathname:e.history.location.pathname}),{matches:X,route:ne}=eC(a);b=X,x={[ne.id]:z}}b&&!e.hydrationData&&je(b,a,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(z=>z.route.lazy))_=!1;else if(!b.some(z=>z.route.loader))_=!0;else{let z=e.hydrationData?e.hydrationData.loaderData:null,X=e.hydrationData?e.hydrationData.errors:null;if(X){let ne=b.findIndex(de=>X[de.route.id]!==void 0);_=b.slice(0,ne+1).every(de=>!oy(de.route,z,X))}else _=b.every(ne=>!oy(ne.route,z,X))}else{_=!1,b=[];let z=je(null,a,e.history.location.pathname);z.active&&z.matches&&(b=z.matches)}let w,j={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:ty,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||x,fetchers:new Map,blockers:new Map},E="POP",S=!1,O,k=!1,N=new Map,P=null,R=!1,A=!1,C=new Set,M=new Map,T=0,D=-1,I=new Map,L=new Set,B=new Map,U=new Map,F=new Set,H=new Map,J,q=null;function re(){if(d=e.history.listen(({action:z,location:X,delta:ne})=>{if(J){J(),J=void 0;return}$t(H.size===0||ne!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let de=Mt({currentLocation:j.location,nextLocation:X,historyAction:z});if(de&&ne!=null){let Se=new Promise(Pe=>{J=Pe});e.history.go(ne*-1),ke(de,{state:"blocked",location:X,proceed(){ke(de,{state:"proceeding",proceed:void 0,reset:void 0,location:X}),Se.then(()=>e.history.go(ne))},reset(){let Pe=new Map(j.blockers);Pe.set(de,mc),W({blockers:Pe})}});return}return se(z,X)}),n){a7(t,N);let z=()=>i7(t,N);t.addEventListener("pagehide",z),P=()=>t.removeEventListener("pagehide",z)}return j.initialized||se("POP",j.location,{initialHydration:!0}),w}function Z(){d&&d(),P&&P(),f.clear(),O&&O.abort(),j.fetchers.forEach((z,X)=>Sr(X)),j.blockers.forEach((z,X)=>pe(X))}function Y(z){return f.add(z),()=>f.delete(z)}function W(z,X={}){j={...j,...z};let ne=[],de=[];j.fetchers.forEach((Se,Pe)=>{Se.state==="idle"&&(F.has(Pe)?ne.push(Pe):de.push(Pe))}),[...f].forEach(Se=>Se(j,{deletedFetchers:ne,viewTransitionOpts:X.viewTransitionOpts,flushSync:X.flushSync===!0})),ne.forEach(Se=>Sr(Se)),de.forEach(Se=>j.fetchers.delete(Se))}function G(z,X,{flushSync:ne}={}){var be,De;let de=j.actionData!=null&&j.navigation.formMethod!=null&&ar(j.navigation.formMethod)&&j.navigation.state==="loading"&&((be=z.state)==null?void 0:be._isRedirect)!==!0,Se;X.actionData?Object.keys(X.actionData).length>0?Se=X.actionData:Se=null:de?Se=j.actionData:Se=null;let Pe=X.loaderData?GS(j.loaderData,X.loaderData,X.matches||[],X.errors):j.loaderData,Ie=j.blockers;Ie.size>0&&(Ie=new Map(Ie),Ie.forEach((Ue,gt)=>Ie.set(gt,mc)));let Ce=S===!0||j.navigation.formMethod!=null&&ar(j.navigation.formMethod)&&((De=z.state)==null?void 0:De._isRedirect)!==!0;i&&(a=i,i=void 0),R||E==="POP"||(E==="PUSH"?e.history.push(z,z.state):E==="REPLACE"&&e.history.replace(z,z.state));let Ne;if(E==="POP"){let Ue=N.get(j.location.pathname);Ue&&Ue.has(z.pathname)?Ne={currentLocation:j.location,nextLocation:z}:N.has(z.pathname)&&(Ne={currentLocation:z,nextLocation:j.location})}else if(k){let Ue=N.get(j.location.pathname);Ue?Ue.add(z.pathname):(Ue=new Set([z.pathname]),N.set(j.location.pathname,Ue)),Ne={currentLocation:j.location,nextLocation:z}}W({...X,actionData:Se,loaderData:Pe,historyAction:E,location:z,initialized:!0,navigation:ty,revalidation:"idle",restoreScrollPosition:_e(z,X.matches||j.matches),preventScrollReset:Ce,blockers:Ie},{viewTransitionOpts:Ne,flushSync:ne===!0}),E="POP",S=!1,k=!1,R=!1,A=!1,q==null||q.resolve(),q=null}async function te(z,X){if(typeof z=="number"){e.history.go(z);return}let ne=ry(j.location,j.matches,s,z,X==null?void 0:X.fromRouteId,X==null?void 0:X.relative),{path:de,submission:Se,error:Pe}=US(!1,ne,X),Ie=j.location,Ce=xi(j.location,de,X&&X.state);Ce={...Ce,...e.history.encodeLocation(Ce)};let Ne=X&&X.replace!=null?X.replace:void 0,be="PUSH";Ne===!0?be="REPLACE":Ne===!1||Se!=null&&ar(Se.formMethod)&&Se.formAction===j.location.pathname+j.location.search&&(be="REPLACE");let De=X&&"preventScrollReset"in X?X.preventScrollReset===!0:void 0,Ue=(X&&X.flushSync)===!0,gt=Mt({currentLocation:Ie,nextLocation:Ce,historyAction:be});if(gt){ke(gt,{state:"blocked",location:Ce,proceed(){ke(gt,{state:"proceeding",proceed:void 0,reset:void 0,location:Ce}),te(z,X)},reset(){let _t=new Map(j.blockers);_t.set(gt,mc),W({blockers:_t})}});return}await se(be,Ce,{submission:Se,pendingError:Pe,preventScrollReset:De,replace:X&&X.replace,enableViewTransition:X&&X.viewTransition,flushSync:Ue})}function $(){q||(q=s7()),St(),W({revalidation:"loading"});let z=q.promise;return j.navigation.state==="submitting"?z:j.navigation.state==="idle"?(se(j.historyAction,j.location,{startUninterruptedRevalidation:!0}),z):(se(E||j.historyAction,j.navigation.location,{overrideNavigation:j.navigation,enableViewTransition:k===!0}),z)}async function se(z,X,ne){O&&O.abort(),O=null,E=z,R=(ne&&ne.startUninterruptedRevalidation)===!0,we(j.location,j.matches),S=(ne&&ne.preventScrollReset)===!0,k=(ne&&ne.enableViewTransition)===!0;let de=i||a,Se=ne&&ne.overrideNavigation,Pe=Wo(de,X,s),Ie=(ne&&ne.flushSync)===!0,Ce=je(Pe,de,X.pathname);if(Ce.active&&Ce.matches&&(Pe=Ce.matches),!Pe){let{error:Ke,notFoundMatches:On,route:At}=wt(X.pathname);G(X,{matches:On,loaderData:{},errors:{[At.id]:Ke}},{flushSync:Ie});return}if(j.initialized&&!A&&e7(j.location,X)&&!(ne&&ne.submission&&ar(ne.submission.formMethod))){G(X,{matches:Pe},{flushSync:Ie});return}O=new AbortController;let Ne=wi(e.history,X,O.signal,ne&&ne.submission),be;if(ne&&ne.pendingError)be=[Ea(Pe).route.id,{type:"error",error:ne.pendingError}];else if(ne&&ne.submission&&ar(ne.submission.formMethod)){let Ke=await ue(Ne,X,ne.submission,Pe,Ce.active,{replace:ne.replace,flushSync:Ie});if(Ke.shortCircuited)return;if(Ke.pendingActionResult){let[On,At]=Ke.pendingActionResult;if(An(At)&&od(At.error)&&At.error.status===404){O=null,G(X,{matches:Ke.matches,loaderData:{},errors:{[On]:At.error}});return}}Pe=Ke.matches||Pe,be=Ke.pendingActionResult,Se=sy(X,ne.submission),Ie=!1,Ce.active=!1,Ne=wi(e.history,Ne.url,Ne.signal)}let{shortCircuited:De,matches:Ue,loaderData:gt,errors:_t}=await ve(Ne,X,Pe,Ce.active,Se,ne&&ne.submission,ne&&ne.fetcherSubmission,ne&&ne.replace,ne&&ne.initialHydration===!0,Ie,be);De||(O=null,G(X,{matches:Ue||Pe,...ZS(be),loaderData:gt,errors:_t}))}async function ue(z,X,ne,de,Se,Pe={}){St();let Ie=r7(X,ne);if(W({navigation:Ie},{flushSync:Pe.flushSync===!0}),Se){let be=await Le(de,X.pathname,z.signal);if(be.type==="aborted")return{shortCircuited:!0};if(be.type==="error"){let De=Ea(be.partialMatches).route.id;return{matches:be.partialMatches,pendingActionResult:[De,{type:"error",error:be.error}]}}else if(be.matches)de=be.matches;else{let{notFoundMatches:De,error:Ue,route:gt}=wt(X.pathname);return{matches:De,pendingActionResult:[gt.id,{type:"error",error:Ue}]}}}let Ce,Ne=yc(de,X);if(!Ne.route.action&&!Ne.route.lazy)Ce={type:"error",error:Un(405,{method:z.method,pathname:X.pathname,routeId:Ne.route.id})};else if(Ce=(await lt("action",j,z,[Ne],de,null))[Ne.route.id],z.signal.aborted)return{shortCircuited:!0};if(Sa(Ce)){let be;return Pe&&Pe.replace!=null?be=Pe.replace:be=XS(Ce.response.headers.get("Location"),new URL(z.url),s)===j.location.pathname+j.location.search,await He(z,Ce,!0,{submission:ne,replace:be}),{shortCircuited:!0}}if(An(Ce)){let be=Ea(de,Ne.route.id);return(Pe&&Pe.replace)!==!0&&(E="PUSH"),{matches:de,pendingActionResult:[be.route.id,Ce]}}return{matches:de,pendingActionResult:[Ne.route.id,Ce]}}async function ve(z,X,ne,de,Se,Pe,Ie,Ce,Ne,be,De){let Ue=Se||sy(X,Pe),gt=Pe||Ie||oC(Ue),_t=!R&&!Ne;if(de){if(_t){let Nn=Te(De);W({navigation:Ue,...Nn!==void 0?{actionData:Nn}:{}},{flushSync:be})}let nt=await Le(ne,X.pathname,z.signal);if(nt.type==="aborted")return{shortCircuited:!0};if(nt.type==="error"){let Nn=Ea(nt.partialMatches).route.id;return{matches:nt.partialMatches,loaderData:{},errors:{[Nn]:nt.error}}}else if(nt.matches)ne=nt.matches;else{let{error:Nn,notFoundMatches:di,route:Ot}=wt(X.pathname);return{matches:di,loaderData:{},errors:{[Ot.id]:Nn}}}}let Ke=i||a,[On,At]=WS(e.history,j,ne,gt,X,Ne===!0,A,C,F,B,L,Ke,s,De);if(D=++T,On.length===0&&At.length===0){let nt=Q();return G(X,{matches:ne,loaderData:{},errors:De&&An(De[1])?{[De[0]]:De[1].error}:null,...ZS(De),...nt?{fetchers:new Map(j.fetchers)}:{}},{flushSync:be}),{shortCircuited:!0}}if(_t){let nt={};if(!de){nt.navigation=Ue;let Nn=Te(De);Nn!==void 0&&(nt.actionData=Nn)}At.length>0&&(nt.fetchers=qe(At)),W(nt,{flushSync:be})}At.forEach(nt=>{Zn(nt.key),nt.controller&&M.set(nt.key,nt.controller)});let ui=()=>At.forEach(nt=>Zn(nt.key));O&&O.signal.addEventListener("abort",ui);let{loaderResults:Cr,fetcherResults:va}=await Ht(j,ne,On,At,z);if(z.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",ui),At.forEach(nt=>M.delete(nt.key));let Qr=ad(Cr);if(Qr)return await He(z,Qr.result,!0,{replace:Ce}),{shortCircuited:!0};if(Qr=ad(va),Qr)return L.add(Qr.key),await He(z,Qr.result,!0,{replace:Ce}),{shortCircuited:!0};let{loaderData:Iu,errors:er}=JS(j,ne,Cr,De,At,va);Ne&&j.errors&&(er={...j.errors,...er});let Qs=Q(),Js=ee(D),Gs=Qs||Js||At.length>0;return{matches:ne,loaderData:Iu,errors:er,...Gs?{fetchers:new Map(j.fetchers)}:{}}}function Te(z){if(z&&!An(z[1]))return{[z[0]]:z[1].data};if(j.actionData)return Object.keys(j.actionData).length===0?null:j.actionData}function qe(z){return z.forEach(X=>{let ne=j.fetchers.get(X.key),de=gc(void 0,ne?ne.data:void 0);j.fetchers.set(X.key,de)}),new Map(j.fetchers)}async function Ye(z,X,ne,de){Zn(z);let Se=(de&&de.flushSync)===!0,Pe=i||a,Ie=ry(j.location,j.matches,s,ne,X,de==null?void 0:de.relative),Ce=Wo(Pe,Ie,s),Ne=je(Ce,Pe,Ie);if(Ne.active&&Ne.matches&&(Ce=Ne.matches),!Ce){Rt(z,X,Un(404,{pathname:Ie}),{flushSync:Se});return}let{path:be,submission:De,error:Ue}=US(!0,Ie,de);if(Ue){Rt(z,X,Ue,{flushSync:Se});return}let gt=yc(Ce,be),_t=(de&&de.preventScrollReset)===!0;if(De&&ar(De.formMethod)){await ze(z,X,be,gt,Ce,Ne.active,Se,_t,De);return}B.set(z,{routeId:X,path:be}),await ct(z,X,be,gt,Ce,Ne.active,Se,_t,De)}async function ze(z,X,ne,de,Se,Pe,Ie,Ce,Ne){St(),B.delete(z);function be(Ot){if(!Ot.route.action&&!Ot.route.lazy){let zo=Un(405,{method:Ne.formMethod,pathname:ne,routeId:X});return Rt(z,X,zo,{flushSync:Ie}),!0}return!1}if(!Pe&&be(de))return;let De=j.fetchers.get(z);yt(z,o7(Ne,De),{flushSync:Ie});let Ue=new AbortController,gt=wi(e.history,ne,Ue.signal,Ne);if(Pe){let Ot=await Le(Se,ne,gt.signal);if(Ot.type==="aborted")return;if(Ot.type==="error"){Rt(z,X,Ot.error,{flushSync:Ie});return}else if(Ot.matches){if(Se=Ot.matches,de=yc(Se,ne),be(de))return}else{Rt(z,X,Un(404,{pathname:ne}),{flushSync:Ie});return}}M.set(z,Ue);let _t=T,Ke=(await lt("action",j,gt,[de],Se,z))[de.route.id];if(gt.signal.aborted){M.get(z)===Ue&&M.delete(z);return}if(F.has(z)){if(Sa(Ke)||An(Ke)){yt(z,qo(void 0));return}}else{if(Sa(Ke))if(M.delete(z),D>_t){yt(z,qo(void 0));return}else return L.add(z),yt(z,gc(Ne)),He(gt,Ke,!1,{fetcherSubmission:Ne,preventScrollReset:Ce});if(An(Ke)){Rt(z,X,Ke.error);return}}let On=j.navigation.location||j.location,At=wi(e.history,On,Ue.signal),ui=i||a,Cr=j.navigation.state!=="idle"?Wo(ui,j.navigation.location,s):j.matches;$e(Cr,"Didn't find any matches after fetcher action");let va=++T;I.set(z,va);let Qr=gc(Ne,Ke.data);j.fetchers.set(z,Qr);let[Iu,er]=WS(e.history,j,Cr,Ne,On,!1,A,C,F,B,L,ui,s,[de.route.id,Ke]);er.filter(Ot=>Ot.key!==z).forEach(Ot=>{let zo=Ot.key,Wh=j.fetchers.get(zo),wE=gc(void 0,Wh?Wh.data:void 0);j.fetchers.set(zo,wE),Zn(zo),Ot.controller&&M.set(zo,Ot.controller)}),W({fetchers:new Map(j.fetchers)});let Qs=()=>er.forEach(Ot=>Zn(Ot.key));Ue.signal.addEventListener("abort",Qs);let{loaderResults:Js,fetcherResults:Gs}=await Ht(j,Cr,Iu,er,At);if(Ue.signal.aborted)return;Ue.signal.removeEventListener("abort",Qs),I.delete(z),M.delete(z),er.forEach(Ot=>M.delete(Ot.key));let nt=ad(Js);if(nt)return He(At,nt.result,!1,{preventScrollReset:Ce});if(nt=ad(Gs),nt)return L.add(nt.key),He(At,nt.result,!1,{preventScrollReset:Ce});let{loaderData:Nn,errors:di}=JS(j,Cr,Js,void 0,er,Gs);if(j.fetchers.has(z)){let Ot=qo(Ke.data);j.fetchers.set(z,Ot)}ee(va),j.navigation.state==="loading"&&va>D?($e(E,"Expected pending action"),O&&O.abort(),G(j.navigation.location,{matches:Cr,loaderData:Nn,errors:di,fetchers:new Map(j.fetchers)})):(W({errors:di,loaderData:GS(j.loaderData,Nn,Cr,di),fetchers:new Map(j.fetchers)}),A=!1)}async function ct(z,X,ne,de,Se,Pe,Ie,Ce,Ne){let be=j.fetchers.get(z);yt(z,gc(Ne,be?be.data:void 0),{flushSync:Ie});let De=new AbortController,Ue=wi(e.history,ne,De.signal);if(Pe){let Ke=await Le(Se,ne,Ue.signal);if(Ke.type==="aborted")return;if(Ke.type==="error"){Rt(z,X,Ke.error,{flushSync:Ie});return}else if(Ke.matches)Se=Ke.matches,de=yc(Se,ne);else{Rt(z,X,Un(404,{pathname:ne}),{flushSync:Ie});return}}M.set(z,De);let gt=T,_t=(await lt("loader",j,Ue,[de],Se,z))[de.route.id];if(M.get(z)===De&&M.delete(z),!Ue.signal.aborted){if(F.has(z)){yt(z,qo(void 0));return}if(Sa(_t))if(D>gt){yt(z,qo(void 0));return}else{L.add(z),await He(Ue,_t,!1,{preventScrollReset:Ce});return}if(An(_t)){Rt(z,X,_t.error);return}yt(z,qo(_t.data))}}async function He(z,X,ne,{submission:de,fetcherSubmission:Se,preventScrollReset:Pe,replace:Ie}={}){X.response.headers.has("X-Remix-Revalidate")&&(A=!0);let Ce=X.response.headers.get("Location");$e(Ce,"Expected a Location header on the redirect Response"),Ce=XS(Ce,new URL(z.url),s);let Ne=xi(j.location,Ce,{_isRedirect:!0});if(n){let Ke=!1;if(X.response.headers.has("X-Remix-Reload-Document"))Ke=!0;else if(ny.test(Ce)){const On=e.history.createURL(Ce);Ke=On.origin!==t.location.origin||or(On.pathname,s)==null}if(Ke){Ie?t.location.replace(Ce):t.location.assign(Ce);return}}O=null;let be=Ie===!0||X.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:De,formAction:Ue,formEncType:gt}=j.navigation;!de&&!Se&&De&&Ue&&gt&&(de=oC(j.navigation));let _t=de||Se;if(zz.has(X.response.status)&&_t&&ar(_t.formMethod))await se(be,Ne,{submission:{..._t,formAction:Ce},preventScrollReset:Pe||S,enableViewTransition:ne?k:void 0});else{let Ke=sy(Ne,de);await se(be,Ne,{overrideNavigation:Ke,fetcherSubmission:Se,preventScrollReset:Pe||S,enableViewTransition:ne?k:void 0})}}async function lt(z,X,ne,de,Se,Pe){let Ie,Ce={};try{Ie=await Xz(c,z,X,ne,de,Se,Pe,o,r)}catch(Ne){return de.forEach(be=>{Ce[be.route.id]={type:"error",error:Ne}}),Ce}for(let[Ne,be]of Object.entries(Ie))if(t7(be)){let De=be.result;Ce[Ne]={type:"redirect",response:Gz(De,ne,Ne,Se,s)}}else Ce[Ne]=await Jz(be);return Ce}async function Ht(z,X,ne,de,Se){let Pe=lt("loader",z,Se,ne,X,null),Ie=Promise.all(de.map(async be=>{if(be.matches&&be.match&&be.controller){let De=(await lt("loader",z,wi(e.history,be.path,be.controller.signal),[be.match],be.matches,be.key))[be.match.route.id];return{[be.key]:De}}else return Promise.resolve({[be.key]:{type:"error",error:Un(404,{pathname:be.path})}})})),Ce=await Pe,Ne=(await Ie).reduce((be,De)=>Object.assign(be,De),{});return{loaderResults:Ce,fetcherResults:Ne}}function St(){A=!0,B.forEach((z,X)=>{M.has(X)&&C.add(X),Zn(X)})}function yt(z,X,ne={}){j.fetchers.set(z,X),W({fetchers:new Map(j.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Rt(z,X,ne,de={}){let Se=Ea(j.matches,X);Sr(z),W({errors:{[Se.route.id]:ne},fetchers:new Map(j.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function bn(z){return U.set(z,(U.get(z)||0)+1),F.has(z)&&F.delete(z),j.fetchers.get(z)||Vz}function Sr(z){let X=j.fetchers.get(z);M.has(z)&&!(X&&X.state==="loading"&&I.has(z))&&Zn(z),B.delete(z),I.delete(z),L.delete(z),F.delete(z),C.delete(z),j.fetchers.delete(z)}function li(z){let X=(U.get(z)||0)-1;X<=0?(U.delete(z),F.add(z)):U.set(z,X),W({fetchers:new Map(j.fetchers)})}function Zn(z){let X=M.get(z);X&&(X.abort(),M.delete(z))}function ga(z){for(let X of z){let ne=bn(X),de=qo(ne.data);j.fetchers.set(X,de)}}function Q(){let z=[],X=!1;for(let ne of L){let de=j.fetchers.get(ne);$e(de,`Expected fetcher: ${ne}`),de.state==="loading"&&(L.delete(ne),z.push(ne),X=!0)}return ga(z),X}function ee(z){let X=[];for(let[ne,de]of I)if(de<z){let Se=j.fetchers.get(ne);$e(Se,`Expected fetcher: ${ne}`),Se.state==="loading"&&(Zn(ne),I.delete(ne),X.push(ne))}return ga(X),X.length>0}function ie(z,X){let ne=j.blockers.get(z)||mc;return H.get(z)!==X&&H.set(z,X),ne}function pe(z){j.blockers.delete(z),H.delete(z)}function ke(z,X){let ne=j.blockers.get(z)||mc;$e(ne.state==="unblocked"&&X.state==="blocked"||ne.state==="blocked"&&X.state==="blocked"||ne.state==="blocked"&&X.state==="proceeding"||ne.state==="blocked"&&X.state==="unblocked"||ne.state==="proceeding"&&X.state==="unblocked",`Invalid blocker state transition: ${ne.state} -> ${X.state}`);let de=new Map(j.blockers);de.set(z,X),W({blockers:de})}function Mt({currentLocation:z,nextLocation:X,historyAction:ne}){if(H.size===0)return;H.size>1&&$t(!1,"A router only supports one blocker at a time");let de=Array.from(H.entries()),[Se,Pe]=de[de.length-1],Ie=j.blockers.get(Se);if(!(Ie&&Ie.state==="proceeding")&&Pe({currentLocation:z,nextLocation:X,historyAction:ne}))return Se}function wt(z){let X=Un(404,{pathname:z}),ne=i||a,{matches:de,route:Se}=eC(ne);return{notFoundMatches:de,route:Se,error:X}}function Be(z,X,ne){if(h=z,m=X,y=ne||null,!v&&j.navigation===ty){v=!0;let de=_e(j.location,j.matches);de!=null&&W({restoreScrollPosition:de})}return()=>{h=null,m=null,y=null}}function ge(z,X){return y&&y(z,X.map(ne=>bz(ne,j.loaderData)))||z.key}function we(z,X){if(h&&m){let ne=ge(z,X);h[ne]=m()}}function _e(z,X){if(h){let ne=ge(z,X),de=h[ne];if(typeof de=="number")return de}return null}function je(z,X,ne){if(l)if(z){if(Object.keys(z[0].params).length>0)return{active:!0,matches:Zu(X,ne,s,!0)}}else return{active:!0,matches:Zu(X,ne,s,!0)||[]};return{active:!1,matches:null}}async function Le(z,X,ne){if(!l)return{type:"success",matches:z};let de=z;for(;;){let Se=i==null,Pe=i||a,Ie=o;try{await l({path:X,matches:de,patch:(be,De)=>{ne.aborted||YS(be,De,Pe,Ie,r)}})}catch(be){return{type:"error",error:be,partialMatches:de}}finally{Se&&!ne.aborted&&(a=[...a])}if(ne.aborted)return{type:"aborted"};let Ce=Wo(Pe,X,s);if(Ce)return{type:"success",matches:Ce};let Ne=Zu(Pe,X,s,!0);if(!Ne||de.length===Ne.length&&de.every((be,De)=>be.route.id===Ne[De].route.id))return{type:"success",matches:null};de=Ne}}function dt(z){o={},i=Gu(z,r,void 0,o)}function Ct(z,X){let ne=i==null;YS(z,X,i||a,o,r),ne&&(a=[...a],W({}))}return w={get basename(){return s},get future(){return u},get state(){return j},get routes(){return a},get window(){return t},initialize:re,subscribe:Y,enableScrollRestoration:Be,navigate:te,fetch:Ye,revalidate:$,createHref:z=>e.history.createHref(z),encodeLocation:z=>e.history.encodeLocation(z),getFetcher:bn,deleteFetcher:li,dispose:Z,getBlocker:ie,deleteBlocker:pe,patchRoutes:Ct,_internalFetchControllers:M,_internalSetRoutes:dt},w}function Hz(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function ry(e,t,n,r,o,a){let i,s;if(o){i=[];for(let l of t)if(i.push(l),l.route.id===o){s=l;break}}else i=t,s=t[t.length-1];let c=nd(r||".",td(i),or(e.pathname,n)||e.pathname,a==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=iy(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(h=>h).forEach(h=>u.append("index",h));let f=u.toString();c.search=f?`?${f}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:Mr([n,c.pathname])),to(c)}function US(e,t,n){if(!n||!Hz(n))return{path:t};if(n.formMethod&&!n7(n.formMethod))return{path:t,error:Un(405,{method:n.formMethod})};let r=()=>({path:t,error:Un(400,{type:"invalid-body"})}),o=(n.formMethod||"get").toUpperCase(),a=tC(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!ar(o))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[f,h])=>`${d}${f}=${h}
`,""):String(n.body);return{path:t,submission:{formMethod:o,formAction:a,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!ar(o))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:o,formAction:a,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}$e(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=ay(n.formData),s=n.formData;else if(n.body instanceof FormData)i=ay(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=QS(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=QS(i)}catch{return r()}let c={formMethod:o,formAction:a,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(ar(c.formMethod))return{path:t,submission:c};let l=no(t);return e&&l.search&&iy(l.search)&&i.append("index",""),l.search=`?${i}`,{path:to(l),submission:c}}function HS(e,t,n=!1){let r=e.findIndex(o=>o.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function WS(e,t,n,r,o,a,i,s,c,l,u,d,f,h){let y=h?An(h[1])?h[1].error:h[1].data:void 0,m=e.createURL(t.location),v=e.createURL(o),b=n;a&&t.errors?b=HS(n,Object.keys(t.errors)[0],!0):h&&An(h[1])&&(b=HS(n,h[0]));let x=h?h[1].statusCode:void 0,_=x&&x>=400,w=b.filter((E,S)=>{let{route:O}=E;if(O.lazy)return!0;if(O.loader==null)return!1;if(a)return oy(O,t.loaderData,t.errors);if(Wz(t.loaderData,t.matches[S],E))return!0;let k=t.matches[S],N=E;return qS(E,{currentUrl:m,currentParams:k.params,nextUrl:v,nextParams:N.params,...r,actionResult:y,actionStatus:x,defaultShouldRevalidate:_?!1:i||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||qz(k,N)})}),j=[];return l.forEach((E,S)=>{if(a||!n.some(R=>R.route.id===E.routeId)||c.has(S))return;let O=Wo(d,E.path,f);if(!O){j.push({key:S,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let k=t.fetchers.get(S),N=yc(O,E.path),P=!1;u.has(S)?P=!1:s.has(S)?(s.delete(S),P=!0):k&&k.state!=="idle"&&k.data===void 0?P=i:P=qS(N,{currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:y,actionStatus:x,defaultShouldRevalidate:_?!1:i}),P&&j.push({key:S,routeId:E.routeId,path:E.path,matches:O,match:N,controller:new AbortController})}),[w,j]}function oy(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,o=n!=null&&n[e.id]!==void 0;return!r&&o?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!o}function Wz(e,t,n){let r=!t||n.route.id!==t.route.id,o=!e.hasOwnProperty(n.route.id);return r||o}function qz(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function qS(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function YS(e,t,n,r,o){let a;if(e){let c=r[e];$e(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),a=c.children}else a=n;let i=t.filter(c=>!a.some(l=>KS(c,l))),s=Gu(i,o,[e||"_","patch",String((a==null?void 0:a.length)||"0")],r);a.push(...s)}function KS(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var o;return(o=t.children)==null?void 0:o.some(a=>KS(n,a))}):!1}async function Yz(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let o=n[e.id];$e(o,"No route found in manifest");let a={};for(let i in r){let s=o[i]!==void 0&&i!=="hasErrorBoundary";$t(!s,`Route "${o.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!gz.has(i)&&(a[i]=r[i])}Object.assign(o,a),Object.assign(o,{...t(o),lazy:void 0})}async function Kz({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,o)=>Object.assign(n,{[t[o].route.id]:r}),{})}async function Xz(e,t,n,r,o,a,i,s,c,l){let u=a.map(h=>h.route.lazy?Yz(h.route,c,s):void 0),d=a.map((h,y)=>{let m=u[y],v=o.some(b=>b.route.id===h.route.id);return{...h,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(h.route.lazy||h.route.loader)&&(v=!0),v?Qz(t,r,h,m,b,l):Promise.resolve({type:"data",result:void 0}))}}),f=await e({matches:d,request:r,params:a[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return f}async function Qz(e,t,n,r,o,a){let i,s,c=l=>{let u,d=new Promise((y,m)=>u=m);s=()=>u(),t.signal.addEventListener("abort",s);let f=y=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:a},...y!==void 0?[y]:[]),h=(async()=>{try{return{type:"data",result:await(o?o(y=>f(y)):f())}}catch(y){return{type:"error",result:y}}})();return Promise.race([h,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw Un(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw Un(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function Jz(e){var r,o,a,i;let{result:t,type:n}=e;if(rC(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new rd(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(nC(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new rd(((o=t.init)==null?void 0:o.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:od(t)?t.status:void 0}}return nC(t)?{type:"data",data:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function Gz(e,t,n,r,o){let a=e.headers.get("Location");if($e(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!ny.test(a)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);a=ry(new URL(t.url),i,o,a),e.headers.set("Location",a)}return e}function XS(e,t,n){if(ny.test(e)){let r=e,o=r.startsWith("//")?new URL(t.protocol+r):new URL(r),a=or(o.pathname,n)!=null;if(o.origin===t.origin&&a)return o.pathname+o.search+o.hash}return e}function wi(e,t,n,r){let o=e.createURL(tC(t)).toString(),a={signal:n};if(r&&ar(r.formMethod)){let{formMethod:i,formEncType:s}=r;a.method=i.toUpperCase(),s==="application/json"?(a.headers=new Headers({"Content-Type":s}),a.body=JSON.stringify(r.json)):s==="text/plain"?a.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?a.body=ay(r.formData):a.body=r.formData}return new Request(o,a)}function ay(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function QS(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function Zz(e,t,n,r=!1,o=!1){let a={},i=null,s,c=!1,l={},u=n&&An(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,h=t[f];if($e(!Sa(h),"Cannot handle redirect results in processLoaderData"),An(h)){let y=h.error;if(u!==void 0&&(y=u,u=void 0),i=i||{},o)i[f]=y;else{let m=Ea(e,f);i[m.route.id]==null&&(i[m.route.id]=y)}r||(a[f]=zS),c||(c=!0,s=od(h.error)?h.error.status:500),h.headers&&(l[f]=h.headers)}else a[f]=h.data,h.statusCode&&h.statusCode!==200&&!c&&(s=h.statusCode),h.headers&&(l[f]=h.headers)}),u!==void 0&&n&&(i={[n[0]]:u},a[n[0]]=void 0),{loaderData:a,errors:i,statusCode:s||200,loaderHeaders:l}}function JS(e,t,n,r,o,a){let{loaderData:i,errors:s}=Zz(t,n,r);return o.forEach(c=>{let{key:l,match:u,controller:d}=c,f=a[l];if($e(f,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(An(f)){let h=Ea(e.matches,u==null?void 0:u.route.id);s&&s[h.route.id]||(s={...s,[h.route.id]:f.error}),e.fetchers.delete(l)}else if(Sa(f))$e(!1,"Unhandled fetcher revalidation redirect");else{let h=qo(f.data);e.fetchers.set(l,h)}}),{loaderData:i,errors:s}}function GS(e,t,n,r){let o=Object.entries(t).filter(([,a])=>a!==zS).reduce((a,[i,s])=>(a[i]=s,a),{});for(let a of n){let i=a.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&a.route.loader&&(o[i]=e[i]),r&&r.hasOwnProperty(i))break}return o}function ZS(e){return e?An(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ea(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function eC(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Un(e,{pathname:t,routeId:n,method:r,type:o,message:a}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:o==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new rd(e||500,i,new Error(s),!0)}function ad(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,o]=t[n];if(Sa(o))return{key:r,result:o}}}function tC(e){let t=typeof e=="string"?no(e):e;return to({...t,hash:""})}function e7(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function t7(e){return rC(e.result)&&$z.has(e.result.status)}function An(e){return e.type==="error"}function Sa(e){return(e&&e.type)==="redirect"}function nC(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function rC(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function n7(e){return Bz.has(e.toUpperCase())}function ar(e){return Lz.has(e.toUpperCase())}function iy(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function yc(e,t){let n=typeof t=="string"?no(t).search:t.search;if(e[e.length-1].route.index&&iy(n||""))return e[e.length-1];let r=FS(e);return r[r.length-1]}function oC(e){let{formMethod:t,formAction:n,formEncType:r,text:o,formData:a,json:i}=e;if(!(!t||!n||!r)){if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:o};if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function sy(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function r7(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function gc(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function o7(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function qo(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function a7(e,t){try{let n=e.sessionStorage.getItem($S);if(n){let r=JSON.parse(n);for(let[o,a]of Object.entries(r||{}))a&&Array.isArray(a)&&t.set(o,new Set(a||[]))}}catch{}}function i7(e,t){if(t.size>0){let n={};for(let[r,o]of t)n[r]=[...o];try{e.sessionStorage.setItem($S,JSON.stringify(n))}catch(r){$t(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function s7(){let e,t,n=new Promise((r,o)=>{e=async a=>{r(a);try{await n}catch{}},t=async a=>{o(a);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Ca=g.createContext(null);Ca.displayName="DataRouter";var vc=g.createContext(null);vc.displayName="DataRouterState";var cy=g.createContext({isTransitioning:!1});cy.displayName="ViewTransition";var aC=g.createContext(new Map);aC.displayName="Fetchers";var c7=g.createContext(null);c7.displayName="Await";var ir=g.createContext(null);ir.displayName="Navigation";var id=g.createContext(null);id.displayName="Location";var Hn=g.createContext({outlet:null,matches:[],isDataRoute:!1});Hn.displayName="Route";var ly=g.createContext(null);ly.displayName="RouteError";function l7(e,{relative:t}={}){$e(_i(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(ir),{hash:o,pathname:a,search:i}=bc(e,{relative:t}),s=a;return n!=="/"&&(s=a==="/"?n:Mr([n,a])),r.createHref({pathname:s,search:i,hash:o})}function _i(){return g.useContext(id)!=null}function kr(){return $e(_i(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(id).location}var iC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sC(e){g.useContext(ir).static||g.useLayoutEffect(e)}function ji(){let{isDataRoute:e}=g.useContext(Hn);return e?E7():u7()}function u7(){$e(_i(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Ca),{basename:t,navigator:n}=g.useContext(ir),{matches:r}=g.useContext(Hn),{pathname:o}=kr(),a=JSON.stringify(td(r)),i=g.useRef(!1);return sC(()=>{i.current=!0}),g.useCallback((s,c={})=>{if($t(i.current,iC),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=nd(s,JSON.parse(a),o,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:Mr([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,a,o,e])}var d7=g.createContext(null);function f7(e){let t=g.useContext(Hn).outlet;return t&&g.createElement(d7.Provider,{value:e},t)}function p7(){let{matches:e}=g.useContext(Hn),t=e[e.length-1];return t?t.params:{}}function bc(e,{relative:t}={}){let{matches:n}=g.useContext(Hn),{pathname:r}=kr(),o=JSON.stringify(td(n));return g.useMemo(()=>nd(e,JSON.parse(o),r,t==="path"),[e,o,r,t])}function h7(e,t,n,r){$e(_i(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=g.useContext(ir),{matches:a}=g.useContext(Hn),i=a[a.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";uC(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=kr(),f;f=d;let h=f.pathname||"/",y=h;if(l!=="/"){let v=l.replace(/^\//,"").split("/");y="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=Wo(e,{pathname:y});return $t(u||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),$t(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),b7(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:Mr([l,o.encodeLocation?o.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Mr([l,o.encodeLocation?o.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,n,r)}function m7(){let e=cC(),t=od(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:a},"ErrorBoundary")," or"," ",g.createElement("code",{style:a},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:o},n):null,i)}var y7=g.createElement(m7,null),g7=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(Hn.Provider,{value:this.props.routeContext},g.createElement(ly.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function v7({routeContext:e,match:t,children:n}){let r=g.useContext(Ca);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(Hn.Provider,{value:e},n)}function b7(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,a=n==null?void 0:n.errors;if(a!=null){let c=o.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id])!==void 0);$e(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),o=o.slice(0,Math.min(o.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<o.length;c++){let l=o[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,f=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){i=!0,s>=0?o=o.slice(0,s+1):o=[o[0]];break}}}return o.reduceRight((c,l,u)=>{let d,f=!1,h=null,y=null;n&&(d=a&&l.route.id?a[l.route.id]:void 0,h=l.route.errorElement||y7,i&&(s<0&&u===0?(uC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,y=null):s===u&&(f=!0,y=l.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,u+1)),v=()=>{let b;return d?b=h:f?b=y:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(v7,{match:l,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(g7,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}function uy(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function x7(e){let t=g.useContext(Ca);return $e(t,uy(e)),t}function w7(e){let t=g.useContext(vc);return $e(t,uy(e)),t}function _7(e){let t=g.useContext(Hn);return $e(t,uy(e)),t}function dy(e){let t=_7(e),n=t.matches[t.matches.length-1];return $e(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function j7(){return dy("useRouteId")}function cC(){var r;let e=g.useContext(ly),t=w7("useRouteError"),n=dy("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function E7(){let{router:e}=x7("useNavigate"),t=dy("useNavigate"),n=g.useRef(!1);return sC(()=>{n.current=!0}),g.useCallback(async(r,o={})=>{$t(n.current,iC),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...o}))},[e,t])}var lC={};function uC(e,t,n){!t&&!lC[e]&&(lC[e]=!0,$t(!1,n))}var dC={};function fC(e,t){!e&&!dC[t]&&(dC[t]=!0,console.warn(t))}function pC(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&$t(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&$t(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&$t(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var S7=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function C7({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[o,a]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[f,h]=g.useState(),y=g.useRef(new Map),m=g.useCallback((_,{deletedFetchers:w,flushSync:j,viewTransitionOpts:E})=>{w.forEach(O=>y.current.delete(O)),_.fetchers.forEach((O,k)=>{O.data!==void 0&&y.current.set(k,O.data)}),fC(j===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let S=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(fC(E==null||S,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!E||!S){t&&j?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&j){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:E.currentLocation,nextLocation:E.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),a(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),h({state:_,currentLocation:E.currentLocation,nextLocation:E.nextLocation})):(a(_),s({isTransitioning:!0,flushSync:!1,currentLocation:E.currentLocation,nextLocation:E.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(m),[e,m]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new S7)},[i]),g.useEffect(()=>{if(c&&o&&e.window){let _=o,w=c.promise,j=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await w});j.finished.finally(()=>{l(void 0),d(void 0),a(void 0),s({isTransitioning:!1})}),d(j)}},[o,c,e.window]),g.useEffect(()=>{c&&o&&n.location.key===o.location.key&&c.resolve()},[c,u,n.location,o]),g.useEffect(()=>{!i.isTransitioning&&f&&(a(f.state),s({isTransitioning:!0,flushSync:!1,currentLocation:f.currentLocation,nextLocation:f.nextLocation}),h(void 0))},[i.isTransitioning,f]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,w,j)=>e.navigate(_,{state:w,preventScrollReset:j==null?void 0:j.preventScrollReset}),replace:(_,w,j)=>e.navigate(_,{replace:!0,state:w,preventScrollReset:j==null?void 0:j.preventScrollReset})}),[e]),b=e.basename||"/",x=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Ca.Provider,{value:x},g.createElement(vc.Provider,{value:n},g.createElement(aC.Provider,{value:y.current},g.createElement(cy.Provider,{value:i},g.createElement(P7,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(O7,{routes:e.routes,future:e.future,state:n})))))),null)}var O7=g.memo(N7);function N7({routes:e,future:t,state:n}){return h7(e,void 0,n,t)}function M7({to:e,replace:t,state:n,relative:r}){$e(_i(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=g.useContext(ir);$t(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=g.useContext(Hn),{pathname:i}=kr(),s=ji(),c=nd(e,td(a),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function k7(e){return f7(e.context)}function xc(e){$e(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function P7({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:o,static:a=!1}){$e(!_i(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:o,static:a,future:{}}),[i,o,a]);typeof n=="string"&&(n=no(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:f="default"}=n,h=g.useMemo(()=>{let y=or(c,i);return y==null?null:{location:{pathname:y,search:l,hash:u,state:d,key:f},navigationType:r}},[i,c,l,u,d,f,r]);return $t(h!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(ir.Provider,{value:s},g.createElement(id.Provider,{children:t,value:h}))}function fy(e,t=[]){let n=[];return g.Children.forEach(e,(r,o)=>{if(!g.isValidElement(r))return;let a=[...t,o];if(r.type===g.Fragment){n.push.apply(n,fy(r.props.children,a));return}$e(r.type===xc,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),$e(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=fy(r.props.children,a)),n.push(i)}),n}var A7=fy,sd="get",cd="application/x-www-form-urlencoded";function ld(e){return e!=null&&typeof e.tagName=="string"}function T7(e){return ld(e)&&e.tagName.toLowerCase()==="button"}function R7(e){return ld(e)&&e.tagName.toLowerCase()==="form"}function I7(e){return ld(e)&&e.tagName.toLowerCase()==="input"}function D7(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function L7(e,t){return e.button===0&&(!t||t==="_self")&&!D7(e)}var ud=null;function F7(){if(ud===null)try{new FormData(document.createElement("form"),0),ud=!1}catch{ud=!0}return ud}var B7=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function py(e){return e!=null&&!B7.has(e)?($t(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cd}"`),null):e}function $7(e,t){let n,r,o,a,i;if(R7(e)){let s=e.getAttribute("action");r=s?or(s,t):null,n=e.getAttribute("method")||sd,o=py(e.getAttribute("enctype"))||cd,a=new FormData(e)}else if(T7(e)||I7(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?or(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||sd,o=py(e.getAttribute("formenctype"))||py(s.getAttribute("enctype"))||cd,a=new FormData(s,e),!F7()){let{name:l,type:u,value:d}=e;if(u==="image"){let f=l?`${l}.`:"";a.append(`${f}x`,"0"),a.append(`${f}y`,"0")}else l&&a.append(l,d)}}else{if(ld(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=sd,r=null,o=cd,i=e}return a&&o==="text/plain"&&(i=a,a=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:a,body:i}}function hy(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function z7(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function V7(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function U7(e,t,n){let r=await Promise.all(e.map(async o=>{let a=t.routes[o.route.id];if(a){let i=await z7(a,n);return i.links?i.links():[]}return[]}));return Y7(r.flat(1).filter(V7).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function hC(e,t,n,r,o,a){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):a==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function H7(e,t){return W7(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let o=[r.module];return r.imports&&(o=o.concat(r.imports)),o}).flat(1))}function W7(e){return[...new Set(e)]}function q7(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function Y7(e,t){let n=new Set;return new Set(t),e.reduce((r,o)=>{let a=JSON.stringify(q7(o));return n.has(a)||(n.add(a),r.push({key:a,link:o})),r},[])}function K7(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function X7(){let e=g.useContext(Ca);return hy(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Q7(){let e=g.useContext(vc);return hy(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var my=g.createContext(void 0);my.displayName="FrameworkContext";function mC(){let e=g.useContext(my);return hy(e,"You must render this element inside a <HydratedRouter> element"),e}function J7(e,t){let n=g.useContext(my),[r,o]=g.useState(!1),[a,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=b=>{b.forEach(x=>{i(x.isIntersecting)})},v=new IntersectionObserver(m,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[r]);let h=()=>{o(!0)},y=()=>{o(!1),i(!1)};return n?e!=="intent"?[a,f,{}]:[a,f,{onFocus:wc(s,h),onBlur:wc(c,y),onMouseEnter:wc(l,h),onMouseLeave:wc(u,y),onTouchStart:wc(d,h)}]:[!1,f,{}]}function wc(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function G7({page:e,...t}){let{router:n}=X7(),r=g.useMemo(()=>Wo(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(eV,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function Z7(e){let{manifest:t,routeModules:n}=mC(),[r,o]=g.useState([]);return g.useEffect(()=>{let a=!1;return U7(e,t,n).then(i=>{a||o(i)}),()=>{a=!0}},[e,t,n]),r}function eV({page:e,matches:t,...n}){let r=kr(),{manifest:o,routeModules:a}=mC(),{loaderData:i,matches:s}=Q7(),c=g.useMemo(()=>hC(e,t,s,o,r,"data"),[e,t,s,o,r]),l=g.useMemo(()=>hC(e,t,s,o,r,"assets"),[e,t,s,o,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let h=new Set,y=!1;if(t.forEach(v=>{var x;let b=o.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((x=a[v.route.id])!=null&&x.shouldRevalidate)||b.hasClientLoader?y=!0:h.add(v.route.id))}),h.size===0)return[];let m=K7(e);return y&&h.size>0&&m.searchParams.set("_routes",t.filter(v=>h.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[i,r,o,c,t,e,a]),d=g.useMemo(()=>H7(l,o),[l,o]),f=Z7(l);return g.createElement(g.Fragment,null,u.map(h=>g.createElement("link",{key:h,rel:"prefetch",as:"fetch",href:h,...n})),d.map(h=>g.createElement("link",{key:h,rel:"modulepreload",href:h,...n})),f.map(({key:h,link:y})=>g.createElement("link",{key:h,...y})))}function tV(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var yC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yC&&(window.__reactRouterVersion="7.0.2")}catch{}function gC(e,t){return VS({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:hz({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||vC(),routes:e,mapRouteProperties:pC,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function nV(e,t){return VS({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:mz({window:t==null?void 0:t.window}),hydrationData:vC(),routes:e,mapRouteProperties:pC,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function vC(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:rV(e.errors)}),e}function rV(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,o]of t)if(o&&o.__type==="RouteErrorResponse")n[r]=new rd(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){if(o.__subType){let a=window[o.__subType];if(typeof a=="function")try{let i=new a(o.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let a=new Error(o.message);a.stack="",n[r]=a}}else n[r]=o;return n}var bC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xC=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:o,replace:a,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:h}=g.useContext(ir),y=typeof c=="string"&&bC.test(c),m,v=!1;if(typeof c=="string"&&y&&(m=c,yC))try{let O=new URL(window.location.href),k=c.startsWith("//")?new URL(O.protocol+c):new URL(c),N=or(k.pathname,h);k.origin===O.origin&&N!=null?c=N+k.search+k.hash:v=!0}catch{$t(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=l7(c,{relative:r}),[x,_,w]=J7(n,d),j=sV(c,{replace:a,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function E(O){e&&e(O),O.defaultPrevented||j(O)}let S=g.createElement("a",{...d,...w,href:m||b,onClick:v||o?e:E,ref:tV(f,_),target:s,"data-discover":!y&&t==="render"?"true":void 0});return x&&!y?g.createElement(g.Fragment,null,S,g.createElement(G7,{page:b})):S});xC.displayName="Link";var oV=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:o,to:a,viewTransition:i,children:s,...c},l){let u=bc(a,{relative:c.relative}),d=kr(),f=g.useContext(vc),{navigator:h,basename:y}=g.useContext(ir),m=f!=null&&fV(u)&&i===!0,v=h.encodeLocation?h.encodeLocation(u).pathname:u.pathname,b=d.pathname,x=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),x=x?x.toLowerCase():null,v=v.toLowerCase()),x&&y&&(x=or(x,y)||x);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let w=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",j=x!=null&&(x===v||!r&&x.startsWith(v)&&x.charAt(v.length)==="/"),E={isActive:w,isPending:j,isTransitioning:m},S=w?e:void 0,O;typeof n=="function"?O=n(E):O=[n,w?"active":null,j?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let k=typeof o=="function"?o(E):o;return g.createElement(xC,{...c,"aria-current":S,className:O,ref:l,style:k,to:a,viewTransition:i},typeof s=="function"?s(E):s)});oV.displayName="NavLink";var aV=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:o,state:a,method:i=sd,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},h)=>{let y=uV(),m=dV(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&bC.test(s),x=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let w=_.nativeEvent.submitter,j=(w==null?void 0:w.getAttribute("formmethod"))||i;y(w||_.currentTarget,{fetcherKey:t,method:j,navigate:n,replace:o,state:a,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:h,method:v,action:m,onSubmit:r?c:x,...f,"data-discover":!b&&e==="render"?"true":void 0})});aV.displayName="Form";function iV(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wC(e){let t=g.useContext(Ca);return $e(t,iV(e)),t}function sV(e,{target:t,replace:n,state:r,preventScrollReset:o,relative:a,viewTransition:i}={}){let s=ji(),c=kr(),l=bc(e,{relative:a});return g.useCallback(u=>{if(L7(u,t)){u.preventDefault();let d=n!==void 0?n:to(c)===to(l);s(e,{replace:d,state:r,preventScrollReset:o,relative:a,viewTransition:i})}},[c,s,l,n,r,t,e,o,a,i])}var cV=0,lV=()=>`__${String(++cV)}__`;function uV(){let{router:e}=wC("useSubmit"),{basename:t}=g.useContext(ir),n=j7();return g.useCallback(async(r,o={})=>{let{action:a,method:i,encType:s,formData:c,body:l}=$7(r,t);if(o.navigate===!1){let u=o.fetcherKey||lV();await e.fetch(u,n,o.action||a,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||i,formEncType:o.encType||s,flushSync:o.flushSync})}else await e.navigate(o.action||a,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||i,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[e,t,n])}function dV(e,{relative:t}={}){let{basename:n}=g.useContext(ir),r=g.useContext(Hn);$e(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),a={...bc(e||".",{relative:t})},i=kr();if(e==null){a.search=i.search;let s=new URLSearchParams(a.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();a.search=l?`?${l}`:""}}return(!e||e===".")&&o.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Mr([n,a.pathname])),to(a)}function fV(e,t={}){let n=g.useContext(cy);$e(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=wC("useViewTransitionState"),o=bc(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=or(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=or(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ed(o.pathname,i)!=null||ed(o.pathname,a)!=null}new TextEncoder;function pV(e){return g.createElement(C7,{flushSync:Du.flushSync,...e})}var hV=Swe.useId||(()=>{}),mV=0;mt=function(e){const[t,n]=g.useState(hV());return xn(()=>{e||n(r=>r??String(mV++))},[e]),e||(t?`radix-${t}`:"")};var yy="Collapsible",[yV,_C]=Vn(yy),[gV,gy]=yV(yy),jC=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:o,disabled:a,onOpenChange:i,...s}=e,[c=!1,l]=en({prop:r,defaultProp:o,onChange:i});return p.jsx(gV,{scope:n,disabled:a,contentId:mt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:p.jsx(Oe.div,{"data-state":wy(c),"data-disabled":a?"":void 0,...s,ref:t})})});jC.displayName=yy;var EC="CollapsibleTrigger",vy=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,o=gy(EC,n);return p.jsx(Oe.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":wy(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...r,ref:t,onClick:he(e.onClick,o.onOpenToggle)})});vy.displayName=EC;var by="CollapsibleContent",xy=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,o=gy(by,e.__scopeCollapsible);return p.jsx(Mn,{present:n||o.open,children:({present:a})=>p.jsx(vV,{...r,ref:t,present:a})})});xy.displayName=by;var vV=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:o,...a}=e,i=gy(by,n),[s,c]=g.useState(r),l=g.useRef(null),u=rt(t,l),d=g.useRef(0),f=d.current,h=g.useRef(0),y=h.current,m=i.open||s,v=g.useRef(m),b=g.useRef();return g.useEffect(()=>{const x=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(x)},[]),xn(()=>{const x=l.current;if(x){b.current=b.current||{transitionDuration:x.style.transitionDuration,animationName:x.style.animationName},x.style.transitionDuration="0s",x.style.animationName="none";const _=x.getBoundingClientRect();d.current=_.height,h.current=_.width,v.current||(x.style.transitionDuration=b.current.transitionDuration,x.style.animationName=b.current.animationName),c(r)}},[i.open,r]),p.jsx(Oe.div,{"data-state":wy(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...a,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:m&&o})});function wy(e){return e?"open":"closed"}var SC=jC,bV=vy,xV=xy;const wV=SC,_V=vy,jV=xy,_y=768;function EV(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${_y-1}px)`),r=()=>{t(window.innerWidth<_y)};return n.addEventListener("change",r),t(window.innerWidth<_y),()=>n.removeEventListener("change",r)},[]),!!e}let _c;_c=Jr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),at=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},a)=>{const i=r?Gr:"button";return p.jsx(i,{className:K(_c({variant:t,size:n,className:e})),ref:a,...o})}),at.displayName="Button";const dn=g.forwardRef(({className:e,type:t,...n},r)=>p.jsx("input",{type:t,className:K("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));dn.displayName="Input";var SV="Separator",CC="horizontal",CV=["horizontal","vertical"],OC=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=CC,...o}=e,a=OV(r)?r:CC,i=n?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return p.jsx(Oe.div,{"data-orientation":a,...i,...o,ref:t})});OC.displayName=SV;function OV(e){return CV.includes(e)}tm=OC;const jc=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},o)=>p.jsx(tm,{ref:o,decorative:n,orientation:t,className:K("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));jc.displayName=tm.displayName;var jy="focusScope.autoFocusOnMount",Ey="focusScope.autoFocusOnUnmount",NC={bubbles:!1,cancelable:!0},NV="FocusScope",Ec=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:a,...i}=e,[s,c]=g.useState(null),l=Vo(o),u=Vo(a),d=g.useRef(null),f=rt(t,m=>c(m)),h=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(h.paused||!s)return;const w=_.target;s.contains(w)?d.current=w:Yo(d.current,{select:!0})},v=function(_){if(h.paused||!s)return;const w=_.relatedTarget;w!==null&&(s.contains(w)||Yo(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const w of _)w.removedNodes.length>0&&Yo(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const x=new MutationObserver(b);return s&&x.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),x.disconnect()}}},[r,s,h.paused]),g.useEffect(()=>{if(s){PC.add(h);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(jy,NC);s.addEventListener(jy,l),s.dispatchEvent(v),v.defaultPrevented||(MV(RV(MC(s)),{select:!0}),document.activeElement===m&&Yo(s))}return()=>{s.removeEventListener(jy,l),setTimeout(()=>{const v=new CustomEvent(Ey,NC);s.addEventListener(Ey,u),s.dispatchEvent(v),v.defaultPrevented||Yo(m??document.body,{select:!0}),s.removeEventListener(Ey,u),PC.remove(h)},0)}}},[s,l,u,h]);const y=g.useCallback(m=>{if(!n&&!r||h.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const x=m.currentTarget,[_,w]=kV(x);_&&w?!m.shiftKey&&b===w?(m.preventDefault(),n&&Yo(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&Yo(w,{select:!0})):b===x&&m.preventDefault()}},[n,r,h.paused]);return p.jsx(Oe.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});Ec.displayName=NV;function MV(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Yo(r,{select:t}),document.activeElement!==n)return}function kV(e){const t=MC(e),n=kC(t,e),r=kC(t.reverse(),e);return[n,r]}function MC(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function kC(e,t){for(const n of e)if(!PV(n,{upTo:t}))return n}function PV(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function AV(e){return e instanceof HTMLInputElement&&"select"in e}function Yo(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&AV(e)&&t&&e.select()}}var PC=TV();function TV(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=AC(e,t),e.unshift(t)},remove(t){var n;e=AC(e,t),(n=e[0])==null||n.resume()}}}function AC(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function RV(e){return e.filter(t=>t.tagName!=="A")}var Sy=0;function dd(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??TC()),document.body.insertAdjacentElement("beforeend",e[1]??TC()),Sy++,()=>{Sy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Sy--}},[])}function TC(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Pr=function(){return Pr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Pr.apply(this,arguments)};function RC(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function IV(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,a;r<o;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var fd="right-scroll-bar-position",pd="width-before-scroll-bar",DV="with-scroll-bars-hidden",LV="--removed-body-scroll-bar-size";function Cy(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function FV(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var BV=typeof window<"u"?g.useLayoutEffect:g.useEffect,IC=new WeakMap;function $V(e,t){var n=FV(null,function(r){return e.forEach(function(o){return Cy(o,r)})});return BV(function(){var r=IC.get(n);if(r){var o=new Set(r),a=new Set(e),i=n.current;o.forEach(function(s){a.has(s)||Cy(s,null)}),a.forEach(function(s){o.has(s)||Cy(s,i)})}IC.set(n,e)},[e]),n}function zV(e){return e}function VV(e,t){t===void 0&&(t=zV);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var i=t(a,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(a){for(r=!0;n.length;){var i=n;n=[],i.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(a),i=n}var c=function(){var u=i;i=[],u.forEach(a)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return o}function UV(e){e===void 0&&(e={});var t=VV(null);return t.options=Pr({async:!0,ssr:!1},e),t}var DC=function(e){var t=e.sideCar,n=RC(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Pr({},n))};DC.isSideCarExport=!0;function HV(e,t){return e.useMedium(t),DC}var LC=UV(),Oy=function(){},hd=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:Oy,onWheelCapture:Oy,onTouchMoveCapture:Oy}),o=r[0],a=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,h=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,x=e.gapMode,_=RC(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,j=$V([n,t]),E=Pr(Pr({},_),o);return g.createElement(g.Fragment,null,u&&g.createElement(w,{sideCar:LC,removeScrollBar:l,shards:d,noIsolation:h,inert:y,setCallbacks:a,allowPinchZoom:!!m,lockRef:n,gapMode:x}),i?g.cloneElement(g.Children.only(s),Pr(Pr({},E),{ref:j})):g.createElement(b,Pr({},E,{className:c,ref:j}),s))});hd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},hd.classNames={fullWidth:pd,zeroRight:fd};var WV=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function qV(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=WV();return t&&e.setAttribute("nonce",t),e}function YV(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function KV(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var XV=function(){var e=0,t=null;return{add:function(n){e==0&&(t=qV())&&(YV(t,n),KV(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},QV=function(){var e=XV();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},FC=function(){var e=QV(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},JV={left:0,top:0,right:0,gap:0},Ny=function(e){return parseInt(e||"",10)||0},GV=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Ny(n),Ny(r),Ny(o)]},ZV=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return JV;var t=GV(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},eU=FC(),Ei="data-scroll-locked",tU=function(e,t,n,r){var o=e.left,a=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(DV,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Ei,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(fd,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(pd,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(fd," .").concat(fd,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(pd," .").concat(pd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ei,`] {
    `).concat(LV,": ").concat(s,`px;
  }
`)},BC=function(){var e=parseInt(document.body.getAttribute(Ei)||"0",10);return isFinite(e)?e:0},nU=function(){g.useEffect(function(){return document.body.setAttribute(Ei,(BC()+1).toString()),function(){var e=BC()-1;e<=0?document.body.removeAttribute(Ei):document.body.setAttribute(Ei,e.toString())}},[])},rU=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;nU();var a=g.useMemo(function(){return ZV(o)},[o]);return g.createElement(eU,{styles:tU(a,!t,o,n?"":"!important")})},My=!1;if(typeof window<"u")try{var md=Object.defineProperty({},"passive",{get:function(){return My=!0,!0}});window.addEventListener("test",md,md),window.removeEventListener("test",md,md)}catch{My=!1}var Si=My?{passive:!1}:!1,oU=function(e){return e.tagName==="TEXTAREA"},$C=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!oU(e)&&n[t]==="visible")},aU=function(e){return $C(e,"overflowY")},iU=function(e){return $C(e,"overflowX")},zC=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=VC(e,r);if(o){var a=UC(e,r),i=a[1],s=a[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},sU=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},cU=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},VC=function(e,t){return e==="v"?aU(t):iU(t)},UC=function(e,t){return e==="v"?sU(t):cU(t)},lU=function(e,t){return e==="h"&&t==="rtl"?-1:1},uU=function(e,t,n,r,o){var a=lU(e,window.getComputedStyle(t).direction),i=a*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var h=UC(e,s),y=h[0],m=h[1],v=h[2],b=m-v-a*y;(y||b)&&VC(e,s)&&(d+=b,f+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!o)||!u&&(Math.abs(f)<1||!o))&&(l=!0),l},yd=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},HC=function(e){return[e.deltaX,e.deltaY]},WC=function(e){return e&&"current"in e?e.current:e},dU=function(e,t){return e[0]===t[0]&&e[1]===t[1]},fU=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},pU=0,Ci=[];function hU(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),o=g.useState(pU++)[0],a=g.useState(FC)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var m=IV([e.lockRef.current],(e.shards||[]).map(WC),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=yd(m),x=n.current,_="deltaX"in m?m.deltaX:x[0]-b[0],w="deltaY"in m?m.deltaY:x[1]-b[1],j,E=m.target,S=Math.abs(_)>Math.abs(w)?"h":"v";if("touches"in m&&S==="h"&&E.type==="range")return!1;var O=zC(S,E);if(!O)return!0;if(O?j=S:(j=S==="v"?"h":"v",O=zC(S,E)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||w)&&(r.current=j),!j)return!0;var k=r.current||j;return uU(k,v,m,k==="h"?_:w,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!Ci.length||Ci[Ci.length-1]!==a)){var b="deltaY"in v?HC(v):yd(v),x=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&dU(j.delta,b)})[0];if(x&&x.should){v.cancelable&&v.preventDefault();return}if(!x){var _=(i.current.shards||[]).map(WC).filter(Boolean).filter(function(j){return j.contains(v.target)}),w=_.length>0?s(v,_[0]):!i.current.noIsolation;w&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,x){var _={name:m,delta:v,target:b,should:x,shadowParent:mU(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(w){return w!==_})},1)},[]),u=g.useCallback(function(m){n.current=yd(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,HC(m),m.target,s(m,e.lockRef.current))},[]),f=g.useCallback(function(m){l(m.type,yd(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return Ci.push(a),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Si),document.addEventListener("touchmove",c,Si),document.addEventListener("touchstart",u,Si),function(){Ci=Ci.filter(function(m){return m!==a}),document.removeEventListener("wheel",c,Si),document.removeEventListener("touchmove",c,Si),document.removeEventListener("touchstart",u,Si)}},[]);var h=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(a,{styles:fU(o)}):null,h?g.createElement(rU,{gapMode:e.gapMode}):null)}function mU(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const yU=HV(LC,hU);var Sc=g.forwardRef(function(e,t){return g.createElement(hd,Pr({},e,{ref:t,sideCar:yU}))});Sc.classNames=hd.classNames;var gU=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Oi=new WeakMap,gd=new WeakMap,vd={},ky=0,qC=function(e){return e&&(e.host||qC(e.parentNode))},vU=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=qC(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},bU=function(e,t,n,r){var o=vU(t,Array.isArray(e)?e:[e]);vd[n]||(vd[n]=new WeakMap);var a=vd[n],i=[],s=new Set,c=new Set(o),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};o.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))u(f);else try{var h=f.getAttribute(r),y=h!==null&&h!=="false",m=(Oi.get(f)||0)+1,v=(a.get(f)||0)+1;Oi.set(f,m),a.set(f,v),i.push(f),m===1&&y&&gd.set(f,!0),v===1&&f.setAttribute(n,"true"),y||f.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),s.clear(),ky++,function(){i.forEach(function(d){var f=Oi.get(d)-1,h=a.get(d)-1;Oi.set(d,f),a.set(d,h),f||(gd.has(d)||d.removeAttribute(r),gd.delete(d)),h||d.removeAttribute(n)}),ky--,ky||(Oi=new WeakMap,Oi=new WeakMap,gd=new WeakMap,vd={})}},bd=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=gU(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),bU(r,o,n,"aria-hidden")):function(){return null}},Py="Dialog",[YC,KC]=Vn(Py),[xU,sr]=YC(Py),XC=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:o,onOpenChange:a,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=en({prop:r,defaultProp:o,onChange:a});return p.jsx(xU,{scope:t,triggerRef:s,contentRef:c,contentId:mt(),titleId:mt(),descriptionId:mt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})};XC.displayName=Py;var QC="DialogTrigger",JC=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=sr(QC,n),a=rt(t,o.triggerRef);return p.jsx(Oe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Ry(o.open),...r,ref:a,onClick:he(e.onClick,o.onOpenToggle)})});JC.displayName=QC;var Ay="DialogPortal",[wU,GC]=YC(Ay,{forceMount:void 0}),ZC=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:o}=e,a=sr(Ay,t);return p.jsx(wU,{scope:t,forceMount:n,children:g.Children.map(r,i=>p.jsx(Mn,{present:n||a.open,children:p.jsx(Fu,{asChild:!0,container:o,children:i})}))})};ZC.displayName=Ay;var xd="DialogOverlay",eO=g.forwardRef((e,t)=>{const n=GC(xd,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,a=sr(xd,e.__scopeDialog);return a.modal?p.jsx(Mn,{present:r||a.open,children:p.jsx(_U,{...o,ref:t})}):null});eO.displayName=xd;var _U=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=sr(xd,n);return p.jsx(Sc,{as:Gr,allowPinchZoom:!0,shards:[o.contentRef],children:p.jsx(Oe.div,{"data-state":Ry(o.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Oa="DialogContent",tO=g.forwardRef((e,t)=>{const n=GC(Oa,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,a=sr(Oa,e.__scopeDialog);return p.jsx(Mn,{present:r||a.open,children:a.modal?p.jsx(jU,{...o,ref:t}):p.jsx(EU,{...o,ref:t})})});tO.displayName=Oa;var jU=g.forwardRef((e,t)=>{const n=sr(Oa,e.__scopeDialog),r=g.useRef(null),o=rt(t,n.contentRef,r);return g.useEffect(()=>{const a=r.current;if(a)return bd(a)},[]),p.jsx(nO,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:he(e.onCloseAutoFocus,a=>{var i;a.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:he(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&a.preventDefault()}),onFocusOutside:he(e.onFocusOutside,a=>a.preventDefault())})}),EU=g.forwardRef((e,t)=>{const n=sr(Oa,e.__scopeDialog),r=g.useRef(!1),o=g.useRef(!1);return p.jsx(nO,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,a),a.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),a.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:a=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=a.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&o.current&&a.preventDefault()}})}),nO=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:a,...i}=e,s=sr(Oa,n),c=g.useRef(null),l=rt(t,c);return dd(),p.jsxs(p.Fragment,{children:[p.jsx(Ec,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:a,children:p.jsx(Lu,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":Ry(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),p.jsxs(p.Fragment,{children:[p.jsx(lO,{titleId:s.titleId}),p.jsx(dO,{contentRef:c,descriptionId:s.descriptionId})]})]})}),Ty="DialogTitle",rO=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=sr(Ty,n);return p.jsx(Oe.h2,{id:o.titleId,...r,ref:t})});rO.displayName=Ty;var oO="DialogDescription",aO=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=sr(oO,n);return p.jsx(Oe.p,{id:o.descriptionId,...r,ref:t})});aO.displayName=oO;var iO="DialogClose",sO=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=sr(iO,n);return p.jsx(Oe.button,{type:"button",...r,ref:t,onClick:he(e.onClick,()=>o.onOpenChange(!1))})});sO.displayName=iO;function Ry(e){return e?"open":"closed"}let Iy,cO,Dy,lO,uO,dO,fO;Iy="DialogTitleWarning",[cO,Dy]=Cwe(Iy,{contentName:Oa,titleName:Ty,docsSlug:"dialog"}),lO=({titleId:e})=>{const t=Dy(Iy),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},uO="DialogDescriptionWarning",dO=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Dy(uO).contentName}}.`;return g.useEffect(()=>{var o;const r=(o=e.current)==null?void 0:o.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},oc=XC,fO=JC,lc=ZC,_a=eO,ja=tO,hi=rO,mi=aO,uc=sO;const SU=oc,CU=lc,pO=g.forwardRef(({className:e,...t},n)=>p.jsx(_a,{className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));pO.displayName=_a.displayName;const OU=Jr("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),hO=g.forwardRef(({side:e="right",className:t,children:n,...r},o)=>p.jsxs(CU,{children:[p.jsx(pO,{}),p.jsxs(ja,{ref:o,className:K(OU({side:e}),t),...r,children:[n,p.jsxs(uc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[p.jsx(le,{name:"x",className:"h-4 w-4"}),p.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));hO.displayName=ja.displayName;const NU=g.forwardRef(({className:e,...t},n)=>p.jsx(hi,{ref:n,className:K("text-lg font-semibold text-foreground",e),...t}));NU.displayName=hi.displayName;const MU=g.forwardRef(({className:e,...t},n)=>p.jsx(mi,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));MU.displayName=mi.displayName;function mO({className:e,...t}){return p.jsx("div",{className:K("animate-pulse rounded-md bg-muted",e),...t})}const kU=["top","right","bottom","left"],Ar=Math.min,Tn=Math.max,wd=Math.round,_d=Math.floor,Ko=e=>({x:e,y:e}),PU={left:"right",right:"left",bottom:"top",top:"bottom"},AU={start:"end",end:"start"};function Ly(e,t,n){return Tn(e,Ar(t,n))}function ro(e,t){return typeof e=="function"?e(t):e}function oo(e){return e.split("-")[0]}function Ni(e){return e.split("-")[1]}function Fy(e){return e==="x"?"y":"x"}function By(e){return e==="y"?"height":"width"}function Xo(e){return["top","bottom"].includes(oo(e))?"y":"x"}function $y(e){return Fy(Xo(e))}function TU(e,t,n){n===void 0&&(n=!1);const r=Ni(e),o=$y(e),a=By(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=jd(i)),[i,jd(i)]}function RU(e){const t=jd(e);return[zy(e),t,zy(t)]}function zy(e){return e.replace(/start|end/g,t=>AU[t])}function IU(e,t,n){const r=["left","right"],o=["right","left"],a=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?a:i;default:return[]}}function DU(e,t,n,r){const o=Ni(e);let a=IU(oo(e),n==="start",r);return o&&(a=a.map(i=>i+"-"+o),t&&(a=a.concat(a.map(zy)))),a}function jd(e){return e.replace(/left|right|bottom|top/g,t=>PU[t])}function LU(e){return{top:0,right:0,bottom:0,left:0,...e}}function yO(e){return typeof e!="number"?LU(e):{top:e,right:e,bottom:e,left:e}}function Ed(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function gO(e,t,n){let{reference:r,floating:o}=e;const a=Xo(t),i=$y(t),s=By(i),c=oo(t),l=a==="y",u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(c){case"top":h={x:u,y:r.y-o.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Ni(t)){case"start":h[i]-=f*(n&&l?-1:1);break;case"end":h[i]+=f*(n&&l?-1:1);break}return h}const FU=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:a=[],platform:i}=n,s=a.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=gO(l,r,c),f=r,h={},y=0;for(let m=0;m<s.length;m++){const{name:v,fn:b}=s[m],{x,y:_,data:w,reset:j}=await b({x:u,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:l,platform:i,elements:{reference:e,floating:t}});u=x??u,d=_??d,h={...h,[v]:{...h[v],...w}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(l=j.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):j.rects),{x:u,y:d}=gO(l,f,c)),m=-1)}return{x:u,y:d,placement:f,strategy:o,middlewareData:h}};async function Cc(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:a,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=ro(t,e),y=yO(h),m=s[f?d==="floating"?"reference":"floating":d],v=Ed(await a.getClippingRect({element:(n=await(a.isElement==null?void 0:a.isElement(m)))==null||n?m:m.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,x=await(a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating)),_=await(a.isElement==null?void 0:a.isElement(x))?await(a.getScale==null?void 0:a.getScale(x))||{x:1,y:1}:{x:1,y:1},w=Ed(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:x,strategy:c}):b);return{top:(v.top-w.top+y.top)/_.y,bottom:(w.bottom-v.bottom+y.bottom)/_.y,left:(v.left-w.left+y.left)/_.x,right:(w.right-v.right+y.right)/_.x}}const BU=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:a,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=ro(e,t)||{};if(l==null)return{};const d=yO(u),f={x:n,y:r},h=$y(o),y=By(h),m=await i.getDimensions(l),v=h==="y",b=v?"top":"left",x=v?"bottom":"right",_=v?"clientHeight":"clientWidth",w=a.reference[y]+a.reference[h]-f[h]-a.floating[y],j=f[h]-a.reference[h],E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let S=E?E[_]:0;(!S||!await(i.isElement==null?void 0:i.isElement(E)))&&(S=s.floating[_]||a.floating[y]);const O=w/2-j/2,k=S/2-m[y]/2-1,N=Ar(d[b],k),P=Ar(d[x],k),R=N,A=S-m[y]-P,C=S/2-m[y]/2+O,M=Ly(R,C,A),T=!c.arrow&&Ni(o)!=null&&C!==M&&a.reference[y]/2-(C<R?N:P)-m[y]/2<0,D=T?C<R?C-R:C-A:0;return{[h]:f[h]+D,data:{[h]:M,centerOffset:C-M-D,...T&&{alignmentOffset:D}},reset:T}}}),$U=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:a,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=ro(e,t);if((n=a.arrow)!=null&&n.alignmentOffset)return{};const b=oo(o),x=Xo(s),_=oo(s)===s,w=await(c.isRTL==null?void 0:c.isRTL(l.floating)),j=f||(_||!m?[jd(s)]:RU(s)),E=y!=="none";!f&&E&&j.push(...DU(s,m,y,w));const S=[s,...j],O=await Cc(t,v),k=[];let N=((r=a.flip)==null?void 0:r.overflows)||[];if(u&&k.push(O[b]),d){const C=TU(o,i,w);k.push(O[C[0]],O[C[1]])}if(N=[...N,{placement:o,overflows:k}],!k.every(C=>C<=0)){var P,R;const C=(((P=a.flip)==null?void 0:P.index)||0)+1,M=S[C];if(M)return{data:{index:C,overflows:N},reset:{placement:M}};let T=(R=N.filter(D=>D.overflows[0]<=0).sort((D,I)=>D.overflows[1]-I.overflows[1])[0])==null?void 0:R.placement;if(!T)switch(h){case"bestFit":{var A;const D=(A=N.filter(I=>{if(E){const L=Xo(I.placement);return L===x||L==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(L=>L>0).reduce((L,B)=>L+B,0)]).sort((I,L)=>I[1]-L[1])[0])==null?void 0:A[0];D&&(T=D);break}case"initialPlacement":T=s;break}if(o!==T)return{reset:{placement:T}}}return{}}}};function vO(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function bO(e){return kU.some(t=>e[t]>=0)}const zU=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=ro(e,t);switch(r){case"referenceHidden":{const a=await Cc(t,{...o,elementContext:"reference"}),i=vO(a,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:bO(i)}}}case"escaped":{const a=await Cc(t,{...o,altBoundary:!0}),i=vO(a,n.floating);return{data:{escapedOffsets:i,escaped:bO(i)}}}default:return{}}}}};async function VU(e,t){const{placement:n,platform:r,elements:o}=e,a=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=oo(n),s=Ni(n),c=Xo(n)==="y",l=["left","top"].includes(i)?-1:1,u=a&&c?-1:1,d=ro(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof y=="number"&&(h=s==="end"?y*-1:y),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const UU=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:a,placement:i,middlewareData:s}=t,c=await VU(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+c.x,y:a+c.y,data:{...c,placement:i}}}}},HU=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:x}=v;return{x:b,y:x}}},...c}=ro(e,t),l={x:n,y:r},u=await Cc(t,c),d=Xo(oo(o)),f=Fy(d);let h=l[f],y=l[d];if(a){const v=f==="y"?"top":"left",b=f==="y"?"bottom":"right",x=h+u[v],_=h-u[b];h=Ly(x,h,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",x=y+u[v],_=y-u[b];y=Ly(x,y,_)}const m=s.fn({...t,[f]:h,[d]:y});return{...m,data:{x:m.x-n,y:m.y-r}}}}},WU=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:a,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=ro(e,t),u={x:n,y:r},d=Xo(o),f=Fy(d);let h=u[f],y=u[d];const m=ro(s,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const _=f==="y"?"height":"width",w=a.reference[f]-a.floating[_]+v.mainAxis,j=a.reference[f]+a.reference[_]-v.mainAxis;h<w?h=w:h>j&&(h=j)}if(l){var b,x;const _=f==="y"?"width":"height",w=["top","left"].includes(oo(o)),j=a.reference[d]-a.floating[_]+(w&&((b=i.offset)==null?void 0:b[d])||0)+(w?0:v.crossAxis),E=a.reference[d]+a.reference[_]+(w?0:((x=i.offset)==null?void 0:x[d])||0)-(w?v.crossAxis:0);y<j?y=j:y>E&&(y=E)}return{[f]:h,[d]:y}}}},qU=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:o,elements:a}=t,{apply:i=()=>{},...s}=ro(e,t),c=await Cc(t,s),l=oo(n),u=Ni(n),d=Xo(n)==="y",{width:f,height:h}=r.floating;let y,m;l==="top"||l==="bottom"?(y=l,m=u===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(m=l,y=u==="end"?"top":"bottom");const v=h-c.top-c.bottom,b=f-c.left-c.right,x=Ar(h-c[y],v),_=Ar(f-c[m],b),w=!t.middlewareData.shift;let j=x,E=_;if(d?E=u||w?Ar(_,b):b:j=u||w?Ar(x,v):v,w&&!u){const O=Tn(c.left,0),k=Tn(c.right,0),N=Tn(c.top,0),P=Tn(c.bottom,0);d?E=f-2*(O!==0||k!==0?O+k:Tn(c.left,c.right)):j=h-2*(N!==0||P!==0?N+P:Tn(c.top,c.bottom))}await i({...t,availableWidth:E,availableHeight:j});const S=await o.getDimensions(a.floating);return f!==S.width||h!==S.height?{reset:{rects:!0}}:{}}}};function Mi(e){return xO(e)?(e.nodeName||"").toLowerCase():"#document"}function Rn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ao(e){var t;return(t=(xO(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function xO(e){return e instanceof Node||e instanceof Rn(e).Node}function cr(e){return e instanceof Element||e instanceof Rn(e).Element}function Tr(e){return e instanceof HTMLElement||e instanceof Rn(e).HTMLElement}function wO(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Rn(e).ShadowRoot}function Oc(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=lr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function YU(e){return["table","td","th"].includes(Mi(e))}function Sd(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Vy(e){const t=Uy(),n=cr(e)?lr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function KU(e){let t=Qo(e);for(;Tr(t)&&!ki(t);){if(Vy(t))return t;if(Sd(t))return null;t=Qo(t)}return null}function Uy(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ki(e){return["html","body","#document"].includes(Mi(e))}function lr(e){return Rn(e).getComputedStyle(e)}function Cd(e){return cr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Qo(e){if(Mi(e)==="html")return e;const t=e.assignedSlot||e.parentNode||wO(e)&&e.host||ao(e);return wO(t)?t.host:t}function _O(e){const t=Qo(e);return ki(t)?e.ownerDocument?e.ownerDocument.body:e.body:Tr(t)&&Oc(t)?t:_O(t)}function Nc(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=_O(e),a=o===((r=e.ownerDocument)==null?void 0:r.body),i=Rn(o);if(a){const s=Hy(i);return t.concat(i,i.visualViewport||[],Oc(o)?o:[],s&&n?Nc(s):[])}return t.concat(o,Nc(o,[],n))}function Hy(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function jO(e){const t=lr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Tr(e),a=o?e.offsetWidth:n,i=o?e.offsetHeight:r,s=wd(n)!==a||wd(r)!==i;return s&&(n=a,r=i),{width:n,height:r,$:s}}function Wy(e){return cr(e)?e:e.contextElement}function Pi(e){const t=Wy(e);if(!Tr(t))return Ko(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:a}=jO(t);let i=(a?wd(n.width):n.width)/r,s=(a?wd(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const XU=Ko(0);function EO(e){const t=Rn(e);return!Uy()||!t.visualViewport?XU:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function QU(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Rn(e)?!1:t}function Na(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),a=Wy(e);let i=Ko(1);t&&(r?cr(r)&&(i=Pi(r)):i=Pi(e));const s=QU(a,n,r)?EO(a):Ko(0);let c=(o.left+s.x)/i.x,l=(o.top+s.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(a){const f=Rn(a),h=r&&cr(r)?Rn(r):r;let y=f,m=Hy(y);for(;m&&r&&h!==y;){const v=Pi(m),b=m.getBoundingClientRect(),x=lr(m),_=b.left+(m.clientLeft+parseFloat(x.paddingLeft))*v.x,w=b.top+(m.clientTop+parseFloat(x.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=w,y=Rn(m),m=Hy(y)}}return Ed({width:u,height:d,x:c,y:l})}function JU(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const a=o==="fixed",i=ao(r),s=t?Sd(t.floating):!1;if(r===i||s&&a)return n;let c={scrollLeft:0,scrollTop:0},l=Ko(1);const u=Ko(0),d=Tr(r);if((d||!d&&!a)&&((Mi(r)!=="body"||Oc(i))&&(c=Cd(r)),Tr(r))){const f=Na(r);l=Pi(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function GU(e){return Array.from(e.getClientRects())}function SO(e){return Na(ao(e)).left+Cd(e).scrollLeft}function ZU(e){const t=ao(e),n=Cd(e),r=e.ownerDocument.body,o=Tn(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=Tn(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+SO(e);const s=-n.scrollTop;return lr(r).direction==="rtl"&&(i+=Tn(t.clientWidth,r.clientWidth)-o),{width:o,height:a,x:i,y:s}}function eH(e,t){const n=Rn(e),r=ao(e),o=n.visualViewport;let a=r.clientWidth,i=r.clientHeight,s=0,c=0;if(o){a=o.width,i=o.height;const l=Uy();(!l||l&&t==="fixed")&&(s=o.offsetLeft,c=o.offsetTop)}return{width:a,height:i,x:s,y:c}}function tH(e,t){const n=Na(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,a=Tr(e)?Pi(e):Ko(1),i=e.clientWidth*a.x,s=e.clientHeight*a.y,c=o*a.x,l=r*a.y;return{width:i,height:s,x:c,y:l}}function CO(e,t,n){let r;if(t==="viewport")r=eH(e,n);else if(t==="document")r=ZU(ao(e));else if(cr(t))r=tH(t,n);else{const o=EO(e);r={...t,x:t.x-o.x,y:t.y-o.y}}return Ed(r)}function OO(e,t){const n=Qo(e);return n===t||!cr(n)||ki(n)?!1:lr(n).position==="fixed"||OO(n,t)}function nH(e,t){const n=t.get(e);if(n)return n;let r=Nc(e,[],!1).filter(s=>cr(s)&&Mi(s)!=="body"),o=null;const a=lr(e).position==="fixed";let i=a?Qo(e):e;for(;cr(i)&&!ki(i);){const s=lr(i),c=Vy(i);!c&&s.position==="fixed"&&(o=null),(a?!c&&!o:!c&&s.position==="static"&&o&&["absolute","fixed"].includes(o.position)||Oc(i)&&!c&&OO(e,i))?r=r.filter(l=>l!==i):o=s,i=Qo(i)}return t.set(e,r),r}function rH(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const a=[...n==="clippingAncestors"?Sd(t)?[]:nH(t,this._c):[].concat(n),r],i=a[0],s=a.reduce((c,l)=>{const u=CO(t,l,o);return c.top=Tn(u.top,c.top),c.right=Ar(u.right,c.right),c.bottom=Ar(u.bottom,c.bottom),c.left=Tn(u.left,c.left),c},CO(t,i,o));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function oH(e){const{width:t,height:n}=jO(e);return{width:t,height:n}}function aH(e,t,n){const r=Tr(t),o=ao(t),a=n==="fixed",i=Na(e,!0,a,t);let s={scrollLeft:0,scrollTop:0};const c=Ko(0);if(r||!r&&!a)if((Mi(t)!=="body"||Oc(o))&&(s=Cd(t)),r){const d=Na(t,!0,a,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else o&&(c.x=SO(o));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function qy(e){return lr(e).position==="static"}function NO(e,t){return!Tr(e)||lr(e).position==="fixed"?null:t?t(e):e.offsetParent}function MO(e,t){const n=Rn(e);if(Sd(e))return n;if(!Tr(e)){let o=Qo(e);for(;o&&!ki(o);){if(cr(o)&&!qy(o))return o;o=Qo(o)}return n}let r=NO(e,t);for(;r&&YU(r)&&qy(r);)r=NO(r,t);return r&&ki(r)&&qy(r)&&!Vy(r)?n:r||KU(e)||n}const iH=async function(e){const t=this.getOffsetParent||MO,n=this.getDimensions,r=await n(e.floating);return{reference:aH(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function sH(e){return lr(e).direction==="rtl"}const cH={convertOffsetParentRelativeRectToViewportRelativeRect:JU,getDocumentElement:ao,getClippingRect:rH,getOffsetParent:MO,getElementRects:iH,getClientRects:GU,getDimensions:oH,getScale:Pi,isElement:cr,isRTL:sH};function lH(e,t){let n=null,r;const o=ao(e);function a(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),a();const{left:l,top:u,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const h=_d(u),y=_d(o.clientWidth-(l+d)),m=_d(o.clientHeight-(u+f)),v=_d(l),b={rootMargin:-h+"px "+-y+"px "+-m+"px "+-v+"px",threshold:Tn(0,Ar(1,c))||1};let x=!0;function _(w){const j=w[0].intersectionRatio;if(j!==c){if(!x)return i();j?i(!1,j):r=setTimeout(()=>{i(!1,1e-7)},1e3)}x=!1}try{n=new IntersectionObserver(_,{...b,root:o.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),a}HE=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=Wy(e),u=o||a?[...l?Nc(l):[],...Nc(t)]:[];u.forEach(b=>{o&&b.addEventListener("scroll",n,{passive:!0}),a&&b.addEventListener("resize",n)});const d=l&&s?lH(l,n):null;let f=-1,h=null;i&&(h=new ResizeObserver(b=>{let[x]=b;x&&x.target===l&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(t)})),n()}),l&&!c&&h.observe(l),h.observe(t));let y,m=c?Na(e):null;c&&v();function v(){const b=Na(e);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&n(),m=b,y=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(x=>{o&&x.removeEventListener("scroll",n),a&&x.removeEventListener("resize",n)}),d==null||d(),(b=h)==null||b.disconnect(),h=null,c&&cancelAnimationFrame(y)}};let kO;zE=UU,aS=HU,VE=$U,sS=qU,kO=zU,Lm=BU,iS=WU,UE=(e,t,n)=>{const r=new Map,o={platform:cH,...n},a={...o.platform,_c:r};return FU(e,t,{...o,platform:a})};var Od=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Nd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Nd(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const a=o[r];if(!(a==="_owner"&&e.$$typeof)&&!Nd(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function PO(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function AO(e,t){const n=PO(e);return Math.round(t*n)/n}function TO(e){const t=g.useRef(e);return Od(()=>{t.current=e}),t}function uH(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:a,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=g.useState(r);Nd(f,r)||h(r);const[y,m]=g.useState(null),[v,b]=g.useState(null),x=g.useCallback(D=>{D!==E.current&&(E.current=D,m(D))},[]),_=g.useCallback(D=>{D!==S.current&&(S.current=D,b(D))},[]),w=a||y,j=i||v,E=g.useRef(null),S=g.useRef(null),O=g.useRef(u),k=c!=null,N=TO(c),P=TO(o),R=g.useCallback(()=>{if(!E.current||!S.current)return;const D={placement:t,strategy:n,middleware:f};P.current&&(D.platform=P.current),UE(E.current,S.current,D).then(I=>{const L={...I,isPositioned:!0};A.current&&!Nd(O.current,L)&&(O.current=L,Du.flushSync(()=>{d(L)}))})},[f,t,n,P]);Od(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const A=g.useRef(!1);Od(()=>(A.current=!0,()=>{A.current=!1}),[]),Od(()=>{if(w&&(E.current=w),j&&(S.current=j),w&&j){if(N.current)return N.current(w,j,R);R()}},[w,j,R,N,k]);const C=g.useMemo(()=>({reference:E,floating:S,setReference:x,setFloating:_}),[x,_]),M=g.useMemo(()=>({reference:w,floating:j}),[w,j]),T=g.useMemo(()=>{const D={position:n,left:0,top:0};if(!M.floating)return D;const I=AO(M.floating,u.x),L=AO(M.floating,u.y);return s?{...D,transform:"translate("+I+"px, "+L+"px)",...PO(M.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:I,top:L}},[n,s,M.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:R,refs:C,elements:M,floatingStyles:T}),[u,R,C,M,T])}const dH=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Lm({element:r.current,padding:o}).fn(n):{}:r?Lm({element:r,padding:o}).fn(n):{}}}},fH=(e,t)=>({...zE(e),options:[e,t]}),pH=(e,t)=>({...aS(e),options:[e,t]}),hH=(e,t)=>({...iS(e),options:[e,t]}),mH=(e,t)=>({...VE(e),options:[e,t]}),yH=(e,t)=>({...sS(e),options:[e,t]}),gH=(e,t)=>({...kO(e),options:[e,t]}),vH=(e,t)=>({...dH(e),options:[e,t]});var bH="Arrow",RO=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...a}=e;return p.jsx(Oe.svg,{...a,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});RO.displayName=bH;var xH=RO;function wH(e,t=[]){let n=[];function r(a,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return p.jsx(m.Provider,{value:v,children:h})}function u(d,f){const h=(f==null?void 0:f[e][c])||s,y=g.useContext(h);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,u]}const o=()=>{const a=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||a;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return o.scopeName=e,[r,_H(o,...t)]}function _H(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(o){const a=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(o)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function IO(e){const[t,n]=g.useState(void 0);return xn(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const a=o[0];let i,s;if("borderBoxSize"in a){const c=a.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var Yy="Popper",[DO,Jo]=wH(Yy),[jH,LO]=DO(Yy),FO=e=>{const{__scopePopper:t,children:n}=e,[r,o]=g.useState(null);return p.jsx(jH,{scope:t,anchor:r,onAnchorChange:o,children:n})};FO.displayName=Yy;var BO="PopperAnchor",$O=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,a=LO(BO,n),i=g.useRef(null),s=rt(t,i);return g.useEffect(()=>{a.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:p.jsx(Oe.div,{...o,ref:s})});$O.displayName=BO;var Ky="PopperContent",[EH,SH]=DO(Ky),zO=g.forwardRef((e,t)=>{var Z,Y,W,G,te,$;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:a="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:y,...m}=e,v=LO(Ky,n),[b,x]=g.useState(null),_=rt(t,se=>x(se)),[w,j]=g.useState(null),E=IO(w),S=(E==null?void 0:E.width)??0,O=(E==null?void 0:E.height)??0,k=r+(a!=="center"?"-"+a:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],R=P.length>0,A={padding:N,boundary:P.filter(OH),altBoundary:R},{refs:C,floatingStyles:M,placement:T,isPositioned:D,middlewareData:I}=uH({strategy:"fixed",placement:k,whileElementsMounted:(...se)=>HE(...se,{animationFrame:h==="always"}),elements:{reference:v.anchor},middleware:[fH({mainAxis:o+O,alignmentAxis:i}),c&&pH({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?hH():void 0,...A}),c&&mH({...A}),yH({...A,apply:({elements:se,rects:ue,availableWidth:ve,availableHeight:Te})=>{const{width:qe,height:Ye}=ue.reference,ze=se.floating.style;ze.setProperty("--radix-popper-available-width",`${ve}px`),ze.setProperty("--radix-popper-available-height",`${Te}px`),ze.setProperty("--radix-popper-anchor-width",`${qe}px`),ze.setProperty("--radix-popper-anchor-height",`${Ye}px`)}}),w&&vH({element:w,padding:s}),NH({arrowWidth:S,arrowHeight:O}),f&&gH({strategy:"referenceHidden",...A})]}),[L,B]=HO(T),U=Vo(y);xn(()=>{D&&(U==null||U())},[D,U]);const F=(Z=I.arrow)==null?void 0:Z.x,H=(Y=I.arrow)==null?void 0:Y.y,J=((W=I.arrow)==null?void 0:W.centerOffset)!==0,[q,re]=g.useState();return xn(()=>{b&&re(window.getComputedStyle(b).zIndex)},[b]),p.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...M,transform:D?M.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:q,"--radix-popper-transform-origin":[(G=I.transformOrigin)==null?void 0:G.x,(te=I.transformOrigin)==null?void 0:te.y].join(" "),...(($=I.hide)==null?void 0:$.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:p.jsx(EH,{scope:n,placedSide:L,onArrowChange:j,arrowX:F,arrowY:H,shouldHideArrow:J,children:p.jsx(Oe.div,{"data-side":L,"data-align":B,...m,ref:_,style:{...m.style,animation:D?void 0:"none"}})})})});zO.displayName=Ky;var VO="PopperArrow",CH={top:"bottom",right:"left",bottom:"top",left:"right"},UO=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,o=SH(VO,n),a=CH[o.placedSide];return p.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:p.jsx(xH,{...r,ref:t,style:{...r.style,display:"block"}})})});UO.displayName=VO;function OH(e){return e!==null}var NH=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:o}=t,a=((m=o.arrow)==null?void 0:m.centerOffset)!==0,i=a?0:e.arrowWidth,s=a?0:e.arrowHeight,[c,l]=HO(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=o.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=o.arrow)==null?void 0:b.y)??0)+s/2;let h="",y="";return c==="bottom"?(h=a?u:`${d}px`,y=`${-s}px`):c==="top"?(h=a?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(h=`${-s}px`,y=a?u:`${f}px`):c==="left"&&(h=`${r.floating.width+s}px`,y=a?u:`${f}px`),{data:{x:h,y}}}});function HO(e){const[t,n="center"]=e.split("-");return[t,n]}var Mc=FO,kc=$O,Md=zO,kd=UO,[Pd,i1e]=Vn("Tooltip",[Jo]),Ad=Jo(),WO="TooltipProvider",MH=700,Xy="tooltip.open",[kH,Qy]=Pd(WO),qO=e=>{const{__scopeTooltip:t,delayDuration:n=MH,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:a}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),p.jsx(kH,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:o,children:a})};qO.displayName=WO;var Td="Tooltip",[PH,Pc]=Pd(Td),YO=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:o=!1,onOpenChange:a,disableHoverableContent:i,delayDuration:s}=e,c=Qy(Td,e.__scopeTooltip),l=Ad(t),[u,d]=g.useState(null),f=mt(),h=g.useRef(0),y=i??c.disableHoverableContent,m=s??c.delayDuration,v=g.useRef(!1),[b=!1,x]=en({prop:r,defaultProp:o,onChange:S=>{S?(c.onOpen(),document.dispatchEvent(new CustomEvent(Xy))):c.onClose(),a==null||a(S)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),w=g.useCallback(()=>{window.clearTimeout(h.current),h.current=0,v.current=!1,x(!0)},[x]),j=g.useCallback(()=>{window.clearTimeout(h.current),h.current=0,x(!1)},[x]),E=g.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{v.current=!0,x(!0),h.current=0},m)},[m,x]);return g.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),p.jsx(Mc,{...l,children:p.jsx(PH,{scope:t,contentId:f,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?E():w()},[c.isOpenDelayed,E,w]),onTriggerLeave:g.useCallback(()=>{y?j():(window.clearTimeout(h.current),h.current=0)},[j,y]),onOpen:w,onClose:j,disableHoverableContent:y,children:n})})};YO.displayName=Td;var Jy="TooltipTrigger",KO=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=Pc(Jy,n),a=Qy(Jy,n),i=Ad(n),s=g.useRef(null),c=rt(t,s,o.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),p.jsx(kc,{asChild:!0,...i,children:p.jsx(Oe.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:c,onPointerMove:he(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!a.isPointerInTransitRef.current&&(o.onTriggerEnter(),u.current=!0)}),onPointerLeave:he(e.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:he(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:he(e.onFocus,()=>{l.current||o.onOpen()}),onBlur:he(e.onBlur,o.onClose),onClick:he(e.onClick,o.onClose)})})});KO.displayName=Jy;var Gy="TooltipPortal",[AH,TH]=Pd(Gy,{forceMount:void 0}),XO=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:o}=e,a=Pc(Gy,t);return p.jsx(AH,{scope:t,forceMount:n,children:p.jsx(Mn,{present:n||a.open,children:p.jsx(Fu,{asChild:!0,container:o,children:r})})})};XO.displayName=Gy;var Ai="TooltipContent",QO=g.forwardRef((e,t)=>{const n=TH(Ai,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...a}=e,i=Pc(Ai,e.__scopeTooltip);return p.jsx(Mn,{present:r||i.open,children:i.disableHoverableContent?p.jsx(JO,{side:o,...a,ref:t}):p.jsx(RH,{side:o,...a,ref:t})})}),RH=g.forwardRef((e,t)=>{const n=Pc(Ai,e.__scopeTooltip),r=Qy(Ai,e.__scopeTooltip),o=g.useRef(null),a=rt(t,o),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=o.current,{onPointerInTransitChange:d}=r,f=g.useCallback(()=>{s(null),d(!1)},[d]),h=g.useCallback((y,m)=>{const v=y.currentTarget,b={x:y.clientX,y:y.clientY},x=FH(b,v.getBoundingClientRect()),_=BH(b,x),w=$H(m.getBoundingClientRect()),j=VH([..._,...w]);s(j),d(!0)},[d]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const y=v=>h(v,u),m=v=>h(v,c);return c.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[c,u,h,f]),g.useEffect(()=>{if(i){const y=m=>{const v=m.target,b={x:m.clientX,y:m.clientY},x=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!zH(b,i);x?f():_&&(f(),l())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,u,i,l,f]),p.jsx(JO,{...e,ref:a})}),[IH,DH]=Pd(Td,{isInside:!1}),JO=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:i,...s}=e,c=Pc(Ai,n),l=Ad(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(Xy,u),()=>document.removeEventListener(Xy,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=f=>{var h;(h=f.target)!=null&&h.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),p.jsx(Lu,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:p.jsxs(Md,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(L9,{children:r}),p.jsx(IH,{scope:n,isInside:!0,children:p.jsx(Owe,{id:c.contentId,role:"tooltip",children:o||r})})]})})});QO.displayName=Ai;var GO="TooltipArrow",LH=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=Ad(n);return DH(GO,n).isInside?null:p.jsx(kd,{...o,...r,ref:t})});LH.displayName=GO;function FH(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(n,r,o,a)){case a:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function BH(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function $H(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function zH(e,t){const{x:n,y:r}=e;let o=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const s=t[a].x,c=t[a].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(o=!o)}return o}function VH(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),UH(t)}function UH(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const a=t[t.length-1],i=t[t.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const a=n[n.length-1],i=n[n.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}qE=qO,JE=YO,GE=KO,Q9=XO,Em=QO;const Ac=qE,Rr=JE,Ir=GE,ur=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>p.jsx(Em,{ref:r,sideOffset:t,className:K("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));ur.displayName=Em.displayName;const HH="sidebar:state",WH=60*60*24*7,qH="16rem",YH="18rem",KH="3rem",XH="b",ZO=g.createContext(null);function Tc(){const e=g.useContext(ZO);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Zy=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:o,children:a,...i},s)=>{const c=EV(),[l,u]=g.useState(!1),[d,f]=g.useState(e),h=t??d,y=g.useCallback(x=>{const _=typeof x=="function"?x(h):x;n?n(_):f(_),document.cookie=`${HH}=${_}; path=/; max-age=${WH}`},[n,h]),m=g.useCallback(()=>c?u(x=>!x):y(x=>!x),[c,y,u]);g.useEffect(()=>{const x=_=>{_.key===XH&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),m())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[m]);const v=h?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:h,setOpen:y,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:m}),[v,h,y,c,l,u,m]);return p.jsx(ZO.Provider,{value:b,children:p.jsx(Ac,{delayDuration:0,children:p.jsx("div",{style:{"--sidebar-width":qH,"--sidebar-width-icon":KH,...o},className:K("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:a})})})});Zy.displayName="SidebarProvider";const eg=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:o,...a},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=Tc();return n==="none"?p.jsx("div",{className:K("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...a,children:o}):s?p.jsx(SU,{open:l,onOpenChange:u,...a,children:p.jsx(hO,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":YH},side:e,children:p.jsx("div",{className:"flex h-full w-full flex-col",children:o})})}):p.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[p.jsx("div",{className:K("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),p.jsx("div",{className:K("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...a,children:p.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:o})})]})});eg.displayName="Sidebar";const eN=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:o}=Tc();return p.jsx(at,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:K("h-7 w-7",e),onClick:a=>{t==null||t(a),o()},...n,children:p.jsx(le,{size:32,name:"panel-left"})})});eN.displayName="SidebarTrigger";const tN=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=Tc();return p.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:K("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});tN.displayName="SidebarRail";const tg=g.forwardRef(({className:e,...t},n)=>p.jsx("main",{ref:n,className:K("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));tg.displayName="SidebarInset";const QH=g.forwardRef(({className:e,...t},n)=>p.jsx(dn,{ref:n,"data-sidebar":"input",className:K("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));QH.displayName="SidebarInput";const JH=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"header",className:K("flex flex-col gap-2 p-2",e),...t}));JH.displayName="SidebarHeader";const nN=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"footer",className:K("flex flex-col gap-2 p-2",e),...t}));nN.displayName="SidebarFooter";const GH=g.forwardRef(({className:e,...t},n)=>p.jsx(jc,{ref:n,"data-sidebar":"separator",className:K("mx-2 w-auto bg-sidebar-border",e),...t}));GH.displayName="SidebarSeparator";const ng=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"content",className:K("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));ng.displayName="SidebarContent";const Rc=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"group",className:K("relative flex w-full min-w-0 flex-col p-2",e),...t}));Rc.displayName="SidebarGroup";const Ic=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const o=t?Gr:"div";return p.jsx(o,{ref:r,"data-sidebar":"group-label",className:K("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});Ic.displayName="SidebarGroupLabel";const ZH=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const o=t?Gr:"button";return p.jsx(o,{ref:r,"data-sidebar":"group-action",className:K("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});ZH.displayName="SidebarGroupAction";const eW=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"group-content",className:K("w-full text-sm",e),...t}));eW.displayName="SidebarGroupContent";const Ti=g.forwardRef(({className:e,...t},n)=>p.jsx("ul",{ref:n,"data-sidebar":"menu",className:K("flex w-full min-w-0 flex-col gap-1",e),...t}));Ti.displayName="SidebarMenu";const io=g.forwardRef(({className:e,...t},n)=>p.jsx("li",{ref:n,"data-sidebar":"menu-item",className:K("group/menu-item relative",e),...t}));io.displayName="SidebarMenuItem";const tW=Jr("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),so=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:o,className:a,...i},s)=>{const c=e?Gr:"button",{isMobile:l,state:u}=Tc(),d=p.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:K(tW({variant:n,size:r}),a),...i});return o?(typeof o=="string"&&(o={children:o}),p.jsxs(Rr,{children:[p.jsx(Ir,{asChild:!0,children:d}),p.jsx(ur,{side:"right",align:"center",hidden:u!=="collapsed"||l,...o})]})):d});so.displayName="SidebarMenuButton";const nW=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},o)=>{const a=t?Gr:"button";return p.jsx(a,{ref:o,"data-sidebar":"menu-action",className:K("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});nW.displayName="SidebarMenuAction";const rW=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:K("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));rW.displayName="SidebarMenuBadge";const oW=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const o=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return p.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:K("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&p.jsx(mO,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),p.jsx(mO,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":o}})]})});oW.displayName="SidebarMenuSkeleton";const rN=g.forwardRef(({className:e,...t},n)=>p.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:K("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));rN.displayName="SidebarMenuSub";const oN=g.forwardRef(({...e},t)=>p.jsx("li",{ref:t,...e}));oN.displayName="SidebarMenuSubItem";const aN=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...o},a)=>{const i=e?Gr:"a";return p.jsx(i,{ref:a,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:K("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...o})});aN.displayName="SidebarMenuSubButton";function aW({items:e}){const{t}=Me("documents");return p.jsxs(Rc,{children:[p.jsx(Ic,{children:p.jsx("div",{className:"text-sm",children:t("title")})}),p.jsx(Ti,{children:e.map(n=>{var r;return p.jsx(wV,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:p.jsxs(io,{children:[p.jsx(_V,{asChild:!0,children:p.jsxs(so,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,p.jsx("span",{children:t(n.title)}),p.jsx(le,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),p.jsx(jV,{children:p.jsx(rN,{children:(r=n.items)==null?void 0:r.map(o=>p.jsx(oN,{className:"cursor-pointer",children:p.jsx(aN,{asChild:!0,children:p.jsx("span",{children:t(o.title)})})},t(o.title)))})})]})},n.title)})})]})}const iW="hash",rg={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?"},In=(e,t)=>{const n=rg[e];return t?Object.keys(t||{}).reduce((r,o)=>r.replace(`:${o}`,(t==null?void 0:t[o])||""),n):n.replace(/\/:[^/]+/g,"")},sW=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}},cW=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...o})=>{const[a,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,f=`${Math.random()*100}%`,h=Math.random()>.5?t.first:t.second,y=Math.random()*2,m=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${f}-${Date.now()}`,x:d,y:f,color:h,delay:y,scale:m,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(f=>f.lifespan<=0?s():{...f,lifespan:f.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),p.jsx("div",{className:K("text-6xl font-bold",n),...o,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:p.jsxs("span",{className:"relative inline-block",children:[a.map(s=>p.jsx(lW,{...s},s.id)),p.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),lW=({id:e,x:t,y:n,color:r,delay:o,scale:a})=>p.jsx(Bu.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,a,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:o},width:"21",height:"21",viewBox:"0 0 21 21",children:p.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function uW({className:e,onClick:t}){const{t:n}=Me("sidebar");return p.jsxs(so,{className:K(e,"tw-w-full"),onClick:t,children:[p.jsx(le,{name:"frame"}),p.jsx(cW,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const dW=()=>{const[e,t]=g.useState(!1),n=Je(i=>i.setCurrentSession),r=Je(i=>i.createSession),o=$u(i=>i.setSelectedSessionId),a=g.useCallback(async i=>{try{t(!0);const s=await r(i);n(s),o(s.id)}finally{t(!1)}},[r,n,o]);return{loading:e,createSession:a}},Ri=oc,fW=lc,iN=g.forwardRef(({className:e,...t},n)=>p.jsx(_a,{ref:n,className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));iN.displayName=_a.displayName;const Ma=g.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(fW,{children:[p.jsx(iN,{}),p.jsxs(ja,{ref:r,className:K("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,p.jsxs(uc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[p.jsx(le,{name:"x",className:"h-4 w-4"}),p.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ma.displayName=ja.displayName;const ka=({className:e,...t})=>p.jsx("div",{className:K("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ka.displayName="DialogHeader";const og=({className:e,...t})=>p.jsx("div",{className:K("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});og.displayName="DialogFooter";const Pa=g.forwardRef(({className:e,...t},n)=>p.jsx(hi,{ref:n,className:K("text-lg font-semibold leading-none tracking-tight",e),...t}));Pa.displayName=hi.displayName;const ag=g.forwardRef(({className:e,...t},n)=>p.jsx(mi,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));ag.displayName=mi.displayName;var pW="Label",sN=g.forwardRef((e,t)=>p.jsx(Oe.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));sN.displayName=pW;var cN=sN;let lN;lN=Jr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qe=g.forwardRef(({className:e,...t},n)=>p.jsx(cN,{ref:n,className:K(lN(),e),...t})),Qe.displayName=cN.displayName;const hW=ba(()=>{const e=Kt(),{t}=Me("dialogs"),[n,r]=g.useState(""),{toast:o}=Bt(),{loading:a,createSession:i}=dW(),s=l=>{r(l.target.value)},c=async()=>{try{await i({name:n}),r(""),e.hide()}catch{o({variant:"destructive",description:t("create_session.errors.create_failed")})}};return p.jsx(Ri,{open:e.visible,onOpenChange:e.hide,children:p.jsxs(Ma,{className:"sm:max-w-[425px]",children:[p.jsxs(ka,{children:[p.jsx(Pa,{children:t("create_session.title")}),p.jsx(ag,{children:t("create_session.description")})]}),p.jsx("div",{className:"grid gap-4 py-4",children:p.jsxs("div",{className:"flex flex-col space-y-1.5",children:[p.jsx(Qe,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),p.jsx(dn,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),p.jsx(og,{children:p.jsx(at,{onClick:c,disabled:a||!n,type:"submit",children:t("create_session.create")})})]})})}),mW=()=>{const[e,t]=g.useState(!1),n=Je(o=>o.deleteSession),r=g.useCallback(async o=>{try{t(!0),await n(o),await Promise.all([ce("FlowEdge").find({select:["id"],where:{session_id:o}}).then(a=>Promise.all(a.map(i=>ce("FlowEdge").delete(i.id)))),ce("FlowNode").find({select:["id"],where:{session_id:o}}).then(a=>Promise.all(a.map(i=>ce("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var uN="AlertDialog",[yW,s1e]=Vn(uN,[KC]),co=KC(),dN=e=>{const{__scopeAlertDialog:t,...n}=e,r=co(t);return p.jsx(oc,{...r,...n,modal:!0})};dN.displayName=uN;var gW="AlertDialogTrigger",vW=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,o=co(n);return p.jsx(fO,{...o,...r,ref:t})});vW.displayName=gW;var bW="AlertDialogPortal",fN=e=>{const{__scopeAlertDialog:t,...n}=e,r=co(t);return p.jsx(lc,{...r,...n})};fN.displayName=bW;var xW="AlertDialogOverlay",pN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,o=co(n);return p.jsx(_a,{...o,...r,ref:t})});pN.displayName=xW;var Ii="AlertDialogContent",[wW,_W]=yW(Ii),hN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...o}=e,a=co(n),i=g.useRef(null),s=rt(t,i),c=g.useRef(null);return p.jsx(cO,{contentName:Ii,titleName:mN,docsSlug:"alert-dialog",children:p.jsx(wW,{scope:n,cancelRef:c,children:p.jsxs(ja,{role:"alertdialog",...a,...o,ref:s,onOpenAutoFocus:he(o.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[p.jsx(L9,{children:r}),p.jsx(_N,{contentRef:i})]})})})});hN.displayName=Ii;var mN="AlertDialogTitle",yN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,o=co(n);return p.jsx(hi,{...o,...r,ref:t})});yN.displayName=mN;var gN="AlertDialogDescription",vN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,o=co(n);return p.jsx(mi,{...o,...r,ref:t})});vN.displayName=gN;var jW="AlertDialogAction",bN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,o=co(n);return p.jsx(uc,{...o,...r,ref:t})});bN.displayName=jW;var xN="AlertDialogCancel",wN=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:o}=_W(xN,n),a=co(n),i=rt(t,o);return p.jsx(uc,{...a,...r,ref:i})});wN.displayName=xN;let _N;_N=({contentRef:e})=>{const t=`\`${Ii}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ii}\` by passing a \`${gN}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ii}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},KE=dN,YE=fN,Im=pN,Dm=hN,im=bN,sm=wN,om=yN,am=vN;const jN=KE,EW=YE,EN=g.forwardRef(({className:e,...t},n)=>p.jsx(Im,{className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));EN.displayName=Im.displayName;const ig=g.forwardRef(({className:e,...t},n)=>p.jsxs(EW,{children:[p.jsx(EN,{}),p.jsx(Dm,{ref:n,className:K("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));ig.displayName=Dm.displayName;const sg=({className:e,...t})=>p.jsx("div",{className:K("flex flex-col space-y-2 text-center sm:text-left",e),...t});sg.displayName="AlertDialogHeader";const cg=({className:e,...t})=>p.jsx("div",{className:K("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});cg.displayName="AlertDialogFooter";const lg=g.forwardRef(({className:e,...t},n)=>p.jsx(om,{ref:n,className:K("text-lg font-semibold",e),...t}));lg.displayName=om.displayName;const ug=g.forwardRef(({className:e,...t},n)=>p.jsx(am,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));ug.displayName=am.displayName;const dg=g.forwardRef(({className:e,...t},n)=>p.jsx(im,{ref:n,className:K(_c(),e),...t}));dg.displayName=im.displayName;const fg=g.forwardRef(({className:e,...t},n)=>p.jsx(sm,{ref:n,className:K(_c({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));fg.displayName=sm.displayName;const SN=ba(({id:e})=>{const{t}=Me("dialogs"),n=Kt(),{toast:r}=Bt(),{deleteSession:o,loading:a}=mW(),i=async()=>{try{await o(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return p.jsx(jN,{open:n.visible,onOpenChange:n.hide,children:p.jsxs(ig,{children:[p.jsxs(sg,{children:[p.jsx(lg,{children:t("delete_session.title")}),p.jsx(ug,{children:t("delete_session.description")})]}),p.jsxs(cg,{children:[p.jsx(fg,{onClick:n.hide,children:t("delete_session.cancel")}),p.jsx(dg,{disabled:a,onClick:i,children:t("delete_session.delete")})]})]})})});function SW({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Me("sidebar"),o=ji(),a=Kt(hW),i=Kt(SN),s=g.useCallback(()=>{a.show({})},[a]),c=g.useCallback((u,d)=>{u.preventDefault(),u.stopPropagation(),i.show({id:d})},[i]),l=u=>{n(u),o(In("whiteboard",{sessionId:u.id}))};return p.jsxs(Rc,{className:"group-data-[collapsible=icon]:hidden",children:[p.jsx(Ic,{children:p.jsx("div",{className:"text-sm",children:r("sessions")})}),p.jsxs(Ti,{children:[p.jsx(io,{children:p.jsx(uW,{onClick:s,className:"w-full"})}),e.map(u=>p.jsx(io,{className:"cursor-pointer",children:p.jsx(so,{asChild:!0,onClick:()=>l(u),children:p.jsxs("div",{className:"flex flex-row justify-between items-center",children:[p.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===u.id?p.jsx(le,{size:16,color:"green",name:"check"}):p.jsx(le,{size:16,name:"chevron-right"}),p.jsx("span",{children:u.name})]}),p.jsx(le,{onClick:d=>c(d,u.id),size:16,name:"trash-2",className:"!z-50"})]})})},u.id)),e!=null&&e.length?p.jsx(io,{children:p.jsxs(so,{className:"text-sidebar-foreground/70",children:[p.jsx(le,{name:"ellipsis",className:"text-sidebar-foreground/70"}),p.jsx("span",{children:r("more_session")})]})}):null]})]})}var CW=g.createContext(void 0);Uo=function(e){const t=g.useContext(CW);return e||t||"ltr"};function OW(e,t=[]){let n=[];function r(a,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return p.jsx(m.Provider,{value:v,children:h})}function u(d,f){const h=(f==null?void 0:f[e][c])||s,y=g.useContext(h);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,u]}const o=()=>{const a=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||a;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return o.scopeName=e,[r,NW(o,...t)]}function NW(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(o){const a=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(o)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}let Rd,CN,Dc,Id,pg,ON,NN,MN,kN,hg;Rd="rovingFocusGroup.onEntryFocus",CN={bubbles:!1,cancelable:!0},Dc="RovingFocusGroup",[Id,pg,ON]=zu(Dc),[NN,Zr]=OW(Dc,[ON]),[MN,kN]=NN(Dc),hg=g.forwardRef((e,t)=>p.jsx(Id.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(Id.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(MW,{...e,ref:t})})})),hg.displayName=Dc;var MW=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,f=g.useRef(null),h=rt(t,f),y=Uo(a),[m=null,v]=en({prop:i,defaultProp:s,onChange:c}),[b,x]=g.useState(!1),_=Vo(l),w=pg(n),j=g.useRef(!1),[E,S]=g.useState(0);return g.useEffect(()=>{const O=f.current;if(O)return O.addEventListener(Rd,_),()=>O.removeEventListener(Rd,_)},[_]),p.jsx(MN,{scope:n,orientation:r,dir:y,loop:o,currentTabStopId:m,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>x(!0),[]),onFocusableItemAdd:g.useCallback(()=>S(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>S(O=>O-1),[]),children:p.jsx(Oe.div,{tabIndex:b||E===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...e.style},onMouseDown:he(e.onMouseDown,()=>{j.current=!0}),onFocus:he(e.onFocus,O=>{const k=!j.current;if(O.target===O.currentTarget&&k&&!b){const N=new CustomEvent(Rd,CN);if(O.currentTarget.dispatchEvent(N),!N.defaultPrevented){const P=w().filter(M=>M.focusable),R=P.find(M=>M.active),A=P.find(M=>M.id===m),C=[R,A,...P].filter(Boolean).map(M=>M.ref.current);TN(C,u)}}j.current=!1}),onBlur:he(e.onBlur,()=>x(!1))})})}),PN="RovingFocusGroupItem",AN=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:a,...i}=e,s=mt(),c=a||s,l=kN(PN,n),u=l.currentTabStopId===c,d=pg(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=l;return g.useEffect(()=>{if(r)return f(),()=>h()},[r,f,h]),p.jsx(Id.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:p.jsx(Oe.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:he(e.onMouseDown,y=>{r?l.onItemFocus(c):y.preventDefault()}),onFocus:he(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:he(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){l.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const m=AW(y,l.orientation,l.dir);if(m!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const b=v.indexOf(y.currentTarget);v=l.loop?TW(v,b+1):v.slice(b+1)}setTimeout(()=>TN(v))}})})})});AN.displayName=PN;var kW={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function PW(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function AW(e,t,n){const r=PW(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return kW[r]}function TN(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function TW(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let Dd,RN,mg,IN,DN,LN,Di,Li,FN,BN,Go,Fi,yg,gg,lo,$N,Bi,vg;ac=hg,ic=AN,Dd=["Enter"," "],RN=["ArrowDown","PageUp","Home"],mg=["ArrowUp","PageDown","End"],IN=[...RN,...mg],DN={ltr:[...Dd,"ArrowRight"],rtl:[...Dd,"ArrowLeft"]},LN={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Di="Menu",[Li,FN,BN]=zu(Di),[Go,Yu]=Vn(Di,[BN,Jo,Zr]),Fi=Jo(),yg=Zr(),[gg,lo]=Go(Di),[$N,Bi]=Go(Di),vg=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:o,onOpenChange:a,modal:i=!0}=e,s=Fi(t),[c,l]=g.useState(null),u=g.useRef(!1),d=Vo(a),f=Uo(o);return g.useEffect(()=>{const h=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),p.jsx(Mc,{...s,children:p.jsx(gg,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:p.jsx($N,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:i,children:r})})})},vg.displayName=Di;var RW="MenuAnchor",bg=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Fi(n);return p.jsx(kc,{...o,...r,ref:t})});bg.displayName=RW;var xg="MenuPortal",[IW,zN]=Go(xg,{forceMount:void 0}),VN=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:o}=e,a=lo(xg,t);return p.jsx(IW,{scope:t,forceMount:n,children:p.jsx(Mn,{present:n||a.open,children:p.jsx(Fu,{asChild:!0,container:o,children:r})})})};VN.displayName=xg;var Wn="MenuContent",[DW,wg]=Go(Wn),UN=g.forwardRef((e,t)=>{const n=zN(Wn,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,a=lo(Wn,e.__scopeMenu),i=Bi(Wn,e.__scopeMenu);return p.jsx(Li.Provider,{scope:e.__scopeMenu,children:p.jsx(Mn,{present:r||a.open,children:p.jsx(Li.Slot,{scope:e.__scopeMenu,children:i.modal?p.jsx(LW,{...o,ref:t}):p.jsx(FW,{...o,ref:t})})})})}),LW=g.forwardRef((e,t)=>{const n=lo(Wn,e.__scopeMenu),r=g.useRef(null),o=rt(t,r);return g.useEffect(()=>{const a=r.current;if(a)return bd(a)},[]),p.jsx(_g,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:he(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),FW=g.forwardRef((e,t)=>{const n=lo(Wn,e.__scopeMenu);return p.jsx(_g,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),_g=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:h,disableOutsideScroll:y,...m}=e,v=lo(Wn,n),b=Bi(Wn,n),x=Fi(n),_=yg(n),w=FN(n),[j,E]=g.useState(null),S=g.useRef(null),O=rt(t,S,v.onContentChange),k=g.useRef(0),N=g.useRef(""),P=g.useRef(0),R=g.useRef(null),A=g.useRef("right"),C=g.useRef(0),M=y?Sc:g.Fragment,T=y?{as:Gr,allowPinchZoom:!0}:void 0,D=L=>{var Z,Y;const B=N.current+L,U=w().filter(W=>!W.disabled),F=document.activeElement,H=(Z=U.find(W=>W.ref.current===F))==null?void 0:Z.textValue,J=U.map(W=>W.textValue),q=QW(J,B,H),re=(Y=U.find(W=>W.textValue===q))==null?void 0:Y.ref.current;(function W(G){N.current=G,window.clearTimeout(k.current),G!==""&&(k.current=window.setTimeout(()=>W(""),1e3))})(B),re&&setTimeout(()=>re.focus())};g.useEffect(()=>()=>window.clearTimeout(k.current),[]),dd();const I=g.useCallback(L=>{var B,U;return A.current===((B=R.current)==null?void 0:B.side)&&GW(L,(U=R.current)==null?void 0:U.area)},[]);return p.jsx(DW,{scope:n,searchRef:N,onItemEnter:g.useCallback(L=>{I(L)&&L.preventDefault()},[I]),onItemLeave:g.useCallback(L=>{var B;I(L)||((B=S.current)==null||B.focus(),E(null))},[I]),onTriggerLeave:g.useCallback(L=>{I(L)&&L.preventDefault()},[I]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(L=>{R.current=L},[]),children:p.jsx(M,{...T,children:p.jsx(Ec,{asChild:!0,trapped:o,onMountAutoFocus:he(a,L=>{var B;L.preventDefault(),(B=S.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:p.jsx(Lu,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:h,children:p.jsx(ac,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:E,onEntryFocus:he(c,L=>{b.isUsingKeyboardRef.current||L.preventDefault()}),preventScrollOnEntryFocus:!0,children:p.jsx(Md,{role:"menu","aria-orientation":"vertical","data-state":sM(v.open),"data-radix-menu-content":"",dir:b.dir,...x,...m,ref:O,style:{outline:"none",...m.style},onKeyDown:he(m.onKeyDown,L=>{const B=L.target.closest("[data-radix-menu-content]")===L.currentTarget,U=L.ctrlKey||L.altKey||L.metaKey,F=L.key.length===1;B&&(L.key==="Tab"&&L.preventDefault(),!U&&F&&D(L.key));const H=S.current;if(L.target!==H||!IN.includes(L.key))return;L.preventDefault();const J=w().filter(q=>!q.disabled).map(q=>q.ref.current);mg.includes(L.key)&&J.reverse(),KW(J)}),onBlur:he(e.onBlur,L=>{L.currentTarget.contains(L.target)||(window.clearTimeout(k.current),N.current="")}),onPointerMove:he(e.onPointerMove,Fc(L=>{const B=L.target,U=C.current!==L.clientX;if(L.currentTarget.contains(B)&&U){const F=L.clientX>C.current?"right":"left";A.current=F,C.current=L.clientX}}))})})})})})})});UN.displayName=Wn;var BW="MenuGroup",jg=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Oe.div,{role:"group",...r,ref:t})});jg.displayName=BW;var $W="MenuLabel",HN=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Oe.div,{...r,ref:t})});HN.displayName=$W;var Ld="MenuItem",WN="menu.itemSelect",Fd=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...o}=e,a=g.useRef(null),i=Bi(Ld,e.__scopeMenu),s=wg(Ld,e.__scopeMenu),c=rt(t,a),l=g.useRef(!1),u=()=>{const d=a.current;if(!n&&d){const f=new CustomEvent(WN,{bubbles:!0,cancelable:!0});d.addEventListener(WN,h=>r==null?void 0:r(h),{once:!0}),Nwe(d,f),f.defaultPrevented?l.current=!1:i.onClose()}};return p.jsx(qN,{...o,ref:c,disabled:n,onClick:he(e.onClick,u),onPointerDown:d=>{var f;(f=e.onPointerDown)==null||f.call(e,d),l.current=!0},onPointerUp:he(e.onPointerUp,d=>{var f;l.current||((f=d.currentTarget)==null||f.click())}),onKeyDown:he(e.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||Dd.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Fd.displayName=Ld;var qN=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...a}=e,i=wg(Ld,n),s=yg(n),c=g.useRef(null),l=rt(t,c),[u,d]=g.useState(!1),[f,h]=g.useState("");return g.useEffect(()=>{const y=c.current;y&&h((y.textContent??"").trim())},[a.children]),p.jsx(Li.ItemSlot,{scope:n,disabled:r,textValue:o??f,children:p.jsx(ic,{asChild:!0,...s,focusable:!r,children:p.jsx(Oe.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...a,ref:l,onPointerMove:he(e.onPointerMove,Fc(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:he(e.onPointerLeave,Fc(y=>i.onItemLeave(y))),onFocus:he(e.onFocus,()=>d(!0)),onBlur:he(e.onBlur,()=>d(!1))})})})}),zW="MenuCheckboxItem",YN=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...o}=e;return p.jsx(GN,{scope:e.__scopeMenu,checked:n,children:p.jsx(Fd,{role:"menuitemcheckbox","aria-checked":Bd(n)?"mixed":n,...o,ref:t,"data-state":Cg(n),onSelect:he(o.onSelect,()=>r==null?void 0:r(Bd(n)?!0:!n),{checkForDefaultPrevented:!1})})})});YN.displayName=zW;var KN="MenuRadioGroup",[VW,UW]=Go(KN,{value:void 0,onValueChange:()=>{}}),XN=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...o}=e,a=Vo(r);return p.jsx(VW,{scope:e.__scopeMenu,value:n,onValueChange:a,children:p.jsx(jg,{...o,ref:t})})});XN.displayName=KN;var QN="MenuRadioItem",JN=g.forwardRef((e,t)=>{const{value:n,...r}=e,o=UW(QN,e.__scopeMenu),a=n===o.value;return p.jsx(GN,{scope:e.__scopeMenu,checked:a,children:p.jsx(Fd,{role:"menuitemradio","aria-checked":a,...r,ref:t,"data-state":Cg(a),onSelect:he(r.onSelect,()=>{var i;return(i=o.onValueChange)==null?void 0:i.call(o,n)},{checkForDefaultPrevented:!1})})})});JN.displayName=QN;var Eg="MenuItemIndicator",[GN,HW]=Go(Eg,{checked:!1}),ZN=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...o}=e,a=HW(Eg,n);return p.jsx(Mn,{present:r||Bd(a.checked)||a.checked===!0,children:p.jsx(Oe.span,{...o,ref:t,"data-state":Cg(a.checked)})})});ZN.displayName=Eg;var WW="MenuSeparator",eM=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Oe.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});eM.displayName=WW;var qW="MenuArrow",tM=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Fi(n);return p.jsx(kd,{...o,...r,ref:t})});tM.displayName=qW;var Sg="MenuSub",[YW,nM]=Go(Sg),rM=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:o}=e,a=lo(Sg,t),i=Fi(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=Vo(o);return g.useEffect(()=>(a.open===!1&&d(!1),()=>d(!1)),[a.open,d]),p.jsx(Mc,{...i,children:p.jsx(gg,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:p.jsx(YW,{scope:t,contentId:mt(),triggerId:mt(),trigger:s,onTriggerChange:c,children:n})})})};rM.displayName=Sg;var Lc="MenuSubTrigger",oM=g.forwardRef((e,t)=>{const n=lo(Lc,e.__scopeMenu),r=Bi(Lc,e.__scopeMenu),o=nM(Lc,e.__scopeMenu),a=wg(Lc,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=a,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),p.jsx(bg,{asChild:!0,...l,children:p.jsx(qN,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":sM(n.open),...e,ref:F9(t,o.onTriggerChange),onClick:d=>{var f;(f=e.onClick)==null||f.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:he(e.onPointerMove,Fc(d=>{a.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(a.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:he(e.onPointerLeave,Fc(d=>{var h,y;u();const f=(h=n.content)==null?void 0:h.getBoundingClientRect();if(f){const m=(y=n.content)==null?void 0:y.dataset.side,v=m==="right",b=v?-5:5,x=f[v?"left":"right"],_=f[v?"right":"left"];a.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x,y:f.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(d),d.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:he(e.onKeyDown,d=>{var h;const f=a.searchRef.current!=="";e.disabled||f&&d.key===" "||DN[r.dir].includes(d.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),d.preventDefault())})})})});oM.displayName=Lc;var aM="MenuSubContent",iM=g.forwardRef((e,t)=>{const n=zN(Wn,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,a=lo(Wn,e.__scopeMenu),i=Bi(Wn,e.__scopeMenu),s=nM(aM,e.__scopeMenu),c=g.useRef(null),l=rt(t,c);return p.jsx(Li.Provider,{scope:e.__scopeMenu,children:p.jsx(Mn,{present:r||a.open,children:p.jsx(Li.Slot,{scope:e.__scopeMenu,children:p.jsx(_g,{id:s.contentId,"aria-labelledby":s.triggerId,...o,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:he(e.onFocusOutside,u=>{u.target!==s.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:he(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:he(e.onKeyDown,u=>{var h;const d=u.currentTarget.contains(u.target),f=LN[i.dir].includes(u.key);d&&f&&(a.onOpenChange(!1),(h=s.trigger)==null||h.focus(),u.preventDefault())})})})})})});iM.displayName=aM;function sM(e){return e?"open":"closed"}function Bd(e){return e==="indeterminate"}function Cg(e){return Bd(e)?"indeterminate":e?"checked":"unchecked"}function KW(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function XW(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function QW(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let a=XW(e,Math.max(o,0));r.length===1&&(a=a.filter(s=>s!==n));const i=a.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function JW(e,t){const{x:n,y:r}=e;let o=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const s=t[a].x,c=t[a].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(o=!o)}return o}function GW(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return JW(n,t)}function Fc(e){return t=>t.pointerType==="mouse"?e(t):void 0}let $d,cM,ZW,Xt,lM,Og,Ng;_m=vg,cm=bg,wm=VN,lm=UN,um=jg,dm=HN,fm=Fd,pm=YN,hm=XN,mm=JN,ym=ZN,gm=eM,vm=tM,XE=rM,bm=oM,xm=iM,$d="DropdownMenu",[cM,ZW]=Vn($d,[Yu]),Xt=Yu(),[lM,Og]=cM($d),Ng=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:o,defaultOpen:a,onOpenChange:i,modal:s=!0}=e,c=Xt(t),l=g.useRef(null),[u=!1,d]=en({prop:o,defaultProp:a,onChange:i});return p.jsx(lM,{scope:t,triggerId:mt(),triggerRef:l,contentId:mt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(f=>!f),[d]),modal:s,children:p.jsx(_m,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})},Ng.displayName=$d;var uM="DropdownMenuTrigger",dM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=e,a=Og(uM,n),i=Xt(n);return p.jsx(cm,{asChild:!0,...i,children:p.jsx(Oe.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:F9(t,a.triggerRef),onPointerDown:he(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(a.onOpenToggle(),a.open||s.preventDefault())}),onKeyDown:he(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&a.onOpenToggle(),s.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});dM.displayName=uM;var eq="DropdownMenuPortal",fM=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Xt(t);return p.jsx(wm,{...r,...n})};fM.displayName=eq;var pM="DropdownMenuContent",hM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Og(pM,n),a=Xt(n),i=g.useRef(!1);return p.jsx(lm,{id:o.contentId,"aria-labelledby":o.triggerId,...a,...r,ref:t,onCloseAutoFocus:he(e.onCloseAutoFocus,s=>{var c;i.current||((c=o.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:he(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!o.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});hM.displayName=pM;var tq="DropdownMenuGroup",mM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(um,{...o,...r,ref:t})});mM.displayName=tq;var nq="DropdownMenuLabel",yM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(dm,{...o,...r,ref:t})});yM.displayName=nq;var rq="DropdownMenuItem",gM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(fm,{...o,...r,ref:t})});gM.displayName=rq;var oq="DropdownMenuCheckboxItem",vM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(pm,{...o,...r,ref:t})});vM.displayName=oq;var aq="DropdownMenuRadioGroup",bM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(hm,{...o,...r,ref:t})});bM.displayName=aq;var iq="DropdownMenuRadioItem",xM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(mm,{...o,...r,ref:t})});xM.displayName=iq;var sq="DropdownMenuItemIndicator",wM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(ym,{...o,...r,ref:t})});wM.displayName=sq;var cq="DropdownMenuSeparator",_M=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(gm,{...o,...r,ref:t})});_M.displayName=cq;var lq="DropdownMenuArrow",uq=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(vm,{...o,...r,ref:t})});uq.displayName=lq;var dq=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:o,defaultOpen:a}=e,i=Xt(t),[s=!1,c]=en({prop:r,defaultProp:a,onChange:o});return p.jsx(XE,{...i,open:s,onOpenChange:c,children:n})},fq="DropdownMenuSubTrigger",jM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(bm,{...o,...r,ref:t})});jM.displayName=fq;var pq="DropdownMenuSubContent",EM=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Xt(n);return p.jsx(xm,{...o,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});EM.displayName=pq,tS=Ng,nS=dM,eS=fM,Sm=hM,ZE=mM,Am=yM,Nm=gM,Mm=vM,J9=bM,Pm=xM,km=wM,Tm=_M,G9=dq,Cm=jM,Om=EM;const hq=tS,mq=nS,yq=ZE,gq=g.forwardRef(({className:e,inset:t,children:n,...r},o)=>p.jsxs(Cm,{ref:o,className:K("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,p.jsx(le,{name:"chevron-right",className:"ml-auto"})]}));gq.displayName=Cm.displayName;const vq=g.forwardRef(({className:e,...t},n)=>p.jsx(Om,{ref:n,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));vq.displayName=Om.displayName;const SM=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>p.jsx(eS,{children:p.jsx(Sm,{ref:r,sideOffset:t,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));SM.displayName=Sm.displayName;const CM=g.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(Nm,{ref:r,className:K("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));CM.displayName=Nm.displayName;const bq=g.forwardRef(({className:e,children:t,checked:n,...r},o)=>p.jsxs(Mm,{ref:o,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(km,{children:p.jsx(le,{name:"check",className:"h-4 w-4"})})}),t]}));bq.displayName=Mm.displayName;const xq=g.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(Pm,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(km,{children:p.jsx(le,{name:"circle",className:"h-4 w-4"})})}),t]}));xq.displayName=Pm.displayName;const wq=g.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(Am,{ref:r,className:K("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));wq.displayName=Am.displayName;const _q=g.forwardRef(({className:e,...t},n)=>p.jsx(Tm,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));_q.displayName=Tm.displayName;function jq(){const{t:e}=Me("sidebar"),{isMobile:t}=Tc();return p.jsx(Ti,{children:p.jsx(io,{children:p.jsxs(hq,{children:[p.jsx(mq,{asChild:!0,children:p.jsxs(so,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[p.jsx("div",{children:p.jsx(le,{name:"settings",size:28,className:"pr-2"})}),p.jsx(le,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),p.jsx(SM,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:p.jsx(yq,{children:p.jsxs(CM,{children:[p.jsx(le,{name:"sparkles"}),e("contact")]})})})]})})})}const Eq=Jr("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function tn({className:e,variant:t,...n}){return p.jsx("div",{className:K(Eq({variant:t}),e),...n})}function Sq({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Me("sidebar"),o=ji(),a=Kt(SN),i=g.useCallback((l,u)=>{l.preventDefault(),l.stopPropagation(),a.show({id:u})},[a]),s=l=>{n(l),o(In("application",{applicationId:l.id}))},c=l=>{switch(l.main_source_type){case"Thread":return p.jsx(tn,{className:"ml-1",color:"blue",children:r("application_types.chat")});default:return null}};return p.jsxs(Rc,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[p.jsx(Ic,{children:p.jsx("div",{className:"text-sm",children:r("applications")})}),p.jsxs(Ti,{children:[e==null?void 0:e.map(l=>p.jsx(io,{className:"cursor-pointer",children:p.jsx(so,{asChild:!0,onClick:()=>s(l),children:p.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[p.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===l.id?p.jsx(le,{size:16,color:"green",name:"check"}):p.jsx(le,{size:16,name:"chevron-right"}),p.jsxs("span",{children:[l.name,c(l)]})]}),p.jsx(le,{onClick:u=>i(u,l.id),size:16,className:"!z-50",name:"trash-2"})]})})},l.id)),e?p.jsx(io,{children:p.jsxs(so,{className:"text-sidebar-foreground/70",children:[p.jsx(le,{name:"ellipsis",className:"text-sidebar-foreground/70"}),p.jsx("span",{children:r("more_session")})]})}):null]})]})}const Cq={navMain:[{title:"playground.title",icon:p.jsx(le,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.drag_and_drop"},{title:"playground.node_connections"},{title:"playground.delete_nodes"}]},{title:"model.title",url:"#",icon:p.jsx(le,{name:"bot"}),items:[{title:"model.llm"},{title:"model.embedding"}]},{title:"tutorial.title",icon:p.jsx(le,{name:"book-open"}),items:[{title:"tutorial.get_started"},{title:"tutorial.chat_with_llm"},{title:"tutorial.ai_structured_output"},{title:"tutorial.tool_calling"},{title:"tutorial.few_shot_example"},{title:"tutorial.vector_database"}]},{title:"application.title",icon:p.jsx(le,{name:"settings-2"}),items:[{title:"application.changelog"}]}]};function Oq({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...o}){return p.jsxs(eg,{collapsible:"icon",...o,children:[p.jsx("div",{className:"h-1"}),p.jsxs(ng,{children:[p.jsx(SW,{sessions:e||[],currentSession:n,setCurrentSession:r}),p.jsx(Sq,{applications:t||[],currentSession:n,setCurrentSession:r}),p.jsx(aW,{items:Cq.navMain})]}),p.jsx(nN,{children:p.jsx(jq,{})}),p.jsx(tN,{})]})}wn=g.memo(e=>{const{loading:t,...n}=e;return p.jsx(at,{...n,disabled:e.disabled||t,children:t?p.jsx(le,{name:"loader-circle",className:"animate-spin"}):e.children})});function Nq({className:e,onProcess:t=async()=>(await new Promise(o=>setTimeout(o,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[o,a]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(o){const f=Date.now(),h=setInterval(()=>{const y=(Date.now()-f)/n*100;y>=100?(clearInterval(h),u(100)):u(y)},10);return()=>clearInterval(h)}},[o,n]);async function d(){if(o)return;a(!0),s(null),u(0),await new Promise(h=>setTimeout(h,n));const f=t?await t():!0;s(f),a(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return p.jsx(at,{className:K("relative group","transition-all duration-300",o&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:o,...r,children:p.jsx("div",{className:K("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?p.jsx(p.Fragment,{children:p.jsx(le,{name:"hard-drive-download",className:K("w-4 h-4 transition-transform duration-200","group-hover:scale-110",o&&"animate-bounce")})}):i?p.jsx(p.Fragment,{children:p.jsx(le,{name:"check",className:"w-4 h-4 text-green-500"})}):p.jsx(p.Fragment,{children:p.jsx(le,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const Dr="NOLLM",Mq="0123456789abcdef",kq=[8,4,4,4,12];function Bc(){return kq.map(e=>Mwe(Mq,e)()).join("-")}const Pq=()=>{const e=Je(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(B9).filter(c=>c!=="Session");await Promise.all(r.map(c=>ce(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${Bc()}]`});let o=JSON.stringify({[Dr]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{o=o.replace(new RegExp(c,"g"),n[c])}),o=o.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const a=new Blob([o],{type:"application/json"}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},Aq=()=>{const[e,t]=g.useState(!1),n=ji(),r=g.useCallback(async o=>{try{t(!0);const a=Object.keys(B9).filter(d=>d!==Dr);if(!Object.keys(o[Dr]).length||typeof o[Dr]!="object")throw new Error("Missing Metadata");if(!("session"in o[Dr])||!o[Dr].session)throw new Error("Missing Session Metadata");const i=o[Dr].session;if(!("ids"in o[Dr]))throw new Error("Missing Session ID");const s=o[Dr].ids,c=s.reduce((d,f)=>(d[f]=Bc(),d),{}),l=Object.keys(o).filter(d=>d!==Dr);if(!l.every(d=>a.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(f=>{if("session_id"in f&&f.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await ce("Session").save({...i,id:void 0});if(!u)throw new Error("Failed to import session");await Promise.all(a.map(d=>{const f=o[d];if(!f||!f.length)return Promise.resolve();const h=f.map(y=>{const m=y;return Object.keys(m).reduce((v,b)=>(m[b]&&typeof m[b]=="string"&&s.includes(m[b])?v[b]=c[m[b]]:b==="session_id"?v[b]=u.id:v[b]=m[b],v),{})});return ce(d).save(h)})),u.type===Zs.Whiteboard?n(`/whiteboard/${u.id}`):u.type===Zs.StandaloneApp&&n(`/application/${u.id}`)}finally{t(!1)}},[n]);return{loading:e,importSession:r}};function Tq(){const{t:e}=Me("tooltips"),t=kr(),n=$u(f=>f.setTheme),r=$u(f=>f.theme),{exportSession:o}=Pq(),{loading:a,importSession:i}=Aq(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await o(),!0}catch(f){return Yh(f),!1}},[o]),u=g.useCallback(async f=>{var h;try{const y=(h=f.target.files)==null?void 0:h[0];if(!y)return;const m=await new Promise((v,b)=>{const x=new FileReader;x.onload=_=>{var w;try{const j=(w=_.target)==null?void 0:w.result;v(JSON.parse(j))}catch(j){b(j)}},x.onerror=_=>{b(_)},x.readAsText(y)});await i(m)}catch(y){return Yh(y),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(In("whiteboard")))return e("whiteboard");if(t.pathname.includes(In("application")))return e("apllication")},[t.pathname,e]);return p.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2 px-4",children:[p.jsx(eN,{}),p.jsx(Qe,{children:d})]}),p.jsx("div",{className:"flex items-center pl-4 pr-2",children:p.jsxs(Ac,{children:[p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsxs(wn,{loading:a,variant:"ghost",onClick:()=>{var f;return(f=s.current)==null?void 0:f.click()},children:[p.jsx(le,{size:18,name:"hard-drive-upload"}),p.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),p.jsx(ur,{children:p.jsx("p",{children:e("import")})})]}),p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(Nq,{onProcess:l})}),p.jsx(ur,{children:p.jsx("p",{children:e("export")})})]}),p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(at,{disabled:a,onClick:c,variant:"ghost",children:p.jsx(le,{size:18,name:r==="dark"?"moon":"sun"})})}),p.jsx(ur,{children:p.jsx("p",{children:e("theme")})})]}),p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(at,{variant:"link",children:p.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:p.jsx(le,{size:18,name:"github"})})})}),p.jsx(ur,{children:p.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function Rq(){const e=p7(),t=ji(),n=kr(),r=g.useRef(n),o=Je(c=>c.currentSession),a=Je(c=>c.sessions),i=Je(c=>c.applications),s=Je(c=>c.setCurrentSession);return r.current=n,g.useEffect(()=>{o!=null&&o.id&&(n.pathname.includes(In("whiteboard"))?e.sessionId?e.sessionId&&e.sessionId!==(o==null?void 0:o.id)&&s(e.sessionId):t(In("whiteboard",{sessionId:o==null?void 0:o.id})):n.pathname.includes(In("application"))&&(e.applicationId?e.applicationId&&e.applicationId!==(o==null?void 0:o.id)&&s(e.applicationId):t(In("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,n.pathname,t,e.applicationId,e.sessionId,s]),g.useEffect(()=>{s(e.sessionId||e.applicationId).then(c=>{sW().has("flow")&&c.type===Zs.StandaloneApp||(c.type===Zs.StandaloneApp&&r.current.pathname.includes(In("whiteboard").replace("/",""))?t(In("application",{applicationId:c.id})):c.type===Zs.Whiteboard&&r.current.pathname.includes(In("application").replace("/",""))&&t(In("whiteboard",{sessionId:c.id})))})},[t,e.applicationId,e.sessionId,s]),p.jsxs(Zy,{defaultOpen:!1,children:[p.jsx(Oq,{sessions:a,applications:i,currentSession:o,setCurrentSession:s}),p.jsxs(tg,{className:"max-h-screen overflow-hidden",children:[p.jsx(Tq,{}),p.jsx(jc,{className:"shrink-0"}),p.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:p.jsx(k7,{})})]})]})}const OM=g.forwardRef(({className:e,children:t,...n},r)=>p.jsx("div",{className:K("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));OM.displayName="ChatMessageList";var NM="vercel.ai.error",Iq=Symbol.for(NM),MM,Dq=class nz extends Error{constructor({name:t,message:n,cause:r}){super(n),this[MM]=!0,this.name=t,this.cause=r}static isInstance(t){return nz.hasMarker(t,NM)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};MM=Iq;var $i=Dq;function kM(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var PM="AI_InvalidArgumentError",AM=`vercel.ai.error.${PM}`,Lq=Symbol.for(AM),TM,Fq=class extends $i{constructor({message:e,cause:t,argument:n}){super({name:PM,message:e,cause:t}),this[TM]=!0,this.argument=n}static isInstance(e){return $i.hasMarker(e,AM)}};TM=Lq;var RM="AI_JSONParseError",IM=`vercel.ai.error.${RM}`,Bq=Symbol.for(IM),DM,LM=class extends $i{constructor({text:e,cause:t}){super({name:RM,message:`JSON parsing failed: Text: ${e}.
Error message: ${kM(t)}`,cause:t}),this[DM]=!0,this.text=e}static isInstance(e){return $i.hasMarker(e,IM)}};DM=Bq;var FM="AI_TypeValidationError",BM=`vercel.ai.error.${FM}`,$q=Symbol.for(BM),$M,zq=class ES extends $i{constructor({value:t,cause:n}){super({name:FM,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${kM(n)}`,cause:n}),this[$M]=!0,this.value=t}static isInstance(t){return $i.hasMarker(t,BM)}static wrap({value:t,cause:n}){return ES.isInstance(n)&&n.value===t?n:new ES({value:t,cause:n})}};$M=$q;var zM=zq;let Vq=(e,t=21)=>(n=t)=>{let r="",o=n;for(;o--;)r+=e[Math.random()*e.length|0];return r};var Aa={exports:{}},VM;function Uq(){if(VM)return Aa.exports;VM=1;const e=typeof Kh<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&Kh.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",f=l&&l.constructorAction||"error";if(d==="ignore"&&f==="ignore")return u;if(d!=="ignore"&&f!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&f==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return o(u,{protoAction:d,constructorAction:f,safe:l&&l.safe})}function o(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const f=d;d=[];for(const h of f){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(h,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete h.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(h,"constructor")&&Object.prototype.hasOwnProperty.call(h.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete h.constructor}for(const y in h){const m=h[y];m&&typeof m=="object"&&d.push(m)}}}return s}function a(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return Aa.exports=a,Aa.exports.default=a,Aa.exports.parse=a,Aa.exports.safeParse=i,Aa.exports.scan=o,Aa.exports}var Hq=Uq();const Wq=Xe(Hq);var qq=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const o=Vq(n,t);if(e==null)return o;if(n.includes(r))throw new Fq({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return a=>`${e}${r}${o(a)}`},UM=qq(),Mg=Symbol.for("vercel.ai.validator");function Yq(e){return{[Mg]:!0,validate:e}}function Kq(e){return typeof e=="object"&&e!==null&&Mg in e&&e[Mg]===!0&&"validate"in e}function Xq(e){return Kq(e)?e:Qq(e)}function Qq(e){return Yq(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function Jq({value:e,schema:t}){const n=Xq(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:zM.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:zM.wrap({value:e,cause:r})}}}function HM({text:e,schema:t}){try{const n=Wq.parse(e);return t==null?{success:!0,value:n}:Jq({value:n,schema:t})}catch(n){return{success:!1,error:LM.isInstance(n)?n:new LM({text:e,cause:n})}}}var zd={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Vd={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Ud={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Hd={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Wd={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Gq=[zd,Vd,Ud,Hd,Wd];zd.code+"",Vd.code+"",Ud.code+"",Hd.code+"",Wd.code+"",zd.name+"",zd.code,Vd.name+"",Vd.code,Ud.name+"",Ud.code,Hd.name+"",Hd.code,Wd.name+"",Wd.code,Gq.map(e=>e.code);function Zq(e){const t=["ROOT"];let n=-1,r=null;function o(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function a(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":o(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{o(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{a(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,o(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{o(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&a(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&a(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?a(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function eY(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=HM({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=HM({text:Zq(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var $c={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},zc={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Vc={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Uc={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Hc={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Wc={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},qc={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Yc={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Kc={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Xc={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},tY=[$c,zc,Vc,Uc,Hc,Wc,qc,Yc,Kc,Xc],nY={[$c.code]:$c,[zc.code]:zc,[Vc.code]:Vc,[Uc.code]:Uc,[Hc.code]:Hc,[Wc.code]:Wc,[qc.code]:qc,[Yc.code]:Yc,[Kc.code]:Kc,[Xc.code]:Xc};$c.name+"",$c.code,zc.name+"",zc.code,Vc.name+"",Vc.code,Uc.name+"",Uc.code,Hc.name+"",Hc.code,Wc.name+"",Wc.code,qc.name+"",qc.code,Yc.name+"",Yc.code,Kc.name+"",Kc.code,Xc.name+"",Xc.code;var rY=tY.map(e=>e.code),oY=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!rY.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,o=e.slice(t+1),a=JSON.parse(o);return nY[r].parse(a)},aY=10;function iY(e,t){const n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return e.length=0,n}async function sY({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:o,onToolCallDeltaPart:a,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),f=new TextDecoder,h=[];let y=0;for(;;){const{value:m}=await d.read();if(m&&(h.push(m),y+=m.length,m[m.length-1]!==aY))continue;if(h.length===0)break;const v=iY(h,y);y=0;const b=f.decode(v,{stream:!0}).split(`
`).filter(x=>x!=="").map(oY);for(const{type:x,value:_}of b)switch(x){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(o==null?void 0:o(_));break;case"tool_call_delta":await(a==null?void 0:a(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const w=x;throw new Error(`Unknown stream part type: ${w}`)}}}}function cY({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function lY({stream:e,update:t,onToolCall:n,onFinish:r,generateId:o=UM,getCurrentDate:a=()=>new Date}){const i=a();let s,c=!0;const l=[],u=[];let d;const f={};let h={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},y="unknown";function m(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const x={...JSON.parse(JSON.stringify(s)),revisionId:o()};t([...l,x],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:o(),role:"assistant",content:"",createdAt:i}),s}await sY({stream:e,onTextPart(b){const x=v();s={...x,content:x.content+b},m()},onToolCallStreamingStartPart(b){const x=v();x.toolInvocations==null&&(x.toolInvocations=[]),f[b.toolCallId]={text:"",toolName:b.toolName,index:x.toolInvocations.length},x.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),m()},onToolCallDeltaPart(b){const x=v(),_=f[b.toolCallId];_.text+=b.argsTextDelta;const{value:w}=eY(_.text);x.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:w},m()},async onToolCallPart(b){const x=v();if(f[b.toolCallId]!=null?x.toolInvocations[f[b.toolCallId].index]={state:"call",...b}:(x.toolInvocations==null&&(x.toolInvocations=[]),x.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(x.toolInvocations[x.toolInvocations.length-1]={state:"result",...b,result:_})}m()},onToolResultPart(b){const x=v().toolInvocations;if(x==null)throw new Error("tool_result must be preceded by a tool_call");const _=x.findIndex(w=>w.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");x[_]={...x[_],state:"result",...b},m()},onDataPart(b){u.push(...b),m()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),m()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){y=b.finishReason,b.usage!=null&&(h=cY(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:y,usage:h})}async function uY({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:o}=await n.read();if(r)break;await t(o)}}var dY=()=>fetch;async function fY({api:e,body:t,streamProtocol:n="data",credentials:r,headers:o,abortController:a,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:f=dY()}){var h,y;const m=await f(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...o},signal:(h=a==null?void 0:a())==null?void 0:h.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(m)}catch(v){throw v}if(!m.ok)throw i(),new Error((y=await m.text())!=null?y:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await uY({stream:m.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await lY({stream:m.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:x}){l&&v!=null&&l(v,{usage:x,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var WM={exports:{}},kg={},qM;function pY(){if(qM)return kg;qM=1;var e=$9();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,o=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function s(d,f){var h=f(),y=r({inst:{value:h,getSnapshot:f}}),m=y[0].inst,v=y[1];return a(function(){m.value=h,m.getSnapshot=f,c(m)&&v({inst:m})},[d,h,f]),o(function(){return c(m)&&v({inst:m}),d(function(){c(m)&&v({inst:m})})},[d]),i(h),h}function c(d){var f=d.getSnapshot;d=d.value;try{var h=f();return!n(d,h)}catch{return!0}}function l(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return kg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,kg}var YM;function KM(){return YM||(YM=1,WM.exports=pY()),WM.exports}Ku=KM();let uo,fn,qd,Ge,dr,fo,XM,Qc;ez=Xe(Ku),uo=()=>{},fn=uo(),qd=Object,Ge=e=>e===fn,dr=e=>typeof e=="function",fo=(e,t)=>({...e,...t}),XM=e=>dr(e.then),Qc=new WeakMap;let hY=0;const Jc=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let o,a;if(qd(e)===e&&!r&&n!=RegExp){if(o=Qc.get(e),o)return o;if(o=++hY+"~",Qc.set(e,o),n==Array){for(o="@",a=0;a<e.length;a++)o+=Jc(e[a])+",";Qc.set(e,o)}if(n==qd){o="#";const i=qd.keys(e).sort();for(;!Ge(a=i.pop());)Ge(e[a])||(o+=a+":"+Jc(e[a])+",");Qc.set(e,o)}}else o=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return o},po=new WeakMap,Pg={},Yd={},Ag="undefined",Kd=typeof window!=Ag,Tg=typeof document!=Ag,mY=()=>Kd&&typeof window.requestAnimationFrame!=Ag,QM=(e,t)=>{const n=po.get(e);return[()=>!Ge(t)&&e.get(t)||Pg,r=>{if(!Ge(t)){const o=e.get(t);t in Yd||(Yd[t]=o),n[5](t,fo(o,r),o||Pg)}},n[6],()=>!Ge(t)&&t in Yd?Yd[t]:!Ge(t)&&e.get(t)||Pg]};let Rg=!0;const yY=()=>Rg,[Ig,Dg]=Kd&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[uo,uo],gY=()=>{const e=Tg&&document.visibilityState;return Ge(e)||e!=="hidden"},vY=e=>(Tg&&document.addEventListener("visibilitychange",e),Ig("focus",e),()=>{Tg&&document.removeEventListener("visibilitychange",e),Dg("focus",e)}),bY=e=>{const t=()=>{Rg=!0,e()},n=()=>{Rg=!1};return Ig("online",t),Ig("offline",n),()=>{Dg("online",t),Dg("offline",n)}},xY={isOnline:yY,isVisible:gY},wY={initFocus:vY,initReconnect:bY},JM=!V.useId,Gc=!Kd||"Deno"in window,_Y=e=>mY()?window.requestAnimationFrame(e):setTimeout(e,1),Lg=Gc?g.useEffect:g.useLayoutEffect,Fg=typeof navigator<"u"&&navigator.connection,GM=!Gc&&Fg&&(["slow-2g","2g"].includes(Fg.effectiveType)||Fg.saveData),Bg=e=>{if(dr(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Jc(e):"",[e,t]};let jY=0;const $g=()=>++jY,ZM=0,ek=1,tk=2;var Zc={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:ZM,MUTATE_EVENT:tk,RECONNECT_EVENT:ek};async function nk(...e){const[t,n,r,o]=e,a=fo({populateCache:!0,throwOnError:!0},typeof o=="boolean"?{revalidate:o}:o||{});let i=a.populateCache;const s=a.rollbackOnError;let c=a.optimisticData;const l=f=>typeof s=="function"?s(f):s!==!1,u=a.throwOnError;if(dr(n)){const f=n,h=[],y=t.keys();for(const m of y)!/^\$(inf|sub)\$/.test(m)&&f(t.get(m)._k)&&h.push(m);return Promise.all(h.map(d))}return d(n);async function d(f){const[h]=Bg(f);if(!h)return;const[y,m]=QM(t,h),[v,b,x,_]=po.get(t),w=()=>{const A=v[h];return(dr(a.revalidate)?a.revalidate(y().data,f):a.revalidate!==!1)&&(delete x[h],delete _[h],A&&A[0])?A[0](tk).then(()=>y().data):y().data};if(e.length<3)return w();let j=r,E;const S=$g();b[h]=[S,0];const O=!Ge(c),k=y(),N=k.data,P=k._c,R=Ge(P)?N:P;if(O&&(c=dr(c)?c(R,N):c,m({data:c,_c:R})),dr(j))try{j=j(R)}catch(A){E=A}if(j&&XM(j))if(j=await j.catch(A=>{E=A}),S!==b[h][0]){if(E)throw E;return j}else E&&O&&l(E)&&(i=!0,m({data:R,_c:fn}));if(i&&!E)if(dr(i)){const A=i(j,R);m({data:A,error:fn,_c:fn})}else m({data:j,error:fn,_c:fn});if(b[h][1]=$g(),Promise.resolve(w()).then(()=>{m({_c:fn})}),E){if(u)throw E;return}return j}}const rk=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},EY=(e,t)=>{if(!po.has(e)){const n=fo(wY,t),r={},o=nk.bind(fn,e);let a=uo;const i={},s=(u,d)=>{const f=i[u]||[];return i[u]=f,f.push(d),()=>f.splice(f.indexOf(d),1)},c=(u,d,f)=>{e.set(u,d);const h=i[u];if(h)for(const y of h)y(d,f)},l=()=>{if(!po.has(e)&&(po.set(e,[r,{},{},{},o,c,s]),!Gc)){const u=n.initFocus(setTimeout.bind(fn,rk.bind(fn,r,ZM))),d=n.initReconnect(setTimeout.bind(fn,rk.bind(fn,r,ek)));a=()=>{u&&u(),d&&d(),po.delete(e)}}};return l(),[e,o,l,a]}return[e,po.get(e)[4]]},SY=(e,t,n,r,o)=>{const a=n.errorRetryCount,i=o.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!Ge(a)&&i>a||setTimeout(r,s,o)},CY=(e,t)=>Jc(e)==Jc(t),[ok,OY]=EY(new Map),NY=fo({onLoadingSlow:uo,onSuccess:uo,onError:uo,onErrorRetry:SY,onDiscarded:uo,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:GM?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:GM?5e3:3e3,compare:CY,isPaused:()=>!1,cache:ok,mutate:OY,fallback:{}},xY),MY=(e,t)=>{const n=fo(e,t);if(t){const{use:r,fallback:o}=e,{use:a,fallback:i}=t;r&&a&&(n.use=r.concat(a)),o&&i&&(n.fallback=fo(o,i))}return n},kY=g.createContext({}),PY="$inf$",ak=Kd&&window.__SWR_DEVTOOLS_USE__,AY=ak?window.__SWR_DEVTOOLS_USE__:[],TY=()=>{ak&&(window.__SWR_DEVTOOLS_REACT__=V)},RY=e=>dr(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],IY=()=>fo(NY,g.useContext(kY)),DY=e=>(t,n,r)=>e(t,n&&((...o)=>{const[a]=Bg(t),[,,,i]=po.get(ok);if(a.startsWith(PY))return n(...o);const s=i[a];return Ge(s)?n(...o):(delete i[a],s)}),r),LY=AY.concat(DY),FY=e=>function(...t){const n=IY(),[r,o,a]=RY(t),i=MY(n,a);let s=e;const{use:c}=i,l=(c||[]).concat(LY);for(let u=l.length;u--;)s=l[u](s);return s(r,o||i.fetcher||null,i)},BY=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o>=0&&(r[o]=r[r.length-1],r.pop())}};TY();const ik=V.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),zg={dedupe:!0},$Y=(e,t,n)=>{const{cache:r,compare:o,suspense:a,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:f}=n,[h,y,m,v]=po.get(r),[b,x]=Bg(e),_=g.useRef(!1),w=g.useRef(!1),j=g.useRef(b),E=g.useRef(t),S=g.useRef(n),O=()=>S.current,k=()=>O().isVisible()&&O().isOnline(),[N,P,R,A]=QM(r,b),C=g.useRef({}).current,M=Ge(i)?n.fallback[b]:i,T=($,se)=>{for(const ue in C){const ve=ue;if(ve==="data"){if(!o($[ve],se[ve])&&(!Ge($[ve])||!o(q,se[ve])))return!1}else if(se[ve]!==$[ve])return!1}return!0},D=g.useMemo(()=>{const $=!b||!t?!1:Ge(s)?O().isPaused()||a?!1:Ge(c)?!0:c:s,se=ze=>{const ct=fo(ze);return delete ct._k,$?{isValidating:!0,isLoading:!0,...ct}:ct},ue=N(),ve=A(),Te=se(ue),qe=ue===ve?Te:se(ve);let Ye=Te;return[()=>{const ze=se(N());return T(ze,Ye)?(Ye.data=ze.data,Ye.isLoading=ze.isLoading,Ye.isValidating=ze.isValidating,Ye.error=ze.error,Ye):(Ye=ze,ze)},()=>qe]},[r,b]),I=Ku.useSyncExternalStore(g.useCallback($=>R(b,(se,ue)=>{T(ue,se)||$()}),[r,b]),D[0],D[1]),L=!_.current,B=h[b]&&h[b].length>0,U=I.data,F=Ge(U)?M:U,H=I.error,J=g.useRef(F),q=f?Ge(U)?J.current:U:F,re=B&&!Ge(H)?!1:L&&!Ge(s)?s:O().isPaused()?!1:a?Ge(F)?!1:c:Ge(F)||c,Z=!!(b&&t&&L&&re),Y=Ge(I.isValidating)?Z:I.isValidating,W=Ge(I.isLoading)?Z:I.isLoading,G=g.useCallback(async $=>{const se=E.current;if(!b||!se||w.current||O().isPaused())return!1;let ue,ve,Te=!0;const qe=$||{},Ye=!m[b]||!qe.dedupe,ze=()=>JM?!w.current&&b===j.current&&_.current:b===j.current,ct={isValidating:!1,isLoading:!1},He=()=>{P(ct)},lt=()=>{const St=m[b];St&&St[1]===ve&&delete m[b]},Ht={isValidating:!0};Ge(N().data)&&(Ht.isLoading=!0);try{if(Ye&&(P(Ht),n.loadingTimeout&&Ge(N().data)&&setTimeout(()=>{Te&&ze()&&O().onLoadingSlow(b,n)},n.loadingTimeout),m[b]=[se(x),$g()]),[ue,ve]=m[b],ue=await ue,Ye&&setTimeout(lt,n.dedupingInterval),!m[b]||m[b][1]!==ve)return Ye&&ze()&&O().onDiscarded(b),!1;ct.error=fn;const St=y[b];if(!Ge(St)&&(ve<=St[0]||ve<=St[1]||St[1]===0))return He(),Ye&&ze()&&O().onDiscarded(b),!1;const yt=N().data;ct.data=o(yt,ue)?yt:ue,Ye&&ze()&&O().onSuccess(ue,b,n)}catch(St){lt();const yt=O(),{shouldRetryOnError:Rt}=yt;yt.isPaused()||(ct.error=St,Ye&&ze()&&(yt.onError(St,b,yt),(Rt===!0||dr(Rt)&&Rt(St))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||k())&&yt.onErrorRetry(St,b,yt,bn=>{const Sr=h[b];Sr&&Sr[0]&&Sr[0](Zc.ERROR_REVALIDATE_EVENT,bn)},{retryCount:(qe.retryCount||0)+1,dedupe:!0})))}return Te=!1,He(),!0},[b,r]),te=g.useCallback((...$)=>nk(r,j.current,...$),[]);if(Lg(()=>{E.current=t,S.current=n,Ge(U)||(J.current=U)}),Lg(()=>{if(!b)return;const $=G.bind(fn,zg);let se=0;const ue=BY(b,h,(ve,Te={})=>{if(ve==Zc.FOCUS_EVENT){const qe=Date.now();O().revalidateOnFocus&&qe>se&&k()&&(se=qe+O().focusThrottleInterval,$())}else if(ve==Zc.RECONNECT_EVENT)O().revalidateOnReconnect&&k()&&$();else{if(ve==Zc.MUTATE_EVENT)return G();if(ve==Zc.ERROR_REVALIDATE_EVENT)return G(Te)}});return w.current=!1,j.current=b,_.current=!0,P({_k:x}),re&&(Ge(F)||Gc?$():_Y($)),()=>{w.current=!0,ue()}},[b]),Lg(()=>{let $;function se(){const ve=dr(l)?l(N().data):l;ve&&$!==-1&&($=setTimeout(ue,ve))}function ue(){!N().error&&(u||O().isVisible())&&(d||O().isOnline())?G(zg).then(se):se()}return se(),()=>{$&&(clearTimeout($),$=-1)}},[l,u,d,b]),g.useDebugValue(q),a&&Ge(F)&&b){if(!JM&&Gc)throw new Error("Fallback data is required when using suspense in SSR.");E.current=t,S.current=n,w.current=!1;const $=v[b];if(!Ge($)){const se=te($);ik(se)}if(Ge(H)){const se=G(zg);Ge(q)||(se.status="fulfilled",se.value=!0),ik(se)}else throw H}return{mutate:te,get data(){return C.data=!0,q},get error(){return C.error=!0,H},get isValidating(){return C.isValidating=!0,Y},get isLoading(){return C.isLoading=!0,W}}},Xd=FY($Y);var Vg,sk;function zY(){if(sk)return Vg;sk=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,o=0;return function(...a){clearTimeout(r);const i=Date.now(),s=i-o,c=n-s;c<=0?(o=i,t.apply(this,a)):r=setTimeout(()=>{o=Date.now(),t.apply(this,a)},c)}}return Vg=e,Vg}var VY=zY();const UY=Xe(VY);function ck(e,t){return t!=null?UY(e,t):e}var HY=async(e,t,n,r,o,a,i,s,c,l,u,d,f,h,y,m,v)=>{var b;const x=i.current;n(t.messages,!1);const _=h?t.messages:t.messages.map(({role:j,content:E,experimental_attachments:S,data:O,annotations:k,toolInvocations:N})=>({role:j,content:E,...S!==void 0&&{experimental_attachments:S},...O!==void 0&&{data:O},...k!==void 0&&{annotations:k},...N!==void 0&&{toolInvocations:N}})),w=o.current;return await fY({api:e,body:(b=y==null?void 0:y({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...a.current.body,...t.body},streamProtocol:l,credentials:a.current.credentials,headers:{...a.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(x,!1)},onResponse:d,onUpdate(j,E){n([...t.messages,...j],!1),E!=null&&E.length&&r([...w??[],...E],!1)},onToolCall:f,onFinish:u,generateId:c,fetch:m})};function WY({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:o,onToolCall:a,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:f,headers:h,body:y,generateId:m=UM,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:x}={}){const _=g.useId(),w=t??_,j=typeof e=="string"?[e,w]:w,[E]=g.useState([]),{data:S,mutate:O}=Xd([j,"messages"],null,{fallbackData:n??E}),k=g.useRef(S||[]);g.useEffect(()=>{k.current=S||[]},[S]);const{data:N,mutate:P}=Xd([j,"streamData"],null),R=g.useRef(N);g.useEffect(()=>{R.current=N},[N]);const{data:A=!1,mutate:C}=Xd([j,"loading"],null),{data:M=void 0,mutate:T}=Xd([j,"error"],null),D=g.useRef(null),I=g.useRef({credentials:f,headers:h,body:y});g.useEffect(()=>{I.current={credentials:f,headers:h,body:y}},[f,h,y]);const L=g.useCallback(async Y=>{const W=k.current.length;try{C(!0),T(void 0);const $=new AbortController;D.current=$,await HY(e,Y,ck(O,x),ck(P,x),R,I,k,D,m,c,u,l,a,o,i,v,b),D.current=null}catch($){if($.name==="AbortError")return D.current=null,null;d&&$ instanceof Error&&d($),T($)}finally{C(!1)}const G=k.current,te=G[G.length-1];G.length>W&&te!=null&&s>1&&lk(te)&&qY(G)<s&&await L({messages:G})},[O,C,e,I,l,u,d,T,P,R,c,o,i,a,s,k,D,m,v,b,x]),B=g.useCallback(async(Y,{data:W,headers:G,body:te,experimental_attachments:$}={})=>{var se,ue;Y.id||(Y.id=m());const ve=await uk($),Te=k.current.concat({...Y,id:(se=Y.id)!=null?se:m(),createdAt:(ue=Y.createdAt)!=null?ue:new Date,experimental_attachments:ve.length>0?ve:void 0});return L({messages:Te,headers:G,body:te,data:W})},[L,m]),U=g.useCallback(async({data:Y,headers:W,body:G}={})=>{const te=k.current;if(te.length===0)return null;const $=te[te.length-1];return L({messages:$.role==="assistant"?te.slice(0,-1):te,headers:W,body:G,data:Y})},[L]),F=g.useCallback(()=>{D.current&&(D.current.abort(),D.current=null)},[]),H=g.useCallback(Y=>{typeof Y=="function"&&(Y=Y(k.current)),O(Y,!1),k.current=Y},[O]),J=g.useCallback(Y=>{typeof Y=="function"&&(Y=Y(R.current)),P(Y,!1),R.current=Y},[P]),[q,re]=g.useState(r),Z=g.useCallback(async(Y,W={},G)=>{var te;if((te=Y==null?void 0:Y.preventDefault)==null||te.call(Y),!q&&!W.allowEmptySubmit)return;G&&(I.current={...I.current,...G});const $=await uk(W.experimental_attachments),se={messages:!q&&!$.length&&W.allowEmptySubmit?k.current:k.current.concat({id:m(),createdAt:new Date,role:"user",content:q,experimental_attachments:$.length>0?$:void 0}),headers:W.headers,body:W.body,data:W.data};L(se),re("")},[q,m,L]);return{messages:S||[],setMessages:H,data:N,setData:J,error:M,append:B,reload:U,stop:F,input:q,setInput:re,handleInputChange:Y=>{re(Y.target.value)},handleSubmit:Z,isLoading:A,addToolResult:({toolCallId:Y,result:W})=>{const G=k.current.map(($,se,ue)=>se===ue.length-1&&$.role==="assistant"&&$.toolInvocations?{...$,toolInvocations:$.toolInvocations.map(ve=>ve.toolCallId===Y?{...ve,result:W,state:"result"}:ve)}:$);O(G,!1);const te=G[G.length-1];lk(te)&&L({messages:G})}}}function lk(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function qY(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function uk(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,o=await new Promise((a,i)=>{const s=new FileReader;s.onload=c=>{var l;a((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:o}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}cS=WY;const ho=g.forwardRef(({className:e,...t},n)=>p.jsx("textarea",{className:K("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));ho.displayName="Textarea";function YY({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(o=>{const a=n.current;if(!a)return;if(o){a.style.height=`${e}px`;return}a.style.height=`${e}px`;const i=Math.max(e,Math.min(a.scrollHeight,t??Number.POSITIVE_INFINITY));a.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const o=n.current;o&&(o.style.height=`${e}px`)},[e]),g.useEffect(()=>{const o=()=>r();return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[r]),{textareaRef:n,adjustHeight:r}}const KY=48,dk=164;function fk({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:o,minHeight:a,maxHeight:i,className:s,onChange:c,value:l}){const[u,d]=g.useState(!1),[f,h]=g.useState(""),{textareaRef:y,adjustHeight:m}=YY({minHeight:a||KY,maxHeight:i||dk}),[v,b]=g.useState(!0),x=async _=>{try{d(!0),await e(f,_)}finally{d(!1)}};return p.jsx("div",{className:K("w-full py-4 max-w-xl",s),children:p.jsx("div",{className:"relative w-full mx-auto",children:p.jsxs("div",{className:"relative flex flex-col",children:[p.jsx("div",{className:"overflow-y-auto",style:{maxHeight:`${i||dk}px`},children:p.jsx(ho,{id:"ai-input-04",value:(c?l:f)||"",disabled:t||u,placeholder:o,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:y,onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),x(_))},onChange:_=>{c||h(_.target.value),m(),c==null||c(_)}})}),p.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[p.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?p.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[p.jsx("input",{type:"file",className:"hidden"}),p.jsx(le,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?p.jsxs("button",{type:"button",onClick:()=>{b(!v)},className:K("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",v?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[p.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:p.jsx(Bu.div,{animate:{rotate:v?180:0,scale:v?1.1:1},whileHover:{rotate:v?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:p.jsx(le,{name:"globe",className:K("w-4 h-4",v?"text-sky-500":"text-inherit")})})}),p.jsx(sz,{children:v&&p.jsx(Bu.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),p.jsx("div",{className:"absolute right-3 bottom-3",children:p.jsx("button",{type:"button",disabled:t||u,onClick:_=>{x(_)},className:K("rounded-lg p-2",c&&l||f?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:p.jsx(le,{name:"send",className:"w-4 h-4"})})})]})]})})})}var Ug,pk;function XY(){if(pk)return Ug;pk=1;function e(){this.__data__=[],this.size=0}return Ug=e,Ug}var Hg,hk;rc=function(){if(hk)return Hg;hk=1;function e(t,n){return t===n||t!==t&&n!==n}return Hg=e,Hg};var Wg,mk;function Qd(){if(mk)return Wg;mk=1;var e=rc();function t(n,r){for(var o=n.length;o--;)if(e(n[o][0],r))return o;return-1}return Wg=t,Wg}var qg,yk;function QY(){if(yk)return qg;yk=1;var e=Qd(),t=Array.prototype,n=t.splice;function r(o){var a=this.__data__,i=e(a,o);if(i<0)return!1;var s=a.length-1;return i==s?a.pop():n.call(a,i,1),--this.size,!0}return qg=r,qg}var Yg,gk;function JY(){if(gk)return Yg;gk=1;var e=Qd();function t(n){var r=this.__data__,o=e(r,n);return o<0?void 0:r[o][1]}return Yg=t,Yg}var Kg,vk;function GY(){if(vk)return Kg;vk=1;var e=Qd();function t(n){return e(this.__data__,n)>-1}return Kg=t,Kg}var Xg,bk;function ZY(){if(bk)return Xg;bk=1;var e=Qd();function t(n,r){var o=this.__data__,a=e(o,n);return a<0?(++this.size,o.push([n,r])):o[a][1]=r,this}return Xg=t,Xg}var Qg,xk;function Jd(){if(xk)return Qg;xk=1;var e=XY(),t=QY(),n=JY(),r=GY(),o=ZY();function a(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=o,Qg=a,Qg}var Jg,wk;function eK(){if(wk)return Jg;wk=1;var e=Jd();function t(){this.__data__=new e,this.size=0}return Jg=t,Jg}var Gg,_k;function tK(){if(_k)return Gg;_k=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Gg=e,Gg}var Zg,jk;function nK(){if(jk)return Zg;jk=1;function e(t){return this.__data__.get(t)}return Zg=e,Zg}var ev,Ek;function rK(){if(Ek)return ev;Ek=1;function e(t){return this.__data__.has(t)}return ev=e,ev}var tv,Sk;function Ck(){if(Sk)return tv;Sk=1;var e=typeof ec=="object"&&ec&&ec.Object===Object&&ec;return tv=e,tv}var nv,Ok;nr=function(){if(Ok)return nv;Ok=1;var e=Ck(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return nv=n,nv};var rv,Nk;gi=function(){if(Nk)return rv;Nk=1;var e=nr(),t=e.Symbol;return rv=t,rv};var ov,Mk;function oK(){if(Mk)return ov;Mk=1;var e=gi(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,o=e?e.toStringTag:void 0;function a(i){var s=n.call(i,o),c=i[o];try{i[o]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[o]=c:delete i[o]),u}return ov=a,ov}var av,kk;function aK(){if(kk)return av;kk=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return av=n,av}var iv,Pk;function mo(){if(Pk)return iv;Pk=1;var e=gi(),t=oK(),n=aK(),r="[object Null]",o="[object Undefined]",a=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?o:r:a&&a in Object(s)?t(s):n(s)}return iv=i,iv}var sv,Ak;rr=function(){if(Ak)return sv;Ak=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return sv=e,sv};var cv,Tk;qu=function(){if(Tk)return cv;Tk=1;var e=mo(),t=rr(),n="[object AsyncFunction]",r="[object Function]",o="[object GeneratorFunction]",a="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==o||c==n||c==a}return cv=i,cv};var lv,Rk;function iK(){if(Rk)return lv;Rk=1;var e=nr(),t=e["__core-js_shared__"];return lv=t,lv}var uv,Ik;function sK(){if(Ik)return uv;Ik=1;var e=iK(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return uv=n,uv}var dv,Dk;function Lk(){if(Dk)return dv;Dk=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return dv=n,dv}var fv,Fk;function cK(){if(Fk)return fv;Fk=1;var e=qu(),t=sK(),n=rr(),r=Lk(),o=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!n(f)||t(f))return!1;var h=e(f)?u:a;return h.test(r(f))}return fv=d,fv}var pv,Bk;function lK(){if(Bk)return pv;Bk=1;function e(t,n){return t==null?void 0:t[n]}return pv=e,pv}var hv,$k;function Ta(){if($k)return hv;$k=1;var e=cK(),t=lK();function n(r,o){var a=t(r,o);return e(a)?a:void 0}return hv=n,hv}var mv,zk;function yv(){if(zk)return mv;zk=1;var e=Ta(),t=nr(),n=e(t,"Map");return mv=n,mv}var gv,Vk;function Gd(){if(Vk)return gv;Vk=1;var e=Ta(),t=e(Object,"create");return gv=t,gv}var vv,Uk;function uK(){if(Uk)return vv;Uk=1;var e=Gd();function t(){this.__data__=e?e(null):{},this.size=0}return vv=t,vv}var bv,Hk;function dK(){if(Hk)return bv;Hk=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return bv=e,bv}var xv,Wk;function fK(){if(Wk)return xv;Wk=1;var e=Gd(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function o(a){var i=this.__data__;if(e){var s=i[a];return s===t?void 0:s}return r.call(i,a)?i[a]:void 0}return xv=o,xv}var wv,qk;function pK(){if(qk)return wv;qk=1;var e=Gd(),t=Object.prototype,n=t.hasOwnProperty;function r(o){var a=this.__data__;return e?a[o]!==void 0:n.call(a,o)}return wv=r,wv}var _v,Yk;function hK(){if(Yk)return _v;Yk=1;var e=Gd(),t="__lodash_hash_undefined__";function n(r,o){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=e&&o===void 0?t:o,this}return _v=n,_v}var jv,Kk;function mK(){if(Kk)return jv;Kk=1;var e=uK(),t=dK(),n=fK(),r=pK(),o=hK();function a(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=o,jv=a,jv}var Ev,Xk;function yK(){if(Xk)return Ev;Xk=1;var e=mK(),t=Jd(),n=yv();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Ev=r,Ev}var Sv,Qk;function gK(){if(Qk)return Sv;Qk=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Sv=e,Sv}var Cv,Jk;function Zd(){if(Jk)return Cv;Jk=1;var e=gK();function t(n,r){var o=n.__data__;return e(r)?o[typeof r=="string"?"string":"hash"]:o.map}return Cv=t,Cv}var Ov,Gk;function vK(){if(Gk)return Ov;Gk=1;var e=Zd();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return Ov=t,Ov}var Nv,Zk;function bK(){if(Zk)return Nv;Zk=1;var e=Zd();function t(n){return e(this,n).get(n)}return Nv=t,Nv}var Mv,eP;function xK(){if(eP)return Mv;eP=1;var e=Zd();function t(n){return e(this,n).has(n)}return Mv=t,Mv}var kv,tP;function wK(){if(tP)return kv;tP=1;var e=Zd();function t(n,r){var o=e(this,n),a=o.size;return o.set(n,r),this.size+=o.size==a?0:1,this}return kv=t,kv}var Pv,nP;function Av(){if(nP)return Pv;nP=1;var e=yK(),t=vK(),n=bK(),r=xK(),o=wK();function a(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=o,Pv=a,Pv}var Tv,rP;function _K(){if(rP)return Tv;rP=1;var e=Jd(),t=yv(),n=Av(),r=200;function o(a,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([a,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(a,i),this.size=s.size,this}return Tv=o,Tv}var Rv,oP;Xm=function(){if(oP)return Rv;oP=1;var e=Jd(),t=eK(),n=tK(),r=nK(),o=rK(),a=_K();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=o,i.prototype.set=a,Rv=i,Rv};var Iv,aP;function jK(){if(aP)return Iv;aP=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return Iv=t,Iv}var Dv,iP;function EK(){if(iP)return Dv;iP=1;function e(t){return this.__data__.has(t)}return Dv=e,Dv}var Lv,sP;function cP(){if(sP)return Lv;sP=1;var e=Av(),t=jK(),n=EK();function r(o){var a=-1,i=o==null?0:o.length;for(this.__data__=new e;++a<i;)this.add(o[a])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,Lv=r,Lv}var Fv,lP;function uP(){if(lP)return Fv;lP=1;function e(t,n){for(var r=-1,o=t==null?0:t.length;++r<o;)if(n(t[r],r,t))return!0;return!1}return Fv=e,Fv}var Bv,dP;function fP(){if(dP)return Bv;dP=1;function e(t,n){return t.has(n)}return Bv=e,Bv}var $v,pP;function hP(){if(pP)return $v;pP=1;var e=cP(),t=uP(),n=fP(),r=1,o=2;function a(i,s,c,l,u,d){var f=c&r,h=i.length,y=s.length;if(h!=y&&!(f&&y>h))return!1;var m=d.get(i),v=d.get(s);if(m&&v)return m==s&&v==i;var b=-1,x=!0,_=c&o?new e:void 0;for(d.set(i,s),d.set(s,i);++b<h;){var w=i[b],j=s[b];if(l)var E=f?l(j,w,b,s,i,d):l(w,j,b,i,s,d);if(E!==void 0){if(E)continue;x=!1;break}if(_){if(!t(s,function(S,O){if(!n(_,O)&&(w===S||u(w,S,c,l,d)))return _.push(O)})){x=!1;break}}else if(!(w===j||u(w,j,c,l,d))){x=!1;break}}return d.delete(i),d.delete(s),x}return $v=a,$v}var zv,mP;gS=function(){if(mP)return zv;mP=1;var e=nr(),t=e.Uint8Array;return zv=t,zv};var Vv,yP;function SK(){if(yP)return Vv;yP=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(o,a){r[++n]=[a,o]}),r}return Vv=e,Vv}var Uv,gP;function Hv(){if(gP)return Uv;gP=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(o){r[++n]=o}),r}return Uv=e,Uv}var Wv,vP;function CK(){if(vP)return Wv;vP=1;var e=gi(),t=gS(),n=rc(),r=hP(),o=SK(),a=Hv(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",f="[object Number]",h="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",x="[object DataView]",_=e?e.prototype:void 0,w=_?_.valueOf:void 0;function j(E,S,O,k,N,P,R){switch(O){case x:if(E.byteLength!=S.byteLength||E.byteOffset!=S.byteOffset)return!1;E=E.buffer,S=S.buffer;case b:return!(E.byteLength!=S.byteLength||!P(new t(E),new t(S)));case c:case l:case f:return n(+E,+S);case u:return E.name==S.name&&E.message==S.message;case h:case m:return E==S+"";case d:var A=o;case y:var C=k&i;if(A||(A=a),E.size!=S.size&&!C)return!1;var M=R.get(E);if(M)return M==S;k|=s,R.set(E,S);var T=r(A(E),A(S),k,N,P,R);return R.delete(E),T;case v:if(w)return w.call(E)==w.call(S)}return!1}return Wv=j,Wv}var qv,bP;function Yv(){if(bP)return qv;bP=1;function e(t,n){for(var r=-1,o=n.length,a=t.length;++r<o;)t[a+r]=n[r];return t}return qv=e,qv}var Kv,xP;un=function(){if(xP)return Kv;xP=1;var e=Array.isArray;return Kv=e,Kv};var Xv,wP;function _P(){if(wP)return Xv;wP=1;var e=Yv(),t=un();function n(r,o,a){var i=o(r);return t(r)?i:e(i,a(r))}return Xv=n,Xv}var Qv,jP;function OK(){if(jP)return Qv;jP=1;function e(t,n){for(var r=-1,o=t==null?0:t.length,a=0,i=[];++r<o;){var s=t[r];n(s,r,t)&&(i[a++]=s)}return i}return Qv=e,Qv}var Jv,EP;function SP(){if(EP)return Jv;EP=1;function e(){return[]}return Jv=e,Jv}var Gv,CP;Wm=function(){if(CP)return Gv;CP=1;var e=OK(),t=SP(),n=Object.prototype,r=n.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(i){return i==null?[]:(i=Object(i),e(o(i),function(s){return r.call(i,s)}))}:t;return Gv=a,Gv};var Zv,OP;function NK(){if(OP)return Zv;OP=1;function e(t,n){for(var r=-1,o=Array(t);++r<t;)o[r]=n(r);return o}return Zv=e,Zv}var e0,NP;Nr=function(){if(NP)return e0;NP=1;function e(t){return t!=null&&typeof t=="object"}return e0=e,e0};var t0,MP;function MK(){if(MP)return t0;MP=1;var e=mo(),t=Nr(),n="[object Arguments]";function r(o){return t(o)&&e(o)==n}return t0=r,t0}var n0,kP;Wu=function(){if(kP)return n0;kP=1;var e=MK(),t=Nr(),n=Object.prototype,r=n.hasOwnProperty,o=n.propertyIsEnumerable,a=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!o.call(i,"callee")};return n0=a,n0};var ef={exports:{}},r0,PP;function kK(){if(PP)return r0;PP=1;function e(){return!1}return r0=e,r0}ef.exports;var AP;Qm=function(){return AP||(AP=1,function(e,t){var n=nr(),r=kK(),o=t&&!t.nodeType&&t,a=o&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===o,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(ef,ef.exports)),ef.exports};var o0,TP;function tf(){if(TP)return o0;TP=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,o){var a=typeof r;return o=o??e,!!o&&(a=="number"||a!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<o}return o0=n,o0}var a0,RP;function i0(){if(RP)return a0;RP=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return a0=t,a0}var s0,IP;function PK(){if(IP)return s0;IP=1;var e=mo(),t=i0(),n=Nr(),r="[object Arguments]",o="[object Array]",a="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",f="[object RegExp]",h="[object Set]",y="[object String]",m="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",x="[object Float32Array]",_="[object Float64Array]",w="[object Int8Array]",j="[object Int16Array]",E="[object Int32Array]",S="[object Uint8Array]",O="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]",P={};P[x]=P[_]=P[w]=P[j]=P[E]=P[S]=P[O]=P[k]=P[N]=!0,P[r]=P[o]=P[v]=P[a]=P[b]=P[i]=P[s]=P[c]=P[l]=P[u]=P[d]=P[f]=P[h]=P[y]=P[m]=!1;function R(A){return n(A)&&t(A.length)&&!!P[e(A)]}return s0=R,s0}var c0,DP;Km=function(){if(DP)return c0;DP=1;function e(t){return function(n){return t(n)}}return c0=e,c0};var nf={exports:{}};nf.exports;var LP;bS=function(){return LP||(LP=1,function(e,t){var n=Ck(),r=t&&!t.nodeType&&t,o=r&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===r,i=a&&n.process,s=function(){try{var c=o&&o.require&&o.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(nf,nf.exports)),nf.exports};var l0,FP;Gh=function(){if(FP)return l0;FP=1;var e=PK(),t=Km(),n=bS(),r=n&&n.isTypedArray,o=r?t(r):e;return l0=o,l0};var u0,BP;function $P(){if(BP)return u0;BP=1;var e=NK(),t=Wu(),n=un(),r=Qm(),o=tf(),a=Gh(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),f=!d&&t(l),h=!d&&!f&&r(l),y=!d&&!f&&!h&&a(l),m=d||f||h||y,v=m?e(l.length,String):[],b=v.length;for(var x in l)(u||s.call(l,x))&&!(m&&(x=="length"||h&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||o(x,b)))&&v.push(x);return v}return u0=c,u0}var d0,zP;Ym=function(){if(zP)return d0;zP=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,o=typeof r=="function"&&r.prototype||e;return n===o}return d0=t,d0};var f0,VP;function UP(){if(VP)return f0;VP=1;function e(t,n){return function(r){return t(n(r))}}return f0=e,f0}var p0,HP;function AK(){if(HP)return p0;HP=1;var e=UP(),t=e(Object.keys,Object);return p0=t,p0}var h0,WP;function TK(){if(WP)return h0;WP=1;var e=Ym(),t=AK(),n=Object.prototype,r=n.hasOwnProperty;function o(a){if(!e(a))return t(a);var i=[];for(var s in Object(a))r.call(a,s)&&s!="constructor"&&i.push(s);return i}return h0=o,h0}var m0,qP;wa=function(){if(qP)return m0;qP=1;var e=qu(),t=i0();function n(r){return r!=null&&t(r.length)&&!e(r)}return m0=n,m0};var y0,YP;cc=function(){if(YP)return y0;YP=1;var e=$P(),t=TK(),n=wa();function r(o){return n(o)?e(o):t(o)}return y0=r,y0};var g0,KP;xS=function(){if(KP)return g0;KP=1;var e=_P(),t=Wm(),n=cc();function r(o){return e(o,n,t)}return g0=r,g0};var v0,XP;function RK(){if(XP)return v0;XP=1;var e=xS(),t=1,n=Object.prototype,r=n.hasOwnProperty;function o(a,i,s,c,l,u){var d=s&t,f=e(a),h=f.length,y=e(i),m=y.length;if(h!=m&&!d)return!1;for(var v=h;v--;){var b=f[v];if(!(d?b in i:r.call(i,b)))return!1}var x=u.get(a),_=u.get(i);if(x&&_)return x==i&&_==a;var w=!0;u.set(a,i),u.set(i,a);for(var j=d;++v<h;){b=f[v];var E=a[b],S=i[b];if(c)var O=d?c(S,E,b,i,a,u):c(E,S,b,a,i,u);if(!(O===void 0?E===S||l(E,S,s,c,u):O)){w=!1;break}j||(j=b=="constructor")}if(w&&!j){var k=a.constructor,N=i.constructor;k!=N&&"constructor"in a&&"constructor"in i&&!(typeof k=="function"&&k instanceof k&&typeof N=="function"&&N instanceof N)&&(w=!1)}return u.delete(a),u.delete(i),w}return v0=o,v0}var b0,QP;function IK(){if(QP)return b0;QP=1;var e=Ta(),t=nr(),n=e(t,"DataView");return b0=n,b0}var x0,JP;function DK(){if(JP)return x0;JP=1;var e=Ta(),t=nr(),n=e(t,"Promise");return x0=n,x0}var w0,GP;function ZP(){if(GP)return w0;GP=1;var e=Ta(),t=nr(),n=e(t,"Set");return w0=n,w0}var _0,eA;function LK(){if(eA)return _0;eA=1;var e=Ta(),t=nr(),n=e(t,"WeakMap");return _0=n,_0}var j0,tA;vS=function(){if(tA)return j0;tA=1;var e=IK(),t=yv(),n=DK(),r=ZP(),o=LK(),a=mo(),i=Lk(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",f="[object DataView]",h=i(e),y=i(t),m=i(n),v=i(r),b=i(o),x=a;return(e&&x(new e(new ArrayBuffer(1)))!=f||t&&x(new t)!=s||n&&x(n.resolve())!=l||r&&x(new r)!=u||o&&x(new o)!=d)&&(x=function(_){var w=a(_),j=w==c?_.constructor:void 0,E=j?i(j):"";if(E)switch(E){case h:return f;case y:return s;case m:return l;case v:return u;case b:return d}return w}),j0=x,j0};var E0,nA;function FK(){if(nA)return E0;nA=1;var e=Xm(),t=hP(),n=CK(),r=RK(),o=vS(),a=un(),i=Qm(),s=Gh(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,h=f.hasOwnProperty;function y(m,v,b,x,_,w){var j=a(m),E=a(v),S=j?u:o(m),O=E?u:o(v);S=S==l?d:S,O=O==l?d:O;var k=S==d,N=O==d,P=S==O;if(P&&i(m)){if(!i(v))return!1;j=!0,k=!1}if(P&&!k)return w||(w=new e),j||s(m)?t(m,v,b,x,_,w):n(m,v,S,b,x,_,w);if(!(b&c)){var R=k&&h.call(m,"__wrapped__"),A=N&&h.call(v,"__wrapped__");if(R||A){var C=R?m.value():m,M=A?v.value():v;return w||(w=new e),_(C,M,b,x,w)}}return P?(w||(w=new e),r(m,v,b,x,_,w)):!1}return E0=y,E0}var S0,rA;function C0(){if(rA)return S0;rA=1;var e=FK(),t=Nr();function n(r,o,a,i,s){return r===o?!0:r==null||o==null||!t(r)&&!t(o)?r!==r&&o!==o:e(r,o,a,i,n,s)}return S0=n,S0}var O0,oA;function BK(){if(oA)return O0;oA=1;var e=Xm(),t=C0(),n=1,r=2;function o(a,i,s,c){var l=s.length,u=l,d=!c;if(a==null)return!u;for(a=Object(a);l--;){var f=s[l];if(d&&f[2]?f[1]!==a[f[0]]:!(f[0]in a))return!1}for(;++l<u;){f=s[l];var h=f[0],y=a[h],m=f[1];if(d&&f[2]){if(y===void 0&&!(h in a))return!1}else{var v=new e;if(c)var b=c(y,m,h,a,i,v);if(!(b===void 0?t(m,y,n|r,c,v):b))return!1}}return!0}return O0=o,O0}var N0,aA;function iA(){if(aA)return N0;aA=1;var e=rr();function t(n){return n===n&&!e(n)}return N0=t,N0}var M0,sA;function $K(){if(sA)return M0;sA=1;var e=iA(),t=cc();function n(r){for(var o=t(r),a=o.length;a--;){var i=o[a],s=r[i];o[a]=[i,s,e(s)]}return o}return M0=n,M0}var k0,cA;function lA(){if(cA)return k0;cA=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return k0=e,k0}var P0,uA;function zK(){if(uA)return P0;uA=1;var e=BK(),t=$K(),n=lA();function r(o){var a=t(o);return a.length==1&&a[0][2]?n(a[0][0],a[0][1]):function(i){return i===o||e(i,o,a)}}return P0=r,P0}var A0,dA;function zi(){if(dA)return A0;dA=1;var e=mo(),t=Nr(),n="[object Symbol]";function r(o){return typeof o=="symbol"||t(o)&&e(o)==n}return A0=r,A0}var T0,fA;function R0(){if(fA)return T0;fA=1;var e=un(),t=zi(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function o(a,i){if(e(a))return!1;var s=typeof a;return s=="number"||s=="symbol"||s=="boolean"||a==null||t(a)?!0:r.test(a)||!n.test(a)||i!=null&&a in Object(i)}return T0=o,T0}var I0,pA;function hA(){if(pA)return I0;pA=1;var e=Av(),t="Expected a function";function n(r,o){if(typeof r!="function"||o!=null&&typeof o!="function")throw new TypeError(t);var a=function(){var i=arguments,s=o?o.apply(this,i):i[0],c=a.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return a.cache=c.set(s,l)||c,l};return a.cache=new(n.Cache||e),a}return n.Cache=e,I0=n,I0}var D0,mA;function VK(){if(mA)return D0;mA=1;var e=hA(),t=500;function n(r){var o=e(r,function(i){return a.size===t&&a.clear(),i}),a=o.cache;return o}return D0=n,D0}var L0,yA;function UK(){if(yA)return L0;yA=1;var e=VK(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(o){var a=[];return o.charCodeAt(0)===46&&a.push(""),o.replace(t,function(i,s,c,l){a.push(c?l.replace(n,"$1"):s||i)}),a});return L0=r,L0}var F0,gA;nc=function(){if(gA)return F0;gA=1;function e(t,n){for(var r=-1,o=t==null?0:t.length,a=Array(o);++r<o;)a[r]=n(t[r],r,t);return a}return F0=e,F0};var B0,vA;function HK(){if(vA)return B0;vA=1;var e=gi(),t=nc(),n=un(),r=zi(),o=1/0,a=e?e.prototype:void 0,i=a?a.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-o?"-0":l}return B0=s,B0}var $0,bA;function xA(){if(bA)return $0;bA=1;var e=HK();function t(n){return n==null?"":e(n)}return $0=t,$0}var z0,wA;fc=function(){if(wA)return z0;wA=1;var e=un(),t=R0(),n=UK(),r=xA();function o(a,i){return e(a)?a:t(a,i)?[a]:n(r(a))}return z0=o,z0};var V0,_A;vi=function(){if(_A)return V0;_A=1;var e=zi(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var o=r+"";return o=="0"&&1/r==-t?"-0":o}return V0=n,V0};var U0,jA;dc=function(){if(jA)return U0;jA=1;var e=fc(),t=vi();function n(r,o){o=e(o,r);for(var a=0,i=o.length;r!=null&&a<i;)r=r[t(o[a++])];return a&&a==i?r:void 0}return U0=n,U0};var H0,EA;function SA(){if(EA)return H0;EA=1;var e=dc();function t(n,r,o){var a=n==null?void 0:e(n,r);return a===void 0?o:a}return H0=t,H0}var W0,CA;function WK(){if(CA)return W0;CA=1;function e(t,n){return t!=null&&n in Object(t)}return W0=e,W0}var q0,OA;function qK(){if(OA)return q0;OA=1;var e=fc(),t=Wu(),n=un(),r=tf(),o=i0(),a=vi();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var h=a(c[u]);if(!(f=s!=null&&l(s,h)))break;s=s[h]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&o(d)&&r(h,d)&&(n(s)||t(s)))}return q0=i,q0}var Y0,NA;BE=function(){if(NA)return Y0;NA=1;var e=WK(),t=qK();function n(r,o){return r!=null&&t(r,o,e)}return Y0=n,Y0};var K0,MA;function YK(){if(MA)return K0;MA=1;var e=C0(),t=SA(),n=BE(),r=R0(),o=iA(),a=lA(),i=vi(),s=1,c=2;function l(u,d){return r(u)&&o(d)?a(i(u),d):function(f){var h=t(f,u);return h===void 0&&h===d?n(f,u):e(d,h,s|c)}}return K0=l,K0}var X0,kA;function Vi(){if(kA)return X0;kA=1;function e(t){return t}return X0=e,X0}var Q0,PA;function KK(){if(PA)return Q0;PA=1;function e(t){return function(n){return n==null?void 0:n[t]}}return Q0=e,Q0}var J0,AA;function XK(){if(AA)return J0;AA=1;var e=dc();function t(n){return function(r){return e(r,n)}}return J0=t,J0}var G0,TA;function QK(){if(TA)return G0;TA=1;var e=KK(),t=XK(),n=R0(),r=vi();function o(a){return n(a)?e(r(a)):t(a)}return G0=o,G0}var Z0,RA;function Lr(){if(RA)return Z0;RA=1;var e=zK(),t=YK(),n=Vi(),r=un(),o=QK();function a(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):o(i)}return Z0=a,Z0}var eb,IA;function JK(){if(IA)return eb;IA=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return eb=t,eb}var tb,DA;function LA(){if(DA)return tb;DA=1;var e=Ta(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return tb=t,tb}var nb,FA;em=function(){if(FA)return nb;FA=1;var e=LA();function t(n,r,o){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:o,writable:!0}):n[r]=o}return nb=t,nb};var rb,BA;wS=function(){if(BA)return rb;BA=1;var e=em(),t=rc(),n=Object.prototype,r=n.hasOwnProperty;function o(a,i,s){var c=a[i];(!(r.call(a,i)&&t(c,s))||s===void 0&&!(i in a))&&e(a,i,s)}return rb=o,rb};var ob,$A;function GK(){if($A)return ob;$A=1;var e=wS(),t=fc(),n=tf(),r=rr(),o=vi();function a(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,f=d-1,h=i;h!=null&&++u<d;){var y=o(s[u]),m=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(u!=f){var v=h[y];m=l?l(v,y,h):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(h,y,m),h=h[y]}return i}return ob=a,ob}var ab,zA;FE=function(){if(zA)return ab;zA=1;var e=dc(),t=GK(),n=fc();function r(o,a,i){for(var s=-1,c=a.length,l={};++s<c;){var u=a[s],d=e(o,u);i(d,u)&&t(l,n(u,o),d)}return l}return ab=r,ab};var ib,VA;qm=function(){if(VA)return ib;VA=1;var e=UP(),t=e(Object.getPrototypeOf,Object);return ib=t,ib};var sb,UA;yS=function(){if(UA)return sb;UA=1;var e=Yv(),t=qm(),n=Wm(),r=SP(),o=Object.getOwnPropertySymbols,a=o?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return sb=a,sb};var cb,HA;function ZK(){if(HA)return cb;HA=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return cb=e,cb}var lb,WA;function eX(){if(WA)return lb;WA=1;var e=rr(),t=Ym(),n=ZK(),r=Object.prototype,o=r.hasOwnProperty;function a(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!o.call(i,l))||c.push(l);return c}return lb=a,lb}var ub,qA;mS=function(){if(qA)return ub;qA=1;var e=$P(),t=eX(),n=wa();function r(o){return n(o)?e(o,!0):t(o)}return ub=r,ub};var db,YA;_S=function(){if(YA)return db;YA=1;var e=_P(),t=yS(),n=mS();function r(o){return e(o,n,t)}return db=r,db};var fb,KA;function tX(){if(KA)return fb;KA=1;var e=nc(),t=Lr(),n=FE(),r=_S();function o(a,i){if(a==null)return{};var s=e(r(a),function(c){return[c]});return i=t(i),n(a,s,function(c,l){return i(c,l[0])})}return fb=o,fb}var pb,XA;function nX(){if(XA)return pb;XA=1;var e=Lr(),t=JK(),n=tX();function r(o,a){return n(o,t(e(a)))}return pb=r,pb}var rX=nX();const el=Xe(rX);var hb,QA;function oX(){if(QA)return hb;QA=1;function e(t){return t===void 0}return hb=e,hb}var aX=oX();const tl=Xe(aX);function It(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=It(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var iX={value:()=>{}};function rf(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new of(n)}function of(e){this._=e}function sX(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}of.prototype=rf.prototype={constructor:of,on:function(e,t){var n=this._,r=sX(e+"",n),o,a=-1,i=r.length;if(arguments.length<2){for(;++a<i;)if((o=(e=r[a]).type)&&(o=cX(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<i;)if(o=(e=r[a]).type)n[o]=JA(n[o],e.name,t);else if(t==null)for(o in n)n[o]=JA(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new of(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,a;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,o=a.length;r<o;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,a=r.length;o<a;++o)r[o].value.apply(t,n)}};function cX(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function JA(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=iX,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var mb="http://www.w3.org/1999/xhtml";const GA={svg:"http://www.w3.org/2000/svg",xhtml:mb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function af(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),GA.hasOwnProperty(t)?{space:GA[t],local:e}:e}function lX(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===mb&&t.documentElement.namespaceURI===mb?t.createElement(e):t.createElementNS(n,e)}}function uX(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ZA(e){var t=af(e);return(t.local?uX:lX)(t)}function dX(){}function yb(e){return e==null?dX:function(){return this.querySelector(e)}}function fX(e){typeof e!="function"&&(e=yb(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a=t[o],i=a.length,s=r[o]=new Array(i),c,l,u=0;u<i;++u)(c=a[u])&&(l=e.call(c,c.__data__,u,a))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new Dn(r,this._parents)}function pX(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function hX(){return[]}function e2(e){return e==null?hX:function(){return this.querySelectorAll(e)}}function mX(e){return function(){return pX(e.apply(this,arguments))}}function yX(e){typeof e=="function"?e=mX(e):e=e2(e);for(var t=this._groups,n=t.length,r=[],o=[],a=0;a<n;++a)for(var i=t[a],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),o.push(c));return new Dn(r,o)}function t2(e){return function(){return this.matches(e)}}function n2(e){return function(t){return t.matches(e)}}var gX=Array.prototype.find;function vX(e){return function(){return gX.call(this.children,e)}}function bX(){return this.firstElementChild}function xX(e){return this.select(e==null?bX:vX(typeof e=="function"?e:n2(e)))}var wX=Array.prototype.filter;function _X(){return Array.from(this.children)}function jX(e){return function(){return wX.call(this.children,e)}}function EX(e){return this.selectAll(e==null?_X:jX(typeof e=="function"?e:n2(e)))}function SX(e){typeof e!="function"&&(e=t2(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a=t[o],i=a.length,s=r[o]=[],c,l=0;l<i;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new Dn(r,this._parents)}function r2(e){return new Array(e.length)}function CX(){return new Dn(this._enter||this._groups.map(r2),this._parents)}function sf(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}sf.prototype={constructor:sf,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function OX(e){return function(){return e}}function NX(e,t,n,r,o,a){for(var i=0,s,c=t.length,l=a.length;i<l;++i)(s=t[i])?(s.__data__=a[i],r[i]=s):n[i]=new sf(e,a[i]);for(;i<c;++i)(s=t[i])&&(o[i]=s)}function MX(e,t,n,r,o,a,i){var s,c,l=new Map,u=t.length,d=a.length,f=new Array(u),h;for(s=0;s<u;++s)(c=t[s])&&(f[s]=h=i.call(c,c.__data__,s,t)+"",l.has(h)?o[s]=c:l.set(h,c));for(s=0;s<d;++s)h=i.call(e,a[s],s,a)+"",(c=l.get(h))?(r[s]=c,c.__data__=a[s],l.delete(h)):n[s]=new sf(e,a[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(o[s]=c)}function kX(e){return e.__data__}function PX(e,t){if(!arguments.length)return Array.from(this,kX);var n=t?MX:NX,r=this._parents,o=this._groups;typeof e!="function"&&(e=OX(e));for(var a=o.length,i=new Array(a),s=new Array(a),c=new Array(a),l=0;l<a;++l){var u=r[l],d=o[l],f=d.length,h=AX(e.call(u,u&&u.__data__,l,r)),y=h.length,m=s[l]=new Array(y),v=i[l]=new Array(y),b=c[l]=new Array(f);n(u,d,m,v,b,h,t);for(var x=0,_=0,w,j;x<y;++x)if(w=m[x]){for(x>=_&&(_=x+1);!(j=v[_])&&++_<y;);w._next=j||null}}return i=new Dn(i,r),i._enter=s,i._exit=c,i}function AX(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function TX(){return new Dn(this._exit||this._groups.map(r2),this._parents)}function RX(e,t,n){var r=this.enter(),o=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?a.remove():n(a),r&&o?r.merge(o).order():o}function IX(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,a=r.length,i=Math.min(o,a),s=new Array(o),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),h,y=0;y<d;++y)(h=l[y]||u[y])&&(f[y]=h);for(;c<o;++c)s[c]=n[c];return new Dn(s,this._parents)}function DX(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,a=r[o],i;--o>=0;)(i=r[o])&&(a&&i.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(i,a),a=i);return this}function LX(e){e||(e=FX);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,o=new Array(r),a=0;a<r;++a){for(var i=n[a],s=i.length,c=o[a]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new Dn(o,this._parents).order()}function FX(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function BX(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $X(){return Array.from(this)}function zX(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,a=r.length;o<a;++o){var i=r[o];if(i)return i}return null}function VX(){let e=0;for(const t of this)++e;return e}function UX(){return!this.node()}function HX(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],a=0,i=o.length,s;a<i;++a)(s=o[a])&&e.call(s,s.__data__,a,o);return this}function WX(e){return function(){this.removeAttribute(e)}}function qX(e){return function(){this.removeAttributeNS(e.space,e.local)}}function YX(e,t){return function(){this.setAttribute(e,t)}}function KX(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function XX(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function QX(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function JX(e,t){var n=af(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?qX:WX:typeof t=="function"?n.local?QX:XX:n.local?KX:YX)(n,t))}function o2(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function GX(e){return function(){this.style.removeProperty(e)}}function ZX(e,t,n){return function(){this.style.setProperty(e,t,n)}}function eQ(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function tQ(e,t,n){return arguments.length>1?this.each((t==null?GX:typeof t=="function"?eQ:ZX)(e,t,n??"")):Ui(this.node(),e)}function Ui(e,t){return e.style.getPropertyValue(t)||o2(e).getComputedStyle(e,null).getPropertyValue(t)}function nQ(e){return function(){delete this[e]}}function rQ(e,t){return function(){this[e]=t}}function oQ(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function aQ(e,t){return arguments.length>1?this.each((t==null?nQ:typeof t=="function"?oQ:rQ)(e,t)):this.node()[e]}function a2(e){return e.trim().split(/^|\s+/)}function gb(e){return e.classList||new i2(e)}function i2(e){this._node=e,this._names=a2(e.getAttribute("class")||"")}i2.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function s2(e,t){for(var n=gb(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function c2(e,t){for(var n=gb(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function iQ(e){return function(){s2(this,e)}}function sQ(e){return function(){c2(this,e)}}function cQ(e,t){return function(){(t.apply(this,arguments)?s2:c2)(this,e)}}function lQ(e,t){var n=a2(e+"");if(arguments.length<2){for(var r=gb(this.node()),o=-1,a=n.length;++o<a;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?cQ:t?iQ:sQ)(n,t))}function uQ(){this.textContent=""}function dQ(e){return function(){this.textContent=e}}function fQ(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function pQ(e){return arguments.length?this.each(e==null?uQ:(typeof e=="function"?fQ:dQ)(e)):this.node().textContent}function hQ(){this.innerHTML=""}function mQ(e){return function(){this.innerHTML=e}}function yQ(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function gQ(e){return arguments.length?this.each(e==null?hQ:(typeof e=="function"?yQ:mQ)(e)):this.node().innerHTML}function vQ(){this.nextSibling&&this.parentNode.appendChild(this)}function bQ(){return this.each(vQ)}function xQ(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wQ(){return this.each(xQ)}function _Q(e){var t=typeof e=="function"?e:ZA(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function jQ(){return null}function EQ(e,t){var n=typeof e=="function"?e:ZA(e),r=t==null?jQ:typeof t=="function"?t:yb(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function SQ(){var e=this.parentNode;e&&e.removeChild(this)}function CQ(){return this.each(SQ)}function OQ(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function NQ(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function MQ(e){return this.select(e?NQ:OQ)}function kQ(e){return arguments.length?this.property("__data__",e):this.node().__data__}function PQ(e){return function(t){e.call(this,t,this.__data__)}}function AQ(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function TQ(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,a;n<o;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function RQ(e,t,n){return function(){var r=this.__on,o,a=PQ(t);if(r){for(var i=0,s=r.length;i<s;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=n),o.value=t;return}}this.addEventListener(e.type,a,n),o={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(o):this.__on=[o]}}function IQ(e,t,n){var r=AQ(e+""),o,a=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(o=0,u=s[c];o<a;++o)if((i=r[o]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?RQ:TQ,o=0;o<a;++o)this.each(s(r[o],t,n));return this}function l2(e,t,n){var r=o2(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function DQ(e,t){return function(){return l2(this,e,t)}}function LQ(e,t){return function(){return l2(this,e,t.apply(this,arguments))}}function FQ(e,t){return this.each((typeof t=="function"?LQ:DQ)(e,t))}function*BQ(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,a=r.length,i;o<a;++o)(i=r[o])&&(yield i)}var u2=[null];function Dn(e,t){this._groups=e,this._parents=t}function nl(){return new Dn([[document.documentElement]],u2)}function $Q(){return this}Dn.prototype=nl.prototype={constructor:Dn,select:fX,selectAll:yX,selectChild:xX,selectChildren:EX,filter:SX,data:PX,enter:CX,exit:TX,join:RX,merge:IX,selection:$Q,order:DX,sort:LX,call:BX,nodes:$X,node:zX,size:VX,empty:UX,each:HX,attr:JX,style:tQ,property:aQ,classed:lQ,text:pQ,html:gQ,raise:bQ,lower:wQ,append:_Q,insert:EQ,remove:CQ,clone:MQ,datum:kQ,on:IQ,dispatch:FQ,[Symbol.iterator]:BQ};function Ln(e){return typeof e=="string"?new Dn([[document.querySelector(e)]],[document.documentElement]):new Dn([[e]],u2)}function zQ(e){let t;for(;t=e.sourceEvent;)e=t;return e}function fr(e,t){if(e=zQ(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const VQ={passive:!1},rl={capture:!0,passive:!1};function vb(e){e.stopImmediatePropagation()}function Hi(e){e.preventDefault(),e.stopImmediatePropagation()}function d2(e){var t=e.document.documentElement,n=Ln(e).on("dragstart.drag",Hi,rl);"onselectstart"in t?n.on("selectstart.drag",Hi,rl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function f2(e,t){var n=e.document.documentElement,r=Ln(e).on("dragstart.drag",null);t&&(r.on("click.drag",Hi,rl),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const cf=e=>()=>e;function bb(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:a,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}bb.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function UQ(e){return!e.ctrlKey&&!e.button}function HQ(){return this.parentNode}function WQ(e,t){return t??{x:e.x,y:e.y}}function qQ(){return navigator.maxTouchPoints||"ontouchstart"in this}function p2(){var e=UQ,t=HQ,n=WQ,r=qQ,o={},a=rf("start","drag","end"),i=0,s,c,l,u,d=0;function f(w){w.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,VQ).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,j){if(!(u||!e.call(this,w,j))){var E=_(this,t.call(this,w,j),w,j,"mouse");E&&(Ln(w.view).on("mousemove.drag",y,rl).on("mouseup.drag",m,rl),d2(w.view),vb(w),l=!1,s=w.clientX,c=w.clientY,E("start",w))}}function y(w){if(Hi(w),!l){var j=w.clientX-s,E=w.clientY-c;l=j*j+E*E>d}o.mouse("drag",w)}function m(w){Ln(w.view).on("mousemove.drag mouseup.drag",null),f2(w.view,l),Hi(w),o.mouse("end",w)}function v(w,j){if(e.call(this,w,j)){var E=w.changedTouches,S=t.call(this,w,j),O=E.length,k,N;for(k=0;k<O;++k)(N=_(this,S,w,j,E[k].identifier,E[k]))&&(vb(w),N("start",w,E[k]))}}function b(w){var j=w.changedTouches,E=j.length,S,O;for(S=0;S<E;++S)(O=o[j[S].identifier])&&(Hi(w),O("drag",w,j[S]))}function x(w){var j=w.changedTouches,E=j.length,S,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<E;++S)(O=o[j[S].identifier])&&(vb(w),O("end",w,j[S]))}function _(w,j,E,S,O,k){var N=a.copy(),P=fr(k||E,j),R,A,C;if((C=n.call(w,new bb("beforestart",{sourceEvent:E,target:f,identifier:O,active:i,x:P[0],y:P[1],dx:0,dy:0,dispatch:N}),S))!=null)return R=C.x-P[0]||0,A=C.y-P[1]||0,function M(T,D,I){var L=P,B;switch(T){case"start":o[O]=M,B=i++;break;case"end":delete o[O],--i;case"drag":P=fr(I||D,j),B=i;break}N.call(T,w,new bb(T,{sourceEvent:D,subject:C,target:f,identifier:O,active:B,x:P[0]+R,y:P[1]+A,dx:P[0]-L[0],dy:P[1]-L[1],dispatch:N}),S)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:cf(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:cf(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:cf(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:cf(!!w),f):r},f.on=function(){var w=a.on.apply(a,arguments);return w===a?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function xb(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function h2(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ol(){}var al=.7,lf=1/al,Wi="\\s*([+-]?\\d+)\\s*",il="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",YQ=/^#([0-9a-f]{3,8})$/,KQ=new RegExp(`^rgb\\(${Wi},${Wi},${Wi}\\)$`),XQ=new RegExp(`^rgb\\(${Fr},${Fr},${Fr}\\)$`),QQ=new RegExp(`^rgba\\(${Wi},${Wi},${Wi},${il}\\)$`),JQ=new RegExp(`^rgba\\(${Fr},${Fr},${Fr},${il}\\)$`),GQ=new RegExp(`^hsl\\(${il},${Fr},${Fr}\\)$`),ZQ=new RegExp(`^hsla\\(${il},${Fr},${Fr},${il}\\)$`),m2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xb(ol,Ra,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:y2,formatHex:y2,formatHex8:eJ,formatHsl:tJ,formatRgb:g2,toString:g2});function y2(){return this.rgb().formatHex()}function eJ(){return this.rgb().formatHex8()}function tJ(){return _2(this).formatHsl()}function g2(){return this.rgb().formatRgb()}function Ra(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=YQ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?v2(t):n===3?new _n(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?uf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?uf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=KQ.exec(e))?new _n(t[1],t[2],t[3],1):(t=XQ.exec(e))?new _n(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=QQ.exec(e))?uf(t[1],t[2],t[3],t[4]):(t=JQ.exec(e))?uf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GQ.exec(e))?w2(t[1],t[2]/100,t[3]/100,1):(t=ZQ.exec(e))?w2(t[1],t[2]/100,t[3]/100,t[4]):m2.hasOwnProperty(e)?v2(m2[e]):e==="transparent"?new _n(NaN,NaN,NaN,0):null}function v2(e){return new _n(e>>16&255,e>>8&255,e&255,1)}function uf(e,t,n,r){return r<=0&&(e=t=n=NaN),new _n(e,t,n,r)}function nJ(e){return e instanceof ol||(e=Ra(e)),e?(e=e.rgb(),new _n(e.r,e.g,e.b,e.opacity)):new _n}function wb(e,t,n,r){return arguments.length===1?nJ(e):new _n(e,t,n,r??1)}function _n(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}xb(_n,wb,h2(ol,{brighter(e){return e=e==null?lf:Math.pow(lf,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _n(Ia(this.r),Ia(this.g),Ia(this.b),df(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:b2,formatHex:b2,formatHex8:rJ,formatRgb:x2,toString:x2}));function b2(){return`#${Da(this.r)}${Da(this.g)}${Da(this.b)}`}function rJ(){return`#${Da(this.r)}${Da(this.g)}${Da(this.b)}${Da((isNaN(this.opacity)?1:this.opacity)*255)}`}function x2(){const e=df(this.opacity);return`${e===1?"rgb(":"rgba("}${Ia(this.r)}, ${Ia(this.g)}, ${Ia(this.b)}${e===1?")":`, ${e})`}`}function df(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ia(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Da(e){return e=Ia(e),(e<16?"0":"")+e.toString(16)}function w2(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pr(e,t,n,r)}function _2(e){if(e instanceof pr)return new pr(e.h,e.s,e.l,e.opacity);if(e instanceof ol||(e=Ra(e)),!e)return new pr;if(e instanceof pr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),a=Math.max(t,n,r),i=NaN,s=a-o,c=(a+o)/2;return s?(t===a?i=(n-r)/s+(n<r)*6:n===a?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?a+o:2-a-o,i*=60):s=c>0&&c<1?0:i,new pr(i,s,c,e.opacity)}function oJ(e,t,n,r){return arguments.length===1?_2(e):new pr(e,t,n,r??1)}function pr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}xb(pr,oJ,h2(ol,{brighter(e){return e=e==null?lf:Math.pow(lf,e),new pr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new pr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new _n(_b(e>=240?e-240:e+120,o,r),_b(e,o,r),_b(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new pr(j2(this.h),ff(this.s),ff(this.l),df(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=df(this.opacity);return`${e===1?"hsl(":"hsla("}${j2(this.h)}, ${ff(this.s)*100}%, ${ff(this.l)*100}%${e===1?")":`, ${e})`}`}}));function j2(e){return e=(e||0)%360,e<0?e+360:e}function ff(e){return Math.max(0,Math.min(1,e||0))}function _b(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const jb=e=>()=>e;function aJ(e,t){return function(n){return e+n*t}}function iJ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function sJ(e){return(e=+e)==1?E2:function(t,n){return n-t?iJ(t,n,e):jb(isNaN(t)?n:t)}}function E2(e,t){var n=t-e;return n?aJ(e,n):jb(isNaN(e)?t:e)}const pf=function e(t){var n=sJ(t);function r(o,a){var i=n((o=wb(o)).r,(a=wb(a)).r),s=n(o.g,a.g),c=n(o.b,a.b),l=E2(o.opacity,a.opacity);return function(u){return o.r=i(u),o.g=s(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function cJ(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(a){for(o=0;o<n;++o)r[o]=e[o]*(1-a)+t[o]*a;return r}}function lJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function uJ(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,o=new Array(r),a=new Array(n),i;for(i=0;i<r;++i)o[i]=qi(e[i],t[i]);for(;i<n;++i)a[i]=t[i];return function(s){for(i=0;i<r;++i)a[i]=o[i](s);return a}}function dJ(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function hr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function fJ(e,t){var n={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=qi(e[o],t[o]):r[o]=t[o];return function(a){for(o in n)r[o]=n[o](a);return r}}var Eb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sb=new RegExp(Eb.source,"g");function pJ(e){return function(){return e}}function hJ(e){return function(t){return e(t)+""}}function S2(e,t){var n=Eb.lastIndex=Sb.lastIndex=0,r,o,a,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=Eb.exec(e))&&(o=Sb.exec(t));)(a=o.index)>n&&(a=t.slice(n,a),s[i]?s[i]+=a:s[++i]=a),(r=r[0])===(o=o[0])?s[i]?s[i]+=o:s[++i]=o:(s[++i]=null,c.push({i,x:hr(r,o)})),n=Sb.lastIndex;return n<t.length&&(a=t.slice(n),s[i]?s[i]+=a:s[++i]=a),s.length<2?c[0]?hJ(c[0].x):pJ(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function qi(e,t){var n=typeof t,r;return t==null||n==="boolean"?jb(t):(n==="number"?hr:n==="string"?(r=Ra(t))?(t=r,pf):S2:t instanceof Ra?pf:t instanceof Date?dJ:lJ(t)?cJ:Array.isArray(t)?uJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?fJ:hr)(e,t)}function Cb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var C2=180/Math.PI,O2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function N2(e,t,n,r,o,a){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*C2,skewX:Math.atan(c)*C2,scaleX:i,scaleY:s}}var hf;function mJ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?O2:N2(t.a,t.b,t.c,t.d,t.e,t.f)}function yJ(e){return e==null||(hf||(hf=document.createElementNS("http://www.w3.org/2000/svg","g")),hf.setAttribute("transform",e),!(e=hf.transform.baseVal.consolidate()))?O2:(e=e.matrix,N2(e.a,e.b,e.c,e.d,e.e,e.f))}function M2(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function a(l,u,d,f,h,y){if(l!==d||u!==f){var m=h.push("translate(",null,t,null,n);y.push({i:m-4,x:hr(l,d)},{i:m-2,x:hr(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(o(d)+"rotate(",null,r)-2,x:hr(l,u)})):u&&d.push(o(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(o(d)+"skewX(",null,r)-2,x:hr(l,u)}):u&&d.push(o(d)+"skewX("+u+r)}function c(l,u,d,f,h,y){if(l!==d||u!==f){var m=h.push(o(h)+"scale(",null,",",null,")");y.push({i:m-4,x:hr(l,d)},{i:m-2,x:hr(u,f)})}else(d!==1||f!==1)&&h.push(o(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),a(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var y=-1,m=f.length,v;++y<m;)d[(v=f[y]).i]=v.x(h);return d.join("")}}}var gJ=M2(mJ,"px, ","px)","deg)"),vJ=M2(yJ,", ",")",")"),bJ=1e-12;function k2(e){return((e=Math.exp(e))+1/e)/2}function xJ(e){return((e=Math.exp(e))-1/e)/2}function wJ(e){return((e=Math.exp(2*e))-1)/(e+1)}const _J=function e(t,n,r){function o(a,i){var s=a[0],c=a[1],l=a[2],u=i[0],d=i[1],f=i[2],h=u-s,y=d-c,m=h*h+y*y,v,b;if(m<bJ)b=Math.log(f/l)/t,v=function(S){return[s+S*h,c+S*y,l*Math.exp(t*S*b)]};else{var x=Math.sqrt(m),_=(f*f-l*l+r*m)/(2*l*n*x),w=(f*f-l*l-r*m)/(2*f*n*x),j=Math.log(Math.sqrt(_*_+1)-_),E=Math.log(Math.sqrt(w*w+1)-w);b=(E-j)/t,v=function(S){var O=S*b,k=k2(j),N=l/(n*x)*(k*wJ(t*O+j)-xJ(j));return[s+N*h,c+N*y,l*k/k2(t*O+j)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return o.rho=function(a){var i=Math.max(.001,+a),s=i*i,c=s*s;return e(i,s,c)},o}(Math.SQRT2,2,4);function jJ(e,t){t===void 0&&(t=e,e=qi);for(var n=0,r=t.length-1,o=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(o,o=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return a[s](i-s)}}var Yi=0,sl=0,cl=0,P2=1e3,mf,ll,yf=0,La=0,gf=0,ul=typeof performance=="object"&&performance.now?performance:Date,A2=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ob(){return La||(A2(EJ),La=ul.now()+gf)}function EJ(){La=0}function vf(){this._call=this._time=this._next=null}vf.prototype=T2.prototype={constructor:vf,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ob():+n)+(t==null?0:+t),!this._next&&ll!==this&&(ll?ll._next=this:mf=this,ll=this),this._call=e,this._time=n,Nb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nb())}};function T2(e,t,n){var r=new vf;return r.restart(e,t,n),r}function SJ(){Ob(),++Yi;for(var e=mf,t;e;)(t=La-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Yi}function R2(){La=(yf=ul.now())+gf,Yi=sl=0;try{SJ()}finally{Yi=0,OJ(),La=0}}function CJ(){var e=ul.now(),t=e-yf;t>P2&&(gf-=t,yf=e)}function OJ(){for(var e,t=mf,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:mf=n);ll=e,Nb(r)}function Nb(e){if(!Yi){sl&&(sl=clearTimeout(sl));var t=e-La;t>24?(e<1/0&&(sl=setTimeout(R2,e-ul.now()-gf)),cl&&(cl=clearInterval(cl))):(cl||(yf=ul.now(),cl=setInterval(CJ,P2)),Yi=1,A2(R2))}}function I2(e,t,n){var r=new vf;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var NJ=rf("start","end","cancel","interrupt"),MJ=[],D2=0,L2=1,Mb=2,bf=3,F2=4,kb=5,xf=6;function wf(e,t,n,r,o,a){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;kJ(e,n,{name:t,index:r,group:o,on:NJ,tween:MJ,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:D2})}function Pb(e,t){var n=mr(e,t);if(n.state>D2)throw new Error("too late; already scheduled");return n}function Br(e,t){var n=mr(e,t);if(n.state>bf)throw new Error("too late; already running");return n}function mr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function kJ(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=T2(a,0,n.time);function a(l){n.state=L2,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,f,h;if(n.state!==L2)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===bf)return I2(i);h.state===F2?(h.state=xf,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=xf,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(I2(function(){n.state===bf&&(n.state=F2,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=Mb,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Mb){for(n.state=bf,o=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=kb,1),d=-1,f=o.length;++d<f;)o[d].call(e,u);n.state===kb&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=xf,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function _f(e,t){var n=e.__transition,r,o,a=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){a=!1;continue}o=r.state>Mb&&r.state<kb,r.state=xf,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}a&&delete e.__transition}}function PJ(e){return this.each(function(){_f(this,e)})}function AJ(e,t){var n,r;return function(){var o=Br(this,e),a=o.tween;if(a!==n){r=n=a;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function TJ(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var a=Br(this,e),i=a.tween;if(i!==r){o=(r=i).slice();for(var s={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=s;break}c===l&&o.push(s)}a.tween=o}}function RJ(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=mr(this.node(),n).tween,o=0,a=r.length,i;o<a;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?AJ:TJ)(n,e,t))}function Ab(e,t,n){var r=e._id;return e.each(function(){var o=Br(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return mr(o,r).value[t]}}function B2(e,t){var n;return(typeof t=="number"?hr:t instanceof Ra?pf:(n=Ra(t))?(t=n,pf):S2)(e,t)}function IJ(e){return function(){this.removeAttribute(e)}}function DJ(e){return function(){this.removeAttributeNS(e.space,e.local)}}function LJ(e,t,n){var r,o=n+"",a;return function(){var i=this.getAttribute(e);return i===o?null:i===r?a:a=t(r=i,n)}}function FJ(e,t,n){var r,o=n+"",a;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?a:a=t(r=i,n)}}function BJ(e,t,n){var r,o,a;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===o?a:(o=c,a=t(r=i,s)))}}function $J(e,t,n){var r,o,a;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===o?a:(o=c,a=t(r=i,s)))}}function zJ(e,t){var n=af(e),r=n==="transform"?vJ:B2;return this.attrTween(e,typeof t=="function"?(n.local?$J:BJ)(n,r,Ab(this,"attr."+e,t)):t==null?(n.local?DJ:IJ)(n):(n.local?FJ:LJ)(n,r,t))}function VJ(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function UJ(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function HJ(e,t){var n,r;function o(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&UJ(e,a)),n}return o._value=t,o}function WJ(e,t){var n,r;function o(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&VJ(e,a)),n}return o._value=t,o}function qJ(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=af(e);return this.tween(n,(r.local?HJ:WJ)(r,t))}function YJ(e,t){return function(){Pb(this,e).delay=+t.apply(this,arguments)}}function KJ(e,t){return t=+t,function(){Pb(this,e).delay=t}}function XJ(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?YJ:KJ)(t,e)):mr(this.node(),t).delay}function QJ(e,t){return function(){Br(this,e).duration=+t.apply(this,arguments)}}function JJ(e,t){return t=+t,function(){Br(this,e).duration=t}}function GJ(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?QJ:JJ)(t,e)):mr(this.node(),t).duration}function ZJ(e,t){if(typeof t!="function")throw new Error;return function(){Br(this,e).ease=t}}function eG(e){var t=this._id;return arguments.length?this.each(ZJ(t,e)):mr(this.node(),t).ease}function tG(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Br(this,e).ease=n}}function nG(e){if(typeof e!="function")throw new Error;return this.each(tG(this._id,e))}function rG(e){typeof e!="function"&&(e=t2(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a=t[o],i=a.length,s=r[o]=[],c,l=0;l<i;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new yo(r,this._parents,this._name,this._id)}function oG(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,a=Math.min(r,o),i=new Array(r),s=0;s<a;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;s<r;++s)i[s]=t[s];return new yo(i,this._parents,this._name,this._id)}function aG(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function iG(e,t,n){var r,o,a=aG(t)?Pb:Br;return function(){var i=a(this,e),s=i.on;s!==r&&(o=(r=s).copy()).on(t,n),i.on=o}}function sG(e,t){var n=this._id;return arguments.length<2?mr(this.node(),n).on.on(e):this.each(iG(n,e,t))}function cG(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function lG(){return this.on("end.remove",cG(this._id))}function uG(e){var t=this._name,n=this._id;typeof e!="function"&&(e=yb(e));for(var r=this._groups,o=r.length,a=new Array(o),i=0;i<o;++i)for(var s=r[i],c=s.length,l=a[i]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,wf(l[f],t,n,f,l,mr(u,n)));return new yo(a,this._parents,t,n)}function dG(e){var t=this._name,n=this._id;typeof e!="function"&&(e=e2(e));for(var r=this._groups,o=r.length,a=[],i=[],s=0;s<o;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,y=mr(u,n),m=0,v=f.length;m<v;++m)(h=f[m])&&wf(h,t,n,m,f,y);a.push(f),i.push(u)}return new yo(a,i,t,n)}var fG=nl.prototype.constructor;function pG(){return new fG(this._groups,this._parents)}function hG(e,t){var n,r,o;return function(){var a=Ui(this,e),i=(this.style.removeProperty(e),Ui(this,e));return a===i?null:a===n&&i===r?o:o=t(n=a,r=i)}}function $2(e){return function(){this.style.removeProperty(e)}}function mG(e,t,n){var r,o=n+"",a;return function(){var i=Ui(this,e);return i===o?null:i===r?a:a=t(r=i,n)}}function yG(e,t,n){var r,o,a;return function(){var i=Ui(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),Ui(this,e))),i===c?null:i===r&&c===o?a:(o=c,a=t(r=i,s))}}function gG(e,t){var n,r,o,a="style."+t,i="end."+a,s;return function(){var c=Br(this,e),l=c.on,u=c.value[a]==null?s||(s=$2(t)):void 0;(l!==n||o!==u)&&(r=(n=l).copy()).on(i,o=u),c.on=r}}function vG(e,t,n){var r=(e+="")=="transform"?gJ:B2;return t==null?this.styleTween(e,hG(e,r)).on("end.style."+e,$2(e)):typeof t=="function"?this.styleTween(e,yG(e,r,Ab(this,"style."+e,t))).each(gG(this._id,e)):this.styleTween(e,mG(e,r,t),n).on("end.style."+e,null)}function bG(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function xG(e,t,n){var r,o;function a(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&bG(e,i,n)),r}return a._value=t,a}function wG(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,xG(e,t,n??""))}function _G(e){return function(){this.textContent=e}}function jG(e){return function(){var t=e(this);this.textContent=t??""}}function EG(e){return this.tween("text",typeof e=="function"?jG(Ab(this,"text",e)):_G(e==null?"":e+""))}function SG(e){return function(t){this.textContent=e.call(this,t)}}function CG(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&SG(o)),t}return r._value=e,r}function OG(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,CG(e))}function NG(){for(var e=this._name,t=this._id,n=z2(),r=this._groups,o=r.length,a=0;a<o;++a)for(var i=r[a],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=mr(c,t);wf(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new yo(r,this._parents,e,n)}function MG(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(a,i){var s={value:i},c={value:function(){--o===0&&a()}};n.each(function(){var l=Br(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),o===0&&a()})}var kG=0;function yo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function z2(){return++kG}var go=nl.prototype;yo.prototype={constructor:yo,select:uG,selectAll:dG,selectChild:go.selectChild,selectChildren:go.selectChildren,filter:rG,merge:oG,selection:pG,transition:NG,call:go.call,nodes:go.nodes,node:go.node,size:go.size,empty:go.empty,each:go.each,on:sG,attr:zJ,attrTween:qJ,style:vG,styleTween:wG,text:EG,textTween:OG,remove:lG,tween:RJ,delay:XJ,duration:GJ,ease:eG,easeVarying:nG,end:MG,[Symbol.iterator]:go[Symbol.iterator]};function PG(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var AG={time:null,delay:0,duration:250,ease:PG};function TG(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function RG(e){var t,n;e instanceof yo?(t=e._id,e=e._name):(t=z2(),(n=AG).time=Ob(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var i=r[a],s=i.length,c,l=0;l<s;++l)(c=i[l])&&wf(c,e,t,l,i,n||TG(c,t));return new yo(r,this._parents,e,t)}nl.prototype.interrupt=PJ,nl.prototype.transition=RG;const jf=e=>()=>e;function IG(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function vo(e,t,n){this.k=e,this.x=t,this.y=n}vo.prototype={constructor:vo,scale:function(e){return e===1?this:new vo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ef=new vo(1,0,0);V2.prototype=vo.prototype;function V2(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Ef;return e.__zoom}function Tb(e){e.stopImmediatePropagation()}function dl(e){e.preventDefault(),e.stopImmediatePropagation()}function DG(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function LG(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function U2(){return this.__zoom||Ef}function FG(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function BG(){return navigator.maxTouchPoints||"ontouchstart"in this}function $G(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>a?(a+i)/2:Math.min(0,a)||Math.max(0,i))}function H2(){var e=DG,t=LG,n=$G,r=FG,o=BG,a=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=_J,l=rf("start","zoom","end"),u,d,f,h=500,y=150,m=0,v=10;function b(C){C.property("__zoom",U2).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",N).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,M,T,D){var I=C.selection?C.selection():C;I.property("__zoom",U2),C!==I?j(C,M,T,D):I.interrupt().each(function(){E(this,arguments).event(D).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},b.scaleBy=function(C,M,T,D){b.scaleTo(C,function(){var I=this.__zoom.k,L=typeof M=="function"?M.apply(this,arguments):M;return I*L},T,D)},b.scaleTo=function(C,M,T,D){b.transform(C,function(){var I=t.apply(this,arguments),L=this.__zoom,B=T==null?w(I):typeof T=="function"?T.apply(this,arguments):T,U=L.invert(B),F=typeof M=="function"?M.apply(this,arguments):M;return n(_(x(L,F),B,U),I,i)},T,D)},b.translateBy=function(C,M,T,D){b.transform(C,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof T=="function"?T.apply(this,arguments):T),t.apply(this,arguments),i)},null,D)},b.translateTo=function(C,M,T,D,I){b.transform(C,function(){var L=t.apply(this,arguments),B=this.__zoom,U=D==null?w(L):typeof D=="function"?D.apply(this,arguments):D;return n(Ef.translate(U[0],U[1]).scale(B.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof T=="function"?-T.apply(this,arguments):-T),L,i)},D,I)};function x(C,M){return M=Math.max(a[0],Math.min(a[1],M)),M===C.k?C:new vo(M,C.x,C.y)}function _(C,M,T){var D=M[0]-T[0]*C.k,I=M[1]-T[1]*C.k;return D===C.x&&I===C.y?C:new vo(C.k,D,I)}function w(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,M,T,D){C.on("start.zoom",function(){E(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(D).end()}).tween("zoom",function(){var I=this,L=arguments,B=E(I,L).event(D),U=t.apply(I,L),F=T==null?w(U):typeof T=="function"?T.apply(I,L):T,H=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),J=I.__zoom,q=typeof M=="function"?M.apply(I,L):M,re=c(J.invert(F).concat(H/J.k),q.invert(F).concat(H/q.k));return function(Z){if(Z===1)Z=q;else{var Y=re(Z),W=H/Y[2];Z=new vo(W,F[0]-Y[0]*W,F[1]-Y[1]*W)}B.zoom(null,Z)}})}function E(C,M,T){return!T&&C.__zooming||new S(C,M)}function S(C,M){this.that=C,this.args=M,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,M),this.taps=0}S.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,M){return this.mouse&&C!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var M=Ln(this.that).datum();l.call(C,this.that,new IG(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),M)}};function O(C,...M){if(!e.apply(this,arguments))return;var T=E(this,M).event(C),D=this.__zoom,I=Math.max(a[0],Math.min(a[1],D.k*Math.pow(2,r.apply(this,arguments)))),L=fr(C);if(T.wheel)(T.mouse[0][0]!==L[0]||T.mouse[0][1]!==L[1])&&(T.mouse[1]=D.invert(T.mouse[0]=L)),clearTimeout(T.wheel);else{if(D.k===I)return;T.mouse=[L,D.invert(L)],_f(this),T.start()}dl(C),T.wheel=setTimeout(B,y),T.zoom("mouse",n(_(x(D,I),T.mouse[0],T.mouse[1]),T.extent,i));function B(){T.wheel=null,T.end()}}function k(C,...M){if(f||!e.apply(this,arguments))return;var T=C.currentTarget,D=E(this,M,!0).event(C),I=Ln(C.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",H,!0),L=fr(C,T),B=C.clientX,U=C.clientY;d2(C.view),Tb(C),D.mouse=[L,this.__zoom.invert(L)],_f(this),D.start();function F(J){if(dl(J),!D.moved){var q=J.clientX-B,re=J.clientY-U;D.moved=q*q+re*re>m}D.event(J).zoom("mouse",n(_(D.that.__zoom,D.mouse[0]=fr(J,T),D.mouse[1]),D.extent,i))}function H(J){I.on("mousemove.zoom mouseup.zoom",null),f2(J.view,D.moved),dl(J),D.event(J).end()}}function N(C,...M){if(e.apply(this,arguments)){var T=this.__zoom,D=fr(C.changedTouches?C.changedTouches[0]:C,this),I=T.invert(D),L=T.k*(C.shiftKey?.5:2),B=n(_(x(T,L),D,I),t.apply(this,M),i);dl(C),s>0?Ln(this).transition().duration(s).call(j,B,D,C):Ln(this).call(b.transform,B,D,C)}}function P(C,...M){if(e.apply(this,arguments)){var T=C.touches,D=T.length,I=E(this,M,C.changedTouches.length===D).event(C),L,B,U,F;for(Tb(C),B=0;B<D;++B)U=T[B],F=fr(U,this),F=[F,this.__zoom.invert(F),U.identifier],I.touch0?!I.touch1&&I.touch0[2]!==F[2]&&(I.touch1=F,I.taps=0):(I.touch0=F,L=!0,I.taps=1+!!u);u&&(u=clearTimeout(u)),L&&(I.taps<2&&(d=F[0],u=setTimeout(function(){u=null},h)),_f(this),I.start())}}function R(C,...M){if(this.__zooming){var T=E(this,M).event(C),D=C.changedTouches,I=D.length,L,B,U,F;for(dl(C),L=0;L<I;++L)B=D[L],U=fr(B,this),T.touch0&&T.touch0[2]===B.identifier?T.touch0[0]=U:T.touch1&&T.touch1[2]===B.identifier&&(T.touch1[0]=U);if(B=T.that.__zoom,T.touch1){var H=T.touch0[0],J=T.touch0[1],q=T.touch1[0],re=T.touch1[1],Z=(Z=q[0]-H[0])*Z+(Z=q[1]-H[1])*Z,Y=(Y=re[0]-J[0])*Y+(Y=re[1]-J[1])*Y;B=x(B,Math.sqrt(Z/Y)),U=[(H[0]+q[0])/2,(H[1]+q[1])/2],F=[(J[0]+re[0])/2,(J[1]+re[1])/2]}else if(T.touch0)U=T.touch0[0],F=T.touch0[1];else return;T.zoom("touch",n(_(B,U,F),T.extent,i))}}function A(C,...M){if(this.__zooming){var T=E(this,M).event(C),D=C.changedTouches,I=D.length,L,B;for(Tb(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),L=0;L<I;++L)B=D[L],T.touch0&&T.touch0[2]===B.identifier?delete T.touch0:T.touch1&&T.touch1[2]===B.identifier&&delete T.touch1;if(T.touch1&&!T.touch0&&(T.touch0=T.touch1,delete T.touch1),T.touch0)T.touch0[1]=this.__zoom.invert(T.touch0[0]);else if(T.end(),T.taps===2&&(B=fr(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var U=Ln(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:jf(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:jf(!!C),b):e},b.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:jf(!!C),b):o},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:jf([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(a[0]=+C[0],a[1]=+C[1],b):[a[0],a[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,b):Math.sqrt(m)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const bo={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},fl=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],W2=["Enter"," ","Escape"];var Ki;(function(e){e.Strict="strict",e.Loose="loose"})(Ki||(Ki={}));var Zo;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Zo||(Zo={}));var pl;(function(e){e.Partial="partial",e.Full="full"})(pl||(pl={}));const q2={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ea;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ea||(ea={}));var Sf;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Sf||(Sf={}));var fe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(fe||(fe={}));const Y2={[fe.Left]:fe.Right,[fe.Right]:fe.Left,[fe.Top]:fe.Bottom,[fe.Bottom]:fe.Top};function zG(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function K2(e,t,n){if(!n)return;const r=[];e.forEach((o,a)=>{t!=null&&t.has(a)||r.push(o)}),r.length&&n(r)}function X2(e){return e===null?null:e?"valid":"invalid"}const Q2=e=>"id"in e&&"source"in e&&"target"in e,VG=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Rb=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),hl=(e,t=[0,0])=>{const{width:n,height:r}=xo(e),o=e.origin??t,a=n*o[0],i=r*o[1];return{x:e.position.x-a,y:e.position.y-i}},UG=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const a=typeof o=="string";let i=!t.nodeLookup&&!a?o:void 0;t.nodeLookup&&(i=a?t.nodeLookup.get(o):Rb(o)?o:t.nodeLookup.get(o.id));const s=i?Nf(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Cf(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Of(n)},ml=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=Nf(r);n=Cf(n,o)}}),Of(n)},J2=(e,t,[n,r,o]=[0,0,1],a=!1,i=!1)=>{const s={...gl(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(i&&!d||f)continue;const h=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=yl(s,Qi(l)),v=(h??0)*(y??0),b=a&&m>0;(!l.internals.handleBounds||b||m>=v||l.dragging)&&c.push(l)}return c},HG=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Ib(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&(t!=null&&t.includeHiddenNodes||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function Db({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:a},i){if(e.size===0)return Promise.resolve(!1);const s=ml(e),c=Fb(s,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??a,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function G2({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:a}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=o;if(i.extent==="parent"&&!i.expandParent)if(!s)a==null||a("005",bo.error005());else{const h=s.measured.width,y=s.measured.height;h&&y&&(d=[[c,l],[c+h,l+y]])}else s&&Ji(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=Ji(d)?Fa(t,d,i.measured):t;return{position:{x:f.x-c+i.measured.width*u[0],y:f.y-l+i.measured.height*u[1]},positionAbsolute:f}}async function WG({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const a=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const f=a.has(d.id),h=!f&&d.parentId&&i.find(y=>y.id===d.parentId);(f||h)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=HG(i,c);for(const d of c)s.has(d.id)&&!l.find(f=>f.id===d.id)&&l.push(d);if(!o)return{edges:l,nodes:i};const u=await o({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const Xi=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fa=(e={x:0,y:0},t,n)=>({x:Xi(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Xi(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Z2(e,t,n){const{width:r,height:o}=xo(n),{x:a,y:i}=n.internals.positionAbsolute;return Fa(e,[[a,i],[a+r,i+o]],t)}const eT=(e,t,n)=>e<t?Xi(Math.abs(e-t),1,t)/t:e>n?-Xi(Math.abs(e-n),1,t)/t:0,tT=(e,t,n=15,r=40)=>{const o=eT(e.x,r,t.width-r)*n,a=eT(e.y,r,t.height-r)*n;return[o,a]},Cf=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Lb=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Of=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Qi=(e,t=[0,0])=>{var o,a;const{x:n,y:r}=Rb(e)?e.internals.positionAbsolute:hl(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((a=e.measured)==null?void 0:a.height)??e.height??e.initialHeight??0}},Nf=(e,t=[0,0])=>{var o,a;const{x:n,y:r}=Rb(e)?e.internals.positionAbsolute:hl(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((a=e.measured)==null?void 0:a.height)??e.height??e.initialHeight??0)}},nT=(e,t)=>Of(Cf(Lb(e),Lb(t))),yl=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},rT=e=>yr(e.width)&&yr(e.height)&&yr(e.x)&&yr(e.y),yr=e=>!isNaN(e)&&isFinite(e),qG=(e,t)=>{},Mf=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),gl=({x:e,y:t},[n,r,o],a=!1,i=[1,1])=>{const s={x:(e-n)/o,y:(t-r)/o};return a?Mf(s,i):s},oT=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Fb=(e,t,n,r,o,a)=>{const i=t/(e.width*(1+a)),s=n/(e.height*(1+a)),c=Math.min(i,s),l=Xi(c,r,o),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return{x:f,y:h,zoom:l}},kf=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ji(e){return e!==void 0&&e!=="parent"}function xo(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function aT(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function iT(e,t={width:0,height:0},n,r,o){const a={...e},i=r.get(n);if(i){const s=i.origin||o;a.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],a.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return a}function vl(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:a,y:i}=wo(e),s=gl({x:a-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Mf(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Pf=e=>({width:e.offsetWidth,height:e.offsetHeight}),sT=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},YG=["INPUT","SELECT","TEXTAREA"];function Bb(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return YG.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const cT=e=>"clientX"in e,wo=(e,t)=>{var a,i;const n=cT(e),r=n?e.clientX:(a=e.touches)==null?void 0:a[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},lT=(e,t,n,r,o)=>{const a=t.querySelectorAll(`.${e}`);return!a||!a.length?null:Array.from(a).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...Pf(i)}})};function uT({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:a,targetControlX:i,targetControlY:s}){const c=e*.125+o*.375+i*.375+n*.125,l=t*.125+a*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function Af(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function dT({pos:e,x1:t,y1:n,x2:r,y2:o,c:a}){switch(e){case fe.Left:return[t-Af(t-r,a),n];case fe.Right:return[t+Af(r-t,a),n];case fe.Top:return[t,n-Af(n-o,a)];case fe.Bottom:return[t,n+Af(o-n,a)]}}function fT({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:o,targetPosition:a=fe.Top,curvature:i=.25}){const[s,c]=dT({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[l,u]=dT({pos:a,x1:r,y1:o,x2:e,y2:t,c:i}),[d,f,h,y]=uT({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${o}`,d,f,h,y]}function pT({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,a=n<e?n+o:n-o,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[a,s,o,i]}function KG({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const a=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(a?i:0)}function XG({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const a=Cf(Nf(e),Nf(t));a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return yl(i,Of(a))>0}const QG=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,JG=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),hT=(e,t)=>{if(!e.source||!e.target)return t;let n;return Q2(e)?n={...e}:n={...e,id:QG(e)},JG(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function mT({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,a,i,s]=pT({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,a,i,s]}const yT={[fe.Left]:{x:-1,y:0},[fe.Right]:{x:1,y:0},[fe.Top]:{x:0,y:-1},[fe.Bottom]:{x:0,y:1}},GG=({source:e,sourcePosition:t=fe.Bottom,target:n})=>t===fe.Left||t===fe.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},gT=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ZG({source:e,sourcePosition:t=fe.Bottom,target:n,targetPosition:r=fe.Top,center:o,offset:a}){const i=yT[t],s=yT[r],c={x:e.x+i.x*a,y:e.y+i.y*a},l={x:n.x+s.x*a,y:n.y+s.y*a},u=GG({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],y,m;const v={x:0,y:0},b={x:0,y:0},[x,_,w,j]=pT({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){y=o.x??x,m=o.y??_;const E=[{x:y,y:c.y},{x:y,y:l.y}],S=[{x:c.x,y:m},{x:l.x,y:m}];i[d]===f?h=d==="x"?E:S:h=d==="x"?S:E}else{const E=[{x:c.x,y:l.y}],S=[{x:l.x,y:c.y}];if(d==="x"?h=i.x===f?S:E:h=i.y===f?E:S,t===r){const R=Math.abs(e[d]-n[d]);if(R<=a){const A=Math.min(a-1,a-R);i[d]===f?v[d]=(c[d]>e[d]?-1:1)*A:b[d]=(l[d]>n[d]?-1:1)*A}}if(t!==r){const R=d==="x"?"y":"x",A=i[d]===s[R],C=c[R]>l[R],M=c[R]<l[R];(i[d]===1&&(!A&&C||A&&M)||i[d]!==1&&(!A&&M||A&&C))&&(h=d==="x"?E:S)}const O={x:c.x+v.x,y:c.y+v.y},k={x:l.x+b.x,y:l.y+b.y},N=Math.max(Math.abs(O.x-h[0].x),Math.abs(k.x-h[0].x)),P=Math.max(Math.abs(O.y-h[0].y),Math.abs(k.y-h[0].y));N>=P?(y=(O.x+k.x)/2,m=h[0].y):(y=h[0].x,m=(O.y+k.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...h,{x:l.x+b.x,y:l.y+b.y},n],y,m,w,j]}function eZ(e,t,n,r){const o=Math.min(gT(e,t)/2,gT(t,n)/2,r),{x:a,y:i}=t;if(e.x===a&&a===n.x||e.y===i&&i===n.y)return`L${a} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${a+o*l},${i}Q ${a},${i} ${a},${i+o*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${a},${i+o*c}Q ${a},${i} ${a+o*s},${i}`}function $b({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:o,targetPosition:a=fe.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,h,y]=ZG({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:a,center:{x:s,y:c},offset:l});return[u.reduce((m,v,b)=>{let x="";return b>0&&b<u.length-1?x=eZ(u[b-1],v,u[b+1],i):x=`${b===0?"M":"L"}${v.x} ${v.y}`,m+=x,m},""),d,f,h,y]}function vT(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function tZ(e){var d;const{sourceNode:t,targetNode:n}=e;if(!vT(t)||!vT(n))return null;const r=t.internals.handleBounds||bT(t.handles),o=n.internals.handleBounds||bT(n.handles),a=xT((r==null?void 0:r.source)??[],e.sourceHandle),i=xT(e.connectionMode===Ki.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!a||!i)return(d=e.onError)==null||d.call(e,"008",bo.error008(a?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(a==null?void 0:a.position)||fe.Bottom,c=(i==null?void 0:i.position)||fe.Top,l=bl(t,a,s),u=bl(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function bT(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function bl(e,t,n=fe.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,a=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??xo(e);if(r)return{x:o+i/2,y:a+s/2};switch((t==null?void 0:t.position)??n){case fe.Top:return{x:o+i/2,y:a};case fe.Right:return{x:o+i,y:a+s/2};case fe.Bottom:return{x:o+i/2,y:a+s};case fe.Left:return{x:o,y:a+s/2}}}function xT(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function zb(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function nZ(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const a=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=zb(c,t);a.has(l)||(i.push({id:l,color:c.color||n,...c}),a.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const Vb={nodeOrigin:[0,0],nodeExtent:fl,elevateNodesOnSelect:!0,defaults:{}},rZ={...Vb,checkEquality:!0};function Ub(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function oZ(e,t,n){const r=Ub(Vb,n);for(const o of e.values())if(o.parentId)Wb(o,e,t,r);else{const a=hl(o,r.nodeOrigin),i=Ji(o.extent)?o.extent:r.nodeExtent,s=Fa(a,i,xo(o));o.internals.positionAbsolute=s}}function Hb(e,t,n,r){var s,c;const o=Ub(rZ,r),a=new Map(t),i=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=a.get(l.id);if(o.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=hl(l,o.nodeOrigin),f=Ji(l.extent)?l.extent:o.nodeExtent,h=Fa(d,f,xo(l));u={...o.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:h,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:wT(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&Wb(u,t,n,r)}}function aZ(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Wb(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:a,nodeExtent:i}=Ub(Vb,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}aZ(e,n);const l=o?1e3:0,{x:u,y:d,z:f}=iZ(e,c,a,i,l),{positionAbsolute:h}=e.internals,y=u!==h.x||d!==h.y;(y||f!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:y?{x:u,y:d}:h,z:f})}function wT(e,t){return(yr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function iZ(e,t,n,r,o){const{x:a,y:i}=t.internals.positionAbsolute,s=xo(e),c=hl(e,n),l=Ji(e.extent)?Fa(c,e.extent,s):c;let u=Fa({x:a+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=Z2(u,s,t));const d=wT(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function qb(e,t,n,r=[0,0]){var i;const o=[],a=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=a.get(s.parentId))==null?void 0:i.expandedRect)??Qi(c),u=nT(l,s.rect);a.set(s.parentId,{expandedRect:u,parent:c})}return a.size>0&&a.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=xo(c),f=c.origin??r,h=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,y=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,m=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(m-d.width)*f[0],x=(v-d.height)*f[1];(h>0||y>0||b||x)&&(o.push({id:l,type:"position",position:{x:c.position.x-h+b,y:c.position.y-y+x}}),(_=n.get(l))==null||_.forEach(w=>{e.some(j=>j.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+y}})})),(d.width<s.width||d.height<s.height||h||y)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-b:0),height:v+(y?f[1]*y-x:0)}})}),o}function sZ(e,t,n,r,o,a){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const h=t.get(f.id);if(h)if(h.hidden)h.internals={...h.internals,handleBounds:void 0},s=!0;else{const y=Pf(f.nodeElement),m=h.measured.width!==y.width||h.measured.height!==y.height;if(y.width&&y.height&&(m||!h.internals.handleBounds||f.force)){const v=f.nodeElement.getBoundingClientRect(),b=Ji(h.extent)?h.extent:a;let{positionAbsolute:x}=h.internals;h.parentId&&h.extent==="parent"?x=Z2(x,y,t.get(h.parentId)):b&&(x=Fa(x,b,y)),h.measured=y,h.internals={...h.internals,positionAbsolute:x,handleBounds:{source:lT("source",f.nodeElement,v,u,h.id),target:lT("target",f.nodeElement,v,u,h.id)}},h.parentId&&Wb(h,t,n,{nodeOrigin:o}),s=!0,m&&(c.push({id:h.id,type:"dimensions",dimensions:y}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Qi(h,o)}))}}}if(d.length>0){const f=qb(d,t,n,o);c.push(...f)}return{changes:c,updatedInternals:s}}async function cZ({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:a}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,a]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function _T(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:a,sourceHandle:i=null,targetHandle:s=null}=r,c=`${o}-source-${i}`,l=`${a}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,f={edgeId:r.id,source:o,target:a,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${a}-${s}`,f)),e.set(l,d.set(`${o}-${i}`,f))}}function jT(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:jT(n,t):!1}function ET(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function lZ(e,t,n,r){const o=new Map;for(const[a,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!jT(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(a);s&&o.set(a,{id:a,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return o}function Yb({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const o=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&o.push({...d,position:u.position,dragging:r})}if(!e)return[o[0],o];const a=(s=n.get(e))==null?void 0:s.internals.userNode;return[a?{...a,position:((c=t.get(e))==null?void 0:c.position)||a.position,dragging:r}:o[0],o]}function uZ({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let a={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,h=!1;function y({noDragClassName:v,handleSelector:b,domNode:x,isSelectable:_,nodeId:w,nodeClickDistance:j=0}){f=Ln(x);function E({x:N,y:P},R){const{nodeLookup:A,nodeExtent:C,snapGrid:M,snapToGrid:T,nodeOrigin:D,onNodeDrag:I,onSelectionDrag:L,onError:B,updateNodePositions:U}=t();a={x:N,y:P};let F=!1,H={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const J=ml(s);H=Lb(J)}for(const[J,q]of s){if(!A.has(J))continue;let re={x:N-q.distance.x,y:P-q.distance.y};T&&(re=Mf(re,M));let Z=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!q.extent){const{positionAbsolute:G}=q.internals,te=G.x-H.x+C[0][0],$=G.x+q.measured.width-H.x2+C[1][0],se=G.y-H.y+C[0][1],ue=G.y+q.measured.height-H.y2+C[1][1];Z=[[te,se],[$,ue]]}const{position:Y,positionAbsolute:W}=G2({nodeId:J,nextPosition:re,nodeLookup:A,nodeExtent:Z,nodeOrigin:D,onError:B});F=F||q.position.x!==Y.x||q.position.y!==Y.y,q.position=Y,q.internals.positionAbsolute=W}if(F&&(U(s,!0),R&&(r||I||!w&&L))){const[J,q]=Yb({nodeId:w,dragItems:s,nodeLookup:A});r==null||r(R,s,J,q),I==null||I(R,J,q),w||(L==null||L(R,q))}}async function S(){if(!u)return;const{transform:N,panBy:P,autoPanSpeed:R}=t(),[A,C]=tT(l,u,R);(A!==0||C!==0)&&(a.x=(a.x??0)-A/N[2],a.y=(a.y??0)-C/N[2],await P({x:A,y:C})&&E(a,null)),i=requestAnimationFrame(S)}function O(N){var F;const{nodeLookup:P,multiSelectionActive:R,nodesDraggable:A,transform:C,snapGrid:M,snapToGrid:T,selectNodesOnDrag:D,onNodeDragStart:I,onSelectionDragStart:L,unselectNodesAndEdges:B}=t();d=!0,(!D||!_)&&!R&&w&&((F=P.get(w))!=null&&F.selected||B()),_&&D&&w&&(e==null||e(w));const U=vl(N.sourceEvent,{transform:C,snapGrid:M,snapToGrid:T,containerBounds:u});if(a=U,s=lZ(P,A,U,w),s.size>0&&(n||I||!w&&L)){const[H,J]=Yb({nodeId:w,dragItems:s,nodeLookup:P});n==null||n(N.sourceEvent,s,H,J),I==null||I(N.sourceEvent,H,J),w||(L==null||L(N.sourceEvent,J))}}const k=p2().clickDistance(j).on("start",N=>{const{domNode:P,nodeDragThreshold:R,transform:A,snapGrid:C,snapToGrid:M}=t();u=(P==null?void 0:P.getBoundingClientRect())||null,h=!1,R===0&&O(N),a=vl(N.sourceEvent,{transform:A,snapGrid:C,snapToGrid:M,containerBounds:u}),l=wo(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:P,transform:R,snapGrid:A,snapToGrid:C,nodeDragThreshold:M,nodeLookup:T}=t(),D=vl(N.sourceEvent,{transform:R,snapGrid:A,snapToGrid:C,containerBounds:u});if((N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||w&&!T.has(w))&&(h=!0),!h){if(!c&&P&&d&&(c=!0,S()),!d){const I=D.xSnapped-(a.x??0),L=D.ySnapped-(a.y??0);Math.sqrt(I*I+L*L)>M&&O(N)}(a.x!==D.xSnapped||a.y!==D.ySnapped)&&s&&d&&(l=wo(N.sourceEvent,u),E(D,N.sourceEvent))}}).on("end",N=>{if(!(!d||h)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:P,updateNodePositions:R,onNodeDragStop:A,onSelectionDragStop:C}=t();if(R(s,!1),o||A||!w&&C){const[M,T]=Yb({nodeId:w,dragItems:s,nodeLookup:P,dragging:!1});o==null||o(N.sourceEvent,s,M,T),A==null||A(N.sourceEvent,M,T),w||(C==null||C(N.sourceEvent,T))}}}).filter(N=>{const P=N.target;return!N.button&&(!v||!ET(P,`.${v}`,x))&&(!b||ET(P,b,x))});f.call(k)}function m(){f==null||f.on(".drag",null)}return{update:y,destroy:m}}function dZ(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const a of t.values())yl(o,Qi(a))>0&&r.push(a);return r}const fZ=250;function pZ(e,t,n,r){var s,c;let o=[],a=1/0;const i=dZ(e,n,t+fZ);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:h}=bl(l,d,d.position,!0),y=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));y>t||(y<a?(o=[{...d,x:f,y:h}],a=y):y===a&&o.push({...d,x:f,y:h}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function ST(e,t,n,r,o,a=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=o==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(f=>f.id===n):s==null?void 0:s[0])??null;return c&&a?{...c,...bl(i,c,c.position,!0)}:c}function CT(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function hZ(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const OT=()=>!0;function mZ(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:a,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:h,onConnectStart:y,onConnect:m,onConnectEnd:v,isValidConnection:b=OT,onReconnectEnd:x,updateConnection:_,getTransform:w,getFromHandle:j,autoPanSpeed:E}){const S=sT(e.target);let O=0,k;const{x:N,y:P}=wo(e),R=S==null?void 0:S.elementFromPoint(N,P),A=CT(a,R),C=s==null?void 0:s.getBoundingClientRect();if(!C||!A)return;const M=ST(o,A,r,c,t);if(!M)return;let T=wo(e,C),D=!1,I=null,L=!1,B=null;function U(){if(!u||!C)return;const[Y,W]=tT(T,C,E);f({x:Y,y:W}),O=requestAnimationFrame(U)}const F={...M,nodeId:o,type:A,position:M.position},H=c.get(o),J={inProgress:!0,isValid:null,from:bl(H,F,fe.Left,!0),fromHandle:F,fromPosition:F.position,fromNode:H,to:T,toHandle:null,toPosition:Y2[F.position],toNode:null};_(J);let q=J;y==null||y(e,{nodeId:o,handleId:r,handleType:A});function re(Y){if(!j()||!F){Z(Y);return}const W=w();T=wo(Y,C),k=pZ(gl(T,W,!1,[1,1]),n,c,F),D||(U(),D=!0);const G=NT(Y,{handle:k,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:S,lib:l,flowId:d,nodeLookup:c});B=G.handleDomNode,I=G.connection,L=hZ(!!k,G.isValid);const te={...q,isValid:L,to:k&&L?oT({x:k.x,y:k.y},W):T,toHandle:G.toHandle,toPosition:L&&G.toHandle?G.toHandle.position:Y2[F.position],toNode:G.toHandle?c.get(G.toHandle.nodeId):null};L&&k&&q.toHandle&&te.toHandle&&q.toHandle.type===te.toHandle.type&&q.toHandle.nodeId===te.toHandle.nodeId&&q.toHandle.id===te.toHandle.id&&q.to.x===te.to.x&&q.to.y===te.to.y||(_(te),q=te)}function Z(Y){(k||B)&&I&&L&&(m==null||m(I));const{inProgress:W,...G}=q,te={...G,toPosition:q.toHandle?q.toPosition:null};v==null||v(Y,te),a&&(x==null||x(Y,te)),h(),cancelAnimationFrame(O),D=!1,L=!1,I=null,B=null,S.removeEventListener("mousemove",re),S.removeEventListener("mouseup",Z),S.removeEventListener("touchmove",re),S.removeEventListener("touchend",Z)}S.addEventListener("mousemove",re),S.addEventListener("mouseup",Z),S.addEventListener("touchmove",re),S.addEventListener("touchend",Z)}function NT(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:a,doc:i,lib:s,flowId:c,isValidConnection:l=OT,nodeLookup:u}){const d=a==="target",f=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y}=wo(e),m=i.elementFromPoint(h,y),v=m!=null&&m.classList.contains(`${s}-flow__handle`)?m:f,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const x=CT(void 0,v),_=v.getAttribute("data-nodeid"),w=v.getAttribute("data-handleid"),j=v.classList.contains("connectable"),E=v.classList.contains("connectableend");if(!_||!x)return b;const S={source:d?_:r,sourceHandle:d?w:o,target:d?r:_,targetHandle:d?o:w};b.connection=S;const O=j&&E&&(n===Ki.Strict?d&&x==="source"||!d&&x==="target":_!==r||w!==o);b.isValid=O&&l(S),b.toHandle=ST(_,x,w,u,n,!1)}return b}const Kb={onPointerDown:mZ,isValid:NT};function yZ({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=Ln(e);function a({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const y=_=>{const w=n();if(_.sourceEvent.type!=="wheel"||!t)return;const j=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,E=w[2]*Math.pow(2,j);t.scaleTo(E)};let m=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(m=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const w=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const j=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],E=[j[0]-m[0],j[1]-m[1]];m=j;const S=r()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),O={x:w[0]-E[0]*S,y:w[1]-E[1]*S},k=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:w[2]},k,s)},x=H2().on("start",v).on("zoom",d?b:null).on("zoom.wheel",f?y:null);o.call(x,{})}function i(){o.on("zoom",null)}return{update:a,destroy:i,pointer:fr}}const gZ=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Tf=e=>({x:e.x,y:e.y,zoom:e.k}),Xb=({x:e,y:t,zoom:n})=>Ef.translate(e,t).scale(n),Gi=(e,t)=>e.target.closest(`.${t}`),MT=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Qb=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},kT=e=>{const t=e.ctrlKey&&kf()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function vZ({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:a,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Gi(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=fr(u),b=kT(u),x=d*Math.pow(2,b);r.scaleTo(n,x,v,u);return}const f=u.deltaMode===1?20:1;let h=o===Zo.Vertical?0:u.deltaX*f,y=o===Zo.Horizontal?0:u.deltaY*f;!kf()&&u.shiftKey&&o!==Zo.Vertical&&(h=u.deltaY*f,y=0),r.translateBy(n,-(h/d)*a,-(y/d)*a,{internal:!0});const m=Tf(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function bZ({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||Gi(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function xZ({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var a,i,s;if((a=r.sourceEvent)!=null&&a.internal)return;const o=Tf(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function wZ({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return a=>{var i,s;e.usedRightMouseButton=!!(n&&MT(t,e.mouseButton??0)),(i=a.sourceEvent)!=null&&i.sync||r([a.transform.x,a.transform.y,a.transform.k]),o&&!((s=a.sourceEvent)!=null&&s.internal)&&(o==null||o(a.sourceEvent,Tf(a.transform)))}}function _Z({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:a}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,a&&MT(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&a(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&gZ(e.prevViewport,i.transform))){const c=Tf(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,c)},n?150:0)}}}function jZ({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:a,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var y;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Gi(u,`${l}-flow__node`)||Gi(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!o&&!a&&!n||i||Gi(u,s)&&u.type==="wheel"||Gi(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function EZ({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:a,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=H2().clickDistance(!yr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=Ln(e).call(f);_({x:a.x,y:a.y,zoom:Xi(a.zoom,t,n)},[[0,0],[d.width,d.height]],o);const y=h.on("wheel.zoom"),m=h.on("dblclick.zoom");f.wheelDelta(kT);function v(R,A){return h?new Promise(C=>{f==null||f.transform(Qb(h,A==null?void 0:A.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function b({noWheelClassName:R,noPanClassName:A,onPaneContextMenu:C,userSelectionActive:M,panOnScroll:T,panOnDrag:D,panOnScrollMode:I,panOnScrollSpeed:L,preventScrolling:B,zoomOnPinch:U,zoomOnScroll:F,zoomOnDoubleClick:H,zoomActivationKeyPressed:J,lib:q,onTransformChange:re}){M&&!u.isZoomingOrPanning&&x();const Z=T&&!J&&!M?vZ({zoomPanValues:u,noWheelClassName:R,d3Selection:h,d3Zoom:f,panOnScrollMode:I,panOnScrollSpeed:L,zoomOnPinch:U,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):bZ({noWheelClassName:R,preventScrolling:B,d3ZoomHandler:y});if(h.on("wheel.zoom",Z,{passive:!1}),!M){const W=xZ({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});f.on("start",W);const G=wZ({zoomPanValues:u,panOnDrag:D,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:re});f.on("zoom",G);const te=_Z({zoomPanValues:u,panOnDrag:D,panOnScroll:T,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});f.on("end",te)}const Y=jZ({zoomActivationKeyPressed:J,panOnDrag:D,zoomOnScroll:F,panOnScroll:T,zoomOnDoubleClick:H,zoomOnPinch:U,userSelectionActive:M,noPanClassName:A,noWheelClassName:R,lib:q});f.filter(Y),H?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function x(){f.on("zoom",null)}async function _(R,A,C){const M=Xb(R),T=f==null?void 0:f.constrain()(M,A,C);return T&&await v(T),new Promise(D=>D(T))}async function w(R,A){const C=Xb(R);return await v(C,A),new Promise(M=>M(C))}function j(R){if(h){const A=Xb(R),C=h.property("__zoom");(C.k!==R.zoom||C.x!==R.x||C.y!==R.y)&&(f==null||f.transform(h,A,null,{sync:!0}))}}function E(){const R=h?V2(h.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function S(R,A){return h?new Promise(C=>{f==null||f.scaleTo(Qb(h,A==null?void 0:A.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function O(R,A){return h?new Promise(C=>{f==null||f.scaleBy(Qb(h,A==null?void 0:A.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function k(R){f==null||f.scaleExtent(R)}function N(R){f==null||f.translateExtent(R)}function P(R){const A=!yr(R)||R<0?0:R;f==null||f.clickDistance(A)}return{update:b,destroy:x,setViewport:w,setViewportConstrained:_,getViewport:E,scaleTo:S,scaleBy:O,setScaleExtent:k,setTranslateExtent:N,syncViewport:j,setClickDistance:P}}var Zi;(function(e){e.Line="line",e.Handle="handle"})(Zi||(Zi={}));const SZ=["top-left","top-right","bottom-left","bottom-right"],CZ=["top","right","bottom","left"];function OZ({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:a}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&o&&(c[0]=c[0]*-1),s&&a&&(c[1]=c[1]*-1),c}function NZ(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function ta(e,t){return Math.max(0,t-e)}function na(e,t){return Math.max(0,e-t)}function Rf(e,t,n){return Math.max(0,t-e,e-n)}function PT(e,t){return e?!t:t}function MZ(e,t,n,r,o,a,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:h,ySnapped:y}=n,{minWidth:m,maxWidth:v,minHeight:b,maxHeight:x}=r,{x:_,y:w,width:j,height:E,aspectRatio:S}=e;let O=Math.floor(u?h-e.pointerX:0),k=Math.floor(d?y-e.pointerY:0);const N=j+(c?-O:O),P=E+(l?-k:k),R=-a[0]*j,A=-a[1]*E;let C=Rf(N,m,v),M=Rf(P,b,x);if(i){let I=0,L=0;c&&O<0?I=ta(_+O+R,i[0][0]):!c&&O>0&&(I=na(_+N+R,i[1][0])),l&&k<0?L=ta(w+k+A,i[0][1]):!l&&k>0&&(L=na(w+P+A,i[1][1])),C=Math.max(C,I),M=Math.max(M,L)}if(s){let I=0,L=0;c&&O>0?I=na(_+O,s[0][0]):!c&&O<0&&(I=ta(_+N,s[1][0])),l&&k>0?L=na(w+k,s[0][1]):!l&&k<0&&(L=ta(w+P,s[1][1])),C=Math.max(C,I),M=Math.max(M,L)}if(o){if(u){const I=Rf(N/S,b,x)*S;if(C=Math.max(C,I),i){let L=0;!c&&!l||c&&!l&&f?L=na(w+A+N/S,i[1][1])*S:L=ta(w+A+(c?O:-O)/S,i[0][1])*S,C=Math.max(C,L)}if(s){let L=0;!c&&!l||c&&!l&&f?L=ta(w+N/S,s[1][1])*S:L=na(w+(c?O:-O)/S,s[0][1])*S,C=Math.max(C,L)}}if(d){const I=Rf(P*S,m,v)/S;if(M=Math.max(M,I),i){let L=0;!c&&!l||l&&!c&&f?L=na(_+P*S+R,i[1][0])/S:L=ta(_+(l?k:-k)*S+R,i[0][0])/S,M=Math.max(M,L)}if(s){let L=0;!c&&!l||l&&!c&&f?L=ta(_+P*S,s[1][0])/S:L=na(_+(l?k:-k)*S,s[0][0])/S,M=Math.max(M,L)}}}k=k+(k<0?M:-M),O=O+(O<0?C:-C),o&&(f?N>P*S?k=(PT(c,l)?-O:O)/S:O=(PT(c,l)?-k:k)*S:u?(k=O/S,l=c):(O=k*S,c=l));const T=c?_+O:_,D=l?w+k:w;return{width:j+(c?-O:O),height:E+(l?-k:k),x:a[0]*O*(c?-1:1)+T,y:a[1]*k*(l?-1:1)+D}}const AT={width:0,height:0,x:0,y:0},kZ={...AT,pointerX:0,pointerY:0,aspectRatio:1};function PZ(e){return[[0,0],[e.measured.width,e.measured.height]]}function AZ(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,a=e.measured.width??0,i=e.measured.height??0,s=n[0]*a,c=n[1]*i;return[[r-s,o-c],[r+a-s,o+i-c]]}function TZ({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const a=Ln(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:h,shouldResize:y}){let m={...AT},v={...kZ};const b=NZ(c);let x,_=null,w=[],j,E,S;const O=p2().on("start",k=>{const{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:A,nodeOrigin:C,paneDomNode:M}=n();if(x=N.get(t),!x)return;_=(M==null?void 0:M.getBoundingClientRect())??null;const{xSnapped:T,ySnapped:D}=vl(k.sourceEvent,{transform:P,snapGrid:R,snapToGrid:A,containerBounds:_});m={width:x.measured.width??0,height:x.measured.height??0,x:x.position.x??0,y:x.position.y??0},v={...m,pointerX:T,pointerY:D,aspectRatio:m.width/m.height},j=void 0,x.parentId&&(x.extent==="parent"||x.expandParent)&&(j=N.get(x.parentId),E=j&&x.extent==="parent"?PZ(j):void 0),w=[],S=void 0;for(const[I,L]of N)if(L.parentId===t&&(w.push({id:I,position:{...L.position},extent:L.extent}),L.extent==="parent"||L.expandParent)){const B=AZ(L,x,L.origin??C);S?S=[[Math.min(B[0][0],S[0][0]),Math.min(B[0][1],S[0][1])],[Math.max(B[1][0],S[1][0]),Math.max(B[1][1],S[1][1])]]:S=B}d==null||d(k,{...m})}).on("drag",k=>{const{transform:N,snapGrid:P,snapToGrid:R,nodeOrigin:A}=n(),C=vl(k.sourceEvent,{transform:N,snapGrid:P,snapToGrid:R,containerBounds:_}),M=[];if(!x)return;const{x:T,y:D,width:I,height:L}=m,B={},U=x.origin??A,{width:F,height:H,x:J,y:q}=MZ(v,b,C,l,u,U,E,S),re=F!==I,Z=H!==L,Y=J!==T&&re,W=q!==D&&Z;if(!Y&&!W&&!re&&!Z)return;if((Y||W||U[0]===1||U[1]===1)&&(B.x=Y?J:m.x,B.y=W?q:m.y,m.x=B.x,m.y=B.y,w.length>0)){const $=J-T,se=q-D;for(const ue of w)ue.position={x:ue.position.x-$+U[0]*(F-I),y:ue.position.y-se+U[1]*(H-L)},M.push(ue)}if((re||Z)&&(B.width=re?F:m.width,B.height=Z?H:m.height,m.width=B.width,m.height=B.height),j&&x.expandParent){const $=U[0]*(B.width??0);B.x&&B.x<$&&(m.x=$,v.x=v.x-(B.x-$));const se=U[1]*(B.height??0);B.y&&B.y<se&&(m.y=se,v.y=v.y-(B.y-se))}const G=OZ({width:m.width,prevWidth:I,height:m.height,prevHeight:L,affectsX:b.affectsX,affectsY:b.affectsY}),te={...m,direction:G};(y==null?void 0:y(k,te))!==!1&&(f==null||f(k,te),r(B,M))}).on("end",k=>{h==null||h(k,{...m}),o==null||o()});a.call(O)}function s(){a.on(".drag",null)}return{update:i,destroy:s}}var TT={exports:{}},Jb={},RT;function RZ(){if(RT)return Jb;RT=1;var e=$9(),t=KM();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return Jb.useSyncExternalStoreWithSelector=function(l,u,d,f,h){var y=a(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=s(function(){function b(E){if(!x){if(x=!0,_=E,E=f(E),h!==void 0&&m.hasValue){var S=m.value;if(h(S,E))return w=S}return w=E}if(S=w,r(_,E))return S;var O=f(E);return h!==void 0&&h(S,O)?S:(_=E,w=O)}var x=!1,_,w,j=d===void 0?null:d;return[function(){return b(u())},j===null?void 0:function(){return b(j())}]},[u,d,f,h]);var v=o(l,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),c(v),v},Jb}var IT;function IZ(){return IT||(IT=1,TT.exports=RZ()),TT.exports}var DZ=IZ();let DT,Gb,LT,FT,BT,$T;DE=Xe(DZ),DT={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},Gb=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},o=()=>t,a={setState:r,getState:o,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(DT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,o,a);return a},LT=e=>e?Gb(e):Gb,{useDebugValue:FT}=V,{useSyncExternalStoreWithSelector:BT}=DE,$T=e=>e;function zT(e,t=$T,n){const r=BT(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return FT(r),r}const VT=(e,t)=>{const n=LT(e),r=(o,a=t)=>zT(n,o,a);return Object.assign(r,n),r},LZ=(e,t)=>e?VT(e,t):VT;function jt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const If=g.createContext(null),FZ=If.Provider,UT=bo.error001();function Ve(e,t){const n=g.useContext(If);if(n===null)throw new Error(UT);return zT(n,e,t)}function vt(){const e=g.useContext(If);if(e===null)throw new Error(UT);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const HT={display:"none"},BZ={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},WT="react-flow__node-desc",qT="react-flow__edge-desc",$Z="react-flow__aria-live",zZ=e=>e.ariaLiveMessage;function VZ({rfId:e}){const t=Ve(zZ);return p.jsx("div",{id:`${$Z}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:BZ,children:t})}function UZ({rfId:e,disableKeyboardA11y:t}){return p.jsxs(p.Fragment,{children:[p.jsxs("div",{id:`${WT}-${e}`,style:HT,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),p.jsx("div",{id:`${qT}-${e}`,style:HT,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&p.jsx(VZ,{rfId:e})]})}const HZ=e=>e.userSelectionActive?"none":"all";function es({position:e="top-left",children:t,className:n,style:r,...o}){const a=Ve(HZ),i=`${e}`.split("-");return p.jsx("div",{className:It(["react-flow__panel",n,...i]),style:{...r,pointerEvents:a},...o,children:t})}function WZ({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:p.jsx(es,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:p.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const qZ=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Df=e=>e.id;function YZ(e,t){return jt(e.selectedNodes.map(Df),t.selectedNodes.map(Df))&&jt(e.selectedEdges.map(Df),t.selectedEdges.map(Df))}function KZ({onSelectionChange:e}){const t=vt(),{selectedNodes:n,selectedEdges:r}=Ve(qZ,YZ);return g.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(a=>a(o))},[n,r,e]),null}const XZ=e=>!!e.onSelectionChangeHandlers;function QZ({onSelectionChange:e}){const t=Ve(XZ);return e||t?p.jsx(KZ,{onSelectionChange:e}):null}const YT=[0,0],JZ={x:0,y:0,zoom:1},GZ=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],KT=[...GZ,"rfId"],ZZ=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),XT={translateExtent:fl,nodeOrigin:YT,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function eee(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:a,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Ve(ZZ,jt),u=vt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=XT,s()}),[]);const d=g.useRef(XT);return g.useEffect(()=>{for(const f of KT){const h=e[f],y=d.current[f];h!==y&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?o(h):f==="translateExtent"?a(h):f==="nodeExtent"?i(h):f==="paneClickDistance"?l(h):f==="fitView"?u.setState({fitViewOnInit:h}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:h}):u.setState({[f]:h})))}d.current=e},KT.map(f=>e[f])),null}function QT(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function tee(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const o=QT(),a=()=>n(o!=null&&o.matches?"dark":"light");return a(),o==null||o.addEventListener("change",a),()=>{o==null||o.removeEventListener("change",a)}},[e]),t!==null?t:(r=QT())!=null&&r.matches?"dark":"light"}const JT=typeof document<"u"?document:null;function xl(e=null,t={target:JT,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),o=g.useRef(!1),a=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||JT;if(e!==null){const l=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&Bb(f))return!1;const h=ZT(f.code,s);a.current.add(f[h]),GT(i,a.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Bb(f))return!1;const h=ZT(f.code,s);GT(i,a.current,!0)?(r(!1),a.current.clear()):a.current.delete(f[h]),f.key==="Meta"&&a.current.clear(),o.current=!1},d=()=>{a.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function GT(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function ZT(e,t){return t.includes(e)?"code":"key"}const nee=()=>{const e=vt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,a],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??a},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:o,panZoom:a,domNode:i}=e.getState();if(!a||!i)return Promise.resolve(!1);const s=Ib(n,t),{width:c,height:l}=Pf(i);return Db({nodes:s,width:c,height:l,minZoom:r,maxZoom:o,panZoom:a},t)},setCenter:async(t,n,r)=>{const{width:o,height:a,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=o/2-t*c,u=a/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:a,maxZoom:i,panZoom:s}=e.getState(),c=Fb(t,r,o,a,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:o,domNode:a}=e.getState();if(!a)return t;const{x:i,y:s}=a.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return gl(c,r,n.snapToGrid,o)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:a}=r.getBoundingClientRect(),i=oT(t,n);return{x:i.x+o,y:i.y+a}}}),[])};function eR(e,t){const n=[],r=new Map,o=[];for(const a of e)if(a.type==="add"){o.push(a);continue}else if(a.type==="remove"||a.type==="replace")r.set(a.id,[a]);else{const i=r.get(a.id);i?i.push(a):r.set(a.id,[a])}for(const a of t){const i=r.get(a.id);if(!i){n.push(a);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...a};for(const c of i)ree(c,s);n.push(s)}return o.length&&o.forEach(a=>{a.index!==void 0?n.splice(a.index,0,{...a.item}):n.push({...a.item})}),n}function ree(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ba(e,t){return eR(e,t)}function wl(e,t){return eR(e,t)}function $a(e,t){return{id:e,type:"select",selected:t}}function ts(e,t=new Set,n=!1){const r=[];for(const[o,a]of e){const i=t.has(o);!(a.selected===void 0&&!i)&&a.selected!==i&&(n&&(a.selected=i),r.push($a(a.id,i)))}return r}function tR({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(a=>[a.id,a]));for(const[a,i]of e.entries()){const s=t.get(i.id),c=((o=s==null?void 0:s.internals)==null?void 0:o.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:a})}for(const[a]of t)r.get(a)===void 0&&n.push({id:a,type:"remove"});return n}function nR(e){return{id:e.id,type:"remove"}}const rR=e=>VG(e),oee=e=>Q2(e);function oR(e){return g.forwardRef(e)}const aee=typeof window<"u"?g.useLayoutEffect:g.useEffect;function aR(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>iee(()=>n(o=>o+BigInt(1))));return aee(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function iee(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const iR=g.createContext(null);function see({children:e}){const t=vt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let h=c;for(const y of s)h=typeof y=="function"?y(h):y;u?l(h):d&&d(tR({items:h,lookup:f}))},[]),r=aR(n),o=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let h=c;for(const y of s)h=typeof y=="function"?y(h):y;u?l(h):d&&d(tR({items:h,lookup:f}))},[]),a=aR(o),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:a}),[]);return p.jsx(iR.Provider,{value:i,children:e})}function cee(){const e=g.useContext(iR);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const lee=e=>!!e.panZoom;function Fn(){const e=nee(),t=vt(),n=cee(),r=Ve(lee),o=g.useMemo(()=>{const a=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,x;const{nodeLookup:f,nodeOrigin:h}=t.getState(),y=rR(d)?d:f.get(d.id),m=y.parentId?iT(y.position,y.measured,y.parentId,f,h):y.position,v={id:y.id,position:m,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((x=y.measured)==null?void 0:x.height)??y.height,data:y.data};return Qi(v)},l=(d,f,h={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return h.replace&&rR(v)?v:{...m,...v}}return m}))},u=(d,f,h={replace:!1})=>{s(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return h.replace&&oee(v)?v:{...m,...v}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=a(d))==null?void 0:f.internals.userNode},getInternalNode:a,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[y,m,v]=h;return{nodes:d.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:y,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:y,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:x,onDelete:_,onBeforeDelete:w}=t.getState(),{nodes:j,edges:E}=await WG({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:y,onBeforeDelete:w}),S=E.length>0,O=j.length>0;if(S){const k=E.map(nR);v==null||v(E),x(k)}if(O){const k=j.map(nR);m==null||m(j),b(k)}return(O||S)&&(_==null||_({nodes:j,edges:E})),{deletedNodes:j,deletedEdges:E}},getIntersectingNodes:(d,f=!0,h)=>{const y=rT(d),m=y?d:c(d),v=h!==void 0;return m?(h||t.getState().nodes).filter(b=>{const x=t.getState().nodeLookup.get(b.id);if(x&&!y&&(b.id===d.id||!x.internals.positionAbsolute))return!1;const _=Qi(v?b:x),w=yl(_,m);return f&&w>0||w>=m.width*m.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const y=rT(d)?d:c(d);if(!y)return!1;const m=yl(y,f);return h&&m>0||m>=y.width*y.height},updateNode:l,updateNodeData:(d,f,h={replace:!1})=>{l(d,y=>{const m=typeof f=="function"?f(y):f;return h.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},h)},updateEdge:u,updateEdgeData:(d,f,h={replace:!1})=>{u(d,y=>{const m=typeof f=="function"?f(y):f;return h.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return UG(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${h}-${d}-${f??null}`))==null?void 0:y.values())??[])}}},[]);return g.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const sR=e=>e.selected,uee={actInsideInputWithModifier:!1},dee=typeof window<"u"?window:void 0;function fee({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=vt(),{deleteElements:r}=Fn(),o=xl(e,uee),a=xl(t,{target:dee});g.useEffect(()=>{if(o){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(sR),edges:i.filter(sR)}),n.setState({nodesSelectionActive:!1})}},[o]),g.useEffect(()=>{n.setState({multiSelectionActive:a})},[a])}function pee(e){const t=vt();g.useEffect(()=>{const n=()=>{var o,a;if(!e.current)return!1;const r=Pf(e.current);(r.height===0||r.width===0)&&((a=(o=t.getState()).onError)==null||a.call(o,"004",bo.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Lf={position:"absolute",width:"100%",height:"100%",top:0,left:0},hee=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function mee({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:a=Zo.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:y,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:x,paneClickDistance:_}){const w=vt(),j=g.useRef(null),{userSelectionActive:E,lib:S}=Ve(hee,jt),O=xl(f),k=g.useRef();pee(j);const N=g.useCallback(P=>{b==null||b({x:P[0],y:P[1],zoom:P[2]}),x||w.setState({transform:P})},[b,x]);return g.useEffect(()=>{if(j.current){k.current=EZ({domNode:j.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>w.setState({paneDragging:C}),onPanZoomStart:(C,M)=>{const{onViewportChangeStart:T,onMoveStart:D}=w.getState();D==null||D(C,M),T==null||T(M)},onPanZoom:(C,M)=>{const{onViewportChange:T,onMove:D}=w.getState();D==null||D(C,M),T==null||T(M)},onPanZoomEnd:(C,M)=>{const{onViewportChangeEnd:T,onMoveEnd:D}=w.getState();D==null||D(C,M),T==null||T(M)}});const{x:P,y:R,zoom:A}=k.current.getViewport();return w.setState({panZoom:k.current,transform:[P,R,A],domNode:j.current.closest(".react-flow")}),()=>{var C;(C=k.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var P;(P=k.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:a,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:h,noPanClassName:v,userSelectionActive:E,noWheelClassName:m,lib:S,onTransformChange:N})},[e,t,n,r,o,a,i,s,O,h,v,E,m,S,N]),p.jsx("div",{className:"react-flow__renderer",ref:j,style:Lf,children:y})}const yee=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function gee(){const{userSelectionActive:e,userSelectionRect:t}=Ve(yee,jt);return e&&t?p.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Zb=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},vee=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function bee({isSelecting:e,selectionKeyPressed:t,selectionMode:n=pl.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:a,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:h}){const y=g.useRef(null),m=vt(),v=g.useRef(0),b=g.useRef(0),x=g.useRef(),_=g.useRef(new Map),{userSelectionActive:w,elementsSelectable:j,dragging:E}=Ve(vee,jt),S=j&&(e||w),O=g.useRef(!1),k=g.useRef(!1),N=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},P=I=>{if(O.current){O.current=!1;return}s==null||s(I),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},R=I=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){I.preventDefault();return}c==null||c(I)},A=l?I=>l(I):void 0,C=I=>{var J,q,re,Z;const{resetSelectedElements:L,domNode:B,edgeLookup:U}=m.getState();if(x.current=B==null?void 0:B.getBoundingClientRect(),!j||!e||I.button!==0||I.target!==y.current||!x.current)return;(q=(J=I.target)==null?void 0:J.setPointerCapture)==null||q.call(J,I.pointerId),k.current=!0,O.current=!1,_.current=new Map;for(const[Y,W]of U)_.current.set(W.source,((re=_.current.get(W.source))==null?void 0:re.add(Y))||new Set([Y])),_.current.set(W.target,((Z=_.current.get(W.target))==null?void 0:Z.add(Y))||new Set([Y]));const{x:F,y:H}=wo(I.nativeEvent,x.current);L(),m.setState({userSelectionRect:{width:0,height:0,startX:F,startY:H,x:F,y:H}}),a==null||a(I)},M=I=>{const{userSelectionRect:L,edgeLookup:B,transform:U,nodeLookup:F,triggerNodeChanges:H,triggerEdgeChanges:J}=m.getState();if(!x.current||!L)return;O.current=!0;const{x:q,y:re}=wo(I.nativeEvent,x.current),{startX:Z,startY:Y}=L,W={startX:Z,startY:Y,x:q<Z?q:Z,y:re<Y?re:Y,width:Math.abs(q-Z),height:Math.abs(re-Y)},G=J2(F,W,U,n===pl.Partial,!0),te=new Set,$=new Set;for(const se of G){$.add(se.id);const ue=_.current.get(se.id);if(ue)for(const ve of ue)te.add(ve)}if(v.current!==$.size){v.current=$.size;const se=ts(F,$,!0);H(se)}if(b.current!==te.size){b.current=te.size;const se=ts(B,te);J(se)}m.setState({userSelectionRect:W,userSelectionActive:!0,nodesSelectionActive:!1})},T=I=>{var B,U;if(I.button!==0||!k.current)return;(U=(B=I.target)==null?void 0:B.releasePointerCapture)==null||U.call(B,I.pointerId);const{userSelectionRect:L}=m.getState();!w&&L&&I.target===y.current&&(P==null||P(I)),v.current>0&&m.setState({nodesSelectionActive:!0}),N(),i==null||i(I),(t||o)&&(O.current=!1),k.current=!1},D=r===!0||Array.isArray(r)&&r.includes(0);return p.jsxs("div",{className:It(["react-flow__pane",{draggable:D,dragging:E,selection:e}]),onClick:S?void 0:Zb(P,y),onContextMenu:Zb(R,y),onWheel:Zb(A,y),onPointerEnter:S?void 0:u,onPointerDown:S?C:d,onPointerMove:S?M:d,onPointerUp:S?T:void 0,onPointerLeave:f,ref:y,style:Lf,children:[h,p.jsx(gee,{})]})}function ex({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:a,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",bo.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(a({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function cR({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:a,nodeClickDistance:i}){const s=vt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=uZ({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{ex({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:a,nodeId:o,nodeClickDistance:i}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,a,e,o]),c}const xee=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function lR(){const e=vt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:o,nodesDraggable:a,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=xee(a),f=r?o[0]:5,h=r?o[1]:5,y=t.direction.x*f*t.factor,m=t.direction.y*h*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+y,y:v.internals.positionAbsolute.y+m};r&&(b=Mf(b,o));const{position:x,positionAbsolute:_}=G2({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=x,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const tx=g.createContext(null),wee=tx.Provider;tx.Consumer;const nx=()=>g.useContext(tx),_ee=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),jee=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:a,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:a===Ki.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Eee({type:e="source",position:t=fe.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:a=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h){var C,M;const y=i||null,m=e==="target",v=vt(),b=nx(),{connectOnClick:x,noPanClassName:_,rfId:w}=Ve(_ee,jt),{connectingFrom:j,connectingTo:E,clickConnecting:S,isPossibleEndHandle:O,connectionInProcess:k,valid:N}=Ve(jee(b,y,e),jt);b||((M=(C=v.getState()).onError)==null||M.call(C,"010",bo.error010()));const P=T=>{const{defaultEdgeOptions:D,onConnect:I,hasDefaultEdges:L}=v.getState(),B={...D,...T};if(L){const{edges:U,setEdges:F}=v.getState();F(hT(B,U))}I==null||I(B),s==null||s(B)},R=T=>{if(!b)return;const D=cT(T.nativeEvent);if(o&&(D&&T.button===0||!D)){const I=v.getState();Kb.onPointerDown(T.nativeEvent,{autoPanOnConnect:I.autoPanOnConnect,connectionMode:I.connectionMode,connectionRadius:I.connectionRadius,domNode:I.domNode,nodeLookup:I.nodeLookup,lib:I.lib,isTarget:m,handleId:y,nodeId:b,flowId:I.rfId,panBy:I.panBy,cancelConnection:I.cancelConnection,onConnectStart:I.onConnectStart,onConnectEnd:I.onConnectEnd,updateConnection:I.updateConnection,onConnect:P,isValidConnection:n||I.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:I.autoPanSpeed})}D?u==null||u(T):d==null||d(T)},A=T=>{const{onClickConnectStart:D,onClickConnectEnd:I,connectionClickStartHandle:L,connectionMode:B,isValidConnection:U,lib:F,rfId:H,nodeLookup:J,connection:q}=v.getState();if(!b||!L&&!o)return;if(!L){D==null||D(T.nativeEvent,{nodeId:b,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const re=sT(T.target),Z=n||U,{connection:Y,isValid:W}=Kb.isValid(T.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:B,fromNodeId:L.nodeId,fromHandleId:L.id||null,fromType:L.type,isValidConnection:Z,flowId:H,doc:re,lib:F,nodeLookup:J});W&&Y&&P(Y);const G=structuredClone(q);delete G.inProgress,G.toPosition=G.toHandle?G.toHandle.position:null,I==null||I(T,G),v.setState({connectionClickStartHandle:null})};return p.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${y}-${e}`,className:It(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!m,target:m,connectable:r,connectablestart:o,connectableend:a,clickconnecting:S,connectingfrom:j,connectingto:E,valid:N,connectionindicator:r&&(!k||O)&&(k?a:o)}]),onMouseDown:R,onTouchStart:R,onClick:x?A:void 0,ref:h,...f,children:c})}const _l=g.memo(oR(Eee));function See({data:e,isConnectable:t,sourcePosition:n=fe.Bottom}){return p.jsxs(p.Fragment,{children:[e==null?void 0:e.label,p.jsx(_l,{type:"source",position:n,isConnectable:t})]})}function Cee({data:e,isConnectable:t,targetPosition:n=fe.Top,sourcePosition:r=fe.Bottom}){return p.jsxs(p.Fragment,{children:[p.jsx(_l,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,p.jsx(_l,{type:"source",position:r,isConnectable:t})]})}function Oee(){return null}function Nee({data:e,isConnectable:t,targetPosition:n=fe.Top}){return p.jsxs(p.Fragment,{children:[p.jsx(_l,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ff={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},uR={input:See,default:Cee,output:Nee,group:Oee};function Mee(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const kee=e=>{const{width:t,height:n,x:r,y:o}=ml(e.nodeLookup,{filter:a=>!!a.selected});return{width:yr(t)?t:null,height:yr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function Pee({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=vt(),{width:o,height:a,transformString:i,userSelectionActive:s}=Ve(kee,jt),c=lR(),l=g.useRef(null);if(g.useEffect(()=>{var f;n||((f=l.current)==null||f.focus({preventScroll:!0}))},[n]),cR({nodeRef:l}),s||!o||!a)return null;const u=e?f=>{const h=r.getState().nodes.filter(y=>y.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Ff,f.key)&&c({direction:Ff[f.key],factor:f.shiftKey?4:1})};return p.jsx("div",{className:It(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:p.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:o,height:a}})})}const dR=typeof window<"u"?window:void 0,Aee=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function fR({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:a,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:x,zoomOnPinch:_,panOnScroll:w,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:O,defaultViewport:k,translateExtent:N,minZoom:P,maxZoom:R,preventScrolling:A,onSelectionContextMenu:C,noWheelClassName:M,noPanClassName:T,disableKeyboardA11y:D,onViewportChange:I,isControlledViewport:L}){const{nodesSelectionActive:B,userSelectionActive:U}=Ve(Aee),F=xl(l,{target:dR}),H=xl(m,{target:dR}),J=H||O,q=H||w,re=u&&J!==!0,Z=F||U||re;return fee({deleteKeyCode:c,multiSelectionKeyCode:y}),p.jsx(mee,{onPaneContextMenu:a,elementsSelectable:b,zoomOnScroll:x,zoomOnPinch:_,panOnScroll:q,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:!F&&J,defaultViewport:k,translateExtent:N,minZoom:P,maxZoom:R,zoomActivationKeyCode:v,preventScrolling:A,noWheelClassName:M,noPanClassName:T,onViewportChange:I,isControlledViewport:L,paneClickDistance:s,children:p.jsxs(bee,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:a,onPaneScroll:i,panOnDrag:J,isSelecting:!!Z,selectionMode:d,selectionKeyPressed:F,selectionOnDrag:re,children:[e,B&&p.jsx(Pee,{onSelectionContextMenu:C,noPanClassName:T,disableKeyboardA11y:D})]})})}fR.displayName="FlowRenderer";const Tee=g.memo(fR),Ree=e=>t=>e?J2(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Iee(e){return Ve(g.useCallback(Ree(e),[e]),jt)}const Dee=e=>e.updateNodeInternals;function Lee(){const e=Ve(Dee),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const a=o.target.getAttribute("data-id");r.set(a,{id:a,nodeElement:o.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Fee({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=vt(),a=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{a.current&&!e.hidden&&(!u||i.current!==a.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(a.current),i.current=a.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(a.current){const d=l.current!==t,f=s.current!==e.sourcePosition,h=c.current!==e.targetPosition;(d||f||h)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}function Bee({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:a,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:y,rfId:m,nodeTypes:v,nodeExtent:b,nodeClickDistance:x,onError:_}){const{node:w,internals:j,isParent:E}=Ve(Y=>{const W=Y.nodeLookup.get(e),G=Y.parentLookup.has(e);return{node:W,internals:W.internals,isParent:G}},jt);let S=w.type||"default",O=(v==null?void 0:v[S])||uR[S];O===void 0&&(_==null||_("003",bo.error003(S)),S="default",O=uR.default);const k=!!(w.draggable||s&&typeof w.draggable>"u"),N=!!(w.selectable||c&&typeof w.selectable>"u"),P=!!(w.connectable||l&&typeof w.connectable>"u"),R=!!(w.focusable||u&&typeof w.focusable>"u"),A=vt(),C=aT(w),M=Fee({node:w,nodeType:S,hasDimensions:C,resizeObserver:d}),T=cR({nodeRef:M,disabled:w.hidden||!k,noDragClassName:f,handleSelector:w.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:x}),D=lR();if(w.hidden)return null;const I=xo(w),L=Mee(w),B=N||k||t||n||r||o,U=n?Y=>n(Y,{...j.userNode}):void 0,F=r?Y=>r(Y,{...j.userNode}):void 0,H=o?Y=>o(Y,{...j.userNode}):void 0,J=a?Y=>a(Y,{...j.userNode}):void 0,q=i?Y=>i(Y,{...j.userNode}):void 0,re=Y=>{const{selectNodesOnDrag:W,nodeDragThreshold:G}=A.getState();N&&(!W||!k||G>0)&&ex({id:e,store:A,nodeRef:M}),t&&t(Y,{...j.userNode})},Z=Y=>{if(!(Bb(Y.nativeEvent)||y))if(W2.includes(Y.key)&&N){const W=Y.key==="Escape";ex({id:e,store:A,unselect:W,nodeRef:M})}else k&&w.selected&&Object.prototype.hasOwnProperty.call(Ff,Y.key)&&(A.setState({ariaLiveMessage:`Moved selected node ${Y.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~j.positionAbsolute.x}, y: ${~~j.positionAbsolute.y}`}),D({direction:Ff[Y.key],factor:Y.shiftKey?4:1}))};return p.jsx("div",{className:It(["react-flow__node",`react-flow__node-${S}`,{[h]:k},w.className,{selected:w.selected,selectable:N,parent:E,draggable:k,dragging:T}]),ref:M,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:B?"all":"none",visibility:C?"visible":"hidden",...w.style,...L},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:U,onMouseMove:F,onMouseLeave:H,onContextMenu:J,onClick:re,onDoubleClick:q,onKeyDown:R?Z:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":y?void 0:`${WT}-${m}`,"aria-label":w.ariaLabel,children:p.jsx(wee,{value:e,children:p.jsx(O,{id:e,data:w.data,type:S,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:w.selected,selectable:N,draggable:k,deletable:w.deletable??!0,isConnectable:P,sourcePosition:w.sourcePosition,targetPosition:w.targetPosition,dragging:T,dragHandle:w.dragHandle,zIndex:j.z,parentId:w.parentId,...I})})})}const $ee=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function pR(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:a}=Ve($ee,jt),i=Iee(e.onlyRenderVisibleElements),s=Lee();return p.jsx("div",{className:"react-flow__nodes",style:Lf,children:i.map(c=>p.jsx(Bee,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:a},c))})}pR.displayName="NodeRenderer";const zee=g.memo(pR);function Vee(e){return Ve(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const o=t.nodeLookup.get(r.source),a=t.nodeLookup.get(r.target);o&&a&&XG({sourceNode:o,targetNode:a,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),jt)}const Uee=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Hee=({color:e="none",strokeWidth:t=1})=>p.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),hR={[Sf.Arrow]:Uee,[Sf.ArrowClosed]:Hee};function Wee(e){const t=vt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(hR,e)?hR[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",bo.error009(e)),null)},[e])}const qee=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:a="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=Wee(t);return c?p.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:s,refX:"0",refY:"0",children:p.jsx(c,{color:n,strokeWidth:i})}):null},mR=({defaultColor:e,rfId:t})=>{const n=Ve(a=>a.edges),r=Ve(a=>a.defaultEdgeOptions),o=g.useMemo(()=>nZ(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?p.jsx("svg",{className:"react-flow__marker",children:p.jsx("defs",{children:o.map(a=>p.jsx(qee,{id:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient},a.id))})}):null};mR.displayName="MarkerDefinitions";var Yee=g.memo(mR);function yR({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:a={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,f]=g.useState({x:1,y:0,width:0,height:0}),h=It(["react-flow__edge-textwrapper",l]),y=g.useRef(null);return g.useEffect(()=>{if(y.current){const m=y.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:p.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[o&&p.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:a,rx:s,ry:s}),p.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]})}yR.displayName="EdgeText";const Kee=g.memo(yR);function Bf({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:a,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,className:h,interactionWidth:y=20}){return p.jsxs(p.Fragment,{children:[p.jsx("path",{id:e,style:u,d:t,fill:"none",className:It(["react-flow__edge-path",h]),markerEnd:d,markerStart:f}),y&&p.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),o&&yr(n)&&yr(r)?p.jsx(Kee,{x:n,y:r,label:o,labelStyle:a,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function gR({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===fe.Left||e===fe.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function vR({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:o,targetPosition:a=fe.Top}){const[i,s]=gR({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=gR({pos:a,x1:r,y1:o,x2:e,y2:t}),[u,d,f,h]=uT({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${o}`,u,d,f,h]}function bR(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:a,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:v,interactionWidth:b})=>{const[x,_,w]=vR({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:a,targetPosition:s}),j=e.isInternal?void 0:t;return p.jsx(Bf,{id:j,path:x,labelX:_,labelY:w,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:v,interactionWidth:b})})}const Xee=bR({isInternal:!1}),xR=bR({isInternal:!0});Xee.displayName="SimpleBezierEdge",xR.displayName="SimpleBezierEdgeInternal";function wR(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:a,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:h=fe.Bottom,targetPosition:y=fe.Top,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:x})=>{const[_,w,j]=$b({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:a,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),E=e.isInternal?void 0:t;return p.jsx(Bf,{id:E,path:_,labelX:w,labelY:j,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:v,interactionWidth:x})})}const _R=wR({isInternal:!1}),jR=wR({isInternal:!0});_R.displayName="SmoothStepEdge",jR.displayName="SmoothStepEdgeInternal";function ER(e){return g.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return p.jsx(_R,{...n,id:r,pathOptions:g.useMemo(()=>{var a;return{borderRadius:0,offset:(a=n.pathOptions)==null?void 0:a.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Qee=ER({isInternal:!1}),SR=ER({isInternal:!0});Qee.displayName="StepEdge",SR.displayName="StepEdgeInternal";function CR(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:a,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:y,interactionWidth:m})=>{const[v,b,x]=mT({sourceX:n,sourceY:r,targetX:o,targetY:a}),_=e.isInternal?void 0:t;return p.jsx(Bf,{id:_,path:v,labelX:b,labelY:x,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:y,interactionWidth:m})})}const Jee=CR({isInternal:!1}),OR=CR({isInternal:!0});Jee.displayName="StraightEdge",OR.displayName="StraightEdgeInternal";function NR(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:a,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:x})=>{const[_,w,j]=fT({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:a,targetPosition:s,curvature:b==null?void 0:b.curvature}),E=e.isInternal?void 0:t;return p.jsx(Bf,{id:E,path:_,labelX:w,labelY:j,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:v,interactionWidth:x})})}const Gee=NR({isInternal:!1}),MR=NR({isInternal:!0});Gee.displayName="BezierEdge",MR.displayName="BezierEdgeInternal";const kR={default:MR,straight:OR,step:SR,smoothstep:jR,simplebezier:xR},PR={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Zee=(e,t,n)=>n===fe.Left?e-t:n===fe.Right?e+t:e,ete=(e,t,n)=>n===fe.Top?e-t:n===fe.Bottom?e+t:e,AR="react-flow__edgeupdater";function TR({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:a,onMouseOut:i,type:s}){return p.jsx("circle",{onMouseDown:o,onMouseEnter:a,onMouseOut:i,className:It([AR,`${AR}-${s}`]),cx:Zee(t,r,e),cy:ete(n,r,e),r,stroke:"transparent",fill:"transparent"})}function tte({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:a,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const y=vt(),m=(w,j)=>{if(w.button!==0)return;const{autoPanOnConnect:E,domNode:S,isValidConnection:O,connectionMode:k,connectionRadius:N,lib:P,onConnectStart:R,onConnectEnd:A,cancelConnection:C,nodeLookup:M,rfId:T,panBy:D,updateConnection:I}=y.getState(),L=j.type==="target";f(!0),u==null||u(w,n,j.type);const B=(F,H)=>{f(!1),d==null||d(F,n,j.type,H)},U=F=>l==null?void 0:l(n,F);Kb.onPointerDown(w.nativeEvent,{autoPanOnConnect:E,connectionMode:k,connectionRadius:N,domNode:S,handleId:j.id,nodeId:j.nodeId,nodeLookup:M,isTarget:L,edgeUpdaterType:j.type,lib:P,flowId:T,cancelConnection:C,panBy:D,isValidConnection:O,onConnect:U,onConnectStart:R,onConnectEnd:A,onReconnectEnd:B,updateConnection:I,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},v=w=>m(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>m(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),x=()=>h(!0),_=()=>h(!1);return p.jsxs(p.Fragment,{children:[(e===!0||e==="source")&&p.jsx(TR,{position:s,centerX:r,centerY:o,radius:t,onMouseDown:v,onMouseEnter:x,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&p.jsx(TR,{position:c,centerX:a,centerY:i,radius:t,onMouseDown:b,onMouseEnter:x,onMouseOut:_,type:"target"})]})}function nte({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:a,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:y,edgeTypes:m,noPanClassName:v,onError:b,disableKeyboardA11y:x}){let _=Ve($=>$.edgeLookup.get(e));const w=Ve($=>$.defaultEdgeOptions);_=w?{...w,..._}:_;let j=_.type||"default",E=(m==null?void 0:m[j])||kR[j];E===void 0&&(b==null||b("011",bo.error011(j)),j="default",E=kR.default);const S=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),k=!!(_.selectable||r&&typeof _.selectable>"u"),N=g.useRef(null),[P,R]=g.useState(!1),[A,C]=g.useState(!1),M=vt(),{zIndex:T,sourceX:D,sourceY:I,targetX:L,targetY:B,sourcePosition:U,targetPosition:F}=Ve(g.useCallback($=>{const se=$.nodeLookup.get(_.source),ue=$.nodeLookup.get(_.target);if(!se||!ue)return{zIndex:_.zIndex,...PR};const ve=tZ({id:e,sourceNode:se,targetNode:ue,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:$.connectionMode,onError:b});return{zIndex:KG({selected:_.selected,zIndex:_.zIndex,sourceNode:se,targetNode:ue,elevateOnSelect:$.elevateEdgesOnSelect}),...ve||PR}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),jt),H=g.useMemo(()=>_.markerStart?`url('#${zb(_.markerStart,y)}')`:void 0,[_.markerStart,y]),J=g.useMemo(()=>_.markerEnd?`url('#${zb(_.markerEnd,y)}')`:void 0,[_.markerEnd,y]);if(_.hidden||D===null||I===null||L===null||B===null)return null;const q=$=>{var Te;const{addSelectedEdges:se,unselectNodesAndEdges:ue,multiSelectionActive:ve}=M.getState();k&&(M.setState({nodesSelectionActive:!1}),_.selected&&ve?(ue({nodes:[],edges:[_]}),(Te=N.current)==null||Te.blur()):se([e])),o&&o($,_)},re=a?$=>{a($,{..._})}:void 0,Z=i?$=>{i($,{..._})}:void 0,Y=s?$=>{s($,{..._})}:void 0,W=c?$=>{c($,{..._})}:void 0,G=l?$=>{l($,{..._})}:void 0,te=$=>{var se;if(!x&&W2.includes($.key)&&k){const{unselectNodesAndEdges:ue,addSelectedEdges:ve}=M.getState();$.key==="Escape"?((se=N.current)==null||se.blur(),ue({edges:[_]})):ve([e])}};return p.jsx("svg",{style:{zIndex:T},children:p.jsxs("g",{className:It(["react-flow__edge",`react-flow__edge-${j}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!k&&!o,updating:P,selectable:k}]),onClick:q,onDoubleClick:re,onContextMenu:Z,onMouseEnter:Y,onMouseMove:W,onMouseLeave:G,onKeyDown:S?te:void 0,tabIndex:S?0:void 0,role:S?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":S?`${qT}-${y}`:void 0,ref:N,children:[!A&&p.jsx(E,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:k,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:D,sourceY:I,targetX:L,targetY:B,sourcePosition:U,targetPosition:F,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:H,markerEnd:J,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&p.jsx(tte,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:D,sourceY:I,targetX:L,targetY:B,sourcePosition:U,targetPosition:F,setUpdateHover:R,setReconnecting:C})]})})}const rte=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function RR({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:a,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:x,onError:_}=Ve(rte,jt),w=Vee(t);return p.jsxs("div",{className:"react-flow__edges",children:[p.jsx(Yee,{defaultColor:e,rfId:n}),w.map(j=>p.jsx(nte,{id:j,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:x,noPanClassName:o,onReconnect:a,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:y,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:m},j))]})}RR.displayName="EdgeRenderer";const ote=g.memo(RR),ate=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ite({children:e}){const t=Ve(ate);return p.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function ste(e){const t=Fn(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const cte=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function lte(e){const t=Ve(cte),n=vt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ute(e){return e.connection.inProgress?{...e.connection,to:gl(e.connection.to,e.transform)}:{...e.connection}}function dte(e){return ute}function fte(e){const t=dte();return Ve(t,jt)}const pte=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function hte({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:a,height:i,isValid:s,inProgress:c}=Ve(pte,jt);return a&&o&&c?p.jsx("svg",{style:e,width:a,height:i,className:"react-flow__connectionline react-flow__container",children:p.jsx("g",{className:It(["react-flow__connection",X2(s)]),children:p.jsx(IR,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const IR=({style:e,type:t=ea.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:a,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=fte();if(!o)return;if(n)return p.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:a.x,fromY:a.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:X2(r),toNode:u,toHandle:d});let h="";const y={sourceX:a.x,sourceY:a.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case ea.Bezier:[h]=fT(y);break;case ea.SimpleBezier:[h]=vR(y);break;case ea.Step:[h]=$b({...y,borderRadius:0});break;case ea.SmoothStep:[h]=$b(y);break;default:[h]=mT(y)}return p.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};IR.displayName="ConnectionLine";const mte={};function DR(e=mte){g.useRef(e),vt(),g.useEffect(()=>{},[e])}function yte(){vt(),g.useRef(!1),g.useEffect(()=>{},[])}function LR({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:a,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:x,selectionOnDrag:_,selectionMode:w,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:S,deleteKeyCode:O,onlyRenderVisibleElements:k,elementsSelectable:N,defaultViewport:P,translateExtent:R,minZoom:A,maxZoom:C,preventScrolling:M,defaultMarkerColor:T,zoomOnScroll:D,zoomOnPinch:I,panOnScroll:L,panOnScrollSpeed:B,panOnScrollMode:U,zoomOnDoubleClick:F,panOnDrag:H,onPaneClick:J,onPaneMouseEnter:q,onPaneMouseMove:re,onPaneMouseLeave:Z,onPaneScroll:Y,onPaneContextMenu:W,paneClickDistance:G,nodeClickDistance:te,onEdgeContextMenu:$,onEdgeMouseEnter:se,onEdgeMouseMove:ue,onEdgeMouseLeave:ve,reconnectRadius:Te,onReconnect:qe,onReconnectStart:Ye,onReconnectEnd:ze,noDragClassName:ct,noWheelClassName:He,noPanClassName:lt,disableKeyboardA11y:Ht,nodeExtent:St,rfId:yt,viewport:Rt,onViewportChange:bn}){return DR(e),DR(t),yte(),ste(n),lte(Rt),p.jsx(Tee,{onPaneClick:J,onPaneMouseEnter:q,onPaneMouseMove:re,onPaneMouseLeave:Z,onPaneContextMenu:W,onPaneScroll:Y,paneClickDistance:G,deleteKeyCode:O,selectionKeyCode:x,selectionOnDrag:_,selectionMode:w,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:S,elementsSelectable:N,zoomOnScroll:D,zoomOnPinch:I,zoomOnDoubleClick:F,panOnScroll:L,panOnScrollSpeed:B,panOnScrollMode:U,panOnDrag:H,defaultViewport:P,translateExtent:R,minZoom:A,maxZoom:C,onSelectionContextMenu:d,preventScrolling:M,noDragClassName:ct,noWheelClassName:He,noPanClassName:lt,disableKeyboardA11y:Ht,onViewportChange:bn,isControlledViewport:!!Rt,children:p.jsxs(ite,{children:[p.jsx(ote,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:qe,onReconnectStart:Ye,onReconnectEnd:ze,onlyRenderVisibleElements:k,onEdgeContextMenu:$,onEdgeMouseEnter:se,onEdgeMouseMove:ue,onEdgeMouseLeave:ve,reconnectRadius:Te,defaultMarkerColor:T,noPanClassName:lt,disableKeyboardA11y:Ht,rfId:yt}),p.jsx(hte,{style:m,type:y,component:v,containerStyle:b}),p.jsx("div",{className:"react-flow__edgelabel-renderer"}),p.jsx(zee,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:a,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:te,onlyRenderVisibleElements:k,noPanClassName:lt,noDragClassName:ct,disableKeyboardA11y:Ht,nodeExtent:St,rfId:yt}),p.jsx("div",{className:"react-flow__viewport-portal"})]})})}LR.displayName="GraphView";const gte=g.memo(LR),FR=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:a,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,h=r??t??[],y=n??e??[],m=s??[0,0],v=c??fl;_T(d,f,h),Hb(y,l,u,{nodeOrigin:m,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&o&&a){const x=ml(l,{filter:E=>!!((E.width||E.initialWidth)&&(E.height||E.initialHeight))}),{x:_,y:w,zoom:j}=Fb(x,o,a,.5,2,.1);b=[_,w,j]}return{rfId:"1",width:0,height:0,transform:b,nodes:y,nodeLookup:l,parentLookup:u,edges:h,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:fl,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ki.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...q2},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:qG,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},vte=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:a,fitView:i,nodeOrigin:s,nodeExtent:c})=>LZ((l,u)=>({...FR({nodes:e,edges:t,width:o,height:a,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:h,nodeOrigin:y,elevateNodesOnSelect:m}=u();Hb(d,f,h,{nodeOrigin:y,nodeExtent:c,elevateNodesOnSelect:m,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:h}=u();_T(f,h,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:h}=u();h(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:h}=u();h(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:h,nodeLookup:y,parentLookup:m,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:x,domNode:_,nodeOrigin:w,nodeExtent:j,debug:E,fitViewSync:S}=u(),{changes:O,updatedInternals:k}=sZ(d,y,m,_,w,j);if(k){if(oZ(y,m,{nodeOrigin:w,nodeExtent:j}),f.triggerFitView){let N=b;!b&&v&&(N=S({...x,nodes:x==null?void 0:x.nodes})),l({fitViewDone:N})}else l({});(O==null?void 0:O.length)>0&&(E&&console.log("React Flow: trigger node changes",O),h==null||h(O))}},updateNodePositions:(d,f=!1)=>{const h=[],y=[];for(const[m,v]of d){const b={id:m,type:"position",position:v.position,dragging:f};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(h.push({id:m,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),y.push(b)}if(h.length>0){const{nodeLookup:m,parentLookup:v,nodeOrigin:b}=u(),x=qb(h,m,v,b);y.push(...x)}u().triggerNodeChanges(y)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:h,nodes:y,hasDefaultNodes:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Ba(d,y);h(b)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:h,edges:y,hasDefaultEdges:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=wl(d,y);h(b)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(x=>$a(x,!0));m(b);return}m(ts(y,new Set([...d]),!0)),v(ts(h))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(x=>$a(x,!0));v(b);return}v(ts(h,new Set([...d]))),m(ts(y,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:h,nodes:y,nodeLookup:m,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),x=d||y,_=f||h,w=x.map(E=>{const S=m.get(E.id);return S&&(S.selected=!1),$a(E.id,!1)}),j=_.map(E=>$a(E.id,!1));v(w),b(j)},setMinZoom:d=>{const{panZoom:f,maxZoom:h}=u();f==null||f.setScaleExtent([d,h]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:h}=u();f==null||f.setScaleExtent([h,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:y}=u(),m=f.reduce((b,x)=>x.selected?[...b,$a(x.id,!1)]:b,[]),v=d.reduce((b,x)=>x.selected?[...b,$a(x.id,!1)]:b,[]);h(m),y(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:h,parentLookup:y,nodeOrigin:m,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(Hb(f,h,y,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:h,height:y,panZoom:m,translateExtent:v}=u();return cZ({delta:d,panZoom:m,transform:f,translateExtent:v,width:h,height:y})},fitView:d=>{const{panZoom:f,width:h,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return Promise.resolve(!1);const x=Ib(b,d);return Db({nodes:x,width:h,height:y,panZoom:f,minZoom:m,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:h,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return!1;const x=Ib(b,d);return Db({nodes:x,width:h,height:y,panZoom:f,minZoom:m,maxZoom:v},d),x.size>0},cancelConnection:()=>{l({connection:{...q2}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...FR()})}),Object.is);function bte({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:a,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>vte({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:a,fitView:i,nodeOrigin:s,nodeExtent:c}));return p.jsx(FZ,{value:u,children:p.jsx(see,{children:l})})}function xte({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:a,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(If)?p.jsx(p.Fragment,{children:e}):p.jsx(bte,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:a,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const wte={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function _te({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:a,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:x,onNodeMouseMove:_,onNodeMouseLeave:w,onNodeContextMenu:j,onNodeDoubleClick:E,onNodeDragStart:S,onNodeDrag:O,onNodeDragStop:k,onNodesDelete:N,onEdgesDelete:P,onDelete:R,onSelectionChange:A,onSelectionDragStart:C,onSelectionDrag:M,onSelectionDragStop:T,onSelectionContextMenu:D,onSelectionStart:I,onSelectionEnd:L,onBeforeDelete:B,connectionMode:U,connectionLineType:F=ea.Bezier,connectionLineStyle:H,connectionLineComponent:J,connectionLineContainerStyle:q,deleteKeyCode:re="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:Y=!1,selectionMode:W=pl.Full,panActivationKeyCode:G="Space",multiSelectionKeyCode:te=kf()?"Meta":"Control",zoomActivationKeyCode:$=kf()?"Meta":"Control",snapToGrid:se,snapGrid:ue,onlyRenderVisibleElements:ve=!1,selectNodesOnDrag:Te,nodesDraggable:qe,nodesConnectable:Ye,nodesFocusable:ze,nodeOrigin:ct=YT,edgesFocusable:He,edgesReconnectable:lt,elementsSelectable:Ht=!0,defaultViewport:St=JZ,minZoom:yt=.5,maxZoom:Rt=2,translateExtent:bn=fl,preventScrolling:Sr=!0,nodeExtent:li,defaultMarkerColor:Zn="#b1b1b7",zoomOnScroll:ga=!0,zoomOnPinch:Q=!0,panOnScroll:ee=!1,panOnScrollSpeed:ie=.5,panOnScrollMode:pe=Zo.Free,zoomOnDoubleClick:ke=!0,panOnDrag:Mt=!0,onPaneClick:wt,onPaneMouseEnter:Be,onPaneMouseMove:ge,onPaneMouseLeave:we,onPaneScroll:_e,onPaneContextMenu:je,paneClickDistance:Le=0,nodeClickDistance:dt=0,children:Ct,onReconnect:z,onReconnectStart:X,onReconnectEnd:ne,onEdgeContextMenu:de,onEdgeDoubleClick:Se,onEdgeMouseEnter:Pe,onEdgeMouseMove:Ie,onEdgeMouseLeave:Ce,reconnectRadius:Ne=10,onNodesChange:be,onEdgesChange:De,noDragClassName:Ue="nodrag",noWheelClassName:gt="nowheel",noPanClassName:_t="nopan",fitView:Ke,fitViewOptions:On,connectOnClick:At,attributionPosition:ui,proOptions:Cr,defaultEdgeOptions:va,elevateNodesOnSelect:Qr,elevateEdgesOnSelect:Iu,disableKeyboardA11y:er=!1,autoPanOnConnect:Qs,autoPanOnNodeDrag:Js,autoPanSpeed:Gs,connectionRadius:nt,isValidConnection:Nn,onError:di,style:Ot,id:zo,nodeDragThreshold:Wh,viewport:wE,onViewportChange:uwe,width:dwe,height:fwe,colorMode:pwe="light",debug:hwe,...mwe},ywe){const _E=zo||"1",gwe=tee(pwe);return p.jsx("div",{...mwe,style:{...Ot,...wte},ref:ywe,className:It(["react-flow",o,gwe]),"data-testid":"rf__wrapper",id:zo,children:p.jsxs(xte,{nodes:e,edges:t,width:dwe,height:fwe,fitView:Ke,nodeOrigin:ct,nodeExtent:li,children:[p.jsx(gte,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:_,onNodeMouseLeave:w,onNodeContextMenu:j,onNodeDoubleClick:E,nodeTypes:a,edgeTypes:i,connectionLineType:F,connectionLineStyle:H,connectionLineComponent:J,connectionLineContainerStyle:q,selectionKeyCode:Z,selectionOnDrag:Y,selectionMode:W,deleteKeyCode:re,multiSelectionKeyCode:te,panActivationKeyCode:G,zoomActivationKeyCode:$,onlyRenderVisibleElements:ve,defaultViewport:St,translateExtent:bn,minZoom:yt,maxZoom:Rt,preventScrolling:Sr,zoomOnScroll:ga,zoomOnPinch:Q,zoomOnDoubleClick:ke,panOnScroll:ee,panOnScrollSpeed:ie,panOnScrollMode:pe,panOnDrag:Mt,onPaneClick:wt,onPaneMouseEnter:Be,onPaneMouseMove:ge,onPaneMouseLeave:we,onPaneScroll:_e,onPaneContextMenu:je,paneClickDistance:Le,nodeClickDistance:dt,onSelectionContextMenu:D,onSelectionStart:I,onSelectionEnd:L,onReconnect:z,onReconnectStart:X,onReconnectEnd:ne,onEdgeContextMenu:de,onEdgeDoubleClick:Se,onEdgeMouseEnter:Pe,onEdgeMouseMove:Ie,onEdgeMouseLeave:Ce,reconnectRadius:Ne,defaultMarkerColor:Zn,noDragClassName:Ue,noWheelClassName:gt,noPanClassName:_t,rfId:_E,disableKeyboardA11y:er,nodeExtent:li,viewport:wE,onViewportChange:uwe}),p.jsx(eee,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:qe,nodesConnectable:Ye,nodesFocusable:ze,edgesFocusable:He,edgesReconnectable:lt,elementsSelectable:Ht,elevateNodesOnSelect:Qr,elevateEdgesOnSelect:Iu,minZoom:yt,maxZoom:Rt,nodeExtent:li,onNodesChange:be,onEdgesChange:De,snapToGrid:se,snapGrid:ue,connectionMode:U,translateExtent:bn,connectOnClick:At,defaultEdgeOptions:va,fitView:Ke,fitViewOptions:On,onNodesDelete:N,onEdgesDelete:P,onDelete:R,onNodeDragStart:S,onNodeDrag:O,onNodeDragStop:k,onSelectionDrag:M,onSelectionDragStart:C,onSelectionDragStop:T,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:_t,nodeOrigin:ct,rfId:_E,autoPanOnConnect:Qs,autoPanOnNodeDrag:Js,autoPanSpeed:Gs,onError:di,connectionRadius:nt,isValidConnection:Nn,selectNodesOnDrag:Te,nodeDragThreshold:Wh,onBeforeDelete:B,paneClickDistance:Le,debug:hwe}),p.jsx(QZ,{onSelectionChange:A}),Ct,p.jsx(WZ,{proOptions:Cr,position:ui}),p.jsx(UZ,{rfId:_E,disableKeyboardA11y:er})]})})}var jte=oR(_te);const Ete=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Ste({children:e}){const t=Ve(Ete);return t?Du.createPortal(e,t):null}const Cte=e=>e.nodes;function Ote(){return Ve(Cte,jt)}function $f({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:o}){const a=nx(),i=n??a,s=g.useRef(null),c=Ve(l=>l.connectionLookup.get(`${i}-${e}-${t}`),zG);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;K2(s.current,l,o),K2(l,s.current,r)}s.current=c??new Map},[c,r,o]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}ln=function(e){return Ve(g.useCallback(t=>t.nodeLookup.get(e),[e]),jt)};function Nte({dimensions:e,lineWidth:t,variant:n,className:r}){return p.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:It(["react-flow__background-pattern",n,r])})}function Mte({radius:e,className:t}){return p.jsx("circle",{cx:e,cy:e,r:e,className:It(["react-flow__background-pattern","dots",t])})}var _o;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(_o||(_o={}));const kte={[_o.Dots]:1,[_o.Lines]:1,[_o.Cross]:6},Pte=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function BR({id:e,variant:t=_o.Dots,gap:n=20,size:r,lineWidth:o=1,offset:a=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:f,patternId:h}=Ve(Pte,jt),y=r||kte[t],m=t===_o.Dots,v=t===_o.Cross,b=Array.isArray(n)?n:[n,n],x=[b[0]*f[2]||1,b[1]*f[2]||1],_=y*f[2],w=Array.isArray(a)?a:[a,a],j=v?[_,_]:x,E=[w[0]*f[2]||1+j[0]/2,w[1]*f[2]||1+j[1]/2],S=`${h}${e||""}`;return p.jsxs("svg",{className:It(["react-flow__background",l]),style:{...c,...Lf,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[p.jsx("pattern",{id:S,x:f[0]%x[0],y:f[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:m?p.jsx(Mte,{radius:_/2,className:u}):p.jsx(Nte,{dimensions:j,lineWidth:o,variant:t,className:u})}),p.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S})`})]})}BR.displayName="Background";const Ate=g.memo(BR);function Tte(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:p.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Rte(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:p.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Ite(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:p.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Dte(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Lte(){return p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:p.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function zf({children:e,className:t,...n}){return p.jsx("button",{type:"button",className:It(["react-flow__controls-button",t]),...n,children:e})}const Fte=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function $R({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:a,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const y=vt(),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=Ve(Fte,jt),{zoomIn:x,zoomOut:_,fitView:w}=Fn(),j=()=>{x(),a==null||a()},E=()=>{_(),i==null||i()},S=()=>{w(o),s==null||s()},O=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},k=f==="horizontal"?"horizontal":"vertical";return p.jsxs(es,{className:It(["react-flow__controls",k,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&p.jsxs(p.Fragment,{children:[p.jsx(zf,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:p.jsx(Tte,{})}),p.jsx(zf,{onClick:E,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:p.jsx(Rte,{})})]}),n&&p.jsx(zf,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view",children:p.jsx(Ite,{})}),r&&p.jsx(zf,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?p.jsx(Lte,{}):p.jsx(Dte,{})}),u]})}$R.displayName="Controls";const Bte=g.memo($R);function $te({id:e,x:t,y:n,width:r,height:o,style:a,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:h}){const{background:y,backgroundColor:m}=a||{},v=i||y||m;return p.jsx("rect",{className:It(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:h?b=>h(b,e):void 0})}const zte=g.memo($te),Vte=e=>e.nodes.map(t=>t.id),rx=e=>e instanceof Function?e:()=>e;function Ute({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:a=zte,onClick:i}){const s=Ve(Vte,jt),c=rx(t),l=rx(e),u=rx(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return p.jsx(p.Fragment,{children:s.map(f=>p.jsx(Wte,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:a,onClick:i,shapeRendering:d},f))})}function Hte({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:a,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:f,height:h}=Ve(y=>{const m=y.nodeLookup.get(e),{x:v,y:b}=m.internals.positionAbsolute,{width:x,height:_}=xo(m);return{node:m,x:v,y:b,width:x,height:_}},jt);return!l||l.hidden||!aT(l)?null:p.jsx(s,{x:u,y:d,width:f,height:h,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:a,shapeRendering:i,onClick:c,id:l.id})}const Wte=g.memo(Hte);var qte=g.memo(Ute);const Yte=200,Kte=150,Xte=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?nT(ml(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Qte="react-flow__minimap-desc";function zR({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:a=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:y,pannable:m=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:x,zoomStep:_=10,offsetScale:w=5}){const j=vt(),E=g.useRef(null),{boundingRect:S,viewBB:O,rfId:k,panZoom:N,translateExtent:P,flowWidth:R,flowHeight:A}=Ve(Xte,jt),C=(e==null?void 0:e.width)??Yte,M=(e==null?void 0:e.height)??Kte,T=S.width/C,D=S.height/M,I=Math.max(T,D),L=I*C,B=I*M,U=w*I,F=S.x-(L-S.width)/2-U,H=S.y-(B-S.height)/2-U,J=L+U*2,q=B+U*2,re=`${Qte}-${k}`,Z=g.useRef(0),Y=g.useRef();Z.current=I,g.useEffect(()=>{if(E.current&&N)return Y.current=yZ({domNode:E.current,panZoom:N,getTransform:()=>j.getState().transform,getViewScale:()=>Z.current}),()=>{var te;(te=Y.current)==null||te.destroy()}},[N]),g.useEffect(()=>{var te;(te=Y.current)==null||te.update({translateExtent:P,width:R,height:A,inversePan:x,pannable:m,zoomStep:_,zoomable:v})},[m,v,x,_,P,R,A]);const W=h?te=>{var ue;const[$,se]=((ue=Y.current)==null?void 0:ue.pointer(te))||[0,0];h(te,{x:$,y:se})}:void 0,G=y?g.useCallback((te,$)=>{const se=j.getState().nodeLookup.get($);y(te,se)},[]):void 0;return p.jsx(es,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*I:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:It(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:p.jsxs("svg",{width:C,height:M,viewBox:`${F} ${H} ${J} ${q}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":re,ref:E,onClick:W,children:[b&&p.jsx("title",{id:re,children:b}),p.jsx(qte,{onClick:G,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:a,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:s}),p.jsx("path",{className:"react-flow__minimap-mask",d:`M${F-U},${H-U}h${J+U*2}v${q+U*2}h${-J-U*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}zR.displayName="MiniMap";const Jte=g.memo(zR);function Gte({nodeId:e,position:t,variant:n=Zi.Handle,className:r,style:o={},children:a,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:h,onResize:y,onResizeEnd:m}){const v=nx(),b=typeof e=="string"?e:v,x=vt(),_=g.useRef(null),w=n===Zi.Line?"right":"bottom-right",j=t??w,E=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return E.current||(E.current=TZ({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:A,nodeOrigin:C,domNode:M}=x.getState();return{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:A,nodeOrigin:C,paneDomNode:M}},onChange:(N,P)=>{const{triggerNodeChanges:R,nodeLookup:A,parentLookup:C,nodeOrigin:M}=x.getState(),T=[],D={x:N.x,y:N.y},I=A.get(b);if(I&&I.expandParent&&I.parentId){const L=I.origin??M,B=N.width??I.measured.width,U=N.height??I.measured.height,F={id:I.id,parentId:I.parentId,rect:{width:B,height:U,...iT({x:N.x??I.position.x,y:N.y??I.position.y},{width:B,height:U},I.parentId,A,L)}},H=qb([F],A,C,M);T.push(...H),D.x=N.x?Math.max(L[0]*B,N.x):void 0,D.y=N.y?Math.max(L[1]*U,N.y):void 0}if(D.x!==void 0&&D.y!==void 0){const L={id:b,type:"position",position:{...D}};T.push(L)}if(N.width!==void 0&&N.height!==void 0){const L={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:N.width,height:N.height}};T.push(L)}for(const L of P){const B={...L,type:"position"};T.push(B)}R(T)},onEnd:()=>{const N={id:b,type:"dimensions",resizing:!1};x.getState().triggerNodeChanges([N])}})),E.current.update({controlPosition:j,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:h,onResize:y,onResizeEnd:m,shouldResize:f}),()=>{var N;(N=E.current)==null||N.destroy()}},[j,s,c,l,u,d,h,y,m,f]);const S=j.split("-"),O=n===Zi.Line?"borderColor":"backgroundColor",k=i?{...o,[O]:i}:o;return p.jsx("div",{className:It(["react-flow__resize-control","nodrag",...S,n,r]),ref:_,style:k,children:a})}const VR=g.memo(Gte);function Zte({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:o,lineStyle:a,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:h,onResize:y,onResizeEnd:m}){return t?p.jsxs(p.Fragment,{children:[CZ.map(v=>p.jsx(VR,{className:o,style:a,nodeId:e,position:v,variant:Zi.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:h,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v)),SZ.map(v=>p.jsx(VR,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:h,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v))]}):null}var ox,UR;function ene(){if(UR)return ox;UR=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var x=Object.prototype.toString.call(b);return x==="[object RegExp]"||x==="[object Date]"||a(b)}var r=typeof Symbol=="function"&&Symbol.for,o=r?Symbol.for("react.element"):60103;function a(b){return b.$$typeof===o}function i(b){return Array.isArray(b)?[]:{}}function s(b,x){return x.clone!==!1&&x.isMergeableObject(b)?m(i(b),b,x):b}function c(b,x,_){return b.concat(x).map(function(w){return s(w,_)})}function l(b,x){if(!x.customMerge)return m;var _=x.customMerge(b);return typeof _=="function"?_:m}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(x){return Object.propertyIsEnumerable.call(b,x)}):[]}function d(b){return Object.keys(b).concat(u(b))}function f(b,x){try{return x in b}catch{return!1}}function h(b,x){return f(b,x)&&!(Object.hasOwnProperty.call(b,x)&&Object.propertyIsEnumerable.call(b,x))}function y(b,x,_){var w={};return _.isMergeableObject(b)&&d(b).forEach(function(j){w[j]=s(b[j],_)}),d(x).forEach(function(j){h(b,j)||(f(b,j)&&_.isMergeableObject(x[j])?w[j]=l(j,_)(b[j],x[j],_):w[j]=s(x[j],_))}),w}function m(b,x,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var w=Array.isArray(x),j=Array.isArray(b),E=w===j;return E?w?_.arrayMerge(b,x,_):y(b,x,_):s(x,_)}m.all=function(b,x){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,w){return m(_,w,x)},{})};var v=m;return ox=v,ox}var tne=ene();const Vf=Xe(tne);var HR={},WR;function nne(){if(WR)return HR;WR=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof ec=="object"?ec:typeof self=="object"?self:typeof this=="object"?this:c(),o=a(t);typeof r.Reflect<"u"&&(o=a(r.Reflect,o)),n(o,r),typeof r.Reflect>"u"&&(r.Reflect=t);function a(l,u){return function(d,f){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:f}),u&&u(d,f)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var o=Object.prototype.hasOwnProperty,a=typeof Symbol=="function",i=a&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=a&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return ga(Object.create(null))}:l?function(){return ga({__proto__:null})}:function(){return ga({})},has:u?function(Q,ee){return o.call(Q,ee)}:function(Q,ee){return ee in Q},get:u?function(Q,ee){return o.call(Q,ee)?Q[ee]:void 0}:function(Q,ee){return Q[ee]}},f=Object.getPrototypeOf(Function),h=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Sr(),y=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:li(),m=typeof WeakMap=="function"?WeakMap:Zn(),v=a?Symbol.for("@reflect-metadata:registry"):void 0,b=St(),x=yt(b);function _(Q,ee,ie,pe){if(H(ie)){if(!$(Q))throw new TypeError;if(!ue(ee))throw new TypeError;return A(Q,ee)}else{if(!$(Q))throw new TypeError;if(!re(ee))throw new TypeError;if(!re(pe)&&!H(pe)&&!J(pe))throw new TypeError;return J(pe)&&(pe=void 0),ie=te(ie),C(Q,ee,ie,pe)}}n("decorate",_);function w(Q,ee){function ie(pe,ke){if(!re(pe))throw new TypeError;if(!H(ke)&&!ve(ke))throw new TypeError;L(Q,ee,pe,ke)}return ie}n("metadata",w);function j(Q,ee,ie,pe){if(!re(ie))throw new TypeError;return H(pe)||(pe=te(pe)),L(Q,ee,ie,pe)}n("defineMetadata",j);function E(Q,ee,ie){if(!re(ee))throw new TypeError;return H(ie)||(ie=te(ie)),M(Q,ee,ie)}n("hasMetadata",E);function S(Q,ee,ie){if(!re(ee))throw new TypeError;return H(ie)||(ie=te(ie)),T(Q,ee,ie)}n("hasOwnMetadata",S);function O(Q,ee,ie){if(!re(ee))throw new TypeError;return H(ie)||(ie=te(ie)),D(Q,ee,ie)}n("getMetadata",O);function k(Q,ee,ie){if(!re(ee))throw new TypeError;return H(ie)||(ie=te(ie)),I(Q,ee,ie)}n("getOwnMetadata",k);function N(Q,ee){if(!re(Q))throw new TypeError;return H(ee)||(ee=te(ee)),B(Q,ee)}n("getMetadataKeys",N);function P(Q,ee){if(!re(Q))throw new TypeError;return H(ee)||(ee=te(ee)),U(Q,ee)}n("getOwnMetadataKeys",P);function R(Q,ee,ie){if(!re(ee))throw new TypeError;if(H(ie)||(ie=te(ie)),!re(ee))throw new TypeError;H(ie)||(ie=te(ie));var pe=bn(ee,ie,!1);return H(pe)?!1:pe.OrdinaryDeleteMetadata(Q,ee,ie)}n("deleteMetadata",R);function A(Q,ee){for(var ie=Q.length-1;ie>=0;--ie){var pe=Q[ie],ke=pe(ee);if(!H(ke)&&!J(ke)){if(!ue(ke))throw new TypeError;ee=ke}}return ee}function C(Q,ee,ie,pe){for(var ke=Q.length-1;ke>=0;--ke){var Mt=Q[ke],wt=Mt(ee,ie,pe);if(!H(wt)&&!J(wt)){if(!re(wt))throw new TypeError;pe=wt}}return pe}function M(Q,ee,ie){var pe=T(Q,ee,ie);if(pe)return!0;var ke=lt(ee);return J(ke)?!1:M(Q,ke,ie)}function T(Q,ee,ie){var pe=bn(ee,ie,!1);return H(pe)?!1:W(pe.OrdinaryHasOwnMetadata(Q,ee,ie))}function D(Q,ee,ie){var pe=T(Q,ee,ie);if(pe)return I(Q,ee,ie);var ke=lt(ee);if(!J(ke))return D(Q,ke,ie)}function I(Q,ee,ie){var pe=bn(ee,ie,!1);if(!H(pe))return pe.OrdinaryGetOwnMetadata(Q,ee,ie)}function L(Q,ee,ie,pe){var ke=bn(ie,pe,!0);ke.OrdinaryDefineOwnMetadata(Q,ee,ie,pe)}function B(Q,ee){var ie=U(Q,ee),pe=lt(Q);if(pe===null)return ie;var ke=B(pe,ee);if(ke.length<=0)return ie;if(ie.length<=0)return ke;for(var Mt=new y,wt=[],Be=0,ge=ie;Be<ge.length;Be++){var we=ge[Be],_e=Mt.has(we);_e||(Mt.add(we),wt.push(we))}for(var je=0,Le=ke;je<Le.length;je++){var we=Le[je],_e=Mt.has(we);_e||(Mt.add(we),wt.push(we))}return wt}function U(Q,ee){var ie=bn(Q,ee,!1);return ie?ie.OrdinaryOwnMetadataKeys(Q,ee):[]}function F(Q){if(Q===null)return 1;switch(typeof Q){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Q===null?1:6;default:return 6}}function H(Q){return Q===void 0}function J(Q){return Q===null}function q(Q){return typeof Q=="symbol"}function re(Q){return typeof Q=="object"?Q!==null:typeof Q=="function"}function Z(Q,ee){switch(F(Q)){case 0:return Q;case 1:return Q;case 2:return Q;case 3:return Q;case 4:return Q;case 5:return Q}var ie="string",pe=qe(Q,i);if(pe!==void 0){var ke=pe.call(Q,ie);if(re(ke))throw new TypeError;return ke}return Y(Q)}function Y(Q,ee){var ie,pe;{var ke=Q.toString;if(se(ke)){var pe=ke.call(Q);if(!re(pe))return pe}var ie=Q.valueOf;if(se(ie)){var pe=ie.call(Q);if(!re(pe))return pe}}throw new TypeError}function W(Q){return!!Q}function G(Q){return""+Q}function te(Q){var ee=Z(Q);return q(ee)?ee:G(ee)}function $(Q){return Array.isArray?Array.isArray(Q):Q instanceof Object?Q instanceof Array:Object.prototype.toString.call(Q)==="[object Array]"}function se(Q){return typeof Q=="function"}function ue(Q){return typeof Q=="function"}function ve(Q){switch(F(Q)){case 3:return!0;case 4:return!0;default:return!1}}function Te(Q,ee){return Q===ee||Q!==Q&&ee!==ee}function qe(Q,ee){var ie=Q[ee];if(ie!=null){if(!se(ie))throw new TypeError;return ie}}function Ye(Q){var ee=qe(Q,s);if(!se(ee))throw new TypeError;var ie=ee.call(Q);if(!re(ie))throw new TypeError;return ie}function ze(Q){return Q.value}function ct(Q){var ee=Q.next();return ee.done?!1:ee}function He(Q){var ee=Q.return;ee&&ee.call(Q)}function lt(Q){var ee=Object.getPrototypeOf(Q);if(typeof Q!="function"||Q===f||ee!==f)return ee;var ie=Q.prototype,pe=ie&&Object.getPrototypeOf(ie);if(pe==null||pe===Object.prototype)return ee;var ke=pe.constructor;return typeof ke!="function"||ke===Q?ee:ke}function Ht(){var Q;!H(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Q=Rt(r.Reflect));var ee,ie,pe,ke=new m,Mt={registerProvider:wt,getProvider:ge,setProvider:_e};return Mt;function wt(je){if(!Object.isExtensible(Mt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Q===je:break;case H(ee):ee=je;break;case ee===je:break;case H(ie):ie=je;break;case ie===je:break;default:pe===void 0&&(pe=new y),pe.add(je);break}}function Be(je,Le){if(!H(ee)){if(ee.isProviderFor(je,Le))return ee;if(!H(ie)){if(ie.isProviderFor(je,Le))return ee;if(!H(pe))for(var dt=Ye(pe);;){var Ct=ct(dt);if(!Ct)return;var z=ze(Ct);if(z.isProviderFor(je,Le))return He(dt),z}}}if(!H(Q)&&Q.isProviderFor(je,Le))return Q}function ge(je,Le){var dt=ke.get(je),Ct;return H(dt)||(Ct=dt.get(Le)),H(Ct)&&(Ct=Be(je,Le),H(Ct)||(H(dt)&&(dt=new h,ke.set(je,dt)),dt.set(Le,Ct))),Ct}function we(je){if(H(je))throw new TypeError;return ee===je||ie===je||!H(pe)&&pe.has(je)}function _e(je,Le,dt){if(!we(dt))throw new Error("Metadata provider not registered.");var Ct=ge(je,Le);if(Ct!==dt){if(!H(Ct))return!1;var z=ke.get(je);H(z)&&(z=new h,ke.set(je,z)),z.set(Le,dt)}return!0}}function St(){var Q;return!H(v)&&re(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Q=r.Reflect[v]),H(Q)&&(Q=Ht()),!H(v)&&re(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Q}),Q}function yt(Q){var ee=new m,ie={isProviderFor:function(we,_e){var je=ee.get(we);return H(je)?!1:je.has(_e)},OrdinaryDefineOwnMetadata:wt,OrdinaryHasOwnMetadata:ke,OrdinaryGetOwnMetadata:Mt,OrdinaryOwnMetadataKeys:Be,OrdinaryDeleteMetadata:ge};return b.registerProvider(ie),ie;function pe(we,_e,je){var Le=ee.get(we),dt=!1;if(H(Le)){if(!je)return;Le=new h,ee.set(we,Le),dt=!0}var Ct=Le.get(_e);if(H(Ct)){if(!je)return;if(Ct=new h,Le.set(_e,Ct),!Q.setProvider(we,_e,ie))throw Le.delete(_e),dt&&ee.delete(we),new Error("Wrong provider for target.")}return Ct}function ke(we,_e,je){var Le=pe(_e,je,!1);return H(Le)?!1:W(Le.has(we))}function Mt(we,_e,je){var Le=pe(_e,je,!1);if(!H(Le))return Le.get(we)}function wt(we,_e,je,Le){var dt=pe(je,Le,!0);dt.set(we,_e)}function Be(we,_e){var je=[],Le=pe(we,_e,!1);if(H(Le))return je;for(var dt=Le.keys(),Ct=Ye(dt),z=0;;){var X=ct(Ct);if(!X)return je.length=z,je;var ne=ze(X);try{je[z]=ne}catch(de){try{He(Ct)}finally{throw de}}z++}}function ge(we,_e,je){var Le=pe(_e,je,!1);if(H(Le)||!Le.delete(we))return!1;if(Le.size===0){var dt=ee.get(_e);H(dt)||(dt.delete(je),dt.size===0&&ee.delete(dt))}return!0}}function Rt(Q){var ee=Q.defineMetadata,ie=Q.hasOwnMetadata,pe=Q.getOwnMetadata,ke=Q.getOwnMetadataKeys,Mt=Q.deleteMetadata,wt=new m,Be={isProviderFor:function(ge,we){var _e=wt.get(ge);return!H(_e)&&_e.has(we)?!0:ke(ge,we).length?(H(_e)&&(_e=new y,wt.set(ge,_e)),_e.add(we),!0):!1},OrdinaryDefineOwnMetadata:ee,OrdinaryHasOwnMetadata:ie,OrdinaryGetOwnMetadata:pe,OrdinaryOwnMetadataKeys:ke,OrdinaryDeleteMetadata:Mt};return Be}function bn(Q,ee,ie){var pe=b.getProvider(Q,ee);if(!H(pe))return pe;if(ie){if(b.setProvider(Q,ee,x))return x;throw new Error("Illegal state.")}}function Sr(){var Q={},ee=[],ie=function(){function Be(ge,we,_e){this._index=0,this._keys=ge,this._values=we,this._selector=_e}return Be.prototype["@@iterator"]=function(){return this},Be.prototype[s]=function(){return this},Be.prototype.next=function(){var ge=this._index;if(ge>=0&&ge<this._keys.length){var we=this._selector(this._keys[ge],this._values[ge]);return ge+1>=this._keys.length?(this._index=-1,this._keys=ee,this._values=ee):this._index++,{value:we,done:!1}}return{value:void 0,done:!0}},Be.prototype.throw=function(ge){throw this._index>=0&&(this._index=-1,this._keys=ee,this._values=ee),ge},Be.prototype.return=function(ge){return this._index>=0&&(this._index=-1,this._keys=ee,this._values=ee),{value:ge,done:!0}},Be}(),pe=function(){function Be(){this._keys=[],this._values=[],this._cacheKey=Q,this._cacheIndex=-2}return Object.defineProperty(Be.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Be.prototype.has=function(ge){return this._find(ge,!1)>=0},Be.prototype.get=function(ge){var we=this._find(ge,!1);return we>=0?this._values[we]:void 0},Be.prototype.set=function(ge,we){var _e=this._find(ge,!0);return this._values[_e]=we,this},Be.prototype.delete=function(ge){var we=this._find(ge,!1);if(we>=0){for(var _e=this._keys.length,je=we+1;je<_e;je++)this._keys[je-1]=this._keys[je],this._values[je-1]=this._values[je];return this._keys.length--,this._values.length--,Te(ge,this._cacheKey)&&(this._cacheKey=Q,this._cacheIndex=-2),!0}return!1},Be.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Q,this._cacheIndex=-2},Be.prototype.keys=function(){return new ie(this._keys,this._values,ke)},Be.prototype.values=function(){return new ie(this._keys,this._values,Mt)},Be.prototype.entries=function(){return new ie(this._keys,this._values,wt)},Be.prototype["@@iterator"]=function(){return this.entries()},Be.prototype[s]=function(){return this.entries()},Be.prototype._find=function(ge,we){if(!Te(this._cacheKey,ge)){this._cacheIndex=-1;for(var _e=0;_e<this._keys.length;_e++)if(Te(this._keys[_e],ge)){this._cacheIndex=_e;break}}return this._cacheIndex<0&&we&&(this._cacheIndex=this._keys.length,this._keys.push(ge),this._values.push(void 0)),this._cacheIndex},Be}();return pe;function ke(Be,ge){return Be}function Mt(Be,ge){return ge}function wt(Be,ge){return[Be,ge]}}function li(){var Q=function(){function ee(){this._map=new h}return Object.defineProperty(ee.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ee.prototype.has=function(ie){return this._map.has(ie)},ee.prototype.add=function(ie){return this._map.set(ie,ie),this},ee.prototype.delete=function(ie){return this._map.delete(ie)},ee.prototype.clear=function(){this._map.clear()},ee.prototype.keys=function(){return this._map.keys()},ee.prototype.values=function(){return this._map.keys()},ee.prototype.entries=function(){return this._map.entries()},ee.prototype["@@iterator"]=function(){return this.keys()},ee.prototype[s]=function(){return this.keys()},ee}();return Q}function Zn(){var Q=16,ee=d.create(),ie=pe();return function(){function ge(){this._key=pe()}return ge.prototype.has=function(we){var _e=ke(we,!1);return _e!==void 0?d.has(_e,this._key):!1},ge.prototype.get=function(we){var _e=ke(we,!1);return _e!==void 0?d.get(_e,this._key):void 0},ge.prototype.set=function(we,_e){var je=ke(we,!0);return je[this._key]=_e,this},ge.prototype.delete=function(we){var _e=ke(we,!1);return _e!==void 0?delete _e[this._key]:!1},ge.prototype.clear=function(){this._key=pe()},ge}();function pe(){var ge;do ge="@@WeakMap@@"+Be();while(d.has(ee,ge));return ee[ge]=!0,ge}function ke(ge,we){if(!o.call(ge,ie)){if(!we)return;Object.defineProperty(ge,ie,{value:d.create()})}return ge[ie]}function Mt(ge,we){for(var _e=0;_e<we;++_e)ge[_e]=Math.random()*255|0;return ge}function wt(ge){if(typeof Uint8Array=="function"){var we=new Uint8Array(ge);return typeof crypto<"u"?crypto.getRandomValues(we):typeof msCrypto<"u"?msCrypto.getRandomValues(we):Mt(we,ge),we}return Mt(new Array(ge),ge)}function Be(){var ge=wt(Q);ge[6]=ge[6]&79|64,ge[8]=ge[8]&191|128;for(var we="",_e=0;_e<Q;++_e){var je=ge[_e];(_e===4||_e===6||_e===8)&&(we+="-"),je<16&&(we+="0"),we+=je.toString(16).toLowerCase()}return we}}function ga(Q){return Q.__=void 0,delete Q.__,Q}})}(e||(e={})),HR}nne(),typeof window<"u"&&(window.Buffer=kwe),typeof Jh<"u"&&typeof require<"u"&&(Jh.Buffer=require("buffer/").Buffer);class Dt{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const o of Object.getOwnPropertyNames(r))t[o]=r[o]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class ns extends xe{constructor(){super("Locking not supported on given driver.")}}class ax extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class pt{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class rne extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return pt.isEntitySchema(t)?t.options.name:typeof t=="function"||Dt.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class qR extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class YR extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class one extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class Uf extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class $r extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,$r.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class ane extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class ine extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class jl extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class sne extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class cne extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class lne extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class KR{constructor(t){Dt.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class zr{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var ix={exports:{}},sx={exports:{}},XR;function rs(){return XR||(XR=1,typeof Object.create=="function"?sx.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:sx.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),sx.exports}var cx={exports:{}},QR;function za(){return QR||(QR=1,function(e,t){var n=Pwe(),r=n.Buffer;function o(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=a);function a(i,s,c){return r(i,s,c)}a.prototype=Object.create(r.prototype),o(r,a),a.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},a.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},a.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},a.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(cx,cx.exports)),cx.exports}var lx,JR;function os(){if(JR)return lx;JR=1;var e=za().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var o=this._block,a=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%a,u=Math.min(i-c,a-l),d=0;d<u;d++)o[l+d]=n[c+d];s+=u,c+=u,s%a===0&&this._update(o)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var o=this._len*8;if(o<=4294967295)this._block.writeUInt32BE(o,this._blockSize-4);else{var a=(o&4294967295)>>>0,i=(o-a)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(a,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},lx=t,lx}var ux,GR;function une(){if(GR)return ux;GR=1;var e=rs(),t=os(),n=za().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,f){return l===0?u&d|~u&f:l===2?u&d|u&f|d&f:u^d^f}return a.prototype._update=function(l){for(var u=this._w,d=this._a|0,f=this._b|0,h=this._c|0,y=this._d|0,m=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var x=~~(b/20),_=i(d)+c(x,f,h,y)+m+u[b]+r[x]|0;m=y,y=h,h=s(f),f=d,d=_}this._a=d+this._a|0,this._b=f+this._b|0,this._c=h+this._c|0,this._d=y+this._d|0,this._e=m+this._e|0},a.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},ux=a,ux}var dx,ZR;function dne(){if(ZR)return dx;ZR=1;var e=rs(),t=os(),n=za().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,f,h){return u===0?d&f|~d&h:u===2?d&f|d&h|f&h:d^f^h}return a.prototype._update=function(u){for(var d=this._w,f=this._a|0,h=this._b|0,y=this._c|0,m=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var x=0;x<80;++x){var _=~~(x/20),w=s(f)+l(_,h,y,m)+v+d[x]+r[_]|0;v=m,m=y,y=c(h),h=f,f=w}this._a=f+this._a|0,this._b=h+this._b|0,this._c=y+this._c|0,this._d=m+this._d|0,this._e=v+this._e|0},a.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},dx=a,dx}var fx,eI;function tI(){if(eI)return fx;eI=1;var e=rs(),t=os(),n=za().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(f,h,y){return y^f&(h^y)}function s(f,h,y){return f&h|y&(f|h)}function c(f){return(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10)}function l(f){return(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7)}function u(f){return(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3}function d(f){return(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10}return a.prototype._update=function(f){for(var h=this._w,y=this._a|0,m=this._b|0,v=this._c|0,b=this._d|0,x=this._e|0,_=this._f|0,w=this._g|0,j=this._h|0,E=0;E<16;++E)h[E]=f.readInt32BE(E*4);for(;E<64;++E)h[E]=d(h[E-2])+h[E-7]+u(h[E-15])+h[E-16]|0;for(var S=0;S<64;++S){var O=j+l(x)+i(x,_,w)+r[S]+h[S]|0,k=c(y)+s(y,m,v)|0;j=w,w=_,_=x,x=b+O|0,b=v,v=m,m=y,y=O+k|0}this._a=y+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=x+this._e|0,this._f=_+this._f|0,this._g=w+this._g|0,this._h=j+this._h|0},a.prototype._hash=function(){var f=n.allocUnsafe(32);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f.writeInt32BE(this._h,28),f},fx=a,fx}var px,nI;function fne(){if(nI)return px;nI=1;var e=rs(),t=tI(),n=os(),r=za().Buffer,o=new Array(64);function a(){this.init(),this._w=o,n.call(this,64,56)}return e(a,t),a.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},a.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},px=a,px}var hx,rI;function oI(){if(rI)return hx;rI=1;var e=rs(),t=os(),n=za().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function a(){this.init(),this._w=o,t.call(this,128,112)}e(a,t),a.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(m,v,b){return b^m&(v^b)}function s(m,v,b){return m&v|b&(m|v)}function c(m,v){return(m>>>28|v<<4)^(v>>>2|m<<30)^(v>>>7|m<<25)}function l(m,v){return(m>>>14|v<<18)^(m>>>18|v<<14)^(v>>>9|m<<23)}function u(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7}function d(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25)}function f(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6}function h(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26)}function y(m,v){return m>>>0<v>>>0?1:0}return a.prototype._update=function(m){for(var v=this._w,b=this._ah|0,x=this._bh|0,_=this._ch|0,w=this._dh|0,j=this._eh|0,E=this._fh|0,S=this._gh|0,O=this._hh|0,k=this._al|0,N=this._bl|0,P=this._cl|0,R=this._dl|0,A=this._el|0,C=this._fl|0,M=this._gl|0,T=this._hl|0,D=0;D<32;D+=2)v[D]=m.readInt32BE(D*4),v[D+1]=m.readInt32BE(D*4+4);for(;D<160;D+=2){var I=v[D-30],L=v[D-15*2+1],B=u(I,L),U=d(L,I);I=v[D-2*2],L=v[D-2*2+1];var F=f(I,L),H=h(L,I),J=v[D-7*2],q=v[D-7*2+1],re=v[D-16*2],Z=v[D-16*2+1],Y=U+q|0,W=B+J+y(Y,U)|0;Y=Y+H|0,W=W+F+y(Y,H)|0,Y=Y+Z|0,W=W+re+y(Y,Z)|0,v[D]=W,v[D+1]=Y}for(var G=0;G<160;G+=2){W=v[G],Y=v[G+1];var te=s(b,x,_),$=s(k,N,P),se=c(b,k),ue=c(k,b),ve=l(j,A),Te=l(A,j),qe=r[G],Ye=r[G+1],ze=i(j,E,S),ct=i(A,C,M),He=T+Te|0,lt=O+ve+y(He,T)|0;He=He+ct|0,lt=lt+ze+y(He,ct)|0,He=He+Ye|0,lt=lt+qe+y(He,Ye)|0,He=He+Y|0,lt=lt+W+y(He,Y)|0;var Ht=ue+$|0,St=se+te+y(Ht,ue)|0;O=S,T=M,S=E,M=C,E=j,C=A,A=R+He|0,j=w+lt+y(A,R)|0,w=_,R=P,_=x,P=N,x=b,N=k,k=He+Ht|0,b=lt+St+y(k,He)|0}this._al=this._al+k|0,this._bl=this._bl+N|0,this._cl=this._cl+P|0,this._dl=this._dl+R|0,this._el=this._el+A|0,this._fl=this._fl+C|0,this._gl=this._gl+M|0,this._hl=this._hl+T|0,this._ah=this._ah+b+y(this._al,k)|0,this._bh=this._bh+x+y(this._bl,N)|0,this._ch=this._ch+_+y(this._cl,P)|0,this._dh=this._dh+w+y(this._dl,R)|0,this._eh=this._eh+j+y(this._el,A)|0,this._fh=this._fh+E+y(this._fl,C)|0,this._gh=this._gh+S+y(this._gl,M)|0,this._hh=this._hh+O+y(this._hl,T)|0},a.prototype._hash=function(){var m=n.allocUnsafe(64);function v(b,x,_){m.writeInt32BE(b,_),m.writeInt32BE(x,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),m},hx=a,hx}var mx,aI;function pne(){if(aI)return mx;aI=1;var e=rs(),t=oI(),n=os(),r=za().Buffer,o=new Array(160);function a(){this.init(),this._w=o,n.call(this,128,112)}return e(a,t),a.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},a.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},mx=a,mx}var iI;function hne(){if(iI)return ix.exports;iI=1;var e=ix.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=une(),e.sha1=dne(),e.sha224=fne(),e.sha256=tI(),e.sha384=pne(),e.sha512=oI(),ix.exports}var mne=hne();const yne=Xe(mne);function gne(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:o=2}=t;return e.split(r).reduce((a,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?o:n,l=s.map(u=>u.substr(0,c)).join("");return a.push(l),a},[]).join(r)}function vne(e,t={}){const n=yne("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class bne{static isGreaterOrEqual(t,n){const r=sI(t),o=sI(n);return r[0]>o[0]||r[0]===o[0]&&r[1]>o[1]||r[0]===o[0]&&r[1]===o[1]&&r[2]>=o[2]}}function sI(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ye{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&bne.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const o of Object.keys(r))typeof r[o]>"u"&&delete r[o];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const o of Object.keys(r))typeof r[o]>"u"&&delete r[o];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const o=n&&n.joiner?n.joiner:"_";let a=r.length===1?r[0]:r.join(o);if(t&&t>0&&a.length>t){if(n&&n.shorten===!0){const i=gne(a);if(i.length<t)return i}return vne(a,{length:t})}return a}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),o=t.substr(r+2),a=o.indexOf("/"),i=a!==-1?o.substr(0,a):o;let s=a!==-1?o.substr(a+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,f="";const h=l.indexOf(":");h!==-1&&(d=l.substr(0,h),f=l.substr(h+1));const[y,m]=u.split(":");return{type:n,host:y,username:decodeURIComponent(d),password:decodeURIComponent(f),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),o=t.substr(r+2),a=o.indexOf("/"),i=a!==-1?o.substr(0,a):o;let s=a!==-1?o.substr(a+1):void 0,c="",l,u,d,f,h={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const j=c.split("&");let E,S;j.forEach(O=>{E=O.split("=")[0],S=O.split("=")[1],h[E]=S}),f=h.replicaSet,s=s.substr(0,s.indexOf("?"))}const y=i.lastIndexOf("@"),m=i.substr(0,y),v=i.substr(y+1);let b=m,x="";const _=m.indexOf(":");_!==-1&&(b=m.substr(0,_),x=m.substr(_+1)),f?d=v:[l,u]=v.split(":");let w={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(x),port:u?parseInt(u):void 0,database:s||void 0};for(const[j,E]of Object.entries(h))w[j]=E;return w}}class cI{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Dt.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(zr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(zr.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!zr.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ye.buildAlias(this.connection.driver,void 0,t,this.alias.name):ye.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class yx{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,Dt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class gx{constructor(t,n){this.expressionMap=t,Dt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!zr.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class vx{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new KR;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new vx(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new KR(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new cI(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new yx(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new gx(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class lI{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class bx{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,o)=>o.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,o)=>o.to(r),n):t.to(n)}}class El{constructor(t,n,r=!0,o=!1,a,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=o,this._getSql=a,this._objectLiteralParameters=i}get useParameter(){return pt.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return pt.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return pt.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return pt.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(pt.isFindOperator(this._value))return this._value}get getSql(){return pt.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof El?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&bx.transformTo(t,n)):bx.transformTo(t,this._value)}}function Vr(e){return new El("in",e,!0,!0)}const xne=/[.*+\-?^${}()|[\]\\]/g,wne=e=>e.replace(xne,"\\$&");class kt{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,pt.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new vx(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){kt.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),pt.isSelectQueryBuilder(this)?this:kt.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",pt.isInsertQueryBuilder(this)?this:kt.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=pt.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const o=this.createFromAlias(t);this.expressionMap.setMainAlias(o)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,pt.isUpdateQueryBuilder(this)?this:kt.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",pt.isDeleteQueryBuilder(this)?this:kt.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",pt.isSoftDeleteQueryBuilder(this)?this:kt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",pt.isSoftDeleteQueryBuilder(this)?this:kt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,o=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=o,r){const a=this.createFromAlias(r);this.expressionMap.setMainAlias(a)}return pt.isRelationQueryBuilder(this)?this:kt.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(o=>!!r.findRelationWithPropertyPath(o))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(o=>o.discriminatorColumn).map(o=>o.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const a=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:a?void 0:t,subQuery:a?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const o=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:o})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const a of this.expressionMap.aliases){if(!a.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&a.name?`${a.name}.`:"";n[i]||(n[i]={});for(const s of a.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of a.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of a.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of a.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of a.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),o=r.map(a=>wne(a)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${o?"("+o+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...a)=>{let i,s,c;if(o){if(i=a[0],s=a[1],c=a[3],n[a[2]][c])return`${s}${this.escape(a[2].substring(0,a[2].length-1))}.${this.escape(n[a[2]][c])}`}else if(i=a[0],s=a[1],c=a[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const o=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&o.deleteDateColumn){const a=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+o.deleteDateColumn.propertyName:o.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(a)} IS NULL`;t.push(i)}if(o.discriminatorColumn&&o.parentEntityMetadata){const a=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+o.discriminatorColumn.databaseName:o.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(a)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const o=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(o)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(o=>n.indexOf(o)===-1)),n.length){let o=n.map(a=>{const i=this.escape(a.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(o+=" INTO "+n.map(a=>this.createParameter({type:r.columnTypeToNativeParameter(a.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(o+=" INTO @OutputTable"),o}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const o=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${o}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${o}${this.connection.options.isolateWhereStatements?")":""}`}return o}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${El.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!pt.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let o=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(pt.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);o+=`(${s.join(", ")})`}const a=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[a,o,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(o=>n.ensureEntityIdMap(o));if(!n.hasMultiplePrimaryKeys){const o=n.primaryColumns[0];if(!o.transformer&&!o.relationMetadata&&!o.embeddedMetadata)return{[o.propertyName]:Vr(r.map(a=>o.getEntityValue(a,!1)))}}return new lI(o=>{for(const a of r)o.orWhere(new lI(i=>i.where(a)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],o=t.split(".");for(;o.length>1;){const s=o[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){o.unshift(`${o.shift()}.${o.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),o.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const a=o.join("."),i=n.metadata.findColumnsWithPropertyPath(a);if(!i.length)throw new $r(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const o=[];for(const a of Object.keys(n)){const i=r?`${r}.${a}`:a;if(n[a]===null||typeof n[a]!="object"||pt.isFindOperator(n[a])){o.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[a],i);o.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[a],!1))){o.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[a],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);o.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[a]).map(u=>`${i}.${u}`);o.push(...l);continue}o.push(i)}return o}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[o,a,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of a){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${o.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(pt.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const o of n.value)r.push(this.createParameter(o));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const o=n.value;return{operator:n.type,parameters:o.map(a=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,a)))}}else if(n.type==="or"){const o=n.value;return{operator:n.type,parameters:o.map(a=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,a)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(pt.isBrackets(t)){const o=this.createQueryBuilder();return o.parentQueryBuilder=this,o.expressionMap.mainAlias=this.expressionMap.mainAlias,o.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,o.expressionMap.parameters=this.expressionMap.parameters,o.expressionMap.nativeParameters=this.expressionMap.nativeParameters,o.expressionMap.wheres=[],t.whereFactory(o),{operator:pt.isNotBrackets(t)?"not":"brackets",condition:o.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const o of n){const a=[];for(const[i,s]of this.getPredicates(o))a.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:a})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}kt.queryBuilderRegistry={};class _ne{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class jne extends kt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let o=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),o=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const a=await r.query(t,n,!0),i=_ne.from(a);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),o&&await r.commitTransaction(),i}catch(a){if(o)try{await r.rollbackTransaction()}catch{}throw a}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new Uf;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Hf;const Ene=new Uint8Array(16);function Sne(){if(!Hf&&(Hf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Hf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hf(Ene)}const Qt=[];for(let e=0;e<256;++e)Qt.push((e+256).toString(16).slice(1));function Cne(e,t=0){return Qt[e[t+0]]+Qt[e[t+1]]+Qt[e[t+2]]+Qt[e[t+3]]+"-"+Qt[e[t+4]]+Qt[e[t+5]]+"-"+Qt[e[t+6]]+Qt[e[t+7]]+"-"+Qt[e[t+8]]+Qt[e[t+9]]+"-"+Qt[e[t+10]]+Qt[e[t+11]]+Qt[e[t+12]]+Qt[e[t+13]]+Qt[e[t+14]]+Qt[e[t+15]]}const One=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),uI={randomUUID:One};function Nne(e,t,n){if(uI.randomUUID&&!t&&!e)return uI.randomUUID();e=e||{};const r=e.random||(e.rng||Sne)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Cne(r)}class dI{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class fI{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class xx{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(o,a)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[a]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,o,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(o);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,o,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let o=r.getInsertionReturningColumns();const a=this.queryRunner.connection.driver.isReturningSqlSupported("insert");o=o.filter(s=>s.isGenerated?a===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,f,h)=>(d[this.expressionMap.extraReturningColumns[h].databaseName]=f[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(o.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(o.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class Mne extends kt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new fI;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const h=new dI;t.forEach(y=>{n.broadcaster.broadcastBeforeInsertEvent(h,this.expressionMap.mainAlias.metadata,y)}),await h.wait()}let o=null,a=null;const i=new xx(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const h of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(h));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(h=>!s.includes(h)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(o=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),a="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[o,c,a].filter(h=>h!=null).join(`;

`),d=await n.query(u,l,!0),f=fI.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(f,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const h=new dI;t.forEach(y=>{n.broadcaster.broadcastAfterInsertEvent(h,this.expressionMap.mainAlias.metadata,y)}),await h.wait()}return r&&await n.commitTransaction(),f}catch(o){if(r)try{await n.rollbackTransaction()}catch{}throw o}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new Uf;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),o=this.createColumnNamesExpression();let a="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(a="UPSERT "),(ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(a+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),a+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ye.isPostgresFamily(this.connection.driver)&&(a+=` AS "${this.alias}"`),o?a+=`(${o})`:!n&&(ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(a+="()"),r&&this.connection.driver.options.type==="mssql"&&(a+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?a+=` ${n}`:a+=` VALUES ${n}`:ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?a+=" VALUES ()":a+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)a+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)a+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:f}=this.expressionMap.onUpdate;let h="ON CONFLICT";if(Array.isArray(u)){if(h+=` ( ${u.map(m=>this.escape(m)).join(", ")} )`,f&&!ye.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");f&&ye.isPostgresFamily(this.connection.driver)&&(h+=` WHERE ( ${f} )`)}else u&&(h+=` ON CONSTRAINT ${this.escape(u)}`);const y=[];Array.isArray(c)?y.push(...c.map(m=>`${this.escape(m)} = EXCLUDED.${this.escape(m)}`)):l&&y.push(...l.map(m=>`${this.escape(m)} = :${m}`)),y.length>0&&(a+=` ${h} DO UPDATE SET `,y.push(...this.expressionMap.mainAlias.metadata.columns.filter(m=>m.isUpdateDate&&!(c!=null&&c.includes(m.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ye.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(m=>`${this.escape(m.databaseName)} = DEFAULT`)),a+=y.join(", "),a+=" "),Array.isArray(c)&&d&&ye.isPostgresFamily(this.connection.driver)&&(a+=" WHERE (",a+=c.map(m=>`${t}.${this.escape(m)} IS DISTINCT FROM EXCLUDED.${this.escape(m)}`).join(" OR "),a+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(a+=" ON DUPLICATE KEY UPDATE ",a+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),a+=" "):Array.isArray(l)&&(a+=" ON DUPLICATE KEY UPDATE ",a+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),a+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ye.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ye.isMySQLFamily(this.connection.driver))&&(a+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(a=`SET IDENTITY_INSERT ${t} ON; ${a}; SET IDENTITY_INSERT ${t} OFF`),a}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ye.isSQLiteFamily(this.connection.driver)&&!ye.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((o,a)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(o);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=Nne(),r+=this.createParameter(c),a in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[a]={}),i.setEntityValue(this.expressionMap.locallyGenerated[a],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ye.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ye.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?a===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((o,a)=>{Object.keys(o).forEach((i,s)=>{s===0&&(r+="(");const c=o[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ye.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(o).length-1?a===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(Dt.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new ine}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class pI{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((o,a)=>{const i=Dt.isObject(t)?a.referencedColumn.getEntityValue(t):t;return a.setEntityValue(o,i),o},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const o=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a={},i=[];o.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const f="joinColumn_"+l+"_"+d;a[f]=Dt.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${f}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(a).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,o=n.inverseRelation.joinColumns.reduce((a,i)=>{const s=Dt.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(a,s),a},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,o=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?o:a,s=n.isManyToManyOwner?a:o,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(f=>{d[f.databaseName]=Dt.isObject(l)?f.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(f=>{d[f.databaseName]=Dt.isObject(u)?f.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class kne{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],a={};n.inverseRelation.joinColumns.forEach(l=>{a[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...o.map((d,f)=>[...n.inverseRelation.joinColumns.map((h,y)=>{const m="joinColumn_"+u+"_"+f+"_"+y;return i[m]=Dt.isObject(l)?h.referencedColumn.getEntityValue(l):l,`${h.propertyPath} = :${m}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((h,y)=>{const m="primaryColumn_"+f+"_"+f+"_"+y;return i[m]=Dt.isObject(d)?h.getEntityValue(d):d,`${h.propertyPath} = :${m}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,o=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?o:a,s=n.isManyToManyOwner?a:o,c={},l=[];i.forEach((d,f)=>{l.push(...s.map((h,y)=>[...r.ownerColumns.map((m,v)=>{const b="firstValue_"+f+"_"+y+"_"+v;return c[b]=Dt.isObject(d)?m.referencedColumn.getEntityValue(d):d,`${m.databaseName} = :${b}`}),...r.inverseColumns.map((m,v)=>{const b="secondValue_"+f+"_"+y+"_"+v;return c[b]=Dt.isObject(h)?m.referencedColumn.getEntityValue(h):h,`${m.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class Pne extends kt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Dt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new pI(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Dt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new pI(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new kne(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!Dt.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class Jt{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,o)=>t.slice(o*n,o*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,o)=>{const a=n(o);let i=r.find(s=>s.id===a);return i||(i={id:a,items:[]},r.push(i)),i.items.push(o),r},[])}static uniq(t,n){return t.reduce((r,o)=>{let a=!1;if(typeof n=="function"){const i=n(o);a=!!r.find(s=>n(s)===i)}else typeof n=="string"?a=!!r.find(i=>i[n]===o[n]):a=r.indexOf(o)!==-1;return a||r.push(o),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,o){if(o.has(r)){t[n]=o.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),o.set(r,t[n]),this.merge(t[n],r,o),o.delete(r)}}static mergeObjectKey(t,n,r,o){if(o.has(r)){Object.assign(t,{[n]:o.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),o.set(r,t[n]),this.merge(t[n],r,o),o.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const o of Object.keys(n))o!=="__proto__"&&this.mergeObjectKey(t,o,n[o],r);if(Array.isArray(t)&&Array.isArray(n))for(let o=0;o<n.length;o++)this.mergeArrayKey(t,o,n[o],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)Jt.merge(t,r);return t}static deepCompare(...t){let n,r,o,a;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(o=[],a=[],!this.compare2Objects(o,a,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let o=0,a=r.length;o<a;o++)t=t[r[o]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const o=r.split(".");if(!o.length)continue;(!n[o[0]]||n[o[0]]===!0)&&(n[o[0]]={});let a=n[o[0]];for(let[i,s]of o.entries())i!==0&&(a[s]?a=a[s]:i===o.length-1?(a[s]={},a=null):(a[s]={},a=a[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:Jt.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,o,a)=>(r[o]=n[a],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(o=>o!==n);return n.some(o=>r.some(a=>a.includes(o)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const o=t.substring(r.index+r[0].length);let a="",i="";const s=[];for(let c=0;c<o.length;c++){const l=o[c];switch(l){case",":a==""?(s.push(i),i=""):i+=l;break;case"'":a==l?o[c+1]===l?(i+=l,c+=1):a="":a=l;break;case")":if(a=="")return s.push(i),s;i+=l;break;default:a!=""&&(i+=l)}}}}static compare2Objects(t,n,r,o){let a;if(Number.isNaN(r)&&Number.isNaN(o)||r===o)return!0;if(r===null||o===null||r===void 0||o===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(o))return!0;if(typeof r=="function"&&typeof o=="function"||r instanceof Date&&o instanceof Date||r instanceof RegExp&&o instanceof RegExp||typeof r=="string"&&typeof o=="string"||typeof r=="number"&&typeof o=="number")return r.toString()===o.toString();if(!(typeof r=="object"&&typeof o=="object")||Object.prototype.isPrototypeOf.call(r,o)||Object.prototype.isPrototypeOf.call(o,r)||r.constructor!==o.constructor||r.prototype!==o.prototype||t.indexOf(r)>-1||n.indexOf(o)>-1)return!1;for(a in o)if(o.hasOwnProperty(a)!==r.hasOwnProperty(a)||typeof o[a]!=typeof r[a])return!1;for(a in r){if(o.hasOwnProperty(a)!==r.hasOwnProperty(a)||typeof o[a]!=typeof r[a])return!1;switch(typeof r[a]){case"object":case"function":if(t.push(r),n.push(o),!this.compare2Objects(t,n,r[a],o[a]))return!1;t.pop(),n.pop();break;default:if(r[a]!==o[a])return!1;break}}return!0}}class Ane{constructor(t,n,r,o,a){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=o,this.queryRunner=a}transform(t,n){const r=this.group(t,n),o=[];return r.forEach(a=>{const i=this.transformRawResultsGroup(a,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&o.push(i)}),o}group(t,n){const r=new Map,o=[];return n.metadata.tableType==="view"?o.push(...n.metadata.columns.map(a=>ye.buildAlias(this.driver,void 0,n.name,a.databaseName))):o.push(...n.metadata.primaryColumns.map(a=>ye.buildAlias(this.driver,void 0,n.name,a.databaseName))),t.forEach(a=>{const i=o.map(c=>{const l=a[c];return Kh.isBuffer(l)?l.toString("hex"):Dt.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(a):r.set(i,[a])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ye.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(f=>f===d.discriminatorValue)<"u");u&&(r=u)}let o=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const a=this.transformColumns(t,n,o,r),i=this.transformJoins(t,o,n,r),s=this.transformRelationIds(t,n,o,r),c=this.transformRelationCounts(t,n,o);if(a||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return o}transformColumns(t,n,r,o){let a=!1;return o.columns.forEach(i=>{if(o.childEntityMetadatas.length>0&&o.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ye.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(a=!0))}),a}transformJoins(t,n,r,o){let a=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!o.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),a=!0)}),a}transformRelationIds(t,n,r,o){let a=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],f=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),h=(y,m,v)=>{const b=y.shift();if(b&&y.length===0)return m[b]=v,m;if(b&&y.length>0)h(y,m[b],v);else return m};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(h(f,r,d[0]),a=!0):(h(f,r,d),a=a||d.length>0)}),a}transformRelationCounts(t,n,r){let o=!1;return this.rawRelationCountResults.filter(a=>a.relationCountAttribute.parentAlias===n.name).forEach(a=>{const i=a.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ye.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[a.relationCountAttribute.mapToPropertyPropertyName]=0,a.results.filter(l=>l.parentId===c).forEach(l=>{r[a.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),o=!0}))}),o}createValueMapFromJoinColumns(t,n,r){let o;return t.isManyToOne||t.isOneToOneOwner?o=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?o=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?o=t.joinColumns.map(a=>a):o=t.inverseRelation.inverseJoinColumns.map(a=>a),o.reduce((a,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?a[i.databaseName]=this.driver.prepareHydratedValue(s[ye.buildAlias(this.driver,void 0,n,i.databaseName)],i):a[i.databaseName]=this.driver.prepareHydratedValue(s[ye.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),a),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?r=t.joinColumns.map(o=>o):r=t.inverseRelation.inverseJoinColumns.map(o=>o),r.reduce((o,a)=>(o[a.databaseName]=n[a.databaseName],o),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((o,a)=>{let i=r.reduce((s,c)=>{let l=a[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),Jt.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),Jt.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,a);o[s]?o[s].push(i):o[s]=[i]}return o},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let Tne=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},o=e.map(a=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(a[ye.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(a[ye.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(a=>a);return{relationIdAttribute:n,results:o}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,o=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,a=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((h,y)=>{const m=[],v={},b=o.map(_=>{const w=_.databaseName+y,j=h[ye.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],E=`${s}:${_.propertyPath}:${j}`;return m.indexOf(E)!==-1?"":(m.push(E),v[w]=j,s+"."+_.propertyPath+" = :"+w)}).filter(_=>_).join(" AND ");m.sort();const x=m.join("::");return c[x]?"":(c[x]=!0,Object.assign(l,v),b)}).filter(h=>h).map(h=>"("+h+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);Jt.uniq([...o,...r.inverseRelation.entityMetadata.primaryColumns],h=>h.propertyPath).forEach(h=>{d.addSelect(s+"."+h.propertyPath,h.databaseName)}),d.from(a,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const f=await d.getRawMany();return f.forEach(h=>{o.forEach(y=>{h[y.databaseName]=this.connection.driver.prepareHydratedValue(h[y.databaseName],y.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(y=>{h[y.databaseName]=this.connection.driver.prepareHydratedValue(h[y.databaseName],y)})}),{relationIdAttribute:n,results:f}}else{const r=n.relation,o=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,a=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(x=>o.reduce((_,w)=>(_[w.propertyPath]=x[ye.buildAlias(this.connection.driver,void 0,n.parentAlias,w.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},f={},h=u.map((x,_)=>{const w=[],j={},E=Object.keys(x).map(O=>{const k=O+_,N=x[O],P=`${i}:${O}:${N}`;return w.indexOf(P)!==-1?"":(w.push(P),j[k]=N,i+"."+O+" = :"+k)}).filter(O=>O).join(" AND ");w.sort();const S=w.join("::");return f[S]?"":(f[S]=!0,Object.assign(d,j),E)}).filter(x=>x),y=a.map(x=>i+"."+x.propertyPath+" = "+c+"."+x.referencedColumn.propertyPath).join(" AND "),m=h.map(x=>"("+x+" AND "+y+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);a.forEach(x=>{v.addSelect(i+"."+x.propertyPath,x.databaseName).addOrderBy(i+"."+x.propertyPath)}),o.forEach(x=>{v.addSelect(i+"."+x.propertyPath,x.databaseName).addOrderBy(i+"."+x.propertyPath)}),v.from(s,c).innerJoin(l,i,m).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(x=>{[...o,...a].forEach(_=>{x[_.databaseName]=this.connection.driver.prepareHydratedValue(x[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class Rne{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const o=Array.isArray(n)?n:[n],a=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,o,a):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,o,a):this.loadForOneToManyAndOneToOneNotOwner(t,o,a)}async loadManyToManyRelationIdsAndGroup(t,n,r,o){const a=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,o),!r.length))return i.map(d=>({entity:d,related:a?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const f={entity:d,related:a?[]:void 0},h=s.filter(y=>u.every(m=>m.compareEntityValue(d,y[m.entityMetadata.name+"_"+m.propertyAliasName])));return h.length&&c.forEach(y=>{h.forEach(m=>{l.every(v=>v.compareEntityValue(y,m[ye.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(a?f.related.push(y):f.related=y)})}),f})}loadForManyToMany(t,n,r){const o=t.junctionEntityMetadata,a=o.name,i=t.isOwning?o.ownerColumns:o.inverseColumns,s=t.isOwning?o.inverseColumns:o.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(f=>{const h=ye.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(a+"."+f.propertyPath,h)}),s.forEach(f=>{const h=ye.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(a+"."+f.propertyPath,h)});let l="";if(i.length===1){const f=n.map(h=>i[0].referencedColumn.getEntityValue(h));f.every(h=>typeof h=="number")?l=`${a}.${i[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values1",f),l=a+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((f,h)=>i.map(y=>{const m="entity1_"+h+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),a+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const f=r.map(h=>s[0].referencedColumn.getEntityValue(h));f.every(h=>typeof h=="number")?u=`${a}.${s[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values2",f),u=a+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((f,h)=>s.map(y=>{const m="entity2_"+h+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),a+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const d=[l,u].filter(f=>f.length>0).join(" AND ");return c.from(o.target,a).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const o=t.entityMetadata.targetName,a=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&a){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const f=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[f]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(f=>{const h=f.getEntityValue(l),y=f.referencedColumn.getEntityValue(d);if(!(h===void 0||y===void 0)&&h===y){const m=f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[m]=y}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ye.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(o+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ye.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(o+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${o}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=o+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const f="entity"+l+"_"+d;return i.setParameter(f,u.getEntityValue(c)),o+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,o).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),f=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[f]=u}),c}));const o=t.entityMetadata.targetName,a=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ye.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));a.addSelect(o+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ye.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));a.addSelect(o+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${o}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(a.setParameter("values",s),i=o+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return a.setParameter(d,l.referencedColumn.getEntityValue(s)),o+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return a.from(t.entityMetadata.target,o).where(i).getRawMany()}}class Ine{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new yx(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class Dne{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(o,a,i)=>i.indexOf(o)===a,r=this.relationCountAttributes.map(async o=>{if(o.relation.isOneToMany){const a=o.relation,i=a.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=a.inverseEntityMetadata.target,l=a.inverseEntityMetadata.tableName,u=o.alias||l,d=i.propertyName;let f=t.map(y=>y[o.parentAlias+"_"+s]).filter(y=>!!y);if(f=f.filter(n),f.length===0)return{relationCountAttribute:o,results:[]};const h=this.connection.createQueryBuilder(this.queryRunner);return h.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",f),o.queryBuilderFactory&&o.queryBuilderFactory(h),{relationCountAttribute:o,results:await h.getRawMany()}}else{let a,i,s,c;o.relation.isOwning?(a=o.relation.joinColumns[0].referencedColumn.databaseName,i=o.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=o.relation.junctionEntityMetadata.columns[0],c=o.relation.junctionEntityMetadata.columns[1]):(a=o.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=o.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=o.relation.junctionEntityMetadata.columns[1],c=o.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[o.parentAlias+"_"+a]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:o,results:[]};const u=o.junctionAlias,d=o.joinInverseSideMetadata.tableName,f=o.alias||d,h=o.relation.junctionEntityMetadata.tableName,y=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+f+"."+i,m=this.connection.createQueryBuilder(this.queryRunner);return m.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+m.escape(f)+"."+m.escape(i)+")","cnt").from(d,f).innerJoin(h,u,y).addGroupBy(u+"."+s.propertyName),o.queryBuilderFactory&&o.queryBuilderFactory(m),{relationCountAttribute:o,results:await m.getRawMany()}}});return Promise.all(r)}}class Lne{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new gx(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class wx{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(wx.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new sne(r)}return t}static applyRelationsRecursively(t,n,r,o,a){let i=[];if(a){const s=new RegExp("^"+a.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>o.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>o.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ye.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(a?a+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const f=t.expressionMap.joinAttributes.find(h=>h.entityOrProperty===l);u=f.metadata,d=f.alias.name}if(!d||!u)throw new $r(s.propertyPath,o);if(this.applyRelationsRecursively(t,n,d,u,a?a+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const f=o.relations.find(h=>h.propertyName===s.propertyPath);f&&this.joinEagerRelations(t,c,f.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(o=>{let a=ye.buildAlias(t.connection.driver,{joiner:"__"},n,o.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${o.propertyPath}`)){i=!1,a=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===a);i&&!s&&t.leftJoin(n+"."+o.propertyPath,a);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==a)){c=!1;break}c&&t.addSelect(a),this.joinEagerRelations(t,a,o.inverseEntityMetadata)})}}class _x extends kt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,o){return this.join("INNER",t,n,r,o),this}leftJoin(t,n,r,o){return this.join("LEFT",t,n,r,o),this}innerJoinAndSelect(t,n,r,o){return this.addSelect(n),this.innerJoin(t,n,r,o),this}leftJoinAndSelect(t,n,r,o){return this.addSelect(n),this.leftJoin(t,n,r,o),this}innerJoinAndMapMany(t,n,r,o,a){return this.addSelect(r),this.join("INNER",n,r,o,a,t,!0),this}innerJoinAndMapOne(t,n,r,o,a,i){return this.addSelect(r),this.join("INNER",n,r,o,a,t,!1,i),this}leftJoinAndMapMany(t,n,r,o,a){return this.addSelect(r),this.join("LEFT",n,r,o,a,t,!0),this}leftJoinAndMapOne(t,n,r,o,a,i){return this.addSelect(r),this.join("LEFT",n,r,o,a,t,!1,i),this}loadRelationIdAndMap(t,n,r,o){const a=new yx(this.expressionMap);return a.mapToProperty=t,a.relationName=n,typeof r=="string"&&(a.alias=r),typeof r=="object"&&r.disableMixedMap&&(a.disableMixedMap=!0),a.queryBuilderFactory=o,this.expressionMap.relationIdAttributes.push(a),a.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:a.junctionAlias,metadata:a.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,o){const a=new gx(this.expressionMap);return a.mapToProperty=t,a.relationName=n,a.alias=r,a.queryBuilderFactory=o,this.expressionMap.relationCountAttributes.push(a),this.expressionMap.createAlias({type:"other",name:a.junctionAlias}),a.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:a.junctionAlias,metadata:a.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new jl;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new qR(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new qR(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new rne(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new jl;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new jl;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new jl;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new jl;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const o=this.expressionMap.cacheId;this.expressionMap.cacheId=o&&`${o}-count`;const a=await this.executeCountQuery(t),i=[r.entities,a];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let o=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),o=!0);const a=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,a,a);return o&&await r.commitTransaction(),i}catch(a){if(o)try{await r.rollbackTransaction()}catch{}throw a}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,o,a,i,s,c){a&&this.setParameters(a);const l=new cI(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=o,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const h=n(this.subQuery());this.setParameters(h.getParameters()),d=h.getQuery()}else d=n;const f=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:f===!1?n:void 0,subQuery:f===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ye.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const o=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),a=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return a+i+" FROM "+o.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:o}=this.connection;let a="SELECT ";return r>0&&ye.isMySQLFamily(o)&&(a+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ye.isPostgresFamily(o)&&n.length>0?a=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(a="SELECT DISTINCT "),a}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,o=t.alias.name;let a=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(o)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>o+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(o)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+a)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(a+=" AND "+o+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),o+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(o)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+a)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>o+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>o+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(o)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+a)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,o=this.expressionMap.selects.find(a=>a.selection===n);if(o&&!o.aliasName&&n.indexOf(".")!==-1){const a=n.split("."),i=a[0],s=a.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ye.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new lne}else if(ye.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ye.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ye.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ye.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new ns;case"pessimistic_write":if(ye.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ye.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new ns;case"pessimistic_partial_write":if(ye.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ye.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new ns;case"pessimistic_write_or_fail":if(ye.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ye.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new ns;case"for_no_key_update":if(ye.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new ns;case"for_key_share":if(ye.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new ns;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),o=[];if(r&&o.push(...n.columns.filter(l=>l.isSelect===!0)),o.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),o.length===0)return[];const a=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>o.indexOf(l)===-1):[],i=[...o,...a],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ye.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(f=>f.selection===t+"."+l.propertyPath);if(d.length)d.forEach(f=>{s.push({selection:u,aliasName:f.aliasName?f.aliasName:ye.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:f.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ye.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(o=>o.selection===t);return r?[r]:this.expressionMap.selects.filter(o=>n.columns.some(a=>o.selection===t+"."+a.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ye.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", ")+"))";if(ye.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const o=n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${o}))`:`COUNT(DISTINCT(CONCAT(${o})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(o=>`CAST(${r}.${this.escape(o.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?Jt.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?Jt.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(o=>o.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&wx.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new cne;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new ane(i.name)}const n=new Tne(this.connection,t,this.expressionMap.relationIdAttributes),r=new Dne(this.connection,t,this.expressionMap.relationCountAttributes);new Ine(this.expressionMap).transform(),new Lne(this.expressionMap).transform();let o=[],a=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(h=>{const y=this.escape("distinctAlias"),m=this.escape(ye.buildAlias(this.connection.driver,void 0,l,h.databaseName));s[m]||(s[m]="ASC");const v=ye.buildAlias(this.connection.driver,void 0,"ids_"+l,h.databaseName);return`${y}.${m} AS ${this.escape(v)}`}),d=this.clone(),f=d.expressionMap.timeTravel;if(o=await new _x(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(f).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),o.length>0){let h="";const y={};if(c.hasMultiplePrimaryKeys)h=o.map((m,v)=>c.primaryColumns.map(b=>{const x=`orm_distinct_ids_${v}_${b.databaseName}`,_=ye.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return y[x]=m[_],`${l}.${b.propertyPath}=:${x}`}).join(" AND ")).join(" OR ");else{const m=ye.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=o.map(b=>b[m]);v.every(b=>typeof b=="number")?h=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(y.orm_distinct_ids=v,h=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}o=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:h}).setParameters(y).loadRawResults(t)}}else o=await this.loadRawResults(t);if(o.length>0){const i=await n.load(o),s=await r.load(o);a=new Ane(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(o,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,a)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new Rne(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?Jt.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?Jt.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,f=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?Jt.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?Jt.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?Jt.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(a.length>0){const h=await i.loadManyToManyRelationIdsAndGroup(s,a,void 0,f);a.forEach(y=>{const m=h.find(v=>v.entity===y);if(m){const v=m.related===void 0?null:m.related;s.setEntityValue(y,v)}})}}))}return{raw:o,entities:a}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(a=>{if(a.indexOf(".")!==-1){const i=a.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ye.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===a||i.aliasName===a)?this.escape(t)+"."+this.escape(a):""}).join(", "),o={};return Object.keys(n).forEach(a=>{if(a.indexOf(".")!==-1){const i=a.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);o[this.escape(t)+"."+this.escape(ye.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[a]}else this.expressionMap.selects.find(i=>i.selection===a||i.aliasName===a)?o[this.escape(t)+"."+this.escape(a)]=n[a]:o[a]=n[a]}),[r,o]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),o=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),a=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=a.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:o,duration:this.expressionMap.cacheDuration||a.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!a.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:o,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||a.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!a.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return Dt.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,o){for(let a in t){if(t[a]===void 0||t[a]===!1)continue;const i=o?o+"."+a:a,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new $r(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[a],n,r,i)}}buildRelations(t,n,r,o,a){t&&Object.keys(t).forEach(i=>{const s=t[i],c=a?a+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new $r(c,r);if(l)this.buildRelations(s,typeof n=="object"?Jt.deepValue(n,l.propertyPath):void 0,r,o,c);else if(u){let d=o+"_"+c.replace(".","_");d=ye.buildAlias(this.connection.driver,{joiner:"__"},o,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:o,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?Jt.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,o,a){t&&Object.keys(t).forEach(i=>{const s=t[i],c=a?a+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new $r(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?Jt.deepValue(n,l.propertyPath):void 0,r,o,c);else if(u){let d=o+"_"+c.replace(".","_");d=ye.buildAlias(this.connection.driver,{joiner:"__"},o,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let h=d+"_"+f.propertyPath.replace(".","_");h=ye.buildAlias(this.connection.driver,{joiner:"__"},d,h),this.joins.find(y=>y.alias===h)||this.joins.push({type:"left",select:!0,alias:h,parentAlias:d,selection:void 0,relationMetadata:f}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?Jt.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,o){for(let a in t){if(t[a]===void 0)continue;const i=o?o+"."+a:a,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new $r(i,n);if(s){let u=typeof t[a]=="object"?t[a].direction:t[a];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[a]=="object"?t[a].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let f=`${r}.${i}`;this.addOrderBy(f,u,d)}else if(c)this.buildOrder(t[a],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ye.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[a],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,o){let a="";if(Array.isArray(t))t.length&&(a=t.map(i=>this.buildWhere(i,n,r,o)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=o?o+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new $r(c,n);if(l){let f=`${r}.${c}`;l.isVirtualProperty&&l.query&&(f=`(${l.query(r)})`);let h=t[s];pt.isEqualOperator(t[s])&&(h=t[s].value),l.transformer&&(h instanceof El?h.transformValue(l.transformer):h=bx.transformTo(l.transformer,h)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,h)))}else if(u){const f=this.buildWhere(t[s],n,r,c);f&&i.push(f)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(f=>t[s][f]===void 0))continue;if(pt.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let f="";t[s].type==="moreThan"?f=">":t[s].type==="lessThan"?f="<":t[s].type==="moreThanOrEqual"?f=">=":t[s].type==="lessThanOrEqual"&&(f="<=");const h=this.subQuery();if(d.isManyToManyOwner)h.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(y=>`${d.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)h.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(y=>`${d.inverseRelation.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)h.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(y=>`${d.inverseEntityMetadata.tableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(h.getSql()+" "+f+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const f=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let f=r+"_"+d.propertyPath.replace(".","_");f=ye.buildAlias(this.connection.driver,{joiner:"__"},r,f),this.joins.find(y=>y.alias===f)||this.joins.push({type:"left",select:!1,selection:void 0,alias:f,parentAlias:r,relationMetadata:d});const h=this.buildWhere(t[s],d.inverseEntityMetadata,f);h&&i.push(h)}}}a=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return a.length?"("+a+")":a}}class hI{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Fne extends kt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new xx(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[o,a]=this.getQueryAndParameters(),i=await t.query(o,a,!0),s=hI.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Uf;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const o=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!o)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(o)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new one(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new ax;const r=this.createWhereExpression(),o=this.createReturningExpression("update");return o===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${o}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${o}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ye.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new YR}return""}}class Bne extends kt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,o=null;const a=new xx(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=a.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(f=>!i.includes(f)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),o="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,o],u=await t.query(l.filter(f=>f!=null).join(`;

`),c,!0),d=hI.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await a.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Uf;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const o=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!o)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(o)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const o=[],a=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new $r(c,n);l.forEach(u=>{if(!u.isUpdate||a.includes(u))return;a.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!Kh.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")o.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)o.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const f=this.createParameter(d);let h=null;if((ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?h=`${y}(${f}, ${u.srid})`:h=`${y}(${f})`}else ye.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?h=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:h=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?h=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":h=f;o.push(this.escape(u.databaseName)+" = "+h)}})}),(o.length>0||Object.keys(r).length===0)&&(n.versionColumn&&a.indexOf(n.versionColumn)===-1&&o.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&a.indexOf(n.updateDateColumn)===-1&&o.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")o.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)o.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);o.push(this.escape(c)+" = "+u)}}),o.length<=0)throw new ax;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${o.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${o.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${o.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ye.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new YR}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new ax}}function $ne(){kt.registerQueryBuilderClass("DeleteQueryBuilder",e=>new jne(e)),kt.registerQueryBuilderClass("InsertQueryBuilder",e=>new Mne(e)),kt.registerQueryBuilderClass("RelationQueryBuilder",e=>new Pne(e)),kt.registerQueryBuilderClass("SelectQueryBuilder",e=>new _x(e)),kt.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new Fne(e)),kt.registerQueryBuilderClass("UpdateQueryBuilder",e=>new Bne(e))}var mI;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(mI||(mI={}));var jx={exports:{}},Ex,yI;function zne(){if(yI)return Ex;yI=1;var e=1e3,t=e*60,n=t*60,r=n*24,o=r*7,a=r*365.25;Ex=function(u,d){d=d||{};var f=typeof u;if(f==="string"&&u.length>0)return i(u);if(f==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var f=parseFloat(d[1]),h=(d[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return f*a;case"weeks":case"week":case"w":return f*o;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,f,h){var y=d>=f*1.5;return Math.round(u/f)+" "+h+(y?"s":"")}return Ex}var Sx,gI;function Vne(){if(gI)return Sx;gI=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=a,r.enabled=s,r.humanize=zne(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let f=0;for(let h=0;h<d.length;h++)f=(f<<5)-f+d.charCodeAt(h),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=n;function r(d){let f,h=null,y,m;function v(...b){if(!v.enabled)return;const x=v,_=Number(new Date),w=_-(f||_);x.diff=w,x.prev=f,x.curr=_,f=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let j=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(E,S)=>{if(E==="%%")return"%";j++;const O=r.formatters[S];if(typeof O=="function"){const k=b[j];E=O.call(x,k),b.splice(j,1),j--}return E}),r.formatArgs.call(x,b),(x.log||r.log).apply(x,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=o,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(y!==r.namespaces&&(y=r.namespaces,m=r.enabled(d)),m),set:b=>{h=b}}),typeof r.init=="function"&&r.init(v),v}function o(d,f){const h=r(this.namespace+(typeof f>"u"?":":f)+d);return h.log=this.log,h}function a(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let f;const h=(typeof d=="string"?d:"").split(/[\s,]+/),y=h.length;for(f=0;f<y;f++)h[f]&&(d=h[f].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(f=>"-"+f)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let f,h;for(f=0,h=r.skips.length;f<h;f++)if(r.skips[f].test(d))return!1;for(f=0,h=r.names.length;f<h;f++)if(r.names[f].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return Sx=e,Sx}var vI;function Une(){return vI||(vI=1,function(e,t){var n={};t.formatArgs=o,t.save=a,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,f=0;l[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(d++,h==="%c"&&(f=d))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function a(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof z9<"u"&&"env"in z9&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=Vne()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(jx,jx.exports)),jx.exports}Une(),$ne();const bI=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),Hne=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),xI=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),Wne=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),Cx=(e,t,n)=>{const r=[];return{changes:e.map(o=>{var c;const a=t.find(l=>o.id===l.id);a||r.push(o.id);const i=(c=n==null?void 0:n[o.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===o.source_id),s=bI(o,{...a==null?void 0:a.data,entity:i});return{type:a?"replace":"add",id:o.id,item:a?Vf({...a||{},data:void 0},el(s,tl)):s}}),newIds:[]}},Ox=(e,t)=>{const n=[],r=[],o=e.map(a=>{const i=t.find(s=>a.source===s.source&&a.target===s.target);return!i||i.id!==a.id?(i&&r.push(i.id),{type:"add",item:xI(a)}):(n.push(a.id),{type:"replace",item:xI(a)})});return t.forEach(a=>{n.includes(a.id)||r.push(a.id)}),{changes:o,updatedIds:n,deletedIds:r}},Nx={width:440,height:360},Wf={width:380,height:650},Sl={[oe.Toolbox]:"toolbox",[oe.SessionInfo]:"session-info",[oe.DefaultEmbeddingModel]:"default-embedding-model",[oe.ApplicationBar]:"application-bar"},qne={id:Sl[oe.Toolbox],type:oe.Toolbox,position:{x:10+Wf.width+20,y:10},measured:Nx,data:{}},Yne={id:Sl[oe.SessionInfo],type:oe.SessionInfo,position:{x:10,y:10},measured:Wf,data:{}},Kne={id:Sl[oe.DefaultEmbeddingModel],type:oe.DefaultEmbeddingModel,position:{x:10+Wf.width+Nx.width+40,y:10},data:{model:Awe}},Xne={id:Sl[oe.ApplicationBar],type:oe.ApplicationBar,position:{x:10+Wf.width+Nx.width+40,y:80},data:{}},Qne=[qne,Yne,Kne,Xne],Jne=[oe.Toolbox,oe.SessionInfo,oe.ApplicationBar,oe.EditorApp,oe.CodeContainerApp],wI={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Qne},qf=async e=>{const t=await ce("FlowNode").find(e),n=t.reduce((o,a)=>{var i;return o[a.source_type]||(o[a.source_type]=[]),(i=o[a.source_type])==null||i.push(a),o},{}),r={};return await Promise.all(Object.entries(n).map(async([o,a])=>{const i=o;r[i]=await ce(i).find({where:{id:Vr(a.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},Gne=(e,t)=>({reset:()=>{e(wI)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:Ba(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:wl(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:hT(n,r)})},flowNodesToNodes:(n,r={})=>{const o=t().nodes,{changes:a}=Cx(n,o,r);e({nodes:Ba(a,o)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:o,updatedIds:a,deletedIds:i}=Ox(n,r);r.forEach(s=>{a.includes(s.id)||i.push(s.id)}),i.forEach(s=>{o.push({type:"remove",id:s})}),e({edges:wl(o,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const o of n){const a=r.findIndex(i=>i.timestamp===o);a>-1&&r.splice(a,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const o of n){const a=r.findIndex(i=>i.timestamp===o);a>-1&&r.splice(a,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:o}=t();e({syncNodeQueue:[...o,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:o,flowNodeDatas:a}=await qf(n);if(r!=null&&r.clean)e({flowNodes:o,nodes:o.map(i=>{var c;const s=(c=a==null?void 0:a[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return bI(i,{data:s})})});else{const i=t().flowNodes,s=o.map(u=>u.id),c=t().nodes,{changes:l}=Cx(o,c,a);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...o],nodes:Ba(l,c)})}return o}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const o=await ce("FlowEdge").find(n),a=t().flowEdges,i=o.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:o,edges:o.map(s=>Hne(s))});else{const s=t().edges,{changes:c}=Ox(o,s);e({flowEdges:[...a.filter(l=>!i.includes(l.id)),...o],edges:wl(c,s)})}return o}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await ce("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await ce("FlowNode").delete(r.id);const o=t().flowNodes;r.source_type&&r.source_id&&await ce(r.source_type).delete(r.source_id).catch(i=>{Or("Failed to delete source entity",r.source_type,r.source_id,i)});const a=t().nodes;e({flowNodes:o.filter(i=>i.id!==r.id),nodes:Ba([{type:"remove",id:r.id}],a)})}}catch(r){Or("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await ce("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await ce("FlowEdge").delete(r.id);const o=t().flowEdges;e({flowEdges:o.filter(a=>a.id!==r.id)})}}catch(r){Or("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var o;try{if(!((o=Je.getState().currentSession)!=null&&o.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await ce("FlowNode").update(n.id,n);const a=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?a:[...a]})}catch(a){Or("Failed to create or update flow node",a,n)}},createOrUpdateFlowNode:async(n,r)=>{var o;try{const a=Je.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(h=>h.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await ce("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=Vf(s,el(n,tl)),r!=null&&r.lazy?ce("FlowNode").update(s.id,i):await ce("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(i.id=xa(),ce("FlowNode").save(i)):i=await ce("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(h=>h.id===i.id);i.source_type&&!l?c=await ce(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(o=l==null?void 0:l.data)==null?void 0:o.entity);const u=t().flowNodes,d=t().nodes,{changes:f}=Cx([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(h=>h.id!==i.id),i],nodes:Ba(f,d)}),i}catch(a){Or("Failed to create or update flow node",a,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const o=Je.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let a,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await ce("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)a=Vf(i,el(n,tl)),r!=null&&r.lazy?ce("FlowEdge").update(i.id,a):await ce("FlowEdge").update(i.id,a);else if(n.source&&n.target)a={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(a.id=xa(),ce("FlowEdge").save(a)):a=await ce("FlowEdge").save(a);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==a.id),a],edges:wl(Ox([a],c).changes,c)}),a}catch(o){Or("Failed to create or update flow node",o)}}}),Zne=()=>{var E;const[e,t]=g.useState(),[n,r]=g.useState(),[o,a]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),f=Je(S=>S.currentSession),h=sn(S=>S.loadModel),y=g.useCallback(async S=>{var k;if(!f)return;const O=await ce("JSONData").findOne({where:{id:S.source_id,session_id:f==null?void 0:f.id}});O&&((k=u.current)==null||k.call(u,O.data?O.data:[]),l({node:S,enity:O}))},[f]),m=g.useCallback(async S=>{var C;const O=(S==null?void 0:S.sessionId)||(f==null?void 0:f.id),k=(S==null?void 0:S.threadNode)||(n==null?void 0:n.threadNode),N=(S==null?void 0:S.prompts)||(e==null?void 0:e.prompts);if(!O||!(k!=null&&k.id))return;const P=N==null?void 0:N.map(M=>{if(M.type!=="few_shot_example")switch(M.role){case"ai":case"assistant":case"tool":return{id:M.id,content:M.content,role:"assistant"};case"system":return{id:M.id,content:M.content,role:"system"};default:return{id:M.id,content:M.content,role:"user"}}}).filter(Boolean),R=await ce("JSONData").save({headers:"item",session_id:O,json:"",data:P});if(!R)return;const A=await ce("FlowNode").save({session_id:O,source_id:R.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(A)return await ce("FlowEdge").save({session_id:O,source:k.id,target:A.id}),(C=u.current)==null||C.call(u,P),l({node:A,enity:R}),{jsonData:R,jsonDataNode:A}},[e==null?void 0:e.prompts,f==null?void 0:f.id,n==null?void 0:n.threadNode]),v=g.useCallback(async(S,O)=>{if(!f)return;const k=await ce("FlowEdge").findOne({where:{session_id:f.id,source:S.id},order:{id:"DESC"}});if(k){const N=await ce("FlowNode").findOne({where:{id:k.target,session_id:f.id}});if(!N)return;await y(N)}else if(!await m({sessionId:f.id,threadNode:S,prompts:O||[]}))return},[m,f,y]),b=g.useCallback(async S=>{if(S!=null&&S.length&&(f!=null&&f.id)){const O=(await Promise.all(S.map(async k=>ce("FlowEdge").find({where:{target:k.source.id}}).then(N=>qf({where:{session_id:f.id,id:Vr(N.map(P=>P.source))}}).then(P=>({...P,...k})))))).map(k=>{var C,M,T,D;const N=k.flowNodes.find(I=>I.source_type==="Prompt"),P=k.flowNodes.find(I=>I.source_type==="VectorDatabase");if(!P||!N)return;const R=(M=(C=k.flowNodeDatas)==null?void 0:C.Prompt)==null?void 0:M.find(I=>I.id===N.source_id),A=(D=(T=k.flowNodeDatas)==null?void 0:T.VectorDatabase)==null?void 0:D.find(I=>I.id===P.source_id);return{promptNode:N,vectorDatabaseNode:P,placeholderNode:k.source,placeholderEntity:k.entity,promptEntity:R,vectorDatabaseEntity:A}}).filter(Boolean);s(O)}},[f==null?void 0:f.id]),x=g.useCallback(async()=>{try{if(d.current.handling=f==null?void 0:f.id,!(f!=null&&f.id)||!(f!=null&&f.main_source_id)||(f==null?void 0:f.main_source_type)!=="Thread")return;const[S,O]=await Promise.all([ce("Thread").findOne({where:{id:f.main_source_id,session_id:f.id}}),ce("FlowNode").findOne({where:{id:f.main_node_id}})]);if(!S||!O)return;const k=await ce("FlowEdge").find({where:{session_id:f.id,target:O.id}}),{flowNodes:N,flowNodeDatas:P}=await qf({where:{session_id:f.id,id:Vr(k.map(I=>I.source))}}),R=(await ce("FlowEdge").find({where:{session_id:f.id}})).filter(I=>I.target===O.id).map(I=>{var B;const L=N.find(U=>U.id===I.source);return{connection:I,source:L,entity:(B=P==null?void 0:P[L.source_type])==null?void 0:B.find(U=>U.id===L.source_id)}}),A=R.find(I=>I.source.source_type==="LLM"),C=R.filter(I=>I.source.source_type==="Prompt"),M=R.find(I=>I.source.source_type==="Schema");if(!(A!=null&&A.entity))return;const T=R.filter(I=>I.source.source_type==="FlowNodePlaceholder");await b(T),await v(O,(C==null?void 0:C.map(I=>I.entity))||[]),a({llm:A.entity,status:et.Started,progress:""}),r({thread:S,threadNode:O});const D=M==null?void 0:M.entity;if(D){const I=await ce("SchemaItem").find({where:{schema_id:D.id}});D.schema_items=I||[]}t({prompts:(C==null?void 0:C.map(I=>I.entity))||[],schema:D}),d.current.handled=f.id}finally{d.current.handling=void 0}},[f==null?void 0:f.id,f==null?void 0:f.main_node_id,f==null?void 0:f.main_source_id,f==null?void 0:f.main_source_type,b,v]),_=g.useCallback(async()=>{if(o!=null&&o.llm.name)try{a(S=>S&&{...S,status:et.Loading}),await h(o==null?void 0:o.llm.name,S=>{a(O=>O&&{...O,progress:S.text})}),a(S=>S&&{...S,status:et.Loaded,progress:""})}catch{a(S=>S&&{...S,status:et.Started,progress:""})}},[(E=o==null?void 0:o.llm)==null?void 0:E.name,h]),w=g.useCallback(S=>(u.current=S,()=>{u.current=void 0}),[]),j=g.useCallback(async S=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await ce("JSONData").save({...c.enity,data:S})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(f==null?void 0:f.id)||x()},[f==null?void 0:f.id,x]),{...e,loadLLM:_,threadInfo:n,mainLLMInfo:o,retriverInfo:i,currentDataNode:c,updateMessagesData:j,addNewDataNode:m,selectDataNode:y,onThreadMessagesLoaded:w}};class ere extends Twe{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[o,a]of Object.entries(n))typeof a=="string"?r[o]=a:r[o]=await a();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await Nt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>PI);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await Nt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>PI);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await Nt(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-DSdXkoPe.js").then(async o=>(await o.__tla,o));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4,5,6]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class tre extends Rwe{}class nre extends tre{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Vu(this.value)]}}pS=class extends ere{async formatPromptValue(e){const t=await this.format(e);return new nre(t)}};var rre=Object.prototype.toString,as=Array.isArray||function(e){return rre.call(e)==="[object Array]"};function Mx(e){return typeof e=="function"}function ore(e){return as(e)?"array":typeof e}function kx(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function _I(e,t){return e!=null&&typeof e=="object"&&t in e}function are(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var ire=RegExp.prototype.test;function sre(e,t){return ire.call(e,t)}var cre=/\S/;function lre(e){return!sre(cre,e)}var ure={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function dre(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return ure[t]})}var fre=/\s*/,pre=/\s+/,jI=/\s*=/,hre=/\s*\}/,mre=/#|\^|\/|>|\{|&|=|!/;function yre(e,t){if(!e)return[];var n=!1,r=[],o=[],a=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;a.length;)delete o[a.pop()];else a=[];i=!1,s=!1}var d,f,h;function y(O){if(typeof O=="string"&&(O=O.split(pre,2)),!as(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(kx(O[0])+"\\s*"),f=new RegExp("\\s*"+kx(O[1])),h=new RegExp("\\s*"+kx("}"+O[1]))}y(t||jn.tags);for(var m=new Cl(e),v,b,x,_,w,j;!m.eos();){if(v=m.pos,x=m.scanUntil(d),x)for(var E=0,S=x.length;E<S;++E)_=x.charAt(E),lre(_)?(a.push(o.length),c+=_):(s=!0,n=!0,c+=" "),o.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!m.scan(d))break;if(i=!0,b=m.scan(mre)||"name",m.scan(fre),b==="="?(x=m.scanUntil(jI),m.scan(jI),m.scanUntil(f)):b==="{"?(x=m.scanUntil(h),m.scan(hre),m.scanUntil(f),b="&"):x=m.scanUntil(f),!m.scan(f))throw new Error("Unclosed tag at "+m.pos);if(b==">"?w=[b,x,v,m.pos,c,l,n]:w=[b,x,v,m.pos],l++,o.push(w),b==="#"||b==="^")r.push(w);else if(b==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+x+'" at '+v);if(j[1]!==x)throw new Error('Unclosed section "'+j[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&y(x)}if(u(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+m.pos);return vre(gre(o))}function gre(e){for(var t=[],n,r,o=0,a=e.length;o<a;++o)n=e[o],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function vre(e){for(var t=[],n=t,r=[],o,a,i=0,s=e.length;i<s;++i)switch(o=e[i],o[0]){case"#":case"^":n.push(o),r.push(o),n=o[4]=[];break;case"/":a=r.pop(),a[5]=o[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(o)}return t}function Cl(e){this.string=e,this.tail=e,this.pos=0}Cl.prototype.eos=function(){return this.tail===""},Cl.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Cl.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function is(e,t){this.view=e,this.cache={".":this.view},this.parent=t}is.prototype.push=function(e){return new is(e,this)},is.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,o,a,i,s=!1;r;){if(e.indexOf(".")>0)for(o=r.view,a=e.split("."),i=0;o!=null&&i<a.length;)i===a.length-1&&(s=_I(o,a[i])||are(o,a[i])),o=o[a[i++]];else o=r.view[e],s=_I(r.view,e);if(s){n=o;break}r=r.parent}t[e]=n}return Mx(n)&&(n=n.call(this.view)),n};function pn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}pn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},pn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||jn.tags).join(":"),o=typeof n<"u",a=o?n.get(r):void 0;return a==null&&(a=yre(e,t),o&&n.set(r,a)),a},pn.prototype.render=function(e,t,n,r){var o=this.getConfigTags(r),a=this.parse(e,o),i=t instanceof is?t:new is(t,void 0);return this.renderTokens(a,i,n,e,r)},pn.prototype.renderTokens=function(e,t,n,r,o){for(var a="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,o):s==="^"?c=this.renderInverted(i,t,n,r,o):s===">"?c=this.renderPartial(i,t,n,o):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,o):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(a+=c);return a},pn.prototype.renderSection=function(e,t,n,r,o){var a=this,i="",s=t.lookup(e[1]);function c(d){return a.render(d,t,n,o)}if(s){if(as(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,o);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,o);else if(Mx(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,o);return i}},pn.prototype.renderInverted=function(e,t,n,r,o){var a=t.lookup(e[1]);if(!a||as(a)&&a.length===0)return this.renderTokens(e[4],t,n,r,o)},pn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),o=e.split(`
`),a=0;a<o.length;a++)o[a].length&&(a>0||!n)&&(o[a]=r+o[a]);return o.join(`
`)},pn.prototype.renderPartial=function(e,t,n,r){if(n){var o=this.getConfigTags(r),a=Mx(n)?n(e[1]):n[e[1]];if(a!=null){var i=e[6],s=e[5],c=e[4],l=a;s==0&&c&&(l=this.indentPartial(a,c,i));var u=this.parse(l,o);return this.renderTokens(u,t,n,l,r)}}},pn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},pn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||jn.escape,o=t.lookup(e[1]);if(o!=null)return typeof o=="number"&&r===jn.escape?String(o):r(o)},pn.prototype.rawValue=function(e){return e[1]},pn.prototype.getConfigTags=function(e){return as(e)?e:e&&typeof e=="object"?e.tags:void 0},pn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!as(e))return e.escape};var jn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){Ol.templateCache=e},get templateCache(){return Ol.templateCache}},Ol=new pn;jn.clearCache=function(){return Ol.clearCache()},jn.parse=function(e,t){return Ol.parse(e,t)},jn.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+ore(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Ol.render(e,t,n,r)},jn.escape=dre,jn.Scanner=Cl,jn.Context=is,jn.Writer=pn;function EI(){jn.escape=e=>e}let Px,SI,CI,OI,NI,Yf,MI,kI;Px=e=>{const t=e.split(""),n=[],r=(a,i)=>{for(let s=i;s<t.length;s+=1)if(a.includes(t[s]))return s;return-1};let o=0;for(;o<t.length;)if(t[o]==="{"&&o+1<t.length&&t[o+1]==="{")n.push({type:"literal",text:"{"}),o+=2;else if(t[o]==="}"&&o+1<t.length&&t[o+1]==="}")n.push({type:"literal",text:"}"}),o+=2;else if(t[o]==="{"){const a=r("}",o);if(a<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(o+1,a).join("")}),o=a+1}else{if(t[o]==="}")throw new Error("Single '}' in template.");{const a=r("{}",o),i=(a<0?t.slice(o):t.slice(o,a)).join("");n.push({type:"literal",text:i}),o=a<0?t.length:a}}return n},SI=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),CI=e=>{EI();const t=jn.parse(e);return SI(t)},OI=(e,t)=>Px(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),NI=(e,t)=>(EI(),jn.render(e,t)),Yf={"f-string":OI,mustache:NI},MI={"f-string":Px,mustache:CI},yi=(e,t,n)=>Yf[t](e,n),kI=(e,t)=>MI[t](e),hS=(e,t,n)=>{if(!(t in Yf)){const r=Object.keys(Yf);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((o,a)=>(o[a]="foo",o),{});Array.isArray(e)?e.forEach(o=>{if(o.type==="text")yi(o.text,t,r);else if(o.type==="image_url")if(typeof o.image_url=="string")yi(o.image_url,t,r);else{const a=o.image_url.url;yi(a,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(o,null,2)}`)}):yi(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},Ho=class extends pS{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),hS(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return yi(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,o=""){const a=[o,...e,t].join(r);return new Ho({inputVariables:n,template:a})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},o=new Set;return kI(e,n).forEach(a=>{a.type==="variable"&&o.add(a.name)}),new Ho({inputVariables:[...o],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(o=>!(o in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new Ho(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Ho({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const PI=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Ho},Symbol.toStringTag,{value:"Module"})),bre=()=>{const[e]=g.useState(!1),t=fi(a=>a.similaritySearchWithScore),{stream:n}=Zm(),r=g.useCallback(async(a,i)=>{if(!(i!=null&&i.length))return[];const s=[];return await Promise.all(i.map(async c=>{var u,d,f,h;const l=c.placeholderEntity;if(l)switch(l.placeholder_type){case bi.VECTOR_DATABASE_RETREIVER:{if(!c.promptNode||!c.promptEntity||!c.vectorDatabaseNode||!c.vectorDatabaseEntity)return;const y=(u=l.metadata)!=null&&u.k?+((d=l.metadata)==null?void 0:d.k):1;let m=(f=l.metadata)!=null&&f.minimalScore?+((h=l.metadata)==null?void 0:h.minimalScore):void 0;m&&m>1&&(m=m/100);const v=await t({databaseId:c.vectorDatabaseEntity.id},a,y);if(!v)return[];const b=new Ho({template:c.promptEntity.content,inputVariables:["context"]});s.push(new Uu(await b.format({context:m?v.filter(([,x])=>x>=m).map(([x])=>x.pageContent).join(`
`):v.map(([x])=>x.pageContent).join(`
`)})))}}})),s},[t]),o=g.useCallback(async(a,i,{retriverInfo:s},{schema:c,onMessageUpdate:l,onResponseMessageCreate:u,onInjectedMessages:d})=>{const f=[];s!=null&&s.length&&(f.push(...await r(a,s)),d==null||d(f));const h=i.map(m=>m.role==="system"?new V9(m.content):m.role==="user"?new Vu(m.content):new Uu(m.content));u==null||u();const{content:y}=await n(h,{schemas:c?[c]:void 0,onMessageUpdate:({content:m})=>{l==null||l({nodeData:{loading:!0,content:m}})}});return l==null||l({nodeData:{content:y}}),y},[r,n]);return{loading:e,sendMessage:o}},xre=ba(({onDelete:e})=>{const{t}=Me("dialogs"),[n,r]=g.useState(!1),o=Kt(),{toast:a}=Bt(),i=async()=>{try{r(!0),await e(),o.hide()}catch{a({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return p.jsx(jN,{open:o.visible,onOpenChange:o.hide,children:p.jsxs(ig,{children:[p.jsxs(sg,{children:[p.jsx(lg,{children:t("delete_chat_data_node.title")}),p.jsx(ug,{children:t("delete_chat_data_node.description")})]}),p.jsxs(cg,{children:[p.jsx(fg,{onClick:o.hide,children:t("delete_chat_data_node.cancel")}),p.jsx(dg,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})}),wre=e=>{const t=(n,r=null)=>{let o=`{
`;return n.filter(a=>a.parent_id===r).forEach(a=>{if(a.type==="object"){const i=e.filter(c=>c.parent_id===a.id),s=t(i,a.id);o+=`  ${a.name}${a.required?"":"?"}: ${s}
`}else o+=`  // ${a.description||""}
  ${a.name}${a.required?"":"?"}: ${a.type};
`}),o+="}",o};return t(e)},AI=e=>{const t=(r,o=null)=>{let a="";return r.filter(i=>i.parent_id===o).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);a+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else a+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),a};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n};function Kf(){return p.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[p.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:p.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),p.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:p.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),p.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:p.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const _re=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),jre=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Ere=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),Sre=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),Cre=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Ore="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Nre="/NoLLMChat/assets/smollm-CikBjd4F.png",Mre="/NoLLMChat/assets/stablelm-BquePdQ7.png",kre="/NoLLMChat/assets/nomic-BjJqoFji.webp",Pre="/NoLLMChat/assets/joshua-ByaReJuI.webp",jo=g.memo(({name:e,className:t,...n})=>(e=e.toLowerCase(),e.includes("gemma")?p.jsx(jre,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?p.jsx("img",{className:K("w-5 h-5",t),src:Ore,alt:"qwen",...n}):e!=null&&e.includes("phi")?p.jsx(Ere,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?p.jsx(Sre,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?p.jsx("img",{className:K("w-5 h-5",t),src:Nre,alt:"smollm",...n}):e!=null&&e.includes("mistral")?p.jsx(Cre,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?p.jsx(_re,{className:K("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?p.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Mre,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?p.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:kre,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?p.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Pre,alt:"Xenova",...n}):p.jsx(le,{className:K("w-5 h-5",t),name:"brain"}))),Ax=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC"],Nl=g.memo(e=>{var s;const{name:t,model:n,isCached:r,isFunctionCalling:o}=e,{t:a}=Me("atoms"),i=g.useCallback(c=>c===1?"llm_info.model_types.embedding":c===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]);if(n)return p.jsxs(p.Fragment,{children:[p.jsx(tn,{className:"",children:a(i(n.model_type))}),Ax.some(c=>t&&c.includes(t))?p.jsx(tn,{className:"",variant:"outline",children:a("llm_info.recommended")}):null,r?p.jsx(tn,{className:"",variant:"outline",children:a("llm_info.cached")}):null,o?p.jsx(tn,{className:"",variant:"outline",children:a("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?p.jsx(tn,{className:"",variant:"outline",children:a("llm_info.low_resource_required")}):null,(s=n==null?void 0:n.overrides)!=null&&s.context_window_size?p.jsxs(tn,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?p.jsxs(tn,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),Tt=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:K("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Tt.displayName="Card";const hn=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:K("flex flex-col space-y-1.5 p-6",e),...t}));hn.displayName="CardHeader";const En=g.forwardRef(({className:e,...t},n)=>p.jsx("h3",{ref:n,className:K("text-2xl font-semibold leading-none tracking-tight",e),...t}));En.displayName="CardTitle";const TI=g.forwardRef(({className:e,...t},n)=>p.jsx("p",{ref:n,className:K("text-sm text-muted-foreground",e),...t}));TI.displayName="CardDescription";const mn=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:K("p-6 pt-0",e),...t}));mn.displayName="CardContent";const ra=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:K("flex items-center p-6 pt-0",e),...t}));ra.displayName="CardFooter";const Are=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:o}=Me("flows"),[a,i]=g.useState();g.useEffect(()=>{a||!(e!=null&&e.name)||Nt(()=>import("./index-BG3xyZmB.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([7,1,2,3,4,5,6])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const f=await l(e==null?void 0:e.name);i({hasCache:f,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(h=>h.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,a]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case et.Downloading:return p.jsx(le,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case et.Loaded:return p.jsx(jo,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return p.jsx(jo,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return p.jsx(Tt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:p.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[p.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),p.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[p.jsx(Nl,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(a==null?void 0:a.hasCache)||!1}),t!==et.Loaded?r?p.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):p.jsx(at,{disabled:t===et.Loading,onClick:s,className:"mt-4 w-full",children:o(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),Tre=e=>{const[t,n]=g.useState([]),r=Je(i=>i.currentSession),o=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await ce("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await qf({where:{session_id:r.id,id:Vr(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var f;const d=(f=c[u.source_type])==null?void 0:f.find(h=>h.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),a=g.useCallback(async i=>{await ce("FlowNode").delete(i.id),await ce("JSONData").delete(i.source_id);const s=await ce("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>ce("FlowEdge").delete(c.id))),o()},[o]);return g.useEffect(()=>{e&&o()},[o,e]),{chatList:t,deleteChat:a,getChatList:o}};class Rre{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class RI extends Rre{constructor(t,{splitPages:n=!0,pdfjs:r=Ire,parsedItemSeparator:o=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=o}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,o=await r.getMetadata().catch(()=>null),a=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);a.push(new Hu({pageContent:u,metadata:{pdf:{version:n,info:o==null?void 0:o.info,metadata:o==null?void 0:o.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?a:a.length===0?[]:[new Hu({pageContent:a.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:o==null?void 0:o.info,metadata:o==null?void 0:o.metadata,totalPages:r.numPages}}})]}}async function Ire(){try{const{default:e}=await Nt(async()=>{const{default:r}=await import("./pdf-LFgu0vye.js").then(async o=>(await o.__tla,o)).then(o=>o.p);return{default:r}},__vite__mapDeps([8,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var Tx="Tabs",[Dre,l1e]=Vn(Tx,[Zr]),II=Zr(),[Lre,Rx]=Dre(Tx),DI=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:a,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=Uo(s),[d,f]=en({prop:r,onChange:o,defaultProp:a});return p.jsx(Lre,{scope:n,baseId:mt(),value:d,onValueChange:f,orientation:i,dir:u,activationMode:c,children:p.jsx(Oe.div,{dir:u,"data-orientation":i,...l,ref:t})})});DI.displayName=Tx;var LI="TabsList",FI=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...o}=e,a=Rx(LI,n),i=II(n);return p.jsx(ac,{asChild:!0,...i,orientation:a.orientation,dir:a.dir,loop:r,children:p.jsx(Oe.div,{role:"tablist","aria-orientation":a.orientation,...o,ref:t})})});FI.displayName=LI;var BI="TabsTrigger",$I=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...a}=e,i=Rx(BI,n),s=II(n),c=UI(i.baseId,r),l=HI(i.baseId,r),u=r===i.value;return p.jsx(ic,{asChild:!0,...s,focusable:!o,active:u,children:p.jsx(Oe.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:c,...a,ref:t,onMouseDown:he(e.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:he(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:he(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!o&&d&&i.onValueChange(r)})})})});$I.displayName=BI;var zI="TabsContent",VI=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:o,children:a,...i}=e,s=Rx(zI,n),c=UI(s.baseId,r),l=HI(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),p.jsx(Mn,{present:o||u,children:({present:f})=>p.jsx(Oe.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&a})})});VI.displayName=zI;function UI(e,t){return`${e}-trigger-${t}`}function HI(e,t){return`${e}-content-${t}`}var Fre=DI,WI=FI,qI=$I,YI=VI;const Ix=Fre,Xf=g.forwardRef(({className:e,...t},n)=>p.jsx(WI,{ref:n,className:K("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Xf.displayName=WI.displayName;const gr=g.forwardRef(({className:e,...t},n)=>p.jsx(qI,{ref:n,className:K("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));gr.displayName=qI.displayName;const vr=g.forwardRef(({className:e,...t},n)=>p.jsx(YI,{ref:n,className:K("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));vr.displayName=YI.displayName,$m=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function KI(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Bre=[" ","Enter","ArrowUp","ArrowDown"],$re=[" ","Enter"],Ml="Select",[Qf,Jf,zre]=zu(Ml),[ss,u1e]=Vn(Ml,[zre,Jo]),Gf=Jo(),[Vre,oa]=ss(Ml),[Ure,Hre]=ss(Ml),XI=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:o,onOpenChange:a,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:f,required:h,form:y}=e,m=Gf(t),[v,b]=g.useState(null),[x,_]=g.useState(null),[w,j]=g.useState(!1),E=Uo(l),[S=!1,O]=en({prop:r,defaultProp:o,onChange:a}),[k,N]=en({prop:i,defaultProp:s,onChange:c}),P=g.useRef(null),R=v?y||!!v.closest("form"):!0,[A,C]=g.useState(new Set),M=Array.from(A).map(T=>T.props.value).join(";");return p.jsx(Mc,{...m,children:p.jsxs(Vre,{required:h,scope:t,trigger:v,onTriggerChange:b,valueNode:x,onValueNodeChange:_,valueNodeHasChildren:w,onValueNodeHasChildrenChange:j,contentId:mt(),value:k,onValueChange:N,open:S,onOpenChange:O,dir:E,triggerPointerDownPosRef:P,disabled:f,children:[p.jsx(Qf.Provider,{scope:t,children:p.jsx(Ure,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(T=>{C(D=>new Set(D).add(T))},[]),onNativeOptionRemove:g.useCallback(T=>{C(D=>{const I=new Set(D);return I.delete(T),I})},[]),children:n})}),R?p.jsxs(xD,{"aria-hidden":!0,required:h,tabIndex:-1,name:u,autoComplete:d,value:k,onChange:T=>N(T.target.value),disabled:f,form:y,children:[k===void 0?p.jsx("option",{value:""}):null,Array.from(A)]},M):null]})})};XI.displayName=Ml;var QI="SelectTrigger",JI=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...o}=e,a=Gf(n),i=oa(QI,n),s=i.disabled||r,c=rt(t,i.onTriggerChange),l=Jf(n),u=g.useRef("touch"),[d,f,h]=wD(m=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),x=_D(v,m,b);x!==void 0&&i.onValueChange(x.value)}),y=m=>{s||(i.onOpenChange(!0),h()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return p.jsx(kc,{asChild:!0,...a,children:p.jsx(Oe.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":bD(i.value)?"":void 0,...o,ref:c,onClick:he(o.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:he(o.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:he(o.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&f(m.key),!(v&&m.key===" ")&&Bre.includes(m.key)&&(y(),m.preventDefault())})})})});JI.displayName=QI;var GI="SelectValue",ZI=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,children:a,placeholder:i="",...s}=e,c=oa(GI,n),{onValueNodeHasChildrenChange:l}=c,u=a!==void 0,d=rt(t,c.onValueNodeChange);return xn(()=>{l(u)},[l,u]),p.jsx(Oe.span,{...s,ref:d,style:{pointerEvents:"none"},children:bD(c.value)?p.jsx(p.Fragment,{children:i}):a})});ZI.displayName=GI;var Wre="SelectIcon",eD=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...o}=e;return p.jsx(Oe.span,{"aria-hidden":!0,...o,ref:t,children:r||"\u25BC"})});eD.displayName=Wre;var qre="SelectPortal",tD=e=>p.jsx(Fu,{asChild:!0,...e});tD.displayName=qre;var Va="SelectContent",nD=g.forwardRef((e,t)=>{const n=oa(Va,e.__scopeSelect),[r,o]=g.useState();if(xn(()=>{o(new DocumentFragment)},[]),!n.open){const a=r;return a?Du.createPortal(p.jsx(rD,{scope:e.__scopeSelect,children:p.jsx(Qf.Slot,{scope:e.__scopeSelect,children:p.jsx("div",{children:e.children})})}),a):null}return p.jsx(oD,{...e,ref:t})});nD.displayName=Va;var br=10,[rD,aa]=ss(Va),Yre="SelectContentImpl",oD=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:a,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:y,hideWhenDetached:m,avoidCollisions:v,...b}=e,x=oa(Va,n),[_,w]=g.useState(null),[j,E]=g.useState(null),S=rt(t,Z=>w(Z)),[O,k]=g.useState(null),[N,P]=g.useState(null),R=Jf(n),[A,C]=g.useState(!1),M=g.useRef(!1);g.useEffect(()=>{if(_)return bd(_)},[_]),dd();const T=g.useCallback(Z=>{const[Y,...W]=R().map($=>$.ref.current),[G]=W.slice(-1),te=document.activeElement;for(const $ of Z)if($===te||($==null||$.scrollIntoView({block:"nearest"}),$===Y&&j&&(j.scrollTop=0),$===G&&j&&(j.scrollTop=j.scrollHeight),$==null||$.focus(),document.activeElement!==te))return},[R,j]),D=g.useCallback(()=>T([O,_]),[T,O,_]);g.useEffect(()=>{A&&D()},[A,D]);const{onOpenChange:I,triggerPointerDownPosRef:L}=x;g.useEffect(()=>{if(_){let Z={x:0,y:0};const Y=G=>{var te,$;Z={x:Math.abs(Math.round(G.pageX)-(((te=L.current)==null?void 0:te.x)??0)),y:Math.abs(Math.round(G.pageY)-((($=L.current)==null?void 0:$.y)??0))}},W=G=>{Z.x<=10&&Z.y<=10?G.preventDefault():_.contains(G.target)||I(!1),document.removeEventListener("pointermove",Y),L.current=null};return L.current!==null&&(document.addEventListener("pointermove",Y),document.addEventListener("pointerup",W,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",W,{capture:!0})}}},[_,I,L]),g.useEffect(()=>{const Z=()=>I(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[I]);const[B,U]=wD(Z=>{const Y=R().filter(te=>!te.disabled),W=Y.find(te=>te.ref.current===document.activeElement),G=_D(Y,Z,W);G&&setTimeout(()=>G.ref.current.focus())}),F=g.useCallback((Z,Y,W)=>{const G=!M.current&&!W;(x.value!==void 0&&x.value===Y||G)&&(k(Z),G&&(M.current=!0))},[x.value]),H=g.useCallback(()=>_==null?void 0:_.focus(),[_]),J=g.useCallback((Z,Y,W)=>{const G=!M.current&&!W;(x.value!==void 0&&x.value===Y||G)&&P(Z)},[x.value]),q=r==="popper"?Dx:aD,re=q===Dx?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return p.jsx(rD,{scope:n,content:_,viewport:j,onViewportChange:E,itemRefCallback:F,selectedItem:O,onItemLeave:H,itemTextRefCallback:J,focusSelectedItem:D,selectedItemText:N,position:r,isPositioned:A,searchRef:B,children:p.jsx(Sc,{as:Gr,allowPinchZoom:!0,children:p.jsx(Ec,{asChild:!0,trapped:x.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:he(o,Z=>{var Y;(Y=x.trigger)==null||Y.focus({preventScroll:!0}),Z.preventDefault()}),children:p.jsx(Lu,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:p.jsx(q,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:Z=>Z.preventDefault(),...b,...re,onPlaced:()=>C(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:he(b.onKeyDown,Z=>{const Y=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!Y&&Z.key.length===1&&U(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let W=R().filter(G=>!G.disabled).map(G=>G.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(W=W.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const G=Z.target,te=W.indexOf(G);W=W.slice(te+1)}setTimeout(()=>T(W)),Z.preventDefault()}})})})})})})});oD.displayName=Yre;var Kre="SelectItemAlignedPosition",aD=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...o}=e,a=oa(Va,n),i=aa(Va,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=rt(t,S=>u(S)),f=Jf(n),h=g.useRef(!1),y=g.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:b,focusSelectedItem:x}=i,_=g.useCallback(()=>{if(a.trigger&&a.valueNode&&s&&l&&m&&v&&b){const S=a.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),k=a.valueNode.getBoundingClientRect(),N=b.getBoundingClientRect();if(a.dir!=="rtl"){const G=N.left-O.left,te=k.left-G,$=S.left-te,se=S.width+$,ue=Math.max(se,O.width),ve=window.innerWidth-br,Te=$m(te,[br,Math.max(br,ve-ue)]);s.style.minWidth=se+"px",s.style.left=Te+"px"}else{const G=O.right-N.right,te=window.innerWidth-k.right-G,$=window.innerWidth-S.right-te,se=S.width+$,ue=Math.max(se,O.width),ve=window.innerWidth-br,Te=$m(te,[br,Math.max(br,ve-ue)]);s.style.minWidth=se+"px",s.style.right=Te+"px"}const P=f(),R=window.innerHeight-br*2,A=m.scrollHeight,C=window.getComputedStyle(l),M=parseInt(C.borderTopWidth,10),T=parseInt(C.paddingTop,10),D=parseInt(C.borderBottomWidth,10),I=parseInt(C.paddingBottom,10),L=M+T+A+I+D,B=Math.min(v.offsetHeight*5,L),U=window.getComputedStyle(m),F=parseInt(U.paddingTop,10),H=parseInt(U.paddingBottom,10),J=S.top+S.height/2-br,q=R-J,re=v.offsetHeight/2,Z=v.offsetTop+re,Y=M+T+Z,W=L-Y;if(Y<=J){const G=P.length>0&&v===P[P.length-1].ref.current;s.style.bottom="0px";const te=l.clientHeight-m.offsetTop-m.offsetHeight,$=Math.max(q,re+(G?H:0)+te+D),se=Y+$;s.style.height=se+"px"}else{const G=P.length>0&&v===P[0].ref.current;s.style.top="0px";const te=Math.max(J,M+m.offsetTop+(G?F:0)+re)+W;s.style.height=te+"px",m.scrollTop=Y-J+m.offsetTop}s.style.margin=`${br}px 0`,s.style.minHeight=B+"px",s.style.maxHeight=R+"px",r==null||r(),requestAnimationFrame(()=>h.current=!0)}},[f,a.trigger,a.valueNode,s,l,m,v,b,a.dir,r]);xn(()=>_(),[_]);const[w,j]=g.useState();xn(()=>{l&&j(window.getComputedStyle(l).zIndex)},[l]);const E=g.useCallback(S=>{S&&y.current===!0&&(_(),x==null||x(),y.current=!1)},[_,x]);return p.jsx(Qre,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:h,onScrollButtonChange:E,children:p.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:p.jsx(Oe.div,{...o,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});aD.displayName=Kre;var Xre="SelectPopperPosition",Dx=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:o=br,...a}=e,i=Gf(n);return p.jsx(Md,{...i,...a,ref:t,align:r,collisionPadding:o,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Dx.displayName=Xre;var[Qre,Lx]=ss(Va,{}),Fx="SelectViewport",iD=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...o}=e,a=aa(Fx,n),i=Lx(Fx,n),s=rt(t,a.onViewportChange),c=g.useRef(0);return p.jsxs(p.Fragment,{children:[p.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),p.jsx(Qf.Slot,{scope:n,children:p.jsx(Oe.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:he(o.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&d){const h=Math.abs(c.current-u.scrollTop);if(h>0){const y=window.innerHeight-br*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(m,v);if(b<y){const x=b+h,_=Math.min(y,x),w=x-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});iD.displayName=Fx;var sD="SelectGroup",[Jre,Gre]=ss(sD),Zre=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=mt();return p.jsx(Jre,{scope:n,id:o,children:p.jsx(Oe.div,{role:"group","aria-labelledby":o,...r,ref:t})})});Zre.displayName=sD;var cD="SelectLabel",lD=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Gre(cD,n);return p.jsx(Oe.div,{id:o.id,...r,ref:t})});lD.displayName=cD;var Zf="SelectItem",[eoe,uD]=ss(Zf),dD=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:o=!1,textValue:a,...i}=e,s=oa(Zf,n),c=aa(Zf,n),l=s.value===r,[u,d]=g.useState(a??""),[f,h]=g.useState(!1),y=rt(t,x=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,x,r,o)}),m=mt(),v=g.useRef("touch"),b=()=>{o||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return p.jsx(eoe,{scope:n,value:r,disabled:o,textId:m,isSelected:l,onItemTextChange:g.useCallback(x=>{d(_=>_||((x==null?void 0:x.textContent)??"").trim())},[]),children:p.jsx(Qf.ItemSlot,{scope:n,value:r,disabled:o,textValue:u,children:p.jsx(Oe.div,{role:"option","aria-labelledby":m,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...i,ref:y,onFocus:he(i.onFocus,()=>h(!0)),onBlur:he(i.onBlur,()=>h(!1)),onClick:he(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:he(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:he(i.onPointerDown,x=>{v.current=x.pointerType}),onPointerMove:he(i.onPointerMove,x=>{var _;v.current=x.pointerType,o?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:he(i.onPointerLeave,x=>{var _;x.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:he(i.onKeyDown,x=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&x.key===" "||($re.includes(x.key)&&b(),x.key===" "&&x.preventDefault())})})})})});dD.displayName=Zf;var kl="SelectItemText",fD=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,...a}=e,i=oa(kl,n),s=aa(kl,n),c=uD(kl,n),l=Hre(kl,n),[u,d]=g.useState(null),f=rt(t,b=>d(b),c.onItemTextChange,b=>{var x;return(x=s.itemTextRefCallback)==null?void 0:x.call(s,b,c.value,c.disabled)}),h=u==null?void 0:u.textContent,y=g.useMemo(()=>p.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=l;return xn(()=>(m(y),()=>v(y)),[m,v,y]),p.jsxs(p.Fragment,{children:[p.jsx(Oe.span,{id:c.textId,...a,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Du.createPortal(a.children,i.valueNode):null]})});fD.displayName=kl;var pD="SelectItemIndicator",hD=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return uD(pD,n).isSelected?p.jsx(Oe.span,{"aria-hidden":!0,...r,ref:t}):null});hD.displayName=pD;var Bx="SelectScrollUpButton",mD=g.forwardRef((e,t)=>{const n=aa(Bx,e.__scopeSelect),r=Lx(Bx,e.__scopeSelect),[o,a]=g.useState(!1),i=rt(t,r.onScrollButtonChange);return xn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;a(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),o?p.jsx(gD,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});mD.displayName=Bx;var $x="SelectScrollDownButton",yD=g.forwardRef((e,t)=>{const n=aa($x,e.__scopeSelect),r=Lx($x,e.__scopeSelect),[o,a]=g.useState(!1),i=rt(t,r.onScrollButtonChange);return xn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;a(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),o?p.jsx(gD,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});yD.displayName=$x;var gD=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...o}=e,a=aa("SelectScrollButton",n),i=g.useRef(null),s=Jf(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),xn(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),p.jsx(Oe.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:he(o.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:he(o.onPointerMove,()=>{var l;(l=a.onItemLeave)==null||l.call(a),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:he(o.onPointerLeave,()=>{c()})})}),toe="SelectSeparator",vD=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return p.jsx(Oe.div,{"aria-hidden":!0,...r,ref:t})});vD.displayName=toe;var zx="SelectArrow",noe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Gf(n),a=oa(zx,n),i=aa(zx,n);return a.open&&i.position==="popper"?p.jsx(kd,{...o,...r,ref:t}):null});noe.displayName=zx;function bD(e){return e===""||e===void 0}var xD=g.forwardRef((e,t)=>{const{value:n,...r}=e,o=g.useRef(null),a=rt(t,o),i=KI(n);return g.useEffect(()=>{const s=o.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),p.jsx(Iwe,{asChild:!0,children:p.jsx("select",{...r,ref:a,defaultValue:n})})});xD.displayName="BubbleSelect";function wD(e){const t=Vo(e),n=g.useRef(""),r=g.useRef(0),o=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),a=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,o,a]}function _D(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let a=roe(e,Math.max(o,0));r.length===1&&(a=a.filter(s=>s!==n));const i=a.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function roe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ooe=XI,jD=JI,aoe=ZI,ioe=eD,soe=tD,ED=nD,coe=iD,SD=lD,CD=dD,loe=fD,uoe=hD,OD=mD,ND=yD,MD=vD;const Eo=ooe,So=aoe,Ur=g.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(jD,{ref:r,className:K("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,p.jsx(ioe,{asChild:!0,children:p.jsx(le,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ur.displayName=jD.displayName;const kD=g.forwardRef(({className:e,...t},n)=>p.jsx(OD,{ref:n,className:K("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(le,{name:"chevron-up",className:"h-4 w-4"})}));kD.displayName=OD.displayName;const PD=g.forwardRef(({className:e,...t},n)=>p.jsx(ND,{ref:n,className:K("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(le,{name:"chevron-down",className:"h-4 w-4"})}));PD.displayName=ND.displayName;const Hr=g.forwardRef(({className:e,children:t,position:n="popper",...r},o)=>p.jsx(soe,{children:p.jsxs(ED,{ref:o,className:K("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[p.jsx(kD,{}),p.jsx(coe,{className:K("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),p.jsx(PD,{})]})}));Hr.displayName=ED.displayName;const doe=g.forwardRef(({className:e,...t},n)=>p.jsx(SD,{ref:n,className:K("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));doe.displayName=SD.displayName;const Sn=g.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(CD,{ref:r,className:K("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(uoe,{children:p.jsx(le,{name:"check",className:"h-4 w-4"})})}),p.jsx(loe,{children:t})]}));Sn.displayName=CD.displayName;const foe=g.forwardRef(({className:e,...t},n)=>p.jsx(MD,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));foe.displayName=MD.displayName;var Co="Accordion",poe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Vx,hoe,moe]=zu(Co),[ep,d1e]=Vn(Co,[moe,_C]),Ux=_C(),AD=V.forwardRef((e,t)=>{const{type:n,...r}=e,o=r,a=r;return p.jsx(Vx.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?p.jsx(boe,{...a,ref:t}):p.jsx(voe,{...o,ref:t})})});AD.displayName=Co;var[TD,yoe]=ep(Co),[RD,goe]=ep(Co,{collapsible:!1}),voe=V.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:o=()=>{},collapsible:a=!1,...i}=e,[s,c]=en({prop:n,defaultProp:r,onChange:o});return p.jsx(TD,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:V.useCallback(()=>a&&c(""),[a,c]),children:p.jsx(RD,{scope:e.__scopeAccordion,collapsible:a,children:p.jsx(ID,{...i,ref:t})})})}),boe=V.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:o=()=>{},...a}=e,[i=[],s]=en({prop:n,defaultProp:r,onChange:o}),c=V.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=V.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return p.jsx(TD,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:p.jsx(RD,{scope:e.__scopeAccordion,collapsible:!0,children:p.jsx(ID,{...a,ref:t})})})}),[xoe,tp]=ep(Co),ID=V.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:o,orientation:a="vertical",...i}=e,s=V.useRef(null),c=rt(s,t),l=hoe(n),u=Uo(o)==="ltr",d=he(e.onKeyDown,f=>{var S;if(!poe.includes(f.key))return;const h=f.target,y=l().filter(O=>{var k;return!((k=O.ref.current)!=null&&k.disabled)}),m=y.findIndex(O=>O.ref.current===h),v=y.length;if(m===-1)return;f.preventDefault();let b=m;const x=0,_=v-1,w=()=>{b=m+1,b>_&&(b=x)},j=()=>{b=m-1,b<x&&(b=_)};switch(f.key){case"Home":b=x;break;case"End":b=_;break;case"ArrowRight":a==="horizontal"&&(u?w():j());break;case"ArrowDown":a==="vertical"&&w();break;case"ArrowLeft":a==="horizontal"&&(u?j():w());break;case"ArrowUp":a==="vertical"&&j();break}const E=b%v;(S=y[E].ref.current)==null||S.focus()});return p.jsx(xoe,{scope:n,disabled:r,direction:o,orientation:a,children:p.jsx(Vx.Slot,{scope:n,children:p.jsx(Oe.div,{...i,"data-orientation":a,ref:c,onKeyDown:r?void 0:d})})})}),np="AccordionItem",[woe,Hx]=ep(np),DD=V.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...o}=e,a=tp(np,n),i=yoe(np,n),s=Ux(n),c=mt(),l=r&&i.value.includes(r)||!1,u=a.disabled||e.disabled;return p.jsx(woe,{scope:n,open:l,disabled:u,triggerId:c,children:p.jsx(SC,{"data-orientation":a.orientation,"data-state":VD(l),...s,...o,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});DD.displayName=np;var LD="AccordionHeader",FD=V.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,o=tp(Co,n),a=Hx(LD,n);return p.jsx(Oe.h3,{"data-orientation":o.orientation,"data-state":VD(a.open),"data-disabled":a.disabled?"":void 0,...r,ref:t})});FD.displayName=LD;var Wx="AccordionTrigger",BD=V.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,o=tp(Co,n),a=Hx(Wx,n),i=goe(Wx,n),s=Ux(n);return p.jsx(Vx.ItemSlot,{scope:n,children:p.jsx(bV,{"aria-disabled":a.open&&!i.collapsible||void 0,"data-orientation":o.orientation,id:a.triggerId,...s,...r,ref:t})})});BD.displayName=Wx;var $D="AccordionContent",zD=V.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,o=tp(Co,n),a=Hx($D,n),i=Ux(n);return p.jsx(xV,{role:"region","aria-labelledby":a.triggerId,"data-orientation":o.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});zD.displayName=$D;function VD(e){return e?"open":"closed"}let UD;lS=AD,uS=DD,UD=FD,zm=BD,Vm=zD;const HD=lS,qx=g.forwardRef(({className:e,...t},n)=>p.jsx(uS,{ref:n,className:K("border-b",e),...t}));qx.displayName="AccordionItem";const Yx=g.forwardRef(({className:e,children:t,...n},r)=>p.jsx(UD,{className:"flex",children:p.jsxs(zm,{ref:r,className:K("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,p.jsx(le,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Yx.displayName=zm.displayName;const Kx=g.forwardRef(({className:e,children:t,...n},r)=>p.jsx(Vm,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:p.jsx("div",{className:K("pb-4 pt-0",e),children:t})}));Kx.displayName=Vm.displayName;const _oe=[1,2,3,4,5,6,7,8,9,10],WD=g.memo(e=>{const{t}=Me("flows"),[n,r]=g.useState(""),[o,a]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,f=async()=>{a(await l(n,+i)),r("")},h=async y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),f())};return p.jsxs("div",{className:"mt-4 max-w-full",children:[p.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:p.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[p.jsxs(Eo,{value:`${i}`,onValueChange:y=>s(y),children:[p.jsx(Ur,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:p.jsx(So,{placeholder:t("vector_database_node.k_select_placeholder")})}),p.jsx(Hr,{children:_oe.map(y=>p.jsx(Sn,{value:`${y}`,children:y},`${y}`))})]}),p.jsx(ho,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:K("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:h,onChange:y=>{r(y.target.value)}}),p.jsx("button",{type:"button",disabled:c,onClick:f,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:p.jsx(le,{name:c?"loader-circle":"arrow-right",className:K("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),p.jsx(HD,{type:"single",collapsible:!0,children:o==null?void 0:o.map(([y,m],v)=>p.jsxs(qx,{value:`${v}`,children:[p.jsxs(Yx,{children:[`[${m.toFixed(2)}] ${y.pageContent}`.substring(0,32),"..."]}),p.jsx(Kx,{children:y.pageContent})]},`${v}`))}),p.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?p.jsx(at,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,o!=null&&o.length&&u?p.jsx(at,{disabled:c,onClick:()=>u(o),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),qD=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Me("flows"),[r,o]=g.useState(""),[a,i]=g.useState(""),s=async()=>{a&&(await t({id:r,content:a}),o(""),i(""))};return p.jsxs("div",{className:"min-w-80",children:[p.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[p.jsx(Qe,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),p.jsx(dn,{value:r,disabled:e,onChange:c=>o(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),p.jsxs(Qe,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",p.jsx("span",{className:"text-red-600",children:"*"})]}),p.jsx(ho,{value:a,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),p.jsx("div",{className:"flex justify-between mt-6",children:p.jsx(wn,{loading:e,disabled:!(a!=null&&a.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),Xx=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:o=1.5,colorFrom:a="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>p.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":o,"--color-from":a,"--color-to":i,"--delay":`-${s}s`},className:K("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function joe({accept:e,maxSize:t}){const{t:n}=Me("atoms"),[r,o]=g.useState(""),[a,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=f=>{var y;const h=(y=f.target.files)==null?void 0:y[0];d(h)},d=f=>{if(i(""),f){if(t&&f.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(f.size/1024/1024).toFixed(2)}));return}const h=e==null?void 0:e.split(",").map(y=>y.replace(".","").trim());if(e&&!f.type.match(e.replace("/*",""))&&!(h!=null&&h.some(y=>f.type.includes(y)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(f.size),o(f.name),f}};return{fileName:r,error:a,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{o(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Eoe({file:e,setFile:t,loading:n,progress:r,fileOptions:o}){const{toast:a}=Bt(),{t:i}=Me("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:f,validateAndSetFile:h,fileSize:y}=joe({accept:(o==null?void 0:o.accept)||"image/*",maxSize:(o==null?void 0:o.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{f&&a({title:f,variant:"destructive"})},[f,a]);function m(w){const j=h(w);j&&t(j)}function v(w){w.preventDefault(),c(!1);const j=w.dataTransfer.files[0];j&&m(j)}function b(w){var E;const j=(E=w.target.files)==null?void 0:E[0];j&&m(j)}function x(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return p.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:p.jsx(le,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const w=e.type.startsWith("image/");return p.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:w?p.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):p.jsx(le,{className:"w-14 h-14",name:"file-text"})})},[e]);return p.jsx(p.Fragment,{children:p.jsxs("div",{className:K("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:w=>{w.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var w;return(w=u.current)==null?void 0:w.click()},onKeyDown:w=>{var j;(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),(j=u.current)==null||j.click())},"aria-label":"Upload file",children:[p.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(o==null?void 0:o.accept)||"image/*",onChange:b,className:"hidden"}),p.jsx("div",{className:"p-8 space-y-4",children:l?p.jsxs("div",{className:"flex items-center gap-4",children:[_,p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",p.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:y?`(${(y/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?p.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),p.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:p.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),p.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:w=>{w.stopPropagation(),x()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:p.jsx(le,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?p.jsx(Xx,{className:"rounded-lg"}):void 0]}):p.jsxs("div",{className:"flex flex-col items-center gap-2",children:[p.jsx(le,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),p.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function YD({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:o}=Me("flows"),[a,i]=g.useState(),s=async()=>{a&&(await e(a),i(void 0))};return p.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[p.jsx("div",{className:"mb-6",children:p.jsx(Eoe,{progress:n,loading:r,fileOptions:t,setFile:i,file:a})}),p.jsx(wn,{loading:r,disabled:!a,onClick:s,className:"w-full mt-4",children:o("vector_database_node.add_file.index")})]})}const rp=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{className:"relative w-full overflow-auto",children:p.jsx("table",{ref:n,className:K("w-full caption-bottom text-sm",e),...t})}));rp.displayName="Table";const op=g.forwardRef(({className:e,...t},n)=>p.jsx("thead",{ref:n,className:K("[&_tr]:border-b",e),...t}));op.displayName="TableHeader";const ap=g.forwardRef(({className:e,...t},n)=>p.jsx("tbody",{ref:n,className:K("[&_tr:last-child]:border-0",e),...t}));ap.displayName="TableBody";const Soe=g.forwardRef(({className:e,...t},n)=>p.jsx("tfoot",{ref:n,className:K("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Soe.displayName="TableFooter";const Ua=g.forwardRef(({className:e,...t},n)=>p.jsx("tr",{ref:n,className:K("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Ua.displayName="TableRow";const cs=g.forwardRef(({className:e,...t},n)=>p.jsx("th",{ref:n,className:K("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));cs.displayName="TableHead";const ls=g.forwardRef(({className:e,...t},n)=>p.jsx("td",{ref:n,className:K("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));ls.displayName="TableCell";const Coe=g.forwardRef(({className:e,...t},n)=>p.jsx("caption",{ref:n,className:K("mt-4 text-sm text-muted-foreground",e),...t}));Coe.displayName="TableCaption";const KD=({className:e,...t})=>p.jsx("nav",{role:"navigation","aria-label":"pagination",className:K("mx-auto flex w-full justify-center",e),...t});KD.displayName="Pagination";const XD=g.forwardRef(({className:e,...t},n)=>p.jsx("ul",{ref:n,className:K("flex flex-row items-center gap-1",e),...t}));XD.displayName="PaginationContent";const us=g.forwardRef(({className:e,...t},n)=>p.jsx("li",{ref:n,className:K("",e),...t}));us.displayName="PaginationItem";const ip=({className:e,isActive:t,size:n="icon",...r})=>p.jsx("a",{"aria-current":t?"page":void 0,className:K(_c({variant:t?"outline":"ghost",size:n}),e),...r});ip.displayName="PaginationLink";const QD=({className:e,...t})=>{const{t:n}=Me("atoms");return p.jsxs(ip,{"aria-label":"Go to previous page",size:"default",className:K("gap-1 pl-2.5",e),...t,children:[p.jsx(le,{name:"chevron-left",className:"h-4 w-4"}),p.jsx("span",{children:n("pagination.previous")})]})};QD.displayName="PaginationPrevious";const JD=({className:e,...t})=>{const{t:n}=Me("atoms");return p.jsxs(ip,{"aria-label":"Go to next page",size:"default",className:K("gap-1 pr-2.5",e),...t,children:[p.jsx("span",{children:n("pagination.next")}),p.jsx(le,{name:"chevron-right",className:"h-4 w-4"})]})};JD.displayName="PaginationNext";const Qx=({className:e,...t})=>{const{t:n}=Me("atoms");return p.jsxs("span",{"aria-hidden":!0,className:K("flex h-9 w-9 items-center justify-center",e),...t,children:[p.jsx(le,{name:"ellipsis",className:"h-4 w-4"}),p.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};Qx.displayName="PaginationEllipsis";const GD=ba(({title:e,content:t})=>{const n=Kt();return p.jsx(Ri,{open:n.visible,onOpenChange:n.hide,children:p.jsxs(Ma,{className:"sm:max-w-2xl",children:[p.jsx(ka,{children:p.jsxs("div",{className:"flex",children:[p.jsx(le,{name:"file",className:"mr-2 h-4 w-4"}),p.jsx(Pa,{children:e})]})}),p.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:p.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:p.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),sp=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:o=7,paginationShowLimit:a=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=Kt(GD);g.useEffect(()=>{c(h=>({...h,maxPage:Math.ceil(t.length/o)}))},[t.length,o]);const u=g.useMemo(()=>t.slice((s.page-1)*o,s.page*o),[t,s.page,o]),d=g.useMemo(()=>{let h=!1,y=!1;return p.jsx(KD,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:p.jsxs(XD,{children:[s.page>1?p.jsx(us,{onClick:()=>c(m=>({...m,page:m.page-1})),children:p.jsx(QD,{})}):null,Array.from({length:s.maxPage},(m,v)=>{const b=v+1,x=v===0||v===s.maxPage-1;return!x&&b>s.page+a&&y?null:!x&&b>s.page+a?(y=!0,p.jsx(us,{children:p.jsx(Qx,{})},v)):!x&&b<s.page-a&&h?null:!x&&b<s.page-a?(h=!0,p.jsx(us,{children:p.jsx(Qx,{})},v)):p.jsx(us,{onClick:()=>c(_=>({..._,page:b})),children:p.jsx(ip,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?p.jsx(us,{onClick:()=>c(m=>({...m,page:m.page+1})),children:p.jsx(JD,{})}):null]})})},[s.maxPage,s.page,a]),f=(h,y)=>{if(!h)return;const m=Array.isArray(h)?h:n.map(v=>h[v]);return p.jsxs(Ua,{children:[p.jsx(ls,{children:p.jsx("div",{className:"font-bold",children:y+1})}),m.map((v,b)=>{const x=typeof v=="string"?v:JSON.stringify(v),_=n[b],w=(r==null?void 0:r[_])||i,j=x.length>w;return p.jsx(ls,{className:"p-4",children:p.jsxs("div",{onClick:j?()=>l.show({title:_,content:x}):void 0,className:"flex gap-4",children:[j?`${x.substring(0,w)}...`:x,j?p.jsx(le,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${y}`)};return p.jsxs(p.Fragment,{children:[p.jsxs(rp,{className:"w-full",children:[p.jsx(op,{children:p.jsxs(Ua,{children:[p.jsx(cs,{},"index"),n?n.map(h=>p.jsx(cs,{children:p.jsx("div",{className:"font-bold",children:h})},h)):void 0]})}),p.jsx(ap,{children:u!=null&&u.length?u==null?void 0:u.map(f):void 0})]}),d]})});var Jx,ZD;Jm=function(){if(ZD)return Jx;ZD=1;function e(t,n,r){var o=-1,a=t.length;n<0&&(n=-n>a?0:a+n),r=r>a?a:r,r<0&&(r+=a),a=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(a);++o<a;)i[o]=t[o+n];return i}return Jx=e,Jx};var Gx,e3;pi=function(){if(e3)return Gx;e3=1;var e=rc(),t=wa(),n=tf(),r=rr();function o(a,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],a):!1}return Gx=o,Gx};var Zx,t3;function Ooe(){if(t3)return Zx;t3=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Zx=t,Zx}var ew,n3;function Noe(){if(n3)return ew;n3=1;var e=Ooe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return ew=n,ew}var tw,r3;function o3(){if(r3)return tw;r3=1;var e=Noe(),t=rr(),n=zi(),r=NaN,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=a.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):o.test(l)?r:+l}return tw=c,tw}var nw,a3;function i3(){if(a3)return nw;a3=1;var e=o3(),t=1/0,n=17976931348623157e292;function r(o){if(!o)return o===0?o:0;if(o=e(o),o===t||o===-t){var a=o<0?-1:1;return a*n}return o===o?o:0}return nw=r,nw}var rw,s3;function c3(){if(s3)return rw;s3=1;var e=i3();function t(n){var r=e(n),o=r%1;return r===r?o?r-o:r:0}return rw=t,rw}var ow,l3;function Moe(){if(l3)return ow;l3=1;var e=Jm(),t=pi(),n=c3(),r=Math.ceil,o=Math.max;function a(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=o(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,f=Array(r(l/s));u<l;)f[d++]=e(i,u,u+=s);return f}return ow=a,ow}var koe=Moe();const aw=Xe(koe),Poe=()=>{const[e,t]=g.useState(!1),{t:n}=Me("flows"),{toast:r}=Bt(),o=fi(c=>c.index),a=fi(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===tr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await a({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new Hu({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===tr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=aw(d,10);let h=0;for(const y of f)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:y.length,handled:h,total:d.length}),await o({databaseId:l.vectorDatabase.id},y),h+=y.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},Aoe=ba(({retriverInfo:e})=>{var m,v,b;const{t}=Me("applications"),{loading:n,similaritySearchWithScore:r,indexData:o}=Poe(),[a,i]=g.useState("search"),[s,c]=g.useState(0),l=Kt(),u=g.useMemo(()=>{var w,j;if(!((w=e==null?void 0:e.vectorDatabaseEntity)!=null&&w.raw))return{headers:[],rows:[]};const x=["content","embedding","metadata"],_=Xh((j=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:j.raw);return{headers:x,rows:_.map(E=>{try{return JSON.parse(E)}catch{return[]}})}},[(m=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:m.raw]),d=g.useCallback(async(...x)=>{const[_,w]=x;await o(_,{...w,vectorDatabase:e.vectorDatabaseEntity})},[o,e.vectorDatabaseEntity]),f=g.useCallback(async(x,_)=>{const w=x.trim(),j=await r(w,{k:_,vectorDatabase:e.vectorDatabaseEntity});if(j!=null&&j.length)return j},[e.vectorDatabaseEntity,r]),h=g.useCallback(async x=>{if(x.type.includes("text")||x.type.includes("txt")){const _=new FileReader;_.onload=async w=>{var E;const j=(E=w.target)==null?void 0:E.result;await d({content:j},{vectorDatabase:e.vectorDatabaseEntity})},_.readAsText(x)}else if(x.type.endsWith("pdf")){const _=new Blob([x],{type:"application/pdf"}),w=await new RI(_,{pdfjs:async()=>{const j=await Nt(()=>import("./pdf.min-Dzflniks.js").then(async E=>(await E.__tla,E)),__vite__mapDeps([9,1,2,3,4,5,6]));return await Nt(()=>import("./pdf.worker.min-B2T89Jua.js").then(async E=>(await E.__tla,E)),__vite__mapDeps([10,1,2,3,4,5,6])),j.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),j},parsedItemSeparator:" "}).load();await d({documents:w},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:j=>{c((j.handled+j.handling)/j.total)}})}},[d,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(a){case"search":return p.jsx(vr,{value:"search",children:p.jsx(WD,{loading:n,onSimilaritySearch:f})});case"new":return p.jsx(vr,{className:"min-w-80",value:"new",children:p.jsx(qD,{loading:n,onCreateData:d})});case"file":return p.jsx(vr,{value:"file",children:p.jsx(YD,{loading:n,progress:s,onFileSubmit:h,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return p.jsx(vr,{value:"view",className:"max-h-full overflow-auto",children:p.jsx(sp,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,h,f,n,a,s,u]);return p.jsx(Ri,{open:l.visible,onOpenChange:l.hide,children:p.jsxs(Ma,{className:"max-w-3xl",children:[p.jsx(ka,{children:p.jsxs("div",{className:"flex",children:[p.jsx(le,{name:"file",className:"mr-2 h-4 w-4"}),p.jsx(Pa,{children:t("chat.vector_database")})]})}),p.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:p.jsx("div",{className:"w-full h-full",children:p.jsxs(Ix,{value:a,onValueChange:i,defaultValue:"search",className:K("w-full h-full mt-4"),children:[p.jsxs(Xf,{className:K("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===tr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[p.jsx(gr,{value:"search",children:t("chat.search")}),p.jsx(gr,{value:"new",children:t("chat.text")}),p.jsx(gr,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===tr.DatabaseNode?p.jsx(gr,{value:"view",children:t("chat.view")}):void 0]}),y]})})})]})})}),Toe=g.lazy(()=>Nt(()=>import("./index-DapbfuH2.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([11,12,1,2,13,14])));function Roe({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:o,onSelectThread:a,onAddNewThread:i,currentDataNode:s,...c}){var w,j;const{t:l}=Me("applications"),[u,d]=g.useState(!1),f=Kt(xre),h=Kt(Aoe),{chatList:y,getChatList:m,deleteChat:v}=Tre(o),b=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),m()}finally{d(!1)}},[m,i]),x=g.useCallback(()=>{h.show({retriverInfo:r[0]})},[r,h]),_=g.useCallback(async(E,S)=>{E.stopPropagation(),f.show({onDelete:()=>v(S)})},[v,f]);return p.jsxs(eg,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[p.jsx("div",{className:"h-1"}),p.jsxs(Ic,{className:"justify-between",children:[p.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),p.jsx(wn,{loading:u,onClick:b,variant:"link",className:"mr-[-6px]",children:p.jsx(le,{name:"circle-plus"})})]}),p.jsxs(ng,{children:[p.jsx(Rc,{className:"flex-1",children:p.jsx(Ti,{children:y.map(({node:E},S)=>{var O;return p.jsx(io,{onClick:()=>a(E),children:p.jsx(so,{className:"cursor-pointer",children:p.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx(le,{size:16,name:((O=s==null?void 0:s.node)==null?void 0:O.id)===E.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),p.jsx("span",{children:`Thread ${S+1}`})]}),p.jsx(le,{onClick:k=>_(k,E),size:16,name:"trash-2"})]})})},E.id)})})}),r!=null&&r.length?p.jsxs(Tt,{className:"m-2 p-2 max-w-full",children:[p.jsx("pre",{className:"overflow-auto",children:r.map((E,S)=>{var O;return p.jsx("span",{children:((O=E.promptEntity)==null?void 0:O.content)||""},`${S}`)})}),p.jsx(at,{onClick:x,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(w=e==null?void 0:e.schema_items)!=null&&w.length?p.jsx("div",{className:"m-2 !mb-0",children:p.jsx(g.Suspense,{fallback:p.jsx(Kf,{}),children:p.jsx(Toe,{className:K("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(j=e==null?void 0:e.schema_items)!=null&&j.length?`\`\`\`javascript
${AI((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})})}):void 0,p.jsx(Are,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var Ioe=Object.defineProperty,Doe=Object.defineProperties,Loe=Object.getOwnPropertyDescriptors,cp=Object.getOwnPropertySymbols,u3=Object.prototype.hasOwnProperty,d3=Object.prototype.propertyIsEnumerable,f3=(e,t,n)=>t in e?Ioe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lp=(e,t)=>{for(var n in t||(t={}))u3.call(t,n)&&f3(e,n,t[n]);if(cp)for(var n of cp(t))d3.call(t,n)&&f3(e,n,t[n]);return e},Foe=(e,t)=>Doe(e,Loe(t)),Boe=(e,t)=>{var n={};for(var r in e)u3.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&cp)for(var r of cp(e))t.indexOf(r)<0&&d3.call(e,r)&&(n[r]=e[r]);return n};sc=function(...e){return Dwe(Lwe(e))},WE=function(e,t){const n=e;return V.forwardRef(function(r,o){return V.createElement(n,Foe(lp(lp({ref:o},t),r),{className:sc(t.className,r.className)}))})},K9=function(e,...t){return WE(e,{className:sc(t)})},Y9=function(e,t,n){const r=e;return V.forwardRef(function(o,a){const i=o,{className:s}=i,c=Boe(i,["className"]),l=lp({},c);return n&&n.forEach(u=>{c[u]!==void 0&&delete l[u]}),V.createElement(r,lp({ref:a,className:sc(t(c),s)},l))})};var iw="Avatar",[$oe,f1e]=Vn(iw),[zoe,p3]=$oe(iw),h3=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[o,a]=g.useState("idle");return p.jsx(zoe,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:a,children:p.jsx(Oe.span,{...r,ref:t})})});h3.displayName=iw;var m3="AvatarImage",y3=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:o=()=>{},...a}=e,i=p3(m3,n),s=Voe(r,a.referrerPolicy),c=Vo(l=>{o(l),i.onImageLoadingStatusChange(l)});return xn(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?p.jsx(Oe.img,{...a,ref:t,src:r}):null});y3.displayName=m3;var g3="AvatarFallback",v3=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...o}=e,a=p3(g3,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&a.imageLoadingStatus!=="loaded"?p.jsx(Oe.span,{...o,ref:t}):null});v3.displayName=g3;function Voe(e,t){const[n,r]=g.useState("idle");return xn(()=>{if(!e){r("error");return}let o=!0;const a=new window.Image,i=s=>()=>{o&&r(s)};return r("loading"),a.onload=i("loaded"),a.onerror=i("error"),a.src=e,t&&(a.referrerPolicy=t),()=>{o=!1}},[e,t]),n}var b3=h3,x3=y3,w3=v3;const _3=g.forwardRef(({className:e,...t},n)=>p.jsx(b3,{ref:n,className:K("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));_3.displayName=b3.displayName;const j3=g.forwardRef(({className:e,...t},n)=>p.jsx(x3,{ref:n,className:K("aspect-square h-full w-full",e),...t}));j3.displayName=x3.displayName;const E3=g.forwardRef(({className:e,...t},n)=>p.jsx(w3,{ref:n,className:K("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));E3.displayName=w3.displayName;const Uoe=Jr("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),S3=g.forwardRef(({className:e,variant:t,layout:n,children:r,...o},a)=>p.jsx("div",{className:K(Uoe({variant:t,layout:n,className:e}),"relative group"),ref:a,...o,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:o==null?void 0:o.innerclassname}):i)}));S3.displayName="ChatBubble";const Hoe=({src:e,fallback:t,className:n})=>p.jsxs(_3,{className:n,children:[p.jsx(j3,{src:e,alt:"Avatar"}),p.jsx(E3,{children:t})]}),Woe=Jr("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"bg-primary text-primary-foreground rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),C3=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:o,...a},i)=>p.jsx("div",{className:K(Woe({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...a,children:r?p.jsx("div",{className:"flex items-center space-x-2",children:p.jsx(Kf,{})}):o}));C3.displayName="ChatBubbleMessage";const qoe=({icon:e,onClick:t,className:n,variant:r="ghost",size:o="icon",...a})=>p.jsx(at,{variant:r,size:o,className:n,onClick:t,...a,children:e}),Yoe=g.forwardRef(({variant:e,className:t,children:n,...r},o)=>p.jsx("div",{ref:o,className:K("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));Yoe.displayName="ChatBubbleActionWrapper";const Koe=g.lazy(()=>Nt(()=>import("./index-DapbfuH2.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([11,12,1,2,13,14]))),Xoe=[{icon:Zwe,label:"Copy"},{icon:t1e,label:"Refresh"},{icon:r1e,label:"Volume"}],Qoe=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:o,onActionClick:a})=>p.jsxs(S3,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?p.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?p.jsx(Hoe,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,p.jsxs(C3,{children:[r&&n&&(!e.content||o)?p.jsx(Kf,{}):p.jsxs(g.Suspense,{fallback:p.jsx(Kf,{}),children:[e.role==="system"?p.jsx(tn,{className:"!text-sm mb-1",children:"System"}):void 0,p.jsx(Koe,{className:sc("[&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans !text-sm"),style:{color:"unset !important"},source:e.content?o?`\`\`\`json
${e.content}
\`\`\``:e.content:""})]}),e.role==="assistant"&&n&&p.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&p.jsx(p.Fragment,{children:Xoe.map((i,s)=>{const c=i.icon;return p.jsx(qoe,{variant:"ghost",className:"size-5",icon:p.jsx(c,{className:"size-3"}),onClick:()=>a(i.label,e)},s)})})})]})]},t),(e,t)=>e.message.content===t.message.content&&e.isLastMessage===t.isLastMessage),Joe=g.memo(()=>{const{t:e}=Me("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),o=g.useCallback(()=>{setTimeout(()=>{O.current&&(O.current.scrollTop=O.current.scrollHeight)},50)},[]),{schema:a,threadInfo:i,mainLLMInfo:s,retriverInfo:c,currentDataNode:l,loadLLM:u,addNewDataNode:d,selectDataNode:f,updateMessagesData:h,onThreadMessagesLoaded:y}=Zne(),{sendMessage:m}=bre(),{input:v,messages:b,isLoading:x,reload:_,setInput:w,handleSubmit:j,handleInputChange:E,setMessages:S}=cS({fetch:async(A,C)=>{try{r(!0);const M=JSON.parse(C==null?void 0:C.body),T=xa(),D=M.messages[M.messages.length-1];return t.current=!0,S(I=>[...I,{id:xa(),content:D.content,role:"user"}]),await m(D.content,M.messages||[],{retriverInfo:c},{schema:a,onInjectedMessages:I=>{I.length&&S(L=>[...L,...I.map(B=>B._getType()==="system"?{id:xa(),content:`${B.content}`,role:"system",data:{injectedMessage:!0}}:B._getType()==="human"?{id:xa(),content:`${B.content}`,role:"user",data:{injectedMessage:!0}}:{id:xa(),content:`${B.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:I=>{S(L=>[...L,{id:T,content:I||"",role:"assistant"}])},onMessageUpdate:I=>{S(L=>{const B=[...L],U=B.findIndex(F=>F.id===T);return U!==-1&&(B[U]={...B[U],content:I.nodeData.content||""}),B}),t.current&&o()}}),S(I=>(h(I),I)),r(!1),w(""),t.current&&o(),new Response}finally{r(!1)}}}),O=g.useRef(null);g.useEffect(()=>{const A=y(C=>{S(C||[]),o()});return()=>{A()}},[S,y,o]);const k=async(A,C)=>(r(!0),await j(C),!0),N=g.useCallback(async(A,C)=>{if(A==="Refresh"){r(!0);try{await _()}finally{r(!1)}}A==="Copy"&&C&&C.role==="assistant"&&navigator.clipboard.writeText(C.content),A==="Volume"&&(C!=null&&C.content)&&await CE.speak((C==null?void 0:C.content)||"")},[_]),P=g.useCallback(()=>t.current=!1,[]),R=g.useMemo(()=>b&&b.map((A,C)=>p.jsx(Qoe,{message:A,index:C,isLastMessage:C===b.length-1,isGenerating:n,isSchema:!!a,onActionClick:N},A.id||`${C}`)),[b,n,a,N]);return p.jsxs(Zy,{onClick:P,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[p.jsx(tg,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:p.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[p.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:p.jsx(OM,{className:"!max-h-full",ref:O,children:R})}),p.jsx(fk,{className:"!max-w-2xl px-4",onSubmit:k,disabled:x||n||(s==null?void 0:s.status)!==et.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:v,onChange:E})]})}),p.jsx(Roe,{schema:a,currentDataNode:l,threadNode:i==null?void 0:i.threadNode,loadLLM:u,mainLLMInfo:s,retriverInfo:c,onAddNewThread:d,onSelectThread:f})]})}),Goe=()=>{const[e,t]=g.useState(),n=Je(l=>l.currentSession),{t:r}=Me("flows"),{toast:o}=Bt(),a=sn(l=>l.stream),i=sn(l=>l.loadModel),s=g.useCallback(async(l,u)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return o({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==et.Loaded&&(await i(e.llm.name,d=>{t(f=>f&&{...f,progress:d.text})}),t(d=>d&&{...d,status:et.Loaded,progress:""}));try{const d=a(l);if(!d)throw new Error("Stream is not supported");const f=[];for await(const h of d)h&&Array.isArray(h)&&(f.push(...h.map(y=>y.content)),h!=null&&h.length&&(u==null||u(h.map(y=>y.content).join(""))));return f.join("")}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return o({title:r("editor_node.errors.llm_not_loaded_yet")});o({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,o,r,i,a]),c=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const l=await ce("FlowEdge").find({where:{target:n.main_node_id}}),u=(await ce("FlowNode").find({where:{id:Vr(l.map(f=>f.source))}})).find(f=>f.source_type===oe.LLM);if(!u)return;const d=await ce("LLM").findOne({where:{id:u.source_id}});d&&(await i(d.name,f=>{t(h=>h&&{...h,llm:d,progress:f.text})}),t({llm:d,status:et.Loaded}))},[n==null?void 0:n.main_node_id,i]);return g.useEffect(()=>{n!=null&&n.main_node_id&&c()},[n==null?void 0:n.main_node_id,c]),{mainLLMInfo:e,createMessage:s}},Zoe=()=>{const e=Je(n=>n.currentSession),t=g.useRef(null);return{updateEditorContent:g.useCallback(async n=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await ce("FlowNode").update(e.main_node_id,{data:n})},150))},[e])}},eae=g.lazy(()=>Nt(()=>import("./PlateEditor-JAHzsm90.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([15,1,2,13,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,3,5,6,105]))),tae=g.memo(()=>{var o,a,i,s,c;const{updateEditorContent:e}=Zoe(),{mainLLMInfo:t,createMessage:n}=Goe(),r=g.useCallback(l=>{e(l)},[e]);return p.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[p.jsx(Ac,{children:p.jsx(Rr,{children:p.jsxs("div",{className:K("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===et.Loaded&&((o=t==null?void 0:t.llm)!=null&&o.name)?p.jsx(jo,{name:(a=t==null?void 0:t.llm)==null?void 0:a.name,className:"w-5 h-5 mr-1"}):void 0,p.jsx(Ir,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:t!=null&&t.progress?t==null?void 0:t.progress:(t==null?void 0:t.status)===et.Loaded?(i=t==null?void 0:t.llm)==null?void 0:i.name:p.jsx(le,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),p.jsx(ur,{children:p.jsx("p",{children:(t==null?void 0:t.progress)||((s=t==null?void 0:t.llm)==null?void 0:s.name)||""})})]})})}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-ful !rounded-none flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:p.jsx(eae,{onValueChange:r,copilotStream:n,hideDragIcon:!0,enableHistoryControl:!0},((c=t==null?void 0:t.llm)==null?void 0:c.name)||"default")})]})}),nae=()=>{const[e,t]=g.useState(),n=Je(l=>l.currentSession),{t:r}=Me("flows"),{toast:o}=Bt(),a=sn(l=>l.stream),i=sn(l=>l.loadModel),s=g.useCallback(async(l,u)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return o({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==et.Loaded&&(await i(e.llm.name,d=>{t(f=>f&&{...f,progress:d.text})}),t(d=>d&&{...d,status:et.Loaded,progress:""}));try{const d=a(l);if(!d)throw new Error("Stream is not supported");const f=[];for await(const h of d)h&&Array.isArray(h)&&(f.push(...h.map(y=>y.content)),h!=null&&h.length&&(u==null||u(h.map(y=>y.content).join(""))));return f.join("")}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return o({title:r("editor_node.errors.llm_not_loaded_yet")});o({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,o,r,i,a]),c=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const l=await ce("FlowEdge").find({where:{target:n.main_node_id}}),u=(await ce("FlowNode").find({where:{id:Vr(l.map(f=>f.source))}})).find(f=>f.source_type===oe.LLM);if(!u)return;const d=await ce("LLM").findOne({where:{id:u.source_id}});d&&(await i(d.name,f=>{t(h=>h&&{...h,llm:d,progress:f.text})}),t({llm:d,status:et.Loaded}))},[n==null?void 0:n.main_node_id,i]);return g.useEffect(()=>{n!=null&&n.main_node_id&&c()},[n==null?void 0:n.main_node_id,c]),{mainLLMInfo:e,createMessage:s}};dS=function(e,t=""){const n=[];for(const[r,o]of Object.entries(e)){const a=xa(),i=[t,r].filter(Boolean).join("/"),s="file"in o&&"contents"in o.file?o.file:void 0,c={id:a,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in o&&(c.children=dS(o.directory,i)),n.push(c)}return n},Um=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:o,content:a}=JSON.parse(r),i=o.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:a}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},Bm=function(e){const t=[];function n(r,o=[]){for(const[a,i]of Object.entries(r))if("file"in i){const s=[...o,a].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...o,a])}return n(e),t.join(`
`)},Hm=function(e,t,n){const r=t.replace(/^\.\//,"").split("/");let o=e;for(let a=0;a<r.length;a++){const i=r[a];if(a===r.length-1)i in o&&"file"in o[i]?o[i].file.contents=n:Or(`Path "${t}" is not a file.`);else if(i in o&&"directory"in o[i])o=o[i].directory;else return Or(`Path "${t}" does not exist.`),e}return e};const rae=()=>{const e=Je(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await ce("FlowNode").update(i,{raw:Bm(s)})},[]),o=g.useCallback(async(i,s)=>{e!=null&&e.main_node_id&&n(c=>{if(!(e!=null&&e.main_node_id))return c;const l=Hm(c||{},i,s);return r(e==null?void 0:e.main_node_id,l),l})},[e==null?void 0:e.main_node_id,r]),a=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await ce("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?Um(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&a()},[e==null?void 0:e.main_node_id,a]),{fileSystemTree:t,updateCodeContainerFile:o,updateCodeContainerData:r}},oae=g.lazy(()=>Nt(()=>import("./index-Dn1R432j.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([106,1,2,104,107,3,4,5,6,108]))),aae=g.memo(()=>{var r,o,a,i;const{mainLLMInfo:e}=nae(),{fileSystemTree:t,updateCodeContainerFile:n}=rae();return p.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[p.jsx(Ac,{children:p.jsx(Rr,{children:p.jsxs("div",{className:K("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(e==null?void 0:e.status)===et.Loaded&&((r=e==null?void 0:e.llm)!=null&&r.name)?p.jsx(jo,{name:(o=e==null?void 0:e.llm)==null?void 0:o.name,className:"w-5 h-5 mr-1"}):void 0,p.jsx(Ir,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:e!=null&&e.progress?e.progress:(e==null?void 0:e.status)===et.Loaded?((a=e==null?void 0:e.llm)==null?void 0:a.name)||"":p.jsx(le,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),p.jsx(ur,{children:p.jsx("p",{children:(e==null?void 0:e.progress)||((i=e==null?void 0:e.llm)==null?void 0:i.name)||""})})]})})}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-full flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:t!==void 0?p.jsx(oae,{autoLoad:!0,hideAppName:!0,fileSystemTree:t,onUpdateFileContent:n}):void 0})]})});function iae(){var t,n;const e=Je(r=>r.currentSession);if(!e)return p.jsx(U9,{flickeringGrid:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return p.jsx(Joe,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return p.jsx(tae,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return p.jsx(aae,{})}var up="Menubar",[sw,sae,cae]=zu(up),[O3,p1e]=Vn(up,[cae,Zr]),yn=Yu(),N3=Zr(),[lae,cw]=O3(up),M3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:o,defaultValue:a,loop:i=!0,dir:s,...c}=e,l=Uo(s),u=N3(n),[d="",f]=en({prop:r,onChange:o,defaultProp:a}),[h,y]=g.useState(null);return p.jsx(lae,{scope:n,value:d,onMenuOpen:g.useCallback(m=>{f(m),y(m)},[f]),onMenuClose:g.useCallback(()=>f(""),[f]),onMenuToggle:g.useCallback(m=>{f(v=>v?"":m),y(m)},[f]),dir:l,loop:i,children:p.jsx(sw.Provider,{scope:n,children:p.jsx(sw.Slot,{scope:n,children:p.jsx(ac,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:h,onCurrentTabStopIdChange:y,children:p.jsx(Oe.div,{role:"menubar",...c,ref:t})})})})})});M3.displayName=up;var lw="MenubarMenu",[uae,k3]=O3(lw),P3=e=>{const{__scopeMenubar:t,value:n,...r}=e,o=mt(),a=n||o||"LEGACY_REACT_AUTO_VALUE",i=cw(lw,t),s=yn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===a;return g.useEffect(()=>{u||(l.current=!1)},[u]),p.jsx(uae,{scope:t,value:a,triggerId:mt(),triggerRef:c,contentId:mt(),wasKeyboardTriggerOpenRef:l,children:p.jsx(_m,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};P3.displayName=lw;var uw="MenubarTrigger",A3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...o}=e,a=N3(n),i=yn(n),s=cw(uw,n),c=k3(uw,n),l=g.useRef(null),u=rt(t,l,c.triggerRef),[d,f]=g.useState(!1),h=s.value===c.value;return p.jsx(sw.ItemSlot,{scope:n,value:c.value,disabled:r,children:p.jsx(ic,{asChild:!0,...a,focusable:!r,tabStopId:c.value,children:p.jsx(cm,{asChild:!0,...i,children:p.jsx(Oe.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":h,"aria-controls":h?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":h?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:u,onPointerDown:he(e.onPointerDown,y=>{!r&&y.button===0&&y.ctrlKey===!1&&(s.onMenuOpen(c.value),h||y.preventDefault())}),onPointerEnter:he(e.onPointerEnter,()=>{var y;s.value&&!h&&(s.onMenuOpen(c.value),(y=l.current)==null||y.focus())}),onKeyDown:he(e.onKeyDown,y=>{r||(["Enter"," "].includes(y.key)&&s.onMenuToggle(c.value),y.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(y.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,y.preventDefault()))}),onFocus:he(e.onFocus,()=>f(!0)),onBlur:he(e.onBlur,()=>f(!1))})})})})});A3.displayName=uw;var dae="MenubarPortal",T3=e=>{const{__scopeMenubar:t,...n}=e,r=yn(t);return p.jsx(wm,{...r,...n})};T3.displayName=dae;var dw="MenubarContent",R3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...o}=e,a=yn(n),i=cw(dw,n),s=k3(dw,n),c=sae(n),l=g.useRef(!1);return p.jsx(lm,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...a,...o,ref:t,align:r,onCloseAutoFocus:he(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:he(e.onFocusOutside,u=>{const d=u.target;c().some(f=>{var h;return(h=f.ref.current)==null?void 0:h.contains(d)})&&u.preventDefault()}),onInteractOutside:he(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:he(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,f=d.hasAttribute("data-radix-menubar-subtrigger"),h=d.closest("[data-radix-menubar-content]")!==u.currentTarget,y=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!y&&f||h&&y)return;let m=c().filter(x=>!x.disabled).map(x=>x.value);y&&m.reverse();const v=m.indexOf(s.value);m=i.loop?Cae(m,v+1):m.slice(v+1);const[b]=m;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});R3.displayName=dw;var fae="MenubarGroup",pae=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(um,{...o,...r,ref:t})});pae.displayName=fae;var hae="MenubarLabel",I3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(dm,{...o,...r,ref:t})});I3.displayName=hae;var mae="MenubarItem",D3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(fm,{...o,...r,ref:t})});D3.displayName=mae;var yae="MenubarCheckboxItem",L3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(pm,{...o,...r,ref:t})});L3.displayName=yae;var gae="MenubarRadioGroup",vae=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(hm,{...o,...r,ref:t})});vae.displayName=gae;var bae="MenubarRadioItem",F3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(mm,{...o,...r,ref:t})});F3.displayName=bae;var xae="MenubarItemIndicator",B3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(ym,{...o,...r,ref:t})});B3.displayName=xae;var wae="MenubarSeparator",$3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(gm,{...o,...r,ref:t})});$3.displayName=wae;var _ae="MenubarArrow",jae=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(vm,{...o,...r,ref:t})});jae.displayName=_ae;var Eae="MenubarSubTrigger",z3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(bm,{"data-radix-menubar-subtrigger":"",...o,...r,ref:t})});z3.displayName=Eae;var Sae="MenubarSubContent",V3=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,o=yn(n);return p.jsx(xm,{...o,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});V3.displayName=Sae;function Cae(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var U3=M3,Oae=P3,H3=A3,Nae=T3,W3=R3,q3=I3,Y3=D3,K3=L3,X3=F3,Q3=B3,J3=$3,G3=z3,Z3=V3;const fw=Oae,e5=g.forwardRef(({className:e,...t},n)=>p.jsx(U3,{ref:n,className:K("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));e5.displayName=U3.displayName;const pw=g.forwardRef(({className:e,...t},n)=>p.jsx(H3,{ref:n,className:K("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));pw.displayName=H3.displayName;const Mae=g.forwardRef(({className:e,inset:t,children:n,...r},o)=>p.jsxs(G3,{ref:o,className:K("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,p.jsx(le,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));Mae.displayName=G3.displayName;const kae=g.forwardRef(({className:e,...t},n)=>p.jsx(Z3,{ref:n,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));kae.displayName=Z3.displayName;const t5=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...o},a)=>p.jsx(Nae,{children:p.jsx(W3,{ref:a,align:t,alignOffset:n,sideOffset:r,className:K("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o})}));t5.displayName=W3.displayName;const n5=g.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(Y3,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));n5.displayName=Y3.displayName;const Pae=g.forwardRef(({className:e,children:t,checked:n,...r},o)=>p.jsxs(K3,{ref:o,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(Q3,{children:p.jsx(le,{name:"check",className:"h-4 w-4"})})}),t]}));Pae.displayName=K3.displayName;const Aae=g.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(X3,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[p.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:p.jsx(Q3,{children:p.jsx(le,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));Aae.displayName=X3.displayName;const Tae=g.forwardRef(({className:e,inset:t,...n},r)=>p.jsx(q3,{ref:r,className:K("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Tae.displayName=q3.displayName;const Rae=g.forwardRef(({className:e,...t},n)=>p.jsx(J3,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));Rae.displayName=J3.displayName;let r5;Ae=Fwe()(Bwe($we((e,t)=>({...wI,...Gne(e,t)})))),r5=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.pushSyncNodeQueue),o=Ae(i=>i.createOrUpdateFlowNode),a=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");n(!0);const c=await ce("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):ce("LLM").save({name:`${s.name}`,status:et.Started,session_id:e,provider:Qu.WebLLM,metadata:JSON.stringify({}),model_type:s.model_type||pc.LLM,...s}).then(async l=>{var u,d,f;return await o({source_id:l.id,source_type:"LLM",node_type:oe.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((f=i.measured)==null?void 0:f.height)||0)+30}),l})}finally{n(!1)}},[o,r,e]);return{loading:t,createDatabaseLLM:a}};var hw="Popover",[o5,h1e]=Vn(hw,[Jo]),Pl=Jo(),[Iae,ia]=o5(hw),a5=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:o,onOpenChange:a,modal:i=!1}=e,s=Pl(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,f]=en({prop:r,defaultProp:o,onChange:a});return p.jsx(Mc,{...s,children:p.jsx(Iae,{scope:t,contentId:mt(),triggerRef:c,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};a5.displayName=hw;let mw;mw="PopoverAnchor",Fm=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=ia(mw,n),a=Pl(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=o;return g.useEffect(()=>(i(),()=>s()),[i,s]),p.jsx(kc,{...a,...r,ref:t})}),Fm.displayName=mw;var i5="PopoverTrigger",yw=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=ia(i5,n),a=Pl(n),i=rt(t,o.triggerRef),s=p.jsx(Oe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":d5(o.open),...r,ref:i,onClick:he(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?s:p.jsx(kc,{asChild:!0,...a,children:s})});yw.displayName=i5;var gw="PopoverPortal",[Dae,Lae]=o5(gw,{forceMount:void 0}),s5=e=>{const{__scopePopover:t,forceMount:n,children:r,container:o}=e,a=ia(gw,t);return p.jsx(Dae,{scope:t,forceMount:n,children:p.jsx(Mn,{present:n||a.open,children:p.jsx(Fu,{asChild:!0,container:o,children:r})})})};s5.displayName=gw;var ds="PopoverContent",c5=g.forwardRef((e,t)=>{const n=Lae(ds,e.__scopePopover),{forceMount:r=n.forceMount,...o}=e,a=ia(ds,e.__scopePopover);return p.jsx(Mn,{present:r||a.open,children:a.modal?p.jsx(Fae,{...o,ref:t}):p.jsx(Bae,{...o,ref:t})})});c5.displayName=ds;var Fae=g.forwardRef((e,t)=>{const n=ia(ds,e.__scopePopover),r=g.useRef(null),o=rt(t,r),a=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return bd(i)},[]),p.jsx(Sc,{as:Gr,allowPinchZoom:!0,children:p.jsx(l5,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:he(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),a.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:he(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;a.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:he(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Bae=g.forwardRef((e,t)=>{const n=ia(ds,e.__scopePopover),r=g.useRef(!1),o=g.useRef(!1);return p.jsx(l5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,a),a.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),a.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:a=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=a.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&o.current&&a.preventDefault()}})}),l5=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,f=ia(ds,n),h=Pl(n);return dd(),p.jsx(Ec,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:a,children:p.jsx(Lu,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:p.jsx(Md,{"data-state":d5(f.open),role:"dialog",id:f.contentId,...h,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),u5="PopoverClose",$ae=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=ia(u5,n);return p.jsx(Oe.button,{type:"button",...r,ref:t,onClick:he(e.onClick,()=>o.onOpenChange(!1))})});$ae.displayName=u5;var zae="PopoverArrow",Vae=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=Pl(n);return p.jsx(kd,{...o,...r,ref:t})});Vae.displayName=zae;function d5(e){return e?"open":"closed"}rS=a5,X9=Fm,Z9=yw,oS=s5,Rm=c5;const Uae=rS,f5=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},o)=>p.jsx(oS,{children:p.jsx(Rm,{ref:o,align:t,sideOffset:n,className:K("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));f5.displayName=Rm.displayName;var p5=1,Hae=.9,Wae=.8,qae=.17,vw=.1,bw=.999,Yae=.9999,Kae=.99,Xae=/[\\\/_+.#"@\[\(\{&]/,Qae=/[\\\/_+.#"@\[\(\{&]/g,Jae=/[\s-]/,h5=/[\s-]/g;function xw(e,t,n,r,o,a,i){if(a===t.length)return o===e.length?p5:Kae;var s=`${o},${a}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(a),l=n.indexOf(c,o),u=0,d,f,h,y;l>=0;)d=xw(e,t,n,r,l+1,a+1,i),d>u&&(l===o?d*=p5:Xae.test(e.charAt(l-1))?(d*=Wae,h=e.slice(o,l-1).match(Qae),h&&o>0&&(d*=Math.pow(bw,h.length))):Jae.test(e.charAt(l-1))?(d*=Hae,y=e.slice(o,l-1).match(h5),y&&o>0&&(d*=Math.pow(bw,y.length))):(d*=qae,o>0&&(d*=Math.pow(bw,l-o))),e.charAt(l)!==t.charAt(a)&&(d*=Yae)),(d<vw&&n.charAt(l-1)===r.charAt(a+1)||r.charAt(a+1)===r.charAt(a)&&n.charAt(l-1)!==r.charAt(a))&&(f=xw(e,t,n,r,l+1,a+2,i),f*vw>d&&(d=f*vw)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function m5(e){return e.toLowerCase().replace(h5," ")}function Gae(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,xw(e,t,m5(e),m5(t),0,0,{})}var Al='[cmdk-group=""]',ww='[cmdk-group-items=""]',Zae='[cmdk-group-heading=""]',_w='[cmdk-item=""]',y5=`${_w}:not([aria-disabled="true"])`,jw="cmdk-item-select",Ha="data-value",eie=(e,t,n)=>Gae(e,t,n),g5=g.createContext(void 0),Tl=()=>g.useContext(g5),v5=g.createContext(void 0),Ew=()=>g.useContext(v5),b5=g.createContext(void 0),x5=g.forwardRef((e,t)=>{let n=fs(()=>{var F,H;return{search:"",value:(H=(F=e.value)!=null?F:e.defaultValue)!=null?H:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=fs(()=>new Set),o=fs(()=>new Map),a=fs(()=>new Map),i=fs(()=>new Set),s=w5(e),{label:c,children:l,value:u,onValueChange:d,filter:f,shouldFilter:h,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...b}=e,x=mt(),_=mt(),w=mt(),j=g.useRef(null),E=die();Wa(()=>{if(u!==void 0){let F=u.trim();n.current.value=F,S.emit()}},[u]),Wa(()=>{E(6,A)},[]);let S=g.useMemo(()=>({subscribe:F=>(i.current.add(F),()=>i.current.delete(F)),snapshot:()=>n.current,setState:(F,H,J)=>{var q,re,Z;if(!Object.is(n.current[F],H)){if(n.current[F]=H,F==="search")R(),N(),E(1,P);else if(F==="value"&&(J||E(5,A),((q=s.current)==null?void 0:q.value)!==void 0)){let Y=H??"";(Z=(re=s.current).onValueChange)==null||Z.call(re,Y);return}S.emit()}},emit:()=>{i.current.forEach(F=>F())}}),[]),O=g.useMemo(()=>({value:(F,H,J)=>{var q;H!==((q=a.current.get(F))==null?void 0:q.value)&&(a.current.set(F,{value:H,keywords:J}),n.current.filtered.items.set(F,k(H,J)),E(2,()=>{N(),S.emit()}))},item:(F,H)=>(r.current.add(F),H&&(o.current.has(H)?o.current.get(H).add(F):o.current.set(H,new Set([F]))),E(3,()=>{R(),N(),n.current.value||P(),S.emit()}),()=>{a.current.delete(F),r.current.delete(F),n.current.filtered.items.delete(F);let J=C();E(4,()=>{R(),(J==null?void 0:J.getAttribute("id"))===F&&P(),S.emit()})}),group:F=>(o.current.has(F)||o.current.set(F,new Set),()=>{a.current.delete(F),o.current.delete(F)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:x,inputId:w,labelId:_,listInnerRef:j}),[]);function k(F,H){var J,q;let re=(q=(J=s.current)==null?void 0:J.filter)!=null?q:eie;return F?re(F,n.current.search,H):0}function N(){if(!n.current.search||s.current.shouldFilter===!1)return;let F=n.current.filtered.items,H=[];n.current.filtered.groups.forEach(q=>{let re=o.current.get(q),Z=0;re.forEach(Y=>{let W=F.get(Y);Z=Math.max(W,Z)}),H.push([q,Z])});let J=j.current;M().sort((q,re)=>{var Z,Y;let W=q.getAttribute("id"),G=re.getAttribute("id");return((Z=F.get(G))!=null?Z:0)-((Y=F.get(W))!=null?Y:0)}).forEach(q=>{let re=q.closest(ww);re?re.appendChild(q.parentElement===re?q:q.closest(`${ww} > *`)):J.appendChild(q.parentElement===J?q:q.closest(`${ww} > *`))}),H.sort((q,re)=>re[1]-q[1]).forEach(q=>{var re;let Z=(re=j.current)==null?void 0:re.querySelector(`${Al}[${Ha}="${encodeURIComponent(q[0])}"]`);Z==null||Z.parentElement.appendChild(Z)})}function P(){let F=M().find(J=>J.getAttribute("aria-disabled")!=="true"),H=F==null?void 0:F.getAttribute(Ha);S.setState("value",H||void 0)}function R(){var F,H,J,q;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let re=0;for(let Z of r.current){let Y=(H=(F=a.current.get(Z))==null?void 0:F.value)!=null?H:"",W=(q=(J=a.current.get(Z))==null?void 0:J.keywords)!=null?q:[],G=k(Y,W);n.current.filtered.items.set(Z,G),G>0&&re++}for(let[Z,Y]of o.current)for(let W of Y)if(n.current.filtered.items.get(W)>0){n.current.filtered.groups.add(Z);break}n.current.filtered.count=re}function A(){var F,H,J;let q=C();q&&(((F=q.parentElement)==null?void 0:F.firstChild)===q&&((J=(H=q.closest(Al))==null?void 0:H.querySelector(Zae))==null||J.scrollIntoView({block:"nearest"})),q.scrollIntoView({block:"nearest"}))}function C(){var F;return(F=j.current)==null?void 0:F.querySelector(`${_w}[aria-selected="true"]`)}function M(){var F;return Array.from(((F=j.current)==null?void 0:F.querySelectorAll(y5))||[])}function T(F){let H=M()[F];H&&S.setState("value",H.getAttribute(Ha))}function D(F){var H;let J=C(),q=M(),re=q.findIndex(Y=>Y===J),Z=q[re+F];(H=s.current)!=null&&H.loop&&(Z=re+F<0?q[q.length-1]:re+F===q.length?q[0]:q[re+F]),Z&&S.setState("value",Z.getAttribute(Ha))}function I(F){let H=C(),J=H==null?void 0:H.closest(Al),q;for(;J&&!q;)J=F>0?lie(J,Al):uie(J,Al),q=J==null?void 0:J.querySelector(y5);q?S.setState("value",q.getAttribute(Ha)):D(F)}let L=()=>T(M().length-1),B=F=>{F.preventDefault(),F.metaKey?L():F.altKey?I(1):D(1)},U=F=>{F.preventDefault(),F.metaKey?T(0):F.altKey?I(-1):D(-1)};return g.createElement(Oe.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:F=>{var H;if((H=b.onKeyDown)==null||H.call(b,F),!F.defaultPrevented)switch(F.key){case"n":case"j":{v&&F.ctrlKey&&B(F);break}case"ArrowDown":{B(F);break}case"p":case"k":{v&&F.ctrlKey&&U(F);break}case"ArrowUp":{U(F);break}case"Home":{F.preventDefault(),T(0);break}case"End":{F.preventDefault(),L();break}case"Enter":if(!F.nativeEvent.isComposing&&F.keyCode!==229){F.preventDefault();let J=C();if(J){let q=new Event(jw);J.dispatchEvent(q)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:pie},c),dp(e,F=>g.createElement(v5.Provider,{value:S},g.createElement(g5.Provider,{value:O},F))))}),tie=g.forwardRef((e,t)=>{var n,r;let o=mt(),a=g.useRef(null),i=g.useContext(b5),s=Tl(),c=w5(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;Wa(()=>{if(!l)return s.item(o,i==null?void 0:i.id)},[l]);let u=_5(o,a,[e.value,e.children,a],e.keywords),d=Ew(),f=qa(E=>E.value&&E.value===u.current),h=qa(E=>l||s.filter()===!1?!0:E.search?E.filtered.items.get(o)>0:!0);g.useEffect(()=>{let E=a.current;if(!(!E||e.disabled))return E.addEventListener(jw,y),()=>E.removeEventListener(jw,y)},[h,e.onSelect,e.disabled]);function y(){var E,S;m(),(S=(E=c.current).onSelect)==null||S.call(E,u.current)}function m(){d.setState("value",u.current,!0)}if(!h)return null;let{disabled:v,value:b,onSelect:x,forceMount:_,keywords:w,...j}=e;return g.createElement(Oe.div,{ref:Rl([a,t]),...j,id:o,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||s.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},e.children)}),nie=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:o,...a}=e,i=mt(),s=g.useRef(null),c=g.useRef(null),l=mt(),u=Tl(),d=qa(h=>o||u.filter()===!1?!0:h.search?h.filtered.groups.has(i):!0);Wa(()=>u.group(i),[]),_5(i,s,[e.value,e.heading,c]);let f=g.useMemo(()=>({id:i,forceMount:o}),[o]);return g.createElement(Oe.div,{ref:Rl([s,t]),...a,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),dp(e,h=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(b5.Provider,{value:f},h))))}),rie=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,o=g.useRef(null),a=qa(i=>!i.search);return!n&&!a?null:g.createElement(Oe.div,{ref:Rl([o,t]),...r,"cmdk-separator":"",role:"separator"})}),oie=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,o=e.value!=null,a=Ew(),i=qa(u=>u.search),s=qa(u=>u.value),c=Tl(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${_w}[${Ha}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),g.createElement(Oe.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:o?e.value:i,onChange:u=>{o||a.setState("search",u.target.value),n==null||n(u.target.value)}})}),aie=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...o}=e,a=g.useRef(null),i=g.useRef(null),s=Tl();return g.useEffect(()=>{if(i.current&&a.current){let c=i.current,l=a.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;l.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Oe.div,{ref:Rl([a,t]),...o,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},dp(e,c=>g.createElement("div",{ref:Rl([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),iie=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:o,contentClassName:a,container:i,...s}=e;return g.createElement(oc,{open:n,onOpenChange:r},g.createElement(lc,{container:i},g.createElement(_a,{"cmdk-overlay":"",className:o}),g.createElement(ja,{"aria-label":e.label,"cmdk-dialog":"",className:a},g.createElement(x5,{ref:t,...s}))))}),sie=g.forwardRef((e,t)=>qa(n=>n.filtered.count===0)?g.createElement(Oe.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),cie=g.forwardRef((e,t)=>{let{progress:n,children:r,label:o="Loading...",...a}=e;return g.createElement(Oe.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},dp(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),Cn=Object.assign(x5,{List:aie,Item:tie,Input:oie,Group:nie,Separator:rie,Dialog:iie,Empty:sie,Loading:cie});function lie(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function uie(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function w5(e){let t=g.useRef(e);return Wa(()=>{t.current=e}),t}var Wa=typeof window>"u"?g.useEffect:g.useLayoutEffect;function fs(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function Rl(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function qa(e){let t=Ew(),n=()=>e(t.snapshot());return Ku.useSyncExternalStore(t.subscribe,n,n)}function _5(e,t,n,r=[]){let o=g.useRef(),a=Tl();return Wa(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():o.current}})(),c=r.map(l=>l.trim());a.value(e,s,c),(i=t.current)==null||i.setAttribute(Ha,s),o.current=s}),o}var die=()=>{let[e,t]=g.useState(),n=fs(()=>new Map);return Wa(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,o)=>{n.current.set(r,o),t({})}};function fie(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function dp({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(fie(t),{ref:t.ref},n(t.props.children)):n(t)}var pie={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const j5=g.forwardRef(({className:e,...t},n)=>p.jsx(Cn,{ref:n,className:K("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));j5.displayName=Cn.displayName;const E5=g.forwardRef(({className:e,...t},n)=>p.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[p.jsx(le,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),p.jsx(Cn.Input,{ref:n,className:K("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));E5.displayName=Cn.Input.displayName;const S5=g.forwardRef(({className:e,...t},n)=>p.jsx(Cn.List,{ref:n,className:K("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));S5.displayName=Cn.List.displayName;const C5=g.forwardRef((e,t)=>p.jsx(Cn.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));C5.displayName=Cn.Empty.displayName;const O5=g.forwardRef(({className:e,...t},n)=>p.jsx(Cn.Group,{ref:n,className:K("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));O5.displayName=Cn.Group.displayName;const hie=g.forwardRef(({className:e,...t},n)=>p.jsx(Cn.Separator,{ref:n,className:K("-mx-1 h-px bg-border",e),...t}));hie.displayName=Cn.Separator.displayName;const N5=g.forwardRef(({className:e,...t},n)=>p.jsx(Cn.Item,{ref:n,className:K("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));N5.displayName=Cn.Item.displayName;const mie=[Qu.WebLLM];function yie(e){var C;const{id:t,setDialog:n}=e,{t:r}=Me("components"),{toast:o}=Bt(),a=ln(t),[i,s]=g.useState(""),[c,l]=g.useState(!1),[u,d]=g.useState(""),[f,h]=g.useState(Qu.WebLLM),[y,m]=g.useState(!1),[v,b]=g.useState(),x=sn(M=>M.syncCachedLLMURLs),_=sn(M=>M.cachedLLMURLs),{loading:w,createDatabaseLLM:j}=r5();g.useEffect(()=>{Nt(()=>import("./index-BG3xyZmB.js").then(async M=>(await M.__tla,M)),__vite__mapDeps([7,1,2,3,4,5,6])).then(async({functionCallingModelIds:M,prebuiltAppConfig:T})=>{const D=T.model_list;b({modelList:D,functionCallingModelIds:M})})},[]),g.useEffect(()=>{x()},[x]);const E=g.useMemo(()=>!(v!=null&&v.functionCallingModelIds)||!(v!=null&&v.modelList)?[]:((u?v==null?void 0:v.modelList.filter(M=>M.model_id.toLowerCase().includes(u.toLowerCase())):v==null?void 0:v.modelList)||[]).sort((M,T)=>{const D=_.some(H=>H.includes(M.model_id)),I=_.some(H=>H.includes(T.model_id));if(D&&!I)return-1;if(!D&&I)return 1;const L=Ax.includes(M.model_id),B=Ax.includes(T.model_id);if(L&&!B)return-1;if(!L&&B)return 1;const U=v==null?void 0:v.functionCallingModelIds.includes(M.model_id),F=v==null?void 0:v.functionCallingModelIds.includes(T.model_id);return U&&!F?-1:!U&&F?1:M.vram_required_MB&&T.vram_required_MB&&M.vram_required_MB!==T.vram_required_MB?M.vram_required_MB-T.vram_required_MB:M.model_id.localeCompare(T.model_id)}),[v==null?void 0:v.modelList,v==null?void 0:v.functionCallingModelIds,u,_]),S=g.useMemo(()=>{if(!(!i||!(v!=null&&v.modelList)))return v==null?void 0:v.modelList.find(M=>M.model_id===i)},[i,v==null?void 0:v.modelList]);g.useEffect(()=>{!(S!=null&&S.model_id)||!_||m(_.some(M=>M.includes(S.model_id)))},[_,S==null?void 0:S.model_id]);const O=g.useCallback(M=>M===1?pc.embedding:M===2?pc.VLM:pc.LLM,[]),k=g.useCallback(M=>{s(M),l(!1)},[]),N=g.useCallback(M=>{d(M)},[]),P=g.useCallback(M=>{h(M)},[]),R=async()=>{var M;if(a)try{await j(a,{name:i,model_type:O(S==null?void 0:S.model_type),function_calling:S!=null&&S.model_id?(M=v==null?void 0:v.functionCallingModelIds)==null?void 0:M.includes(S==null?void 0:S.model_id):!1}),n==null||n(!1)}catch{o({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s("")}},A=g.useMemo(()=>E.map(M=>{var T;return p.jsxs(N5,{value:M.model_id,onSelect:k,children:[i===M.model_id?p.jsx(le,{name:"check",className:"mr-2 h-4 w-4"}):p.jsx("div",{className:"mr-2 h-4 w-4"}),p.jsxs("span",{className:"max-w-md",children:[p.jsxs("div",{className:"flex gap-2 mb-2",children:[p.jsx(jo,{name:M.model_id}),M.model_id]}),p.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:p.jsx(Nl,{model:M,isFunctionCalling:((T=v==null?void 0:v.functionCallingModelIds)==null?void 0:T.includes(M.model_id))||!1,name:M.model_id,isCached:_.some(D=>D.includes(M.model_id))||!1})})]})]},M.model_id)}),[_,k,i,v==null?void 0:v.functionCallingModelIds,E]);return p.jsxs(Tt,{className:"max-w-lg",children:[p.jsx(hn,{children:p.jsx(En,{children:r("add_llm_card.title")})}),p.jsxs(mn,{children:[p.jsxs("div",{className:"grid w-full gap-1.5",children:[p.jsx(Qe,{children:r("add_llm_card.provider")}),p.jsxs(Eo,{value:f,onValueChange:P,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:r("add_llm_card.provider_select_placeholder")})}),p.jsx(Hr,{children:Object.values(mie).map(M=>p.jsx(Sn,{value:M,children:r(`add_llm_card.providers.${M.toLowerCase()}`)},M))})]}),p.jsx(Qe,{children:r("add_llm_card.model_name")}),p.jsxs(Uae,{open:c,onOpenChange:l,children:[p.jsx(yw,{asChild:!0,children:p.jsxs(at,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between",children:[i?S==null?void 0:S.model_id:r("add_llm_card.select_model_placeholder"),p.jsx(le,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),p.jsx(f5,{className:"w-full p-0",children:p.jsxs(j5,{children:[p.jsx(E5,{onValueChange:N,placeholder:r("add_llm_card.search_placeholder")}),p.jsxs(S5,{children:[p.jsx(C5,{children:r("add_llm_card.no_model")}),p.jsx(O5,{children:A})]})]})})]})]}),S?p.jsxs("div",{className:"mt-4",children:[p.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[p.jsx(jo,{name:S.model_id,className:"mr-2"}),p.jsx(Nl,{model:S,isFunctionCalling:((C=v==null?void 0:v.functionCallingModelIds)==null?void 0:C.includes(S.model_id))||!1,name:S.model_id,isCached:_.some(M=>M.includes(S.model_id))||!1})]}),p.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[p.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),S.model]}),p.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[p.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),S.model_lib]}),p.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[p.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(S.overrides)]})]}):null]}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{loading:w,disabled:!(i!=null&&i.length),onClick:R,className:"w-full",children:r(y?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const M5=()=>{const e=Je(a=>{var i;return(i=a.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=Ae(a=>a.createOrUpdateFlowNode),o=g.useCallback(async(a,i)=>{var s,c,l;try{if(!a||!e)throw new Error("Source or Session not found");n(!0);const u=((s=a.position)==null?void 0:s.x)||0,d=(((c=a.position)==null?void 0:c.y)||0)+(((l=a.measured)==null?void 0:l.height)||0),f=await ce("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||kn.System,status:eo.Started,session_id:e,type:i.type||Pn.Chat});if(!f)throw new Error("Failed to save prompt");if(!await r({source_id:f.id,source_type:"Prompt",node_type:oe.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:o}},gie={[Pn.Chat]:{label:"add_prompt_card.prompt_types.chat",value:Pn.Chat},[Pn.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:Pn.FewShotExample}},vie={[kn.System]:{label:"add_prompt_card.prompt_roles.system",value:kn.System},[kn.Human]:{label:"add_prompt_card.prompt_roles.human",value:kn.Human},[kn.AI]:{label:"add_prompt_card.prompt_roles.ai",value:kn.AI}},Sw=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:o,loading:a,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||Pn.Chat),[d,f]=g.useState(t),[h,y]=g.useState(""),{t:m}=Me("components"),v=g.useCallback(j=>{c(j.target.value)},[]),b=g.useCallback(j=>{y(j.target.value)},[]),x=g.useCallback(j=>{j===Pn.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(j)},[]),_=g.useCallback(j=>{f(j)},[]),w=async()=>{await i({content:s,role:d,prefix:h,type:l})&&(c(""),f(void 0),u("chat"),y(""))};return p.jsxs("div",{children:[p.jsxs("div",{className:"grid w-full gap-1.5",children:[o?void 0:p.jsxs(p.Fragment,{children:[p.jsx(Qe,{children:m("add_prompt_card.prompt_type")}),p.jsxs(Eo,{value:l,onValueChange:x,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:m("add_prompt_card.type_select_placeholder")})}),p.jsx(Hr,{children:Object.values(gie).map(j=>p.jsx(Sn,{value:j.value,children:m(j.label)},j.value))})]})]}),r?void 0:p.jsxs(p.Fragment,{children:[p.jsx(Qe,{children:m("add_prompt_card.prompt_role")}),p.jsxs(Eo,{value:d,onValueChange:_,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:m("add_prompt_card.role_select_placeholder")})}),p.jsx(Hr,{children:Object.values(vie).map(j=>p.jsx(Sn,{value:j.value,children:m(j.label)},j.value))})]})]}),l===Pn.FewShotExample&&p.jsxs(p.Fragment,{children:[p.jsx(Qe,{children:m("add_prompt_card.prompt_prefix")}),p.jsx(ho,{value:h,onChange:b,disabled:!1,className:"h-20",placeholder:m("add_prompt_card.placeholder"),id:"message"}),p.jsx(Qe,{children:m("add_prompt_card.prompt_content")}),p.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[p.jsx(le,{name:"info",className:"mr-2",size:14}),m("add_prompt_card.few_shot_example_note")]})]}),p.jsx(ho,{value:s,onChange:v,disabled:!1,placeholder:m("add_prompt_card.placeholder"),id:"message"})]}),p.jsx("div",{children:p.jsx(wn,{loading:a,disabled:!(s!=null&&s.length),onClick:w,className:"w-full mt-4",children:m("add_prompt_card.button")})})]})}),bie=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:o}=Me("components"),{toast:a}=Bt(),i=ln(t),{createPrompt:s,loading:c}=M5(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){a({variant:"destructive",title:`${d}`})}};return p.jsxs(Tt,{className:"mw-full",children:[p.jsx(hn,{children:p.jsx(En,{children:o("add_prompt_card.title")})}),p.jsx(mn,{children:p.jsx(Sw,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),xie=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.createOrUpdateFlowNode),o=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?o(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||Bc(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),a=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,f=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),h=await ce("Schema").save({name:"Untitled Schema",session_id:e});if(!h)throw new Error("Failed to save schema");const y=o(h.id,s,[],void 0);if(!(y!=null&&y.length))throw new Error("Failed to convert schema items");if(await ce("SchemaItem").save(y),!await r({source_id:h.id,source_type:"Schema",node_type:oe.Schema,x:d,y:f+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,o,r]);return{loading:t,createSchema:a}};var Cw="Checkbox",[wie,m1e]=Vn(Cw),[_ie,jie]=wie(Cw),k5=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:o,defaultChecked:a,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[f,h]=g.useState(null),y=rt(t,w=>h(w)),m=g.useRef(!1),v=f?u||!!f.closest("form"):!0,[b=!1,x]=en({prop:o,defaultProp:a,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const w=f==null?void 0:f.form;if(w){const j=()=>x(_.current);return w.addEventListener("reset",j),()=>w.removeEventListener("reset",j)}},[f,x]),p.jsxs(_ie,{scope:n,state:b,disabled:s,children:[p.jsx(Oe.button,{type:"button",role:"checkbox","aria-checked":sa(b)?"mixed":b,"aria-required":i,"data-state":T5(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:y,onKeyDown:he(e.onKeyDown,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:he(e.onClick,w=>{x(j=>sa(j)?!0:!j),v&&(m.current=w.isPropagationStopped(),m.current||w.stopPropagation())})}),v&&p.jsx(Eie,{control:f,bubbles:!m.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:sa(a)?!1:a})]})});k5.displayName=Cw;var P5="CheckboxIndicator",A5=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...o}=e,a=jie(P5,n);return p.jsx(Mn,{present:r||sa(a.state)||a.state===!0,children:p.jsx(Oe.span,{"data-state":T5(a.state),"data-disabled":a.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});A5.displayName=P5;var Eie=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:o,...a}=e,i=g.useRef(null),s=KI(n),c=IO(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&f){const h=new Event("click",{bubbles:r});u.indeterminate=sa(n),f.call(u,sa(n)?!1:n),u.dispatchEvent(h)}},[s,n,r]);const l=g.useRef(sa(n)?!1:n);return p.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o??l.current,...a,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function sa(e){return e==="indeterminate"}function T5(e){return sa(e)?"indeterminate":e?"checked":"unchecked"}jm=k5,QE=A5;const R5=g.forwardRef(({className:e,...t},n)=>p.jsx(jm,{ref:n,className:K("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:p.jsx(QE,{className:K("flex items-center justify-center text-current"),children:p.jsx(le,{name:"check",className:"h-4 w-4"})})}));R5.displayName=jm.displayName;const I5=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Me("components"),[o,a]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(m=>m.id===n)||o,[t,o,n]),s=g.useCallback(m=>{m.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(m.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:m.target.value||""}:b)]):a(v=>({...v,name:m.target.value||""})))},[n,e]),c=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:m.target.value||""}:b)]):a(v=>({...v,description:m.target.value||""}))},[n,e]),l=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:m||""}:b)]):a(v=>({...v,type:m||"string"}))},[n,e]),u=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!m||!1}:b)]):a(v=>({...v,required:!!m||!1}))},[n,e]),d=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:m.target.value||""}:b)]):a(v=>({...v,enum:m.target.value||""}))},[n,e]),f=g.useCallback(()=>{if(t.find(m=>m.name===o.name))return tc({variant:"destructive",content:"Name already exists"});o.id=Bc(),e(m=>[...m,{...o}]),a({name:"",description:"",type:"string",required:!1,id:Bc(),parent:n||void 0,data:[]})},[t,o,e,n]),h=g.useCallback(m=>{e(v=>[...v.map(b=>b.id===n?{...b,data:m(b.data||[])}:b)])},[n,e]),y=["object","array"].includes(i.type);return p.jsxs("div",{className:"w-full p-1",children:[p.jsxs("div",{children:[p.jsx(Qe,{children:r("add_schema_card.field.name")}),p.jsx(dn,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),p.jsxs("div",{children:[p.jsx(Qe,{children:r("add_schema_card.field.description")}),p.jsx(dn,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),p.jsxs("div",{children:[p.jsx(Qe,{children:r("add_schema_card.field.type")}),p.jsxs(Eo,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[p.jsx(Ur,{children:p.jsx(So,{placeholder:r("add_schema_card.field.type_placeholder")})}),p.jsxs(Hr,{children:[p.jsx(Sn,{value:"string",children:r("add_schema_card.types.string")}),p.jsx(Sn,{value:"boolean",children:r("add_schema_card.types.boolean")}),p.jsx(Sn,{value:"number",children:r("add_schema_card.types.number")}),p.jsx(Sn,{value:"object",children:r("add_schema_card.types.object")}),p.jsx(Sn,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),p.jsxs("div",{className:"flex items-center h-10",children:[p.jsx(Qe,{children:r("add_schema_card.field.required")}),p.jsx(R5,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),y?p.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[p.jsx(Qe,{children:r("add_schema_card.children")}),p.jsx(D5,{data:(i==null?void 0:i.data)||[],setData:h})]}):null,(i==null?void 0:i.type)==="enum"?p.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[p.jsx(Qe,{children:r("add_schema_card.field.enum")}),p.jsx(dn,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:p.jsx("div",{className:"w-full flex justify-end mt-2",children:p.jsx(at,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:f,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),D5=g.memo(({data:e,setData:t})=>p.jsxs(HD,{type:"single",collapsible:!0,children:[e.map(n=>p.jsxs(qx,{value:`${n.id}`,children:[p.jsx(Yx,{children:n.name}),p.jsx(Kx,{children:p.jsx(I5,{setData:t,data:e,id:n.id})})]},n.id||"new")),p.jsx(Tt,{className:"p-2 mt-4",children:p.jsx(I5,{setData:t,data:e})})]})),Sie=g.memo(e=>{const{t}=Me("components"),{id:n}=e,r=ln(n),[o,a]=g.useState([]),{createSchema:i,loading:s}=xie(),c=async()=>{if(r&&(o!=null&&o.length))try{await i(r,o),a([])}catch(l){tc({variant:"destructive",title:`${l}`})}};return p.jsxs(Tt,{className:"max-w-lg",children:[p.jsx(hn,{children:p.jsx(En,{children:t("add_schema_card.title")})}),p.jsx(mn,{className:"min-w-96",children:p.jsx(D5,{setData:a,data:o})}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{loading:s,disabled:!(o!=null&&o.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),L5=()=>{const e=Je(a=>{var i;return(i=a.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=Ae(a=>a.createOrUpdateFlowNode),o=g.useCallback(async(a,i,s)=>{var c,l,u;try{if(!a||!e)throw new Error("Source or Session not found");n(!0);const d=((c=a.position)==null?void 0:c.x)||0,f=(((l=a.position)==null?void 0:l.y)||0)+(((u=a.measured)==null?void 0:u.height)||0),h=zwe(i,s),y=await ce("CSVData").save({headers:h.headers,csv:h.data,session_id:e});if(!y)throw new Error("Failed to save");if(!await r({source_id:y.id,source_type:"CSVData",node_type:oe.CSVData,x:d,y:f+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:o}};function Cie({data:e}){const{t}=Me("components");return p.jsxs(rp,{className:"w-full",children:[p.jsx(op,{children:p.jsxs(Ua,{children:[p.jsx(cs,{children:t("add_few_shot_example_card.input")}),p.jsx(cs,{children:t("add_few_shot_example_card.output")})]})}),p.jsx(ap,{children:e==null?void 0:e.map((n,r)=>p.jsxs(Ua,{children:[p.jsx(ls,{className:"p-4",children:n.input}),p.jsx(ls,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const Oie=g.memo(e=>{const{id:t}=e,{t:n}=Me("components"),[r,o]=g.useState([]),[a,i]=g.useState(""),[s,c]=g.useState(""),l=ln(t),{createCSVData:u,loading:d}=L5(),f=()=>{o(y=>[...y,{input:a,output:s}]),i(""),c("")},h=async()=>{l&&await u(l,["input","output"],r.map(y=>[y.input,y.output]))};return p.jsxs(Tt,{className:"mw-full",children:[p.jsx(hn,{children:p.jsx(En,{children:n("add_few_shot_example_card.title")})}),p.jsxs(mn,{children:[p.jsxs("div",{className:"flex flex-col space-y-1.5",children:[p.jsx(Qe,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),p.jsx(dn,{value:a,onChange:y=>i(y.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),p.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[p.jsx(Qe,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),p.jsx(ho,{value:s,onChange:y=>c(y.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),p.jsx("div",{className:"w-full flex mt-4 justify-end",children:p.jsx(at,{disabled:!a||!s,onClick:f,className:"w-40",children:n("add_few_shot_example_card.add")})}),p.jsx(Cie,{data:r||[]})]}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{loading:d,disabled:!(r!=null&&r.length),onClick:h,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),Nie=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.createOrUpdateFlowNode),o=Ae(i=>i.createOrUpdateFlowEdge),a=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,h=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ce("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!y)throw new Error("Failed create tool.");const m=await r({source_id:y.id,source_type:"ToolDefinition",node_type:oe.ToolDefinition,x:f,y:h+20});if(!m)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await o({source:c.schemaNode.id,target:m.id})}finally{n(!1)}},[e,r,o]);return{loading:t,createTool:a}},Mie=g.memo(e=>{const{t}=Me("components"),{toast:n}=Bt(),{id:r}=e,o=ln(r),[a,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=Nie(),d=y=>{i(y.target.value)},f=y=>{c(y.target.value)},h=async()=>{if(o&&a&&s)try{await l(o,{name:a,description:s}),i(""),c("")}catch(y){Or(y),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return p.jsxs(Tt,{className:"mw-full",children:[p.jsx(hn,{children:p.jsx(En,{children:t("add_tool_card.title")})}),p.jsxs(mn,{children:[p.jsxs("div",{className:"flex flex-col space-y-1.5",children:[p.jsx(Qe,{htmlFor:"name",children:t("add_tool_card.tool_name")}),p.jsx(dn,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),p.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[p.jsx(Qe,{htmlFor:"name",children:t("add_tool_card.tool_description")}),p.jsx(ho,{onChange:f,placeholder:t("add_tool_card.description_placeholder")})]})]}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{loading:u,onClick:h,className:"w-full",children:t("add_tool_card.create")})})]})}),kie=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.createOrUpdateFlowNode),o=Ae(i=>i.createOrUpdateFlowEdge),a=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,h=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ce("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||Vwe.Local,storage:s.storage||tr.DatabaseNode,raw:"",provider:s.provider||H9.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!y)throw new Error("Failed to save vectorDatabase");const m=await r({source_id:y.id,source_type:"VectorDatabase",node_type:oe.VectorDatabase,x:f,y:h+30});if(!m)throw new Error("Failed to save vectorDatabase node");if(s.storage===tr.DataNode){const v=await ce("JSONLData").save({headers:Uwe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:oe.JSONLData,x:f+80,y:h+30});if(!b)throw new Error("Failed to save databaseSource node");await o({source:b.id,target:m.id})}return{vectorDatabase:y,vectorDatabaseNode:m}}finally{n(!1)}},[e,r,o]);return{loading:t,createVectorDatabase:a}},Il=[H9.Memory],Dl=[tr.DatabaseNode],Pie=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],Aie=g.memo(e=>{const{t}=Me("components"),{id:n}=e,r=ln(n),{toast:o}=Bt(),[a,i]=g.useState(""),[s,c]=g.useState(Il[0]),[l,u]=g.useState(Dl[0]),[d,f]=g.useState({}),{loading:h,createVectorDatabase:y}=kie(),m=g.useCallback(E=>{c(E)},[]),v=g.useCallback(E=>{u(E)},[]),b=g.useCallback(E=>{f(S=>({...S,type:E,chunkSize:500,chunkOverlap:40}))},[]),x=g.useCallback(E=>{i(E.target.value||"")},[]),_=g.useCallback(E=>{f(S=>({...S,chunkSize:Number(E.target.value)}))},[]),w=g.useCallback(E=>{f(S=>({...S,chunkOverlap:Number(E.target.value)}))},[]),j=async()=>{try{if(!r)return;await y(r,{name:a,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),f({})}catch{o({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return p.jsxs(Tt,{className:"mw-full",children:[p.jsx(hn,{children:p.jsx(En,{children:t("create_vector_database_card.title")})}),p.jsx(mn,{children:p.jsxs("div",{className:"grid w-full gap-1.5",children:[p.jsx(Qe,{children:t("create_vector_database_card.name")}),p.jsx(dn,{className:"mb-4",value:a,onChange:x}),(Dl==null?void 0:Dl.length)>1?p.jsxs(p.Fragment,{children:[p.jsx(Qe,{children:t("create_vector_database_card.storage_type")}),p.jsxs(Eo,{value:l,onValueChange:v,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),p.jsx(Hr,{children:Object.values(Dl).map(E=>p.jsx(Sn,{value:E,children:t(`create_vector_database_card.storage_types.${E.toLowerCase()}`)},E))})]})]}):void 0,(Il==null?void 0:Il.length)>1?p.jsxs(p.Fragment,{children:[p.jsx(Qe,{children:t("create_vector_database_card.provider")}),p.jsxs(Eo,{value:s,onValueChange:m,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),p.jsx(Hr,{children:Object.values(Il).map(E=>p.jsx(Sn,{value:E,children:t(`create_vector_database_card.providers.${E.toLowerCase()}`)},E))})]})]}):void 0,p.jsx(Qe,{children:t("create_vector_database_card.text_splitter")}),p.jsxs(Eo,{value:d.type,onValueChange:b,children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),p.jsx(Hr,{children:Object.values(Pie).map(E=>p.jsx(Sn,{value:E,children:t(`create_vector_database_card.text_splitters.${E.toLowerCase()}`)},E))})]}),d.type?p.jsxs(Tt,{children:[p.jsx(hn,{children:p.jsx(En,{children:t("create_vector_database_card.text_splitter_configuration")})}),p.jsxs(mn,{children:[p.jsx(Qe,{children:t("create_vector_database_card.text_splitter_chunksize")}),p.jsx(dn,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),p.jsx(Qe,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),p.jsx(dn,{value:d.chunkOverlap,onChange:w,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{disabled:!d.type||!a,loading:h,onClick:j,className:"w-full",children:t("create_vector_database_card.create")})})]})});function Tie({data:e}){const{t}=Me("components");return p.jsxs(rp,{className:"w-full",children:[p.jsx(op,{children:p.jsx(Ua,{children:p.jsx(cs,{children:t("add_text_data.text")})})}),p.jsx(ap,{children:e==null?void 0:e.map((n,r)=>p.jsx(Ua,{children:p.jsx(ls,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const Rie=g.memo(e=>{const{id:t}=e,{t:n}=Me("components"),[r,o]=g.useState([]),[a,i]=g.useState(""),s=ln(t),{createCSVData:c,loading:l}=L5(),u=()=>{o(f=>[...f,{text:a}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(f=>[f.text]))};return p.jsxs(Tt,{className:"mw-full",children:[p.jsx(hn,{children:p.jsx(En,{children:n("add_text_data.title")})}),p.jsxs(mn,{children:[p.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[p.jsx(Qe,{htmlFor:"name",children:n("add_text_data.text")}),p.jsx(ho,{value:a,onChange:f=>i(f.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),p.jsx("div",{className:"w-full flex mt-4 justify-end",children:p.jsx(at,{disabled:!a,onClick:u,className:"w-40",children:n("add_text_data.add")})}),p.jsx(Tie,{data:r||[]})]}),p.jsx(ra,{className:"flex justify-between",children:p.jsx(wn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var Oo=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(Oo||{});const Iie=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],Die=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let F5=0;const Lie=(e,t)=>{F5++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],o=45;let a=[],i=!1,s=0,c=0;const l=Die();function u(){const S=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,k=(t==null?void 0:t.speedUp)||Math.random()*25,N=Math.random()*360,P=Math.random()*35*(Math.random()<=.5?-1:1),R=c-S/2,A=s-S/2,C=Math.random()<=.5?-1:1,M=document.createElement("div");if(n==="circle"){const T="http://www.w3.org/2000/svg",D=document.createElementNS(T,"svg"),I=document.createElementNS(T,"circle");I.setAttributeNS(null,"cx",(S/2).toString()),I.setAttributeNS(null,"cy",(S/2).toString()),I.setAttributeNS(null,"r",(S/2).toString()),I.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),D.appendChild(I),D.setAttribute("width",S.toString()),D.setAttribute("height",S.toString()),M.appendChild(D)}else M.innerHTML=`<img src="${n}" width="${S}" height="${S}" style="border-radius: 50%">`;M.style.position="absolute",M.style.transform=`translate3d(${A}px, ${R}px, 0px) rotate(${N}deg)`,l.appendChild(M),a.push({direction:C,element:M,left:A,size:S,speedHorz:O,speedUp:k,spinSpeed:P,spinVal:N,top:R})}function d(){a.forEach(S=>{S.left=S.left-S.speedHorz*S.direction,S.top=S.top-S.speedUp,S.speedUp=Math.min(S.size,S.speedUp-1),S.spinVal=S.spinVal+S.spinSpeed,S.top>=Math.max(window.innerHeight,document.body.clientHeight)+S.size&&(a=a.filter(O=>O!==S),S.element.remove()),S.element.setAttribute("style",["position:absolute","will-change:transform",`top:${S.top}px`,`left:${S.left}px`,`transform:rotate(${S.spinVal}deg)`].join(";"))})}let f,h=0;const y=30;function m(){const S=performance.now();i&&a.length<o&&S-h>y&&(u(),h=S),d(),f=requestAnimationFrame(m)}m();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",x=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",w=S=>{var O,k;"touches"in S?(s=(O=S.touches)==null?void 0:O[0].clientX,c=(k=S.touches)==null?void 0:k[0].clientY):(s=S.clientX,c=S.clientY)},j=S=>{w(S),i=!0},E=()=>{i=!1};return e.addEventListener(_,w,{passive:!0}),e.addEventListener(b,j,{passive:!0}),e.addEventListener(x,E,{passive:!0}),e.addEventListener("mouseleave",E,{passive:!0}),()=>{e.removeEventListener(_,w),e.removeEventListener(b,j),e.removeEventListener(x,E),e.removeEventListener("mouseleave",E);const S=setInterval(()=>{f&&a.length===0&&(cancelAnimationFrame(f),clearInterval(S),--F5===0&&l.remove())},500)}},Fie=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return Lie(n.current,t)},[t]),V.cloneElement(e,{ref:n})},Bie=g.memo(e=>{const{t}=Me("flows"),n=$u(s=>s.theme),[r,o]=g.useState(`${Oo.ADD_LLM}`),a=g.useMemo(()=>p.jsxs(e5,{children:[p.jsx(fw,{children:p.jsx(Fie,{children:p.jsx(at,{variant:"link",className:"!p-0 !pl-3",children:p.jsx(Hwe,{width:32,height:32,className:K(n==="dark"?"fill-white":"fill-black")})})})}),Iie.map(s=>typeof s=="object"?p.jsxs(fw,{children:[p.jsx(pw,{children:s.icon?p.jsx(le,{name:s.icon}):t(`supported_nodes.${s.label}`)}),p.jsx(t5,{children:s.children.map(c=>p.jsx(n5,{onClick:()=>o(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):p.jsx(fw,{children:p.jsx(pw,{value:s,onClick:()=>o(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case Oo.ADD_LLM:return p.jsx(yie,{...e});case Oo.ADD_PROMPT:return p.jsx(bie,{...e});case Oo.ADD_SCHEMA:return p.jsx(Sie,{...e});case Oo.ADD_FEW_SHOT_EXAMPLE:return p.jsx(Oie,{...e});case Oo.ADD_TOOL_DEFINITION:return p.jsx(Mie,{...e});case Oo.ADD_VECTOR_DATABASE:return p.jsx(Aie,{...e});case Oo.ADD_TEXT_DATA:return p.jsx(Rie,{...e})}},[e,r]);return p.jsxs(p.Fragment,{children:[a,p.jsx("div",{className:"mt-4",children:i})]})}),$ie=Jr("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),No=g.forwardRef(({className:e,variant:t,...n},r)=>p.jsx("div",{ref:r,role:"alert",className:K($ie({variant:t}),e),...n}));No.displayName="Alert";const Mo=g.forwardRef(({className:e,...t},n)=>p.jsx("h5",{ref:n,className:K("mb-1 font-medium leading-none tracking-tight",e),...t}));Mo.displayName="AlertTitle";const ps=g.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:K("text-sm [&_p]:leading-relaxed",e),...t}));ps.displayName="AlertDescription";let B5,$5,z5,nn,Ze,V5,U5,H5,W5,fp,Ow,Nw,Mw,q5,Y5,kw,K5,X5,Q5;B5=()=>{const[e,t]=g.useState(!1),n=Je(i=>i.currentSession),r=Je(i=>i.getLatestApplications),o=g.useCallback(async(i,s,c,l)=>{var f;const u=(f=s.data)==null?void 0:f.entity;let d=s.type?Wwe[s.type]:void 0;if(d&&u&&s&&typeof u=="object"&&"id"in u&&!c.has(`${u.id}`)&&!l.has(`${s.id}`)){d=d;const h=await ce(d).save({...u,...u&&typeof u=="object"&&"session_id"in u?{session_id:i.id}:{}});c.set(`${u.id}`,h.id);const y=await ce("FlowNode").findOne({where:{id:s.data.flowNode.id}}),m=await ce("FlowNode").save({...y||s.data.flowNode,session_id:i.id,id:void 0,source_type:d,source_id:h.id});return l.set(`${s.id}`,m.id),{entityName:d,entity:h,node:m}}else if(!l.has(`${s.id}`)){const h=await ce("FlowNode").findOne({where:{id:s.data.flowNode.id}}),y=await ce("FlowNode").save({...h||s.data.flowNode,node_type:s.type,session_id:i.id,id:void 0});return l.set(`${s.id}`,y.id),{node:y}}},[]),a=g.useCallback(async(i,s)=>{try{if(!n)throw new Error("No current session");t(!0);const c=await ce("Session").save({type:Zs.StandaloneApp,name:s.name||(n!=null&&n.name?`${n.name}`:"Standalone"),status:qwe.Started});if(!c)throw new Error("Failed create standalone session");const l=new Map,u=new Map,d=await o(c,i,l,u);if(!d)throw new Error("Failed to clone main node");await ce("Session").update(c.id,{main_node_id:d.node.id,main_source_id:d!=null&&d.entity?d.entity.id:void 0,main_source_type:d.entityName?d.entityName:void 0});for(const{node:f,connectedNodes:h}of s.connections)if(await o(c,f,l,u),h)for(const y of h)await o(c,y,l,u);for(const{connections:f}of s.connections)for(const h of f){const y=u.get(`${h.source}`),m=u.get(`${h.target}`);if(!y||!m)throw new Error("Failed to get connected flow node id");await ce("FlowEdge").save({source:y,target:m,sourceHandle:h.sourceHandle,targetHandle:h.targetHandle,session_id:c.id})}return r(),!0}finally{t(!1)}},[o,n,r]);return{loading:e,createStandaloneSession:a}},$5=()=>{const[e,t]=g.useState(!1),n=Ae(a=>a.updateNodes),r=Ae(a=>a.updateEdges),o=g.useCallback(async a=>{try{t(!0),await ce("FlowNode").delete(a);const i=await ce("FlowEdge").find({where:[{source:a},{target:a}]});return await Promise.all(i.map(s=>ce("FlowEdge").delete(s.id))),await n([{id:a,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:o}},z5=ba(({cloneStandaloneSession:e})=>{const t=Kt(),{t:n}=Me("dialogs"),[r,o]=g.useState(""),{toast:a}=Bt(),i=c=>{o(c.target.value)},s=async()=>{try{t.hide(),await e(r),o("")}catch{a({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return p.jsx(Ri,{open:t.visible,onOpenChange:t.hide,children:p.jsxs(Ma,{className:"sm:max-w-[425px]",children:[p.jsxs(ka,{children:[p.jsx(Pa,{children:n("create_session.title")}),p.jsx(ag,{children:n("create_standalone_application.description")})]}),p.jsx("div",{className:"grid gap-4 py-4",children:p.jsxs("div",{className:"flex flex-col space-y-1.5",children:[p.jsx(Qe,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),p.jsx(dn,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),p.jsx(og,{children:p.jsx(at,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),nn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:o}=Me("common"),{getNode:a}=Fn(),{loading:i,deleteNodeFlow:s}=$5(),{createStandaloneSession:c}=B5(),{toast:l}=Bt(),u=Kt(z5),d=g.useCallback(async()=>{try{await s(e),l({description:o("deleted")})}catch{l({description:o("errors.delete_failed"),variant:"destructive"})}},[s,e,l,o]),f=g.useCallback(async y=>{try{const m=a(e);if(!m)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(m,{name:y,connections:v}),l({description:o("standalone_session_created")})}catch(m){Yh(m),l({description:o("errors.create_standalone_session_failed"),variant:"destructive"})}},[a,e,r,c,l,o]),h=g.useCallback(()=>{u.show({cloneStandaloneSession:f})},[f,u]);return p.jsxs("div",{className:K("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?p.jsx(at,{className:"!rounded-none !px-2",onClick:h,variant:"ghost",children:p.jsx(le,{name:"package-plus",size:16})}):void 0,p.jsx(wn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:p.jsx(le,{name:"trash-2",size:16})})]})}),Ze=g.memo(e=>{const{className:t,...n}=e;return p.jsx(_l,{className:K("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===fe.Top?"!top-[-2px]":"",t),...n})}),V5=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.createOrUpdateFlowNode),o=Ae(i=>i.createOrUpdateFlowEdge),a=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),f=await ce("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:Ju.Started,messages:[],session_id:e}),h=await r({source_id:f.id,source_type:"Thread",node_type:oe.Thread,x:u,y:d+60});if(!h)throw new Error("Failed to create thread node");const y=await o({source:i.id,target:h.id});return{thread:f,flowNode:h,flowEdge:y}}finally{n(!1)}},[o,r,e]);return{loading:t,createThread:a}},U5=(e,t)=>{var x;const{t:n}=Me("flows"),{toast:r}=Bt(),[o,a]=g.useState(!1),[i,s]=g.useState(!1),c=ln(e),l=sn(_=>_.loadModel),{createThread:u,loading:d}=V5(),f=Ae(_=>_.updateNodes),h=Ae(_=>_.pushSyncNodeQueue),{getNodes:y}=Fn(),m=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const _=await ce("Thread").find({where:{initial_llm_id:t.entity.id}});h("Thread",{where:{source_type:"Thread",source_id:Vr(_.map(w=>w.id))}})}}finally{s(!1)}},[(x=t==null?void 0:t.entity)==null?void 0:x.id,h]),v=g.useCallback(async()=>{try{if(a(!0),t.entity&&c){await(l==null?void 0:l(`${t.entity.name}`));const _=y().filter(w=>w.type===oe.LLM).map(w=>(w.data.status=et.Started,{id:w.id,type:"replace",item:w}));c.data.status=et.Loading,_.push({id:e,type:"replace",item:c}),f(_),await m()}}catch(_){Or(_),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{a(!1)}},[t.entity,y,e,l,c,m,n,r,f]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return{loadingModel:o,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:m}},cn=(e,t)=>{const[n,r]=g.useState(!1),[o,a]=g.useState([]),{deleteElements:i,getNode:s}=Fn();$f({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&a(u=>[...u,...Wne(l)])}});const c=g.useCallback(async(l,u,d,f)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:f})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(o!=null&&o.length)||n||(async()=>{try{r(!0);const l=[...o];a([]);const u=[],d=s(e);await Promise.all(l.map(async f=>{const h="edgeId"in f?f.edgeId:void 0,y=s(f.source);if(!y||!d)return;const m=await c(`${h}`,y,d,f);m!=null&&m.deleteEdgeId&&u.push(...Array.isArray(m.deleteEdgeId)?m.deleteEdgeId:[m.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(f=>({id:f}))})}finally{r(!1)}})()},[i,s,e,n,c,o])},H5=e=>{const t=g.useCallback(async()=>{},[]);cn(e,t)},W5=g.memo(e=>{var m,v,b,x;const{id:t,data:n,isConnectable:r}=e,[o,a]=g.useState(),{t:i}=Me("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=U5(t,n);H5(t);const f=[et.Loading,et.Downloading].includes(n.status);g.useEffect(()=>{var _;o||!((_=n==null?void 0:n.entity)!=null&&_.name)||Nt(()=>import("./index-BG3xyZmB.js").then(async w=>(await w.__tla,w)),__vite__mapDeps([7,1,2,3,4,5,6])).then(async({hasModelInCache:w,functionCallingModelIds:j,prebuiltAppConfig:E})=>{var O,k;const S=await w((O=n==null?void 0:n.entity)==null?void 0:O.name);a({hasCache:S,isFunctionCalling:j.includes((k=n==null?void 0:n.entity)==null?void 0:k.name),info:E.model_list.find(N=>{var P;return N.model_id===((P=n==null?void 0:n.entity)==null?void 0:P.name)})})})},[(m=n==null?void 0:n.entity)==null?void 0:m.name,o]);const h=g.useMemo(()=>{var _,w;switch(n.status){case et.Downloading:return p.jsx(le,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case et.Loaded:return p.jsx(jo,{name:((_=n.entity)==null?void 0:_.name)||"brain",className:"w-7 h-7"});case et.Loading:return p.jsx(le,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return p.jsx(jo,{name:((w=n.entity)==null?void 0:w.name)||"brain",className:"w-7 h-7"})}},[(v=n.entity)==null?void 0:v.name,n.status]),y=g.useMemo(()=>f?null:d?p.jsx(at,{disabled:!0,className:"w-full mt-4",children:p.jsx(le,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===et.Loaded?p.jsx(at,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):p.jsxs("div",{className:"flex gap-2 mt-4",children:[o!=null&&o.hasCache?p.jsx(wn,{loading:l,onClick:u,children:p.jsx(le,{size:24,name:"message-square-more"})}):null,p.jsx(at,{disabled:d,onClick:c,className:"w-full",children:i(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[f,d,n.status,o==null?void 0:o.hasCache,l,u,c,i,s]);return p.jsxs("div",{children:[p.jsxs("div",{children:[p.jsx(nn,{id:t}),p.jsxs(No,{className:"flex justify-center",children:[h,p.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[p.jsx(Mo,{className:"flex gap-2 items-center pr-6",children:`${((b=n==null?void 0:n.entity)==null?void 0:b.name)||""}`}),p.jsx(ps,{className:"max-w-full",children:`${n.label||""}`}),p.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:p.jsx(Nl,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:(x=n==null?void 0:n.entity)==null?void 0:x.name,isCached:(o==null?void 0:o.hasCache)||!1})}),y]})]}),f?p.jsx(Xx,{className:"rounded-lg"}):void 0]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),fp=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:o}=Me("components"),a=async i=>{try{return await r(i),!0}catch{return!1}};return p.jsxs(Tt,{className:"min-w-80",children:[p.jsx(hn,{children:p.jsx(En,{children:o("add_message_card.title")})}),p.jsxs(mn,{children:[p.jsx("div",{className:"grid w-full gap-1.5",children:p.jsx(fk,{onSubmit:a,disabled:t||n,placeholder:o("add_message_card.placeholder")})}),e?p.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),Ow=(e,t,n,r=[],o)=>{const a=e.map(i=>o.getNode(i));for(const i of a){if(!i)continue;const s=o.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===oe.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==oe.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&Ow(s.map(c=>c.source),t,n,r,o)}return{nodes:t,connections:n}},Nw=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const f=t.getNode(d.source);return f?{connections:t.getHandleConnections({nodeId:f.id,type:"target"}),node:f}:void 0}),o=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Prompt}),a=[];o!=null&&o.length&&o.forEach(d=>{var h;const f=(h=d.connections)==null?void 0:h.map(y=>t.getNode(y.source)).filter(Boolean);a.push({node:d.node,connections:d.connections,connectedNodes:f})});const i=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var h;const f=(h=d.connections)==null?void 0:h.map(y=>t.getNode(y.source)).filter(Boolean);f!=null&&f.find(y=>y.type===oe.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:f})});const c=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var h;const f=(h=d.connections)==null?void 0:h.map(y=>t.getNode(y.source)).filter(Boolean);f&&l.push({node:d.node,connections:d.connections,connectedNodes:f})});const u=r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.LLM}),schemas:u?[u]:[],prompts:a,tools:s,placeholders:l}},Mw=e=>{const t=[];return e.forEach(n=>{var a,i,s;const{node:r,connectedNodes:o}=n;if((a=r.data)!=null&&a.entity){if(r.type===oe.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Vu(c.content));break;case"ai":t.push(new Uu(c.content));break}}else if(r.type===oe.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===Pn.FewShotExample){const u=(s=(i=o.find(d=>d.type===oe.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=W9(u.headers,u.csv);d.forEach(f=>{l+=`${c.content.replace(/{([^{}]*)}/g,(h,y)=>`${f[y]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Vu(l));break;case"system":t.push(new V9(l));break;default:t.push(new Uu(l));break}}}}),t},q5=(e,t)=>{const n=(e==null?void 0:e.filter(o=>o.type===oe.Message).map(o=>({node:o,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async o=>{r.unshift({node:o.node,connectedNodes:o.connectedNodes||[]})}),{history:Mw(n),systems:Mw(r)}},Y5=e=>e?e.reduce((t,n)=>{var a,i,s,c,l;const r=(a=n.node.data)==null?void 0:a.entity,o=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===oe.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=o==null?void 0:o.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:o.schema_items}),t},[]):[],kw=({getNode:e,getHandleConnections:t})=>{const{t:n}=Me("create_new_message"),[r,o]=g.useState(!1),a=Je(m=>m.currentSession),i=Ae(m=>m.createOrUpdateFlowNode),s=Ae(m=>m.createOrUpdateFlowEdge),c=fi(m=>m.similaritySearchWithScore),l=sn(m=>m.getCurrentModelInfo),{stream:u}=Zm(),d=g.useCallback(async({content:m,threadId:v,sourceId:b,initialX:x,initialY:_,initialLLMId:w})=>{if(!a)throw new Error("Session is not found");const j=await ce("Message").save({thread_id:v,content:m,role:kn.Human,status:eo.Started,llm_id:w,session_id:a.id});if(!j)throw new Error("Failed to save message");const E=await i({source_id:j.id,source_type:"Message",node_type:oe.Message,x,y:_+80});if(!E)throw new Error("Failed to save human message node");await s({source:b,target:E.id});const S=await ce("Message").save({thread_id:v,content:n("initial_ai_message"),role:kn.AI,status:eo.Inprogress,llm_id:w,parent_message_id:j.id,session_id:a.id});if(!S)throw new Error("Failed to save message");const O=await i({source_id:S.id,source_type:"Message",node_type:oe.Message,x,y:_+250});if(!O)throw new Error("Failed to save ai message node");return await s({source:E.id,target:O.id}),{aiMessage:S,humanMessage:j,aiMessageNode:O,humanMessageNode:E}},[s,i,a,n]),f=g.useCallback(async(m,v)=>{const{placeholders:b}=v;if(!(b!=null&&b.length))return[];const x=[];return await Promise.all(b.map(async _=>{var j,E,S,O,k,N,P,R,A,C,M,T;const w=(j=_.node.data)==null?void 0:j.entity;if(w)switch(w.placeholder_type){case bi.VECTOR_DATABASE_RETREIVER:{const D=(E=_.connectedNodes)==null?void 0:E.find(J=>J.type===oe.VectorDatabase),I=(S=D==null?void 0:D.data)==null?void 0:S.entity,L=(N=(k=(O=_.connectedNodes)==null?void 0:O.find(J=>J.type===oe.Prompt))==null?void 0:k.data)==null?void 0:N.entity;if(!L||!I||!D)return;const B=(P=w.metadata)!=null&&P.k?+((R=w.metadata)==null?void 0:R.k):1;let U=(A=w.metadata)!=null&&A.minimalScore?+((C=w.metadata)==null?void 0:C.minimalScore):void 0;U&&U>1&&(U=U/100);const F=[];if(I.storage===tr.DataNode){const J=(T=(M=t({nodeId:D.id,type:"target"}).map(q=>e(q.source)).find(q=>(q==null?void 0:q.type)&&[oe.JSONLData,oe.CSVData].includes(q==null?void 0:q.type)))==null?void 0:M.data)==null?void 0:T.entity;if(!J)return;F.push(...await c({databaseId:I.id,dataSourceId:J.id,dataSourceType:OE(J)},m.humanMessage.content,B))}else F.push(...await c({databaseId:I.id},m.humanMessage.content,B));if(!F)return[];const H=new Ho({template:L.content,inputVariables:["context"]});x.push(new Uu(await H.format({context:U?F.filter(([,J])=>J>=U).map(([J])=>J.pageContent).join(`
`):F.map(([J])=>J.pageContent).join(`
`)})))}}})),x},[t,e,c]),h=g.useCallback(async(m,v,b,{onMessageUpdate:x})=>{const{prompts:_,tools:w,schemas:j,placeholders:E}=v,S=[];E!=null&&E.length&&S.push(...await f(m,v));const{history:O,systems:k}=q5(b,_),N=[...k,...S,...O,new Vu(m.humanMessage.content)],P=j.map(C=>{var M;return(M=C.node.data)==null?void 0:M.entity}).filter(Boolean),{lastChunk:R,content:A}=await u(N,{tools:Y5(w),schemas:P,onMessageUpdate:({content:C})=>{x==null||x({id:m.aiMessageNode.id,nodeData:{loading:!0,content:C}})}});return m.aiMessage.content=A,m.aiMessage.metadata=JSON.stringify({message:R}),x==null||x({id:m.aiMessageNode.id,nodeData:{content:A,loading:!1,entity:m.aiMessage}}),m.aiMessage.id&&await ce("Message").update(m.aiMessage.id,{content:A,metadata:JSON.stringify({message:R})}),A},[f,u]),y=g.useCallback(async(m,v,b)=>{var S,O,k;const{nodes:x}=Ow([m.id],[],[],[],{getNode:e,getHandleConnections:t}),_=x.find(N=>N.type===oe.Thread),w=_==null?void 0:_.data.entity;if(!m||!w||!_)throw new Error("Source or thread is not found");if(!await l())throw new Error("Model is not loaded yet");const j=Nw(_,{getNode:e,getHandleConnections:t});if(!(j!=null&&j.thread))throw new Error("Thread node is not found");let E;try{o(!0);const N=((S=m.position)==null?void 0:S.x)||0,P=(((O=m.position)==null?void 0:O.y)||0)+(((k=m.measured)==null?void 0:k.height)||0);return E=await d({content:v,initialX:N,initialY:P,sourceId:m.id,threadId:w.id,initialLLMId:w.initial_llm_id}),await h(E,j,x,b),await ce("Message").update(`${E.aiMessage.id}`,{status:eo.Success}),E.aiMessage.status=eo.Success,b.onMessageUpdate({id:E.aiMessageNode.id,nodeData:{entity:E.aiMessage,loading:!1}}),!0}catch{E!=null&&E.aiMessage&&await ce("Message").update(`${E.aiMessage.id}`,{status:eo.Failed,content:n("errors.ai_message_content_failed")}),E!=null&&E.aiMessageNode.id&&(b==null||b.onMessageUpdate({id:E.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),loading:!1}}))}finally{o(!1)}},[l,t,e,d,h,n]);return{loading:r,createMessage:y}},K5=(e,t)=>{const n=ln(e),{t:r}=Me("flows"),{getNode:o,getHandleConnections:a}=Fn(),i=Ae(f=>f.updateNodes),{createMessage:s,loading:c}=kw({getNode:o,getHandleConnections:a}),l=g.useCallback(f=>{if(!f.id)return;const h=o(f.id);!h||!f.nodeData||i([{id:h.id,type:"replace",item:{...h,data:{...h.data,...el(f.nodeData,tl)}}}])},[o,i]),u=g.useCallback(async f=>{if(n&&t.entity)try{await s(n,f,{onMessageUpdate:l})}catch(h){if(h instanceof Error&&h.message.includes("LLM_NOT_LOADED_YET"))return tc({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});tc({variant:"destructive",title:`${h}`})}},[n,t.entity,s,l,r]),d=g.useCallback(f=>{const h=o(f);if(!h)return[];const y=[],m=Nw(h,{getNode:o,getHandleConnections:a});return m.thread&&y.push({node:m.thread.node,connectedNodes:[],connections:m.thread.connections}),m.prompts&&y.push(...m.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),m.schemas&&y.push(...m.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),m.placeholders&&m.placeholders.forEach(v=>{const b=v.connections.map(x=>o(x.source)).filter(Boolean);y.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),m.llm&&y.push(m.llm),y},[a,o]);return{loading:c,createMessage:u,getLinkedConnections:d}},X5=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if((o==null?void 0:o.type)===oe.Prompt&&(a==null?void 0:a.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((o==null?void 0:o.type)===oe.LLM&&(a==null?void 0:a.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((o==null?void 0:o.type)===oe.Schema&&(a==null?void 0:a.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((o==null?void 0:o.type)===oe.ToolDefinition&&(a==null?void 0:a.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((o==null?void 0:o.type)===oe.VectorDatabase&&(a==null?void 0:a.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((o==null?void 0:o.type)===oe.PlaceHolder&&(a==null?void 0:a.type)===oe.Thread&&o.data.entity.placeholder_type===bi.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},Q5=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:o}=Me("flows"),[a,i]=g.useState(!1),s=$f({type:"source"}),c=$f({type:"target"}),{getNode:l}=Fn(),{loading:u,createMessage:d,getLinkedConnections:f}=K5(t,n);X5(t);const h=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),y=g.useMemo(()=>s.length>0,[s]),m=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var x,_;const b=c.map((w,j)=>{var S;const E=l(w.source);if((E==null?void 0:E.type)===oe.Schema)return p.jsx(tn,{children:o("thread_node.structured_output")},`${j}`);if((E==null?void 0:E.type)===oe.Prompt){const O=E.data.entity;return p.jsx(tn,{children:o(O.type===Pn.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${j}`)}else if((E==null?void 0:E.type)===oe.PlaceHolder&&((S=E.data.entity)==null?void 0:S.placeholder_type)===bi.VECTOR_DATABASE_RETREIVER)return p.jsx(tn,{children:o("thread_node.vector_database_retriever")},`${j}`)}).filter(Boolean);return e.data.entity&&!((_=(x=e.data.entity)==null?void 0:x.messages)!=null&&_.length)&&!y?p.jsx(fp,{disabled:u,loading:u,onSubmit:h,tags:b}):b!=null&&b.length?p.jsxs(Tt,{className:"p-4 pt-2",children:[p.jsx(En,{className:"mb-2",children:o("thread_node.title")}),p.jsx("div",{className:"flex gap-1.5",children:b}),p.jsx("div",{className:"mt-4 w-full flex justify-end",children:p.jsxs(at,{onClick:m,variant:"outline",children:[p.jsx(le,{name:a?"copy-minus":"copy-plus"}),o(a?"thread_node.hide":"thread_node.clone")]})})]}):p.jsx("div",{className:"w-12 h-10"})},[y,l,h,m,u,e.data.entity,a,o,c]);return p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs("div",{children:[p.jsx(nn,{id:t,enableToStandalone:!0,getLinkedConnections:f}),v,a?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),p.jsx("div",{className:"absolute mt-[30px] w-full",children:p.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:p.jsx(fp,{disabled:u,loading:u,onSubmit:h})})})]}):void 0]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});function zie({data:e,onNewThread:t,loading:n,showThread:r}){var a;const{t:o}=Me("flows");return p.jsxs(No,{className:"flex min-w-52",children:[p.jsx(le,{size:24,name:"user"}),p.jsxs("div",{className:"ml-2 max-w-full w-full",children:[p.jsx(Mo,{children:"Human"}),p.jsx(ps,{children:`${e.content||((a=e.entity)==null?void 0:a.content)||""}`}),t?p.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:p.jsxs(at,{onClick:t,disabled:n,variant:"outline",children:[p.jsx(le,{name:r?"minus":"plus",size:16}),o(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}const Vie=g.lazy(()=>Nt(()=>import("./index-DapbfuH2.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([11,12,1,2,13,14])));function Uie({data:e,onNewThread:t,loading:n,showThread:r}){var i,s,c,l,u,d,f,h;const{t:o}=Me("flows"),a=g.useMemo(()=>{var y;try{return JSON.parse(((y=e==null?void 0:e.entity)==null?void 0:y.metadata)||"{}")}catch{return{}}},[(i=e==null?void 0:e.entity)==null?void 0:i.metadata]);return p.jsxs(No,{className:"flex min-w-52",children:[p.jsx(le,{className:K(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),p.jsx(le,{name:r?"minus":"plus",size:24}),p.jsxs("div",{className:"ml-2 w-full max-w-full",children:[p.jsx(Mo,{children:o(`message_node.message_roles.${(c=(s=e.entity)==null?void 0:s.role)==null?void 0:c.toLowerCase()}`)}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:p.jsx(Vie,{className:"!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",source:`${e.content||((l=e.entity)==null?void 0:l.content)||""}`,style:{color:"unset !important"}})}),Array.isArray((u=a==null?void 0:a.message)==null?void 0:u.tool_calls)&&((f=(d=a==null?void 0:a.message)==null?void 0:d.tool_calls)!=null&&f.length)?(h=a==null?void 0:a.message)==null?void 0:h.tool_calls.map((y,m)=>p.jsx(tn,{children:o("message_node.tool_call",{name:y.name,args:Object.entries(y.args).map(([v,b])=>`"${v}": "${b}"`).join(", ")})},`${y.name}_${m}`)):null,t?p.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:p.jsxs(at,{onClick:t,disabled:n,variant:"outline",children:[p.jsx(le,{name:r?"minus":"plus",size:16}),o(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?p.jsx(Xx,{size:350,duration:10}):void 0]})}const Hie=e=>{const{t}=Me("flows"),n=ln(e),r=Ae(u=>u.updateNodes),{getNode:o,getHandleConnections:a}=Fn(),{createMessage:i,loading:s}=kw({getNode:o,getHandleConnections:a}),c=g.useCallback(u=>{if(!u.id)return;const d=o(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...el(u.nodeData,tl)}}}])},[o,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return tc({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});tc({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},J5=()=>{const e=Je(r=>r.currentSession),t=Ae(r=>r.createOrUpdateFlowNode),n=Ae(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,o,a,i)=>{var y,m,v,b,x;if(!r||!o||!e)return;const s=(m=(y=i==null?void 0:i.promptNode)==null?void 0:y.data)==null?void 0:m.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((x=r.measured)==null?void 0:x.height)||0),u=await ce("Message").save({thread_id:o.id,content:a,role:(s==null?void 0:s.role)||kn.Human,status:eo.Started,llm_id:o.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:oe.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const f=await n({source:r.id,target:d.id});let h;return i!=null&&i.promptNode&&(h=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:h,messageNode:d,messageEdge:f}},[t,n])}},Wie=e=>{const{createIdieMessage:t}=J5(),n=g.useCallback(async({edgeId:r,source:o,target:a})=>{var i,s;try{if((o==null?void 0:o.type)===oe.Prompt&&(a==null?void 0:a.type)===oe.Message){const c=(i=a==null?void 0:a.data)==null?void 0:i.entity,l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if(!l||!c||!a)return{deleteEdgeId:r};await t(a,{id:c==null?void 0:c.thread_id,title:"",status:Ju.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:o});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},qie=g.memo(e=>{var _,w,j;const{id:t,data:n,isConnectable:r}=e,[o,a]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Me("common"),l=$f({type:"source"}),{loading:u,createMessage:d}=Hie(t),{toast:f}=Bt();Wie(t);const h=g.useCallback(async(...E)=>{const S=await d(...E);return a(!1),S},[d]),y=g.useMemo(()=>l.length===0,[l]),m=g.useCallback(()=>{var E;(E=n.entity)!=null&&E.content&&(navigator.clipboard.writeText(n.entity.content),f({description:c("copied")}))},[f,n,c]),v=g.useCallback(async()=>{var E;try{if(i)return await CE.stop(),s(!1);s(!0),await CE.speak(((E=n.entity)==null?void 0:E.content)||"")}catch{f({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,f]),b=g.useCallback(()=>{a(E=>!E)},[]),x=g.useMemo(()=>{var E;if(!(!y&&!o||n.loading||u||((E=n==null?void 0:n.entity)==null?void 0:E.status)==="inprogress"))return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),p.jsx("div",{className:"absolute mt-[30px] w-full",children:p.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:p.jsx(fp,{disabled:u,loading:u,onSubmit:h})})})]})},[(w=n==null?void 0:n.entity)==null?void 0:w.status,n.loading,h,y,u,o]);return p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs("div",{className:"max-w-sm min-w-64",children:[p.jsxs("div",{className:"w-auto",children:[p.jsx(nn,{id:t}),p.jsx("div",{children:((j=n.entity)==null?void 0:j.role)===kn.Human?p.jsx(zie,{data:n,showThread:o,onNewThread:y?void 0:b}):p.jsx(Uie,{data:n,showThread:o,loading:u,onNewThread:y?void 0:b})}),p.jsx(at,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:p.jsx(le,{name:i?"circle-stop":"speech",size:16})}),p.jsx(at,{onClick:m,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:p.jsx(le,{name:"copy",size:16})})]}),x]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Yie=e=>{const t=Ae(o=>o.createOrUpdateFlowEdge),{createIdieMessage:n}=J5(),r=g.useCallback(async({edgeId:o,source:a,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,f=(c=a==null?void 0:a.data)==null?void 0:c.entity;if((a==null?void 0:a.type)===oe.Message&&(i==null?void 0:i.type)===oe.Prompt){const h=(l=a==null?void 0:a.data)==null?void 0:l.entity,y=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!y||!h||!i)return{deleteEdgeId:o};await n(a,{id:h==null?void 0:h.thread_id,title:"",status:Ju.Started,initial_llm_id:h.llm_id,session_id:y.session_id},y.content,{promptNode:i});return}else if((a==null?void 0:a.type)===oe.CSVData&&(i==null?void 0:i.type)===oe.Prompt&&(d==null?void 0:d.type)===Pn.FewShotExample&&(f!=null&&f.headers.includes("input"))&&(f!=null&&f.headers.includes("output"))){await t({source:a.id,target:i.id});return}return{deleteEdgeId:o}}catch{return{deleteEdgeId:o}}},[n,t]);cn(e,r)},Kie=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;Yie(t);const o=Kt(GD),a=g.useMemo(()=>{var f,h,y;return`${(f=n.entity)!=null&&f.prefix?`${(h=n.entity)==null?void 0:h.prefix}
`:""}${((y=n.entity)==null?void 0:y.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var h;const f=/{(.*?)}/g;return((h=a.match(f))==null?void 0:h.map(y=>y.replace("{","").replace("}","")))||[]},[a]),s=a.length>990,c=()=>{o.show({title:"Prompt",content:a})};return p.jsxs("div",{className:"min-w-56",children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs("div",{children:[p.jsx(nn,{id:t}),p.jsxs(No,{className:"flex justify-center max-w-72",variant:"default",children:[p.jsx(le,{size:24,name:"notepad-text"}),p.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[p.jsx(Mo,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),p.jsxs(ps,{onClick:s?c:void 0,children:[s?`${a.slice(0,990)}...`:a,s?p.jsx("span",{className:"float-right",children:p.jsx(le,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((f,h)=>p.jsx(tn,{className:"mt-2 mr-1",variant:"default",children:f},h)):void 0]})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});var Xie=SA();const qn=Xe(Xie);var Pw,G5;function Qie(){if(G5)return Pw;G5=1;function e(t){return t==null}return Pw=e,Pw}var Jie=Qie();const it=Xe(Jie);var Aw,Z5;function Gie(){if(Z5)return Aw;Z5=1;var e=mo(),t=un(),n=Nr(),r="[object String]";function o(a){return typeof a=="string"||!t(a)&&n(a)&&e(a)==r}return Aw=o,Aw}var Zie=Gie();const Ll=Xe(Zie);var ese=qu();const We=Xe(ese);var tse=rr();const hs=Xe(tse);var e4={exports:{}},st={},t4;function nse(){if(t4)return st;t4=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),y;y=Symbol.for("react.module.reference");function m(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case o:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case f:case d:case a:return v;default:return b}}case t:return b}}}return st.ContextConsumer=i,st.ContextProvider=a,st.Element=e,st.ForwardRef=c,st.Fragment=n,st.Lazy=f,st.Memo=d,st.Portal=t,st.Profiler=o,st.StrictMode=r,st.Suspense=l,st.SuspenseList=u,st.isAsyncMode=function(){return!1},st.isConcurrentMode=function(){return!1},st.isContextConsumer=function(v){return m(v)===i},st.isContextProvider=function(v){return m(v)===a},st.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},st.isForwardRef=function(v){return m(v)===c},st.isFragment=function(v){return m(v)===n},st.isLazy=function(v){return m(v)===f},st.isMemo=function(v){return m(v)===d},st.isPortal=function(v){return m(v)===t},st.isProfiler=function(v){return m(v)===o},st.isStrictMode=function(v){return m(v)===r},st.isSuspense=function(v){return m(v)===l},st.isSuspenseList=function(v){return m(v)===u},st.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===o||v===r||v===l||v===u||v===h||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===d||v.$$typeof===a||v.$$typeof===i||v.$$typeof===c||v.$$typeof===y||v.getModuleId!==void 0)},st.typeOf=m,st}var n4;function rse(){return n4||(n4=1,e4.exports=nse()),e4.exports}var ose=rse(),Tw,r4;function o4(){if(r4)return Tw;r4=1;var e=mo(),t=Nr(),n="[object Number]";function r(o){return typeof o=="number"||t(o)&&e(o)==n}return Tw=r,Tw}var Rw,a4;function ase(){if(a4)return Rw;a4=1;var e=o4();function t(n){return e(n)&&n!=+n}return Rw=t,Rw}var ise=ase();const Fl=Xe(ise);var sse=o4();const cse=Xe(sse);var xr=function(e){return e===0?0:e>0?1:-1},Ya=function(e){return Ll(e)&&e.indexOf("%")===e.length-1},me=function(e){return cse(e)&&!Fl(e)},zt=function(e){return me(e)||Ll(e)},lse=0,pp=function(e){var t=++lse;return"".concat(e||"").concat(t)},Ka=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!me(e)&&!Ll(e))return n;var o;if(Ya(e)){var a=e.indexOf("%");o=t*parseFloat(e.slice(0,a))/100}else o=+e;return Fl(o)&&(o=n),r&&o>t&&(o=t),o},ca=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},use=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},ms=function(e,t){return me(e)&&me(t)?function(n){return e+n*(t-e)}:function(){return t}};function Iw(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):qn(r,t))===n})}function ys(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function Dw(e){"@babel/helpers - typeof";return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}var dse=["viewBox","children"],fse=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],i4=["points","pathLength"],Lw={svg:dse,polygon:i4,polyline:i4},Fw=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],hp=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!hs(n))return null;var r={};return Object.keys(n).forEach(function(o){Fw.includes(o)&&(r[o]=t||function(a){return n[o](n,a)})}),r},pse=function(e,t,n){return function(r){return e(t,n,r),null}},mp=function(e,t,n){if(!hs(e)||Dw(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(o){var a=e[o];Fw.includes(o)&&typeof a=="function"&&(r||(r={}),r[o]=pse(a,t,n))}),r},hse=["children"],mse=["children"];function s4(e,t){if(e==null)return{};var n=yse(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yse(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var c4={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},ko=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},l4=null,Bw=null,$w=function e(t){if(t===l4&&Array.isArray(Bw))return Bw;var n=[];return g.Children.forEach(t,function(r){it(r)||(ose.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),Bw=n,l4=t,n};function wr(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(o){return ko(o)}):r=[ko(t)],$w(e).forEach(function(o){var a=qn(o,"type.displayName")||qn(o,"type.name");r.indexOf(a)!==-1&&n.push(o)}),n}function Bn(e,t){var n=wr(e,t);return n&&n[0]}var u4=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!me(n)||n<=0||!me(r)||r<=0)},gse=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],vse=function(e){return e&&e.type&&Ll(e.type)&&gse.indexOf(e.type)>=0},bse=function(e,t,n,r){var o,a=(o=Lw==null?void 0:Lw[r])!==null&&o!==void 0?o:[];return!We(e)&&(r&&a.includes(t)||fse.includes(t))||n&&Fw.includes(t)},ot=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!hs(r))return null;var o={};return Object.keys(r).forEach(function(a){var i;bse((i=r)===null||i===void 0?void 0:i[a],a,t,n)&&(o[a]=r[a])}),o},zw=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return d4(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var o=0;o<r;o++){var a=t[o],i=n[o];if(Array.isArray(a)||Array.isArray(i)){if(!e(a,i))return!1}else if(!d4(a,i))return!1}return!0},d4=function(e,t){if(it(e)&&it(t))return!0;if(!it(e)&&!it(t)){var n=e.props||{},r=n.children,o=s4(n,hse),a=t.props||{},i=a.children,s=s4(a,mse);return r&&i?ys(o,s)&&zw(r,i):!r&&!i?ys(o,s):!1}return!1},f4=function(e,t){var n=[],r={};return $w(e).forEach(function(o,a){if(vse(o))n.push(o);else if(o){var i=ko(o.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(o,i,a);n.push(u),r[i]=!0}}}),n},xse=function(e){var t=e&&e.type;return t&&c4[t]?c4[t]:null},wse=function(e,t){return $w(t).indexOf(e)},_se=["children","width","height","viewBox","className","style","title","desc"];function Vw(){return Vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vw.apply(this,arguments)}function jse(e,t){if(e==null)return{};var n=Ese(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ese(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Uw(e){var t=e.children,n=e.width,r=e.height,o=e.viewBox,a=e.className,i=e.style,s=e.title,c=e.desc,l=jse(e,_se),u=o||{width:n,height:r,x:0,y:0},d=ut("recharts-surface",a);return V.createElement("svg",Vw({},ot(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),V.createElement("title",null,s),V.createElement("desc",null,c),t)}var Sse=["children","className"];function Hw(){return Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hw.apply(this,arguments)}function Cse(e,t){if(e==null)return{};var n=Ose(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ose(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var Wt=V.forwardRef(function(e,t){var n=e.children,r=e.className,o=Cse(e,Sse),a=ut("recharts-layer",r);return V.createElement("g",Hw({className:a},ot(o,!0),{ref:t}),n)}),Po=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o]},Ww,p4;function Nse(){if(p4)return Ww;p4=1;var e=Jm();function t(n,r,o){var a=n.length;return o=o===void 0?a:o,!r&&o>=a?n:e(n,r,o)}return Ww=t,Ww}var qw,h4;function m4(){if(h4)return qw;h4=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",o=t+n+r,a="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+o+a+"]");function c(l){return s.test(l)}return qw=c,qw}var Yw,y4;function Mse(){if(y4)return Yw;y4=1;function e(t){return t.split("")}return Yw=e,Yw}var Kw,g4;function kse(){if(g4)return Kw;g4=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",o=t+n+r,a="\\ufe0e\\ufe0f",i="["+e+"]",s="["+o+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",f="[\uD800-\uDBFF][\uDC00-\uDFFF]",h="\\u200d",y=l+"?",m="["+a+"]?",v="(?:"+h+"(?:"+[u,d,f].join("|")+")"+m+y+")*",b=m+y+v,x="(?:"+[u+s+"?",s,d,f,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+x+b,"g");function w(j){return j.match(_)||[]}return Kw=w,Kw}var Xw,v4;function Pse(){if(v4)return Xw;v4=1;var e=Mse(),t=m4(),n=kse();function r(o){return t(o)?n(o):e(o)}return Xw=r,Xw}var Qw,b4;function Ase(){if(b4)return Qw;b4=1;var e=Nse(),t=m4(),n=Pse(),r=xA();function o(a){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[a]()+l}}return Qw=o,Qw}var Jw,x4;function Tse(){if(x4)return Jw;x4=1;var e=Ase(),t=e("toUpperCase");return Jw=t,Jw}var Rse=Tse();const yp=Xe(Rse);function bt(e){return function(){return e}}const w4=Math.cos,gp=Math.sin,_r=Math.sqrt,vp=Math.PI,bp=2*vp,Gw=Math.PI,Zw=2*Gw,Xa=1e-6,Ise=Zw-Xa;function _4(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Dse(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return _4;const n=10**t;return function(r){this._+=r[0];for(let o=1,a=r.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}class Lse{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?_4:Dse(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,o){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(t,n,r,o,a,i){this._append`C${+t},${+n},${+r},${+o},${this._x1=+a},${this._y1=+i}`}arcTo(t,n,r,o,a){if(t=+t,n=+n,r=+r,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,s=this._y1,c=r-t,l=o-n,u=i-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>Xa)if(!(Math.abs(d*c-l*u)>Xa)||!a)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-i,y=o-s,m=c*c+l*l,v=h*h+y*y,b=Math.sqrt(m),x=Math.sqrt(f),_=a*Math.tan((Gw-Math.acos((m+f-v)/(2*b*x)))/2),w=_/x,j=_/b;Math.abs(w-1)>Xa&&this._append`L${t+w*u},${n+w*d}`,this._append`A${a},${a},0,0,${+(d*h>u*y)},${this._x1=t+j*c},${this._y1=n+j*l}`}}arc(t,n,r,o,a,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(o),c=r*Math.sin(o),l=t+s,u=n+c,d=1^i,f=i?o-a:a-o;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Xa||Math.abs(this._y1-u)>Xa)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%Zw+Zw),f>Ise?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:f>Xa&&this._append`A${r},${r},0,${+(f>=Gw)},${d},${this._x1=t+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(t,n,r,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function e1(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Lse(t)}function t1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function j4(e){this._context=e}j4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xp(e){return new j4(e)}function E4(e){return e[0]}function S4(e){return e[1]}function C4(e,t){var n=bt(!0),r=null,o=xp,a=null,i=e1(s);e=typeof e=="function"?e:e===void 0?E4:bt(e),t=typeof t=="function"?t:t===void 0?S4:bt(t);function s(c){var l,u=(c=t1(c)).length,d,f=!1,h;for(r==null&&(a=o(h=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(d,l,c),+t(d,l,c));if(h)return a=null,h+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:bt(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:bt(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:bt(!!c),s):n},s.curve=function(c){return arguments.length?(o=c,r!=null&&(a=o(r)),s):o},s.context=function(c){return arguments.length?(c==null?r=a=null:a=o(r=c),s):r},s}function wp(e,t,n){var r=null,o=bt(!0),a=null,i=xp,s=null,c=e1(l);e=typeof e=="function"?e:e===void 0?E4:bt(+e),t=typeof t=="function"?t:bt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?S4:bt(+n);function l(d){var f,h,y,m=(d=t1(d)).length,v,b=!1,x,_=new Array(m),w=new Array(m);for(a==null&&(s=i(x=c())),f=0;f<=m;++f){if(!(f<m&&o(v=d[f],f,d))===b)if(b=!b)h=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),y=f-1;y>=h;--y)s.point(_[y],w[y]);s.lineEnd(),s.areaEnd()}b&&(_[f]=+e(v,f,d),w[f]=+t(v,f,d),s.point(r?+r(v,f,d):_[f],n?+n(v,f,d):w[f]))}if(x)return s=null,x+""||null}function u(){return C4().defined(o).curve(i).context(a)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:bt(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:bt(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:bt(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:bt(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:bt(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:bt(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(o=typeof d=="function"?d:bt(!!d),l):o},l.curve=function(d){return arguments.length?(i=d,a!=null&&(s=i(a)),l):i},l.context=function(d){return arguments.length?(d==null?a=s=null:s=i(a=d),l):a},l}class O4{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Fse(e){return new O4(e,!0)}function Bse(e){return new O4(e,!1)}const n1={draw(e,t){const n=_r(t/vp);e.moveTo(n,0),e.arc(0,0,n,0,bp)}},$se={draw(e,t){const n=_r(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},N4=_r(1/3),zse=N4*2,Vse={draw(e,t){const n=_r(t/zse),r=n*N4;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Use={draw(e,t){const n=_r(t),r=-n/2;e.rect(r,r,n,n)}},Hse=.8908130915292852,M4=gp(vp/10)/gp(7*vp/10),Wse=gp(bp/10)*M4,qse=-w4(bp/10)*M4,Yse={draw(e,t){const n=_r(t*Hse),r=Wse*n,o=qse*n;e.moveTo(0,-n),e.lineTo(r,o);for(let a=1;a<5;++a){const i=bp*a/5,s=w4(i),c=gp(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*o,c*r+s*o)}e.closePath()}},r1=_r(3),Kse={draw(e,t){const n=-_r(t/(r1*3));e.moveTo(0,n*2),e.lineTo(-r1*n,-n),e.lineTo(r1*n,-n),e.closePath()}},Yn=-.5,Kn=_r(3)/2,o1=1/_r(12),Xse=(o1/2+1)*3,Qse={draw(e,t){const n=_r(t/Xse),r=n/2,o=n*o1,a=r,i=n*o1+n,s=-a,c=i;e.moveTo(r,o),e.lineTo(a,i),e.lineTo(s,c),e.lineTo(Yn*r-Kn*o,Kn*r+Yn*o),e.lineTo(Yn*a-Kn*i,Kn*a+Yn*i),e.lineTo(Yn*s-Kn*c,Kn*s+Yn*c),e.lineTo(Yn*r+Kn*o,Yn*o-Kn*r),e.lineTo(Yn*a+Kn*i,Yn*i-Kn*a),e.lineTo(Yn*s+Kn*c,Yn*c-Kn*s),e.closePath()}};function Jse(e,t){let n=null,r=e1(o);e=typeof e=="function"?e:bt(e||n1),t=typeof t=="function"?t:bt(t===void 0?64:+t);function o(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return o.type=function(a){return arguments.length?(e=typeof a=="function"?a:bt(a),o):e},o.size=function(a){return arguments.length?(t=typeof a=="function"?a:bt(+a),o):t},o.context=function(a){return arguments.length?(n=a??null,o):n},o}function _p(){}function jp(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function k4(e){this._context=e}k4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:jp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Gse(e){return new k4(e)}function P4(e){this._context=e}P4.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zse(e){return new P4(e)}function A4(e){this._context=e}A4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ece(e){return new A4(e)}function T4(e){this._context=e}T4.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function tce(e){return new T4(e)}function R4(e){return e<0?-1:1}function I4(e,t,n){var r=e._x1-e._x0,o=t-e._x1,a=(e._y1-e._y0)/(r||o<0&&-0),i=(n-e._y1)/(o||r<0&&-0),s=(a*o+i*r)/(r+o);return(R4(a)+R4(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(s))||0}function D4(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function a1(e,t,n){var r=e._x0,o=e._y0,a=e._x1,i=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,o+s*t,a-s,i-s*n,a,i)}function Ep(e){this._context=e}Ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:a1(this,this._t0,D4(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,a1(this,D4(this,n=I4(this,e,t)),n);break;default:a1(this,this._t0,n=I4(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function L4(e){this._context=new F4(e)}(L4.prototype=Object.create(Ep.prototype)).point=function(e,t){Ep.prototype.point.call(this,t,e)};function F4(e){this._context=e}F4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,o,a){this._context.bezierCurveTo(t,e,r,n,a,o)}};function nce(e){return new Ep(e)}function rce(e){return new L4(e)}function B4(e){this._context=e}B4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=$4(e),o=$4(t),a=0,i=1;i<n;++a,++i)this._context.bezierCurveTo(r[0][a],o[0][a],r[1][a],o[1][a],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function $4(e){var t,n=e.length-1,r,o=new Array(n),a=new Array(n),i=new Array(n);for(o[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)o[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(o[n-1]=2,a[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=o[t]/a[t-1],a[t]-=r,i[t]-=r*i[t-1];for(o[n-1]=i[n-1]/a[n-1],t=n-2;t>=0;--t)o[t]=(i[t]-o[t+1])/a[t];for(a[n-1]=(e[n]+o[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-o[t+1];return[o,a]}function oce(e){return new B4(e)}function Sp(e,t){this._context=e,this._t=t}Sp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function ace(e){return new Sp(e,.5)}function ice(e){return new Sp(e,0)}function sce(e){return new Sp(e,1)}function gs(e,t){if((i=e.length)>1)for(var n=1,r,o,a=e[t[0]],i,s=a.length;n<i;++n)for(o=a,a=e[t[n]],r=0;r<s;++r)a[r][1]+=a[r][0]=isNaN(o[r][1])?o[r][0]:o[r][1]}function i1(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function cce(e,t){return e[t]}function lce(e){const t=[];return t.key=e,t}function uce(){var e=bt([]),t=i1,n=gs,r=cce;function o(a){var i=Array.from(e.apply(this,arguments),lce),s,c=i.length,l=-1,u;for(const d of a)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,a)]).data=d;for(s=0,u=t1(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return o.keys=function(a){return arguments.length?(e=typeof a=="function"?a:bt(Array.from(a)),o):e},o.value=function(a){return arguments.length?(r=typeof a=="function"?a:bt(+a),o):r},o.order=function(a){return arguments.length?(t=a==null?i1:typeof a=="function"?a:bt(Array.from(a)),o):t},o.offset=function(a){return arguments.length?(n=a??gs,o):n},o}function dce(e,t){if((r=e.length)>0){for(var n,r,o=0,a=e[0].length,i;o<a;++o){for(i=n=0;n<r;++n)i+=e[n][o][1]||0;if(i)for(n=0;n<r;++n)e[n][o][1]/=i}gs(e,t)}}function fce(e,t){if((o=e.length)>0){for(var n=0,r=e[t[0]],o,a=r.length;n<a;++n){for(var i=0,s=0;i<o;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}gs(e,t)}}function pce(e,t){if(!(!((i=e.length)>0)||!((a=(o=e[t[0]]).length)>0))){for(var n=0,r=1,o,a,i;r<a;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,h=(d-f)/2,y=0;y<s;++y){var m=e[t[y]],v=m[r][1]||0,b=m[r-1][1]||0;h+=v-b}c+=d,l+=h*d}o[r-1][1]+=o[r-1][0]=n,c&&(n-=l/c)}o[r-1][1]+=o[r-1][0]=n,gs(e,t)}}function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}var hce=["type","size","sizeType"];function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s1.apply(this,arguments)}function z4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function V4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z4(Object(n),!0).forEach(function(r){mce(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z4(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mce(e,t,n){return t=yce(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yce(e){var t=gce(e,"string");return Bl(t)=="symbol"?t:t+""}function gce(e,t){if(Bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vce(e,t){if(e==null)return{};var n=bce(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bce(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var U4={symbolCircle:n1,symbolCross:$se,symbolDiamond:Vse,symbolSquare:Use,symbolStar:Yse,symbolTriangle:Kse,symbolWye:Qse},xce=Math.PI/180,wce=function(e){var t="symbol".concat(yp(e));return U4[t]||n1},_ce=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*xce;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},jce=function(e,t){U4["symbol".concat(yp(e))]=t},c1=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,o=r===void 0?64:r,a=e.sizeType,i=a===void 0?"area":a,s=vce(e,hce),c=V4(V4({},s),{},{type:n,size:o,sizeType:i}),l=function(){var y=wce(n),m=Jse().type(y).size(_ce(o,i,n));return m()},u=c.className,d=c.cx,f=c.cy,h=ot(c,!0);return d===+d&&f===+f&&o===+o?V.createElement("path",s1({},h,{className:ut("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};c1.registerSymbol=jce;function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function l1(){return l1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l1.apply(this,arguments)}function H4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ece(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H4(Object(n),!0).forEach(function(r){$l(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H4(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Sce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q4(r.key),r)}}function Oce(e,t,n){return t&&Cce(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nce(e,t,n){return t=Cp(t),Mce(e,W4()?Reflect.construct(t,n||[],Cp(e).constructor):t.apply(e,n))}function Mce(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kce(e)}function kce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W4=function(){return!!e})()}function Cp(e){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cp(e)}function Pce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u1(e,t)}function u1(e,t){return u1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},u1(e,t)}function $l(e,t,n){return t=q4(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q4(e){var t=Ace(e,"string");return vs(t)=="symbol"?t:t+""}function Ace(e,t){if(vs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xn=32,d1=function(e){function t(){return Sce(this,t),Nce(this,t,arguments)}return Pce(t,e),Oce(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,o=Xn/2,a=Xn/6,i=Xn/3,s=n.inactive?r:n.color;if(n.type==="plainline")return V.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:Xn,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return V.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(o,"h").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*i,",").concat(o,`
            H`).concat(Xn,"M").concat(2*i,",").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(i,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return V.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Xn/8,"h").concat(Xn,"v").concat(Xn*3/4,"h").concat(-Xn,"z"),className:"recharts-legend-icon"});if(V.isValidElement(n.legendIcon)){var c=Ece({},n);return delete c.legendIcon,V.cloneElement(n.legendIcon,c)}return V.createElement(c1,{fill:s,cx:o,cy:o,size:Xn,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,o=r.payload,a=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Xn,height:Xn},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(f,h){var y=f.formatter||s,m=ut($l($l({"recharts-legend-item":!0},"legend-item-".concat(h),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=We(f.value)?null:f.value;Po(!We(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return V.createElement("li",l1({className:m,style:u,key:"legend-item-".concat(h)},mp(n.props,f,h)),V.createElement(Uw,{width:a,height:a,viewBox:l,style:d},n.renderIcon(f)),V.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(v,f,h):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,o=n.layout,a=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:o==="horizontal"?a:"left"};return V.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);$l(d1,"displayName","Legend"),$l(d1,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var f1,Y4;function K4(){if(Y4)return f1;Y4=1;function e(t,n,r,o){for(var a=t.length,i=r+(o?1:-1);o?i--:++i<a;)if(n(t[i],i,t))return i;return-1}return f1=e,f1}var p1,X4;function Tce(){if(X4)return p1;X4=1;function e(t){return t!==t}return p1=e,p1}var h1,Q4;function Rce(){if(Q4)return h1;Q4=1;function e(t,n,r){for(var o=r-1,a=t.length;++o<a;)if(t[o]===n)return o;return-1}return h1=e,h1}var m1,J4;function Ice(){if(J4)return m1;J4=1;var e=K4(),t=Tce(),n=Rce();function r(o,a,i){return a===a?n(o,a,i):e(o,t,i)}return m1=r,m1}var y1,G4;function Dce(){if(G4)return y1;G4=1;var e=Ice();function t(n,r){var o=n==null?0:n.length;return!!o&&e(n,r,0)>-1}return y1=t,y1}var g1,Z4;function Lce(){if(Z4)return g1;Z4=1;function e(t,n,r){for(var o=-1,a=t==null?0:t.length;++o<a;)if(r(n,t[o]))return!0;return!1}return g1=e,g1}var v1,eL;function Fce(){if(eL)return v1;eL=1;function e(){}return v1=e,v1}var b1,tL;function Bce(){if(tL)return b1;tL=1;var e=ZP(),t=Fce(),n=Hv(),r=1/0,o=e&&1/n(new e([,-0]))[1]==r?function(a){return new e(a)}:t;return b1=o,b1}var x1,nL;function $ce(){if(nL)return x1;nL=1;var e=cP(),t=Dce(),n=Lce(),r=fP(),o=Bce(),a=Hv(),i=200;function s(c,l,u){var d=-1,f=t,h=c.length,y=!0,m=[],v=m;if(u)y=!1,f=n;else if(h>=i){var b=l?null:o(c);if(b)return a(b);y=!1,f=r,v=new e}else v=l?[]:m;e:for(;++d<h;){var x=c[d],_=l?l(x):x;if(x=u||x!==0?x:0,y&&_===_){for(var w=v.length;w--;)if(v[w]===_)continue e;l&&v.push(_),m.push(x)}else f(v,_,u)||(v!==m&&v.push(_),m.push(x))}return m}return x1=s,x1}var w1,rL;function zce(){if(rL)return w1;rL=1;var e=Lr(),t=$ce();function n(r,o){return r&&r.length?t(r,e(o,2)):[]}return w1=n,w1}var Vce=zce();const oL=Xe(Vce);function aL(e,t,n){return t===!0?oL(e,n):We(t)?oL(e,t):e}function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}var Uce=["ref"];function iL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iL(Object(n),!0).forEach(function(r){Np(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lL(r.key),r)}}function Wce(e,t,n){return t&&sL(e.prototype,t),n&&sL(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qce(e,t,n){return t=Op(t),Yce(e,cL()?Reflect.construct(t,n||[],Op(e).constructor):t.apply(e,n))}function Yce(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kce(e)}function Kce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cL=function(){return!!e})()}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Op(e)}function Xce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_1(e,t)}function _1(e,t){return _1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_1(e,t)}function Np(e,t,n){return t=lL(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lL(e){var t=Qce(e,"string");return bs(t)=="symbol"?t:t+""}function Qce(e,t){if(bs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jce(e,t){if(e==null)return{};var n=Gce(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Gce(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Zce(e){return e.value}function ele(e,t){if(V.isValidElement(e))return V.cloneElement(e,t);if(typeof e=="function")return V.createElement(e,t);t.ref;var n=Jce(t,Uce);return V.createElement(d1,n)}var uL=1,xs=function(e){function t(){var n;Hce(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=qce(this,t,[].concat(o)),Np(n,"lastBoundingBox",{width:-1,height:-1}),n}return Xce(t,e),Wce(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>uL||Math.abs(r.height-this.lastBoundingBox.height)>uL)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Ao({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,o=r.layout,a=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(a==="center"&&o==="vertical"){var f=this.getBBoxSnapshot();u={left:((c||0)-f.width)/2}}else u=a==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var h=this.getBBoxSnapshot();d={top:((l||0)-h.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return Ao(Ao({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,o=r.content,a=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=Ao(Ao({position:"absolute",width:a||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return V.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},ele(o,Ao(Ao({},this.props),{},{payload:aL(l,c,Zce)})))}}],[{key:"getWithHeight",value:function(n,r){var o=Ao(Ao({},this.defaultProps),n.props),a=o.layout;return a==="vertical"&&me(n.props.height)?{height:n.props.height}:a==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);Np(xs,"displayName","Legend"),Np(xs,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var j1,dL;function tle(){if(dL)return j1;dL=1;var e=gi(),t=Wu(),n=un(),r=e?e.isConcatSpreadable:void 0;function o(a){return n(a)||t(a)||!!(r&&a&&a[r])}return j1=o,j1}var E1,fL;Qh=function(){if(fL)return E1;fL=1;var e=Yv(),t=tle();function n(r,o,a,i,s){var c=-1,l=r.length;for(a||(a=t),s||(s=[]);++c<l;){var u=r[c];o>0&&a(u)?o>1?n(u,o-1,a,i,s):e(s,u):i||(s[s.length]=u)}return s}return E1=n,E1};var S1,pL;function nle(){if(pL)return S1;pL=1;function e(t){return function(n,r,o){for(var a=-1,i=Object(n),s=o(n),c=s.length;c--;){var l=s[t?c:++a];if(r(i[l],l,i)===!1)break}return n}}return S1=e,S1}var C1,hL;AE=function(){if(hL)return C1;hL=1;var e=nle(),t=e();return C1=t,C1};var O1,mL;function yL(){if(mL)return O1;mL=1;var e=AE(),t=cc();function n(r,o){return r&&e(r,o,t)}return O1=n,O1}var N1,gL;function rle(){if(gL)return N1;gL=1;var e=wa();function t(n,r){return function(o,a){if(o==null)return o;if(!e(o))return n(o,a);for(var i=o.length,s=r?i:-1,c=Object(o);(r?s--:++s<i)&&a(c[s],s,c)!==!1;);return o}}return N1=t,N1}var M1,vL;function k1(){if(vL)return M1;vL=1;var e=yL(),t=rle(),n=t(e);return M1=n,M1}var P1,bL;function xL(){if(bL)return P1;bL=1;var e=k1(),t=wa();function n(r,o){var a=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++a]=o(s,c,l)}),i}return P1=n,P1}var A1,wL;function ole(){if(wL)return A1;wL=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return A1=e,A1}var T1,_L;function ale(){if(_L)return T1;_L=1;var e=zi();function t(n,r){if(n!==r){var o=n!==void 0,a=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||a&&c&&u||!o&&u||!i)return 1;if(!a&&!s&&!d&&n<r||d&&o&&i&&!a&&!s||l&&o&&i||!c&&i||!u)return-1}return 0}return T1=t,T1}var R1,jL;function ile(){if(jL)return R1;jL=1;var e=ale();function t(n,r,o){for(var a=-1,i=n.criteria,s=r.criteria,c=i.length,l=o.length;++a<c;){var u=e(i[a],s[a]);if(u){if(a>=l)return u;var d=o[a];return u*(d=="desc"?-1:1)}}return n.index-r.index}return R1=t,R1}var I1,EL;function sle(){if(EL)return I1;EL=1;var e=nc(),t=dc(),n=Lr(),r=xL(),o=ole(),a=Km(),i=ile(),s=Vi(),c=un();function l(u,d,f){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var h=-1;d=e(d,a(n));var y=r(u,function(m,v,b){var x=e(d,function(_){return _(m)});return{criteria:x,index:++h,value:m}});return o(y,function(m,v){return i(m,v,f)})}return I1=l,I1}var D1,SL;$E=function(){if(SL)return D1;SL=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return D1=e,D1};var L1,CL;PE=function(){if(CL)return L1;CL=1;var e=$E(),t=Math.max;function n(r,o,a){return o=t(o===void 0?r.length-1:o,0),function(){for(var i=arguments,s=-1,c=t(i.length-o,0),l=Array(c);++s<c;)l[s]=i[o+s];s=-1;for(var u=Array(o+1);++s<o;)u[s]=i[s];return u[o]=a(l),e(r,this,u)}}return L1=n,L1};var F1,OL;function cle(){if(OL)return F1;OL=1;function e(t){return function(){return t}}return F1=e,F1}var B1,NL;function lle(){if(NL)return B1;NL=1;var e=cle(),t=LA(),n=Vi(),r=t?function(o,a){return t(o,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:n;return B1=r,B1}var $1,ML;function ule(){if(ML)return $1;ML=1;var e=800,t=16,n=Date.now;function r(o){var a=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++a>=e)return arguments[0]}else a=0;return o.apply(void 0,arguments)}}return $1=r,$1}var z1,kL;kE=function(){if(kL)return z1;kL=1;var e=lle(),t=ule(),n=t(e);return z1=n,z1};var V1,PL;TE=function(){if(PL)return V1;PL=1;var e=Vi(),t=PE(),n=kE();function r(o,a){return n(t(o,a,e),o+"")}return V1=r,V1};var U1,AL;function dle(){if(AL)return U1;AL=1;var e=Qh(),t=sle(),n=TE(),r=pi(),o=n(function(a,i){if(a==null)return[];var s=i.length;return s>1&&r(a,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(a,e(i,1),[])});return U1=o,U1}var fle=dle();const H1=Xe(fle);function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function W1(){return W1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W1.apply(this,arguments)}function ple(e,t){return gle(e)||yle(e,t)||mle(e,t)||hle()}function hle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mle(e,t){if(e){if(typeof e=="string")return TL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TL(e,t)}}function TL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yle(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function gle(e){if(Array.isArray(e))return e}function RL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function q1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RL(Object(n),!0).forEach(function(r){vle(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vle(e,t,n){return t=ble(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ble(e){var t=xle(e,"string");return zl(t)=="symbol"?t:t+""}function xle(e,t){if(zl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wle(e){return Array.isArray(e)&&zt(e[0])&&zt(e[1])?e.join(" ~ "):e}var _le=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,o=r===void 0?{}:r,a=e.itemStyle,i=a===void 0?{}:a,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,f=e.wrapperClassName,h=e.labelClassName,y=e.label,m=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,x=function(){if(l&&l.length){var N={padding:0,margin:0},P=(d?H1(l,d):l).map(function(R,A){if(R.type==="none")return null;var C=q1({display:"block",paddingTop:4,paddingBottom:4,color:R.color||"#000"},i),M=R.formatter||u||wle,T=R.value,D=R.name,I=T,L=D;if(M&&I!=null&&L!=null){var B=M(T,D,R,A,l);if(Array.isArray(B)){var U=ple(B,2);I=U[0],L=U[1]}else I=B}return V.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:C},zt(L)?V.createElement("span",{className:"recharts-tooltip-item-name"},L):null,zt(L)?V.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,V.createElement("span",{className:"recharts-tooltip-item-value"},I),V.createElement("span",{className:"recharts-tooltip-item-unit"},R.unit||""))});return V.createElement("ul",{className:"recharts-tooltip-item-list",style:N},P)}return null},_=q1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),w=q1({margin:0},c),j=!it(y),E=j?y:"",S=ut("recharts-default-tooltip",f),O=ut("recharts-tooltip-label",h);j&&m&&l!==void 0&&l!==null&&(E=m(y,l));var k=b?{role:"status","aria-live":"assertive"}:{};return V.createElement("div",W1({className:S,style:_},k),V.createElement("p",{className:O,style:w},V.isValidElement(E)?E:"".concat(E)),x())};function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function Mp(e,t,n){return t=jle(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jle(e){var t=Ele(e,"string");return Vl(t)=="symbol"?t:t+""}function Ele(e,t){if(Vl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ul="recharts-tooltip-wrapper",Sle={visibility:"hidden"};function Cle(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return ut(Ul,Mp(Mp(Mp(Mp({},"".concat(Ul,"-right"),me(n)&&t&&me(t.x)&&n>=t.x),"".concat(Ul,"-left"),me(n)&&t&&me(t.x)&&n<t.x),"".concat(Ul,"-bottom"),me(r)&&t&&me(t.y)&&r>=t.y),"".concat(Ul,"-top"),me(r)&&t&&me(t.y)&&r<t.y))}function IL(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,o=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(a&&me(a[r]))return a[r];var u=n[r]-s-o,d=n[r]+o;if(t[r])return i[r]?u:d;if(i[r]){var f=u,h=c[r];return f<h?Math.max(d,c[r]):Math.max(u,c[r])}var y=d+s,m=c[r]+l;return y>m?Math.max(u,c[r]):Math.max(d,c[r])}function Ole(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function Nle(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,o=e.position,a=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=IL({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:o,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=IL({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:o,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=Ole({translateX:u,translateY:d,useTranslate3d:s})):l=Sle,{cssProperties:l,cssClasses:Cle({translateX:u,translateY:d,coordinate:n})}}function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function DL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function LL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(n),!0).forEach(function(r){K1(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Mle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kle(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,BL(r.key),r)}}function Ple(e,t,n){return t&&kle(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ale(e,t,n){return t=kp(t),Tle(e,FL()?Reflect.construct(t,n||[],kp(e).constructor):t.apply(e,n))}function Tle(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rle(e)}function Rle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FL=function(){return!!e})()}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kp(e)}function Ile(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y1(e,t)}function Y1(e,t){return Y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Y1(e,t)}function K1(e,t,n){return t=BL(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BL(e){var t=Dle(e,"string");return ws(t)=="symbol"?t:t+""}function Dle(e,t){if(ws(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ws(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $L=1,Lle=function(e){function t(){var n;Mle(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=Ale(this,t,[].concat(o)),K1(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),K1(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return Ile(t,e),Ple(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>$L||Math.abs(n.height-this.state.lastBoundingBox.height)>$L)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,o=r.active,a=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,f=r.offset,h=r.position,y=r.reverseDirection,m=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,x=Nle({allowEscapeViewBox:a,coordinate:l,offsetTopLeft:f,position:h,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:v}),_=x.cssClasses,w=x.cssProperties,j=LL(LL({transition:d&&o?"transform ".concat(i,"ms ").concat(s):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return V.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(E){n.wrapperNode=E}},c)}}])}(g.PureComponent),Fle=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},la={isSsr:Fle(),get:function(e){return la[e]},set:function(e,t){if(typeof e=="string")la[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){la[r]=e[r]})}}};function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function zL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function VL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zL(Object(n),!0).forEach(function(r){Q1(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ble(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,HL(r.key),r)}}function zle(e,t,n){return t&&$le(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vle(e,t,n){return t=Pp(t),Ule(e,UL()?Reflect.construct(t,n||[],Pp(e).constructor):t.apply(e,n))}function Ule(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hle(e)}function Hle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UL=function(){return!!e})()}function Pp(e){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pp(e)}function Wle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X1(e,t)}function X1(e,t){return X1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},X1(e,t)}function Q1(e,t,n){return t=HL(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HL(e){var t=qle(e,"string");return _s(t)=="symbol"?t:t+""}function qle(e,t){if(_s(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_s(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yle(e){return e.dataKey}function Kle(e,t){return V.isValidElement(e)?V.cloneElement(e,t):typeof e=="function"?V.createElement(e,t):V.createElement(_le,t)}var Wr=function(e){function t(){return Ble(this,t),Vle(this,t,arguments)}return Wle(t,e),zle(t,[{key:"render",value:function(){var n=this,r=this.props,o=r.active,a=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,f=r.offset,h=r.payload,y=r.payloadUniqBy,m=r.position,v=r.reverseDirection,b=r.useTranslate3d,x=r.viewBox,_=r.wrapperStyle,w=h??[];u&&w.length&&(w=aL(h.filter(function(E){return E.value!=null&&(E.hide!==!0||n.props.includeHidden)}),y,Yle));var j=w.length>0;return V.createElement(Lle,{allowEscapeViewBox:a,animationDuration:i,animationEasing:s,isAnimationActive:d,active:o,coordinate:l,hasPayload:j,offset:f,position:m,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:_},Kle(c,VL(VL({},this.props),{},{payload:w})))}}])}(g.PureComponent);Q1(Wr,"displayName","Tooltip"),Q1(Wr,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!la.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var J1,WL;function Xle(){if(WL)return J1;WL=1;var e=nr(),t=function(){return e.Date.now()};return J1=t,J1}var G1,qL;LE=function(){if(qL)return G1;qL=1;var e=rr(),t=Xle(),n=o3(),r="Expected a function",o=Math.max,a=Math.min;function i(s,c,l){var u,d,f,h,y,m,v=0,b=!1,x=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,x="maxWait"in l,f=x?o(n(l.maxWait)||0,c):f,_="trailing"in l?!!l.trailing:_);function w(A){var C=u,M=d;return u=d=void 0,v=A,h=s.apply(M,C),h}function j(A){return v=A,y=setTimeout(O,c),b?w(A):h}function E(A){var C=A-m,M=A-v,T=c-C;return x?a(T,f-M):T}function S(A){var C=A-m,M=A-v;return m===void 0||C>=c||C<0||x&&M>=f}function O(){var A=t();if(S(A))return k(A);y=setTimeout(O,E(A))}function k(A){return y=void 0,_&&u?w(A):(u=d=void 0,h)}function N(){y!==void 0&&clearTimeout(y),v=0,u=m=d=y=void 0}function P(){return y===void 0?h:k(t())}function R(){var A=t(),C=S(A);if(u=arguments,d=this,m=A,C){if(y===void 0)return j(m);if(x)return clearTimeout(y),y=setTimeout(O,c),w(m)}return y===void 0&&(y=setTimeout(O,c)),h}return R.cancel=N,R.flush=P,R}return G1=i,G1};var Z1,YL;function Qle(){if(YL)return Z1;YL=1;var e=LE(),t=rr(),n="Expected a function";function r(o,a,i){var s=!0,c=!0;if(typeof o!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(o,a,{leading:s,maxWait:a,trailing:c})}return Z1=r,Z1}var Jle=Qle();Zh=Xe(Jle);function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function KL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ap(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KL(Object(n),!0).forEach(function(r){Gle(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Gle(e,t,n){return t=Zle(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zle(e){var t=eue(e,"string");return Hl(t)=="symbol"?t:t+""}function eue(e,t){if(Hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tue(e,t){return aue(e)||oue(e,t)||rue(e,t)||nue()}function nue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rue(e,t){if(e){if(typeof e=="string")return XL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XL(e,t)}}function XL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oue(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function aue(e){if(Array.isArray(e))return e}var iue=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,o=r===void 0?{width:-1,height:-1}:r,a=e.width,i=a===void 0?"100%":a,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,f=e.maxHeight,h=e.children,y=e.debounce,m=y===void 0?0:y,v=e.id,b=e.className,x=e.onResize,_=e.style,w=_===void 0?{}:_,j=g.useRef(null),E=g.useRef();E.current=x,g.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var S=g.useState({containerWidth:o.width,containerHeight:o.height}),O=tue(S,2),k=O[0],N=O[1],P=g.useCallback(function(A,C){N(function(M){var T=Math.round(A),D=Math.round(C);return M.containerWidth===T&&M.containerHeight===D?M:{containerWidth:T,containerHeight:D}})},[]);g.useEffect(function(){var A=function(I){var L,B=I[0].contentRect,U=B.width,F=B.height;P(U,F),(L=E.current)===null||L===void 0||L.call(E,U,F)};m>0&&(A=Zh(A,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(A),M=j.current.getBoundingClientRect(),T=M.width,D=M.height;return P(T,D),C.observe(j.current),function(){C.disconnect()}},[P,m]);var R=g.useMemo(function(){var A=k.containerWidth,C=k.containerHeight;if(A<0||C<0)return null;Po(Ya(i)||Ya(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Po(!n||n>0,"The aspect(%s) must be greater than zero.",n);var M=Ya(i)?A:i,T=Ya(c)?C:c;n&&n>0&&(M?T=M/n:T&&(M=T*n),f&&T>f&&(T=f)),Po(M>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,M,T,i,c,u,d,n);var D=!Array.isArray(h)&&ko(h.type).endsWith("Chart");return V.Children.map(h,function(I){return V.isValidElement(I)?g.cloneElement(I,Ap({width:M,height:T},D?{style:Ap({height:"100%",width:"100%",maxHeight:T,maxWidth:M},I.props.style)}:{})):I})},[n,h,c,f,d,u,k,i]);return V.createElement("div",{id:v?"".concat(v):void 0,className:ut("recharts-responsive-container",b),style:Ap(Ap({},w),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:f}),ref:j},R)}),QL=function(e){return null};QL.displayName="Cell";function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function JL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function e_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JL(Object(n),!0).forEach(function(r){sue(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sue(e,t,n){return t=cue(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cue(e){var t=lue(e,"string");return Wl(t)=="symbol"?t:t+""}function lue(e,t){if(Wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var js={widthCache:{},cacheCount:0},uue=2e3,due={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},GL="recharts_measurement_span";function fue(e){var t=e_({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var ql=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||la.isSsr)return{width:0,height:0};var n=fue(t),r=JSON.stringify({text:e,copyStyle:n});if(js.widthCache[r])return js.widthCache[r];try{var o=document.getElementById(GL);o||(o=document.createElement("span"),o.setAttribute("id",GL),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var a=e_(e_({},due),n);Object.assign(o.style,a),o.textContent="".concat(e);var i=o.getBoundingClientRect(),s={width:i.width,height:i.height};return js.widthCache[r]=s,++js.cacheCount>uue&&(js.cacheCount=0,js.widthCache={}),s}catch{return{width:0,height:0}}},pue=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function Tp(e,t){return gue(e)||yue(e,t)||mue(e,t)||hue()}function hue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mue(e,t){if(e){if(typeof e=="string")return ZL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZL(e,t)}}function ZL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yue(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function gue(e){if(Array.isArray(e))return e}function vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xue(r.key),r)}}function bue(e,t,n){return t&&eF(e.prototype,t),n&&eF(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function xue(e){var t=wue(e,"string");return Yl(t)=="symbol"?t:t+""}function wue(e,t){if(Yl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Yl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_ue=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,jue=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,rF={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Eue=Object.keys(rF),Es="NaN";function Sue(e,t){return e*rF[t]}var Rp=function(){function e(t,n){vue(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!_ue.test(n)&&(this.num=NaN,this.unit=""),Eue.includes(n)&&(this.num=Sue(t,n),this.unit="px")}return bue(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=jue.exec(t))!==null&&n!==void 0?n:[],o=Tp(r,3),a=o[1],i=o[2];return new e(parseFloat(a),i??"")}}])}();function oF(e){if(e.includes(Es))return Es;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=tF.exec(t))!==null&&n!==void 0?n:[],o=Tp(r,4),a=o[1],i=o[2],s=o[3],c=Rp.parse(a??""),l=Rp.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return Es;t=t.replace(tF,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,f=(d=nF.exec(t))!==null&&d!==void 0?d:[],h=Tp(f,4),y=h[1],m=h[2],v=h[3],b=Rp.parse(y??""),x=Rp.parse(v??""),_=m==="+"?b.add(x):b.subtract(x);if(_.isNaN())return Es;t=t.replace(nF,_.toString())}return t}var aF=/\(([^()]*)\)/;function Cue(e){for(var t=e;t.includes("(");){var n=aF.exec(t),r=Tp(n,2),o=r[1];t=t.replace(aF,oF(o))}return t}function Oue(e){var t=e.replace(/\s+/g,"");return t=Cue(t),t=oF(t),t}function Nue(e){try{return Oue(e)}catch{return Es}}function t_(e){var t=Nue(e.slice(5,-1));return t===Es?"":t}var Mue=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],kue=["dx","dy","angle","className","breakAll"];function n_(){return n_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n_.apply(this,arguments)}function iF(e,t){if(e==null)return{};var n=Pue(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pue(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function sF(e,t){return Iue(e)||Rue(e,t)||Tue(e,t)||Aue()}function Aue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tue(e,t){if(e){if(typeof e=="string")return cF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cF(e,t)}}function cF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rue(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function Iue(e){if(Array.isArray(e))return e}var lF=/[ \f\n\r\t\v\u2028\u2029]+/,uF=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var o=[];it(t)||(n?o=t.toString().split(""):o=t.toString().split(lF));var a=o.map(function(s){return{word:s,width:ql(s,r).width}}),i=n?0:ql("\xA0",r).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},Due=function(e,t,n,r,o){var a=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=me(a),u=i,d=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return A.reduce(function(C,M){var T=M.word,D=M.width,I=C[C.length-1];if(I&&(r==null||o||I.width+D+n<Number(r)))I.words.push(T),I.width+=D+n;else{var L={words:[T],width:D};C.push(L)}return C},[])},f=d(t),h=function(A){return A.reduce(function(C,M){return C.width>M.width?C:M})};if(!l)return f;for(var y="\u2026",m=function(A){var C=u.slice(0,A),M=uF({breakAll:c,style:s,children:C+y}).wordsWithComputedWidth,T=d(M),D=T.length>a||h(T).width>Number(r);return[D,T]},v=0,b=u.length-1,x=0,_;v<=b&&x<=u.length-1;){var w=Math.floor((v+b)/2),j=w-1,E=m(j),S=sF(E,2),O=S[0],k=S[1],N=m(w),P=sF(N,1),R=P[0];if(!O&&!R&&(v=w+1),O&&R&&(b=w-1),!O&&R){_=k;break}x++}return _||f},dF=function(e){var t=it(e)?[]:e.toString().split(lF);return[{words:t}]},Lue=function(e){var t=e.width,n=e.scaleToFit,r=e.children,o=e.style,a=e.breakAll,i=e.maxLines;if((t||n)&&!la.isSsr){var s,c,l=uF({breakAll:a,children:r,style:o});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return dF(r);return Due({breakAll:a,children:r,maxLines:i,style:o},s,c,t,n)}return dF(r)},fF="#808080",Ip=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,o=r===void 0?0:r,a=e.lineHeight,i=a===void 0?"1em":a,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,f=d===void 0?"start":d,h=e.verticalAnchor,y=h===void 0?"end":h,m=e.fill,v=m===void 0?fF:m,b=iF(e,Mue),x=g.useMemo(function(){return Lue({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,w=b.dy,j=b.angle,E=b.className,S=b.breakAll,O=iF(b,kue);if(!zt(n)||!zt(o))return null;var k=n+(me(_)?_:0),N=o+(me(w)?w:0),P;switch(y){case"start":P=t_("calc(".concat(c,")"));break;case"middle":P=t_("calc(".concat((x.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:P=t_("calc(".concat(x.length-1," * -").concat(i,")"));break}var R=[];if(u){var A=x[0].width,C=b.width;R.push("scale(".concat((me(C)?C/A:1)/A,")"))}return j&&R.push("rotate(".concat(j,", ").concat(k,", ").concat(N,")")),R.length&&(O.transform=R.join(" ")),V.createElement("text",n_({},ot(O,!0),{x:k,y:N,className:ut("recharts-text",E),textAnchor:f,fill:v.includes("url")?fF:v}),x.map(function(M,T){var D=M.words.join(S?"":" ");return V.createElement("tspan",{x:k,dy:T===0?P:i,key:"".concat(D,"-").concat(T)},D)}))};function ua(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Fue(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function r_(e){let t,n,r;e.length!==2?(t=ua,n=(s,c)=>ua(e(s),c),r=(s,c)=>e(s)-c):(t=e===ua||e===Fue?e:Bue,n=e,r=e);function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=o(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:o,center:i,right:a}}function Bue(){return 0}function pF(e){return e===null?NaN:+e}function*$ue(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const zue=r_(ua),Kl=zue.right;r_(pF).center;class hF extends Map{constructor(t,n=Hue){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,o]of t)this.set(r,o)}get(t){return super.get(mF(this,t))}has(t){return super.has(mF(this,t))}set(t,n){return super.set(Vue(this,t),n)}delete(t){return super.delete(Uue(this,t))}}function mF({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Vue({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Uue({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Hue(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Wue(e=ua){if(e===ua)return yF;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function yF(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const que=Math.sqrt(50),Yue=Math.sqrt(10),Kue=Math.sqrt(2);function Dp(e,t,n){const r=(t-e)/Math.max(0,n),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),i=a>=que?10:a>=Yue?5:a>=Kue?2:1;let s,c,l;return o<0?(l=Math.pow(10,-o)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,o)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?Dp(e,t,n*2):[s,c,l]}function o_(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[o,a,i]=r?Dp(t,e,n):Dp(e,t,n);if(!(a>=o))return[];const s=a-o+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(a-l)/-i;else for(let l=0;l<s;++l)c[l]=(a-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(o+l)/-i;else for(let l=0;l<s;++l)c[l]=(o+l)*i;return c}function a_(e,t,n){return t=+t,e=+e,n=+n,Dp(e,t,n)[2]}function i_(e,t,n){t=+t,e=+e,n=+n;const r=t<e,o=r?a_(t,e,n):a_(e,t,n);return(r?-1:1)*(o<0?1/-o:o)}function gF(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function vF(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function bF(e,t,n=0,r=1/0,o){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(o=o===void 0?yF:Wue(o);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),h=Math.max(n,Math.floor(t-l*d/c+f)),y=Math.min(r,Math.floor(t+(c-l)*d/c+f));bF(e,t,h,y,o)}const a=e[t];let i=n,s=r;for(Xl(e,n,t),o(e[r],a)>0&&Xl(e,n,r);i<s;){for(Xl(e,i,s),++i,--s;o(e[i],a)<0;)++i;for(;o(e[s],a)>0;)--s}o(e[n],a)===0?Xl(e,n,s):(++s,Xl(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Xl(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Xue(e,t,n){if(e=Float64Array.from($ue(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return vF(e);if(t>=1)return gF(e);var r,o=(r-1)*t,a=Math.floor(o),i=gF(bF(e,a).subarray(0,a+1)),s=vF(e.subarray(a+1));return i+(s-i)*(o-a)}}function Que(e,t,n=pF){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,o=(r-1)*t,a=Math.floor(o),i=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return i+(s-i)*(o-a)}}function Jue(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var r=-1,o=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(o);++r<o;)a[r]=e+r*n;return a}function Qn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function To(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const s_=Symbol("implicit");function c_(){var e=new hF,t=[],n=[],r=s_;function o(a){let i=e.get(a);if(i===void 0){if(r!==s_)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return o.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new hF;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return o},o.range=function(a){return arguments.length?(n=Array.from(a),o):n.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.copy=function(){return c_(t,n).unknown(r)},Qn.apply(o,arguments),o}function Ql(){var e=c_().unknown(void 0),t=e.domain,n=e.range,r=0,o=1,a,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var f=t().length,h=o<r,y=h?o:r,m=h?r:o;a=(m-y)/Math.max(1,f-c+l*2),s&&(a=Math.floor(a)),y+=(m-y-a*(f-c))*u,i=a*(1-c),s&&(y=Math.round(y),i=Math.round(i));var v=Jue(f).map(function(b){return y+a*b});return n(h?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,o]=f,r=+r,o=+o,d()):[r,o]},e.rangeRound=function(f){return[r,o]=f,r=+r,o=+o,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),d()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return Ql(t(),[r,o]).round(s).paddingInner(c).paddingOuter(l).align(u)},Qn.apply(d(),arguments)}function xF(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return xF(t())},e}function Jl(){return xF(Ql.apply(null,arguments).paddingInner(1))}function Gue(e){return function(){return e}}function Lp(e){return+e}var wF=[0,1];function gn(e){return e}function l_(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Gue(isNaN(t)?NaN:.5)}function Zue(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function ede(e,t,n){var r=e[0],o=e[1],a=t[0],i=t[1];return o<r?(r=l_(o,r),a=n(i,a)):(r=l_(r,o),a=n(a,i)),function(s){return a(r(s))}}function tde(e,t,n){var r=Math.min(e.length,t.length)-1,o=new Array(r),a=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)o[i]=l_(e[i],e[i+1]),a[i]=n(t[i],t[i+1]);return function(s){var c=Kl(e,s,1,r)-1;return a[c](o[c](s))}}function Gl(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Fp(){var e=wF,t=wF,n=qi,r,o,a,i=gn,s,c,l;function u(){var f=Math.min(e.length,t.length);return i!==gn&&(i=Zue(e[0],e[f-1])),s=f>2?tde:ede,c=l=null,d}function d(f){return f==null||isNaN(f=+f)?a:(c||(c=s(e.map(r),t,n)))(r(i(f)))}return d.invert=function(f){return i(o((l||(l=s(t,e.map(r),hr)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,Lp),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=Cb,u()},d.clamp=function(f){return arguments.length?(i=f?!0:gn,u()):i!==gn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(a=f,d):a},function(f,h){return r=f,o=h,u()}}function u_(){return Fp()(gn,gn)}function nde(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Bp(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ss(e){return e=Bp(Math.abs(e)),e?e[1]:NaN}function rde(e,t){return function(n,r){for(var o=n.length,a=[],i=0,s=e[0],c=0;o>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(o-=s,o+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return a.reverse().join(t)}}function ode(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var ade=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Zl(e){if(!(t=ade.exec(e)))throw new Error("invalid format: "+e);var t;return new d_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Zl.prototype=d_.prototype;function d_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}d_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ide(e){e:for(var t=e.length,n=1,r=-1,o;n<t;++n)switch(e[n]){case".":r=o=n;break;case"0":r===0&&(r=n),o=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(o+1):e}var _F;function sde(e,t){var n=Bp(e,t);if(!n)return e+"";var r=n[0],o=n[1],a=o-(_F=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Bp(e,Math.max(0,t+a-1))[0]}function jF(e,t){var n=Bp(e,t);if(!n)return e+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const EF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:nde,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>jF(e*100,t),r:jF,s:sde,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function SF(e){return e}var CF=Array.prototype.map,OF=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function cde(e){var t=e.grouping===void 0||e.thousands===void 0?SF:rde(CF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?SF:ode(CF.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Zl(d);var f=d.fill,h=d.align,y=d.sign,m=d.symbol,v=d.zero,b=d.width,x=d.comma,_=d.precision,w=d.trim,j=d.type;j==="n"?(x=!0,j="g"):EF[j]||(_===void 0&&(_=12),w=!0,j="g"),(v||f==="0"&&h==="=")&&(v=!0,f="0",h="=");var E=m==="$"?n:m==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",S=m==="$"?r:/[%p]/.test(j)?i:"",O=EF[j],k=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function N(P){var R=E,A=S,C,M,T;if(j==="c")A=O(P)+A,P="";else{P=+P;var D=P<0||1/P<0;if(P=isNaN(P)?c:O(Math.abs(P),_),w&&(P=ide(P)),D&&+P==0&&y!=="+"&&(D=!1),R=(D?y==="("?y:s:y==="-"||y==="("?"":y)+R,A=(j==="s"?OF[8+_F/3]:"")+A+(D&&y==="("?")":""),k){for(C=-1,M=P.length;++C<M;)if(T=P.charCodeAt(C),48>T||T>57){A=(T===46?o+P.slice(C+1):P.slice(C))+A,P=P.slice(0,C);break}}}x&&!v&&(P=t(P,1/0));var I=R.length+P.length+A.length,L=I<b?new Array(b-I+1).join(f):"";switch(x&&v&&(P=t(L+P,L.length?b-A.length:1/0),L=""),h){case"<":P=R+P+A+L;break;case"=":P=R+L+P+A;break;case"^":P=L.slice(0,I=L.length>>1)+R+P+A+L.slice(I);break;default:P=L+R+P+A;break}return a(P)}return N.toString=function(){return d+""},N}function u(d,f){var h=l((d=Zl(d),d.type="f",d)),y=Math.max(-8,Math.min(8,Math.floor(Ss(f)/3)))*3,m=Math.pow(10,-y),v=OF[8+y/3];return function(b){return h(m*b)+v}}return{format:l,formatPrefix:u}}var $p,f_,NF;lde({thousands:",",grouping:[3],currency:["$",""]});function lde(e){return $p=cde(e),f_=$p.format,NF=$p.formatPrefix,$p}function ude(e){return Math.max(0,-Ss(Math.abs(e)))}function dde(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ss(t)/3)))*3-Ss(Math.abs(e)))}function fde(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ss(t)-Ss(e))+1}function MF(e,t,n,r){var o=i_(e,t,n),a;switch(r=Zl(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=dde(o,i))&&(r.precision=a),NF(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=fde(o,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=ude(o))&&(r.precision=a-(r.type==="%")*2);break}}return f_(r)}function da(e){var t=e.domain;return e.ticks=function(n){var r=t();return o_(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var o=t();return MF(o[0],o[o.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),o=0,a=r.length-1,i=r[o],s=r[a],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=o,o=a,a=l);u-- >0;){if(l=a_(i,s,n),l===c)return r[o]=i,r[a]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function zp(){var e=u_();return e.copy=function(){return Gl(e,zp())},Qn.apply(e,arguments),da(e)}function kF(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Lp),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return kF(e).unknown(t)},e=arguments.length?Array.from(e,Lp):[0,1],da(n)}function PF(e,t){e=e.slice();var n=0,r=e.length-1,o=e[n],a=e[r],i;return a<o&&(i=n,n=r,r=i,i=o,o=a,a=i),e[n]=t.floor(o),e[r]=t.ceil(a),e}function AF(e){return Math.log(e)}function TF(e){return Math.exp(e)}function pde(e){return-Math.log(-e)}function hde(e){return-Math.exp(-e)}function mde(e){return isFinite(e)?+("1e"+e):e<0?0:e}function yde(e){return e===10?mde:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gde(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function RF(e){return(t,n)=>-e(-t,n)}function p_(e){const t=e(AF,TF),n=t.domain;let r=10,o,a;function i(){return o=gde(r),a=yde(r),n()[0]<0?(o=RF(o),a=RF(a),e(pde,hde)):e(AF,TF),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let f=o(l),h=o(u),y,m;const v=s==null?10:+s;let b=[];if(!(r%1)&&h-f<v){if(f=Math.floor(f),h=Math.ceil(h),l>0){for(;f<=h;++f)for(y=1;y<r;++y)if(m=f<0?y/a(-f):y*a(f),!(m<l)){if(m>u)break;b.push(m)}}else for(;f<=h;++f)for(y=r-1;y>=1;--y)if(m=f>0?y/a(-f):y*a(f),!(m<l)){if(m>u)break;b.push(m)}b.length*2<v&&(b=o_(l,u,v))}else b=o_(f,h,Math.min(h-f,v)).map(a);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Zl(c)).precision==null&&(c.trim=!0),c=f_(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/a(Math.round(o(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(PF(n(),{floor:s=>a(Math.floor(o(s))),ceil:s=>a(Math.ceil(o(s)))})),t}function IF(){const e=p_(Fp()).domain([1,10]);return e.copy=()=>Gl(e,IF()).base(e.base()),Qn.apply(e,arguments),e}function DF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function LF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function h_(e){var t=1,n=e(DF(t),LF(t));return n.constant=function(r){return arguments.length?e(DF(t=+r),LF(t)):t},da(n)}function FF(){var e=h_(Fp());return e.copy=function(){return Gl(e,FF()).constant(e.constant())},Qn.apply(e,arguments)}function BF(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vde(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bde(e){return e<0?-e*e:e*e}function m_(e){var t=e(gn,gn),n=1;function r(){return n===1?e(gn,gn):n===.5?e(vde,bde):e(BF(n),BF(1/n))}return t.exponent=function(o){return arguments.length?(n=+o,r()):n},da(t)}function y_(){var e=m_(Fp());return e.copy=function(){return Gl(e,y_()).exponent(e.exponent())},Qn.apply(e,arguments),e}function xde(){return y_.apply(null,arguments).exponent(.5)}function $F(e){return Math.sign(e)*e*e}function wde(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function zF(){var e=u_(),t=[0,1],n=!1,r;function o(a){var i=wde(e(a));return isNaN(i)?r:n?Math.round(i):i}return o.invert=function(a){return e.invert($F(a))},o.domain=function(a){return arguments.length?(e.domain(a),o):e.domain()},o.range=function(a){return arguments.length?(e.range((t=Array.from(a,Lp)).map($F)),o):t.slice()},o.rangeRound=function(a){return o.range(a).round(!0)},o.round=function(a){return arguments.length?(n=!!a,o):n},o.clamp=function(a){return arguments.length?(e.clamp(a),o):e.clamp()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.copy=function(){return zF(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Qn.apply(o,arguments),da(o)}function VF(){var e=[],t=[],n=[],r;function o(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=Que(e,i/s);return a}function a(i){return i==null||isNaN(i=+i)?r:t[Kl(n,i)]}return a.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ua),o()},a.range=function(i){return arguments.length?(t=Array.from(i),o()):t.slice()},a.unknown=function(i){return arguments.length?(r=i,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return VF().domain(e).range(t).unknown(r)},Qn.apply(a,arguments)}function UF(){var e=0,t=1,n=1,r=[.5],o=[0,1],a;function i(c){return c!=null&&c<=c?o[Kl(r,c,0,n)]:a}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(o=Array.from(c)).length-1,s()):o.slice()},i.invertExtent=function(c){var l=o.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return UF().domain([e,t]).range(o).unknown(a)},Qn.apply(da(i),arguments)}function HF(){var e=[.5],t=[0,1],n,r=1;function o(a){return a!=null&&a<=a?t[Kl(e,a,0,r)]:n}return o.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},o.unknown=function(a){return arguments.length?(n=a,o):n},o.copy=function(){return HF().domain(e).range(t).unknown(n)},Qn.apply(o,arguments)}const g_=new Date,v_=new Date;function Vt(e,t,n,r){function o(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return o.floor=a=>(e(a=new Date(+a)),a),o.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),o.round=a=>{const i=o(a),s=o.ceil(a);return a-i<s-a?i:s},o.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),o.range=(a,i,s)=>{const c=[];if(a=o.ceil(a),s=s==null?1:Math.floor(s),!(a<i)||!(s>0))return c;let l;do c.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<i);return c},o.filter=a=>Vt(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!a(i););else for(;--s>=0;)for(;t(i,1),!a(i););}),n&&(o.count=(a,i)=>(g_.setTime(+a),v_.setTime(+i),e(g_),e(v_),Math.floor(n(g_,v_))),o.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?o.filter(r?i=>r(i)%a===0:i=>o.count(0,i)%a===0):o)),o}const Vp=Vt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Vp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vt(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Vp),Vp.range;const Ro=1e3,Jn=Ro*60,Io=Jn*60,Do=Io*24,b_=Do*7,WF=Do*30,x_=Do*365,Qa=Vt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ro)},(e,t)=>(t-e)/Ro,e=>e.getUTCSeconds());Qa.range;const w_=Vt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ro)},(e,t)=>{e.setTime(+e+t*Jn)},(e,t)=>(t-e)/Jn,e=>e.getMinutes());w_.range;const __=Vt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Jn)},(e,t)=>(t-e)/Jn,e=>e.getUTCMinutes());__.range;const j_=Vt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ro-e.getMinutes()*Jn)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getHours());j_.range;const E_=Vt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getUTCHours());E_.range;const eu=Vt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Jn)/Do,e=>e.getDate()-1);eu.range;const Up=Vt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Do,e=>e.getUTCDate()-1);Up.range;const qF=Vt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Do,e=>Math.floor(e/Do));qF.range;function Ja(e){return Vt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Jn)/b_)}const Hp=Ja(0),Wp=Ja(1),_de=Ja(2),jde=Ja(3),Cs=Ja(4),Ede=Ja(5),Sde=Ja(6);Hp.range,Wp.range,_de.range,jde.range,Cs.range,Ede.range,Sde.range;function Ga(e){return Vt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/b_)}const qp=Ga(0),Yp=Ga(1),Cde=Ga(2),Ode=Ga(3),Os=Ga(4),Nde=Ga(5),Mde=Ga(6);qp.range,Yp.range,Cde.range,Ode.range,Os.range,Nde.range,Mde.range;const S_=Vt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());S_.range;const C_=Vt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());C_.range;const Lo=Vt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Lo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Lo.range;const Fo=Vt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Fo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Fo.range;function YF(e,t,n,r,o,a){const i=[[Qa,1,Ro],[Qa,5,5*Ro],[Qa,15,15*Ro],[Qa,30,30*Ro],[a,1,Jn],[a,5,5*Jn],[a,15,15*Jn],[a,30,30*Jn],[o,1,Io],[o,3,3*Io],[o,6,6*Io],[o,12,12*Io],[r,1,Do],[r,2,2*Do],[n,1,b_],[t,1,WF],[t,3,3*WF],[e,1,x_]];function s(l,u,d){const f=u<l;f&&([l,u]=[u,l]);const h=d&&typeof d.range=="function"?d:c(l,u,d),y=h?h.range(l,+u+1):[];return f?y.reverse():y}function c(l,u,d){const f=Math.abs(u-l)/d,h=r_(([,,v])=>v).right(i,f);if(h===i.length)return e.every(i_(l/x_,u/x_,d));if(h===0)return Vp.every(Math.max(i_(l,u,d),1));const[y,m]=i[f/i[h-1][2]<i[h][2]/f?h-1:h];return y.every(m)}return[s,c]}const[kde,Pde]=YF(Fo,C_,qp,qF,E_,__),[Ade,Tde]=YF(Lo,S_,Hp,eu,j_,w_);function O_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function N_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function tu(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Rde(e){var t=e.dateTime,n=e.date,r=e.time,o=e.periods,a=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=nu(o),u=ru(o),d=nu(a),f=ru(a),h=nu(i),y=ru(i),m=nu(s),v=ru(s),b=nu(c),x=ru(c),_={a:D,A:I,b:L,B,c:null,d:ZF,e:ZF,f:rfe,g:pfe,G:mfe,H:efe,I:tfe,j:nfe,L:eB,m:ofe,M:afe,p:U,q:F,Q:iB,s:sB,S:ife,u:sfe,U:cfe,V:lfe,w:ufe,W:dfe,x:null,X:null,y:ffe,Y:hfe,Z:yfe,"%":aB},w={a:H,A:J,b:q,B:re,c:null,d:nB,e:nB,f:xfe,g:kfe,G:Afe,H:gfe,I:vfe,j:bfe,L:rB,m:wfe,M:_fe,p:Z,q:Y,Q:iB,s:sB,S:jfe,u:Efe,U:Sfe,V:Cfe,w:Ofe,W:Nfe,x:null,X:null,y:Mfe,Y:Pfe,Z:Tfe,"%":aB},j={a:N,A:P,b:R,B:A,c:C,d:JF,e:JF,f:Qde,g:QF,G:XF,H:GF,I:GF,j:qde,L:Xde,m:Wde,M:Yde,p:k,q:Hde,Q:Gde,s:Zde,S:Kde,u:Bde,U:$de,V:zde,w:Fde,W:Vde,x:M,X:T,y:QF,Y:XF,Z:Ude,"%":Jde};_.x=E(n,_),_.X=E(r,_),_.c=E(t,_),w.x=E(n,w),w.X=E(r,w),w.c=E(t,w);function E(W,G){return function(te){var $=[],se=-1,ue=0,ve=W.length,Te,qe,Ye;for(te instanceof Date||(te=new Date(+te));++se<ve;)W.charCodeAt(se)===37&&($.push(W.slice(ue,se)),(qe=KF[Te=W.charAt(++se)])!=null?Te=W.charAt(++se):qe=Te==="e"?" ":"0",(Ye=G[Te])&&(Te=Ye(te,qe)),$.push(Te),ue=se+1);return $.push(W.slice(ue,se)),$.join("")}}function S(W,G){return function(te){var $=tu(1900,void 0,1),se=O($,W,te+="",0),ue,ve;if(se!=te.length)return null;if("Q"in $)return new Date($.Q);if("s"in $)return new Date($.s*1e3+("L"in $?$.L:0));if(G&&!("Z"in $)&&($.Z=0),"p"in $&&($.H=$.H%12+$.p*12),$.m===void 0&&($.m="q"in $?$.q:0),"V"in $){if($.V<1||$.V>53)return null;"w"in $||($.w=1),"Z"in $?(ue=N_(tu($.y,0,1)),ve=ue.getUTCDay(),ue=ve>4||ve===0?Yp.ceil(ue):Yp(ue),ue=Up.offset(ue,($.V-1)*7),$.y=ue.getUTCFullYear(),$.m=ue.getUTCMonth(),$.d=ue.getUTCDate()+($.w+6)%7):(ue=O_(tu($.y,0,1)),ve=ue.getDay(),ue=ve>4||ve===0?Wp.ceil(ue):Wp(ue),ue=eu.offset(ue,($.V-1)*7),$.y=ue.getFullYear(),$.m=ue.getMonth(),$.d=ue.getDate()+($.w+6)%7)}else("W"in $||"U"in $)&&("w"in $||($.w="u"in $?$.u%7:"W"in $?1:0),ve="Z"in $?N_(tu($.y,0,1)).getUTCDay():O_(tu($.y,0,1)).getDay(),$.m=0,$.d="W"in $?($.w+6)%7+$.W*7-(ve+5)%7:$.w+$.U*7-(ve+6)%7);return"Z"in $?($.H+=$.Z/100|0,$.M+=$.Z%100,N_($)):O_($)}}function O(W,G,te,$){for(var se=0,ue=G.length,ve=te.length,Te,qe;se<ue;){if($>=ve)return-1;if(Te=G.charCodeAt(se++),Te===37){if(Te=G.charAt(se++),qe=j[Te in KF?G.charAt(se++):Te],!qe||($=qe(W,te,$))<0)return-1}else if(Te!=te.charCodeAt($++))return-1}return $}function k(W,G,te){var $=l.exec(G.slice(te));return $?(W.p=u.get($[0].toLowerCase()),te+$[0].length):-1}function N(W,G,te){var $=h.exec(G.slice(te));return $?(W.w=y.get($[0].toLowerCase()),te+$[0].length):-1}function P(W,G,te){var $=d.exec(G.slice(te));return $?(W.w=f.get($[0].toLowerCase()),te+$[0].length):-1}function R(W,G,te){var $=b.exec(G.slice(te));return $?(W.m=x.get($[0].toLowerCase()),te+$[0].length):-1}function A(W,G,te){var $=m.exec(G.slice(te));return $?(W.m=v.get($[0].toLowerCase()),te+$[0].length):-1}function C(W,G,te){return O(W,t,G,te)}function M(W,G,te){return O(W,n,G,te)}function T(W,G,te){return O(W,r,G,te)}function D(W){return i[W.getDay()]}function I(W){return a[W.getDay()]}function L(W){return c[W.getMonth()]}function B(W){return s[W.getMonth()]}function U(W){return o[+(W.getHours()>=12)]}function F(W){return 1+~~(W.getMonth()/3)}function H(W){return i[W.getUTCDay()]}function J(W){return a[W.getUTCDay()]}function q(W){return c[W.getUTCMonth()]}function re(W){return s[W.getUTCMonth()]}function Z(W){return o[+(W.getUTCHours()>=12)]}function Y(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var G=E(W+="",_);return G.toString=function(){return W},G},parse:function(W){var G=S(W+="",!1);return G.toString=function(){return W},G},utcFormat:function(W){var G=E(W+="",w);return G.toString=function(){return W},G},utcParse:function(W){var G=S(W+="",!0);return G.toString=function(){return W},G}}}var KF={"-":"",_:" ",0:"0"},qt=/^\s*\d+/,Ide=/^%/,Dde=/[\\^$*+?|[\]().{}]/g;function tt(e,t,n){var r=e<0?"-":"",o=(r?-e:e)+"",a=o.length;return r+(a<n?new Array(n-a+1).join(t)+o:o)}function Lde(e){return e.replace(Dde,"\\$&")}function nu(e){return new RegExp("^(?:"+e.map(Lde).join("|")+")","i")}function ru(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Fde(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Bde(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function $de(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function zde(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Vde(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function XF(e,t,n){var r=qt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function QF(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ude(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Hde(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Wde(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function JF(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function qde(e,t,n){var r=qt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function GF(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Yde(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Kde(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Xde(e,t,n){var r=qt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Qde(e,t,n){var r=qt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Jde(e,t,n){var r=Ide.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Gde(e,t,n){var r=qt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Zde(e,t,n){var r=qt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function ZF(e,t){return tt(e.getDate(),t,2)}function efe(e,t){return tt(e.getHours(),t,2)}function tfe(e,t){return tt(e.getHours()%12||12,t,2)}function nfe(e,t){return tt(1+eu.count(Lo(e),e),t,3)}function eB(e,t){return tt(e.getMilliseconds(),t,3)}function rfe(e,t){return eB(e,t)+"000"}function ofe(e,t){return tt(e.getMonth()+1,t,2)}function afe(e,t){return tt(e.getMinutes(),t,2)}function ife(e,t){return tt(e.getSeconds(),t,2)}function sfe(e){var t=e.getDay();return t===0?7:t}function cfe(e,t){return tt(Hp.count(Lo(e)-1,e),t,2)}function tB(e){var t=e.getDay();return t>=4||t===0?Cs(e):Cs.ceil(e)}function lfe(e,t){return e=tB(e),tt(Cs.count(Lo(e),e)+(Lo(e).getDay()===4),t,2)}function ufe(e){return e.getDay()}function dfe(e,t){return tt(Wp.count(Lo(e)-1,e),t,2)}function ffe(e,t){return tt(e.getFullYear()%100,t,2)}function pfe(e,t){return e=tB(e),tt(e.getFullYear()%100,t,2)}function hfe(e,t){return tt(e.getFullYear()%1e4,t,4)}function mfe(e,t){var n=e.getDay();return e=n>=4||n===0?Cs(e):Cs.ceil(e),tt(e.getFullYear()%1e4,t,4)}function yfe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+tt(t/60|0,"0",2)+tt(t%60,"0",2)}function nB(e,t){return tt(e.getUTCDate(),t,2)}function gfe(e,t){return tt(e.getUTCHours(),t,2)}function vfe(e,t){return tt(e.getUTCHours()%12||12,t,2)}function bfe(e,t){return tt(1+Up.count(Fo(e),e),t,3)}function rB(e,t){return tt(e.getUTCMilliseconds(),t,3)}function xfe(e,t){return rB(e,t)+"000"}function wfe(e,t){return tt(e.getUTCMonth()+1,t,2)}function _fe(e,t){return tt(e.getUTCMinutes(),t,2)}function jfe(e,t){return tt(e.getUTCSeconds(),t,2)}function Efe(e){var t=e.getUTCDay();return t===0?7:t}function Sfe(e,t){return tt(qp.count(Fo(e)-1,e),t,2)}function oB(e){var t=e.getUTCDay();return t>=4||t===0?Os(e):Os.ceil(e)}function Cfe(e,t){return e=oB(e),tt(Os.count(Fo(e),e)+(Fo(e).getUTCDay()===4),t,2)}function Ofe(e){return e.getUTCDay()}function Nfe(e,t){return tt(Yp.count(Fo(e)-1,e),t,2)}function Mfe(e,t){return tt(e.getUTCFullYear()%100,t,2)}function kfe(e,t){return e=oB(e),tt(e.getUTCFullYear()%100,t,2)}function Pfe(e,t){return tt(e.getUTCFullYear()%1e4,t,4)}function Afe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Os(e):Os.ceil(e),tt(e.getUTCFullYear()%1e4,t,4)}function Tfe(){return"+0000"}function aB(){return"%"}function iB(e){return+e}function sB(e){return Math.floor(+e/1e3)}var Ns,cB,lB;Rfe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Rfe(e){return Ns=Rde(e),cB=Ns.format,Ns.parse,lB=Ns.utcFormat,Ns.utcParse,Ns}function Ife(e){return new Date(e)}function Dfe(e){return e instanceof Date?+e:+new Date(+e)}function M_(e,t,n,r,o,a,i,s,c,l){var u=u_(),d=u.invert,f=u.domain,h=l(".%L"),y=l(":%S"),m=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),x=l("%b %d"),_=l("%B"),w=l("%Y");function j(E){return(c(E)<E?h:s(E)<E?y:i(E)<E?m:a(E)<E?v:r(E)<E?o(E)<E?b:x:n(E)<E?_:w)(E)}return u.invert=function(E){return new Date(d(E))},u.domain=function(E){return arguments.length?f(Array.from(E,Dfe)):f().map(Ife)},u.ticks=function(E){var S=f();return e(S[0],S[S.length-1],E??10)},u.tickFormat=function(E,S){return S==null?j:l(S)},u.nice=function(E){var S=f();return(!E||typeof E.range!="function")&&(E=t(S[0],S[S.length-1],E??10)),E?f(PF(S,E)):u},u.copy=function(){return Gl(u,M_(e,t,n,r,o,a,i,s,c,l))},u}function Lfe(){return Qn.apply(M_(Ade,Tde,Lo,S_,Hp,eu,j_,w_,Qa,cB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ffe(){return Qn.apply(M_(kde,Pde,Fo,C_,qp,Up,E_,__,Qa,lB).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Kp(){var e=0,t=1,n,r,o,a,i=gn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(o===0?.5:(d=(a(d)-n)*o,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=a(e=+e),r=a(t=+t),o=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(f){var h,y;return arguments.length?([h,y]=f,i=d(h,y),l):[i(0),i(1)]}}return l.range=u(qi),l.rangeRound=u(Cb),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return a=d,n=d(e),r=d(t),o=n===r?0:1/(r-n),l}}function fa(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function uB(){var e=da(Kp()(gn));return e.copy=function(){return fa(e,uB())},To.apply(e,arguments)}function dB(){var e=p_(Kp()).domain([1,10]);return e.copy=function(){return fa(e,dB()).base(e.base())},To.apply(e,arguments)}function fB(){var e=h_(Kp());return e.copy=function(){return fa(e,fB()).constant(e.constant())},To.apply(e,arguments)}function k_(){var e=m_(Kp());return e.copy=function(){return fa(e,k_()).exponent(e.exponent())},To.apply(e,arguments)}function Bfe(){return k_.apply(null,arguments).exponent(.5)}function pB(){var e=[],t=gn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Kl(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let o of r)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ua),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,o)=>t(o/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(o,a)=>Xue(e,a/r))},n.copy=function(){return pB(t).domain(e)},To.apply(n,arguments)}function Xp(){var e=0,t=.5,n=1,r=1,o,a,i,s,c,l=gn,u,d=!1,f;function h(m){return isNaN(m=+m)?f:(m=.5+((m=+u(m))-a)*(r*m<r*a?s:c),l(d?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,n]=m,o=u(e=+e),a=u(t=+t),i=u(n=+n),s=o===a?0:.5/(a-o),c=a===i?0:.5/(i-a),r=a<o?-1:1,h):[e,t,n]},h.clamp=function(m){return arguments.length?(d=!!m,h):d},h.interpolator=function(m){return arguments.length?(l=m,h):l};function y(m){return function(v){var b,x,_;return arguments.length?([b,x,_]=v,l=jJ(m,[b,x,_]),h):[l(0),l(.5),l(1)]}}return h.range=y(qi),h.rangeRound=y(Cb),h.unknown=function(m){return arguments.length?(f=m,h):f},function(m){return u=m,o=m(e),a=m(t),i=m(n),s=o===a?0:.5/(a-o),c=a===i?0:.5/(i-a),r=a<o?-1:1,h}}function hB(){var e=da(Xp()(gn));return e.copy=function(){return fa(e,hB())},To.apply(e,arguments)}function mB(){var e=p_(Xp()).domain([.1,1,10]);return e.copy=function(){return fa(e,mB()).base(e.base())},To.apply(e,arguments)}function yB(){var e=h_(Xp());return e.copy=function(){return fa(e,yB()).constant(e.constant())},To.apply(e,arguments)}function P_(){var e=m_(Xp());return e.copy=function(){return fa(e,P_()).exponent(e.exponent())},To.apply(e,arguments)}function $fe(){return P_.apply(null,arguments).exponent(.5)}const gB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ql,scaleDiverging:hB,scaleDivergingLog:mB,scaleDivergingPow:P_,scaleDivergingSqrt:$fe,scaleDivergingSymlog:yB,scaleIdentity:kF,scaleImplicit:s_,scaleLinear:zp,scaleLog:IF,scaleOrdinal:c_,scalePoint:Jl,scalePow:y_,scaleQuantile:VF,scaleQuantize:UF,scaleRadial:zF,scaleSequential:uB,scaleSequentialLog:dB,scaleSequentialPow:k_,scaleSequentialQuantile:pB,scaleSequentialSqrt:Bfe,scaleSequentialSymlog:fB,scaleSqrt:xde,scaleSymlog:FF,scaleThreshold:HF,scaleTime:Lfe,scaleUtc:Ffe,tickFormat:MF},Symbol.toStringTag,{value:"Module"}));var A_,vB;function bB(){if(vB)return A_;vB=1;var e=zi();function t(n,r,o){for(var a=-1,i=n.length;++a<i;){var s=n[a],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):o(c,l)))var l=c,u=s}return u}return A_=t,A_}var T_,xB;function zfe(){if(xB)return T_;xB=1;function e(t,n){return t>n}return T_=e,T_}var R_,wB;function Vfe(){if(wB)return R_;wB=1;var e=bB(),t=zfe(),n=Vi();function r(o){return o&&o.length?e(o,n,t):void 0}return R_=r,R_}var Ufe=Vfe();const Qp=Xe(Ufe);var I_,_B;function Hfe(){if(_B)return I_;_B=1;function e(t,n){return t<n}return I_=e,I_}var D_,jB;function Wfe(){if(jB)return D_;jB=1;var e=bB(),t=Hfe(),n=Vi();function r(o){return o&&o.length?e(o,n,t):void 0}return D_=r,D_}var qfe=Wfe();const Jp=Xe(qfe);var L_,EB;RE=function(){if(EB)return L_;EB=1;var e=nc(),t=Lr(),n=xL(),r=un();function o(a,i){var s=r(a)?e:n;return s(a,t(i,3))}return L_=o,L_};var F_,SB;function Yfe(){if(SB)return F_;SB=1;var e=Qh(),t=RE();function n(r,o){return e(t(r,o),1)}return F_=n,F_}var Kfe=Yfe();const Xfe=Xe(Kfe);var B_,CB;function Qfe(){if(CB)return B_;CB=1;var e=C0();function t(n,r){return e(n,r)}return B_=t,B_}var Jfe=Qfe();const $_=Xe(Jfe);var Ms=1e9,Gfe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},U_,Et=!0,Gn="[DecimalError] ",Za=Gn+"Invalid argument: ",z_=Gn+"Exponent out of range: ",ks=Math.floor,ei=Math.pow,Zfe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$n,Yt=1e7,xt=7,OB=9007199254740991,Gp=ks(OB/xt),Ee={};Ee.absoluteValue=Ee.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ee.comparedTo=Ee.cmp=function(e){var t,n,r,o,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(r=a.d.length,o=e.d.length,t=0,n=r<o?r:o;t<n;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return r===o?0:r>o^a.s<0?1:-1},Ee.decimalPlaces=Ee.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*xt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ee.dividedBy=Ee.div=function(e){return Bo(this,new this.constructor(e))},Ee.dividedToIntegerBy=Ee.idiv=function(e){var t=this,n=t.constructor;return ht(Bo(t,new n(e),0,1),n.precision)},Ee.equals=Ee.eq=function(e){return!this.cmp(e)},Ee.exponent=function(){return Lt(this)},Ee.greaterThan=Ee.gt=function(e){return this.cmp(e)>0},Ee.greaterThanOrEqualTo=Ee.gte=function(e){return this.cmp(e)>=0},Ee.isInteger=Ee.isint=function(){return this.e>this.d.length-2},Ee.isNegative=Ee.isneg=function(){return this.s<0},Ee.isPositive=Ee.ispos=function(){return this.s>0},Ee.isZero=function(){return this.s===0},Ee.lessThan=Ee.lt=function(e){return this.cmp(e)<0},Ee.lessThanOrEqualTo=Ee.lte=function(e){return this.cmp(e)<1},Ee.logarithm=Ee.log=function(e){var t,n=this,r=n.constructor,o=r.precision,a=o+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq($n))throw Error(Gn+"NaN");if(n.s<1)throw Error(Gn+(n.s?"NaN":"-Infinity"));return n.eq($n)?new r(0):(Et=!1,t=Bo(ou(n,a),ou(e,a),a),Et=!0,ht(t,o))},Ee.minus=Ee.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?PB(t,e):NB(t,(e.s=-e.s,e))},Ee.modulo=Ee.mod=function(e){var t,n=this,r=n.constructor,o=r.precision;if(e=new r(e),!e.s)throw Error(Gn+"NaN");return n.s?(Et=!1,t=Bo(n,e,0,1).times(e),Et=!0,n.minus(t)):ht(new r(n),o)},Ee.naturalExponential=Ee.exp=function(){return MB(this)},Ee.naturalLogarithm=Ee.ln=function(){return ou(this)},Ee.negated=Ee.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ee.plus=Ee.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?NB(t,e):PB(t,(e.s=-e.s,e))},Ee.precision=Ee.sd=function(e){var t,n,r,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Za+e);if(t=Lt(o)+1,r=o.d.length-1,n=r*xt+1,r=o.d[r],r){for(;r%10==0;r/=10)n--;for(r=o.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ee.squareRoot=Ee.sqrt=function(){var e,t,n,r,o,a,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Gn+"NaN")}for(e=Lt(s),Et=!1,o=Math.sqrt(+s),o==0||o==1/0?(t=Yr(s.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=ks((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(o.toString()),n=c.precision,o=i=n+3;;)if(a=r,r=a.plus(Bo(s,a,i+2)).times(.5),Yr(a.d).slice(0,i)===(t=Yr(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),o==i&&t=="4999"){if(ht(a,n+1,0),a.times(a).eq(s)){r=a;break}}else if(t!="9999")break;i+=4}return Et=!0,ht(r,n)},Ee.times=Ee.mul=function(e){var t,n,r,o,a,i,s,c,l,u=this,d=u.constructor,f=u.d,h=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=f.length,l=h.length,c<l&&(a=f,f=h,h=a,i=c,c=l,l=i),a=[],i=c+l,r=i;r--;)a.push(0);for(r=l;--r>=0;){for(t=0,o=c+r;o>r;)s=a[o]+h[r]*f[o-r-1]+t,a[o--]=s%Yt|0,t=s/Yt|0;a[o]=(a[o]+t)%Yt|0}for(;!a[--i];)a.pop();return t?++n:a.shift(),e.d=a,e.e=n,Et?ht(e,d.precision):e},Ee.toDecimalPlaces=Ee.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(qr(e,0,Ms),t===void 0?t=r.rounding:qr(t,0,8),ht(n,e+Lt(n)+1,t))},Ee.toExponential=function(e,t){var n,r=this,o=r.constructor;return e===void 0?n=ti(r,!0):(qr(e,0,Ms),t===void 0?t=o.rounding:qr(t,0,8),r=ht(new o(r),e+1,t),n=ti(r,!0,e+1)),n},Ee.toFixed=function(e,t){var n,r,o=this,a=o.constructor;return e===void 0?ti(o):(qr(e,0,Ms),t===void 0?t=a.rounding:qr(t,0,8),r=ht(new a(o),e+Lt(o)+1,t),n=ti(r.abs(),!1,e+Lt(r)+1),o.isneg()&&!o.isZero()?"-"+n:n)},Ee.toInteger=Ee.toint=function(){var e=this,t=e.constructor;return ht(new t(e),Lt(e)+1,t.rounding)},Ee.toNumber=function(){return+this},Ee.toPower=Ee.pow=function(e){var t,n,r,o,a,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c($n);if(s=new c(s),!s.s){if(e.s<1)throw Error(Gn+"Infinity");return s}if(s.eq($n))return s;if(r=c.precision,e.eq($n))return ht(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,a=s.s,i){if((n=u<0?-u:u)<=OB){for(o=new c($n),t=Math.ceil(r/xt+4),Et=!1;n%2&&(o=o.times(s),AB(o.d,t)),n=ks(n/2),n!==0;)s=s.times(s),AB(s.d,t);return Et=!0,e.s<0?new c($n).div(o):ht(o,r)}}else if(a<0)throw Error(Gn+"NaN");return a=a<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Et=!1,o=e.times(ou(s,r+l)),Et=!0,o=MB(o),o.s=a,o},Ee.toPrecision=function(e,t){var n,r,o=this,a=o.constructor;return e===void 0?(n=Lt(o),r=ti(o,n<=a.toExpNeg||n>=a.toExpPos)):(qr(e,1,Ms),t===void 0?t=a.rounding:qr(t,0,8),o=ht(new a(o),e,t),n=Lt(o),r=ti(o,e<=n||n<=a.toExpNeg,e)),r},Ee.toSignificantDigits=Ee.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(qr(e,1,Ms),t===void 0?t=r.rounding:qr(t,0,8)),ht(new r(n),e,t)},Ee.toString=Ee.valueOf=Ee.val=Ee.toJSON=Ee[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Lt(e),n=e.constructor;return ti(e,t<=n.toExpNeg||t>=n.toExpPos)};function NB(e,t){var n,r,o,a,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Et?ht(t,d):t;if(c=e.d,l=t.d,i=e.e,o=t.e,c=c.slice(),a=i-o,a){for(a<0?(r=c,a=-a,s=l.length):(r=l,o=i,s=c.length),i=Math.ceil(d/xt),s=i>s?i+1:s+1,a>s&&(a=s,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for(s=c.length,a=l.length,s-a<0&&(a=s,r=l,l=c,c=r),n=0;a;)n=(c[--a]=c[a]+l[a]+n)/Yt|0,c[a]%=Yt;for(n&&(c.unshift(n),++o),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=o,Et?ht(t,d):t}function qr(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Za+e)}function Yr(e){var t,n,r,o=e.length-1,a="",i=e[0];if(o>0){for(a+=i,t=1;t<o;t++)r=e[t]+"",n=xt-r.length,n&&(a+=pa(n)),a+=r;i=e[t],r=i+"",n=xt-r.length,n&&(a+=pa(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var Bo=function(){function e(r,o){var a,i=0,s=r.length;for(r=r.slice();s--;)a=r[s]*o+i,r[s]=a%Yt|0,i=a/Yt|0;return i&&r.unshift(i),r}function t(r,o,a,i){var s,c;if(a!=i)c=a>i?1:-1;else for(s=c=0;s<a;s++)if(r[s]!=o[s]){c=r[s]>o[s]?1:-1;break}return c}function n(r,o,a){for(var i=0;a--;)r[a]-=i,i=r[a]<o[a]?1:0,r[a]=i*Yt+r[a]-o[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,o,a,i){var s,c,l,u,d,f,h,y,m,v,b,x,_,w,j,E,S,O,k=r.constructor,N=r.s==o.s?1:-1,P=r.d,R=o.d;if(!r.s)return new k(r);if(!o.s)throw Error(Gn+"Division by zero");for(c=r.e-o.e,S=R.length,j=P.length,h=new k(N),y=h.d=[],l=0;R[l]==(P[l]||0);)++l;if(R[l]>(P[l]||0)&&--c,a==null?x=a=k.precision:i?x=a+(Lt(r)-Lt(o))+1:x=a,x<0)return new k(0);if(x=x/xt+2|0,l=0,S==1)for(u=0,R=R[0],x++;(l<j||u)&&x--;l++)_=u*Yt+(P[l]||0),y[l]=_/R|0,u=_%R|0;else{for(u=Yt/(R[0]+1)|0,u>1&&(R=e(R,u),P=e(P,u),S=R.length,j=P.length),w=S,m=P.slice(0,S),v=m.length;v<S;)m[v++]=0;O=R.slice(),O.unshift(0),E=R[0],R[1]>=Yt/2&&++E;do u=0,s=t(R,m,S,v),s<0?(b=m[0],S!=v&&(b=b*Yt+(m[1]||0)),u=b/E|0,u>1?(u>=Yt&&(u=Yt-1),d=e(R,u),f=d.length,v=m.length,s=t(d,m,f,v),s==1&&(u--,n(d,S<f?O:R,f))):(u==0&&(s=u=1),d=R.slice()),f=d.length,f<v&&d.unshift(0),n(m,d,v),s==-1&&(v=m.length,s=t(R,m,S,v),s<1&&(u++,n(m,S<v?O:R,v))),v=m.length):s===0&&(u++,m=[0]),y[l++]=u,s&&m[0]?m[v++]=P[w]||0:(m=[P[w]],v=1);while((w++<j||m[0]!==void 0)&&x--)}return y[0]||y.shift(),h.e=c,ht(h,i?a+Lt(h)+1:a)}}();function MB(e,t){var n,r,o,a,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(Lt(e)>16)throw Error(z_+Lt(e));if(!e.s)return new u($n);for(t==null?(Et=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(ei(2,l))/Math.LN10*2+5|0,s+=r,n=o=a=new u($n),u.precision=s;;){if(o=ht(o.times(e),s),n=n.times(++c),i=a.plus(Bo(o,n,s)),Yr(i.d).slice(0,s)===Yr(a.d).slice(0,s)){for(;l--;)a=ht(a.times(a),s);return u.precision=d,t==null?(Et=!0,ht(a,d)):a}a=i}}function Lt(e){for(var t=e.e*xt,n=e.d[0];n>=10;n/=10)t++;return t}function V_(e,t,n){if(t>e.LN10.sd())throw Et=!0,n&&(e.precision=n),Error(Gn+"LN10 precision limit exceeded");return ht(new e(e.LN10),t)}function pa(e){for(var t="";e--;)t+="0";return t}function ou(e,t){var n,r,o,a,i,s,c,l,u,d=1,f=10,h=e,y=h.d,m=h.constructor,v=m.precision;if(h.s<1)throw Error(Gn+(h.s?"NaN":"-Infinity"));if(h.eq($n))return new m(0);if(t==null?(Et=!1,l=v):l=t,h.eq(10))return t==null&&(Et=!0),V_(m,l);if(l+=f,m.precision=l,n=Yr(y),r=n.charAt(0),a=Lt(h),Math.abs(a)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(e),n=Yr(h.d),r=n.charAt(0),d++;a=Lt(h),r>1?(h=new m("0."+n),a++):h=new m(r+"."+n.slice(1))}else return c=V_(m,l+2,v).times(a+""),h=ou(new m(r+"."+n.slice(1)),l-f).plus(c),m.precision=v,t==null?(Et=!0,ht(h,v)):h;for(s=i=h=Bo(h.minus($n),h.plus($n),l),u=ht(h.times(h),l),o=3;;){if(i=ht(i.times(u),l),c=s.plus(Bo(i,new m(o),l)),Yr(c.d).slice(0,l)===Yr(s.d).slice(0,l))return s=s.times(2),a!==0&&(s=s.plus(V_(m,l+2,v).times(a+""))),s=Bo(s,new m(d),l),m.precision=v,t==null?(Et=!0,ht(s,v)):s;s=c,o+=2}}function kB(e,t){var n,r,o;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(r,o),t){if(o-=r,n=n-r-1,e.e=ks(n/xt),e.d=[],r=(n+1)%xt,n<0&&(r+=xt),r<o){for(r&&e.d.push(+t.slice(0,r)),o-=xt;r<o;)e.d.push(+t.slice(r,r+=xt));t=t.slice(r),r=xt-t.length}else r-=o;for(;r--;)t+="0";if(e.d.push(+t),Et&&(e.e>Gp||e.e<-Gp))throw Error(z_+n)}else e.s=0,e.e=0,e.d=[0];return e}function ht(e,t,n){var r,o,a,i,s,c,l,u,d=e.d;for(i=1,a=d[0];a>=10;a/=10)i++;if(r=t-i,r<0)r+=xt,o=t,l=d[u=0];else{if(u=Math.ceil((r+1)/xt),a=d.length,u>=a)return e;for(l=a=d[u],i=1;a>=10;a/=10)i++;r%=xt,o=r-xt+i}if(n!==void 0&&(a=ei(10,i-o-1),s=l/a%10|0,c=t<0||d[u+1]!==void 0||l%a,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?o>0?l/ei(10,i-o):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(a=Lt(e),d.length=1,t=t-a-1,d[0]=ei(10,(xt-t%xt)%xt),e.e=ks(-t/xt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,a=1,u--):(d.length=u+1,a=ei(10,xt-r),d[u]=o>0?(l/ei(10,i-o)%ei(10,o)|0)*a:0),c)for(;;)if(u==0){(d[0]+=a)==Yt&&(d[0]=1,++e.e);break}else{if(d[u]+=a,d[u]!=Yt)break;d[u--]=0,a=1}for(r=d.length;d[--r]===0;)d.pop();if(Et&&(e.e>Gp||e.e<-Gp))throw Error(z_+Lt(e));return e}function PB(e,t){var n,r,o,a,i,s,c,l,u,d,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Et?ht(t,h):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),o=Math.max(Math.ceil(h/xt),s)+2,i>o&&(i=o,n.length=1),n.reverse(),o=i;o--;)n.push(0);n.reverse()}else{for(o=c.length,s=d.length,u=o<s,u&&(s=o),o=0;o<s;o++)if(c[o]!=d[o]){u=c[o]<d[o];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,o=d.length-s;o>0;--o)c[s++]=0;for(o=d.length;o>i;){if(c[--o]<d[o]){for(a=o;a&&c[--a]===0;)c[a]=Yt-1;--c[a],c[o]+=Yt}c[o]-=d[o]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Et?ht(t,h):t):new f(0)}function ti(e,t,n){var r,o=Lt(e),a=Yr(e.d),i=a.length;return t?(n&&(r=n-i)>0?a=a.charAt(0)+"."+a.slice(1)+pa(r):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(o<0?"e":"e+")+o):o<0?(a="0."+pa(-o-1)+a,n&&(r=n-i)>0&&(a+=pa(r))):o>=i?(a+=pa(o+1-i),n&&(r=n-o-1)>0&&(a=a+"."+pa(r))):((r=o+1)<i&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-i)>0&&(o+1===i&&(a+="."),a+=pa(r))),e.s<0?"-"+a:a}function AB(e,t){if(e.length>t)return e.length=t,!0}function TB(e){var t,n,r;function o(a){var i=this;if(!(i instanceof o))return new o(a);if(i.constructor=o,a instanceof o){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Za+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return kB(i,a.toString())}else if(typeof a!="string")throw Error(Za+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,Zfe.test(a))kB(i,a);else throw Error(Za+a)}if(o.prototype=Ee,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=TB,o.config=o.set=epe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return o.config(e),o}function epe(e){if(!e||typeof e!="object")throw Error(Gn+"Object expected");var t,n,r,o=["precision",1,Ms,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((r=e[n=o[t]])!==void 0)if(ks(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(Za+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Za+n+": "+r);return this}var U_=TB(Gfe);$n=new U_(1);const ft=U_;function tpe(e){return ape(e)||ope(e)||rpe(e)||npe()}function npe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rpe(e,t){if(e){if(typeof e=="string")return H_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H_(e,t)}}function ope(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ape(e){if(Array.isArray(e))return H_(e)}function H_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ipe=function(e){return e},RB={"@@functional/placeholder":!0},IB=function(e){return e===RB},DB=function(e){return function t(){return arguments.length===0||arguments.length===1&&IB(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},spe=function e(t,n){return t===1?n:DB(function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];var i=o.filter(function(s){return s!==RB}).length;return i>=t?n.apply(void 0,o):e(t-i,DB(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=o.map(function(d){return IB(d)?c.shift():d});return n.apply(void 0,tpe(u).concat(c))}))})},Zp=function(e){return spe(e.length,e)},W_=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},cpe=Zp(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),lpe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return ipe;var r=t.reverse(),o=r[0],a=r.slice(1);return function(){return a.reduce(function(i,s){return s(i)},o.apply(void 0,arguments))}},q_=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},LB=function(e){var t=null,n=null;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t&&o.every(function(i,s){return i===t[s]})||(t=o,n=e.apply(void 0,o)),n}};function upe(e){var t;return e===0?t=1:t=Math.floor(new ft(e).abs().log(10).toNumber())+1,t}function dpe(e,t,n){for(var r=new ft(e),o=0,a=[];r.lt(t)&&o<1e5;)a.push(r.toNumber()),r=r.add(n),o++;return a}var fpe=Zp(function(e,t,n){var r=+e,o=+t;return r+n*(o-r)}),ppe=Zp(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),hpe=Zp(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const eh={rangeStep:dpe,getDigitCount:upe,interpolateNumber:fpe,uninterpolateNumber:ppe,uninterpolateTruncation:hpe};function Y_(e){return gpe(e)||ype(e)||FB(e)||mpe()}function mpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ype(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function gpe(e){if(Array.isArray(e))return K_(e)}function au(e,t){return xpe(e)||bpe(e,t)||FB(e,t)||vpe()}function vpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FB(e,t){if(e){if(typeof e=="string")return K_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K_(e,t)}}function K_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bpe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,o=!1,a=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){o=!0,a=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(o)throw a}}return n}}function xpe(e){if(Array.isArray(e))return e}function BB(e){var t=au(e,2),n=t[0],r=t[1],o=n,a=r;return n>r&&(o=r,a=n),[o,a]}function $B(e,t,n){if(e.lte(0))return new ft(0);var r=eh.getDigitCount(e.toNumber()),o=new ft(10).pow(r),a=e.div(o),i=r!==1?.05:.1,s=new ft(Math.ceil(a.div(i).toNumber())).add(n).mul(i),c=s.mul(o);return t?c:new ft(Math.ceil(c))}function wpe(e,t,n){var r=1,o=new ft(e);if(!o.isint()&&n){var a=Math.abs(e);a<1?(r=new ft(10).pow(eh.getDigitCount(e)-1),o=new ft(Math.floor(o.div(r).toNumber())).mul(r)):a>1&&(o=new ft(Math.floor(e)))}else e===0?o=new ft(Math.floor((t-1)/2)):n||(o=new ft(Math.floor(e)));var i=Math.floor((t-1)/2),s=lpe(cpe(function(c){return o.add(new ft(c-i).mul(r)).toNumber()}),W_);return s(0,t)}function zB(e,t,n,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new ft(0),tickMin:new ft(0),tickMax:new ft(0)};var a=$B(new ft(t).sub(e).div(n-1),r,o),i;e<=0&&t>=0?i=new ft(0):(i=new ft(e).add(t).div(2),i=i.sub(new ft(i).mod(a)));var s=Math.ceil(i.sub(e).div(a).toNumber()),c=Math.ceil(new ft(t).sub(i).div(a).toNumber()),l=s+c+1;return l>n?zB(e,t,n,r,o+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:a,tickMin:i.sub(new ft(s).mul(a)),tickMax:i.add(new ft(c).mul(a))})}function _pe(e){var t=au(e,2),n=t[0],r=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(o,2),s=BB([n,r]),c=au(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(Y_(W_(0,o-1).map(function(){return 1/0}))):[].concat(Y_(W_(0,o-1).map(function(){return-1/0})),[u]);return n>r?q_(d):d}if(l===u)return wpe(l,o,a);var f=zB(l,u,i,a),h=f.step,y=f.tickMin,m=f.tickMax,v=eh.rangeStep(y,m.add(new ft(.1).mul(h)),h);return n>r?q_(v):v}function jpe(e,t){var n=au(e,2),r=n[0],o=n[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=BB([r,o]),s=au(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,o];if(c===l)return[c];var u=Math.max(t,2),d=$B(new ft(l).sub(c).div(u-1),a,0),f=[].concat(Y_(eh.rangeStep(new ft(c),new ft(l).sub(new ft(.99).mul(d)),d)),[l]);return r>o?q_(f):f}var Epe=LB(_pe),Spe=LB(jpe),Cpe="Invariant failed";function ni(e,t){throw new Error(Cpe)}var Ope=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function th(){return th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},th.apply(this,arguments)}function Npe(e,t){return Ape(e)||Ppe(e,t)||kpe(e,t)||Mpe()}function Mpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kpe(e,t){if(e){if(typeof e=="string")return VB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VB(e,t)}}function VB(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ppe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function Ape(e){if(Array.isArray(e))return e}function Tpe(e,t){if(e==null)return{};var n=Rpe(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Rpe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Ipe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dpe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WB(r.key),r)}}function Lpe(e,t,n){return t&&Dpe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fpe(e,t,n){return t=nh(t),Bpe(e,UB()?Reflect.construct(t,n||[],nh(e).constructor):t.apply(e,n))}function Bpe(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $pe(e)}function $pe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UB(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UB=function(){return!!e})()}function nh(e){return nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nh(e)}function zpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X_(e,t)}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},X_(e,t)}function HB(e,t,n){return t=WB(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WB(e){var t=Vpe(e,"string");return Ps(t)=="symbol"?t:t+""}function Vpe(e,t){if(Ps(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ps(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rh=function(e){function t(){return Ipe(this,t),Fpe(this,t,arguments)}return zpe(t,e),Lpe(t,[{key:"render",value:function(){var n=this.props,r=n.offset,o=n.layout,a=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=Tpe(n,Ope),f=ot(d,!1);this.props.direction==="x"&&l.type!=="number"&&ni();var h=s.map(function(y){var m=c(y,i),v=m.x,b=m.y,x=m.value,_=m.errorVal;if(!_)return null;var w=[],j,E;if(Array.isArray(_)){var S=Npe(_,2);j=S[0],E=S[1]}else j=E=_;if(o==="vertical"){var O=l.scale,k=b+r,N=k+a,P=k-a,R=O(x-j),A=O(x+E);w.push({x1:A,y1:N,x2:A,y2:P}),w.push({x1:R,y1:k,x2:A,y2:k}),w.push({x1:R,y1:N,x2:R,y2:P})}else if(o==="horizontal"){var C=u.scale,M=v+r,T=M-a,D=M+a,I=C(x-j),L=C(x+E);w.push({x1:T,y1:L,x2:D,y2:L}),w.push({x1:M,y1:I,x2:M,y2:L}),w.push({x1:T,y1:I,x2:D,y2:I})}return V.createElement(Wt,th({className:"recharts-errorBar",key:"bar-".concat(w.map(function(B){return"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))},f),w.map(function(B){return V.createElement("line",th({},B,{key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))}))});return V.createElement(Wt,{className:"recharts-errorBars"},h)}}])}(V.Component);HB(rh,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),HB(rh,"displayName","ErrorBar");function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function qB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function ri(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qB(Object(n),!0).forEach(function(r){Upe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Upe(e,t,n){return t=Hpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hpe(e){var t=Wpe(e,"string");return iu(t)=="symbol"?t:t+""}function Wpe(e,t){if(iu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(iu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YB=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,o=e.legendContent,a=Bn(t,xs);if(!a)return null;var i=xs.defaultProps,s=i!==void 0?ri(ri({},i),a.props):{},c;return a.props&&a.props.payload?c=a.props&&a.props.payload:o==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,f=u.props,h=f.sectors||f.data||[];return l.concat(h.map(function(y){return{type:a.props.iconType||d.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,f=d!==void 0?ri(ri({},d),u.props):{},h=f.dataKey,y=f.name,m=f.legendType,v=f.hide;return{inactive:v,dataKey:h,type:s.iconType||m||"square",color:J_(u),value:y||h,payload:f}}),ri(ri(ri({},s),xs.getWithHeight(a,r)),{},{payload:c,item:a})};function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function KB(e){return Xpe(e)||Kpe(e)||Ype(e)||qpe()}function qpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ype(e,t){if(e){if(typeof e=="string")return Q_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q_(e,t)}}function Kpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xpe(e){if(Array.isArray(e))return Q_(e)}function Q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function XB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XB(Object(n),!0).forEach(function(r){As(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function As(e,t,n){return t=Qpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qpe(e){var t=Jpe(e,"string");return su(t)=="symbol"?t:t+""}function Jpe(e,t){if(su(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(su(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kr(e,t,n){return it(e)||it(t)?n:zt(t)?qn(e,t,n):We(t)?t(e):n}function oh(e,t,n,r){var o=Xfe(e,function(s){return Kr(s,t)});if(n==="number"){var a=o.filter(function(s){return me(s)||parseFloat(s)});return a.length?[Jp(a),Qp(a)]:[1/0,-1/0]}var i=r?o.filter(function(s){return!it(s)}):o;return i.map(function(s){return zt(s)||s instanceof Date?s:""})}var Gpe=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var s=o.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(xr(u-l)!==xr(d-u)){var h=[];if(xr(d-u)===xr(s[1]-s[0])){f=d;var y=u+s[1]-s[0];h[0]=Math.min(y,(y+l)/2),h[1]=Math.max(y,(y+l)/2)}else{f=l;var m=d+s[1]-s[0];h[0]=Math.min(u,(m+u)/2),h[1]=Math.max(u,(m+u)/2)}var v=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>v[0]&&e<=v[1]||e>=h[0]&&e<=h[1]){a=r[c].index;break}}else{var b=Math.min(l,d),x=Math.max(l,d);if(e>(b+u)/2&&e<=(x+u)/2){a=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){a=n[_].index;break}return a},J_=function(e){var t,n=e,r=n.type.displayName,o=(t=e.type)!==null&&t!==void 0&&t.defaultProps?Pt(Pt({},e.type.defaultProps),e.props):e.props,a=o.stroke,i=o.fill,s;switch(r){case"Line":s=a;break;case"Area":case"Radar":s=a&&a!=="none"?a:i;break;default:s=i;break}return s},Zpe=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,o=r===void 0?{}:r;if(!o)return{};for(var a={},i=Object.keys(o),s=0,c=i.length;s<c;s++)for(var l=o[i[s]].stackGroups,u=Object.keys(l),d=0,f=u.length;d<f;d++){var h=l[u[d]],y=h.items,m=h.cateAxisId,v=y.filter(function(E){return ko(E.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,x=b!==void 0?Pt(Pt({},b),v[0].props):v[0].props,_=x.barSize,w=x[m];a[w]||(a[w]=[]);var j=it(_)?t:_;a[w].push({item:v[0],stackList:v.slice(1),barSize:it(j)?void 0:Ka(j,n,0)})}}return a},ehe=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,o=e.sizeList,a=o===void 0?[]:o,i=e.maxBarSize,s=a.length;if(s<1)return null;var c=Ka(t,r,0,!0),l,u=[];if(a[0].barSize===+a[0].barSize){var d=!1,f=r/s,h=a.reduce(function(_,w){return _+w.barSize||0},0);h+=(s-1)*c,h>=r&&(h-=(s-1)*c,c=0),h>=r&&f>0&&(d=!0,f*=.9,h=s*f);var y=(r-h)/2>>0,m={offset:y-c,size:0};l=a.reduce(function(_,w){var j={item:w.item,position:{offset:m.offset+m.size+c,size:d?f:w.barSize}},E=[].concat(KB(_),[j]);return m=E[E.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(S){E.push({item:S,position:m})}),E},u)}else{var v=Ka(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var x=i===+i?Math.min(b,i):b;l=a.reduce(function(_,w,j){var E=[].concat(KB(_),[{item:w.item,position:{offset:v+(b+c)*j+(b-x)/2,size:x}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(S){E.push({item:S,position:E[E.length-1].position})}),E},u)}return l},the=function(e,t,n,r){var o=n.children,a=n.width,i=n.margin,s=a-(i.left||0)-(i.right||0),c=YB({children:o,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,f=c.align,h=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&h==="middle")&&f!=="center"&&me(e[f]))return Pt(Pt({},e),{},As({},f,e[f]+(u||0)));if((y==="horizontal"||y==="vertical"&&f==="center")&&h!=="middle"&&me(e[h]))return Pt(Pt({},e),{},As({},h,e[h]+(d||0)))}return e},nhe=function(e,t,n){return it(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},QB=function(e,t,n,r,o){var a=t.props.children,i=wr(a,rh).filter(function(c){return nhe(r,o,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=Kr(l,n);if(it(u))return c;var d=Array.isArray(u)?[Jp(u),Qp(u)]:[u,u],f=s.reduce(function(h,y){var m=Kr(l,y,0),v=d[0]-Math.abs(Array.isArray(m)?m[0]:m),b=d[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(v,h[0]),Math.max(b,h[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},rhe=function(e,t,n,r,o){var a=t.map(function(i){return QB(e,i,n,o,r)}).filter(function(i){return!it(i)});return a&&a.length?a.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},JB=function(e,t,n,r,o){var a=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&QB(e,s,c,r)||oh(e,c,n,o)});if(n==="number")return a.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return a.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},GB=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},ZB=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var o,a,i=e.map(function(s){return s.coordinate===t&&(o=!0),s.coordinate===n&&(a=!0),s.coordinate});return o||i.push(t),a||i.push(n),i},$o=function(e,t,n){if(!e)return null;var r=e.scale,o=e.duplicateDomain,a=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&a==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?xr(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=o?o.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!Fl(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:o?o[u]:u,index:d,offset:c}})},G_=new WeakMap,ah=function(e,t){if(typeof t!="function")return e;G_.has(e)||G_.set(e,new WeakMap);var n=G_.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},ohe=function(e,t,n){var r=e.scale,o=e.type,a=e.layout,i=e.axisType;if(r==="auto")return a==="radial"&&i==="radiusAxis"?{scale:Ql(),realScaleType:"band"}:a==="radial"&&i==="angleAxis"?{scale:zp(),realScaleType:"linear"}:o==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Jl(),realScaleType:"point"}:o==="category"?{scale:Ql(),realScaleType:"band"}:{scale:zp(),realScaleType:"linear"};if(Ll(r)){var s="scale".concat(yp(r));return{scale:(gB[s]||Jl)(),realScaleType:gB[s]?s:"point"}}return We(r)?{scale:r}:{scale:Jl(),realScaleType:"point"}},e6=1e-4,ahe=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),o=Math.min(r[0],r[1])-e6,a=Math.max(r[0],r[1])+e6,i=e(t[0]),s=e(t[n-1]);(i<o||i>a||s<o||s>a)&&e.domain([t[0],t[n-1]])}},ihe=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},she=function(e,t){if(!t||t.length!==2||!me(t[0])||!me(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),o=[e[0],e[1]];return(!me(e[0])||e[0]<n)&&(o[0]=n),(!me(e[1])||e[1]>r)&&(o[1]=r),o[0]>r&&(o[0]=r),o[1]<n&&(o[1]=n),o},che=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var o=0,a=0,i=0;i<t;++i){var s=Fl(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1]):(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1])}},lhe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var o=0,a=0;a<t;++a){var i=Fl(e[a][n][1])?e[a][n][0]:e[a][n][1];i>=0?(e[a][n][0]=o,e[a][n][1]=o+i,o=e[a][n][1]):(e[a][n][0]=0,e[a][n][1]=0)}},uhe={sign:che,expand:dce,none:gs,silhouette:fce,wiggle:pce,positive:lhe},dhe=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),o=uhe[n],a=uce().keys(r).value(function(i,s){return+Kr(i,s,0)}).order(i1).offset(o);return a(e)},fhe=function(e,t,n,r,o,a){if(!e)return null;var i=a?t.reverse():t,s={},c=i.reduce(function(u,d){var f,h=(f=d.type)!==null&&f!==void 0&&f.defaultProps?Pt(Pt({},d.type.defaultProps),d.props):d.props,y=h.stackId,m=h.hide;if(m)return u;var v=h[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(zt(y)){var x=b.stackGroups[y]||{numericAxisId:n,cateAxisId:r,items:[]};x.items.push(d),b.hasStack=!0,b.stackGroups[y]=x}else b.stackGroups[pp("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return Pt(Pt({},u),{},As({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var f=c[d];if(f.hasStack){var h={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(y,m){var v=f.stackGroups[m];return Pt(Pt({},y),{},As({},m,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:dhe(e,v.items,o)}))},h)}return Pt(Pt({},u),{},As({},d,f))},l)},phe=function(e,t){var n=t.realScaleType,r=t.type,o=t.tickCount,a=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(o&&r==="number"&&a&&(a[0]==="auto"||a[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=Epe(c,o,i);return e.domain([Jp(l),Qp(l)]),{niceTicks:l}}if(o&&r==="number"){var u=e.domain(),d=Spe(u,o,i);return{niceTicks:d}}return null},t6=function(e){var t=e.axis,n=e.ticks,r=e.offset,o=e.bandSize,a=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=Kr(a,t.dataKey,t.domain[i]);return it(s)?null:t.scale(s)-o/2+r},hhe=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return r<=0&&o>=0?0:o<0?o:r}return n[0]},mhe=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Pt(Pt({},e.type.defaultProps),e.props):e.props,o=r.stackId;if(zt(o)){var a=t[o];if(a){var i=a.items.indexOf(e);return i>=0?a.stackedData[i]:null}}return null},yhe=function(e){return e.reduce(function(t,n){return[Jp(n.concat([t[0]]).filter(me)),Qp(n.concat([t[1]]).filter(me))]},[1/0,-1/0])},n6=function(e,t,n){return Object.keys(e).reduce(function(r,o){var a=e[o],i=a.stackedData,s=i.reduce(function(c,l){var u=yhe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},r6=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,o6=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Z_=function(e,t,n){if(We(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(me(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(r6.test(e[0])){var o=+r6.exec(e[0])[1];r[0]=t[0]-o}else We(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(me(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(o6.test(e[1])){var a=+o6.exec(e[1])[1];r[1]=t[1]+a}else We(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},ih=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var o=H1(t,function(u){return u.coordinate}),a=1/0,i=1,s=o.length;i<s;i++){var c=o[i],l=o[i-1];a=Math.min((c.coordinate||0)-(l.coordinate||0),a)}return a===1/0?0:a}return n?void 0:0},a6=function(e,t,n){return!e||!e.length||$_(e,qn(n,"type.defaultProps.domain"))?t:e},i6=function(e,t){var n=e.type.defaultProps?Pt(Pt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,o=n.name,a=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return Pt(Pt({},ot(e,!1)),{},{dataKey:r,unit:a,formatter:i,name:o||r,color:J_(e),value:Kr(t,r),type:s,payload:t,chartType:c,hide:l})};function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function s6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function c6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?s6(Object(n),!0).forEach(function(r){ghe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ghe(e,t,n){return t=vhe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vhe(e){var t=bhe(e,"string");return cu(t)=="symbol"?t:t+""}function bhe(e,t){if(cu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sh=Math.PI/180,xhe=function(e){return e*180/Math.PI},Gt=function(e,t,n,r){return{x:e+Math.cos(-sh*r)*n,y:t+Math.sin(-sh*r)*n}},whe=function(e,t){var n=e.x,r=e.y,o=t.x,a=t.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(r-a,2))},_he=function(e,t){var n=e.x,r=e.y,o=t.cx,a=t.cy,i=whe({x:n,y:r},{x:o,y:a});if(i<=0)return{radius:i};var s=(n-o)/i,c=Math.acos(s);return r>a&&(c=2*Math.PI-c),{radius:i,angle:xhe(c),angleInRadian:c}},jhe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),o=Math.floor(n/360),a=Math.min(r,o);return{startAngle:t-a*360,endAngle:n-a*360}},Ehe=function(e,t){var n=t.startAngle,r=t.endAngle,o=Math.floor(n/360),a=Math.floor(r/360),i=Math.min(o,a);return e+i*360},l6=function(e,t){var n=e.x,r=e.y,o=_he({x:n,y:r},t),a=o.radius,i=o.angle,s=t.innerRadius,c=t.outerRadius;if(a<s||a>c)return!1;if(a===0)return!0;var l=jhe(t),u=l.startAngle,d=l.endAngle,f=i,h;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;h=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;h=f>=d&&f<=u}return h?c6(c6({},t),{},{radius:a,angle:Ehe(f,t)}):null};function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}var She=["offset"];function Che(e){return khe(e)||Mhe(e)||Nhe(e)||Ohe()}function Ohe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nhe(e,t){if(e){if(typeof e=="string")return ej(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ej(e,t)}}function Mhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function khe(e){if(Array.isArray(e))return ej(e)}function ej(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Phe(e,t){if(e==null)return{};var n=Ahe(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ahe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function u6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(n),!0).forEach(function(r){The(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function The(e,t,n){return t=Rhe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rhe(e){var t=Ihe(e,"string");return lu(t)=="symbol"?t:t+""}function Ihe(e,t){if(lu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uu(){return uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uu.apply(this,arguments)}var Dhe=function(e){var t=e.value,n=e.formatter,r=it(e.children)?t:e.children;return We(n)?n(r):r},Lhe=function(e,t){var n=xr(t-e),r=Math.min(Math.abs(t-e),360);return n*r},Fhe=function(e,t,n){var r=e.position,o=e.viewBox,a=e.offset,i=e.className,s=o,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,f=s.startAngle,h=s.endAngle,y=s.clockWise,m=(u+d)/2,v=Lhe(f,h),b=v>=0?1:-1,x,_;r==="insideStart"?(x=f+b*a,_=y):r==="insideEnd"?(x=h-b*a,_=!y):r==="end"&&(x=h+b*a,_=y),_=v<=0?_:!_;var w=Gt(c,l,m,x),j=Gt(c,l,m,x+(_?1:-1)*359),E="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),S=it(e.id)?pp("recharts-radial-line-"):e.id;return V.createElement("text",uu({},n,{dominantBaseline:"central",className:ut("recharts-radial-bar-label",i)}),V.createElement("defs",null,V.createElement("path",{id:S,d:E})),V.createElement("textPath",{xlinkHref:"#".concat(S)},t))},Bhe=function(e){var t=e.viewBox,n=e.offset,r=e.position,o=t,a=o.cx,i=o.cy,s=o.innerRadius,c=o.outerRadius,l=o.startAngle,u=o.endAngle,d=(l+u)/2;if(r==="outside"){var f=Gt(a,i,c+n,d),h=f.x,y=f.y;return{x:h,y,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+c)/2,v=Gt(a,i,m,d),b=v.x,x=v.y;return{x:b,y:x,textAnchor:"middle",verticalAnchor:"middle"}},$he=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,o=e.position,a=t,i=a.x,s=a.y,c=a.width,l=a.height,u=l>=0?1:-1,d=u*r,f=u>0?"end":"start",h=u>0?"start":"end",y=c>=0?1:-1,m=y*r,v=y>0?"end":"start",b=y>0?"start":"end";if(o==="top"){var x={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:f};return Ut(Ut({},x),n?{height:Math.max(s-n.y,0),width:c}:{})}if(o==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:h};return Ut(Ut({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(o==="left"){var w={x:i-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return Ut(Ut({},w),n?{width:Math.max(w.x-n.x,0),height:l}:{})}if(o==="right"){var j={x:i+c+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return Ut(Ut({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:l}:{})}var E=n?{width:c,height:l}:{};return o==="insideLeft"?Ut({x:i+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},E):o==="insideRight"?Ut({x:i+c-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},E):o==="insideTop"?Ut({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:h},E):o==="insideBottom"?Ut({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:f},E):o==="insideTopLeft"?Ut({x:i+m,y:s+d,textAnchor:b,verticalAnchor:h},E):o==="insideTopRight"?Ut({x:i+c-m,y:s+d,textAnchor:v,verticalAnchor:h},E):o==="insideBottomLeft"?Ut({x:i+m,y:s+l-d,textAnchor:b,verticalAnchor:f},E):o==="insideBottomRight"?Ut({x:i+c-m,y:s+l-d,textAnchor:v,verticalAnchor:f},E):hs(o)&&(me(o.x)||Ya(o.x))&&(me(o.y)||Ya(o.y))?Ut({x:i+Ka(o.x,c),y:s+Ka(o.y,l),textAnchor:"end",verticalAnchor:"end"},E):Ut({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},E)},zhe=function(e){return"cx"in e&&me(e.cx)};function rn(e){var t=e.offset,n=t===void 0?5:t,r=Phe(e,She),o=Ut({offset:n},r),a=o.viewBox,i=o.position,s=o.value,c=o.children,l=o.content,u=o.className,d=u===void 0?"":u,f=o.textBreakAll;if(!a||it(s)&&it(c)&&!g.isValidElement(l)&&!We(l))return null;if(g.isValidElement(l))return g.cloneElement(l,o);var h;if(We(l)){if(h=g.createElement(l,o),g.isValidElement(h))return h}else h=Dhe(o);var y=zhe(a),m=ot(o,!0);if(y&&(i==="insideStart"||i==="insideEnd"||i==="end"))return Fhe(o,h,m);var v=y?Bhe(o):$he(o);return V.createElement(Ip,uu({className:ut("recharts-label",d)},m,v,{breakAll:f}),h)}rn.displayName="Label";var d6=function(e){var t=e.cx,n=e.cy,r=e.angle,o=e.startAngle,a=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,f=e.top,h=e.left,y=e.width,m=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(me(y)&&me(m)){if(me(u)&&me(d))return{x:u,y:d,width:y,height:m};if(me(f)&&me(h))return{x:f,y:h,width:y,height:m}}return me(u)&&me(d)?{x:u,y:d,width:0,height:0}:me(t)&&me(n)?{cx:t,cy:n,startAngle:o||r||0,endAngle:a||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},Vhe=function(e,t){return e?e===!0?V.createElement(rn,{key:"label-implicit",viewBox:t}):zt(e)?V.createElement(rn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===rn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):V.createElement(rn,{key:"label-implicit",content:e,viewBox:t}):We(e)?V.createElement(rn,{key:"label-implicit",content:e,viewBox:t}):hs(e)?V.createElement(rn,uu({viewBox:t},e,{key:"label-implicit"})):null:null},Uhe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,o=d6(e),a=wr(r,rn).map(function(s,c){return g.cloneElement(s,{viewBox:t||o,key:"label-".concat(c)})});if(!n)return a;var i=Vhe(e.label,t||o);return[i].concat(Che(a))};rn.parseViewBox=d6,rn.renderCallByParent=Uhe;var tj,f6;jS=function(){if(f6)return tj;f6=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return tj=e,tj};var Hhe=jS();IE=Xe(Hhe);function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}var Whe=["valueAccessor"],qhe=["data","dataKey","clockWise","id","textBreakAll"];function Yhe(e){return Jhe(e)||Qhe(e)||Xhe(e)||Khe()}function Khe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xhe(e,t){if(e){if(typeof e=="string")return nj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nj(e,t)}}function Qhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jhe(e){if(Array.isArray(e))return nj(e)}function nj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ch.apply(this,arguments)}function p6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function h6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p6(Object(n),!0).forEach(function(r){Ghe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ghe(e,t,n){return t=Zhe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zhe(e){var t=eme(e,"string");return du(t)=="symbol"?t:t+""}function eme(e,t){if(du(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(du(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m6(e,t){if(e==null)return{};var n=tme(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tme(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var nme=function(e){return Array.isArray(e.value)?IE(e.value):e.value};function oi(e){var t=e.valueAccessor,n=t===void 0?nme:t,r=m6(e,Whe),o=r.data,a=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=m6(r,qhe);return!o||!o.length?null:V.createElement(Wt,{className:"recharts-label-list"},o.map(function(u,d){var f=it(a)?n(u,d):Kr(u&&u.payload,a),h=it(s)?{}:{id:"".concat(s,"-").concat(d)};return V.createElement(rn,ch({},ot(u,!0),l,h,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:rn.parseViewBox(it(i)?u:h6(h6({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}oi.displayName="LabelList";function rme(e,t){return e?e===!0?V.createElement(oi,{key:"labelList-implicit",data:t}):V.isValidElement(e)||We(e)?V.createElement(oi,{key:"labelList-implicit",data:t,content:e}):hs(e)?V.createElement(oi,ch({data:t},e,{key:"labelList-implicit"})):null:null}function ome(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,o=wr(r,oi).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return o;var a=rme(e.label,t);return[a].concat(Yhe(o))}oi.renderCallByParent=ome;function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function rj(){return rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rj.apply(this,arguments)}function y6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function g6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y6(Object(n),!0).forEach(function(r){ame(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ame(e,t,n){return t=ime(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ime(e){var t=sme(e,"string");return fu(t)=="symbol"?t:t+""}function sme(e,t){if(fu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cme=function(e,t){var n=xr(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},lh=function(e){var t=e.cx,n=e.cy,r=e.radius,o=e.angle,a=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/sh,d=c?o:o+a*u,f=Gt(t,n,l,d),h=Gt(t,n,r,d),y=c?o-a*u:o,m=Gt(t,n,l*Math.cos(u*sh),y);return{center:f,circleTangency:h,lineTangency:m,theta:u}},v6=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,o=e.outerRadius,a=e.startAngle,i=e.endAngle,s=cme(a,i),c=a+s,l=Gt(t,n,o,a),u=Gt(t,n,o,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(a>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var f=Gt(t,n,r,a),h=Gt(t,n,r,c);d+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(a<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},lme=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,o=e.outerRadius,a=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=xr(l-c),d=lh({cx:t,cy:n,radius:o,angle:c,sign:u,cornerRadius:a,cornerIsExternal:s}),f=d.circleTangency,h=d.lineTangency,y=d.theta,m=lh({cx:t,cy:n,radius:o,angle:l,sign:-u,cornerRadius:a,cornerIsExternal:s}),v=m.circleTangency,b=m.lineTangency,x=m.theta,_=s?Math.abs(c-l):Math.abs(c-l)-y-x;if(_<0)return i?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):v6({cx:t,cy:n,innerRadius:r,outerRadius:o,startAngle:c,endAngle:l});var w="M ".concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var j=lh({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),E=j.circleTangency,S=j.lineTangency,O=j.theta,k=lh({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),N=k.circleTangency,P=k.lineTangency,R=k.theta,A=s?Math.abs(c-l):Math.abs(c-l)-O-R;if(A<0&&a===0)return"".concat(w,"L").concat(t,",").concat(n,"Z");w+="L".concat(P.x,",").concat(P.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(A>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(S.x,",").concat(S.y,"Z")}else w+="L".concat(t,",").concat(n,"Z");return w},ume={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},b6=function(e){var t=g6(g6({},ume),e),n=t.cx,r=t.cy,o=t.innerRadius,a=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(a<o||l===u)return null;var f=ut("recharts-sector",d),h=a-o,y=Ka(i,h,0,!0),m;return y>0&&Math.abs(l-u)<360?m=lme({cx:n,cy:r,innerRadius:o,outerRadius:a,cornerRadius:Math.min(y,h/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):m=v6({cx:n,cy:r,innerRadius:o,outerRadius:a,startAngle:l,endAngle:u}),V.createElement("path",rj({},ot(t,!0),{className:f,d:m,role:"img"}))};function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}function oj(){return oj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oj.apply(this,arguments)}function x6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function w6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x6(Object(n),!0).forEach(function(r){dme(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dme(e,t,n){return t=fme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fme(e){var t=pme(e,"string");return pu(t)=="symbol"?t:t+""}function pme(e,t){if(pu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(pu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _6={curveBasisClosed:Zse,curveBasisOpen:ece,curveBasis:Gse,curveBumpX:Fse,curveBumpY:Bse,curveLinearClosed:tce,curveLinear:xp,curveMonotoneX:nce,curveMonotoneY:rce,curveNatural:oce,curveStep:ace,curveStepAfter:sce,curveStepBefore:ice},uh=function(e){return e.x===+e.x&&e.y===+e.y},hu=function(e){return e.x},mu=function(e){return e.y},hme=function(e,t){if(We(e))return e;var n="curve".concat(yp(e));return(n==="curveMonotone"||n==="curveBump")&&t?_6["".concat(n).concat(t==="vertical"?"Y":"X")]:_6[n]||xp},mme=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,o=r===void 0?[]:r,a=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=hme(n,i),u=c?o.filter(function(y){return uh(y)}):o,d;if(Array.isArray(a)){var f=c?a.filter(function(y){return uh(y)}):a,h=u.map(function(y,m){return w6(w6({},y),{},{base:f[m]})});return i==="vertical"?d=wp().y(mu).x1(hu).x0(function(y){return y.base.x}):d=wp().x(hu).y1(mu).y0(function(y){return y.base.y}),d.defined(uh).curve(l),d(h)}return i==="vertical"&&me(a)?d=wp().y(mu).x1(hu).x0(a):me(a)?d=wp().x(hu).y1(mu).y0(a):d=C4().x(hu).y(mu),d.defined(uh).curve(l),d(u)},j6=function(e){var t=e.className,n=e.points,r=e.path,o=e.pathRef;if((!n||!n.length)&&!r)return null;var a=n&&n.length?mme(e):r;return V.createElement("path",oj({},ot(e,!1),hp(e),{className:ut("recharts-curve",t),d:a,ref:o}))},E6={exports:{}},aj,S6;function yme(){if(S6)return aj;S6=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return aj=e,aj}var ij,C6;function gme(){if(C6)return ij;C6=1;var e=yme();function t(){}function n(){}return n.resetWarningCache=t,ij=function(){function r(i,s,c,l,u,d){if(d!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function o(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:t};return a.PropTypes=a,a},ij}var O6;function vme(){return O6||(O6=1,E6.exports=gme()()),E6.exports}var bme=vme();const Fe=Xe(bme);var xme=Object.getOwnPropertyNames,wme=Object.getOwnPropertySymbols,_me=Object.prototype.hasOwnProperty;function N6(e,t){return function(n,r,o){return e(n,r,o)&&t(n,r,o)}}function dh(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var o=r.cache,a=o.get(t),i=o.get(n);if(a&&i)return a===n&&i===t;o.set(t,n),o.set(n,t);var s=e(t,n,r);return o.delete(t),o.delete(n),s}}function M6(e){return xme(e).concat(wme(e))}var k6=Object.hasOwn||function(e,t){return _me.call(e,t)};function Ts(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var P6="_owner",A6=Object.getOwnPropertyDescriptor,T6=Object.keys;function jme(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function Eme(e,t){return Ts(e.getTime(),t.getTime())}function R6(e,t,n){if(e.size!==t.size)return!1;for(var r={},o=e.entries(),a=0,i,s;(i=o.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],h=d[1],y=s.value,m=y[0],v=y[1];!l&&!r[u]&&(l=n.equals(f,m,a,u,e,t,n)&&n.equals(h,v,f,m,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;a++}return!0}function Sme(e,t,n){var r=T6(e),o=r.length;if(T6(t).length!==o)return!1;for(var a;o-- >0;)if(a=r[o],a===P6&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!k6(t,a)||!n.equals(e[a],t[a],a,a,e,t,n))return!1;return!0}function yu(e,t,n){var r=M6(e),o=r.length;if(M6(t).length!==o)return!1;for(var a,i,s;o-- >0;)if(a=r[o],a===P6&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!k6(t,a)||!n.equals(e[a],t[a],a,a,e,t,n)||(i=A6(e,a),s=A6(t,a),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function Cme(e,t){return Ts(e.valueOf(),t.valueOf())}function Ome(e,t){return e.source===t.source&&e.flags===t.flags}function I6(e,t,n){if(e.size!==t.size)return!1;for(var r={},o=e.values(),a,i;(a=o.next())&&!a.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(a.value,i.value,a.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function Nme(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var Mme="[object Arguments]",kme="[object Boolean]",Pme="[object Date]",Ame="[object Map]",Tme="[object Number]",Rme="[object Object]",Ime="[object RegExp]",Dme="[object Set]",Lme="[object String]",Fme=Array.isArray,D6=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,L6=Object.assign,Bme=Object.prototype.toString.call.bind(Object.prototype.toString);function $me(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,o=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var f=l.constructor;if(f!==u.constructor)return!1;if(f===Object)return o(l,u,d);if(Fme(l))return t(l,u,d);if(D6!=null&&D6(l))return c(l,u,d);if(f===Date)return n(l,u,d);if(f===RegExp)return i(l,u,d);if(f===Map)return r(l,u,d);if(f===Set)return s(l,u,d);var h=Bme(l);return h===Pme?n(l,u,d):h===Ime?i(l,u,d):h===Ame?r(l,u,d):h===Dme?s(l,u,d):h===Rme?typeof l.then!="function"&&typeof u.then!="function"&&o(l,u,d):h===Mme?o(l,u,d):h===kme||h===Tme||h===Lme?a(l,u,d):!1}}function zme(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,o={areArraysEqual:r?yu:jme,areDatesEqual:Eme,areMapsEqual:r?N6(R6,yu):R6,areObjectsEqual:r?yu:Sme,arePrimitiveWrappersEqual:Cme,areRegExpsEqual:Ome,areSetsEqual:r?N6(I6,yu):I6,areTypedArraysEqual:r?yu:Nme};if(n&&(o=L6({},o,n(o))),t){var a=dh(o.areArraysEqual),i=dh(o.areMapsEqual),s=dh(o.areObjectsEqual),c=dh(o.areSetsEqual);o=L6({},o,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return o}function Vme(e){return function(t,n,r,o,a,i,s){return e(t,n,s)}}function Ume(e){var t=e.circular,n=e.comparator,r=e.createState,o=e.equals,a=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,f=l.meta;return n(s,c,{cache:d,equals:o,meta:f,strict:a})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:o,meta:void 0,strict:a})};var i={cache:void 0,equals:o,meta:void 0,strict:a};return function(s,c){return n(s,c,i)}}var Hme=ha();ha({strict:!0}),ha({circular:!0}),ha({circular:!0,strict:!0}),ha({createInternalComparator:function(){return Ts}}),ha({strict:!0,createInternalComparator:function(){return Ts}}),ha({circular:!0,createInternalComparator:function(){return Ts}}),ha({circular:!0,createInternalComparator:function(){return Ts},strict:!0});function ha(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,o=e.createState,a=e.strict,i=a===void 0?!1:a,s=zme(e),c=$me(s),l=r?r(c):Vme(c);return Ume({circular:n,comparator:c,createState:o,equals:l,strict:i})}function Wme(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function F6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function o(a){n<0&&(n=a),a-n>t?(e(a),n=-1):Wme(o)};requestAnimationFrame(r)}function sj(e){"@babel/helpers - typeof";return sj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sj(e)}function qme(e){return Qme(e)||Xme(e)||Kme(e)||Yme()}function Yme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kme(e,t){if(e){if(typeof e=="string")return B6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B6(e,t)}}function B6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qme(e){if(Array.isArray(e))return e}function Jme(){var e={},t=function(){return null},n=!1,r=function o(a){if(!n){if(Array.isArray(a)){if(!a.length)return;var i=a,s=qme(i),c=s[0],l=s.slice(1);if(typeof c=="number"){F6(o.bind(null,l),c);return}o(c),F6(o.bind(null,l));return}sj(a)==="object"&&(e=a,t(e)),typeof a=="function"&&a()}};return{stop:function(){n=!0},start:function(o){n=!1,r(o)},subscribe:function(o){return t=o,function(){t=function(){return null}}}}}function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function $6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function z6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$6(Object(n),!0).forEach(function(r){V6(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function V6(e,t,n){return t=Gme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gme(e){var t=Zme(e,"string");return gu(t)==="symbol"?t:String(t)}function Zme(e,t){if(gu(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gu(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eye=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(o){return r.includes(o)})})},tye=function(e){return e},nye=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},vu=function(e,t){return Object.keys(t).reduce(function(n,r){return z6(z6({},n),{},V6({},r,e(r,t[r])))},{})},U6=function(e,t,n){return e.map(function(r){return"".concat(nye(r)," ").concat(t,"ms ").concat(n)}).join(",")};function rye(e,t){return iye(e)||aye(e,t)||H6(e,t)||oye()}function oye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aye(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function iye(e){if(Array.isArray(e))return e}function sye(e){return uye(e)||lye(e)||H6(e)||cye()}function cye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H6(e,t){if(e){if(typeof e=="string")return cj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cj(e,t)}}function lye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uye(e){if(Array.isArray(e))return cj(e)}function cj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fh=1e-4,W6=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},q6=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},Y6=function(e,t){return function(n){var r=W6(e,t);return q6(r,n)}},dye=function(e,t){return function(n){var r=W6(e,t),o=[].concat(sye(r.map(function(a,i){return a*i}).slice(1)),[0]);return q6(o,n)}},K6=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t[1],a=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,o=0,a=1,i=1;break;case"ease":r=.25,o=.1,a=.25,i=1;break;case"ease-in":r=.42,o=0,a=1,i=1;break;case"ease-out":r=.42,o=0,a=.58,i=1;break;case"ease-in-out":r=0,o=0,a=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),l=rye(c,4);r=l[0],o=l[1],a=l[2],i=l[3]}}}var u=Y6(r,a),d=Y6(o,i),f=dye(r,a),h=function(m){return m>1?1:m<0?0:m},y=function(m){for(var v=m>1?1:m,b=v,x=0;x<8;++x){var _=u(b)-v,w=f(b);if(Math.abs(_-v)<fh||w<fh)return d(b);b=h(b-_/w)}return d(b)};return y.isStepper=!1,y},fye=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,o=r===void 0?8:r,a=e.dt,i=a===void 0?17:a,s=function(c,l,u){var d=-(c-l)*n,f=u*o,h=u+(d-f)*i/1e3,y=u*i/1e3+c;return Math.abs(y-l)<fh&&Math.abs(h)<fh?[l,0]:[y,h]};return s.isStepper=!0,s.dt=i,s},pye=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return K6(r);case"spring":return fye();default:if(r.split("(")[0]==="cubic-bezier")return K6(r)}return typeof r=="function"?r:null};function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function X6(e){return yye(e)||mye(e)||J6(e)||hye()}function hye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yye(e){if(Array.isArray(e))return uj(e)}function Q6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q6(Object(n),!0).forEach(function(r){lj(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lj(e,t,n){return t=gye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gye(e){var t=vye(e,"string");return bu(t)==="symbol"?t:String(t)}function vye(e,t){if(bu(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bu(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bye(e,t){return _ye(e)||wye(e,t)||J6(e,t)||xye()}function xye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J6(e,t){if(e){if(typeof e=="string")return uj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uj(e,t)}}function uj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wye(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function _ye(e){if(Array.isArray(e))return e}var ph=function(e,t,n){return e+(t-e)*n},dj=function(e){var t=e.from,n=e.to;return t!==n},jye=function e(t,n,r){var o=vu(function(a,i){if(dj(i)){var s=t(i.from,i.to,i.velocity),c=bye(s,2),l=c[0],u=c[1];return Zt(Zt({},i),{},{from:l,velocity:u})}return i},n);return r<1?vu(function(a,i){return dj(i)?Zt(Zt({},i),{},{velocity:ph(i.velocity,o[a].velocity,r),from:ph(i.from,o[a].from,r)}):i},n):e(t,o,r-1)};const Eye=function(e,t,n,r,o){var a=eye(e,t),i=a.reduce(function(v,b){return Zt(Zt({},v),{},lj({},b,[e[b],t[b]]))},{}),s=a.reduce(function(v,b){return Zt(Zt({},v),{},lj({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},f=function(){return vu(function(v,b){return b.from},s)},h=function(){return!Object.values(s).filter(dj).length},y=function(v){l||(l=v);var b=v-l,x=b/n.dt;s=jye(n,s,x),o(Zt(Zt(Zt({},e),t),f())),l=v,h()||(c=requestAnimationFrame(d))},m=function(v){u||(u=v);var b=(v-u)/r,x=vu(function(w,j){return ph.apply(void 0,X6(j).concat([n(b)]))},i);if(o(Zt(Zt(Zt({},e),t),x)),b<1)c=requestAnimationFrame(d);else{var _=vu(function(w,j){return ph.apply(void 0,X6(j).concat([n(1)]))},i);o(Zt(Zt(Zt({},e),t),_))}};return d=n.isStepper?y:m,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}var Sye=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Cye(e,t){if(e==null)return{};var n=Oye(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Oye(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function fj(e){return Pye(e)||kye(e)||Mye(e)||Nye()}function Nye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mye(e,t){if(e){if(typeof e=="string")return pj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pj(e,t)}}function kye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pye(e){if(Array.isArray(e))return pj(e)}function pj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function jr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G6(Object(n),!0).forEach(function(r){xu(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G6(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xu(e,t,n){return t=Z6(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Aye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Z6(r.key),r)}}function Rye(e,t,n){return t&&Tye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z6(e){var t=Iye(e,"string");return Rs(t)==="symbol"?t:String(t)}function Iye(e,t){if(Rs(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rs(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hj(e,t)}function hj(e,t){return hj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},hj(e,t)}function Lye(e){var t=Fye();return function(){var n=hh(e),r;if(t){var o=hh(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return mj(this,r)}}function mj(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yj(e)}function yj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hh(e){return hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hh(e)}var ma=function(e){Dye(n,e);var t=Lye(n);function n(r,o){var a;Aye(this,n),a=t.call(this,r,o);var i=a.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,f=i.children,h=i.duration;if(a.handleStyleChange=a.handleStyleChange.bind(yj(a)),a.changeStyle=a.changeStyle.bind(yj(a)),!s||h<=0)return a.state={style:{}},typeof f=="function"&&(a.state={style:u}),mj(a);if(d&&d.length)a.state={style:d[0].style};else if(l){if(typeof f=="function")return a.state={style:l},mj(a);a.state={style:c?xu({},c,l):l}}else a.state={style:{}};return a}return Rye(n,[{key:"componentDidMount",value:function(){var r=this.props,o=r.isActive,a=r.canBegin;this.mounted=!0,!(!o||!a)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var o=this.props,a=o.isActive,i=o.canBegin,s=o.attributeName,c=o.shouldReAnimate,l=o.to,u=o.from,d=this.state.style;if(i){if(!a){var f={style:s?xu({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(f);return}if(!(Hme(r.to,l)&&r.canBegin&&r.isActive)){var h=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=h||c?u:r.to;if(this.state&&d){var m={style:s?xu({},s,y):y};(s&&d[s]!==y||!s&&d!==y)&&this.setState(m)}this.runAnimation(jr(jr({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var o=this,a=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,f=Eye(a,i,pye(c),s,this.changeStyle),h=function(){o.stopJSAnimation=f()};this.manager.start([d,l,h,s,u])}},{key:"runStepAnimation",value:function(r){var o=this,a=r.steps,i=r.begin,s=r.onAnimationStart,c=a[0],l=c.style,u=c.duration,d=u===void 0?0:u,f=function(h,y,m){if(m===0)return h;var v=y.duration,b=y.easing,x=b===void 0?"ease":b,_=y.style,w=y.properties,j=y.onAnimationEnd,E=m>0?a[m-1]:y,S=w||Object.keys(_);if(typeof x=="function"||x==="spring")return[].concat(fj(h),[o.runJSAnimation.bind(o,{from:E.style,to:_,duration:v,easing:x}),v]);var O=U6(S,v,x),k=jr(jr(jr({},E.style),_),{},{transition:O});return[].concat(fj(h),[k,v,j]).filter(tye)};return this.manager.start([s].concat(fj(a.reduce(f,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=Jme());var o=r.begin,a=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,f=r.children,h=this.manager;if(this.unSubscribe=h.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var y=i?xu({},i,s):s,m=U6(Object.keys(y),a,c);h.start([l,o,jr(jr({},y),{},{transition:m}),a,u])}},{key:"render",value:function(){var r=this.props,o=r.children;r.begin;var a=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=Cye(r,Sye),c=g.Children.count(o),l=this.state.style;if(typeof o=="function")return o(l);if(!i||c===0||a<=0)return o;var u=function(d){var f=d.props,h=f.style,y=h===void 0?{}:h,m=f.className,v=g.cloneElement(d,jr(jr({},s),{},{style:jr(jr({},y),l),className:m}));return v};return c===1?u(g.Children.only(o)):V.createElement("div",null,g.Children.map(o,function(d){return u(d)}))}}]),n}(g.PureComponent);ma.displayName="Animate",ma.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},ma.propTypes={from:Fe.oneOfType([Fe.object,Fe.string]),to:Fe.oneOfType([Fe.object,Fe.string]),attributeName:Fe.string,duration:Fe.number,begin:Fe.number,easing:Fe.oneOfType([Fe.string,Fe.func]),steps:Fe.arrayOf(Fe.shape({duration:Fe.number.isRequired,style:Fe.object.isRequired,easing:Fe.oneOfType([Fe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Fe.func]),properties:Fe.arrayOf("string"),onAnimationEnd:Fe.func})),children:Fe.oneOfType([Fe.node,Fe.func]),isActive:Fe.bool,canBegin:Fe.bool,onAnimationEnd:Fe.func,shouldReAnimate:Fe.bool,onAnimationStart:Fe.func,onAnimationReStart:Fe.func},Fe.object,Fe.object,Fe.object,Fe.element,Fe.object,Fe.object,Fe.object,Fe.oneOfType([Fe.array,Fe.element]),Fe.any;function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function mh(){return mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mh.apply(this,arguments)}function Bye(e,t){return Uye(e)||Vye(e,t)||zye(e,t)||$ye()}function $ye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zye(e,t){if(e){if(typeof e=="string")return e$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e$(e,t)}}function e$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vye(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function Uye(e){if(Array.isArray(e))return e}function t$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function n$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?t$(Object(n),!0).forEach(function(r){Hye(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hye(e,t,n){return t=Wye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wye(e){var t=qye(e,"string");return wu(t)=="symbol"?t:t+""}function qye(e,t){if(wu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r$=function(e,t,n,r,o){var a=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(a>0&&o instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=o[d]>a?a:o[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(a>0&&o===+o&&o>0){var h=Math.min(a,o);l="M ".concat(e,",").concat(t+i*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+s*h,",").concat(t,`
            L `).concat(e+n-s*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*h,`
            L `).concat(e+n,",").concat(t+r-i*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n-s*h,",").concat(t+r,`
            L `).concat(e+s*h,",").concat(t+r,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*h," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},Yye=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,o=t.x,a=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(o,o+i),l=Math.max(o,o+i),u=Math.min(a,a+s),d=Math.max(a,a+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},Kye={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},gj=function(e){var t=n$(n$({},Kye),e),n=g.useRef(),r=g.useState(-1),o=Bye(r,2),a=o[0],i=o[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,f=t.className,h=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var x=ut("recharts-rectangle",f);return b?V.createElement(ma,{canBegin:a>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:y,animationEasing:h,isActive:b},function(_){var w=_.width,j=_.height,E=_.x,S=_.y;return V.createElement(ma,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,isActive:v,easing:h},V.createElement("path",mh({},ot(t,!0),{className:x,d:r$(E,S,w,j,d),ref:n})))}):V.createElement("path",mh({},ot(t,!0),{className:x,d:r$(s,c,l,u,d)}))};function vj(){return vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vj.apply(this,arguments)}var o$=function(e){var t=e.cx,n=e.cy,r=e.r,o=e.className,a=ut("recharts-dot",o);return t===+t&&n===+n&&r===+r?V.createElement("circle",vj({},ot(e,!1),hp(e),{className:a,cx:t,cy:n,r})):null};function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}var Xye=["x","y","top","left","width","height","className"];function bj(){return bj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bj.apply(this,arguments)}function a$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Qye(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?a$(Object(n),!0).forEach(function(r){Jye(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Jye(e,t,n){return t=Gye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gye(e){var t=Zye(e,"string");return _u(t)=="symbol"?t:t+""}function Zye(e,t){if(_u(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_u(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ege(e,t){if(e==null)return{};var n=tge(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tge(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var nge=function(e,t,n,r,o,a){return"M".concat(e,",").concat(o,"v").concat(r,"M").concat(a,",").concat(t,"h").concat(n)},rge=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,o=r===void 0?0:r,a=e.top,i=a===void 0?0:a,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,f=d===void 0?0:d,h=e.className,y=ege(e,Xye),m=Qye({x:n,y:o,top:i,left:c,width:u,height:f},y);return!me(n)||!me(o)||!me(u)||!me(f)||!me(i)||!me(c)?null:V.createElement("path",bj({},ot(m,!0),{className:ut("recharts-cross",h),d:nge(n,o,u,f,i,c)}))},xj,i$;ME=function(){if(i$)return xj;i$=1;var e=mo(),t=qm(),n=Nr(),r="[object Object]",o=Function.prototype,a=Object.prototype,i=o.toString,s=a.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&i.call(f)==c}return xj=l,xj};var oge=ME();const age=Xe(oge);var wj,s$;function ige(){if(s$)return wj;s$=1;var e=mo(),t=Nr(),n="[object Boolean]";function r(o){return o===!0||o===!1||t(o)&&e(o)==n}return wj=r,wj}var sge=ige();const cge=Xe(sge);function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yh.apply(this,arguments)}function lge(e,t){return pge(e)||fge(e,t)||dge(e,t)||uge()}function uge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dge(e,t){if(e){if(typeof e=="string")return c$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c$(e,t)}}function c$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fge(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function pge(e){if(Array.isArray(e))return e}function l$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function u$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?l$(Object(n),!0).forEach(function(r){hge(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hge(e,t,n){return t=mge(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mge(e){var t=yge(e,"string");return ju(t)=="symbol"?t:t+""}function yge(e,t){if(ju(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ju(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d$=function(e,t,n,r,o){var a=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-a/2,",").concat(t+o),i+="L ".concat(e+n-a/2-r,",").concat(t+o),i+="L ".concat(e,",").concat(t," Z"),i},gge={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},vge=function(e){var t=u$(u$({},gge),e),n=g.useRef(),r=g.useState(-1),o=lge(r,2),a=o[0],i=o[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var x=n.current.getTotalLength();x&&i(x)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,f=t.className,h=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=ut("recharts-trapezoid",f);return v?V.createElement(ma,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:y,animationEasing:h,isActive:v},function(x){var _=x.upperWidth,w=x.lowerWidth,j=x.height,E=x.x,S=x.y;return V.createElement(ma,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,easing:h},V.createElement("path",yh({},ot(t,!0),{className:b,d:d$(E,S,_,w,j),ref:n})))}):V.createElement("g",null,V.createElement("path",yh({},ot(t,!0),{className:b,d:d$(s,c,l,u,d)})))},bge=["option","shapeType","propTransformer","activeClassName","isActive"];function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function xge(e,t){if(e==null)return{};var n=wge(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wge(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function f$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function gh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f$(Object(n),!0).forEach(function(r){_ge(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _ge(e,t,n){return t=jge(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jge(e){var t=Ege(e,"string");return Eu(t)=="symbol"?t:t+""}function Ege(e,t){if(Eu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Eu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sge(e,t){return gh(gh({},t),e)}function Cge(e,t){return e==="symbols"}function p$(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return V.createElement(gj,n);case"trapezoid":return V.createElement(vge,n);case"sector":return V.createElement(b6,n);case"symbols":if(Cge(t))return V.createElement(c1,n);break;default:return null}}function Oge(e){return g.isValidElement(e)?e.props:e}function Nge(e){var t=e.option,n=e.shapeType,r=e.propTransformer,o=r===void 0?Sge:r,a=e.activeClassName,i=a===void 0?"recharts-active-shape":a,s=e.isActive,c=xge(e,bge),l;if(g.isValidElement(t))l=g.cloneElement(t,gh(gh({},c),Oge(t)));else if(We(t))l=t(c);else if(age(t)&&!cge(t)){var u=o(t,c);l=V.createElement(p$,{shapeType:n,elementProps:u})}else{var d=c;l=V.createElement(p$,{shapeType:n,elementProps:d})}return s?V.createElement(Wt,{className:i},l):l}function vh(e,t){return t!=null&&"trapezoids"in e.props}function bh(e,t){return t!=null&&"sectors"in e.props}function Su(e,t){return t!=null&&"points"in e.props}function Mge(e,t){var n,r,o=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,a=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return o&&a}function kge(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function Pge(e,t){var n=e.x===t.x,r=e.y===t.y,o=e.z===t.z;return n&&r&&o}function Age(e,t){var n;return vh(e,t)?n=Mge:bh(e,t)?n=kge:Su(e,t)&&(n=Pge),n}function Tge(e,t){var n;return vh(e,t)?n="trapezoids":bh(e,t)?n="sectors":Su(e,t)&&(n="points"),n}function Rge(e,t){if(vh(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(bh(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return Su(e,t)?t.payload:{}}function Ige(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,o=Tge(n,t),a=Rge(n,t),i=r.filter(function(c,l){var u=$_(a,c),d=n.props[o].filter(function(y){var m=Age(n,t);return m(y,t)}),f=n.props[o].indexOf(d[d.length-1]),h=l===f;return u&&h}),s=r.indexOf(i[i.length-1]);return s}var _j,h$;function Dge(){if(h$)return _j;h$=1;var e=Math.ceil,t=Math.max;function n(r,o,a,i){for(var s=-1,c=t(e((o-r)/(a||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=a;return l}return _j=n,_j}var jj,m$;function Lge(){if(m$)return jj;m$=1;var e=Dge(),t=pi(),n=i3();function r(o){return function(a,i,s){return s&&typeof s!="number"&&t(a,i,s)&&(i=s=void 0),a=n(a),i===void 0?(i=a,a=0):i=n(i),s=s===void 0?a<i?1:-1:n(s),e(a,i,s,o)}}return jj=r,jj}var Ej,y$;function Fge(){if(y$)return Ej;y$=1;var e=Lge(),t=e();return Ej=t,Ej}var Bge=Fge();const xh=Xe(Bge);function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function g$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function v$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g$(Object(n),!0).forEach(function(r){b$(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function b$(e,t,n){return t=$ge(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ge(e){var t=zge(e,"string");return Cu(t)=="symbol"?t:t+""}function zge(e,t){if(Cu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Cu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vge=["Webkit","Moz","O","ms"],Uge=function(e,t){var n=e.replace(/(\w)/,function(o){return o.toUpperCase()}),r=Vge.reduce(function(o,a){return v$(v$({},o),{},b$({},a+n,t))},{});return r[e]=t,r};function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function wh(){return wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wh.apply(this,arguments)}function x$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Sj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x$(Object(n),!0).forEach(function(r){zn(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j$(r.key),r)}}function Wge(e,t,n){return t&&w$(e.prototype,t),n&&w$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qge(e,t,n){return t=_h(t),Yge(e,_$()?Reflect.construct(t,n||[],_h(e).constructor):t.apply(e,n))}function Yge(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kge(e)}function Kge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_$=function(){return!!e})()}function _h(e){return _h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_h(e)}function Xge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cj(e,t)}function Cj(e,t){return Cj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Cj(e,t)}function zn(e,t,n){return t=j$(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j$(e){var t=Qge(e,"string");return Is(t)=="symbol"?t:t+""}function Qge(e,t){if(Is(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Is(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jge=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,o=e.x,a=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Jl().domain(xh(0,s)).range([o,o+a-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},E$=function(e){return e.changedTouches&&!!e.changedTouches.length},Ds=function(e){function t(n){var r;return Hge(this,t),r=qge(this,t,[n]),zn(r,"handleDrag",function(o){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(o):r.state.isSlideMoving&&r.handleSlideDrag(o)}),zn(r,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&r.handleDrag(o.changedTouches[0])}),zn(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=r.props,a=o.endIndex,i=o.onDragEnd,s=o.startIndex;i==null||i({endIndex:a,startIndex:s})}),r.detachDragEndListener()}),zn(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),zn(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),zn(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),zn(r,"handleSlideDragStart",function(o){var a=E$(o)?o.changedTouches[0]:o;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return Xge(t,e),Wge(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,o=n.endX,a=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,o),d=Math.max(r,o),f=t.getIndexInRange(a,u),h=t.getIndexInRange(a,d);return{startIndex:f-f%s,endIndex:h===l?l:h-h%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,o=r.data,a=r.tickFormatter,i=r.dataKey,s=Kr(o[n],i,n);return We(a)?a(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,o=r.slideMoveStartX,a=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,f=s.endIndex,h=s.onChange,y=n.pageX-o;y>0?y=Math.min(y,c+l-u-i,c+l-u-a):y<0&&(y=Math.max(y,c-a,c-i));var m=this.getIndex({startX:a+y,endX:i+y});(m.startIndex!==d||m.endIndex!==f)&&h&&h(m),this.setState({startX:a+y,endX:i+y,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var o=E$(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,o=r.brushMoveStartX,a=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[a],l=this.props,u=l.x,d=l.width,f=l.travellerWidth,h=l.onChange,y=l.gap,m=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-o;b>0?b=Math.min(b,u+d-f-c):b<0&&(b=Math.max(b,u-c)),v[a]=c+b;var x=this.getIndex(v),_=x.startIndex,w=x.endIndex,j=function(){var E=m.length-1;return a==="startX"&&(i>s?_%y===0:w%y===0)||i<s&&w===E||a==="endX"&&(i>s?w%y===0:_%y===0)||i>s&&w===E};this.setState(zn(zn({},a,c+b),"brushMoveStartX",n.pageX),function(){h&&j()&&h(x)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var o=this,a=this.state,i=a.scaleValues,s=a.startX,c=a.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var f=i[d];r==="startX"&&f>=c||r==="endX"&&f<=s||this.setState(zn({},r,f),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,o=n.y,a=n.width,i=n.height,s=n.fill,c=n.stroke;return V.createElement("rect",{stroke:c,fill:s,x:r,y:o,width:a,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,o=n.y,a=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?V.cloneElement(u,{x:r,y:o,width:a,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var o,a,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,f=s.ariaLabel,h=s.data,y=s.startIndex,m=s.endIndex,v=Math.max(n,this.props.x),b=Sj(Sj({},ot(this.props,!1)),{},{x:v,y:c,width:l,height:u}),x=f||"Min value: ".concat((o=h[y])===null||o===void 0?void 0:o.name,", Max value: ").concat((a=h[m])===null||a===void 0?void 0:a.name);return V.createElement(Wt,{tabIndex:0,role:"slider","aria-label":x,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var o=this.props,a=o.y,i=o.height,s=o.stroke,c=o.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return V.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:a,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,o=n.endIndex,a=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,f=5,h={pointerEvents:"none",fill:c};return V.createElement(Wt,{className:"recharts-brush-texts"},V.createElement(Ip,wh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-f,y:a+i/2},h),this.getTextOfTick(r)),V.createElement(Ip,wh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+f,y:a+i/2},h),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,r=n.data,o=n.className,a=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,f=d.startX,h=d.endX,y=d.isTextActive,m=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!me(i)||!me(s)||!me(c)||!me(l)||c<=0||l<=0)return null;var x=ut("recharts-brush",o),_=V.Children.count(a)===1,w=Uge("userSelect","none");return V.createElement(Wt,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(f,h),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(h,"endX"),(y||m||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,o=n.y,a=n.width,i=n.height,s=n.stroke,c=Math.floor(o+i/2)-1;return V.createElement(V.Fragment,null,V.createElement("rect",{x:r,y:o,width:a,height:i,fill:s,stroke:"none"}),V.createElement("line",{x1:r+1,y1:c,x2:r+a-1,y2:c,fill:"none",stroke:"#fff"}),V.createElement("line",{x1:r+1,y1:c+2,x2:r+a-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var o;return V.isValidElement(n)?o=V.cloneElement(n,r):We(n)?o=n(r):o=t.renderDefaultTraveller(r),o}},{key:"getDerivedStateFromProps",value:function(n,r){var o=n.data,a=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(o!==r.prevData||c!==r.prevUpdateId)return Sj({prevData:o,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:a},o&&o.length?Jge({data:o,width:a,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(a!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+a-s]);var d=r.scale.domain().map(function(f){return r.scale(f)});return{prevData:o,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:a,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var o=n.length,a=0,i=o-1;i-a>1;){var s=Math.floor((a+i)/2);n[s]>r?i=s:a=s}return r>=n[i]?i:a}}])}(g.PureComponent);zn(Ds,"displayName","Brush"),zn(Ds,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Oj,S$;function Gge(){if(S$)return Oj;S$=1;var e=k1();function t(n,r){var o;return e(n,function(a,i,s){return o=r(a,i,s),!o}),!!o}return Oj=t,Oj}var Nj,C$;function Zge(){if(C$)return Nj;C$=1;var e=uP(),t=Lr(),n=Gge(),r=un(),o=pi();function a(i,s,c){var l=r(i)?e:n;return c&&o(i,s,c)&&(s=void 0),l(i,t(s,3))}return Nj=a,Nj}var eve=Zge();const tve=Xe(eve);var Xr=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},Mj,O$;function nve(){if(O$)return Mj;O$=1;var e=em(),t=yL(),n=Lr();function r(o,a){var i={};return a=n(a,3),t(o,function(s,c,l){e(i,c,a(s,c,l))}),i}return Mj=r,Mj}var rve=nve();const ove=Xe(rve);var kj,N$;function ave(){if(N$)return kj;N$=1;function e(t,n){for(var r=-1,o=t==null?0:t.length;++r<o;)if(!n(t[r],r,t))return!1;return!0}return kj=e,kj}var Pj,M$;function ive(){if(M$)return Pj;M$=1;var e=k1();function t(n,r){var o=!0;return e(n,function(a,i,s){return o=!!r(a,i,s),o}),o}return Pj=t,Pj}var Aj,k$;function sve(){if(k$)return Aj;k$=1;var e=ave(),t=ive(),n=Lr(),r=un(),o=pi();function a(i,s,c){var l=r(i)?e:t;return c&&o(i,s,c)&&(s=void 0),l(i,n(s,3))}return Aj=a,Aj}var cve=sve();const P$=Xe(cve);var lve=["x","y"];function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function Tj(){return Tj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tj.apply(this,arguments)}function A$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Nu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A$(Object(n),!0).forEach(function(r){uve(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uve(e,t,n){return t=dve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dve(e){var t=fve(e,"string");return Ou(t)=="symbol"?t:t+""}function fve(e,t){if(Ou(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ou(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pve(e,t){if(e==null)return{};var n=hve(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hve(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function mve(e,t){var n=e.x,r=e.y,o=pve(e,lve),a="".concat(n),i=parseInt(a,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||o.height),u=parseInt(l,10),d="".concat(t.width||o.width),f=parseInt(d,10);return Nu(Nu(Nu(Nu(Nu({},t),o),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function T$(e){return V.createElement(Nge,Tj({shapeType:"rectangle",propTransformer:mve,activeClassName:"recharts-active-bar"},e))}var yve=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var o=typeof n=="number";return o?e(n,r):(o||ni(),t)}},gve=["value","background"],R$;function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function vve(e,t){if(e==null)return{};var n=bve(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bve(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function jh(){return jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jh.apply(this,arguments)}function I$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I$(Object(n),!0).forEach(function(r){ya(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F$(r.key),r)}}function wve(e,t,n){return t&&D$(e.prototype,t),n&&D$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ve(e,t,n){return t=Eh(t),jve(e,L$()?Reflect.construct(t,n||[],Eh(e).constructor):t.apply(e,n))}function jve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eve(e)}function Eve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L$=function(){return!!e})()}function Eh(e){return Eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Eh(e)}function Sve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rj(e,t)}function Rj(e,t){return Rj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Rj(e,t)}function ya(e,t,n){return t=F$(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F$(e){var t=Cve(e,"string");return Ls(t)=="symbol"?t:t+""}function Cve(e,t){if(Ls(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ls(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ai=function(e){function t(){var n;xve(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=_ve(this,t,[].concat(o)),ya(n,"state",{isAnimationFinished:!1}),ya(n,"id",pp("recharts-bar-")),ya(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),ya(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return Sve(t,e),wve(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,o=this.props,a=o.shape,i=o.dataKey,s=o.activeIndex,c=o.activeBar,l=ot(this.props,!1);return n&&n.map(function(u,d){var f=d===s,h=f?c:a,y=Ft(Ft(Ft({},l),u),{},{isActive:f,option:h,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return V.createElement(Wt,jh({className:"recharts-bar-rectangle"},mp(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),V.createElement(T$,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,o=r.data,a=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return V.createElement(ma,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var h=f.t,y=o.map(function(m,v){var b=d&&d[v];if(b){var x=ms(b.x,m.x),_=ms(b.y,m.y),w=ms(b.width,m.width),j=ms(b.height,m.height);return Ft(Ft({},m),{},{x:x(h),y:_(h),width:w(h),height:j(h)})}if(a==="horizontal"){var E=ms(0,m.height),S=E(h);return Ft(Ft({},m),{},{y:m.y+m.height-S,height:S})}var O=ms(0,m.width),k=O(h);return Ft(Ft({},m),{},{width:k})});return V.createElement(Wt,null,n.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,o=n.isAnimationActive,a=this.state.prevData;return o&&r&&r.length&&(!a||!$_(a,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,o=r.data,a=r.dataKey,i=r.activeIndex,s=ot(this.props.background,!1);return o.map(function(c,l){c.value;var u=c.background,d=vve(c,gve);if(!u)return null;var f=Ft(Ft(Ft(Ft(Ft({},d),{},{fill:"#eee"},u),s),mp(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:a,index:l,className:"recharts-bar-background-rectangle"});return V.createElement(T$,jh({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},f))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,a=o.data,i=o.xAxis,s=o.yAxis,c=o.layout,l=o.children,u=wr(l,rh);if(!u)return null;var d=c==="vertical"?a[0].height/2:a[0].width/2,f=function(y,m){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:Kr(y,m)}},h={clipPath:n?"url(#clipPath-".concat(r,")"):null};return V.createElement(Wt,h,u.map(function(y){return V.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:a,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,o=n.data,a=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,f=n.isAnimationActive,h=n.background,y=n.id;if(r||!o||!o.length)return null;var m=this.state.isAnimationFinished,v=ut("recharts-bar",a),b=i&&i.allowDataOverflow,x=s&&s.allowDataOverflow,_=b||x,w=it(y)?this.id:y;return V.createElement(Wt,{className:v},b||x?V.createElement("defs",null,V.createElement("clipPath",{id:"clipPath-".concat(w)},V.createElement("rect",{x:b?c:c-u/2,y:x?l:l-d/2,width:b?u:u*2,height:x?d:d*2}))):null,V.createElement(Wt,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(w,")"):null},h?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,w),(!f||m)&&oi.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);R$=ai,ya(ai,"displayName","Bar"),ya(ai,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!la.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),ya(ai,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,o=e.bandSize,a=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,f=e.offset,h=ihe(r,n);if(!h)return null;var y=t.layout,m=n.type.defaultProps,v=m!==void 0?Ft(Ft({},m),n.props):n.props,b=v.dataKey,x=v.children,_=v.minPointSize,w=y==="horizontal"?i:a,j=l?w.scale.domain():null,E=hhe({numericAxis:w}),S=wr(x,QL),O=d.map(function(k,N){var P,R,A,C,M,T;l?P=she(l[u+N],j):(P=Kr(k,b),Array.isArray(P)||(P=[E,P]));var D=yve(_,R$.defaultProps.minPointSize)(P[1],N);if(y==="horizontal"){var I,L=[i.scale(P[0]),i.scale(P[1])],B=L[0],U=L[1];R=t6({axis:a,ticks:s,bandSize:o,offset:h.offset,entry:k,index:N}),A=(I=U??B)!==null&&I!==void 0?I:void 0,C=h.size;var F=B-U;if(M=Number.isNaN(F)?0:F,T={x:R,y:i.y,width:C,height:i.height},Math.abs(D)>0&&Math.abs(M)<Math.abs(D)){var H=xr(M||D)*(Math.abs(D)-Math.abs(M));A-=H,M+=H}}else{var J=[a.scale(P[0]),a.scale(P[1])],q=J[0],re=J[1];if(R=q,A=t6({axis:i,ticks:c,bandSize:o,offset:h.offset,entry:k,index:N}),C=re-q,M=h.size,T={x:a.x,y:A,width:a.width,height:M},Math.abs(D)>0&&Math.abs(C)<Math.abs(D)){var Z=xr(C||D)*(Math.abs(D)-Math.abs(C));C+=Z}}return Ft(Ft(Ft({},k),{},{x:R,y:A,width:C,height:M,value:l?P:P[1],payload:k,background:T},S&&S[N]&&S[N].props),{},{tooltipPayload:[i6(n,k)],tooltipPosition:{x:R+C/2,y:A+M/2}})});return Ft({data:O,layout:y},f)});function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function Ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z$(r.key),r)}}function Nve(e,t,n){return t&&B$(e.prototype,t),n&&B$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$$(Object(n),!0).forEach(function(r){Sh(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$$(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Sh(e,t,n){return t=z$(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z$(e){var t=Mve(e,"string");return Mu(t)=="symbol"?t:t+""}function Mve(e,t){if(Mu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Mu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kve=function(e,t,n,r,o){var a=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:a-n.right,rightMirror:a-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!Bn(c,ai);return l.reduce(function(f,h){var y=t[h],m=y.orientation,v=y.domain,b=y.padding,x=b===void 0?{}:b,_=y.mirror,w=y.reversed,j="".concat(m).concat(_?"Mirror":""),E,S,O,k,N;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var P=v[1]-v[0],R=1/0,A=y.categoricalDomain.sort();if(A.forEach(function(H,J){J>0&&(R=Math.min((H||0)-(A[J-1]||0),R))}),Number.isFinite(R)){var C=R/P,M=y.layout==="vertical"?n.height:n.width;if(y.padding==="gap"&&(E=C*M/2),y.padding==="no-gap"){var T=Ka(e.barCategoryGap,C*M),D=C*M/2;E=D-T-(D-T)/M*T}}}r==="xAxis"?S=[n.left+(x.left||0)+(E||0),n.left+n.width-(x.right||0)-(E||0)]:r==="yAxis"?S=s==="horizontal"?[n.top+n.height-(x.bottom||0),n.top+(x.top||0)]:[n.top+(x.top||0)+(E||0),n.top+n.height-(x.bottom||0)-(E||0)]:S=y.range,w&&(S=[S[1],S[0]]);var I=ohe(y,o,d),L=I.scale,B=I.realScaleType;L.domain(v).range(S),ahe(L);var U=phe(L,Er(Er({},y),{},{realScaleType:B}));r==="xAxis"?(N=m==="top"&&!_||m==="bottom"&&_,O=n.left,k=u[j]-N*y.height):r==="yAxis"&&(N=m==="left"&&!_||m==="right"&&_,O=u[j]-N*y.width,k=n.top);var F=Er(Er(Er({},y),U),{},{realScaleType:B,x:O,y:k,scale:L,width:r==="xAxis"?n.width:y.width,height:r==="yAxis"?n.height:y.height});return F.bandSize=ih(F,U),!y.hide&&r==="xAxis"?u[j]+=(N?-1:1)*F.height:y.hide||(u[j]+=(N?-1:1)*F.width),Er(Er({},f),{},Sh({},h,F))},{})},V$=function(e,t){var n=e.x,r=e.y,o=t.x,a=t.y;return{x:Math.min(n,o),y:Math.min(r,a),width:Math.abs(o-n),height:Math.abs(a-r)}},Pve=function(e){var t=e.x1,n=e.y1,r=e.x2,o=e.y2;return V$({x:t,y:n},{x:r,y:o})},U$=function(){function e(t){Ove(this,e),this.scale=t}return Nve(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,o=n.position;if(t!==void 0){if(o)switch(o){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],o=n[n.length-1];return r<=o?t>=r&&t<=o:t>=o&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();Sh(U$,"EPS",1e-4);var Ij=function(e){var t=Object.keys(e).reduce(function(n,r){return Er(Er({},n),{},Sh({},r,U$.create(e[r])))},{});return Er(Er({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.bandAware,a=r.position;return ove(n,function(i,s){return t[s].apply(i,{bandAware:o,position:a})})},isInRange:function(n){return P$(n,function(r,o){return t[o].isInRange(r)})}})};function Ave(e){return(e%180+180)%180}var Tve=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=Ave(r),a=o*Math.PI/180,i=Math.atan(n/t),s=a>i&&a<Math.PI-i?n/Math.sin(a):t/Math.cos(a);return Math.abs(s)},Dj,H$;function Rve(){if(H$)return Dj;H$=1;var e=Lr(),t=wa(),n=cc();function r(o){return function(a,i,s){var c=Object(a);if(!t(a)){var l=e(i,3);a=n(a),i=function(d){return l(c[d],d,c)}}var u=o(a,i,s);return u>-1?c[l?a[u]:u]:void 0}}return Dj=r,Dj}var Lj,W$;function Ive(){if(W$)return Lj;W$=1;var e=K4(),t=Lr(),n=c3(),r=Math.max;function o(a,i,s){var c=a==null?0:a.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(a,t(i,3),l)}return Lj=o,Lj}var Fj,q$;function Dve(){if(q$)return Fj;q$=1;var e=Rve(),t=Ive(),n=e(t);return Fj=n,Fj}var Lve=Dve();const Fve=Xe(Lve);var Bve=hA(),$ve=Xe(Bve)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Bj=g.createContext(void 0),$j=g.createContext(void 0),Y$=g.createContext(void 0),K$=g.createContext({}),X$=g.createContext(void 0),Q$=g.createContext(0),J$=g.createContext(0),G$=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,o=t.offset,a=e.clipPathId,i=e.children,s=e.width,c=e.height,l=$ve(o);return V.createElement(Bj.Provider,{value:n},V.createElement($j.Provider,{value:r},V.createElement(K$.Provider,{value:o},V.createElement(Y$.Provider,{value:l},V.createElement(X$.Provider,{value:a},V.createElement(Q$.Provider,{value:c},V.createElement(J$.Provider,{value:s},i)))))))},zve=function(){return g.useContext(X$)},Z$=function(e){var t=g.useContext(Bj);t==null&&ni();var n=t[e];return n==null&&ni(),n},Vve=function(){var e=g.useContext(Bj);return ca(e)},Uve=function(){var e=g.useContext($j),t=Fve(e,function(n){return P$(n.domain,Number.isFinite)});return t||ca(e)},e8=function(e){var t=g.useContext($j);t==null&&ni();var n=t[e];return n==null&&ni(),n},Hve=function(){var e=g.useContext(Y$);return e},Wve=function(){return g.useContext(K$)},zj=function(){return g.useContext(J$)},Vj=function(){return g.useContext(Q$)};function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function qve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o8(r.key),r)}}function Kve(e,t,n){return t&&Yve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xve(e,t,n){return t=Ch(t),Qve(e,t8()?Reflect.construct(t,n||[],Ch(e).constructor):t.apply(e,n))}function Qve(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jve(e)}function Jve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t8=function(){return!!e})()}function Ch(e){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ch(e)}function Gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uj(e,t)}function Uj(e,t){return Uj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Uj(e,t)}function n8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function r8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n8(Object(n),!0).forEach(function(r){Hj(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hj(e,t,n){return t=o8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o8(e){var t=Zve(e,"string");return Fs(t)=="symbol"?t:t+""}function Zve(e,t){if(Fs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e0e(e,t){return o0e(e)||r0e(e,t)||n0e(e,t)||t0e()}function t0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n0e(e,t){if(e){if(typeof e=="string")return a8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a8(e,t)}}function a8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r0e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function o0e(e){if(Array.isArray(e))return e}function Wj(){return Wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wj.apply(this,arguments)}var a0e=function(e,t){var n;return V.isValidElement(e)?n=V.cloneElement(e,t):We(e)?n=e(t):n=V.createElement("line",Wj({},t,{className:"recharts-reference-line-line"})),n},i0e=function(e,t,n,r,o,a,i,s,c){var l=o.x,u=o.y,d=o.width,f=o.height;if(n){var h=c.y,y=e.y.apply(h,{position:a});if(Xr(c,"discard")&&!e.y.isInRange(y))return null;var m=[{x:l+d,y},{x:l,y}];return s==="left"?m.reverse():m}if(t){var v=c.x,b=e.x.apply(v,{position:a});if(Xr(c,"discard")&&!e.x.isInRange(b))return null;var x=[{x:b,y:u+f},{x:b,y:u}];return i==="top"?x.reverse():x}if(r){var _=c.segment,w=_.map(function(j){return e.apply(j,{position:a})});return Xr(c,"discard")&&tve(w,function(j){return!e.isInRange(j)})?null:w}return null};function s0e(e){var t=e.x,n=e.y,r=e.segment,o=e.xAxisId,a=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=zve(),u=Z$(o),d=e8(a),f=Hve();if(!l||!f)return null;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Ij({x:u.scale,y:d.scale}),y=zt(t),m=zt(n),v=r&&r.length===2,b=i0e(h,y,m,v,f,e.position,u.orientation,d.orientation,e);if(!b)return null;var x=e0e(b,2),_=x[0],w=_.x,j=_.y,E=x[1],S=E.x,O=E.y,k=Xr(e,"hidden")?"url(#".concat(l,")"):void 0,N=r8(r8({clipPath:k},ot(e,!0)),{},{x1:w,y1:j,x2:S,y2:O});return V.createElement(Wt,{className:ut("recharts-reference-line",s)},a0e(i,N),rn.renderCallByParent(e,Pve({x1:w,y1:j,x2:S,y2:O})))}var qj=function(e){function t(){return qve(this,t),Xve(this,t,arguments)}return Gve(t,e),Kve(t,[{key:"render",value:function(){return V.createElement(s0e,this.props)}}])}(V.Component);Hj(qj,"displayName","ReferenceLine"),Hj(qj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Yj(){return Yj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yj.apply(this,arguments)}function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function i8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function s8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i8(Object(n),!0).forEach(function(r){Nh(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function c0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l0e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l8(r.key),r)}}function u0e(e,t,n){return t&&l0e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d0e(e,t,n){return t=Oh(t),f0e(e,c8()?Reflect.construct(t,n||[],Oh(e).constructor):t.apply(e,n))}function f0e(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p0e(e)}function p0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(c8=function(){return!!e})()}function Oh(e){return Oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oh(e)}function h0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kj(e,t)}function Kj(e,t){return Kj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Kj(e,t)}function Nh(e,t,n){return t=l8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l8(e){var t=m0e(e,"string");return Bs(t)=="symbol"?t:t+""}function m0e(e,t){if(Bs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y0e=function(e){var t=e.x,n=e.y,r=e.xAxis,o=e.yAxis,a=Ij({x:r.scale,y:o.scale}),i=a.apply({x:t,y:n},{bandAware:!0});return Xr(e,"discard")&&!a.isInRange(i)?null:i},Mh=function(e){function t(){return c0e(this,t),d0e(this,t,arguments)}return h0e(t,e),u0e(t,[{key:"render",value:function(){var n=this.props,r=n.x,o=n.y,a=n.r,i=n.alwaysShow,s=n.clipPathId,c=zt(r),l=zt(o);if(Po(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=y0e(this.props);if(!u)return null;var d=u.x,f=u.y,h=this.props,y=h.shape,m=h.className,v=Xr(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=s8(s8({clipPath:v},ot(this.props,!0)),{},{cx:d,cy:f});return V.createElement(Wt,{className:ut("recharts-reference-dot",m)},t.renderDot(y,b),rn.renderCallByParent(this.props,{x:d-a,y:f-a,width:2*a,height:2*a}))}}])}(V.Component);Nh(Mh,"displayName","ReferenceDot"),Nh(Mh,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),Nh(Mh,"renderDot",function(e,t){var n;return V.isValidElement(e)?n=V.cloneElement(e,t):We(e)?n=e(t):n=V.createElement(o$,Yj({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function Xj(){return Xj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xj.apply(this,arguments)}function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function u8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function d8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u8(Object(n),!0).forEach(function(r){Ph(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function g0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v0e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p8(r.key),r)}}function b0e(e,t,n){return t&&v0e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function x0e(e,t,n){return t=kh(t),w0e(e,f8()?Reflect.construct(t,n||[],kh(e).constructor):t.apply(e,n))}function w0e(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _0e(e)}function _0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f8=function(){return!!e})()}function kh(e){return kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kh(e)}function j0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qj(e,t)}function Qj(e,t){return Qj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Qj(e,t)}function Ph(e,t,n){return t=p8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p8(e){var t=E0e(e,"string");return $s(t)=="symbol"?t:t+""}function E0e(e,t){if($s(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($s(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S0e=function(e,t,n,r,o){var a=o.x1,i=o.x2,s=o.y1,c=o.y2,l=o.xAxis,u=o.yAxis;if(!l||!u)return null;var d=Ij({x:l.scale,y:u.scale}),f={x:e?d.x.apply(a,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},h={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Xr(o,"discard")&&(!d.isInRange(f)||!d.isInRange(h))?null:V$(f,h)},Ah=function(e){function t(){return g0e(this,t),x0e(this,t,arguments)}return j0e(t,e),b0e(t,[{key:"render",value:function(){var n=this.props,r=n.x1,o=n.x2,a=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=zt(r),d=zt(o),f=zt(a),h=zt(i),y=this.props.shape;if(!u&&!d&&!f&&!h&&!y)return null;var m=S0e(u,d,f,h,this.props);if(!m&&!y)return null;var v=Xr(this.props,"hidden")?"url(#".concat(l,")"):void 0;return V.createElement(Wt,{className:ut("recharts-reference-area",s)},t.renderRect(y,d8(d8({clipPath:v},ot(this.props,!0)),m)),rn.renderCallByParent(this.props,m))}}])}(V.Component);Ph(Ah,"displayName","ReferenceArea"),Ph(Ah,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),Ph(Ah,"renderRect",function(e,t){var n;return V.isValidElement(e)?n=V.cloneElement(e,t):We(e)?n=e(t):n=V.createElement(gj,Xj({},t,{className:"recharts-reference-area-rect"})),n});function h8(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],o=0;o<e.length;o+=t)r.push(e[o]);return r}function C0e(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return Tve(r,n)}function O0e(e,t,n){var r=n==="width",o=e.x,a=e.y,i=e.width,s=e.height;return t===1?{start:r?o:a,end:r?o+i:a+s}:{start:r?o+i:a+s,end:r?o:a}}function Th(e,t,n,r,o){if(e*t<e*r||e*t>e*o)return!1;var a=n();return e*(t-e*a/2-r)>=0&&e*(t+e*a/2-o)<=0}function N0e(e,t){return h8(e,t+1)}function M0e(e,t,n,r,o){for(var a=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var h=r==null?void 0:r[c];if(h===void 0)return{v:h8(r,l)};var y=c,m,v=function(){return m===void 0&&(m=n(h,y)),m},b=h.coordinate,x=c===0||Th(e,b,v,u,s);x||(c=0,u=i,l+=1),x&&(u=b+e*(v()/2+o),c+=l)},f;l<=a.length;)if(f=d(),f)return f.v;return[]}function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function m8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m8(Object(n),!0).forEach(function(r){k0e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function k0e(e,t,n){return t=P0e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P0e(e){var t=A0e(e,"string");return ku(t)=="symbol"?t:t+""}function A0e(e,t){if(ku(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ku(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T0e(e,t,n,r,o){for(var a=(r||[]).slice(),i=a.length,s=t.start,c=t.end,l=function(d){var f=a[d],h,y=function(){return h===void 0&&(h=n(f,d)),h};if(d===i-1){var m=e*(f.coordinate+e*y()/2-c);a[d]=f=on(on({},f),{},{tickCoord:m>0?f.coordinate-m*e:f.coordinate})}else a[d]=f=on(on({},f),{},{tickCoord:f.coordinate});var v=Th(e,f.tickCoord,y,s,c);v&&(c=f.tickCoord-e*(y()/2+o),a[d]=on(on({},f),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return a}function R0e(e,t,n,r,o,a){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(a){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);i[s-1]=u=on(on({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var h=Th(e,u.tickCoord,function(){return d},c,l);h&&(l=u.tickCoord-e*(d/2+o),i[s-1]=on(on({},u),{},{isShow:!0}))}for(var y=a?s-1:s,m=function(b){var x=i[b],_,w=function(){return _===void 0&&(_=n(x,b)),_};if(b===0){var j=e*(x.coordinate-e*w()/2-c);i[b]=x=on(on({},x),{},{tickCoord:j<0?x.coordinate-j*e:x.coordinate})}else i[b]=x=on(on({},x),{},{tickCoord:x.coordinate});var E=Th(e,x.tickCoord,w,c,l);E&&(c=x.tickCoord+e*(w()/2+o),i[b]=on(on({},x),{},{isShow:!0}))},v=0;v<y;v++)m(v);return i}function Jj(e,t,n){var r=e.tick,o=e.ticks,a=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!o||!o.length||!r)return[];if(me(c)||la.isSsr)return N0e(o,typeof c=="number"&&me(c)?c:0);var f=[],h=s==="top"||s==="bottom"?"width":"height",y=u&&h==="width"?ql(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(x,_){var w=We(l)?l(x.value,_):x.value;return h==="width"?C0e(ql(w,{fontSize:t,letterSpacing:n}),y,d):ql(w,{fontSize:t,letterSpacing:n})[h]},v=o.length>=2?xr(o[1].coordinate-o[0].coordinate):1,b=O0e(a,v,h);return c==="equidistantPreserveStart"?M0e(v,b,m,o,i):(c==="preserveStart"||c==="preserveStartEnd"?f=R0e(v,b,m,o,i,c==="preserveStartEnd"):f=T0e(v,b,m,o,i),f.filter(function(x){return x.isShow}))}var I0e=["viewBox"],D0e=["viewBox"],L0e=["ticks"];function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function Vs(){return Vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vs.apply(this,arguments)}function y8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y8(Object(n),!0).forEach(function(r){eE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Gj(e,t){if(e==null)return{};var n=F0e(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function F0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function B0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b8(r.key),r)}}function $0e(e,t,n){return t&&g8(e.prototype,t),n&&g8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z0e(e,t,n){return t=Rh(t),V0e(e,v8()?Reflect.construct(t,n||[],Rh(e).constructor):t.apply(e,n))}function V0e(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U0e(e)}function U0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v8=function(){return!!e})()}function Rh(e){return Rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rh(e)}function H0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zj(e,t)}function Zj(e,t){return Zj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Zj(e,t)}function eE(e,t,n){return t=b8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b8(e){var t=W0e(e,"string");return zs(t)=="symbol"?t:t+""}function W0e(e,t){if(zs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Us=function(e){function t(n){var r;return B0e(this,t),r=z0e(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return H0e(t,e),$0e(t,[{key:"shouldComponentUpdate",value:function(n,r){var o=n.viewBox,a=Gj(n,I0e),i=this.props,s=i.viewBox,c=Gj(i,D0e);return!ys(o,s)||!ys(a,c)||!ys(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,o=r.x,a=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,f,h,y,m,v,b,x=u?-1:1,_=n.tickSize||l,w=me(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=h=n.coordinate,m=a+ +!u*s,y=m-x*_,b=y-x*d,v=w;break;case"left":y=m=n.coordinate,h=o+ +!u*i,f=h-x*_,v=f-x*d,b=w;break;case"right":y=m=n.coordinate,h=o+ +u*i,f=h+x*_,v=f+x*d,b=w;break;default:f=h=n.coordinate,m=a+ +u*s,y=m+x*_,b=y+x*d,v=w;break}return{line:{x1:f,y1:y,x2:h,y2:m},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,o=n.mirror,a;switch(r){case"left":a=o?"start":"end";break;case"right":a=o?"end":"start";break;default:a="middle";break}return a}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,o=n.mirror,a="end";switch(r){case"left":case"right":a="middle";break;case"top":a=o?"start":"end";break;default:a=o?"end":"start";break}return a}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,o=n.y,a=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=vn(vn(vn({},ot(this.props,!1)),ot(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=vn(vn({},u),{},{x1:r,y1:o+d*i,x2:r+a,y2:o+d*i})}else{var f=+(s==="left"&&!c||s==="right"&&c);u=vn(vn({},u),{},{x1:r+f*a,y1:o,x2:r+f*a,y2:o+i})}return V.createElement("line",Vs({},u,{className:ut("recharts-cartesian-axis-line",qn(l,"className"))}))}},{key:"renderTicks",value:function(n,r,o){var a=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,f=Jj(vn(vn({},this.props),{},{ticks:n}),r,o),h=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),m=ot(this.props,!1),v=ot(l,!1),b=vn(vn({},m),{},{fill:"none"},ot(s,!1)),x=f.map(function(_,w){var j=a.getTickLineCoord(_),E=j.line,S=j.tick,O=vn(vn(vn(vn({textAnchor:h,verticalAnchor:y},m),{},{stroke:"none",fill:c},v),S),{},{index:w,payload:_,visibleTicksCount:f.length,tickFormatter:u});return V.createElement(Wt,Vs({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},mp(a.props,_,w)),s&&V.createElement("line",Vs({},b,E,{className:ut("recharts-cartesian-axis-tick-line",qn(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(We(u)?u(_.value,w):_.value).concat(d||"")))});return V.createElement("g",{className:"recharts-cartesian-axis-ticks"},x)}},{key:"render",value:function(){var n=this,r=this.props,o=r.axisLine,a=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,f=Gj(u,L0e),h=d;return We(s)&&(h=d&&d.length>0?s(this.props):s(f)),a<=0||i<=0||!h||!h.length?null:V.createElement(Wt,{className:ut("recharts-cartesian-axis",c),ref:function(y){n.layerReference=y}},o&&this.renderAxisLine(),this.renderTicks(h,this.state.fontSize,this.state.letterSpacing),rn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,o){var a;return V.isValidElement(n)?a=V.cloneElement(n,r):We(n)?a=n(r):a=V.createElement(Ip,Vs({},r,{className:"recharts-cartesian-axis-tick-value"}),o),a}}])}(g.Component);eE(Us,"displayName","CartesianAxis"),eE(Us,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var q0e=["x1","y1","x2","y2","key"],Y0e=["offset"];function ii(e){"@babel/helpers - typeof";return ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(e)}function x8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x8(Object(n),!0).forEach(function(r){K0e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function K0e(e,t,n){return t=X0e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X0e(e){var t=Q0e(e,"string");return ii(t)=="symbol"?t:t+""}function Q0e(e,t){if(ii(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ii(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function si(){return si=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},si.apply(this,arguments)}function w8(e,t){if(e==null)return{};var n=J0e(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function J0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var G0e=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,o=e.y,a=e.width,i=e.height,s=e.ry;return V.createElement("rect",{x:r,y:o,ry:s,width:a,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function _8(e,t){var n;if(V.isValidElement(e))n=V.cloneElement(e,t);else if(We(e))n=e(t);else{var r=t.x1,o=t.y1,a=t.x2,i=t.y2,s=t.key,c=w8(t,q0e),l=ot(c,!1);l.offset;var u=w8(l,Y0e);n=V.createElement("line",si({},u,{x1:r,y1:o,x2:a,y2:i,fill:"none",key:s}))}return n}function Z0e(e){var t=e.x,n=e.width,r=e.horizontal,o=r===void 0?!0:r,a=e.horizontalPoints;if(!o||!a||!a.length)return null;var i=a.map(function(s,c){var l=an(an({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return _8(o,l)});return V.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function ebe(e){var t=e.y,n=e.height,r=e.vertical,o=r===void 0?!0:r,a=e.verticalPoints;if(!o||!a||!a.length)return null;var i=a.map(function(s,c){var l=an(an({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return _8(o,l)});return V.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function tbe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,o=e.y,a=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(f){return Math.round(f+o-o)}).sort(function(f,h){return f-h});o!==u[0]&&u.unshift(0);var d=u.map(function(f,h){var y=!u[h+1],m=y?o+i-f:u[h+1]-f;if(m<=0)return null;var v=h%t.length;return V.createElement("rect",{key:"react-".concat(h),y:f,x:r,height:m,width:a,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return V.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function nbe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,o=e.fillOpacity,a=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(f){return Math.round(f+a-a)}).sort(function(f,h){return f-h});a!==u[0]&&u.unshift(0);var d=u.map(function(f,h){var y=!u[h+1],m=y?a+s-f:u[h+1]-f;if(m<=0)return null;var v=h%r.length;return V.createElement("rect",{key:"react-".concat(h),x:f,y:i,width:m,height:c,stroke:"none",fill:r[v],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return V.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var rbe=function(e,t){var n=e.xAxis,r=e.width,o=e.height,a=e.offset;return ZB(Jj(an(an(an({},Us.defaultProps),n),{},{ticks:$o(n,!0),viewBox:{x:0,y:0,width:r,height:o}})),a.left,a.left+a.width,t)},obe=function(e,t){var n=e.yAxis,r=e.width,o=e.height,a=e.offset;return ZB(Jj(an(an(an({},Us.defaultProps),n),{},{ticks:$o(n,!0),viewBox:{x:0,y:0,width:r,height:o}})),a.top,a.top+a.height,t)},Hs={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function j8(e){var t,n,r,o,a,i,s=zj(),c=Vj(),l=Wve(),u=an(an({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Hs.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Hs.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Hs.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:Hs.horizontalFill,vertical:(a=e.vertical)!==null&&a!==void 0?a:Hs.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Hs.verticalFill,x:me(e.x)?e.x:l.left,y:me(e.y)?e.y:l.top,width:me(e.width)?e.width:l.width,height:me(e.height)?e.height:l.height}),d=u.x,f=u.y,h=u.width,y=u.height,m=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,x=Vve(),_=Uve();if(!me(h)||h<=0||!me(y)||y<=0||!me(d)||d!==+d||!me(f)||f!==+f)return null;var w=u.verticalCoordinatesGenerator||rbe,j=u.horizontalCoordinatesGenerator||obe,E=u.horizontalPoints,S=u.verticalPoints;if((!E||!E.length)&&We(j)){var O=v&&v.length,k=j({yAxis:_?an(an({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:m);Po(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(ii(k),"]")),Array.isArray(k)&&(E=k)}if((!S||!S.length)&&We(w)){var N=b&&b.length,P=w({xAxis:x?an(an({},x),{},{ticks:N?b:x.ticks}):void 0,width:s,height:c,offset:l},N?!0:m);Po(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(ii(P),"]")),Array.isArray(P)&&(S=P)}return V.createElement("g",{className:"recharts-cartesian-grid"},V.createElement(G0e,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),V.createElement(Z0e,si({},u,{offset:l,horizontalPoints:E,xAxis:x,yAxis:_})),V.createElement(ebe,si({},u,{offset:l,verticalPoints:S,xAxis:x,yAxis:_})),V.createElement(tbe,si({},u,{horizontalPoints:E})),V.createElement(nbe,si({},u,{verticalPoints:S})))}j8.displayName="CartesianGrid";function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function abe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ibe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C8(r.key),r)}}function sbe(e,t,n){return t&&ibe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cbe(e,t,n){return t=Ih(t),lbe(e,E8()?Reflect.construct(t,n||[],Ih(e).constructor):t.apply(e,n))}function lbe(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ube(e)}function ube(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E8=function(){return!!e})()}function Ih(e){return Ih=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ih(e)}function dbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tE(e,t)}function tE(e,t){return tE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},tE(e,t)}function S8(e,t,n){return t=C8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C8(e){var t=fbe(e,"string");return Ws(t)=="symbol"?t:t+""}function fbe(e,t){if(Ws(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ws(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nE(){return nE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nE.apply(this,arguments)}function pbe(e){var t=e.xAxisId,n=zj(),r=Vj(),o=Z$(t);return o==null?null:V.createElement(Us,nE({},o,{className:ut("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(a){return $o(a,!0)}}))}var Dh=function(e){function t(){return abe(this,t),cbe(this,t,arguments)}return dbe(t,e),sbe(t,[{key:"render",value:function(){return V.createElement(pbe,this.props)}}])}(V.Component);S8(Dh,"displayName","XAxis"),S8(Dh,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function hbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M8(r.key),r)}}function ybe(e,t,n){return t&&mbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gbe(e,t,n){return t=Lh(t),vbe(e,O8()?Reflect.construct(t,n||[],Lh(e).constructor):t.apply(e,n))}function vbe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bbe(e)}function bbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(O8=function(){return!!e})()}function Lh(e){return Lh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lh(e)}function xbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rE(e,t)}function rE(e,t){return rE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},rE(e,t)}function N8(e,t,n){return t=M8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M8(e){var t=wbe(e,"string");return qs(t)=="symbol"?t:t+""}function wbe(e,t){if(qs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(qs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oE(){return oE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oE.apply(this,arguments)}var _be=function(e){var t=e.yAxisId,n=zj(),r=Vj(),o=e8(t);return o==null?null:V.createElement(Us,oE({},o,{className:ut("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(a){return $o(a,!0)}}))},aE=function(e){function t(){return hbe(this,t),gbe(this,t,arguments)}return xbe(t,e),ybe(t,[{key:"render",value:function(){return V.createElement(_be,this.props)}}])}(V.Component);N8(aE,"displayName","YAxis"),N8(aE,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function k8(e){return Cbe(e)||Sbe(e)||Ebe(e)||jbe()}function jbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ebe(e,t){if(e){if(typeof e=="string")return iE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iE(e,t)}}function Sbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cbe(e){if(Array.isArray(e))return iE(e)}function iE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sE=function(e,t,n,r,o){var a=wr(e,qj),i=wr(e,Mh),s=[].concat(k8(a),k8(i)),c=wr(e,Ah),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(y,m){if(m.props[l]===n&&Xr(m.props,"extendDomain")&&me(m.props[u])){var v=m.props[u];return[Math.min(y[0],v),Math.max(y[1],v)]}return y},d)),c.length){var f="".concat(u,"1"),h="".concat(u,"2");d=c.reduce(function(y,m){if(m.props[l]===n&&Xr(m.props,"extendDomain")&&me(m.props[f])&&me(m.props[h])){var v=m.props[f],b=m.props[h];return[Math.min(y[0],v,b),Math.max(y[1],v,b)]}return y},d)}return o&&o.length&&(d=o.reduce(function(y,m){return me(m)?[Math.min(y[0],m),Math.max(y[1],m)]:y},d)),d},P8={exports:{}},A8;function Obe(){return A8||(A8=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function a(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new o(u,d||c,f),y=n?n+l:l;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],h]:c._events[y].push(h):(c._events[y]=h,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,h=new Array(f);d<f;d++)h[d]=u[d].fn;return h},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,f,h){var y=n?n+c:c;if(!this._events[y])return!1;var m=this._events[y],v=arguments.length,b,x;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,f),!0;case 6:return m.fn.call(m.context,l,u,d,f,h),!0}for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];m.fn.apply(m.context,b)}else{var _=m.length,w;for(x=0;x<_;x++)switch(m[x].once&&this.removeListener(c,m[x].fn,void 0,!0),v){case 1:m[x].fn.call(m[x].context);break;case 2:m[x].fn.call(m[x].context,l);break;case 3:m[x].fn.call(m[x].context,l,u);break;case 4:m[x].fn.call(m[x].context,l,u,d);break;default:if(!b)for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m[x].fn.apply(m[x].context,b)}}return!0},s.prototype.on=function(c,l,u){return a(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return a(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var f=n?n+c:c;if(!this._events[f])return this;if(!l)return i(this,f),this;var h=this._events[f];if(h.fn)h.fn===l&&(!d||h.once)&&(!u||h.context===u)&&i(this,f);else{for(var y=0,m=[],v=h.length;y<v;y++)(h[y].fn!==l||d&&!h[y].once||u&&h[y].context!==u)&&m.push(h[y]);m.length?this._events[f]=m.length===1?m[0]:m:i(this,f)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(P8)),P8.exports}var Nbe=Obe();const Mbe=Xe(Nbe);var cE=new Mbe,lE="recharts.syncMouseEvents";function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function kbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T8(r.key),r)}}function Abe(e,t,n){return t&&Pbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uE(e,t,n){return t=T8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T8(e){var t=Tbe(e,"string");return Pu(t)=="symbol"?t:t+""}function Tbe(e,t){if(Pu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Pu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Rbe=function(){function e(){kbe(this,e),uE(this,"activeIndex",0),uE(this,"coordinateList",[]),uE(this,"layout","horizontal")}return Abe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,o=r===void 0?null:r,a=t.container,i=a===void 0?null:a,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),o=r.x,a=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=o+s+c,d=a+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function Ibe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],o=e==null?void 0:e[1];if(r&&o&&me(r)&&me(o))return!0}return!1}function Dbe(e,t,n,r){var o=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-o,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function R8(e){var t=e.cx,n=e.cy,r=e.radius,o=e.startAngle,a=e.endAngle,i=Gt(t,n,r,o),s=Gt(t,n,r,a);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:o,endAngle:a}}function Lbe(e,t,n){var r,o,a,i;if(e==="horizontal")r=t.x,a=r,o=n.top,i=n.top+n.height;else if(e==="vertical")o=t.y,i=o,r=n.left,a=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,f=Gt(s,c,l,d),h=Gt(s,c,u,d);r=f.x,o=f.y,a=h.x,i=h.y}else return R8(t);return[{x:r,y:o},{x:a,y:i}]}function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function I8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Fh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I8(Object(n),!0).forEach(function(r){Fbe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fbe(e,t,n){return t=Bbe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bbe(e){var t=$be(e,"string");return Au(t)=="symbol"?t:t+""}function $be(e,t){if(Au(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Au(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zbe(e){var t,n,r=e.element,o=e.tooltipEventType,a=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,f=e.chartName,h=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!h||!a||!i||f!=="ScatterChart"&&o!=="axis")return null;var y,m=j6;if(f==="ScatterChart")y=i,m=rge;else if(f==="BarChart")y=Dbe(d,i,c,u),m=gj;else if(d==="radial"){var v=R8(i),b=v.cx,x=v.cy,_=v.radius,w=v.startAngle,j=v.endAngle;y={cx:b,cy:x,startAngle:w,endAngle:j,innerRadius:_,outerRadius:_},m=b6}else y={points:Lbe(d,i,c)},m=j6;var E=Fh(Fh(Fh(Fh({stroke:"#ccc",pointerEvents:"none"},c),y),ot(h,!1)),{},{payload:s,payloadIndex:l,className:ut("recharts-tooltip-cursor",h.className)});return g.isValidElement(h)?g.cloneElement(h,E):g.createElement(m,E)}var Vbe=["item"],Ube=["children","className","width","height","style","compact","title","desc"];function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function Ks(){return Ks=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ks.apply(this,arguments)}function D8(e,t){return qbe(e)||Wbe(e,t)||B8(e,t)||Hbe()}function Hbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wbe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function qbe(e){if(Array.isArray(e))return e}function L8(e,t){if(e==null)return{};var n=Ybe(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ybe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Kbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z8(r.key),r)}}function Qbe(e,t,n){return t&&Xbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jbe(e,t,n){return t=Bh(t),Gbe(e,F8()?Reflect.construct(t,n||[],Bh(e).constructor):t.apply(e,n))}function Gbe(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zbe(e)}function Zbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(F8=function(){return!!e})()}function Bh(e){return Bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bh(e)}function exe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dE(e,t)}function dE(e,t){return dE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},dE(e,t)}function Xs(e){return rxe(e)||nxe(e)||B8(e)||txe()}function txe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B8(e,t){if(e){if(typeof e=="string")return fE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fE(e,t)}}function nxe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rxe(e){if(Array.isArray(e))return fE(e)}function fE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$8(Object(n),!0).forEach(function(r){Re(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$8(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Re(e,t,n){return t=z8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z8(e){var t=oxe(e,"string");return Ys(t)=="symbol"?t:t+""}function oxe(e,t){if(Ys(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ys(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var axe={xAxis:["bottom","top"],yAxis:["left","right"]},ixe={width:"100%",height:"100%"},V8={x:0,y:0};function $h(e){return e}var sxe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},cxe=function(e,t,n,r){var o=t.find(function(l){return l&&l.index===n});if(o){if(e==="horizontal")return{x:o.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:o.coordinate};if(e==="centric"){var a=o.coordinate,i=r.radius;return ae(ae(ae({},r),Gt(r.cx,r.cy,i,a)),{},{angle:a,radius:i})}var s=o.coordinate,c=r.angle;return ae(ae(ae({},r),Gt(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return V8},zh=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,o=t.dataEndIndex,a=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(Xs(i),Xs(c)):i},[]);return a.length>0?a:e&&e.length&&me(r)&&me(o)?e.slice(r,o+1):[]};function U8(e){return e==="number"?[0,"auto"]:void 0}var pE=function(e,t,n,r){var o=e.graphicalItems,a=e.tooltipAxis,i=zh(t,e);return n<0||!o||!o.length||n>=i.length?null:o.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(a.dataKey&&!a.allowDuplicatedCategory){var f=u===void 0?i:u;d=Iw(f,a.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(Xs(s),[i6(c,d)]):s},[])},H8=function(e,t,n,r){var o=r||{x:e.chartX,y:e.chartY},a=sxe(o,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=Gpe(a,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=pE(e,t,l,u),f=cxe(n,i,l,o);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:f}}return null},lxe=function(e,t){var n=t.axes,r=t.graphicalItems,o=t.axisType,a=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,f=GB(l,o);return n.reduce(function(h,y){var m,v=y.type.defaultProps!==void 0?ae(ae({},y.type.defaultProps),y.props):y.props,b=v.type,x=v.dataKey,_=v.allowDataOverflow,w=v.allowDuplicatedCategory,j=v.scale,E=v.ticks,S=v.includeHidden,O=v[a];if(h[O])return h;var k=zh(e.data,{graphicalItems:r.filter(function(U){var F,H=a in U.props?U.props[a]:(F=U.type.defaultProps)===null||F===void 0?void 0:F[a];return H===O}),dataStartIndex:s,dataEndIndex:c}),N=k.length,P,R,A;Ibe(v.domain,_,b)&&(P=Z_(v.domain,null,_),f&&(b==="number"||j!=="auto")&&(A=oh(k,x,"category")));var C=U8(b);if(!P||P.length===0){var M,T=(M=v.domain)!==null&&M!==void 0?M:C;if(x){if(P=oh(k,x,b),b==="category"&&f){var D=use(P);w&&D?(R=P,P=xh(0,N)):w||(P=a6(T,P,y).reduce(function(U,F){return U.indexOf(F)>=0?U:[].concat(Xs(U),[F])},[]))}else if(b==="category")w?P=P.filter(function(U){return U!==""&&!it(U)}):P=a6(T,P,y).reduce(function(U,F){return U.indexOf(F)>=0||F===""||it(F)?U:[].concat(Xs(U),[F])},[]);else if(b==="number"){var I=rhe(k,r.filter(function(U){var F,H,J=a in U.props?U.props[a]:(F=U.type.defaultProps)===null||F===void 0?void 0:F[a],q="hide"in U.props?U.props.hide:(H=U.type.defaultProps)===null||H===void 0?void 0:H.hide;return J===O&&(S||!q)}),x,o,l);I&&(P=I)}f&&(b==="number"||j!=="auto")&&(A=oh(k,x,"category"))}else f?P=xh(0,N):i&&i[O]&&i[O].hasStack&&b==="number"?P=d==="expand"?[0,1]:n6(i[O].stackGroups,s,c):P=JB(k,r.filter(function(U){var F=a in U.props?U.props[a]:U.type.defaultProps[a],H="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return F===O&&(S||!H)}),b,l,!0);if(b==="number")P=sE(u,P,O,o,E),T&&(P=Z_(T,P,_));else if(b==="category"&&T){var L=T,B=P.every(function(U){return L.indexOf(U)>=0});B&&(P=L)}}return ae(ae({},h),{},Re({},O,ae(ae({},v),{},{axisType:o,domain:P,categoricalDomain:A,duplicateDomain:R,originalDomain:(m=v.domain)!==null&&m!==void 0?m:C,isCategorical:f,layout:l})))},{})},uxe=function(e,t){var n=t.graphicalItems,r=t.Axis,o=t.axisType,a=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=zh(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),f=d.length,h=GB(l,o),y=-1;return n.reduce(function(m,v){var b=v.type.defaultProps!==void 0?ae(ae({},v.type.defaultProps),v.props):v.props,x=b[a],_=U8("number");if(!m[x]){y++;var w;return h?w=xh(0,f):i&&i[x]&&i[x].hasStack?(w=n6(i[x].stackGroups,s,c),w=sE(u,w,x,o)):(w=Z_(_,JB(d,n.filter(function(j){var E,S,O=a in j.props?j.props[a]:(E=j.type.defaultProps)===null||E===void 0?void 0:E[a],k="hide"in j.props?j.props.hide:(S=j.type.defaultProps)===null||S===void 0?void 0:S.hide;return O===x&&!k}),"number",l),r.defaultProps.allowDataOverflow),w=sE(u,w,x,o)),ae(ae({},m),{},Re({},x,ae(ae({axisType:o},r.defaultProps),{},{hide:!0,orientation:qn(axe,"".concat(o,".").concat(y%2),null),domain:w,originalDomain:_,isCategorical:h,layout:l})))}return m},{})},dxe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,o=t.AxisComp,a=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=wr(l,o),f={};return d&&d.length?f=lxe(e,{axes:d,graphicalItems:a,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):a&&a.length&&(f=uxe(e,{Axis:o,graphicalItems:a,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),f},fxe=function(e){var t=ca(e),n=$o(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:H1(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:ih(t,n)}},W8=function(e){var t=e.children,n=e.defaultShowTooltip,r=Bn(t,Ds),o=0,a=0;return e.data&&e.data.length!==0&&(a=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(o=r.props.startIndex),r.props.endIndex>=0&&(a=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:a,activeTooltipIndex:-1,isTooltipActive:!!n}},pxe=function(e){return!e||!e.length?!1:e.some(function(t){var n=ko(t&&t.type);return n&&n.indexOf("Bar")>=0})},q8=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},hxe=function(e,t){var n=e.props,r=e.graphicalItems,o=e.xAxisMap,a=o===void 0?{}:o,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},f=Bn(u,Ds),h=Bn(u,xs),y=Object.keys(s).reduce(function(w,j){var E=s[j],S=E.orientation;return!E.mirror&&!E.hide?ae(ae({},w),{},Re({},S,w[S]+E.width)):w},{left:d.left||0,right:d.right||0}),m=Object.keys(a).reduce(function(w,j){var E=a[j],S=E.orientation;return!E.mirror&&!E.hide?ae(ae({},w),{},Re({},S,qn(w,"".concat(S))+E.height)):w},{top:d.top||0,bottom:d.bottom||0}),v=ae(ae({},m),y),b=v.bottom;f&&(v.bottom+=f.props.height||Ds.defaultProps.height),h&&t&&(v=the(v,r,n,t));var x=c-v.left-v.right,_=l-v.top-v.bottom;return ae(ae({brushBottom:b},v),{},{width:Math.max(x,0),height:Math.max(_,0)})},mxe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},yxe=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,o=r===void 0?"axis":r,a=e.validateTooltipEventTypes,i=a===void 0?["axis"]:a,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(m,v){var b=v.graphicalItems,x=v.stackGroups,_=v.offset,w=v.updateId,j=v.dataStartIndex,E=v.dataEndIndex,S=m.barSize,O=m.layout,k=m.barGap,N=m.barCategoryGap,P=m.maxBarSize,R=q8(O),A=R.numericAxisName,C=R.cateAxisName,M=pxe(b),T=[];return b.forEach(function(D,I){var L=zh(m.data,{graphicalItems:[D],dataStartIndex:j,dataEndIndex:E}),B=D.type.defaultProps!==void 0?ae(ae({},D.type.defaultProps),D.props):D.props,U=B.dataKey,F=B.maxBarSize,H=B["".concat(A,"Id")],J=B["".concat(C,"Id")],q={},re=s.reduce(function(ze,ct){var He=v["".concat(ct.axisType,"Map")],lt=B["".concat(ct.axisType,"Id")];He&&He[lt]||ct.axisType==="zAxis"||ni();var Ht=He[lt];return ae(ae({},ze),{},Re(Re({},ct.axisType,Ht),"".concat(ct.axisType,"Ticks"),$o(Ht)))},q),Z=re[C],Y=re["".concat(C,"Ticks")],W=x&&x[H]&&x[H].hasStack&&mhe(D,x[H].stackGroups),G=ko(D.type).indexOf("Bar")>=0,te=ih(Z,Y),$=[],se=M&&Zpe({barSize:S,stackGroups:x,totalSize:mxe(re,C)});if(G){var ue,ve,Te=it(F)?P:F,qe=(ue=(ve=ih(Z,Y,!0))!==null&&ve!==void 0?ve:Te)!==null&&ue!==void 0?ue:0;$=ehe({barGap:k,barCategoryGap:N,bandSize:qe!==te?qe:te,sizeList:se[J],maxBarSize:Te}),qe!==te&&($=$.map(function(ze){return ae(ae({},ze),{},{position:ae(ae({},ze.position),{},{offset:ze.position.offset-qe/2})})}))}var Ye=D&&D.type&&D.type.getComposedData;Ye&&T.push({props:ae(ae({},Ye(ae(ae({},re),{},{displayedData:L,props:m,dataKey:U,item:D,bandSize:te,barPosition:$,offset:_,stackedData:W,layout:O,dataStartIndex:j,dataEndIndex:E}))),{},Re(Re(Re({key:D.key||"item-".concat(I)},A,re[A]),C,re[C]),"animationId",w)),childIndex:wse(D,m.children),item:D})}),T},f=function(m,v){var b=m.props,x=m.dataStartIndex,_=m.dataEndIndex,w=m.updateId;if(!u4({props:b}))return null;var j=b.children,E=b.layout,S=b.stackOffset,O=b.data,k=b.reverseStackOrder,N=q8(E),P=N.numericAxisName,R=N.cateAxisName,A=wr(j,n),C=fhe(O,A,"".concat(P,"Id"),"".concat(R,"Id"),S,k),M=s.reduce(function(B,U){var F="".concat(U.axisType,"Map");return ae(ae({},B),{},Re({},F,dxe(b,ae(ae({},U),{},{graphicalItems:A,stackGroups:U.axisType===P&&C,dataStartIndex:x,dataEndIndex:_}))))},{}),T=hxe(ae(ae({},M),{},{props:b,graphicalItems:A}),v==null?void 0:v.legendBBox);Object.keys(M).forEach(function(B){M[B]=l(b,M[B],T,B.replace("Map",""),t)});var D=M["".concat(R,"Map")],I=fxe(D),L=d(b,ae(ae({},M),{},{dataStartIndex:x,dataEndIndex:_,updateId:w,graphicalItems:A,stackGroups:C,offset:T}));return ae(ae({formattedGraphicalItems:L,graphicalItems:A,offset:T,stackGroups:C},I),M)},h=function(m){function v(b){var x,_,w;return Kbe(this,v),w=Jbe(this,v,[b]),Re(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Re(w,"accessibilityManager",new Rbe),Re(w,"handleLegendBBoxUpdate",function(j){if(j){var E=w.state,S=E.dataStartIndex,O=E.dataEndIndex,k=E.updateId;w.setState(ae({legendBBox:j},f({props:w.props,dataStartIndex:S,dataEndIndex:O,updateId:k},ae(ae({},w.state),{},{legendBBox:j}))))}}),Re(w,"handleReceiveSyncEvent",function(j,E,S){if(w.props.syncId===j){if(S===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(E)}}),Re(w,"handleBrushChange",function(j){var E=j.startIndex,S=j.endIndex;if(E!==w.state.dataStartIndex||S!==w.state.dataEndIndex){var O=w.state.updateId;w.setState(function(){return ae({dataStartIndex:E,dataEndIndex:S},f({props:w.props,dataStartIndex:E,dataEndIndex:S,updateId:O},w.state))}),w.triggerSyncEvent({dataStartIndex:E,dataEndIndex:S})}}),Re(w,"handleMouseEnter",function(j){var E=w.getMouseInfo(j);if(E){var S=ae(ae({},E),{},{isTooltipActive:!0});w.setState(S),w.triggerSyncEvent(S);var O=w.props.onMouseEnter;We(O)&&O(S,j)}}),Re(w,"triggeredAfterMouseMove",function(j){var E=w.getMouseInfo(j),S=E?ae(ae({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(S),w.triggerSyncEvent(S);var O=w.props.onMouseMove;We(O)&&O(S,j)}),Re(w,"handleItemMouseEnter",function(j){w.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Re(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),Re(w,"handleMouseMove",function(j){j.persist(),w.throttleTriggeredAfterMouseMove(j)}),Re(w,"handleMouseLeave",function(j){w.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};w.setState(E),w.triggerSyncEvent(E);var S=w.props.onMouseLeave;We(S)&&S(E,j)}),Re(w,"handleOuterEvent",function(j){var E=xse(j),S=qn(w.props,"".concat(E));if(E&&We(S)){var O,k;/.*touch.*/i.test(E)?k=w.getMouseInfo(j.changedTouches[0]):k=w.getMouseInfo(j),S((O=k)!==null&&O!==void 0?O:{},j)}}),Re(w,"handleClick",function(j){var E=w.getMouseInfo(j);if(E){var S=ae(ae({},E),{},{isTooltipActive:!0});w.setState(S),w.triggerSyncEvent(S);var O=w.props.onClick;We(O)&&O(S,j)}}),Re(w,"handleMouseDown",function(j){var E=w.props.onMouseDown;if(We(E)){var S=w.getMouseInfo(j);E(S,j)}}),Re(w,"handleMouseUp",function(j){var E=w.props.onMouseUp;if(We(E)){var S=w.getMouseInfo(j);E(S,j)}}),Re(w,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Re(w,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseDown(j.changedTouches[0])}),Re(w,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseUp(j.changedTouches[0])}),Re(w,"triggerSyncEvent",function(j){w.props.syncId!==void 0&&cE.emit(lE,w.props.syncId,j,w.eventEmitterSymbol)}),Re(w,"applySyncEvent",function(j){var E=w.props,S=E.layout,O=E.syncMethod,k=w.state.updateId,N=j.dataStartIndex,P=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)w.setState(ae({dataStartIndex:N,dataEndIndex:P},f({props:w.props,dataStartIndex:N,dataEndIndex:P,updateId:k},w.state)));else if(j.activeTooltipIndex!==void 0){var R=j.chartX,A=j.chartY,C=j.activeTooltipIndex,M=w.state,T=M.offset,D=M.tooltipTicks;if(!T)return;if(typeof O=="function")C=O(D,j);else if(O==="value"){C=-1;for(var I=0;I<D.length;I++)if(D[I].value===j.activeLabel){C=I;break}}var L=ae(ae({},T),{},{x:T.left,y:T.top}),B=Math.min(R,L.x+L.width),U=Math.min(A,L.y+L.height),F=D[C]&&D[C].value,H=pE(w.state,w.props.data,C),J=D[C]?{x:S==="horizontal"?D[C].coordinate:B,y:S==="horizontal"?U:D[C].coordinate}:V8;w.setState(ae(ae({},j),{},{activeLabel:F,activeCoordinate:J,activePayload:H,activeTooltipIndex:C}))}else w.setState(j)}),Re(w,"renderCursor",function(j){var E,S=w.state,O=S.isTooltipActive,k=S.activeCoordinate,N=S.activePayload,P=S.offset,R=S.activeTooltipIndex,A=S.tooltipAxisBandSize,C=w.getTooltipEventType(),M=(E=j.props.active)!==null&&E!==void 0?E:O,T=w.props.layout,D=j.key||"_recharts-cursor";return V.createElement(zbe,{key:D,activeCoordinate:k,activePayload:N,activeTooltipIndex:R,chartName:t,element:j,isActive:M,layout:T,offset:P,tooltipAxisBandSize:A,tooltipEventType:C})}),Re(w,"renderPolarAxis",function(j,E,S){var O=qn(j,"type.axisType"),k=qn(w.state,"".concat(O,"Map")),N=j.type.defaultProps,P=N!==void 0?ae(ae({},N),j.props):j.props,R=k&&k[P["".concat(O,"Id")]];return g.cloneElement(j,ae(ae({},R),{},{className:ut(O,R.className),key:j.key||"".concat(E,"-").concat(S),ticks:$o(R,!0)}))}),Re(w,"renderPolarGrid",function(j){var E=j.props,S=E.radialLines,O=E.polarAngles,k=E.polarRadius,N=w.state,P=N.radiusAxisMap,R=N.angleAxisMap,A=ca(P),C=ca(R),M=C.cx,T=C.cy,D=C.innerRadius,I=C.outerRadius;return g.cloneElement(j,{polarAngles:Array.isArray(O)?O:$o(C,!0).map(function(L){return L.coordinate}),polarRadius:Array.isArray(k)?k:$o(A,!0).map(function(L){return L.coordinate}),cx:M,cy:T,innerRadius:D,outerRadius:I,key:j.key||"polar-grid",radialLines:S})}),Re(w,"renderLegend",function(){var j=w.state.formattedGraphicalItems,E=w.props,S=E.children,O=E.width,k=E.height,N=w.props.margin||{},P=O-(N.left||0)-(N.right||0),R=YB({children:S,formattedGraphicalItems:j,legendWidth:P,legendContent:c});if(!R)return null;var A=R.item,C=L8(R,Vbe);return g.cloneElement(A,ae(ae({},C),{},{chartWidth:O,chartHeight:k,margin:N,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),Re(w,"renderTooltip",function(){var j,E=w.props,S=E.children,O=E.accessibilityLayer,k=Bn(S,Wr);if(!k)return null;var N=w.state,P=N.isTooltipActive,R=N.activeCoordinate,A=N.activePayload,C=N.activeLabel,M=N.offset,T=(j=k.props.active)!==null&&j!==void 0?j:P;return g.cloneElement(k,{viewBox:ae(ae({},M),{},{x:M.left,y:M.top}),active:T,label:C,payload:T?A:[],coordinate:R,accessibilityLayer:O})}),Re(w,"renderBrush",function(j){var E=w.props,S=E.margin,O=E.data,k=w.state,N=k.offset,P=k.dataStartIndex,R=k.dataEndIndex,A=k.updateId;return g.cloneElement(j,{key:j.key||"_recharts-brush",onChange:ah(w.handleBrushChange,j.props.onChange),data:O,x:me(j.props.x)?j.props.x:N.left,y:me(j.props.y)?j.props.y:N.top+N.height+N.brushBottom-(S.bottom||0),width:me(j.props.width)?j.props.width:N.width,startIndex:P,endIndex:R,updateId:"brush-".concat(A)})}),Re(w,"renderReferenceElement",function(j,E,S){if(!j)return null;var O=w,k=O.clipPathId,N=w.state,P=N.xAxisMap,R=N.yAxisMap,A=N.offset,C=j.type.defaultProps||{},M=j.props,T=M.xAxisId,D=T===void 0?C.xAxisId:T,I=M.yAxisId,L=I===void 0?C.yAxisId:I;return g.cloneElement(j,{key:j.key||"".concat(E,"-").concat(S),xAxis:P[D],yAxis:R[L],viewBox:{x:A.left,y:A.top,width:A.width,height:A.height},clipPathId:k})}),Re(w,"renderActivePoints",function(j){var E=j.item,S=j.activePoint,O=j.basePoint,k=j.childIndex,N=j.isRange,P=[],R=E.props.key,A=E.item.type.defaultProps!==void 0?ae(ae({},E.item.type.defaultProps),E.item.props):E.item.props,C=A.activeDot,M=A.dataKey,T=ae(ae({index:k,dataKey:M,cx:S.x,cy:S.y,r:4,fill:J_(E.item),strokeWidth:2,stroke:"#fff",payload:S.payload,value:S.value},ot(C,!1)),hp(C));return P.push(v.renderActiveDot(C,T,"".concat(R,"-activePoint-").concat(k))),O?P.push(v.renderActiveDot(C,ae(ae({},T),{},{cx:O.x,cy:O.y}),"".concat(R,"-basePoint-").concat(k))):N&&P.push(null),P}),Re(w,"renderGraphicChild",function(j,E,S){var O=w.filterFormatItem(j,E,S);if(!O)return null;var k=w.getTooltipEventType(),N=w.state,P=N.isTooltipActive,R=N.tooltipAxis,A=N.activeTooltipIndex,C=N.activeLabel,M=w.props.children,T=Bn(M,Wr),D=O.props,I=D.points,L=D.isRange,B=D.baseLine,U=O.item.type.defaultProps!==void 0?ae(ae({},O.item.type.defaultProps),O.item.props):O.item.props,F=U.activeDot,H=U.hide,J=U.activeBar,q=U.activeShape,re=!!(!H&&P&&T&&(F||J||q)),Z={};k!=="axis"&&T&&T.props.trigger==="click"?Z={onClick:ah(w.handleItemMouseEnter,j.props.onClick)}:k!=="axis"&&(Z={onMouseLeave:ah(w.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:ah(w.handleItemMouseEnter,j.props.onMouseEnter)});var Y=g.cloneElement(j,ae(ae({},O.props),Z));function W(He){return typeof R.dataKey=="function"?R.dataKey(He.payload):null}if(re)if(A>=0){var G,te;if(R.dataKey&&!R.allowDuplicatedCategory){var $=typeof R.dataKey=="function"?W:"payload.".concat(R.dataKey.toString());G=Iw(I,$,C),te=L&&B&&Iw(B,$,C)}else G=I==null?void 0:I[A],te=L&&B&&B[A];if(q||J){var se=j.props.activeIndex!==void 0?j.props.activeIndex:A;return[g.cloneElement(j,ae(ae(ae({},O.props),Z),{},{activeIndex:se})),null,null]}if(!it(G))return[Y].concat(Xs(w.renderActivePoints({item:O,activePoint:G,basePoint:te,childIndex:A,isRange:L})))}else{var ue,ve=(ue=w.getItemByXY(w.state.activeCoordinate))!==null&&ue!==void 0?ue:{graphicalItem:Y},Te=ve.graphicalItem,qe=Te.item,Ye=qe===void 0?j:qe,ze=Te.childIndex,ct=ae(ae(ae({},O.props),Z),{},{activeIndex:ze});return[g.cloneElement(Ye,ct),null,null]}return L?[Y,null,null]:[Y,null]}),Re(w,"renderCustomized",function(j,E,S){return g.cloneElement(j,ae(ae({key:"recharts-customized-".concat(S)},w.props),w.state))}),Re(w,"renderMap",{CartesianGrid:{handler:$h,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:$h},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:$h},YAxis:{handler:$h},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((x=b.id)!==null&&x!==void 0?x:pp("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=Zh(w.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),w.state={},w}return exe(v,m),Qbe(v,[{key:"componentDidMount",value:function(){var b,x;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,x=b.children,_=b.data,w=b.height,j=b.layout,E=Bn(x,Wr);if(E){var S=E.props.defaultIndex;if(!(typeof S!="number"||S<0||S>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[S]&&this.state.tooltipTicks[S].value,k=pE(this.state,_,S,O),N=this.state.tooltipTicks[S].coordinate,P=(this.state.offset.top+w)/2,R=j==="horizontal",A=R?{x:N,y:P}:{y:N,x:P},C=this.state.formattedGraphicalItems.find(function(T){var D=T.item;return D.type.name==="Scatter"});C&&(A=ae(ae({},A),C.props.points[S].tooltipPosition),k=C.props.points[S].tooltipPayload);var M={activeTooltipIndex:S,isTooltipActive:!0,activeLabel:O,activePayload:k,activeCoordinate:A};this.setState(M),this.renderCursor(E),this.accessibilityManager.setIndex(S)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,x){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==x.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,w;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0}})}return null}},{key:"componentDidUpdate",value:function(b){zw([Bn(b.children,Wr)],[Bn(this.props.children,Wr)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Bn(this.props.children,Wr);if(b&&typeof b.props.shared=="boolean"){var x=b.props.shared?"axis":"item";return i.indexOf(x)>=0?x:o}return o}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var x=this.container,_=x.getBoundingClientRect(),w=pue(_),j={chartX:Math.round(b.pageX-w.left),chartY:Math.round(b.pageY-w.top)},E=_.width/x.offsetWidth||1,S=this.inRange(j.chartX,j.chartY,E);if(!S)return null;var O=this.state,k=O.xAxisMap,N=O.yAxisMap,P=this.getTooltipEventType();if(P!=="axis"&&k&&N){var R=ca(k).scale,A=ca(N).scale,C=R&&R.invert?R.invert(j.chartX):null,M=A&&A.invert?A.invert(j.chartY):null;return ae(ae({},j),{},{xValue:C,yValue:M})}var T=H8(this.state,this.props.data,this.props.layout,S);return T?ae(ae({},j),T):null}},{key:"inRange",value:function(b,x){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,w=this.props.layout,j=b/_,E=x/_;if(w==="horizontal"||w==="vertical"){var S=this.state.offset,O=j>=S.left&&j<=S.left+S.width&&E>=S.top&&E<=S.top+S.height;return O?{x:j,y:E}:null}var k=this.state,N=k.angleAxisMap,P=k.radiusAxisMap;if(N&&P){var R=ca(N);return l6({x:j,y:E},R)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,x=this.getTooltipEventType(),_=Bn(b,Wr),w={};_&&x==="axis"&&(_.props.trigger==="click"?w={onClick:this.handleClick}:w={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var j=hp(this.props,this.handleOuterEvent);return ae(ae({},j),w)}},{key:"addListener",value:function(){cE.on(lE,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){cE.removeListener(lE,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,x,_){for(var w=this.state.formattedGraphicalItems,j=0,E=w.length;j<E;j++){var S=w[j];if(S.item===b||S.props.key===b.key||x===ko(S.item.type)&&_===S.childIndex)return S}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,x=this.state.offset,_=x.left,w=x.top,j=x.height,E=x.width;return V.createElement("defs",null,V.createElement("clipPath",{id:b},V.createElement("rect",{x:_,y:w,height:j,width:E})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(x,_){var w=D8(_,2),j=w[0],E=w[1];return ae(ae({},x),{},Re({},j,E.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(x,_){var w=D8(_,2),j=w[0],E=w[1];return ae(ae({},x),{},Re({},j,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var x;return(x=this.state.xAxisMap)===null||x===void 0||(x=x[b])===null||x===void 0?void 0:x.scale}},{key:"getYScaleByAxisId",value:function(b){var x;return(x=this.state.yAxisMap)===null||x===void 0||(x=x[b])===null||x===void 0?void 0:x.scale}},{key:"getItemByXY",value:function(b){var x=this.state,_=x.formattedGraphicalItems,w=x.activeItem;if(_&&_.length)for(var j=0,E=_.length;j<E;j++){var S=_[j],O=S.props,k=S.item,N=k.type.defaultProps!==void 0?ae(ae({},k.type.defaultProps),k.props):k.props,P=ko(k.type);if(P==="Bar"){var R=(O.data||[]).find(function(T){return Yye(b,T)});if(R)return{graphicalItem:S,payload:R}}else if(P==="RadialBar"){var A=(O.data||[]).find(function(T){return l6(b,T)});if(A)return{graphicalItem:S,payload:A}}else if(vh(S,w)||bh(S,w)||Su(S,w)){var C=Ige({graphicalItem:S,activeTooltipItem:w,itemData:N.data}),M=N.activeIndex===void 0?C:N.activeIndex;return{graphicalItem:ae(ae({},S),{},{childIndex:M}),payload:Su(S,w)?N.data[C]:S.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!u4(this))return null;var x=this.props,_=x.children,w=x.className,j=x.width,E=x.height,S=x.style,O=x.compact,k=x.title,N=x.desc,P=L8(x,Ube),R=ot(P,!1);if(O)return V.createElement(G$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},V.createElement(Uw,Ks({},R,{width:j,height:E,title:k,desc:N}),this.renderClipPath(),f4(_,this.renderMap)));if(this.props.accessibilityLayer){var A,C;R.tabIndex=(A=this.props.tabIndex)!==null&&A!==void 0?A:0,R.role=(C=this.props.role)!==null&&C!==void 0?C:"application",R.onKeyDown=function(T){b.accessibilityManager.keyboardEvent(T)},R.onFocus=function(){b.accessibilityManager.focus()}}var M=this.parseEventsOfWrapper();return V.createElement(G$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},V.createElement("div",Ks({className:ut("recharts-wrapper",w),style:ae({position:"relative",cursor:"default",width:j,height:E},S)},M,{ref:function(T){b.container=T}}),V.createElement(Uw,Ks({},R,{width:j,height:E,title:k,desc:N,style:ixe}),this.renderClipPath(),f4(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Re(h,"displayName",t),Re(h,"defaultProps",ae({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Re(h,"getDerivedStateFromProps",function(m,v){var b=m.dataKey,x=m.data,_=m.children,w=m.width,j=m.height,E=m.layout,S=m.stackOffset,O=m.margin,k=v.dataStartIndex,N=v.dataEndIndex;if(v.updateId===void 0){var P=W8(m);return ae(ae(ae({},P),{},{updateId:0},f(ae(ae({props:m},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:x,prevWidth:w,prevHeight:j,prevLayout:E,prevStackOffset:S,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||x!==v.prevData||w!==v.prevWidth||j!==v.prevHeight||E!==v.prevLayout||S!==v.prevStackOffset||!ys(O,v.prevMargin)){var R=W8(m),A={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=ae(ae({},H8(v,x,E)),{},{updateId:v.updateId+1}),M=ae(ae(ae({},R),A),C);return ae(ae(ae({},M),f(ae({props:m},M),v)),{},{prevDataKey:b,prevData:x,prevWidth:w,prevHeight:j,prevLayout:E,prevStackOffset:S,prevMargin:O,prevChildren:_})}if(!zw(_,v.prevChildren)){var T,D,I,L,B=Bn(_,Ds),U=B&&(T=(D=B.props)===null||D===void 0?void 0:D.startIndex)!==null&&T!==void 0?T:k,F=B&&(I=(L=B.props)===null||L===void 0?void 0:L.endIndex)!==null&&I!==void 0?I:N,H=U!==k||F!==N,J=!it(x),q=J&&!H?v.updateId:v.updateId+1;return ae(ae({updateId:q},f(ae(ae({props:m},v),{},{updateId:q,dataStartIndex:U,dataEndIndex:F}),v)),{},{prevChildren:_,dataStartIndex:U,dataEndIndex:F})}return null}),Re(h,"renderActiveDot",function(m,v,b){var x;return g.isValidElement(m)?x=g.cloneElement(m,v):We(m)?x=m(v):x=V.createElement(o$,v),V.createElement(Wt,{className:"recharts-active-dot",key:b},x)});var y=g.forwardRef(function(m,v){return V.createElement(h,Ks({},m,{ref:v}))});return y.displayName=h.displayName,y},gxe=yxe({chartName:"BarChart",GraphicalChild:ai,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Dh},{axisType:"yAxis",AxisComp:aE}],formatAxisMap:kve});const vxe={light:"",dark:".dark"},Y8=g.createContext(null);function K8(){const e=g.useContext(Y8);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const X8=g.forwardRef(({id:e,className:t,children:n,config:r,...o},a)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return p.jsx(Y8.Provider,{value:{config:r},children:p.jsxs("div",{"data-chart":s,ref:a,className:K("flex aspect-video justify-center text-xs",t),...o,children:[p.jsx(bxe,{id:s,config:r}),p.jsx(iue,{children:n})]})})});X8.displayName="Chart";const bxe=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,o])=>o.theme||o.color);return n.length?p.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(vxe).map(([r,o])=>`
${o} [data-chart=${e}] {
${n.map(([a,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${a}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},xxe=Wr,Q8=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:o=!1,hideIndicator:a=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:f},h)=>{const{config:y}=K8(),m=g.useMemo(()=>{var j;if(o||!(t!=null&&t.length))return null;const[b]=t,x=`${f||b.dataKey||b.name||"value"}`,_=hE(y,b,x),w=!f&&typeof i=="string"?((j=y[i])==null?void 0:j.label)||i:_==null?void 0:_.label;return s?p.jsx("div",{className:K("font-medium",c),children:s(w,t)}):w?p.jsx("div",{className:K("font-medium",c),children:w}):null},[i,s,t,o,c,y,f]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return p.jsxs("div",{ref:h,className:K("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:m,p.jsx("div",{className:"grid gap-1.5",children:t.map((b,x)=>{const _=`${d||b.name||b.dataKey||"value"}`,w=hE(y,b,_),j=u||b.payload.fill||b.color;return p.jsx("div",{className:K("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,x,b.payload):p.jsxs(p.Fragment,{children:[w!=null&&w.icon?p.jsx(w.icon,{}):!a&&p.jsx("div",{className:K("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),p.jsxs("div",{className:K("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[p.jsxs("div",{className:"grid gap-1.5",children:[v?m:null,p.jsx("span",{className:"text-muted-foreground",children:(w==null?void 0:w.label)||b.name})]}),b.value&&p.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});Q8.displayName="ChartTooltip";const wxe=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:o},a)=>{const{config:i}=K8();return n!=null&&n.length?p.jsx("div",{ref:a,className:K("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${o||s.dataKey||"value"}`,l=hE(i,s,c);return p.jsxs("div",{className:K("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?p.jsx(l.icon,{}):p.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});wxe.displayName="ChartLegend";function hE(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let o=n;return n in t&&typeof t[n]=="string"?o=t[n]:r&&n in r&&typeof r[n]=="string"&&(o=r[n]),o in e?e[o]:e[n]}const J8=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},_xe=g.memo(()=>{const{t:e}=Me("flows"),[t,n]=g.useState(),r=sn(y=>y.cachedLLMURLs),o=Je(y=>y.currentSession),[a,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{Nt(async()=>{const{functionCallingModelIds:y,prebuiltAppConfig:m}=await import("./index-BG3xyZmB.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:y,prebuiltAppConfig:m}},__vite__mapDeps([7,1,2,3,4,5,6])).then(({functionCallingModelIds:y,prebuiltAppConfig:m})=>{n(r==null?void 0:r.map(v=>{const b=m.model_list.find(x=>v.includes(x.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:y.includes((b==null?void 0:b.model_id)||"")}}))})},[r,o==null?void 0:o.id]);const f=g.useCallback(async()=>{navigator.storage.estimate().then(y=>{y&&c(e("session_info_node.used_bytes",{used:J8(y.usage),total:J8(y==null?void 0:y.quota)}))}),o!=null&&o.id&&(Promise.all([ce("FlowNode").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("FlowEdge").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("Thread").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("Prompt").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("LLM").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("Schema").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("ToolDefinition").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("VectorDatabase").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("JSONLData").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}}),ce("CSVData").findOne({where:{session_id:o==null?void 0:o.id},order:{updated_at:"DESC"}})]).then(y=>{const m=y.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,o.updated_at?new Date(o.updated_at):void 0);i(m)}),Promise.all([ce("FlowNode").count({where:{session_id:o==null?void 0:o.id}}),ce("FlowEdge").count({where:{session_id:o==null?void 0:o.id}}),ce("Thread").count({where:{session_id:o==null?void 0:o.id}}),ce("Prompt").count({where:{session_id:o==null?void 0:o.id}}),ce("LLM").count({where:{session_id:o==null?void 0:o.id}}),ce("ToolDefinition").count({where:{session_id:o==null?void 0:o.id}}),ce("Schema").count({where:{session_id:o==null?void 0:o.id}}),ce("VectorDatabase").count({where:{session_id:o==null?void 0:o.id}}),ce("JSONLData").count({where:{session_id:o==null?void 0:o.id}}),ce("CSVData").count({where:{session_id:o==null?void 0:o.id}})]).then(([y,m,v,b,x,_,w,j,E,S])=>{u([{name:e("session_info_node.count_info.title"),nodes:y||0,edges:m||0,threads:v||0,prompts:b||0,llms:x||0,tools:_||0,schemas:w||0,vectorDatabases:j||0,jsonlDatas:E||0,csvDatas:S||0}])}))},[o==null?void 0:o.id,o==null?void 0:o.updated_at,e]),h=g.useCallback(()=>{f()},[f]);return g.useEffect(()=>{f()},[f]),p.jsxs(Tt,{className:"w-96",children:[p.jsxs(hn,{children:[p.jsx(En,{children:e("session_info_node.title")}),p.jsx(TI,{children:a||o!=null&&o.updated_at?Ywe(a||(o==null?void 0:o.updated_at)).fromNow():""})]}),p.jsxs(mn,{className:"grid gap-4",children:[p.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:p.jsxs("div",{className:"flex-1 space-y-1",children:[p.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),p.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),p.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:p.jsxs("div",{className:"flex-1 space-y-1",children:[p.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),p.jsx(tn,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(y=>p.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[y==null?void 0:y.model_id,p.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:p.jsx(Nl,{model:y==null?void 0:y.info,isFunctionCalling:(y==null?void 0:y.isFunctionCalling)||!1,isCached:!0})})]},y==null?void 0:y.model_id))]})}),p.jsx("div",{children:p.jsx(X8,{config:d,className:"min-h-28 w-full",children:p.jsxs(gxe,{accessibilityLayer:!0,data:l,children:[p.jsx(j8,{vertical:!1}),p.jsx(Dh,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),p.jsx(xxe,{content:p.jsx(Q8,{})}),Object.entries(d).map(([y,m])=>p.jsx(ai,{dataKey:y,fill:m.color,radius:4},y))]})})})]}),p.jsx(ra,{children:p.jsxs(at,{className:"w-full",onClick:h,children:[p.jsx(le,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),jxe=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);cn(e,t)},Exe=g.memo(e=>{var c,l;const{t}=Me("flows"),{id:n,data:r,isConnectable:o}=e,a=g.useRef(!1),i=ln(n),s=Ae(u=>u.updateNodes);return jxe(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||a.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(a.current=!0,ce("SchemaItem").find({where:{schema_id:u.id}}).then(f=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:f}}}}])}).finally(()=>{a.current=!1}))},[r.entity,r.loaded,i,s]),p.jsxs("div",{children:[p.jsxs("div",{children:[p.jsx(nn,{id:n}),p.jsxs(Ix,{defaultValue:"account",className:"w-[400px]",children:[p.jsxs(Xf,{className:"grid w-full grid-cols-2",children:[p.jsx(gr,{value:"account",children:t("schema_node.typescript")}),p.jsx(gr,{value:"password",children:t("schema_node.zod")})]}),p.jsx(vr,{value:"account",children:p.jsx(Tt,{className:"p-4",children:p.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:wre(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),p.jsx(vr,{value:"password",children:p.jsx(Tt,{className:"p-4 max-w-full",children:p.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:AI(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:o})]})}),Sxe=g.memo(e=>{var a,i;const{id:t,data:n,isConnectable:r}=e,o=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=Xh(n.entity.csv);return{headers:NE(n.entity.headers),rows:s.map(c=>NE(c))}},[n==null?void 0:n.entity]);return p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs("div",{children:[p.jsx(nn,{id:t}),p.jsxs(Tt,{className:"min-w-32 min-h-16 p-4",children:[p.jsx(hn,{className:"!p-0",children:p.jsxs("div",{className:"pt-2 flex !flex-row",children:[p.jsx(le,{name:"file-spreadsheet",className:"mr-2"}),p.jsxs(Qe,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.CSVData," ",(a=o==null?void 0:o.rows)!=null&&a.length?`(${((i=o==null?void 0:o.rows)==null?void 0:i.length)||0})`:""]})]})}),p.jsx(mn,{className:"pb-0",children:p.jsx(sp,{data:o.rows,headers:o.headers})})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Cxe=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if((o==null?void 0:o.type)===oe.Schema&&(a==null?void 0:a.type)===oe.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},Oxe=g.memo(({id:e,data:t,isConnectable:n})=>{var r,o;return Cxe(e),p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:n}),p.jsx("div",{children:p.jsxs(No,{className:"flex justify-center",children:[p.jsx(le,{size:24,name:"wrench"}),p.jsxs("div",{className:"ml-2",children:[p.jsx(Mo,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),p.jsx(ps,{children:`${((o=t.entity)==null?void 0:o.description)||""}`})]})]})}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:n})]})}),Nxe=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);cn(e,t)},Mxe=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return Nxe(t),p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsx("div",{children:p.jsxs(No,{className:"flex justify-center max-w-80",variant:"default",children:[p.jsx(jo,{name:n.model||"brain",className:"w-7 h-7"}),p.jsx("div",{className:"ml-2 pr-4 flex items-center",children:p.jsx(Mo,{children:`${n.model||""}`})})]})}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),kxe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,Pxe=ba(e=>{const{source:t,documents:n}=e,r=Kt(),{toast:o}=Bt(),{t:a}=Me("dialogs"),{loading:i,createPrompt:s}=M5(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){o({title:a("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{o({title:a("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return p.jsx(Ri,{open:r.visible,onOpenChange:r.hide,children:p.jsxs(Ma,{className:"sm:max-w-[425px]",children:[p.jsx(ka,{children:p.jsxs("div",{className:"flex",children:[p.jsx(le,{name:"file",className:"mr-2 h-4 w-4"}),p.jsx(Pa,{children:a("create_vector_database_prompt.title")})]})}),p.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[p.jsx(Sw,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:kxe}),p.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[p.jsx(le,{name:"info",className:"mr-2",size:14}),a("create_vector_database_prompt.fill_content_note")]})]})]})})}),Axe=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ae(i=>i.createOrUpdateFlowNode),o=Ae(i=>i.createOrUpdateFlowEdge),a=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,f;try{const h=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!h||!e)throw new Error("Source or Session not found");n(!0);const y=((u=s.position)==null?void 0:u.x)||0,m=(((d=s.position)==null?void 0:d.y)||0)+(((f=s.measured)==null?void 0:f.height)||0),v=await ce("Prompt").save({...i,status:(i==null?void 0:i.status)||eo.Started,role:(i==null?void 0:i.role)||kn.System,type:(i==null?void 0:i.type)||Pn.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:oe.Prompt,x:y,y:m+20});if(!b)throw new Error("Failed to save prompt node");const x=await ce("FlowNodePlaceholder").save({placeholder:`Retriever for ${h.name}`,placeholder_type:bi.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!x)throw new Error("Failed to save node placeholder");const _=await r({source_id:x.id,source_type:"FlowNodePlaceholder",node_type:oe.PlaceHolder,x:y,y:m+40});if(!_)throw new Error("Failed to save node placeholder node");await o({source:b.id,target:_.id}),await o({source:s.id,target:_.id})}finally{n(!1)}},[e,r,o]);return{loading:t,createVectorDatabaseRetriever:a}},Txe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,Rxe=ba(e=>{const{source:t}=e,n=Kt(),{toast:r}=Bt(),{t:o}=Me("dialogs"),[a,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=Axe(),d=async y=>{try{const m=y.content;if(!m||!m.includes("{context}")){r({title:o("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:m},metadata:{k:a,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:o("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},f=y=>{i(y.target.value?Number(y.target.value):void 0)},h=y=>{c(y.target.value?Number(y.target.value):void 0)};return p.jsx(Ri,{open:n.visible,onOpenChange:n.hide,children:p.jsxs(Ma,{className:"sm:max-w-[425px]",children:[p.jsx(ka,{children:p.jsxs("div",{className:"flex",children:[p.jsx(le,{name:"file",className:"mr-2 h-4 w-4"}),p.jsx(Pa,{children:o("create_vector_database_retriever.title")})]})}),p.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[p.jsx(Sw,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:Txe}),p.jsxs(Tt,{children:[p.jsx(hn,{children:p.jsx(En,{children:o("create_vector_database_retriever.retriever_settings")})}),p.jsxs(mn,{children:[p.jsx(Qe,{children:o("create_vector_database_retriever.retriever_k")}),p.jsx(dn,{value:a||"",type:"number",onChange:f,placeholder:o("create_vector_database_retriever.retriever_k_placeholder")}),p.jsx(Qe,{children:o("create_vector_database_retriever.retriever_minimum_score")}),p.jsx(dn,{value:s||"",type:"number",onChange:h,placeholder:o("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),p.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[p.jsx(le,{name:"info",className:"mr-2",size:14}),o("create_vector_database_retriever.fill_content_note")]})]})]})})}),Ixe=e=>{const t=Ae(o=>o.createOrUpdateFlowEdge),n=fi(o=>o.index),r=g.useCallback(async({edgeId:o,target:a,source:i})=>{var s,c;try{const l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===oe.CSVData&&(a==null?void 0:a.type)===oe.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:o};const{rows:d}=W9(u.headers,u.csv),f=d.map(h=>new Hu({pageContent:`${h.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},f),await t({source:i.id,target:a.id});return}return{deleteEdgeId:o}}catch{return{deleteEdgeId:o}}},[t,n]);cn(e,r)},Dxe=e=>{const[t,n]=g.useState(!1),{t:r}=Me("flows"),{toast:o}=Bt(),{getNode:a,getHandleConnections:i}=Fn(),s=Ae(f=>f.updateNodes),c=fi(f=>f.index),l=fi(f=>f.similaritySearchWithScore),u=g.useCallback(async(f,h)=>{var y,m,v;try{const b=a(e);if(!b)return;const x=(y=b.data)==null?void 0:y.entity;if(!x){o({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===tr.DataNode){const _=(v=(m=i({nodeId:e,type:"target"}).map(w=>a(w.source)).find(w=>(w==null?void 0:w.type)&&[oe.JSONLData,oe.CSVData].includes(w==null?void 0:w.type)))==null?void 0:m.data)==null?void 0:v.entity;if(!_){o({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:x.id,dataSourceId:_.id,dataSourceType:OE(_)},f,h==null?void 0:h.k)}else return n(!0),await l({databaseId:x.id},f,h==null?void 0:h.k)}catch{o({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,o,r,a]),d=g.useCallback(async(f,h)=>{var y,m,v,b;try{const x=a(e);if(!x)return;n(!0);const _=f.content?[new Hu({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(_!=null&&_.length)){o({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const w=(y=x.data)==null?void 0:y.entity;if(!w||!x){o({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===tr.DataNode){const j=i({nodeId:e,type:"target"}).map(N=>a(N.source)).find(N=>(N==null?void 0:N.type)&&[oe.JSONLData,oe.CSVData].includes(N==null?void 0:N.type)),E=(m=j==null?void 0:j.data)==null?void 0:m.entity;if(!E){o({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const S=OE(E),O=aw(_,10);let k=0;for(const N of O){if((v=h==null?void 0:h.onProgressReport)==null||v.call(h,{handling:N.length,handled:k,total:_.length}),await c({databaseId:w.id,dataSourceId:E.id,dataSourceType:S},N),S&&j){const P=await ce(S).findOne({where:{id:E.id}});s([{type:"replace",id:j.id,item:{...j,data:{...j.data,entity:P}}}])}k+=N.length}}else{const j=aw(_,10);let E=0;for(const S of j){(b=h==null?void 0:h.onProgressReport)==null||b.call(h,{handling:S.length,handled:E,total:_.length}),await c({databaseId:w.id},S);const O=await ce("VectorDatabase").findOne({where:{id:`${w.id}`}});s([{type:"replace",id:x.id,item:{...x,data:{...x.data,entity:O}}}]),E+=S.length}}}catch{o({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,o,r,a,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},Lxe=g.memo(e=>{var E,S,O,k;const{t}=Me("flows"),[n,r]=g.useState(0),[o,a]=g.useState("search"),i=ln(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:f}=Dxe(s),h=Kt(Pxe),y=Kt(Rxe);Ixe(s);const m=g.useCallback(async(...N)=>{i&&await f(...N)},[f,i]),v=g.useCallback(async(N,P)=>{const R=N.trim(),A=await d(R,{k:P});if(A!=null&&A.length)return A},[d]),b=g.useCallback(N=>{h.show({source:i,documents:N.map(([P])=>P)})},[h,i]),x=g.useCallback(async()=>{y.show({source:i})},[y,i]),_=g.useCallback(async N=>{if(N.type.includes("text")||N.type.includes("txt")){const P=new FileReader;P.onload=async R=>{var C;const A=(C=R.target)==null?void 0:C.result;await m({content:A})},P.readAsText(N)}else if(N.type.endsWith("pdf")){const P=new Blob([N],{type:"application/pdf"}),R=await new RI(P,{pdfjs:async()=>{const A=await Nt(()=>import("./pdf.min-Dzflniks.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([9,1,2,3,4,5,6]));return await Nt(()=>import("./pdf.worker.min-B2T89Jua.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([10,1,2,3,4,5,6])),A.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),A},parsedItemSeparator:" "}).load();await m({documents:R},{onProgressReport:A=>{r((A.handled+A.handling)/A.total)}})}},[m]),w=g.useMemo(()=>{var R,A;if(!((R=c==null?void 0:c.entity)!=null&&R.raw))return{headers:[],rows:[]};const N=["content","embedding","metadata"],P=Xh((A=c==null?void 0:c.entity)==null?void 0:A.raw);return{headers:N,rows:P.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(E=c==null?void 0:c.entity)==null?void 0:E.raw]),j=g.useMemo(()=>{switch(o){case"search":return p.jsx(vr,{value:"search",children:p.jsx(WD,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:x})});case"new":return p.jsx(vr,{className:"min-w-80",value:"new",children:p.jsx(qD,{loading:u,onCreateData:m})});case"file":return p.jsx(vr,{value:"file",children:p.jsx(YD,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return p.jsx(vr,{value:"view",children:p.jsx(sp,{data:w.rows,headers:w.headers,limitLengthByColumns:{embedding:32}})})}},[m,b,x,_,v,u,o,n,w]);return p.jsxs("div",{className:"min-w-72",children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:l}),p.jsxs("div",{className:"max-w-full",children:[p.jsx(nn,{id:s}),p.jsxs(No,{className:"flex justify-center",variant:"default",children:[p.jsx(le,{size:24,name:"database-zap"}),p.jsxs("div",{className:"ml-2 max-w-full",children:[p.jsx(Mo,{children:`${((S=c.entity)==null?void 0:S.name)||""}`}),p.jsxs(Ix,{value:o,onValueChange:a,defaultValue:"search",className:K("w-full mt-4"),children:[p.jsxs(Xf,{className:K("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===tr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[p.jsx(gr,{value:"search",children:t("vector_database_node.search")}),p.jsx(gr,{value:"new",children:t("vector_database_node.text")}),p.jsx(gr,{value:"file",children:t("vector_database_node.file")}),((k=c.entity)==null?void 0:k.storage)===tr.DatabaseNode?p.jsx(gr,{value:"view",children:t("vector_database_node.view")}):void 0]}),j]})]})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:l})]})}),Fxe={embedding:32},Bxe=g.memo(e=>{var a,i,s;const{id:t,data:n,isConnectable:r}=e,o=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=NE(n.entity.headers||""),l=Xh(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(a=n==null?void 0:n.entity)==null?void 0:a.jsonl,n.entity.headers]);return p.jsxs("div",{className:"min-w-80",children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs("div",{children:[p.jsx(nn,{id:t}),p.jsxs(Tt,{className:"min-w-32 min-h-16 p-4",children:[p.jsx(hn,{className:"!p-0",children:p.jsxs("div",{className:"pt-2 flex !flex-row",children:[p.jsx(le,{name:"file-json",className:"mr-2"}),p.jsxs(Qe,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.JSONLData," ",(i=o==null?void 0:o.rows)!=null&&i.length?`(${((s=o==null?void 0:o.rows)==null?void 0:s.length)||0})`:""]})]})}),p.jsx(mn,{className:"pb-0",children:p.jsx(sp,{data:o.rows,headers:o.headers,limitLengthByColumns:Fxe})})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),G8=60,Z8=140,$xe=Jr("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),e9=V.forwardRef(({className:e,children:t,magnification:n=G8,distance:r=Z8,direction:o="bottom",...a},i)=>{const s=Gm(1/0),c=()=>V.Children.map(t,l=>V.isValidElement(l)&&l.type===Tu?V.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return p.jsx(Bu.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...a,className:K($xe({className:e}),{"items-start":o==="top","items-center":o==="middle","items-end":o==="bottom"}),children:c()})});e9.displayName="Dock";const Tu=({magnification:e=G8,distance:t=Z8,mouseX:n,className:r,children:o,...a})=>{const i=g.useRef(null),s=OS(n||new Kwe,u=>{var f;const d=((f=i.current)==null?void 0:f.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=OS(s,[-t,0,t],[40,e,40]),l=fz(c,{mass:.1,stiffness:150,damping:12});return p.jsx(Bu.div,{ref:i,style:{width:l},className:K("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...a,children:o})};Tu.displayName="DockIcon";let t9,n9,Vh,r9,Ru,o9,a9,i9,s9,c9,l9,u9,d9,f9,p9,h9,m9,y9,g9,v9,b9,x9,w9,_9,j9,E9;t9={[oe.Shape]:{width:100,height:100},[oe.CircleShape]:{width:100,height:100},[oe.TriangleShape]:{width:100,height:100},[oe.EditorApp]:{width:1240,height:400}},n9=e=>{const t=ln(e),n=Je(s=>s.currentSession),[r,o]=g.useState(!1),a=Ae(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(o(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,f=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),h=await ce("FlowNodeData").save({data:{},session_id:n.id});if(!h)throw new Error("Failed to save node data");if(!await a({node_type:s,data:{},source_id:h.id,source_type:"FlowNodeData",x:d,y:f+20,...t9[s]||{}}))throw new Error("Failed to save node")}}finally{o(!1)}},[a,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},Vh={applications:[{key:oe.EditorApp,icon:"notebook-text",label:"application_bar.note"},{key:oe.VSLiteApp,icon:"square-terminal",label:"application_bar.vslite"}],shapes:[{key:oe.Shape,icon:"square",label:"application_bar.square"},{key:oe.CircleShape,icon:"circle",label:"application_bar.circle"},{key:oe.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:oe.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},r9=g.memo(e=>{const{t}=Me("flows"),{toast:n}=Bt(),{loading:r,createNode:o}=n9(e.id),a=async i=>{try{if(r)return;await o(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return p.jsx(Ac,{children:p.jsxs(e9,{direction:"middle",children:[Vh.applications.map(i=>p.jsx(Tu,{children:p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(le,{onClick:()=>a(i.key),name:i.icon})}),p.jsx(ur,{children:p.jsx("p",{children:t(i.label)})})]})},i.label)),p.jsx(jc,{orientation:"vertical",className:"h-full"}),Vh.shapes.map(i=>p.jsx(Tu,{children:p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(le,{onClick:()=>a(i.key),name:i.icon})}),p.jsx(ur,{children:p.jsx("p",{children:t(i.label)})})]})},i.label)),p.jsx(jc,{orientation:"vertical",className:"h-full"}),Vh.old.map(i=>p.jsx(Tu,{children:p.jsxs(Rr,{children:[p.jsx(Ir,{children:p.jsx(le,{onClick:()=>a(i.key),name:i.icon})}),p.jsx(ur,{children:p.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),Ru=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return p.jsx(Zte,{lineClassName:K("!border-1.5",t),handleClassName:K("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),o9=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if([oe.CircleShape,oe.TriangleShape].includes(o==null?void 0:o.type)&&(a==null?void 0:a.type)===oe.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},a9=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return o9(t),p.jsxs(p.Fragment,{children:[p.jsx(Ru,{isVisible:!!n,minWidth:40,minHeight:40}),p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:p.jsx(nn,{id:t})}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:r})]})}),i9=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if([oe.Shape,oe.TriangleShape].includes(o==null?void 0:o.type)&&(a==null?void 0:a.type)===oe.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},s9=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return i9(t),p.jsxs(p.Fragment,{children:[p.jsx(Ru,{isVisible:!!n,minWidth:40,minHeight:40}),p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:p.jsx(nn,{id:t})}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:r})]})}),c9=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if([oe.CircleShape,oe.Shape].includes(o==null?void 0:o.type)&&(a==null?void 0:a.type)===oe.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},l9=g.memo(e=>{const{id:t,selected:n,width:r,height:o,isConnectable:a}=e;return c9(t),p.jsxs(p.Fragment,{children:[p.jsx(Ru,{isVisible:!!n,minWidth:40,minHeight:40}),p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:a}),p.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:o||0}}),p.jsx(nn,{id:t,className:"absolute top-0 right-0"}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:a})]})}),u9=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if((o==null?void 0:o.type)===oe.LLM&&(a==null?void 0:a.type)===oe.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},d9=e=>{const t=ln(e),{t:n}=Me("flows"),r=g.useRef(null),{toast:o}=Bt(),{getNode:a,getHandleConnections:i}=Fn(),s=sn(d=>d.stream),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await ce("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,f)=>{if(t){const h=i({nodeId:e,type:"target"}).find(m=>{var v;return((v=a(m.source))==null?void 0:v.type)===oe.LLM}),y=h?a(h==null?void 0:h.source):void 0;if(y){if(y.data.status!==et.Loaded)return o({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")})}else return o({variant:"destructive",description:n("editor_node.errors.llm_not_found")});try{const m=s(d);if(!m)throw new Error("Stream is not supported");const v=[];for await(const b of m)b&&Array.isArray(b)&&(v.push(...b.map(x=>x.content)),b!=null&&b.length&&(f==null||f(b.map(x=>x.content).join(""))));return v.join("")}catch(m){if(m instanceof Error&&m.message.includes("LLM_NOT_LOADED_YET"))return o({title:n("editor_node.errors.llm_not_loaded_yet")});o({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,a,o,n,s]),u=g.useCallback(d=>{if(!a(d))return[];const f=[];return i({nodeId:d,type:"target"}).forEach(h=>{const y=a(h.source);!y||y.type!==oe.LLM||f.push({node:y,connections:[h]})}),f},[i,a]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},f9=g.lazy(()=>Nt(()=>import("./PlateEditor-JAHzsm90.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([15,1,2,13,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,3,5,6,105]))),p9=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:o}=e;u9(t);const{createMessage:a,updateEditorContent:i,getLinkedConnections:s}=d9(t),c=g.useCallback(u=>{i(u)},[i]);return p.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[p.jsx(Ru,{isVisible:!!r,minWidth:1240,minHeight:400}),p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:o}),p.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[p.jsx(nn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:p.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:p.jsx(f9,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:a})})})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:o})]})}),h9=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);cn(e,t)},m9=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:o}=Me("flows");h9(t);let a="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":a=o("placeholder_node.vector_database_retriever");break}return p.jsxs("div",{children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:r}),p.jsxs(No,{className:"flex justify-center max-w-80",variant:"default",children:[p.jsx(nn,{id:t}),p.jsx(le,{name:"land-plot",className:"w-7 h-7"}),p.jsxs("div",{className:"ml-2 pr-4",children:[p.jsx(Mo,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),p.jsx(ps,{children:a?p.jsx(tn,{children:a}):void 0})]})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),y9=g.lazy(()=>Nt(()=>import("./CodeContainerApp-BNeiHUaV.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([109,1,2,104,107,12,110,4,111,112]))),g9=g.memo(e=>{const{id:t,isConnectable:n}=e;return p.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:n}),p.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[p.jsx(nn,{id:t}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-full flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:p.jsx(y9,{...e})})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:n})]})}),v9=["vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],b9=async e=>{switch(e){case"vite-vue":return Nt(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return Nt(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return Nt(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return Nt(()=>import("./porfolio-nextjs-Y_dlzAA8.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},fS=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Me("components"),[r,o]=g.useState();return p.jsxs(Tt,{className:K("mw-full",e),children:[p.jsx(hn,{className:"p-4",children:p.jsx(En,{children:n("add_source_base.title")})}),p.jsx(mn,{className:"p-4",children:p.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[p.jsxs(Eo,{onValueChange:a=>o(a),children:[p.jsx(Ur,{className:"w-full mb-4",children:p.jsx(So,{placeholder:n("add_source_base.source_base_select_placeholder")})}),p.jsx(Hr,{children:v9.map(a=>p.jsx(Sn,{value:`${a}`,children:n(`add_source_base.sourcebases.${a.toLowerCase()}`)},`${a}`))})]}),p.jsx(at,{className:"w-full",onClick:async()=>r&&t(await b9(r)),children:n("add_source_base.update_source")})]})})]})}),x9=()=>{const{getNode:e,getHandleConnections:t}=Fn(),n=g.useCallback(async(r,o)=>{await ce("FlowNode").update(r,{raw:Bm(o)})},[]);return{getLinkedConnections:g.useCallback(r=>{if(!e(r))return[];const o=[];return t({nodeId:r,type:"target"}).forEach(a=>{const i=e(a.source);!i||i.type!==oe.LLM||o.push({node:i,connections:[a]})}),o},[t,e]),updateCodeContainerData:n}},w9=e=>{const t=Ae(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:o,target:a,connection:i})=>{try{if((o==null?void 0:o.type)===oe.LLM&&(a==null?void 0:a.type)===oe.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);cn(e,n)},_9=g.lazy(()=>Nt(()=>import("./index-Dn1R432j.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([106,1,2,104,107,3,4,5,6,108]))),j9=g.memo(e=>{var u,d,f;const{id:t,isConnectable:n,data:r}=e,[o,a]=g.useState((u=r==null?void 0:r.flowNode)!=null&&u.raw?Um(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s}=x9();w9(t);const c=g.useCallback(async h=>{var y,m;(y=r==null?void 0:r.flowNode)!=null&&y.id&&(await i((m=r==null?void 0:r.flowNode)==null?void 0:m.id,h),a(h))},[(d=r==null?void 0:r.flowNode)==null?void 0:d.id,i]),l=g.useCallback(async(h,y)=>{a(m=>{var b;const v=Hm(m||{},h,y);return i((b=r==null?void 0:r.flowNode)==null?void 0:b.id,v),v})},[(f=r==null?void 0:r.flowNode)==null?void 0:f.id,i]);return o?p.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[p.jsx(Ze,{type:"target",position:fe.Top,isConnectable:n}),p.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[p.jsx(nn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),p.jsx(g.Suspense,{fallback:p.jsx("div",{className:"h-full w-full flex justify-center items-center",children:p.jsx(le,{name:"loader-circle",className:"animate-spin"})}),children:p.jsx(_9,{fileSystemTree:o,onUpdateFileContent:l})})]}),p.jsx(Ze,{type:"source",position:fe.Bottom,isConnectable:n})]}):p.jsx("div",{className:"h-full flex justify-center items-center",children:p.jsx(fS,{className:"w-64",onUpdateSourceBase:c})})}),E9={[oe.LLM]:W5,[oe.Toolbox]:Bie,[oe.Thread]:Q5,[oe.Message]:qie,[oe.Prompt]:Kie,[oe.SessionInfo]:_xe,[oe.Schema]:Exe,[oe.CSVData]:Sxe,[oe.ToolDefinition]:Oxe,[oe.DefaultEmbeddingModel]:Mxe,[oe.VectorDatabase]:Lxe,[oe.JSONLData]:Bxe,[oe.ApplicationBar]:r9,[oe.Shape]:a9,[oe.CircleShape]:s9,[oe.TriangleShape]:l9,[oe.EditorApp]:p9,[oe.PlaceHolder]:m9,[oe.CodeContainerApp]:g9,[oe.VSLiteApp]:j9};function zxe(e,t=[]){let n=[];function r(a,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return p.jsx(m.Provider,{value:v,children:h})}function u(d,f){const h=(f==null?void 0:f[e][c])||s,y=g.useContext(h);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,u]}const o=()=>{const a=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||a;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return o.scopeName=e,[r,Vxe(o,...t)]}function Vxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(o){const a=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(o)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var Uxe="Toggle",mE=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:o,...a}=e,[i=!1,s]=en({prop:n,onChange:o,defaultProp:r});return p.jsx(Oe.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...a,ref:t,onClick:he(e.onClick,()=>{e.disabled||s(!i)})})});mE.displayName=Uxe;let yE,ci,gE,vE,Uh;yE=mE,ci="ToggleGroup",[gE,q9]=zxe(ci,[Zr]),vE=Zr(),Uh=V.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const o=r;return p.jsx(Hxe,{...o,ref:t})}if(n==="multiple"){const o=r;return p.jsx(Wxe,{...o,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${ci}\``)}),Uh.displayName=ci;var[S9,C9]=gE(ci),Hxe=V.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:o=()=>{},...a}=e,[i,s]=en({prop:n,defaultProp:r,onChange:o});return p.jsx(S9,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:V.useCallback(()=>s(""),[s]),children:p.jsx(O9,{...a,ref:t})})}),Wxe=V.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:o=()=>{},...a}=e,[i=[],s]=en({prop:n,defaultProp:r,onChange:o}),c=V.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=V.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return p.jsx(S9,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:p.jsx(O9,{...a,ref:t})})});Uh.displayName=ci;var[qxe,Yxe]=gE(ci),O9=V.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:o=!0,orientation:a,dir:i,loop:s=!0,...c}=e,l=vE(n),u=Uo(i),d={role:"group",dir:u,...c};return p.jsx(qxe,{scope:n,rovingFocus:o,disabled:r,children:o?p.jsx(ac,{asChild:!0,...l,orientation:a,dir:u,loop:s,children:p.jsx(Oe.div,{...d,ref:t})}):p.jsx(Oe.div,{...d,ref:t})})}),Hh="ToggleGroupItem",N9=V.forwardRef((e,t)=>{const n=C9(Hh,e.__scopeToggleGroup),r=Yxe(Hh,e.__scopeToggleGroup),o=vE(e.__scopeToggleGroup),a=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:a,disabled:i},c=V.useRef(null);return r.rovingFocus?p.jsx(ic,{asChild:!0,...o,focusable:!i,active:a,ref:c,children:p.jsx(bE,{...s,ref:t})}):p.jsx(bE,{...s,ref:t})});N9.displayName=Hh;let bE;bE=V.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...o}=e,a=C9(Hh,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=a.type==="single"?i:void 0;return p.jsx(mE,{...s,...o,ref:t,onPressedChange:c=>{c?a.onItemActivate(r):a.onItemDeactivate(r)}})}),nm=Uh,rm=N9;const M9=Jr("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Kxe=g.forwardRef(({className:e,variant:t,size:n,...r},o)=>p.jsx(yE,{ref:o,className:K(M9({variant:t,size:n,className:e})),...r}));Kxe.displayName=yE.displayName;const k9=g.createContext({size:"default",variant:"default"}),P9=g.forwardRef(({className:e,variant:t,size:n,children:r,...o},a)=>p.jsx(nm,{ref:a,className:K("flex items-center justify-center gap-1",e),...o,children:p.jsx(k9.Provider,{value:{variant:t,size:n},children:r})}));P9.displayName=nm.displayName;const A9=g.forwardRef(({className:e,children:t,variant:n,size:r,...o},a)=>{const i=g.useContext(k9);return p.jsx(rm,{ref:a,className:K(M9({variant:i.variant||n,size:i.size||r}),e),...o,children:t})});A9.displayName=rm.displayName;function Xxe(){const e=Ve(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return p.jsx("div",{children:e})}function Qxe({change:e}){var r,o,a,i;const t="id"in e?e.id:"-",{type:n}=e;return p.jsxs("div",{className:"mb-3",children:[p.jsxs("div",{children:["node id: ",t]}),p.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(o=e.dimensions)==null?void 0:o.height}`:null,n==="position"?`position: ${(a=e.position)==null?void 0:a.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function Jxe({limit:e=20}){const[t,n]=g.useState([]),r=vt(),o=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:o}),()=>r.setState({onNodesChange:void 0})),[o,r]);const a=()=>p.jsx("div",{children:"No Changes Triggered"});return p.jsx(p.Fragment,{children:t.length===0?p.jsx(a,{}):t.map((i,s)=>p.jsx(Qxe,{change:i},s))})}function Gxe(){const{getInternalNode:e}=Fn(),t=Ote();return p.jsx(Ste,{children:p.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var a,i;const r=e(n.id);if(!r)return null;const o=r==null?void 0:r.internals.positionAbsolute;return p.jsx(Zxe,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:o,width:((a=n.measured)==null?void 0:a.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function Zxe({id:e,type:t,selected:n,position:r,absPosition:o,width:a,height:i,data:s}){if(!a||!i)return null;const c=`translate(${o.x}px, ${o.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${a} \xD7 ${i}`,d=n?"Selected":"Not Selected";return p.jsxs("div",{style:{position:"absolute",transform:c,width:a*2},className:"text-xs",children:[p.jsxs("div",{children:["id: ",e]}),p.jsxs("div",{children:["type: ",t]}),p.jsxs("div",{children:["selected: ",d]}),p.jsxs("div",{children:["position: ",l]}),p.jsxs("div",{children:["dimensions: ",u]}),p.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function ewe({tools:e}){return p.jsx(es,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:p.jsx(P9,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:o})=>p.jsx(A9,{value:o,onClick:()=>n(a=>!a),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},o))})})}function T9(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[o,a]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:o,setActive:a,label:"Viewport Logger",value:"viewport-logger"}];return p.jsxs(p.Fragment,{children:[p.jsx(ewe,{tools:i}),n&&p.jsx(es,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:p.jsx(Jxe,{})}),e&&p.jsx(Gxe,{}),o&&p.jsx(es,{position:"bottom-left",className:"text-secondary-foreground",children:p.jsx(Xxe,{})})]})}T9.displayName="DevTools";const twe=()=>{const e=g.useRef({}),t=g.useRef({}),n=Ae(N=>N.flowEdges),r=Je(N=>N.currentSession),o=Ae(N=>N.setNodes),a=Ae(N=>N.updateNodes),i=Ae(N=>N.updateEdges),s=Ae(N=>N.addConnectionToEdges),c=Ae(N=>N.reset),l=Ae(N=>N.findFlowEdges),u=Ae(N=>N.deleteFlowNode),d=Ae(N=>N.deleteFlowEdge),f=Ae(N=>N.updateFlowNode),h=Ae(N=>N.getNodes),y=Ae(N=>N.findFlowNodesWithSource),m=g.useRef(n),v=g.useRef(),[b,x]=g.useState({loading:!1});m.current=n;const _=g.useCallback(async(N,P)=>{try{v.current=N,c(),await(P==null?void 0:P())}catch{v.current=void 0}},[c]),w=g.useCallback(async N=>{try{if(!(r!=null&&r.id))return;x(A=>({...A,loading:!0}));const P=await y({...N,where:{...N.where,session_id:r.id}}),R=await l({where:[{source:Vr(P.map(A=>A.id))},{target:Vr(P.map(A=>A.id))}]});return{flowNodes:P,flowEdges:R}}finally{x(P=>({...P,loading:!1}))}},[y,l,r==null?void 0:r.id]),j=g.useCallback(async N=>{var P,R;for(const A of N)if("id"in A&&Object.values(Sl).includes(A.id)&&A.type!=="remove")a([A]);else if(A.type==="position"&&A.position&&!isNaN(A.position.x)&&!isNaN(A.position.y)){a([A]);const C=A.position.x,M=A.position.y;clearTimeout(e.current[A.id]),e.current[A.id]=setTimeout(async()=>{e.current[A.id]=void 0,await f({id:A.id,x:C,y:M},{silent:!0})},200)}else if(A.type==="remove"){const C=(P=h([A.id]))==null?void 0:P[0];if(!(C!=null&&C.type)||Jne.includes(C.type))return;await u({id:A.id})}else if(A.type==="dimensions"&&A.dimensions&&!isNaN(A.dimensions.width)&&!isNaN(A.dimensions.height)){const C=(R=h([A.id]))==null?void 0:R[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;a([A]),clearTimeout(t.current[A.id]);const M=A.dimensions.width,T=A.dimensions.height;t.current[A.id]=setTimeout(async()=>{await f({id:A.id,width:M,height:T},{silent:!0})},200)}else A.type==="select"&&a([A])},[a,f,h,u]),E=g.useCallback(N=>{Promise.all(N.map(async P=>{if(P.type==="remove")return d({id:P.id})})),i(N)},[d,i]),S=g.useCallback(N=>{s(N)},[s]),O=g.useCallback(()=>{var N;(N=m.current)==null||N.length},[]),k=g.useCallback(N=>{o(P=>{var M,T;let R;if(typeof N=="function"?R=N(P):R=N,!R)return P;const A=P==null?void 0:P.find(D=>D.id===R.id),C={id:R.id,item:A?Vf(A,R):{...R,position:{x:((M=R.position)==null?void 0:M.x)||0,y:((T=R.position)==null?void 0:T.y)||0}},type:A?"replace":"add"};return Ba([C],P)})},[o]);return{syncEdges:O,initialFlow:_,loadingState:b,prepareFlowInfo:w,updateNodeChanges:j,updateEdgeChanges:E,updateOrCreateNode:k,currentSessionIdRef:v,updateEdgeConnection:S}},nwe=e=>{const t=Je(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:o,initialFlow:a,currentSessionIdRef:i}=e,s=Ae(u=>u.ready),c=Ae(u=>u.removeSyncNodeQueue),l=Ae(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||a(t,async()=>{await r({where:{session_id:t}})})},[a,r,n.loading,i,s,t]),g.useEffect(()=>{const u=Ae.subscribe(f=>f.syncNodeQueue,async(f,h)=>{const y=h.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&c(m.map(v=>v.timestamp))}),d=Ae.subscribe(f=>f.syncEdgeQueue,async(f,h)=>{const y=h.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&(l(m.map(v=>v.timestamp)),o())});return()=>{u(),d()}},[r,l,c,o])},rwe=()=>{const[e,t]=g.useState(!0),n=twe(),r=sn(u=>u.selectedModel),o=g.useRef(r),a=sn(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return nwe(n),o.current=r,g.useEffect(()=>{const u=a==null?void 0:a(d=>{if(!o.current)return;const f=`${o.current}`;i(h=>{const y=h==null?void 0:h.find(m=>{var v;return(v=m.data)!=null&&v.entity&&typeof m.data.entity=="object"&&"name"in m.data.entity?m.data.entity.name===f:!1});if(y)return y.data.label=d.text,y.data.status=et.Loading,d.progress===100&&(y.data.label="",y.data.status=et.Loaded),y})});return()=>{u==null||u()}},[a,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},owe=()=>{const e=$u(l=>l.theme),t=Ae(l=>l.nodes),n=Ae(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:o,updateEdgeConnection:a}=rwe(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{o(l)},[o]),c=g.useCallback(l=>{a(l)},[a]);return p.jsxs(jte,{nodes:t,edges:n,nodeTypes:E9,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:Zo.Free,colorMode:e,fitView:!0,children:[p.jsx(Ate,{variant:_o.Dots,gap:24,size:1}),p.jsx(Bte,{}),p.jsx(Jte,{}),Xwe?p.jsx(T9,{}):void 0]})},awe=g.memo(owe);function iwe(){return p.jsx(awe,{})}function xE(){const e=cC();return Yh(e),p.jsx(Jwe,{})}const swe=A7(p.jsxs(xc,{Component:Rq,errorElement:p.jsx(xE,{}),children:[p.jsx(xc,{path:rg.whiteboard,Component:iwe,errorElement:p.jsx(xE,{})}),p.jsx(xc,{path:rg.application,errorElement:p.jsx(xE,{}),Component:iae}),p.jsx(xc,{path:"*",element:p.jsx(M7,{to:In("whiteboard")})})]})),cwe=(e,t)=>{switch(iW){case"browser":return gC(e,t);case"hash":return nV(e);default:return gC(e,t)}},lwe=cwe(swe,{basename:"/NoLLMChat/"});Qwe("[BASE_URL]","/NoLLMChat/");let R9;R9=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?p.jsx(U9,{className:"w-screen h-screen",enableLogo:!0,typing:!0}):p.jsx(pV,{router:lwe})},()=>!0),tz=Object.freeze(Object.defineProperty({__proto__:null,default:R9},Symbol.toStringTag,{value:"Module"}))});export{q9 as $,ME as A,Qh as B,kE as C,PE as D,nc as E,Jh as F,rc as G,wa as H,Wu as I,qu as J,Gh as K,AE as L,TE as M,pi as N,RE as O,IE as P,DE as Q,LE as R,Zh as S,FE as T,BE as U,$E as V,zE as W,VE as X,UE as Y,HE as Z,Zr as _,a1e as __tla,em as a,oc as a$,Uo as a0,ac as a1,tm as a2,ic as a3,nm as a4,rm as a5,Y9 as a6,WE as a7,K9 as a8,qE as a9,om as aA,am as aB,im as aC,sm as aD,YE as aE,KE as aF,Yu as aG,cm as aH,lm as aI,um as aJ,dm as aK,fm as aL,pm as aM,hm as aN,mm as aO,ym as aP,gm as aQ,vm as aR,bm as aS,xm as aT,wm as aU,_m as aV,XE as aW,jm as aX,QE as aY,X9 as aZ,mt as a_,JE as aa,GE as ab,Q9 as ac,Em as ad,sc as ae,ZE as af,J9 as ag,Sm as ah,Cm as ai,Om as aj,eS as ak,Nm as al,Mm as am,km as an,Pm as ao,Am as ap,Tm as aq,tS as ar,nS as as,G9 as at,rS as au,Z9 as av,oS as aw,Rm as ax,Im as ay,Dm as az,cc as b,lc as b0,_a as b1,ja as b2,Ku as b3,uc as b4,hi as b5,mi as b6,ez as b7,aS as b8,iS as b9,sS as ba,Lm as bb,Fm as bc,cS as bd,Qe as be,wn as bf,Ae as bg,cn as bh,ln as bi,Bm as bj,$m as bk,lS as bl,uS as bm,zm as bn,Vm as bo,at as bp,dS as bq,Um as br,Hm as bs,fS as bt,pS as bu,hS as bv,yi as bw,Ho as bx,tz as by,mS as c,nr as d,Wm as e,yS as f,gS as g,gi as h,rr as i,qm as j,Ym as k,vS as l,Nr as m,bS as n,Km as o,Xm as p,xS as q,wS as r,_S as s,Qm as t,un as u,dc as v,Jm as w,fc as x,vi as y,jS as z};
